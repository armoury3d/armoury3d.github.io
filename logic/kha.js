!function(t,e){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};var S,i={},n=function(){return _s.__string_rec(this,"")},w=w||{};function r(t,e){var i=Object.create(t);for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var s=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};(i.EReg=s).__name__="EReg",s.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&0<=t&&t<this.r.m.length)return this.r.m[t];throw new us("EReg::matched")},__class__:s};var ht=function(){};(i.HxOverrides=ht).__name__="HxOverrides",ht.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var r=t.split(" "),s=r[0].split("-"),a=r[1].split(":");return new Date(s[0],s[1]-1,s[2],a[0],a[1],a[2]);default:throw new us("Invalid date format : "+t)}},ht.cca=function(t,e){var i=t.charCodeAt(e);return i!=i?ds.get_undefined():i},ht.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},ht.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},ht.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=function(){};(i.Lambda=l).__name__="Lambda",l.has=function(t,e){for(var i,n=(i=t)instanceof Array?ht.iter(i):i.iterator();n.hasNext();){if(n.next()==e)return!0}return!1};var a=function(){};(i.Main=a).__name__="Main",a.main=function(){Xn.main("Scene",1,!0,!0,!0,1600,900,2,!0,Gn.get)},Math.__name__="Math";var V=function(){};(i.Reflect=V).__name__="Reflect",V.hasField=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},V.field=function(t,e){try{return t[e]}catch(t){t instanceof us&&t.val;return null}},V.setField=function(t,e,i){t[e]=i},V.getProperty=function(t,e){var i;return null==t?null:!!t.__properties__&&(i=t.__properties__["get_"+e])?t[i]():t[e]},V.setProperty=function(t,e,i){var n;!!t.__properties__&&(n=t.__properties__["set_"+e])?t[n](i):t[e]=i},V.callMethod=function(t,e,i){return e.apply(t,i)},V.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var n in t)"__id__"!=n&&"hx__closures__"!=n&&i.call(t,n)&&e.push(n)}return e},V.isFunction=function(t){return"function"==typeof t&&!(_s.isClass(t)||_s.isEnum(t))},V.deleteField=function(t,e){return!!V.hasField(t,e)&&(delete t[e],!0)};var pt=function(){};(i.Std=pt).__name__="Std",pt.is=function(t,e){return _s.__instanceof(t,e)},pt.string=function(t){return _s.__string_rec(t,"")},pt.int=function(t){return 0|t},pt.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e},pt.parseFloat=function(t){return parseFloat(t)},pt.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var o=function(){this.b=""};(i.StringBuf=o).__name__="StringBuf",o.prototype={add:function(t){this.b+=pt.string(t)},addChar:function(t){this.b+=String.fromCodePoint(t)},toString:function(){return this.b},__class__:o};var q=function(){};(i.StringTools=q).__name__="StringTools",q.urlEncode=function(t){return encodeURIComponent(t)},q.urlDecode=function(t){return decodeURIComponent(t.split("+").join(" "))},q.startsWith=function(t,e){return t.length>=e.length&&ht.substr(t,0,e.length)==e},q.endsWith=function(t,e){var i=e.length,n=t.length;return i<=n&&ht.substr(t,n-i,i)==e},q.replace=function(t,e,i){return t.split(e).join(i)},q.fastCodeAt=function(t,e){return t.charCodeAt(e)},q.isEof=function(t){return t!=t};var h=w.ValueType={__ename__:"ValueType",__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"],TNull:{_hx_index:0,__enum__:"ValueType",toString:n},TInt:{_hx_index:1,__enum__:"ValueType",toString:n},TFloat:{_hx_index:2,__enum__:"ValueType",toString:n},TBool:{_hx_index:3,__enum__:"ValueType",toString:n},TObject:{_hx_index:4,__enum__:"ValueType",toString:n},TFunction:{_hx_index:5,__enum__:"ValueType",toString:n},TClass:(S=function(t){return{_hx_index:6,c:t,__enum__:"ValueType",toString:n}},S.__params__=["c"],S),TEnum:(S=function(t){return{_hx_index:7,e:t,__enum__:"ValueType",toString:n}},S.__params__=["e"],S),TUnknown:{_hx_index:8,__enum__:"ValueType",toString:n}},J=function(){};(i.Type=J).__name__="Type",J.getClass=function(t){return null==t?null:_s.getClass(t)},J.getClassName=function(t){return t.__name__},J.getEnumName=function(t){return t.__ename__},J.resolveClass=function(t){return i[t]},J.resolveEnum=function(t){return w[t]},J.createInstance=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(e)))},J.createEmptyInstance=function(t){return Object.create(t.prototype)},J.createEnum=function(t,e,i){var n=V.field(t,e);if(null==n)throw new us("No such constructor "+e);if(V.isFunction(n)){if(null==i)throw new us("Constructor "+e+" need parameters");return V.callMethod(t,n,i)}if(null!=i&&0!=i.length)throw new us("Constructor "+e+" does not need parameters");return n},J.getEnumConstructs=function(t){return t.__constructs__.slice()},J.typeof=function(t){switch(typeof t){case"boolean":return h.TBool;case"function":return _s.isClass(t)||_s.isEnum(t)?h.TObject:h.TFunction;case"number":return Math.ceil(t)==t%2147483648?h.TInt:h.TFloat;case"object":if(null==t)return h.TNull;var e=t.__enum__;if(null!=e)return h.TEnum(w[e]);var i=_s.getClass(t);return null!=i?h.TClass(i):h.TObject;case"string":return h.TClass(String);case"undefined":return h.TNull;default:return h.TUnknown}},J.enumConstructor=function(t){return w[t.__enum__].__constructs__[t._hx_index]},J.enumParameters=function(t){var e=w[t.__enum__],i=e[e.__constructs__[t._hx_index]].__params__;if(null!=i){for(var n=[],r=0;r<i.length;){var s=i[r];++r,n.push(t[s])}return n}return[]};var u=function(){this._render2D=null,this._render=null,this._lateUpdate=null,this._update=null,this._remove=null,this._init=null,this._add=null};(i["iron.Trait"]=u).__name__="iron.Trait",u.prototype={remove:function(){this.object.removeTrait(this)},notifyOnAdd:function(t){null==this._add&&(this._add=[]),this._add.push(t)},notifyOnInit:function(t){null==this._init&&(this._init=[]),this._init.push(t),vr.notifyOnInit(t)},notifyOnRemove:function(t){null==this._remove&&(this._remove=[]),this._remove.push(t)},notifyOnUpdate:function(t){null==this._update&&(this._update=[]),this._update.push(t),vr.notifyOnUpdate(t)},removeUpdate:function(t){ht.remove(this._update,t),vr.removeUpdate(t)},notifyOnRender2D:function(t){null==this._render2D&&(this._render2D=[]),this._render2D.push(t),vr.notifyOnRender2D(t)},__class__:u};var _=function(){u.call(this),Tr.getFont("font_default.ttf",function(t){_.font=t,xr.active.root.addTrait(new T)})};(i["arm.App"]=_).__name__="arm.App",_.w=function(){var t=pt.int(Us.windowWidth()/3);return 0<t?t:1},_.h=function(){var t;return 0<(t=Us.windowHeight())?t:1},_.x=function(){return 0},_.y=function(){return 0},_.realw=function(){return Us.windowWidth()},_.realh=function(){return Us.windowHeight()},_.resize=function(){xr.active.camera.buildProjection(),null!=T.inst.grid&&(T.inst.grid.unload(),T.inst.grid=null)},_.render=function(t){0<=_.lastW&&0<_.realw()&&(_.lastW!=_.realw()||_.lastH!=_.realh())&&_.resize(),_.lastW=_.realw(),_.lastH=_.realh()},_.__super__=u,_.prototype=r(u.prototype,{__class__:_});var k=function(){};(i["arm.NodeCreatorLogic"]=k).__name__="arm.NodeCreatorLogic",k.nodeColor=function(t){switch(t){case"Action":case"Animation":case"Event":case"Input":case"Logic":case"Native":case"Navmesh":case"Physics":case"Sound":case"Value":case"Variable":return-5025958}return-5025958},k.socketColor=function(t){switch(t){case"ACTION":return-3388340;case"BOOL":case"INTEGER":return-10238109;case"OBJECT":return-14250817;case"RGBA":return-10238109;case"SHADER":return-11959648;case"STRING":return-1;case"VALUE":case"VECTOR":return-10238109}return-5025958},k.socketDefault=function(t){switch(t){case"ACTION":return 0;case"BOOL":return!1;case"INTEGER":case"OBJECT":return 0;case"RGBA":return[0,0,0,0];case"SHADER":return 0;case"STRING":return"";case"VALUE":return 0;case"VECTOR":return[0,0,0]}return 0},k.draw=function(t){for(var e=T.inst.ui,i=ko(S=T.inst,S.getNodeX),n=ko(S=T.inst,S.getNodeY),r=T.inst.nodes,s=T.inst.canvasLogic,a=0,o=k.list.categories[t].nodes;a<o.length;){var l=o[a];if(++a,e.button(l.name)){for(var h=r.getNodeId(s.nodes),u={id:h,name:l.name,type:l.type,x:i(),y:n(),color:k.nodeColor(l.type),inputs:[],outputs:[],buttons:[]},_=0,c=l.inputs;_<c.length;){var d=c[_];++_;var p={id:r.getSocketId(s.nodes),node_id:h,name:d.name,type:d.type,color:k.socketColor(d.type),default_value:k.socketDefault(d.type)};u.inputs.push(p)}for(var f=0,g=l.outputs;f<g.length;){var m=g[f];++f;var v={id:r.getSocketId(s.nodes),node_id:h,name:m.name,type:m.type,color:k.socketColor(m.type),default_value:k.socketDefault(m.type)};u.outputs.push(v)}for(var y=0,w=l.buttons;y<w.length;){var b=w[y];++y;var x={name:b.name,type:b.type,output:0,default_value:b.default_value,data:b.data};u.buttons.push(x)}s.nodes.push(u),r.nodeDrag=u,r.nodeSelected=u}}};var T=function(){this.lastT=null,this.hwnd=mo.global.nest(0,null),this.grid=null,this.changed=!1,this.canvasLogic=null,this.nodes=new wo,this.urlParsed=!1,this.popupY=0,this.popupX=0,this.addNodeButton=!1,this.menuCategory=0,this.hideMenu=!1,this.showMenu=!1,this.drawMenu=!1;var s=this;u.call(this),T.inst=this,Tr.getBlob("logic_nodes.json",function(t){var e='{"nodes":[],"links":[]}',i=q.urlDecode(window.location.href);0<i.indexOf("?")&&(e=i.split("?")[1],e=s.decode(e),s.urlParsed=!0),s.canvasLogic=JSON.parse(e),(k.list=JSON.parse(t.toString())).categories.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0});var n=bo.dark;n.ELEMENT_H=18,n.BUTTON_H=16;var r=d.raw.window_scale;s.ui=new xo({font:_.font,color_wheel:_.color_wheel,scaleFactor:r}),s.ui.scrollEnabled=!1,s.notifyOnRender2D(ko(s,s.render2D)),s.notifyOnUpdate(ko(s,s.update)),s.notifyOnInit(ko(s,s.parseLogic)),Us.notifyOnCutCopyPaste(ko(s,s.onCut),ko(s,s.onCopy),ko(s,s.onPaste))})};(i["arm.UINodes"]=T).__name__="arm.UINodes",T.__super__=u,T.prototype=r(u.prototype,{encode:function(t){return t=q.replace(t,'{"nodes":[{',"~0"),t=q.replace(t,'"id":',"~1"),t=q.replace(t,',"name":"',"~2"),t=q.replace(t,'","type":"ACTION","color":-3388340',"~3"),t=q.replace(t,'","type":"OBJECT","color":-14250817',"~4"),t=q.replace(t,'","type":"SHADER","color":-11959648',"~5"),t=q.replace(t,'","type":"INTEGER","color":-3388340',"~6"),t=q.replace(t,'","type":"VALUE","color":-10238109',"~7"),t=q.replace(t,'","type":"VECTOR","color":-10238109',"~8"),t=q.replace(t,'","type":"RGBA","color":-3388340',"~9"),t=q.replace(t,'","type":"STRING","color":-3388340',"~a"),t=q.replace(t,'","type":"BOOL","color":-3388340',"~b"),t=q.replace(t,'","type":"',"~c"),t=q.replace(t,'","x":',"~d"),t=q.replace(t,',"y":',"~e"),t=q.replace(t,',"color":-5025958',"~f"),t=q.replace(t,',"inputs":[',"~g"),t=q.replace(t,',"outputs":[',"~h"),t=q.replace(t,',"node_id":',"~i"),t=q.replace(t,',"default_value":',"~j"),t=q.replace(t,',"buttons":[',"~k"),t=q.replace(t,',"links":[{',"~l"),t=q.replace(t,',"from_id":',"~m"),t=q.replace(t,',"from_socket":',"~n"),t=q.replace(t,',"to_id":',"~o"),t=q.replace(t,',"to_socket":',"~p"),t=q.replace(t,"[0,0,0]","~q"),t=q.replace(t,"[0,0,0,0]","~r"),t=q.replace(t,"},{","~s"),t=q.replace(t,',"color":',"~t"),t=q.replace(t,',"data":',"~u"),t=q.replace(t,',"output":',"~v"),t=q.replace(t,'"name":"property',"~w"),q.urlEncode(t)},decode:function(t){return t=q.replace(t,"~w",'"name":"property'),t=q.replace(t,"~v",',"output":'),t=q.replace(t,"~u",',"data":'),t=q.replace(t,"~t",',"color":'),t=q.replace(t,"~s","},{"),t=q.replace(t,"~r","[0,0,0,0]"),t=q.replace(t,"~q","[0,0,0]"),t=q.replace(t,"~p",',"to_socket":'),t=q.replace(t,"~o",',"to_id":'),t=q.replace(t,"~n",',"from_socket":'),t=q.replace(t,"~m",',"from_id":'),t=q.replace(t,"~l",',"links":[{'),t=q.replace(t,"~k",',"buttons":['),t=q.replace(t,"~j",',"default_value":'),t=q.replace(t,"~i",',"node_id":'),t=q.replace(t,"~h",',"outputs":['),t=q.replace(t,"~g",',"inputs":['),t=q.replace(t,"~f",',"color":-5025958'),t=q.replace(t,"~e",',"y":'),t=q.replace(t,"~d",'","x":'),t=q.replace(t,"~c",'","type":"'),t=q.replace(t,"~b",'","type":"BOOL","color":-3388340'),t=q.replace(t,"~a",'","type":"STRING","color":-3388340'),t=q.replace(t,"~9",'","type":"RGBA","color":-3388340'),t=q.replace(t,"~8",'","type":"VECTOR","color":-10238109'),t=q.replace(t,"~7",'","type":"VALUE","color":-10238109'),t=q.replace(t,"~6",'","type":"INTEGER","color":-3388340'),t=q.replace(t,"~5",'","type":"SHADER","color":-11959648'),t=q.replace(t,"~4",'","type":"OBJECT","color":-14250817'),t=q.replace(t,"~3",'","type":"ACTION","color":-3388340'),t=q.replace(t,"~2",',"name":"'),t=q.replace(t,"~1",'"id":'),t=q.replace(t,"~0",'{"nodes":[{')},onCut:function(){return this.onCopy()},onCopy:function(){return"https://armory3d.org/logic/?"+this.encode(JSON.stringify(this.canvasLogic))},onPaste:function(t){},update:function(){var t=Jr.getMouse(),e=Jr.getKeyboard();(this.ui.changed||this.changed)&&(this.parseLogic(),this.changed=!1),this.wx=pt.int(vr.w()),this.wy=0;var i=t.x+_.x(),n=t.y+_.y();if(!(i<this.wx||n<this.wy||this.ui.isTyping)){if(this.addNodeButton?(this.showMenu=!0,this.addNodeButton=!1):t.released()&&(this.hideMenu=!0),(e.started("x")||e.started("backspace"))&&null!=this.nodes.nodeSelected){var r=this.canvasLogic;this.nodes.removeNode(this.nodes.nodeSelected,r),this.changed=!0}if(e.started("p")){var s=this.canvasLogic,a=JSON.stringify(s);Jn.trace(a,{fileName:"arm/UINodes.hx",lineNumber:191,className:"arm.UINodes",methodName:"update"})}}},getNodeX:function(){var t=Jr.getMouse();return pt.int((t.x+_.x()-this.wx-this.nodes.PAN_X())/this.nodes.SCALE)},getNodeY:function(){var t=Jr.getMouse();return pt.int((t.y+_.y()-this.wy-this.nodes.PAN_Y())/this.nodes.SCALE)},drawGrid:function(){var t=_.realw()-vr.w()+80,e=vr.h()+80;this.grid=Ss.createRenderTarget(t,e),this.grid.get_g2().begin(!0,-14408668);for(var i=0,n=pt.int(e/40)+1;i<n;){var r=i++;this.grid.get_g2().set_color(-14145496),this.grid.get_g2().drawLine(0,40*r,t,40*r),this.grid.get_g2().set_color(-13487566),this.grid.get_g2().drawLine(0,40*r+20,t,40*r+20)}for(var s=0,a=pt.int(t/40)+1;s<a;){var o=s++;this.grid.get_g2().set_color(-14145496),this.grid.get_g2().drawLine(40*o,0,40*o,e),this.grid.get_g2().set_color(-13487566),this.grid.get_g2().drawLine(40*o+20,0,40*o+20,e)}this.grid.get_g2().end()},render2D:function(t){t.end(),null==this.grid&&this.drawGrid(),this.ui.begin(t),this.ww=pt.int(_.realw()-vr.w());this.wx=pt.int(vr.w()),this.wy=0;var e=pt.int(this.ui.ELEMENT_W());if(this.ui.window(this.hwnd,this.wx,this.wy,this.ww,vr.h())){if(this.ui.g.set_color(-1),this.ui.g.drawImage(this.grid,this.nodes.panX*this.nodes.SCALE%40-40,this.nodes.panY*this.nodes.SCALE%40-40),this.ui.g.set_font(_.font),this.ui.g.set_fontSize(22),!this.urlParsed){var i="Ctrl + C to copy URL",n=this.ui.g.get_font().width(22,i),r=this.ui.g.get_font().height(22);this.ui.g.drawString(i,this.ww-n-20,vr.h()-r-10)}var s=this.canvasLogic;this.nodes.nodeCanvas(this.ui,s),this.ui.g.set_color(this.ui.t.WINDOW_BG_COL),this.ui.g.set_color(-1),this.ui._x=3,this.ui._y=3,this.ui._w=e,this.urlParsed||(this.ui.button("Action")&&(this.addNodeButton=!0,this.menuCategory=0,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=3,this.ui.button("Animation")&&(this.addNodeButton=!0,this.menuCategory=1,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=3,this.ui.button("Array")&&(this.addNodeButton=!0,this.menuCategory=2,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=3,this.ui.button("Canvas")&&(this.addNodeButton=!0,this.menuCategory=3,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=3,this.ui.button("Event")&&(this.addNodeButton=!0,this.menuCategory=4,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=3,this.ui.button("Input")&&(this.addNodeButton=!0,this.menuCategory=5,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x=3,this.ui._y=30,this.ui.button("Logic")&&(this.addNodeButton=!0,this.menuCategory=6,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x=e+3,this.ui._y=30,this.ui.button("Navmesh")&&(this.addNodeButton=!0,this.menuCategory=8,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=30,this.ui.button("Physics")&&(this.addNodeButton=!0,this.menuCategory=9,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=30,this.ui.button("Sound")&&(this.addNodeButton=!0,this.menuCategory=10,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=30,this.ui.button("Value")&&(this.addNodeButton=!0,this.menuCategory=11,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y),this.ui._x+=e+3,this.ui._y=30,this.ui.button("Variable")&&(this.addNodeButton=!0,this.menuCategory=12,this.popupX=this.wx+this.ui._x,this.popupY=this.wy+this.ui._y))}if(this.ui.endWindow(),this.drawMenu){var a=20*k.list.categories[this.menuCategory].nodes.length,o=this.popupY;t.set_color(-14540254),t.fillRect(this.popupX,o,e,a),this.ui.beginLayout(t,pt.int(this.popupX),pt.int(o),e),k.draw(this.menuCategory),this.ui.endLayout()}this.ui.end(),t.begin(!1),this.showMenu&&(this.showMenu=!1,this.drawMenu=!0),this.hideMenu&&(this.hideMenu=!1,this.drawMenu=!1)},parseLogic:function(){null!=this.lastT&&xr.active.getChild("Cube").removeTrait(this.lastT),jn.packageName="armory.logicnode";var t=jn.parse(this.canvasLogic);this.lastT=t,xr.active.getChild("Cube").addTrait(t)},__class__:T});var d=function(){};(i["armory.data.Config"]=d).__name__="armory.data.Config";var c=function(t){this.outputs=[],this.inputs=[],this.tree=t};(i["armory.logicnode.LogicNode"]=c).__name__="armory.logicnode.LogicNode",c.prototype={addInput:function(t,e){this.inputs.push(new he(t,e))},addOutputs:function(t){this.outputs.push(t)},run:function(t){},runOutput:function(t){if(!(t>=this.outputs.length))for(var e=0,i=this.outputs[t];e<i.length;){var n=i[e];++e;for(var r=0,s=n.inputs.length;r<s;){var a=r++;if(n.inputs[a].node==this){n.run(a);break}}}},get:function(t){return this},set:function(t){},__class__:c};var p=function(t){c.call(this,t)};(i["armory.logicnode.ActiveCameraNode"]=p).__name__="armory.logicnode.ActiveCameraNode",p.__super__=c,p.prototype=r(c.prototype,{get:function(t){return xr.active.camera},__class__:p});var f=function(t){c.call(this,t)};(i["armory.logicnode.ActiveSceneNode"]=f).__name__="armory.logicnode.ActiveSceneNode",f.__super__=c,f.prototype=r(c.prototype,{get:function(t){return xr.active.raw.name},__class__:f});var g=function(t){c.call(this,t)};(i["armory.logicnode.AddGroupNode"]=g).__name__="armory.logicnode.AddGroupNode",g.__super__=c,g.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null==xr.active.groups.get(e)&&xr.active.groups.set(e,[]),this.runOutput(0)},__class__:g});var m=function(t){c.call(this,t)};(i["armory.logicnode.AddTraitNode"]=m).__name__="armory.logicnode.AddTraitNode",m.__super__=c,m.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.addTrait(i),this.runOutput(0))},__class__:m});var v=function(t){this.b=!0,c.call(this,t)};(i["armory.logicnode.AlternateNode"]=v).__name__="armory.logicnode.AlternateNode",v.__super__=c,v.prototype=r(c.prototype,{run:function(t){this.b?this.runOutput(0):this.runOutput(1),this.b=!this.b},__class__:v});var y=function(t,e){null==e&&(e=""),c.call(this,t),this.value=e};(i["armory.logicnode.AnimActionNode"]=y).__name__="armory.logicnode.AnimActionNode",y.__super__=c,y.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:y});var b=function(t){c.call(this,t)};(i["armory.logicnode.AnimationStateNode"]=b).__name__="armory.logicnode.AnimationStateNode",b.__super__=c,b.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var i=e.animation;return null==i&&(i=e.getParentArmature(e.name)),0==t?!i.paused:1==t?i.action:i.currentFrame()},__class__:b});var x=function(t){c.call(this,t)};(i["armory.logicnode.AppendTransformNode"]=x).__name__="armory.logicnode.AppendTransformNode",x.__super__=c,x.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.multMatrix(i),this.runOutput(0))},__class__:x});var C=function(t){c.call(this,t)};(i["armory.logicnode.ApplyForceAtLocationNode"]=C).__name__="armory.logicnode.ApplyForceAtLocationNode",C.__super__=c,C.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get();null!=e&&null!=i&&null!=n&&this.runOutput(0)},__class__:C});var I=function(t){c.call(this,t)};(i["armory.logicnode.ApplyForceNode"]=I).__name__="armory.logicnode.ApplyForceNode",I.__super__=c,I.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&this.runOutput(0)},__class__:I});var N=function(t){c.call(this,t)};(i["armory.logicnode.ApplyImpulseAtLocationNode"]=N).__name__="armory.logicnode.ApplyImpulseAtLocationNode",N.__super__=c,N.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get();null!=e&&null!=i&&null!=n&&this.runOutput(0)},__class__:N});var O=function(t){c.call(this,t)};(i["armory.logicnode.ApplyImpulseNode"]=O).__name__="armory.logicnode.ApplyImpulseNode",O.__super__=c,O.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&this.runOutput(0)},__class__:O});var E=function(t){c.call(this,t)};(i["armory.logicnode.ApplyTorqueImpulseNode"]=E).__name__="armory.logicnode.ApplyTorqueImpulseNode",E.__super__=c,E.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&this.runOutput(0)},__class__:E});var M=function(t){c.call(this,t)};(i["armory.logicnode.ApplyTorqueNode"]=M).__name__="armory.logicnode.ApplyTorqueNode",M.__super__=c,M.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&this.runOutput(0)},__class__:M});var L=function(t){c.call(this,t)};(i["armory.logicnode.ArrayAddNode"]=L).__name__="armory.logicnode.ArrayAddNode",L.__super__=c,L.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){if(2<this.inputs.length)for(var i=2,n=this.inputs.length;i<n;){var r=i++,s=this.inputs[r].get();e.push(s)}this.runOutput(0)}},__class__:L});var A=function(t){c.call(this,t)};(i["armory.logicnode.ArrayAddUniqueNode"]=A).__name__="armory.logicnode.ArrayAddUniqueNode",A.__super__=c,A.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){if(2<this.inputs.length)for(var i=2,n=this.inputs.length;i<n;){var r=i++,s=this.inputs[r].get();-1==e.indexOf(s)&&e.push(s)}this.runOutput(0)}},__class__:A});var B=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayBooleanNode"]=B).__name__="armory.logicnode.ArrayBooleanNode",B.__super__=c,B.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:B});var R=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayColorNode"]=R).__name__="armory.logicnode.ArrayColorNode",R.__super__=c,R.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:R});var F=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayFloatNode"]=F).__name__="armory.logicnode.ArrayFloatNode",F.__super__=c,F.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:F});var P=function(t){c.call(this,t)};(i["armory.logicnode.ArrayGetNode"]=P).__name__="armory.logicnode.ArrayGetNode",P.__super__=c,P.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var i=this.inputs[1].get();if(i<0&&(i=e.length+i),i<0||i>e.length-1){var n=J.getClassName(J.getClass(this.tree)),r=n.substring(n.lastIndexOf(".")+1),s=this.tree.object.name;return Jn.trace("Logic error (object: "+s+", trait: "+r+"): Array Get - index out of range",{fileName:"Sources/armory/logicnode/ArrayGetNode.hx",lineNumber:19,className:"armory.logicnode.ArrayGetNode",methodName:"get"}),null}return e[i]},__class__:P});var D=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayIntegerNode"]=D).__name__="armory.logicnode.ArrayIntegerNode",D.__super__=c,D.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:D});var W=function(t){c.call(this,t)};(i["armory.logicnode.ArrayLengthNode"]=W).__name__="armory.logicnode.ArrayLengthNode",W.__super__=c,W.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null!=e?e.length:0},__class__:W});var H=function(t){c.call(this,t)};(i["armory.logicnode.ArrayLoopNode"]=H).__name__="armory.logicnode.ArrayLoopNode",H.__super__=c,H.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){for(var i=0;i<e.length;){var n=e[i];if(++i,this.value=n,this.runOutput(0),this.tree.loopBreak){this.tree.loopBreak=!1;break}}this.runOutput(2)}},get:function(t){return this.value},__class__:H});var z=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayNode"]=z).__name__="armory.logicnode.ArrayNode",z.__super__=c,z.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:z});var G=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayObjectNode"]=G).__name__="armory.logicnode.ArrayObjectNode",G.__super__=c,G.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:G});var U=function(t){c.call(this,t)};(i["armory.logicnode.ArrayPopNode"]=U).__name__="armory.logicnode.ArrayPopNode",U.__super__=c,U.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.pop()},__class__:U});var j=function(t){this.removedValue=null,c.call(this,t)};(i["armory.logicnode.ArrayRemoveNode"]=j).__name__="armory.logicnode.ArrayRemoveNode",j.__super__=c,j.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var i=this.inputs[2].get();i<0&&(i=e.length+i),this.removedValue=e[i],e.splice(i,1),this.runOutput(0)}},get:function(t){return this.removedValue},__class__:j});var X=function(t){this.removedValue=null,c.call(this,t)};(i["armory.logicnode.ArrayRemoveValueNode"]=X).__name__="armory.logicnode.ArrayRemoveValueNode",X.__super__=c,X.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var i=this.inputs[2].get();this.removedValue=i,ht.remove(e,i),this.runOutput(0)}},get:function(t){return this.removedValue},__class__:X});var Y=function(t){c.call(this,t)};(i["armory.logicnode.ArraySetNode"]=Y).__name__="armory.logicnode.ArraySetNode",Y.__super__=c,Y.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var i=this.inputs[2].get(),n=this.inputs[3].get();i<0?e[e.length+i]=n:e[i]=n,this.runOutput(0)}},__class__:Y});var Z=function(t){c.call(this,t)};(i["armory.logicnode.ArrayShiftNode"]=Z).__name__="armory.logicnode.ArrayShiftNode",Z.__super__=c,Z.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.shift()},__class__:Z});var K=function(t){c.call(this,t)};(i["armory.logicnode.ArraySliceNode"]=K).__name__="armory.logicnode.ArraySliceNode",K.__super__=c,K.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var i=this.inputs[1].get(),n=this.inputs[2].get();if(i<0&&(i=e.length+i),i<0||i>e.length-1){var r=J.getClassName(J.getClass(this.tree)),s=r.substring(r.lastIndexOf(".")+1),a=this.tree.object.name;return Jn.trace("Logic error (object: "+a+", trait: "+s+"): Array Get - index out of range",{fileName:"Sources/armory/logicnode/ArraySliceNode.hx",lineNumber:21,className:"armory.logicnode.ArraySliceNode",methodName:"get"}),null}return e.slice(i,n)},__class__:K});var Q=function(t){c.call(this,t)};(i["armory.logicnode.ArraySpliceNode"]=Q).__name__="armory.logicnode.ArraySpliceNode",Q.__super__=c,Q.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var i=this.inputs[2].get(),n=this.inputs[3].get();e.splice(i,n),this.runOutput(0)}},__class__:Q});var $=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayStringNode"]=$).__name__="armory.logicnode.ArrayStringNode",$.__super__=c,$.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:$});var tt=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(i["armory.logicnode.ArrayVectorNode"]=tt).__name__="armory.logicnode.ArrayVectorNode",tt.__super__=c,tt.prototype=r(c.prototype,{get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e;var r=n.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:tt});var et=function(t){c.call(this,t)};(i["armory.logicnode.BlendActionNode"]=et).__name__="armory.logicnode.BlendActionNode",et.__super__=c,et.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get(),r=this.inputs[4].get();if(null!=e){var s=e.animation;null==s&&(s=e.getParentArmature(e.name)),s.blend(i,n,r),this.runOutput(0)}},__class__:et});var it=function(t){this.iw=xn.identity(),this.w=null,this.m=null,this.notified=!1,c.call(this,t)};(i["armory.logicnode.BoneFKNode"]=it).__name__="armory.logicnode.BoneFKNode",it.__super__=c,it.prototype=r(c.prototype,{run:function(t){},__class__:it});var nt=function(t){this.notified=!1,c.call(this,t)};(i["armory.logicnode.BoneIKNode"]=nt).__name__="armory.logicnode.BoneIKNode",nt.__super__=c,nt.prototype=r(c.prototype,{run:function(t){},__class__:nt});var rt=function(t,e){null==e&&(e=!1),c.call(this,t),this.value=e};(i["armory.logicnode.BooleanNode"]=rt).__name__="armory.logicnode.BooleanNode",rt.__super__=c,rt.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:rt});var st=function(t){c.call(this,t)};(i["armory.logicnode.BranchNode"]=st).__name__="armory.logicnode.BranchNode",st.__super__=c,st.prototype=r(c.prototype,{run:function(t){this.inputs[1].get()?this.runOutput(0):this.runOutput(1)},__class__:st});var at=function(t){c.call(this,t)};(i["armory.logicnode.CallFunctionNode"]=at).__name__="armory.logicnode.CallFunctionNode",at.__super__=c,at.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){for(var i=this.inputs[2].get(),n=[],r=3,s=this.inputs.length;r<s;){var a=r++;n.push(this.inputs[a].get())}var o=V.field(e,i);null!=o&&(this.result=V.callMethod(e,o,n)),this.runOutput(0)}},get:function(t){return this.result},__class__:at});var ot=function(t){this.callTree=null,c.call(this,t)};(i["armory.logicnode.CallGroupNode"]=ot).__name__="armory.logicnode.CallGroupNode",ot.__super__=c,ot.prototype=r(c.prototype,{run:function(t){if(null==this.callTree){var e=J.resolveClass(this.property0);this.callTree=J.createInstance(e,[]),this.callTree.object=this.tree.object,this.callTree.add()}null!=this.callTree._init&&this.callTree._init[0](),this.runOutput(0)},__class__:ot});var lt=function(t){c.call(this,t)};(i["armory.logicnode.CallHaxeStaticNode"]=lt).__name__="armory.logicnode.CallHaxeStaticNode",lt.__super__=c,lt.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(""!=e){var i=e.lastIndexOf("."),n=ht.substr(e,0,i),r=J.resolveClass(n),s=ht.substr(e,i+1,null);this.result=V.callMethod(r,V.field(r,s),[this.tree])}this.runOutput(0)},get:function(t){return this.result},__class__:lt});var ut=function(t){c.call(this,t)};(i["armory.logicnode.CanvasSetLocationNode"]=ut).__name__="armory.logicnode.CanvasSetLocationNode",ut.__super__=c,ut.prototype=r(c.prototype,{update:function(){this.canvas.get_ready()&&(this.tree.removeUpdate(ko(this,this.update)),this.canvas.getElement(this.element).x=this.newX,this.canvas.getElement(this.element).y=this.newY,this.runOutput(0))},run:function(t){this.element=this.inputs[1].get(),this.newX=this.inputs[2].get(),this.newY=this.inputs[3].get(),this.canvas=xr.active.getTrait(Yn),null==this.canvas&&(this.canvas=xr.active.camera.getTrait(Yn)),this.tree.notifyOnUpdate(ko(this,this.update)),this.update()},__class__:ut});var _t=function(t){c.call(this,t)};(i["armory.logicnode.CanvasSetTextNode"]=_t).__name__="armory.logicnode.CanvasSetTextNode",_t.__super__=c,_t.prototype=r(c.prototype,{update:function(){this.canvas.get_ready()&&(this.tree.removeUpdate(ko(this,this.update)),this.canvas.getElement(this.element).text=this.text,this.runOutput(0))},run:function(t){this.element=this.inputs[1].get(),this.text=pt.string(this.inputs[2].get()),this.canvas=xr.active.getTrait(Yn),null==this.canvas&&(this.canvas=xr.active.camera.getTrait(Yn)),this.tree.notifyOnUpdate(ko(this,this.update)),this.update()},__class__:_t});var ct=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.CastPhysicsRayNode"]=ct).__name__="armory.logicnode.CastPhysicsRayNode",ct.__super__=c,ct.prototype=r(c.prototype,{get:function(t){this.inputs[0].get(),this.inputs[1].get();return null},__class__:ct});var dt=function(t){c.call(this,t)};(i["armory.logicnode.ClearParentNode"]=dt).__name__="armory.logicnode.ClearParentNode",dt.__super__=c,dt.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=e.parent&&(e.parent.removeChild(e,i),xr.active.root.addChild(e,!1),this.runOutput(0))},__class__:dt});var ft=function(t,e,i,n,r){null==r&&(r=1),null==n&&(n=.8),null==i&&(i=.8),null==e&&(e=.8),this.value=new bn,c.call(this,t),this.value.set(e,i,n,r)};(i["armory.logicnode.ColorNode"]=ft).__name__="armory.logicnode.ColorNode",ft.__super__=c,ft.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:ft});var gt=function(t){c.call(this,t)};(i["armory.logicnode.CompareNode"]=gt).__name__="armory.logicnode.CompareNode",gt.__super__=c,gt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get(),n=!1;switch(this.property0){case"Equal":n=e==i;break;case"Greater Than":n=i<e;break;case"Greater Than or Equal":n=i<=e;break;case"Less Than":n=e<i;break;case"Less Than or Equal":n=e<=i;break;case"Not Equal":n=e!=i}return n},__class__:gt});var mt=function(t,e){null==e&&(e=""),c.call(this,t),this.value=e};(i["armory.logicnode.ConcatenateStringNode"]=mt).__name__="armory.logicnode.ConcatenateStringNode",mt.__super__=c,mt.prototype=r(c.prototype,{get:function(t){this.value="";for(var e=0,i=this.inputs;e<i.length;){var n=i[e];++e,this.value+=pt.string(n.get())}return this.value},__class__:mt});var vt=function(t){c.call(this,t)};(i["armory.logicnode.ContainsStringNode"]=vt).__name__="armory.logicnode.ContainsStringNode",vt.__super__=c,vt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();if(null==e||null==i)return null;switch(this.property0){case"Contains":return 0<=e.indexOf(i);case"Ends With":return q.endsWith(e,i);case"Starts With":return q.startsWith(e,i)}return!1},__class__:vt});var yt=function(t){c.call(this,t)};(i["armory.logicnode.DegToRadNode"]=yt).__name__="armory.logicnode.DegToRadNode",yt.__super__=c,yt.prototype=r(c.prototype,{get:function(t){return.0174532924*this.inputs[0].get()},__class__:yt});var wt=function(t){c.call(this,t)};(i["armory.logicnode.DisplayInfoNode"]=wt).__name__="armory.logicnode.DisplayInfoNode",wt.__super__=c,wt.prototype=r(c.prototype,{get:function(t){return 0==t?Is.get_all()[0].get_width():Is.get_all()[0].get_height()},__class__:wt});var bt=function(t,e){c.call(this,t),this.value=null==e?{}:e};(i["armory.logicnode.DynamicNode"]=bt).__name__="armory.logicnode.DynamicNode",bt.__super__=c,bt.prototype=r(c.prototype,{get:function(t){return this.value},set:function(t){this.value=t},__class__:bt});var xt=function(t){c.call(this,t)};(i["armory.logicnode.ExpressionNode"]=xt).__name__="armory.logicnode.ExpressionNode",xt.__super__=c,xt.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},get:function(t){return this.result},__class__:xt});var St=function(t,e){null==e&&(e=0),c.call(this,t),this.value=e};(i["armory.logicnode.FloatNode"]=St).__name__="armory.logicnode.FloatNode",St.__super__=c,St.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:St});var kt=function(t){this.args=[],c.call(this,t)};(i["armory.logicnode.FunctionNode"]=kt).__name__="armory.logicnode.FunctionNode",kt.__super__=c,kt.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},get:function(t){return this.args[t-1]},__class__:kt});var Tt=function(t){c.call(this,t)};(i["armory.logicnode.FunctionOutputNode"]=Tt).__name__="armory.logicnode.FunctionOutputNode",Tt.__super__=c,Tt.prototype=r(c.prototype,{run:function(t){this.result=this.inputs[1].get(),this.runOutput(0)},__class__:Tt});var Ct=function(t){this.coords=new bn,c.call(this,t)};(i["armory.logicnode.GamepadCoordsNode"]=Ct).__name__="armory.logicnode.GamepadCoordsNode",Ct.__super__=c,Ct.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=Jr.getGamepad(e);return 0==t?(this.coords.x=i.leftStick.x,this.coords.y=i.leftStick.y,this.coords):1==t?(this.coords.x=i.rightStick.x,this.coords.y=i.rightStick.y,this.coords):2==t?(this.coords.x=i.leftStick.movementX,this.coords.y=i.leftStick.movementY,this.coords):3==t?(this.coords.x=i.rightStick.movementX,this.coords.y=i.rightStick.movementY,this.coords):null},__class__:Ct});var It=function(t){c.call(this,t)};(i["armory.logicnode.GamepadNode"]=It).__name__="armory.logicnode.GamepadNode",It.__super__=c,It.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=Jr.getGamepad(e);switch(this.property0){case"Down":return i.down(this.property1);case"Released":return i.released(this.property1)?1:0;case"Started":return i.started(this.property1)?1:0}return 0},__class__:It});var Nt=function(t){c.call(this,t)};(i["armory.logicnode.GateNode"]=Nt).__name__="armory.logicnode.GateNode",Nt.__super__=c,Nt.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=!1;switch(this.property0){case"Almost Equal":n=e instanceof bn?e.almostEquals(i,this.property1):Math.abs(e-i)<this.property1;break;case"And":n=!0;for(var r=1,s=this.inputs.length;r<s;){var a=r++;if(!this.inputs[a].get()){n=!1;break}}break;case"Equal":n=e instanceof bn?e.equals(i):e==i;break;case"Greater":n=i<e;break;case"Greater Equal":n=i<=e;break;case"Less":n=e<i;break;case"Less Equal":n=e<=i;break;case"Or":for(var o=1,l=this.inputs.length;o<l;){var h=o++;if(this.inputs[h].get()){n=!0;break}}}n?this.runOutput(0):this.runOutput(1)},__class__:Nt});var Ot=function(t){c.call(this,t)};(i["armory.logicnode.GetCameraFovNode"]=Ot).__name__="armory.logicnode.GetCameraFovNode",Ot.__super__=c,Ot.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?0:e.data.raw.fov},__class__:Ot});var Et=function(t){c.call(this,t)};(i["armory.logicnode.GetChildNode"]=Et).__name__="armory.logicnode.GetChildNode",Et.__super__=c,Et.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();if(null==e||null==i)return null;switch(this.property0){case"By Name":return e.getChild(i);case"Contains":return this.contains(e,i);case"Ends With":return this.endsWith(e,i);case"Starts With":return this.startsWith(e,i)}return null},contains:function(t,e){if(0<=t.name.indexOf(e))return t;for(var i=0,n=t.children;i<n.length;){var r=n[i];++i;var s=this.contains(r,e);if(null!=s)return s}return null},startsWith:function(t,e){if(q.startsWith(t.name,e))return t;for(var i=0,n=t.children;i<n.length;){var r=n[i];++i;var s=this.contains(r,e);if(null!=s)return s}return null},endsWith:function(t,e){if(q.endsWith(t.name,e))return t;for(var i=0,n=t.children;i<n.length;){var r=n[i];++i;var s=this.contains(r,e);if(null!=s)return s}return null},__class__:Et});var Mt=function(t){c.call(this,t)};(i["armory.logicnode.GetChildrenNode"]=Mt).__name__="armory.logicnode.GetChildrenNode",Mt.__super__=c,Mt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.children},__class__:Mt});var Lt=function(t){c.call(this,t)};(i["armory.logicnode.GetContactsNode"]=Lt).__name__="armory.logicnode.GetContactsNode",Lt.__super__=c,Lt.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:Lt});var At=function(t){c.call(this,t)};(i["armory.logicnode.GetDistanceNode"]=At).__name__="armory.logicnode.GetDistanceNode",At.__super__=c,At.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return null==e||null==i?0:bn.distance(e.transform.world.getLoc(),i.transform.world.getLoc())},__class__:At});var Bt=function(t){c.call(this,t)};(i["armory.logicnode.GetFirstContactNode"]=Bt).__name__="armory.logicnode.GetFirstContactNode",Bt.__super__=c,Bt.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:Bt});var Rt=function(t){c.call(this,t)};(i["armory.logicnode.GetGravityNode"]=Rt).__name__="armory.logicnode.GetGravityNode",Rt.__super__=c,Rt.prototype=r(c.prototype,{get:function(t){return null},__class__:Rt});var Ft=function(t){c.call(this,t)};(i["armory.logicnode.GetGroupNode"]=Ft).__name__="armory.logicnode.GetGroupNode",Ft.__super__=c,Ft.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return xr.active.groups.get(e)},__class__:Ft});var Pt=function(t){c.call(this,t)};(i["armory.logicnode.GetHaxePropertyNode"]=Pt).__name__="armory.logicnode.GetHaxePropertyNode",Pt.__super__=c,Pt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return null==e?null:V.getProperty(e,i)},__class__:Pt});var Dt=function(t){c.call(this,t)};(i["armory.logicnode.GetLocationNode"]=Dt).__name__="armory.logicnode.GetLocationNode",Dt.__super__=c,Dt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.world.getLoc()},__class__:Dt});var Wt=function(t){c.call(this,t)};(i["armory.logicnode.GetMaterialNode"]=Wt).__name__="armory.logicnode.GetMaterialNode",Wt.__super__=c,Wt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.materials[0]},__class__:Wt});var Vt=function(t){c.call(this,t)};(i["armory.logicnode.GetMeshNode"]=Vt).__name__="armory.logicnode.GetMeshNode",Vt.__super__=c,Vt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.data},__class__:Vt});var Ht=function(t){c.call(this,t)};(i["armory.logicnode.GetNameNode"]=Ht).__name__="armory.logicnode.GetNameNode",Ht.__super__=c,Ht.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?"":e.name},__class__:Ht});var zt=function(t){c.call(this,t)};(i["armory.logicnode.GetObjectNode"]=zt).__name__="armory.logicnode.GetObjectNode",zt.__super__=c,zt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return xr.active.getChild(e)},__class__:zt});var Gt=function(t){c.call(this,t)};(i["armory.logicnode.GetParentNode"]=Gt).__name__="armory.logicnode.GetParentNode",Gt.__super__=c,Gt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.parent},__class__:Gt});var Ut=function(t){c.call(this,t)};(i["armory.logicnode.GetPropertyNode"]=Ut).__name__="armory.logicnode.GetPropertyNode",Ut.__super__=c,Ut.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return null==e||null==e.properties?null:e.properties.get(i)},__class__:Ut});var jt=function(t){c.call(this,t)};(i["armory.logicnode.GetRotationNode"]=jt).__name__="armory.logicnode.GetRotationNode",jt.__super__=c,jt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.rot.getEuler()},__class__:jt});var Xt=function(t){c.call(this,t)};(i["armory.logicnode.GetScaleNode"]=Xt).__name__="armory.logicnode.GetScaleNode",Xt.__super__=c,Xt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.scale},__class__:Xt});var Yt=function(t){this.cname=null,c.call(this,t)};(i["armory.logicnode.GetTraitNode"]=Yt).__name__="armory.logicnode.GetTraitNode",Yt.__super__=c,Yt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return null==e?null:(null==this.cname&&(this.cname=J.resolveClass("arm."+i)),null==this.cname&&(this.cname=J.resolveClass("arm.node."+i)),e.getTrait(this.cname))},__class__:Yt});var Zt=function(t){c.call(this,t)};(i["armory.logicnode.GetTransformNode"]=Zt).__name__="armory.logicnode.GetTransformNode",Zt.__super__=c,Zt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.world},__class__:Zt});var Kt=function(t){c.call(this,t)};(i["armory.logicnode.GetVelocityNode"]=Kt).__name__="armory.logicnode.GetVelocityNode",Kt.__super__=c,Kt.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:Kt});var Qt=function(t){c.call(this,t)};(i["armory.logicnode.GetVisibleNode"]=Qt).__name__="armory.logicnode.GetVisibleNode",Qt.__super__=c,Qt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return e.visible},__class__:Qt});var qt=function(t){c.call(this,t)};(i["armory.logicnode.GlobalObjectNode"]=qt).__name__="armory.logicnode.GlobalObjectNode",qt.__super__=c,qt.prototype=r(c.prototype,{get:function(t){return xr.global},__class__:qt});var Jt=function(t){c.call(this,t)};(i["armory.logicnode.GoToLocationNode"]=Jt).__name__="armory.logicnode.GoToLocationNode",Jt.__super__=c,Jt.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&this.runOutput(0)},__class__:Jt});var $t=function(t){c.call(this,t)};(i["armory.logicnode.GroupNode"]=$t).__name__="armory.logicnode.GroupNode",$t.__super__=c,$t.prototype=r(c.prototype,{get:function(t){return xr.active.groups.get(this.property0)},__class__:$t});var te=function(t){c.call(this,t)};(i["armory.logicnode.GroupOutputNode"]=te).__name__="armory.logicnode.GroupOutputNode",te.__super__=c,te.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},__class__:te});var ee=function(t){c.call(this,t)};(i["armory.logicnode.HasContactNode"]=ee).__name__="armory.logicnode.HasContactNode",ee.__super__=c,ee.prototype=r(c.prototype,{get:function(t){this.inputs[0].get(),this.inputs[1].get();return!1},__class__:ee});var ie=function(t,e){null==e&&(e=0),c.call(this,t),this.value=e};(i["armory.logicnode.IntegerNode"]=ie).__name__="armory.logicnode.IntegerNode",ie.__super__=c,ie.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:ie});var ne=function(t){this.c=!1,c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.InverseNode"]=ne).__name__="armory.logicnode.InverseNode",ne.__super__=c,ne.prototype=r(c.prototype,{run:function(t){this.c=!0},update:function(){this.c||this.runOutput(0),this.c=!1},__class__:ne});var re=function(t){c.call(this,t)};(i["armory.logicnode.IsFalseNode"]=re).__name__="armory.logicnode.IsFalseNode",re.__super__=c,re.prototype=r(c.prototype,{run:function(t){this.inputs[1].get()||this.runOutput(0)},__class__:re});var se=function(t){c.call(this,t)};(i["armory.logicnode.IsNoneNode"]=se).__name__="armory.logicnode.IsNoneNode",se.__super__=c,se.prototype=r(c.prototype,{run:function(t){null==this.inputs[1].get()&&this.runOutput(0)},__class__:se});var ae=function(t){c.call(this,t)};(i["armory.logicnode.IsNotNoneNode"]=ae).__name__="armory.logicnode.IsNotNoneNode",ae.__super__=c,ae.prototype=r(c.prototype,{run:function(t){null!=this.inputs[1].get()&&this.runOutput(0)},__class__:ae});var oe=function(t){c.call(this,t)};(i["armory.logicnode.IsTrueNode"]=oe).__name__="armory.logicnode.IsTrueNode",oe.__super__=c,oe.prototype=r(c.prototype,{run:function(t){this.inputs[1].get()&&this.runOutput(0)},__class__:oe});var le=function(t){c.call(this,t)};(i["armory.logicnode.KeyboardNode"]=le).__name__="armory.logicnode.KeyboardNode",le.__super__=c,le.prototype=r(c.prototype,{get:function(t){var e=Jr.getKeyboard();switch(this.property0){case"Down":return e.down(this.property1);case"Released":return e.released(this.property1);case"Started":return e.started(this.property1)}return!1},__class__:le});var he=function(t,e){this.node=t,this.from=e};(i["armory.logicnode.LogicNodeInput"]=he).__name__="armory.logicnode.LogicNodeInput",he.prototype={get:function(){return this.node.get(this.from)},set:function(t){this.node.set(t)},__class__:he};var ue=function(){this.paused=!1,this.loopBreak=!1,u.call(this)};(i["armory.logicnode.LogicTree"]=ue).__name__="armory.logicnode.LogicTree",ue.__super__=u,ue.prototype=r(u.prototype,{add:function(){},pause:function(){if(!this.paused){if(this.paused=!0,null!=this._update)for(var t=0,e=this._update;t<e.length;){var i=e[t];++t,vr.removeUpdate(i)}if(null!=this._lateUpdate)for(var n=0,r=this._lateUpdate;n<r.length;){var s=r[n];++n,vr.removeLateUpdate(s)}}},resume:function(){if(this.paused){if(this.paused=!1,null!=this._update)for(var t=0,e=this._update;t<e.length;){var i=e[t];++t,vr.notifyOnUpdate(i)}if(null!=this._lateUpdate)for(var n=0,r=this._lateUpdate;n<r.length;){var s=r[n];++n,vr.notifyOnLateUpdate(s)}}},__class__:ue});var _e=function(t){this.q=new Sn,this.v2=new bn,this.v1=new bn,c.call(this,t)};(i["armory.logicnode.LookAtNode"]=_e).__name__="armory.logicnode.LookAtNode",_e.__super__=c,_e.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return null==e||null==i?null:(this.v1.set(0,0,1),this.v2.setFrom(i).sub(e).normalize(),this.q.fromTo(this.v1,this.v2),this.q.getEuler())},__class__:_e});var ce=function(t){c.call(this,t)};(i["armory.logicnode.LoopBreakNode"]=ce).__name__="armory.logicnode.LoopBreakNode",ce.__super__=c,ce.prototype=r(c.prototype,{run:function(t){this.tree.loopBreak=!0},__class__:ce});var de=function(t){c.call(this,t)};(i["armory.logicnode.LoopNode"]=de).__name__="armory.logicnode.LoopNode",de.__super__=c,de.prototype=r(c.prototype,{run:function(t){this.index=0;for(var e=this.inputs[1].get(),i=this.inputs[2].get();e<i;){var n=e++;if(this.index=n,this.runOutput(0),this.tree.loopBreak){this.tree.loopBreak=!1;break}}this.runOutput(2)},get:function(t){return this.index},__class__:de});var pe=function(t){this.value=null;var e=this;c.call(this,t),xr.active.notifyOnInit(function(){e.get(0)})};(i["armory.logicnode.MaterialNode"]=pe).__name__="armory.logicnode.MaterialNode",pe.__super__=c,pe.prototype=r(c.prototype,{get:function(t){var e=this;return null!=this.property0&&Tr.getMaterial(xr.active.raw.name,this.property0,function(t){e.value=t}),this.value},set:function(t){this.value=t},__class__:pe});var fe=function(t){c.call(this,t)};(i["armory.logicnode.MathNode"]=fe).__name__="armory.logicnode.MathNode",fe.__super__=c,fe.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get(),n=0;switch(this.property0){case"Abs":n=Math.abs(e);break;case"Add":n=e+i;break;case"Arccosine":n=Math.acos(e);break;case"Arcsine":n=Math.asin(e);break;case"Arctan2":n=Math.atan2(e,i);break;case"Arctangent":n=Math.atan(e);break;case"Ceil":n=Math.ceil(e);break;case"Cosine":n=Math.cos(e);break;case"Divide":n=e/i;break;case"Floor":n=Math.floor(e);break;case"Fract":n=Fr.fract(e);break;case"Greater Than":n=i<e?1:0;break;case"Less Than":n=e<i?1:0;break;case"Logarithm":n=Math.log(e);break;case"Max":n=Math.max(e,i);break;case"Min":n=Math.min(e,i);break;case"Modulo":n=e%i;break;case"Multiply":n=e*i;break;case"Power":n=Math.pow(e,i);break;case"Round":n=Math.round(e);break;case"Sine":n=Math.sin(e);break;case"Square Root":n=Math.sqrt(e);break;case"Subtract":n=e-i;break;case"Tangent":n=Math.tan(e)}return"true"==this.property1&&(n=n<0?0:1<n?1:n),n},__class__:fe});var ge=function(t){this.m=xn.identity(),c.call(this,t)};(i["armory.logicnode.MatrixMathNode"]=ge).__name__="armory.logicnode.MatrixMathNode",ge.__super__=c,ge.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return null==e||null==i?null:(this.m.setFrom(e),"Multiply"==this.property0&&this.m.multmat(i),this.m)},__class__:ge});var me=function(t){c.call(this,t)};(i["armory.logicnode.MergeNode"]=me).__name__="armory.logicnode.MergeNode",me.__super__=c,me.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},__class__:me});var ve=function(t){this.value=null;var e=this;c.call(this,t),xr.active.notifyOnInit(function(){e.get(0)})};(i["armory.logicnode.MeshNode"]=ve).__name__="armory.logicnode.MeshNode",ve.__super__=c,ve.prototype=r(c.prototype,{get:function(t){var e=this;return Tr.getMesh("mesh_"+this.property0,this.property0,function(t){e.value=t}),this.value},set:function(t){this.value=t},__class__:ve});var ye=function(t){this.ease=null,c.call(this,t)};(i["armory.logicnode.MixNode"]=ye).__name__="armory.logicnode.MixNode",ye.__super__=c,ye.prototype=r(c.prototype,{init:function(){switch(this.property0){case"Back":this.ease="In"==this.property1?hs.easeBackIn:"Out"==this.property1?hs.easeBackOut:hs.easeBackInOut;break;case"Circ":this.ease="In"==this.property1?hs.easeCircIn:"Out"==this.property1?hs.easeCircOut:hs.easeCircInOut;break;case"Cubic":this.ease="In"==this.property1?hs.easeCubicIn:"Out"==this.property1?hs.easeCubicOut:hs.easeCubicInOut;break;case"Expo":this.ease="In"==this.property1?hs.easeExpoIn:"Out"==this.property1?hs.easeExpoOut:hs.easeExpoInOut;break;case"Linear":this.ease=hs.easeLinear;break;case"Quad":this.ease="In"==this.property1?hs.easeQuadIn:"Out"==this.property1?hs.easeQuadOut:hs.easeQuadInOut;break;case"Quart":this.ease="In"==this.property1?hs.easeQuartIn:"Out"==this.property1?hs.easeQuartOut:hs.easeQuartInOut;break;case"Quint":this.ease="In"==this.property1?hs.easeQuintIn:"Out"==this.property1?hs.easeQuintOut:hs.easeQuintInOut;break;case"Sine":this.ease="In"==this.property1?hs.easeSineIn:"Out"==this.property1?hs.easeSineOut:hs.easeSineInOut;break;default:this.ease=hs.easeLinear}},get:function(t){null==this.ease&&this.init();var e=this.inputs[0].get(),i=this.inputs[1].get(),n=i+(this.inputs[2].get()-i)*this.ease(e);return"true"==this.property2&&(n=Fr.clamp(n,0,1)),n},__class__:ye});var we=function(t){this.coords=new bn,c.call(this,t)};(i["armory.logicnode.MouseCoordsNode"]=we).__name__="armory.logicnode.MouseCoordsNode",we.__super__=c,we.prototype=r(c.prototype,{get:function(t){var e=Jr.getMouse();return 0==t?(this.coords.x=e.x,this.coords.y=e.y,this.coords):1==t?(this.coords.x=e.movementX,this.coords.y=e.movementY,this.coords):e.wheelDelta},__class__:we});var be=function(t){c.call(this,t)};(i["armory.logicnode.MouseNode"]=be).__name__="armory.logicnode.MouseNode",be.__super__=c,be.prototype=r(c.prototype,{get:function(t){var e=Jr.getMouse();switch(this.property0){case"Down":return e.down(this.property1);case"Moved":return e.moved;case"Released":return e.released(this.property1);case"Started":return e.started(this.property1)}return!1},__class__:be});var xe=function(t){var e=this;c.call(this,t),xr.active.notifyOnInit(function(){e.get(0)})};(i["armory.logicnode.NavigableLocationNode"]=xe).__name__="armory.logicnode.NavigableLocationNode",xe.__super__=c,xe.prototype=r(c.prototype,{get:function(t){return this.loc},__class__:xe});var Se=function(t){c.call(this,t)};(i["armory.logicnode.NoneNode"]=Se).__name__="armory.logicnode.NoneNode",Se.__super__=c,Se.prototype=r(c.prototype,{get:function(t){return null},__class__:Se});var ke=function(t){c.call(this,t)};(i["armory.logicnode.NotNode"]=ke).__name__="armory.logicnode.NotNode",ke.__super__=c,ke.prototype=r(c.prototype,{get:function(t){return!this.inputs[0].get()},__class__:ke});var Te=function(t){c.call(this,t)};(i["armory.logicnode.NullNode"]=Te).__name__="armory.logicnode.NullNode",Te.__super__=c,Te.prototype=r(c.prototype,{get:function(t){return null},__class__:Te});var Ce=function(t,e){null==e&&(e=""),this.value=null,this.objectName=e,c.call(this,t)};(i["armory.logicnode.ObjectNode"]=Ce).__name__="armory.logicnode.ObjectNode",Ce.__super__=c,Ce.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():(null==this.value&&(this.value=""!=this.objectName?xr.active.getChild(this.objectName):this.tree.object),this.value)},set:function(t){0<this.inputs.length?this.inputs[0].set(t):(this.objectName=t.name,this.value=t)},__class__:Ce});var Ie=function(t){c.call(this,t),t.notifyOnInit(ko(this,this.init))};(i["armory.logicnode.OnActionMarkerNode"]=Ie).__name__="armory.logicnode.OnActionMarkerNode",Ie.__super__=c,Ie.prototype=r(c.prototype,{init:function(){var t=this,e=this.inputs[0].get(),i=this.inputs[1].get();if(null!=e){var n=e.animation;null==n&&(n=e.getParentArmature(e.name)),n.notifyOnMarker(i,function(){t.runOutput(0)})}},__class__:Ie});var Ne=function(t){this.lastContact=!1,c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnContactArrayNode"]=Ne).__name__="armory.logicnode.OnContactArrayNode",Ne.__super__=c,Ne.prototype=r(c.prototype,{update:function(){var t=this.inputs[0].get(),e=this.inputs[1].get();if(null==t&&(t=this.tree.object),null!=e){var i=!1;switch(this.property0){case"Begin":i=!1;break;case"End":i=this.lastContact;break;case"Overlap":i=!1}this.lastContact=!1,i&&this.runOutput(0)}},__class__:Ne});var Oe=function(t){this.lastContact=!1,c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnContactNode"]=Oe).__name__="armory.logicnode.OnContactNode",Oe.__super__=c,Oe.prototype=r(c.prototype,{update:function(){var t=this.inputs[0].get(),e=this.inputs[1].get();null==t&&(t=this.tree.object),null==e&&(e=this.tree.object);var i=!1;switch(this.property0){case"Begin":i=!1;break;case"End":i=this.lastContact;break;case"Overlap":i=!1}this.lastContact=!1,i&&this.runOutput(0)},__class__:Oe});var Ee=function(t){this.listener=null,c.call(this,t),t.notifyOnRemove(ko(this,this.onRemove))};(i["armory.logicnode.OnEventNode"]=Ee).__name__="armory.logicnode.OnEventNode",Ee.__super__=c,Ee.prototype=r(c.prototype,{get_property0:function(){return this._property0},set_property0:function(t){return this.listener=Un.add(t,ko(this,this.onEvent),this.tree.object.uid),this._property0=t},onEvent:function(){this.runOutput(0)},onRemove:function(){null!=this.listener&&Un.removeListener(this.listener)},__class__:Ee,__properties__:{set_property0:"set_property0",get_property0:"get_property0"}});var Me=function(t){c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnGamepadNode"]=Me).__name__="armory.logicnode.OnGamepadNode",Me.__super__=c,Me.prototype=r(c.prototype,{update:function(){var t=this.inputs[0].get(),e=Jr.getGamepad(t);if(null!=e){var i=!1;switch(this.property0){case"Down":i=0<e.down(this.property1);break;case"Released":i=e.released(this.property1);break;case"Started":i=e.started(this.property1)}i&&this.runOutput(0)}},__class__:Me});var Le=function(t){c.call(this,t),t.notifyOnInit(ko(this,this.init))};(i["armory.logicnode.OnInitNode"]=Le).__name__="armory.logicnode.OnInitNode",Le.__super__=c,Le.prototype=r(c.prototype,{init:function(){this.runOutput(0)},__class__:Le});var Ae=function(t){c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnKeyboardNode"]=Ae).__name__="armory.logicnode.OnKeyboardNode",Ae.__super__=c,Ae.prototype=r(c.prototype,{update:function(){var t=Jr.getKeyboard(),e=!1;switch(this.property0){case"Down":e=t.down(this.property1);break;case"Released":e=t.released(this.property1);break;case"Started":e=t.started(this.property1)}e&&this.runOutput(0)},__class__:Ae});var Be=function(t){c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnMouseNode"]=Be).__name__="armory.logicnode.OnMouseNode",Be.__super__=c,Be.prototype=r(c.prototype,{update:function(){var t=Jr.getMouse(),e=!1;switch(this.property0){case"Down":e=t.down(this.property1);break;case"Moved":e=t.moved;break;case"Released":e=t.released(this.property1);break;case"Started":e=t.started(this.property1)}e&&this.runOutput(0)},__class__:Be});var Re=function(t){c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnSurfaceNode"]=Re).__name__="armory.logicnode.OnSurfaceNode",Re.__super__=c,Re.prototype=r(c.prototype,{update:function(){var t=Jr.getSurface(),e=!1;switch(this.property0){case"Moved":e=t.moved;break;case"Released":e=t.released();break;case"Started":e=t.started();break;case"Touched":e=t.down()}e&&this.runOutput(0)},__class__:Re});var Fe=function(t){this.repeat=!1,this.duration=0,c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnTimerNode"]=Fe).__name__="armory.logicnode.OnTimerNode",Fe.__super__=c,Fe.prototype=r(c.prototype,{update:function(){this.duration<=0&&(this.duration=this.inputs[0].get(),this.repeat=this.inputs[1].get()),this.duration-=ls.get_delta(),this.duration<=0&&(this.repeat||this.tree.removeUpdate(ko(this,this.update)),this.runOutput(0))},__class__:Fe});var Pe=function(t){c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnUpdateNode"]=Pe).__name__="armory.logicnode.OnUpdateNode",Pe.__super__=c,Pe.prototype=r(c.prototype,{update:function(){this.runOutput(0)},__class__:Pe});var De=function(t){c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnVirtualButtonNode"]=De).__name__="armory.logicnode.OnVirtualButtonNode",De.__super__=c,De.prototype=r(c.prototype,{update:function(){var t=Jr.getVirtualButton(this.property1);if(null!=t){var e=!1;switch(this.property0){case"Down":e=t.down;break;case"Released":e=t.released;break;case"Started":e=t.started}e&&this.runOutput(0)}},__class__:De});var We=function(t){this.l2=new bn,this.l1=new bn,this.lastOverlap=!1,c.call(this,t),t.notifyOnUpdate(ko(this,this.update))};(i["armory.logicnode.OnVolumeTriggerNode"]=We).__name__="armory.logicnode.OnVolumeTriggerNode",We.__super__=c,We.prototype=r(c.prototype,{update:function(){var t=this.inputs[0].get(),e=this.inputs[1].get();if(null!=t){null==e&&(e=this.tree.object);var i=t.transform,n=e.transform;this.l1.set(i.worldx(),i.worldy(),i.worldz()),this.l2.set(n.worldx(),n.worldy(),n.worldz());var r=i.dim,s=n.dim,a=this.l1.x+r.x/2>this.l2.x-s.x/2&&this.l1.x-r.x/2<this.l2.x+s.x/2&&this.l1.y+r.y/2>this.l2.y-s.y/2&&this.l1.y-r.y/2<this.l2.y+s.y/2&&this.l1.z+r.z/2>this.l2.z-s.z/2&&this.l1.z-r.z/2<this.l2.z+s.z/2,o=!1;switch(this.property0){case"Enter":o=a&&!this.lastOverlap;break;case"Leave":o=!a&&this.lastOverlap;break;case"Overlap":o=a}this.lastOverlap=a,o&&this.runOutput(0)}},__class__:We});var Ve=function(t){c.call(this,t)};(i["armory.logicnode.PauseActionNode"]=Ve).__name__="armory.logicnode.PauseActionNode",Ve.__super__=c,Ve.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var i=e.animation;null==i&&(i=e.getParentArmature(e.name)),i.pause(),this.runOutput(0)}},__class__:Ve});var He=function(t){c.call(this,t)};(i["armory.logicnode.PauseSoundNode"]=He).__name__="armory.logicnode.PauseSoundNode",He.__super__=c,He.prototype=r(c.prototype,{run:function(t){var e=_s.__cast(this.inputs[1].get(),jr);null!=e&&(e.pause(),this.runOutput(0))},__class__:He});var ze=function(t){c.call(this,t)};(i["armory.logicnode.PauseTilesheetNode"]=ze).__name__="armory.logicnode.PauseTilesheetNode",ze.__super__=c,ze.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.tilesheet.pause(),this.runOutput(0))},__class__:ze});var Ge=function(t){c.call(this,t)};(i["armory.logicnode.PauseTraitNode"]=Ge).__name__="armory.logicnode.PauseTraitNode",Ge.__super__=c,Ge.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&e instanceof ue&&(_s.__cast(e,ue).pause(),this.runOutput(0))},__class__:Ge});var Ue=function(t){this.loc=new bn,c.call(this,t)};(i["armory.logicnode.PickLocationNode"]=Ue).__name__="armory.logicnode.PickLocationNode",Ue.__super__=c,Ue.prototype=r(c.prototype,{get:function(t){this.inputs[0].get(),this.inputs[1].get();return null},__class__:Ue});var je=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.PickObjectNode"]=je).__name__="armory.logicnode.PickObjectNode",je.__super__=c,je.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:je});var Xe=function(t){c.call(this,t)};(i["armory.logicnode.PlayActionNode"]=Xe).__name__="armory.logicnode.PlayActionNode",Xe.__super__=c,Xe.prototype=r(c.prototype,{run:function(t){var e=this,i=this.inputs[1].get(),n=this.inputs[2].get(),r=this.inputs[3].get();if(null!=i){var s=i.animation;null==s&&(s=i.getParentArmature(i.name)),s.play(n,function(){e.runOutput(1)},r),this.runOutput(0)}},__class__:Xe});var Ye=function(t){c.call(this,t)};(i["armory.logicnode.PlaySoundNode"]=Ye).__name__="armory.logicnode.PlaySoundNode",Ye.__super__=c,Ye.prototype=r(c.prototype,{run:function(t){var e=_s.__cast(this.inputs[1].get(),jr);null!=e&&(e.play(),this.runOutput(0))},__class__:Ye});var Ze=function(t){c.call(this,t)};(i["armory.logicnode.PlaySoundRawNode"]=Ze).__name__="armory.logicnode.PlaySoundRawNode",Ze.__super__=c,Ze.prototype=r(c.prototype,{run:function(t){Tr.getSound(this.property0,function(t){qr.play(t,!1)}),this.runOutput(0)},__class__:Ze});var Ke=function(t){c.call(this,t)};(i["armory.logicnode.PlayTilesheetNode"]=Ke).__name__="armory.logicnode.PlayTilesheetNode",Ke.__super__=c,Ke.prototype=r(c.prototype,{run:function(t){var e=this,i=this.inputs[1].get(),n=this.inputs[2].get();null!=i&&(i.tilesheet.play(n,function(){e.runOutput(1)}),this.runOutput(0))},__class__:Ke});var Qe=function(t){c.call(this,t)};(i["armory.logicnode.PrintNode"]=Qe).__name__="armory.logicnode.PrintNode",Qe.__super__=c,Qe.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();Jn.trace(e,{fileName:"Sources/armory/logicnode/PrintNode.hx",lineNumber:12,className:"armory.logicnode.PrintNode",methodName:"run"}),this.runOutput(0)},__class__:Qe});var qe=function(t,e,i,n,r){this.value=new Sn,c.call(this,t),null!=e&&(this.addInput(new St(t,e),0),this.addInput(new St(t,i),0),this.addInput(new St(t,n),0),this.addInput(new St(t,r),0))};(i["armory.logicnode.QuaternionNode"]=qe).__name__="armory.logicnode.QuaternionNode",qe.__super__=c,qe.prototype=r(c.prototype,{get:function(t){return this.value.x=this.inputs[0].get(),this.value.y=this.inputs[1].get(),this.value.z=this.inputs[2].get(),this.value.w=this.inputs[3].get(),this.value},set:function(t){this.value=t},__class__:qe});var Je=function(t){c.call(this,t)};(i["armory.logicnode.RadToDegNode"]=Je).__name__="armory.logicnode.RadToDegNode",Je.__super__=c,Je.prototype=r(c.prototype,{get:function(t){return 57.29578*this.inputs[0].get()},__class__:Je});var $e=function(t){c.call(this,t)};(i["armory.logicnode.RandomBooleanNode"]=$e).__name__="armory.logicnode.RandomBooleanNode",$e.__super__=c,$e.prototype=r(c.prototype,{get:function(t){return 0==pt.random(2)},__class__:$e});var ti=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.RandomColorNode"]=ti).__name__="armory.logicnode.RandomColorNode",ti.__super__=c,ti.prototype=r(c.prototype,{get:function(t){var e=Math.random(),i=Math.random(),n=Math.random();return this.v.set(e,i,n),this.v},__class__:ti});var ei=function(t){c.call(this,t)};(i["armory.logicnode.RandomFloatNode"]=ei).__name__="armory.logicnode.RandomFloatNode",ei.__super__=c,ei.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return e+Math.random()*(i-e)},__class__:ei});var ii=function(t){c.call(this,t)};(i["armory.logicnode.RandomIntegerNode"]=ii).__name__="armory.logicnode.RandomIntegerNode",ii.__super__=c,ii.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();return e+pt.random(i-e)},__class__:ii});var ni=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.RandomVectorNode"]=ni).__name__="armory.logicnode.RandomVectorNode",ni.__super__=c,ni.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get(),n=e.x+Math.random()*(i.x-e.x),r=e.y+Math.random()*(i.y-e.y),s=e.z+Math.random()*(i.z-e.z);return this.v.set(n,r,s),this.v},__class__:ni});var ri=function(t){c.call(this,t)};(i["armory.logicnode.ReadFileNode"]=ri).__name__="armory.logicnode.ReadFileNode",ri.__super__=c,ri.prototype=r(c.prototype,{run:function(t){var e=this,i=this.inputs[1].get();Tr.getBlob(i,function(t){e.data=t.toString(),e.runOutput(0)})},get:function(t){return this.data},__class__:ri});var si=function(t){c.call(this,t)};(i["armory.logicnode.ReadJsonNode"]=si).__name__="armory.logicnode.ReadJsonNode",si.__super__=c,si.prototype=r(c.prototype,{run:function(t){var i=this,e=this.inputs[1].get();Tr.getBlob(e,function(t){var e=t.toString();i.data=JSON.parse(e),i.runOutput(0)})},get:function(t){return this.data},__class__:si});var ai=function(t){c.call(this,t)};(i["armory.logicnode.ReadStorageNode"]=ai).__name__="armory.logicnode.ReadStorageNode",ai.parseArg=function(t){if("true"==t)return!0;if("false"==t)return!1;if("'"==t.charAt(0))return q.replace(t,"'","");if("["==t.charAt(0)){t=q.replace(t,"[",""),t=q.replace(t,"]","");for(var e=[],i=(t=q.replace(t," ","")).split(","),n=0;n<i.length;){var r=i[n];++n,e.push(ai.parseArg(r))}return e}var s=pt.parseFloat(t),a=pt.parseInt(t);return s==a?a:s},ai.__super__=c,ai.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=os.get_data();if(null==i)return null;var n=V.field(i,e);return null==n&&(n=ai.parseArg(this.inputs[1].get())),n},__class__:ai});var oi=function(t){c.call(this,t)};(i["armory.logicnode.RemoveActiveSceneNode"]=oi).__name__="armory.logicnode.RemoveActiveSceneNode",oi.__super__=c,oi.prototype=r(c.prototype,{run:function(t){xr.active.remove(),this.runOutput(0)},__class__:oi});var li=function(t){c.call(this,t)};(i["armory.logicnode.RemoveGroupNode"]=li).__name__="armory.logicnode.RemoveGroupNode",li.__super__=c,li.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();xr.active.groups.remove(e),this.runOutput(0)},__class__:li});var hi=function(t){c.call(this,t)};(i["armory.logicnode.RemoveObjectNode"]=hi).__name__="armory.logicnode.RemoveObjectNode",hi.__super__=c,hi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.remove(),this.runOutput(0))},__class__:hi});var ui=function(t){c.call(this,t)};(i["armory.logicnode.RemoveTraitNode"]=ui).__name__="armory.logicnode.RemoveTraitNode",ui.__super__=c,ui.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.remove(),this.runOutput(0))},__class__:ui});var _i=function(t){c.call(this,t)};(i["armory.logicnode.ResumeActionNode"]=_i).__name__="armory.logicnode.ResumeActionNode",_i.__super__=c,_i.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var i=e.animation;null==i&&(i=e.getParentArmature(e.name)),i.resume(),this.runOutput(0)}},__class__:_i});var ci=function(t){c.call(this,t)};(i["armory.logicnode.ResumeTilesheetNode"]=ci).__name__="armory.logicnode.ResumeTilesheetNode",ci.__super__=c,ci.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.tilesheet.resume(),this.runOutput(0))},__class__:ci});var di=function(t){c.call(this,t)};(i["armory.logicnode.ResumeTraitNode"]=di).__name__="armory.logicnode.ResumeTraitNode",di.__super__=c,di.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&e instanceof ue&&(_s.__cast(e,ue).resume(),this.runOutput(0))},__class__:di});var pi=function(t){this.q=new Sn,c.call(this,t)};(i["armory.logicnode.RotateObjectNode"]=pi).__name__="armory.logicnode.RotateObjectNode",pi.__super__=c,pi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(this.q.fromEuler(i.x,i.y,i.z),e.transform.rot.mult(this.q),e.transform.buildMatrix(),this.runOutput(0))},__class__:pi});var fi=function(t){c.call(this,t)};(i["armory.logicnode.ScaleObjectNode"]=fi).__name__="armory.logicnode.ScaleObjectNode",fi.__super__=c,fi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.scale.add(i),e.transform.buildMatrix(),this.runOutput(0))},__class__:fi});var gi=function(t){c.call(this,t)};(i["armory.logicnode.SceneNode"]=gi).__name__="armory.logicnode.SceneNode",gi.__super__=c,gi.prototype=r(c.prototype,{get:function(t){return this.property0},set:function(t){this.property0=t},__class__:gi});var mi=function(t){c.call(this,t)};(i["armory.logicnode.SceneRootNode"]=mi).__name__="armory.logicnode.SceneRootNode",mi.__super__=c,mi.prototype=r(c.prototype,{get:function(t){return xr.active.root},__class__:mi});var vi=function(t){this.m=xn.identity(),this.v=new bn,c.call(this,t)};(i["armory.logicnode.ScreenToWorldSpaceNode"]=vi).__name__="armory.logicnode.ScreenToWorldSpaceNode",vi.__super__=c,vi.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var i=xr.active.camera;return this.v.setFrom(e),this.m.getInverse(i.P),this.v.applyproj(this.m),this.m.getInverse(i.V),this.v.applyproj(this.m),this.v},__class__:vi});var yi=function(t){c.call(this,t)};(i["armory.logicnode.ScriptNode"]=yi).__name__="armory.logicnode.ScriptNode",yi.__super__=c,yi.prototype=r(c.prototype,{run:function(t){this.inputs[1].get();this.runOutput(0)},get:function(t){return this.result},__class__:yi});var wi=function(t){c.call(this,t)};(i["armory.logicnode.SelfNode"]=wi).__name__="armory.logicnode.SelfNode",wi.__super__=c,wi.prototype=r(c.prototype,{get:function(t){return this.tree.object},__class__:wi});var bi=function(t){c.call(this,t)};(i["armory.logicnode.SelfTraitNode"]=bi).__name__="armory.logicnode.SelfTraitNode",bi.__super__=c,bi.prototype=r(c.prototype,{get:function(t){return this.tree},__class__:bi});var xi=function(t){this.entries=null,c.call(this,t)};(i["armory.logicnode.SendEventNode"]=xi).__name__="armory.logicnode.SendEventNode",xi.__super__=c,xi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=2<this.inputs.length?this.inputs[2].get():this.tree.object;if(null!=i){var n=Un.get(e);if(null!=n){this.entries=[];for(var r=0;r<n.length;){var s=n[r];++r,s.mask==i.uid&&this.entries.push(s)}}if(null!=this.entries){for(var a=0,o=this.entries;a<o.length;){var l=o[a];++a,l.onEvent()}this.runOutput(0)}}},__class__:xi});var Si=function(t){this.entries=null,c.call(this,t)};(i["armory.logicnode.SendGlobalEventNode"]=Si).__name__="armory.logicnode.SendGlobalEventNode",Si.__super__=c,Si.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(this.entries=Un.get(e),null!=this.entries){for(var i=0,n=this.entries;i<n.length;){var r=n[i];++i,r.onEvent()}this.runOutput(0)}},__class__:Si});var ki=function(t){this.coords=new bn,c.call(this,t)};(i["armory.logicnode.SensorCoordsNode"]=ki).__name__="armory.logicnode.SensorCoordsNode",ki.__super__=c,ki.prototype=r(c.prototype,{get:function(t){var e=Jr.getSensor();return this.coords.x=e.x,this.coords.y=e.y,this.coords.z=e.z,this.coords},__class__:ki});var Ti=function(t){c.call(this,t)};(i["armory.logicnode.SeparateColorNode"]=Ti).__name__="armory.logicnode.SeparateColorNode",Ti.__super__=c,Ti.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?0:0==t?e.x:1==t?e.y:e.z},__class__:Ti});var Ci=function(t){c.call(this,t)};(i["armory.logicnode.SeparateTransformNode"]=Ci).__name__="armory.logicnode.SeparateTransformNode",Ci.__super__=c,Ci.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var i=new bn,n=new Sn,r=new bn;return e.decompose(i,n,r),0==t?i:1==t?n.getEuler():r},__class__:Ci});var Ii=function(t){c.call(this,t)};(i["armory.logicnode.SeparateVectorNode"]=Ii).__name__="armory.logicnode.SeparateVectorNode",Ii.__super__=c,Ii.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?0:0==t?e.x:1==t?e.y:e.z},__class__:Ii});var Ni=function(t){c.call(this,t)};(i["armory.logicnode.SequenceNode"]=Ni).__name__="armory.logicnode.SequenceNode",Ni.__super__=c,Ni.prototype=r(c.prototype,{run:function(t){for(var e=0,i=this.outputs.length;e<i;){var n=e++;this.runOutput(n)}},__class__:Ni});var Oi=function(t){c.call(this,t)};(i["armory.logicnode.SetActionSpeedNode"]=Oi).__name__="armory.logicnode.SetActionSpeedNode",Oi.__super__=c,Oi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();if(null!=e){var n=e.animation;null==n&&(n=e.getParentArmature(e.name)),n.speed=i,this.runOutput(0)}},__class__:Oi});var Ei=function(t){c.call(this,t)};(i["armory.logicnode.SetCameraFovNode"]=Ei).__name__="armory.logicnode.SetCameraFovNode",Ei.__super__=c,Ei.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&(e.data.raw.fov=i,e.buildProjection(),this.runOutput(0))},__class__:Ei});var Mi=function(t){c.call(this,t)};(i["armory.logicnode.SetCameraNode"]=Mi).__name__="armory.logicnode.SetCameraNode",Mi.__super__=c,Mi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.buildProjection(),xr.active.camera=e,this.runOutput(0))},__class__:Mi});var Li=function(t){c.call(this,t)};(i["armory.logicnode.SetGravityEnabledNode"]=Li).__name__="armory.logicnode.SetGravityEnabledNode",Li.__super__=c,Li.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();this.inputs[2].get();null!=e&&this.runOutput(0)},__class__:Li});var Ai=function(t){c.call(this,t)};(i["armory.logicnode.SetGravityNode"]=Ai).__name__="armory.logicnode.SetGravityNode",Ai.__super__=c,Ai.prototype=r(c.prototype,{run:function(t){null!=this.inputs[1].get()&&this.runOutput(0)},__class__:Ai});var Bi=function(t){c.call(this,t)};(i["armory.logicnode.SetHaxePropertyNode"]=Bi).__name__="armory.logicnode.SetHaxePropertyNode",Bi.__super__=c,Bi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get();null!=e&&(V.setProperty(e,i,n),this.runOutput(0))},__class__:Bi});var Ri=function(t){c.call(this,t)};(i["armory.logicnode.SetLightColorNode"]=Ri).__name__="armory.logicnode.SetLightColorNode",Ri.__super__=c,Ri.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&(e.data.raw.color[0]=i.x,e.data.raw.color[1]=i.y,e.data.raw.color[2]=i.z,this.runOutput(0))},__class__:Ri});var Fi=function(t){c.call(this,t)};(i["armory.logicnode.SetLightStrengthNode"]=Fi).__name__="armory.logicnode.SetLightStrengthNode",Fi.__super__=c,Fi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&(e.data.raw.strength="sun"==e.data.raw.type?.325*i:.026*i,this.runOutput(0))},__class__:Fi});var Pi=function(t){c.call(this,t)};(i["armory.logicnode.SetLocationNode"]=Pi).__name__="armory.logicnode.SetLocationNode",Pi.__super__=c,Pi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.loc.setFrom(i),e.transform.buildMatrix(),this.runOutput(0))},__class__:Pi});var Di=function(t){c.call(this,t),Di.registered||(Di.registered=!0,Kr.externalTextureLinks.push(Di.textureLink))};(i["armory.logicnode.SetMaterialImageParamNode"]=Di).__name__="armory.logicnode.SetMaterialImageParamNode",Di.textureLink=function(t,e,i){return Di.map.get(i)},Di.__super__=c,Di.prototype=r(c.prototype,{run:function(t){var e=this;Di.mat=this.inputs[1].get(),null!=Di.mat&&(Tr.getImage(this.inputs[3].get(),function(t){Di.map.set(e.inputs[2].get(),t)}),this.runOutput(0))},__class__:Di});var Wi=function(t){c.call(this,t)};(i["armory.logicnode.SetMaterialNode"]=Wi).__name__="armory.logicnode.SetMaterialNode",Wi.__super__=c,Wi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();if(null!=e){for(var n=0,r=e.materials.length;n<r;){var s=n++;e.materials[s]=i}this.runOutput(0)}},__class__:Wi});var Vi=function(t){c.call(this,t),Vi.registered||(Vi.registered=!0,Kr.externalVec3Links.push(Vi.vec3Link))};(i["armory.logicnode.SetMaterialRgbParamNode"]=Vi).__name__="armory.logicnode.SetMaterialRgbParamNode",Vi.vec3Link=function(t,e,i){return Vi.map.get(i)},Vi.__super__=c,Vi.prototype=r(c.prototype,{run:function(t){Vi.mat=this.inputs[1].get(),null!=Vi.mat&&(Vi.map.set(this.inputs[2].get(),this.inputs[3].get()),this.runOutput(0))},__class__:Vi});var Hi=function(t){c.call(this,t)};(i["armory.logicnode.SetMaterialSlotNode"]=Hi).__name__="armory.logicnode.SetMaterialSlotNode",Hi.__super__=c,Hi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get();null!=e&&(n>=e.materials.length||(e.materials[n]=i,this.runOutput(0)))},__class__:Hi});var zi=function(t){c.call(this,t),zi.registered||(zi.registered=!0,Kr.externalFloatLinks.push(zi.floatLink))};(i["armory.logicnode.SetMaterialValueParamNode"]=zi).__name__="armory.logicnode.SetMaterialValueParamNode",zi.floatLink=function(t,e,i){return zi.map.get(i)},zi.__super__=c,zi.prototype=r(c.prototype,{run:function(t){zi.mat=this.inputs[1].get(),null!=zi.mat&&(zi.map.set(this.inputs[2].get(),this.inputs[3].get()),this.runOutput(0))},__class__:zi});var Gi=function(t){c.call(this,t)};(i["armory.logicnode.SetMeshNode"]=Gi).__name__="armory.logicnode.SetMeshNode",Gi.__super__=c,Gi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&(e.data=i,this.runOutput(0))},__class__:Gi});var Ui=function(t){c.call(this,t)};(i["armory.logicnode.SetMouseLockNode"]=Ui).__name__="armory.logicnode.SetMouseLockNode",Ui.__super__=c,Ui.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=Jr.getMouse();e?i.lock():i.unlock(),this.runOutput(0)},__class__:Ui});var ji=function(t){c.call(this,t)};(i["armory.logicnode.SetNameNode"]=ji).__name__="armory.logicnode.SetNameNode",ji.__super__=c,ji.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&(e.name=i,this.runOutput(0))},__class__:ji});var Xi=function(t){c.call(this,t)};(i["armory.logicnode.SetParentBoneNode"]=Xi).__name__="armory.logicnode.SetParentBoneNode",Xi.__super__=c,Xi.prototype=r(c.prototype,{run:function(t){},__class__:Xi});var Yi=function(t){c.call(this,t)};(i["armory.logicnode.SetParentNode"]=Yi).__name__="armory.logicnode.SetParentNode",Yi.__super__=c,Yi.prototype=r(c.prototype,{run:function(t){var e,i=this.inputs[1].get(),n=!1;this.inputs[2].node instanceof Ce&&(n=""==_s.__cast(this.inputs[2].node,Ce).objectName);e=n?xr.active.root:this.inputs[2].get(),null!=i&&null!=e&&i.parent!=e&&(i.parent.removeChild(i,n),e.addChild(i,!n),this.runOutput(0))},__class__:Yi});var Zi=function(t){c.call(this,t)};(i["armory.logicnode.SetParticleSpeedNode"]=Zi).__name__="armory.logicnode.SetParticleSpeedNode",Zi.__super__=c,Zi.prototype=r(c.prototype,{run:function(t){},__class__:Zi});var Ki=function(t){c.call(this,t)};(i["armory.logicnode.SetPropertyNode"]=Ki).__name__="armory.logicnode.SetPropertyNode",Ki.__super__=c,Ki.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get();null!=e&&(null==e.properties&&(e.properties=new ur),e.properties.set(i,n),this.runOutput(0))},__class__:Ki});var Qi=function(t){c.call(this,t)};(i["armory.logicnode.SetRotationNode"]=Qi).__name__="armory.logicnode.SetRotationNode",Qi.__super__=c,Qi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.rot.fromEuler(i.x,i.y,i.z),e.transform.buildMatrix(),this.runOutput(0))},__class__:Qi});var qi=function(t){c.call(this,t)};(i["armory.logicnode.SetScaleNode"]=qi).__name__="armory.logicnode.SetScaleNode",qi.__super__=c,qi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.scale.setFrom(i),e.transform.buildMatrix(),this.runOutput(0))},__class__:qi});var Ji=function(t){c.call(this,t)};(i["armory.logicnode.SetSceneNode"]=Ji).__name__="armory.logicnode.SetSceneNode",Ji.__super__=c,Ji.prototype=r(c.prototype,{run:function(t){var e=this,i=this.inputs[1].get();xr.setActive(i,function(t){e.root=t,e.runOutput(0)})},get:function(t){return this.root},__class__:Ji});var $i=function(t){c.call(this,t)};(i["armory.logicnode.SetTimeScaleNode"]=$i).__name__="armory.logicnode.SetTimeScaleNode",$i.__super__=c,$i.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();ls.scale=e,this.runOutput(0)},__class__:$i});var tn=function(t){c.call(this,t)};(i["armory.logicnode.SetTransformNode"]=tn).__name__="armory.logicnode.SetTransformNode",tn.__super__=c,tn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.setMatrix(i),this.runOutput(0))},__class__:tn});var en=function(t){c.call(this,t)};(i["armory.logicnode.SetVariableNode"]=en).__name__="armory.logicnode.SetVariableNode",en.__super__=c,en.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1],i=this.inputs[2].get();e.set(i),this.runOutput(0)},__class__:en});var nn=function(t){c.call(this,t)};(i["armory.logicnode.SetVelocityNode"]=nn).__name__="armory.logicnode.SetVelocityNode",nn.__super__=c,nn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get(),r=this.inputs[4].get(),s=this.inputs[5].get();null!=e&&null!=i&&null!=n&&null!=r&&null!=s&&this.runOutput(0)},__class__:nn});var rn=function(t){c.call(this,t)};(i["armory.logicnode.SetVisibleNode"]=rn).__name__="armory.logicnode.SetVisibleNode",rn.__super__=c,rn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&(e.visible=i,this.runOutput(0))},__class__:rn});var sn=function(t){c.call(this,t)};(i["armory.logicnode.ShowMouseNode"]=sn).__name__="armory.logicnode.ShowMouseNode",sn.__super__=c,sn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=Jr.getMouse();e?i.show():i.hide(),this.runOutput(0)},__class__:sn});var an=function(t){c.call(this,t)};(i["armory.logicnode.ShutdownNode"]=an).__name__="armory.logicnode.ShutdownNode",an.__super__=c,an.prototype=r(c.prototype,{run:function(t){Us.stop()},__class__:an});var on=function(t){c.call(this,t)};(i["armory.logicnode.SleepNode"]=on).__name__="armory.logicnode.SleepNode",on.__super__=c,on.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();hs.timer(e,ko(this,this.done))},done:function(){this.runOutput(0)},__class__:on});var ln=function(t){this.matrices=[],c.call(this,t)};(i["armory.logicnode.SpawnObjectNode"]=ln).__name__="armory.logicnode.SpawnObjectNode",ln.__super__=c,ln.prototype=r(c.prototype,{run:function(t){var i=this,e="",n=this.inputs[1].get();""==(e=null==n?_s.__cast(this.inputs[1].node,Ce).objectName:n.name)&&(e=this.tree.object.name);var r=this.inputs[2].get();this.matrices.push(null!=r?r.clone():null);var s=!(3<this.inputs.length)||this.inputs[3].get();xr.active.spawnObject(e,null,function(t){i.object=t;var e=i.matrices.pop();null!=e&&i.object.transform.setMatrix(e),i.object.visible=!0,i.runOutput(0)},s)},get:function(t){return this.object},__class__:ln});var hn=function(t){c.call(this,t)};(i["armory.logicnode.SpawnSceneNode"]=hn).__name__="armory.logicnode.SpawnSceneNode",hn.__super__=c,hn.prototype=r(c.prototype,{run:function(t){var e=this,i=this.inputs[1].get(),n=this.inputs[2].get();this.root=xr.active.addObject(),this.root.name=i,null!=n&&(this.root.transform.setMatrix(n),this.root.transform.buildMatrix()),xr.active.addScene(i,this.root,function(t){e.runOutput(0)})},get:function(t){return this.root},__class__:hn});var un=function(t){c.call(this,t)};(i["armory.logicnode.StopAgentNode"]=un).__name__="armory.logicnode.StopAgentNode",un.__super__=c,un.prototype=r(c.prototype,{run:function(t){null!=this.inputs[1].get()&&this.runOutput(0)},__class__:un});var _n=function(t){c.call(this,t)};(i["armory.logicnode.StopSoundNode"]=_n).__name__="armory.logicnode.StopSoundNode",_n.__super__=c,_n.prototype=r(c.prototype,{run:function(t){var e=_s.__cast(this.inputs[1].get(),jr);null!=e&&(e.stop(),this.runOutput(0))},__class__:_n});var cn=function(t,e){null==e&&(e=""),c.call(this,t),this.value=e};(i["armory.logicnode.StringNode"]=cn).__name__="armory.logicnode.StringNode",cn.__super__=c,cn.prototype=r(c.prototype,{get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:cn});var dn=function(t){this.coords=new bn,c.call(this,t)};(i["armory.logicnode.SurfaceCoordsNode"]=dn).__name__="armory.logicnode.SurfaceCoordsNode",dn.__super__=c,dn.prototype=r(c.prototype,{get:function(t){var e=Jr.getSurface();return 0==t?(this.coords.x=e.x,this.coords.y=e.y,this.coords):1==t?(this.coords.x=e.movementX,this.coords.y=e.movementY,this.coords):e.wheelDelta},__class__:dn});var pn=function(t){c.call(this,t)};(i["armory.logicnode.SurfaceNode"]=pn).__name__="armory.logicnode.SurfaceNode",pn.__super__=c,pn.prototype=r(c.prototype,{get:function(t){var e=Jr.getSurface();switch(this.property0){case"Moved":return e.moved;case"Released":return ko(e,e.released);case"Started":return ko(e,e.started);case"Touched":return ko(e,e.down)}return!1},__class__:pn});var fn=function(t){c.call(this,t)};(i["armory.logicnode.SwitchNode"]=fn).__name__="armory.logicnode.SwitchNode",fn.__super__=c,fn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(2<this.inputs.length)for(var i=2,n=this.inputs.length;i<n;){var r=i++;if(this.inputs[r].get()==e)return void this.runOutput(r-1)}this.runOutput(0)},__class__:fn});var gn=function(t){c.call(this,t)};(i["armory.logicnode.TimeNode"]=gn).__name__="armory.logicnode.TimeNode",gn.__super__=c,gn.prototype=r(c.prototype,{get:function(t){return 0==t?ls.time():ls.get_delta()},__class__:gn});var mn=function(t){this.repetitions=0,this.running=!1,this.repeat=0,this.duration=0,this.time=0,c.call(this,t)};(i["armory.logicnode.TimerNode"]=mn).__name__="armory.logicnode.TimerNode",mn.__super__=c,mn.prototype=r(c.prototype,{update:function(){this.time+=ls.get_delta(),this.time>=this.duration&&(this.repeat--,this.runOutput(0),0!=this.repeat?(this.time=0,this.repetitions++):(this.removeUpdate(),this.runOutput(1)))},run:function(t){0==t?(this.duration=this.inputs[3].get(),this.repeat=this.inputs[4].get(),this.running||(this.running=!0,this.tree.notifyOnUpdate(ko(this,this.update)))):1==t?this.removeUpdate():(this.removeUpdate(),this.time=0,this.repetitions=0)},removeUpdate:function(){this.running&&(this.running=!1,this.tree.removeUpdate(ko(this,this.update)))},get:function(t){return 1==t?this.running:2==t?this.time:3==t?this.duration-this.time:4==t?this.time/this.duration:this.repetitions},__class__:mn});var vn=function(t){this.b=!1,c.call(this,t)};(i["armory.logicnode.ToBoolNode"]=vn).__name__="armory.logicnode.ToBoolNode",vn.__super__=c,vn.prototype=r(c.prototype,{run:function(t){this.b=!0},get:function(t){return this.value=this.b,this.b=!1,this.value},__class__:vn});var yn=function(t){this.value=null,c.call(this,t)};(i["armory.logicnode.TraitNode"]=yn).__name__="armory.logicnode.TraitNode",yn.__super__=c,yn.prototype=r(c.prototype,{get:function(t){if(null!=this.value)return this.value;var e=J.resolveClass("arm."+this.property0);return null==e&&(e=J.resolveClass("arm.node."+this.property0)),this.value=J.createInstance(e,[]),this.value},set:function(t){this.value=t},__class__:yn});var wn=function(t,e,i,n,r,s,a,o,l,h,u,_,c,d,p,f){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=h,this._22=u,this._32=_,this._03=c,this._13=d,this._23=p,this._33=f};(i["kha.math.FastMatrix4"]=wn).__name__="kha.math.FastMatrix4",wn.orthogonalProjection=function(t,e,i,n,r,s){return new wn(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},wn.prototype={__class__:wn};var bn=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n};(i["iron.math.Vec4"]=bn).__name__="iron.math.Vec4",bn.distance=function(t,e){return bn.distancef(t.x,t.y,t.z,e.x,e.y,e.z)},bn.distancef=function(t,e,i,n,r,s){var a=t-n,o=e-r,l=i-s;return Fr.sqrt(a*a+o*o+l*l)},bn.xAxis=function(){return new bn(1,0,0)},bn.yAxis=function(){return new bn(0,1,0)},bn.prototype={cross:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,a=t.z;return this.x=i*a-n*s,this.y=n*r-e*a,this.z=e*s-i*r,this},crossvecs:function(t,e){var i=t.x,n=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=n*o-r*a,this.y=r*s-i*o,this.z=i*a-n*s,this},set:function(t,e,i,n){return null==n&&(n=1),this.x=t,this.y=e,this.z=i,this.w=n,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addf:function(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this},addvecs:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},normalize:function(){var t=this.length();if(0<t){var e=1/t;this.x*=e,this.y*=e,this.z*=e}return this},mult:function(t){return this.x*=t,this.y*=t,this.z*=t,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},setFrom:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},lerp:function(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this},applyproj:function(t){var e=this.x,i=this.y,n=this.z,r=1/(t.get__03()*e+t.get__13()*i+t.get__23()*n+t.get__33());return this.x=(t.get__00()*e+t.get__10()*i+t.get__20()*n+t.get__30())*r,this.y=(t.get__01()*e+t.get__11()*i+t.get__21()*n+t.get__31())*r,this.z=(t.get__02()*e+t.get__12()*i+t.get__22()*n+t.get__32())*r,this},applymat4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return this.x=t.get__00()*e+t.get__10()*i+t.get__20()*n+t.get__30()*r,this.y=t.get__01()*e+t.get__11()*i+t.get__21()*n+t.get__31()*r,this.z=t.get__02()*e+t.get__12()*i+t.get__22()*n+t.get__32()*r,this.w=t.get__03()*e+t.get__13()*i+t.get__23()*n+t.get__33()*r,this},length:function(){return Fr.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},clamp:function(t,e){var i=this.length();return i<t?this.normalize().mult(t):e<i&&this.normalize().mult(e),this},__class__:bn};var xn=function(t,e,i,n,r,s,a,o,l,h,u,_,c,d,p,f){this.self=new wn(t,e,i,n,r,s,a,o,l,h,u,_,c,d,p,f)};(i["iron.math.Mat4"]=xn).__name__="iron.math.Mat4",xn.fromFloat32Array=function(t,e){return null==e&&(e=0),new xn(t[e],t[1+e],t[2+e],t[3+e],t[4+e],t[5+e],t[6+e],t[7+e],t[8+e],t[9+e],t[10+e],t[11+e],t[12+e],t[13+e],t[14+e],t[15+e])},xn.identity=function(){return new xn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},xn.persp=function(t,e,i,n){var r=1/Fr.tan(t/2);return new xn(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},xn.ortho=function(t,e,i,n,r,s){var a=e-t,o=n-i,l=s-r;return new xn(2/a,0,0,-(e+t)/a,0,2/o,0,-(n+i)/o,0,0,-2/l,-(s+r)/l,0,0,0,1)},xn.prototype={compose:function(t,e,i){return this.fromQuat(e),this.scale(i),this.setLoc(t),this},decompose:function(t,e,i){t.x=this.get__30(),t.y=this.get__31(),t.z=this.get__32(),i.x=xn.helpVec.set(this.get__00(),this.get__01(),this.get__02()).length(),i.y=xn.helpVec.set(this.get__10(),this.get__11(),this.get__12()).length(),i.z=xn.helpVec.set(this.get__20(),this.get__21(),this.get__22()).length();var n=this.self,r=n._12,s=n._22,a=n._32,o=n._13,l=n._23,h=n._33,u=n._11*(s*h-a*l)-n._21*(r*h-a*o)+n._31*(r*l-s*o),_=n._12,c=n._22,d=n._32,p=n._13,f=n._23,g=n._33,m=n._10*(c*g-d*f)-n._20*(_*g-d*p)+n._30*(_*f-c*p),v=n._11,y=n._21,w=n._31,b=n._13,x=n._23,S=n._33,k=n._10*(y*S-w*x)-n._20*(v*S-w*b)+n._30*(v*x-y*b),T=n._11,C=n._21,I=n._31,N=n._12,O=n._22,E=n._32,M=n._10*(C*E-I*O)-n._20*(T*E-I*N)+n._30*(T*O-C*N);n._00*u-n._01*m+n._02*k-n._03*M<0&&(i.x=-i.x);var L=1/i.x;return xn.helpMat.set__00(this.get__00()*L),xn.helpMat.set__01(this.get__01()*L),xn.helpMat.set__02(this.get__02()*L),L=1/i.y,xn.helpMat.set__10(this.get__10()*L),xn.helpMat.set__11(this.get__11()*L),xn.helpMat.set__12(this.get__12()*L),L=1/i.z,xn.helpMat.set__20(this.get__20()*L),xn.helpMat.set__21(this.get__21()*L),xn.helpMat.set__22(this.get__22()*L),e.fromRotationMat(xn.helpMat),this},setLoc:function(t){return this.set__30(t.x),this.set__31(t.y),this.set__32(t.z),this},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,r=t.w,s=e+e,a=i+i,o=n+n,l=e*s,h=e*a,u=e*o,_=i*a,c=i*o,d=n*o,p=r*s,f=r*a,g=r*o;return this.set__00(1-(_+d)),this.set__10(h-g),this.set__20(u+f),this.set__01(h+g),this.set__11(1-(l+d)),this.set__21(c-p),this.set__02(u-f),this.set__12(c+p),this.set__22(1-(l+_)),this.set__03(0),this.set__13(0),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},setIdentity:function(){return this.set__00(1),this.set__01(0),this.set__02(0),this.set__03(0),this.set__10(0),this.set__11(1),this.set__12(0),this.set__13(0),this.set__20(0),this.set__21(0),this.set__22(1),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},scale:function(t){var e=t.x,i=t.y,n=t.z;this.set__00(this.get__00()*e);this.set__01(this.get__01()*e);this.set__02(this.get__02()*e);this.set__03(this.get__03()*e);this.set__10(this.get__10()*i);this.set__11(this.get__11()*i);this.set__12(this.get__12()*i);this.set__13(this.get__13()*i);this.set__20(this.get__20()*n);this.set__21(this.get__21()*n);this.set__22(this.get__22()*n);return this.set__23(this.get__23()*n),this},multmats3x4:function(t,e){var i=t.get__00(),n=t.get__01(),r=t.get__02(),s=t.get__03(),a=t.get__10(),o=t.get__11(),l=t.get__12(),h=t.get__13(),u=t.get__20(),_=t.get__21(),c=t.get__22(),d=t.get__23(),p=t.get__30(),f=t.get__31(),g=t.get__32(),m=t.get__33(),v=e.get__00(),y=e.get__10(),w=e.get__20(),b=e.get__30();return this.set__00(i*v+n*y+r*w+s*b),this.set__10(a*v+o*y+l*w+h*b),this.set__20(u*v+_*y+c*w+d*b),this.set__30(p*v+f*y+g*w+m*b),v=e.get__01(),y=e.get__11(),w=e.get__21(),b=e.get__31(),this.set__01(i*v+n*y+r*w+s*b),this.set__11(a*v+o*y+l*w+h*b),this.set__21(u*v+_*y+c*w+d*b),this.set__31(p*v+f*y+g*w+m*b),v=e.get__02(),y=e.get__12(),w=e.get__22(),b=e.get__32(),this.set__02(i*v+n*y+r*w+s*b),this.set__12(a*v+o*y+l*w+h*b),this.set__22(u*v+_*y+c*w+d*b),this.set__32(p*v+f*y+g*w+m*b),this.set__03(0),this.set__13(0),this.set__23(0),this.set__33(1),this},multmats:function(t,e){var i=e.get__00(),n=e.get__01(),r=e.get__02(),s=e.get__03(),a=e.get__10(),o=e.get__11(),l=e.get__12(),h=e.get__13(),u=e.get__20(),_=e.get__21(),c=e.get__22(),d=e.get__23(),p=e.get__30(),f=e.get__31(),g=e.get__32(),m=e.get__33(),v=t.get__00(),y=t.get__10(),w=t.get__20(),b=t.get__30();return this.set__00(i*v+n*y+r*w+s*b),this.set__10(a*v+o*y+l*w+h*b),this.set__20(u*v+_*y+c*w+d*b),this.set__30(p*v+f*y+g*w+m*b),v=t.get__01(),y=t.get__11(),w=t.get__21(),b=t.get__31(),this.set__01(i*v+n*y+r*w+s*b),this.set__11(a*v+o*y+l*w+h*b),this.set__21(u*v+_*y+c*w+d*b),this.set__31(p*v+f*y+g*w+m*b),v=t.get__02(),y=t.get__12(),w=t.get__22(),b=t.get__32(),this.set__02(i*v+n*y+r*w+s*b),this.set__12(a*v+o*y+l*w+h*b),this.set__22(u*v+_*y+c*w+d*b),this.set__32(p*v+f*y+g*w+m*b),v=t.get__03(),y=t.get__13(),w=t.get__23(),b=t.get__33(),this.set__03(i*v+n*y+r*w+s*b),this.set__13(a*v+o*y+l*w+h*b),this.set__23(u*v+_*y+c*w+d*b),this.set__33(p*v+f*y+g*w+m*b),this},multmat:function(t){var e=this.get__00(),i=this.get__01(),n=this.get__02(),r=this.get__03(),s=this.get__10(),a=this.get__11(),o=this.get__12(),l=this.get__13(),h=this.get__20(),u=this.get__21(),_=this.get__22(),c=this.get__23(),d=this.get__30(),p=this.get__31(),f=this.get__32(),g=this.get__33(),m=t.get__00(),v=t.get__10(),y=t.get__20(),w=t.get__30();return this.set__00(e*m+i*v+n*y+r*w),this.set__10(s*m+a*v+o*y+l*w),this.set__20(h*m+u*v+_*y+c*w),this.set__30(d*m+p*v+f*y+g*w),m=t.get__01(),v=t.get__11(),y=t.get__21(),w=t.get__31(),this.set__01(e*m+i*v+n*y+r*w),this.set__11(s*m+a*v+o*y+l*w),this.set__21(h*m+u*v+_*y+c*w),this.set__31(d*m+p*v+f*y+g*w),m=t.get__02(),v=t.get__12(),y=t.get__22(),w=t.get__32(),this.set__02(e*m+i*v+n*y+r*w),this.set__12(s*m+a*v+o*y+l*w),this.set__22(h*m+u*v+_*y+c*w),this.set__32(d*m+p*v+f*y+g*w),m=t.get__03(),v=t.get__13(),y=t.get__23(),w=t.get__33(),this.set__03(e*m+i*v+n*y+r*w),this.set__13(s*m+a*v+o*y+l*w),this.set__23(h*m+u*v+_*y+c*w),this.set__33(d*m+p*v+f*y+g*w),this},getInverse:function(t){var e=t.get__00(),i=t.get__01(),n=t.get__02(),r=t.get__03(),s=t.get__10(),a=t.get__11(),o=t.get__12(),l=t.get__13(),h=t.get__20(),u=t.get__21(),_=t.get__22(),c=t.get__23(),d=t.get__30(),p=t.get__31(),f=t.get__32(),g=t.get__33(),m=e*a-i*s,v=e*o-n*s,y=e*l-r*s,w=i*o-n*a,b=i*l-r*a,x=n*l-r*o,S=h*p-u*d,k=h*f-_*d,T=h*g-c*d,C=u*f-_*p,I=u*g-c*p,N=_*g-c*f,O=m*N-v*I+y*C+w*T-b*k+x*S;return 0==O?this.setIdentity():(O=1/O,this.set__00((a*N-o*I+l*C)*O),this.set__01((n*I-i*N-r*C)*O),this.set__02((p*x-f*b+g*w)*O),this.set__03((_*b-u*x-c*w)*O),this.set__10((o*T-s*N-l*k)*O),this.set__11((e*N-n*T+r*k)*O),this.set__12((f*y-d*x-g*v)*O),this.set__13((h*x-_*y+c*v)*O),this.set__20((s*I-a*T+l*S)*O),this.set__21((i*T-e*I-r*S)*O),this.set__22((d*b-p*y+g*m)*O),this.set__23((u*y-h*b-c*m)*O),this.set__30((a*k-s*C-o*S)*O),this.set__31((e*C-i*k+n*S)*O),this.set__32((p*v-d*w-f*m)*O),this.set__33((h*w-u*v+_*m)*O),this)},transpose:function(){var t=this.get__01();return this.set__01(this.get__10()),this.set__10(t),t=this.get__02(),this.set__02(this.get__20()),this.set__20(t),t=this.get__03(),this.set__03(this.get__30()),this.set__30(t),t=this.get__12(),this.set__12(this.get__21()),this.set__21(t),t=this.get__13(),this.set__13(this.get__31()),this.set__31(t),t=this.get__23(),this.set__23(this.get__32()),this.set__32(t),this},transpose3x3:function(){var t=this.get__01();return this.set__01(this.get__10()),this.set__10(t),t=this.get__02(),this.set__02(this.get__20()),this.set__20(t),t=this.get__12(),this.set__12(this.get__21()),this.set__21(t),this},clone:function(){return new xn(this.get__00(),this.get__10(),this.get__20(),this.get__30(),this.get__01(),this.get__11(),this.get__21(),this.get__31(),this.get__02(),this.get__12(),this.get__22(),this.get__32(),this.get__03(),this.get__13(),this.get__23(),this.get__33())},setF32:function(t,e){return null==e&&(e=0),this.set__00(t[e]),this.set__10(t[1+e]),this.set__20(t[2+e]),this.set__30(t[3+e]),this.set__01(t[4+e]),this.set__11(t[5+e]),this.set__21(t[6+e]),this.set__31(t[7+e]),this.set__02(t[8+e]),this.set__12(t[9+e]),this.set__22(t[10+e]),this.set__32(t[11+e]),this.set__03(t[12+e]),this.set__13(t[13+e]),this.set__23(t[14+e]),this.set__33(t[15+e]),this},setFrom:function(t){return this.set__00(t.get__00()),this.set__01(t.get__01()),this.set__02(t.get__02()),this.set__03(t.get__03()),this.set__10(t.get__10()),this.set__11(t.get__11()),this.set__12(t.get__12()),this.set__13(t.get__13()),this.set__20(t.get__20()),this.set__21(t.get__21()),this.set__22(t.get__22()),this.set__23(t.get__23()),this.set__30(t.get__30()),this.set__31(t.get__31()),this.set__32(t.get__32()),this.set__33(t.get__33()),this},getLoc:function(){return new bn(this.get__30(),this.get__31(),this.get__32(),this.get__33())},getScale:function(){return new bn(Fr.sqrt(this.get__00()*this.get__00()+this.get__10()*this.get__10()+this.get__20()*this.get__20()),Fr.sqrt(this.get__01()*this.get__01()+this.get__11()*this.get__11()+this.get__21()*this.get__21()),Fr.sqrt(this.get__02()*this.get__02()+this.get__12()*this.get__12()+this.get__22()*this.get__22()))},toRotation:function(){var t=1/xn.helpVec.set(this.get__00(),this.get__01(),this.get__02()).length();return this.set__00(this.get__00()*t),this.set__01(this.get__01()*t),this.set__02(this.get__02()*t),t=1/xn.helpVec.set(this.get__10(),this.get__11(),this.get__12()).length(),this.set__10(this.get__10()*t),this.set__11(this.get__11()*t),this.set__12(this.get__12()*t),t=1/xn.helpVec.set(this.get__20(),this.get__21(),this.get__22()).length(),this.set__20(this.get__20()*t),this.set__21(this.get__21()*t),this.set__22(this.get__22()*t),this.set__03(0),this.set__13(0),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},setLookAt:function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=1/Fr.sqrt(n*n+r*r+s*s);n*=a,s*=a;var o=(r*=a)*i.z-s*i.y,l=s*i.x-n*i.z,h=n*i.y-r*i.x,u=(l*=a=1/Fr.sqrt(o*o+l*l+h*h))*s-(h*=a)*r,_=h*n-(o*=a)*s,c=o*r-l*n,d=-t.x*o-t.y*l-t.z*h,p=-t.x*u-t.y*_-t.z*c,f=t.x*n+t.y*r+t.z*s;return this.set__00(o),this.set__10(l),this.set__20(h),this.set__30(d),this.set__01(u),this.set__11(_),this.set__21(c),this.set__31(p),this.set__02(-n),this.set__12(-r),this.set__22(-s),this.set__32(f),this.set__03(0),this.set__13(0),this.set__23(0),this.set__33(1),this},right:function(){return new bn(this.get__00(),this.get__01(),this.get__02())},up:function(){return new bn(this.get__20(),this.get__21(),this.get__22())},look:function(){return new bn(this.get__10(),this.get__11(),this.get__12())},get__00:function(){return this.self._00},set__00:function(t){return this.self._00=t},get__01:function(){return this.self._01},set__01:function(t){return this.self._01=t},get__02:function(){return this.self._02},set__02:function(t){return this.self._02=t},get__03:function(){return this.self._03},set__03:function(t){return this.self._03=t},get__10:function(){return this.self._10},set__10:function(t){return this.self._10=t},get__11:function(){return this.self._11},set__11:function(t){return this.self._11=t},get__12:function(){return this.self._12},set__12:function(t){return this.self._12=t},get__13:function(){return this.self._13},set__13:function(t){return this.self._13=t},get__20:function(){return this.self._20},set__20:function(t){return this.self._20=t},get__21:function(){return this.self._21},set__21:function(t){return this.self._21=t},get__22:function(){return this.self._22},set__22:function(t){return this.self._22=t},get__23:function(){return this.self._23},set__23:function(t){return this.self._23=t},get__30:function(){return this.self._30},set__30:function(t){return this.self._30=t},get__31:function(){return this.self._31},set__31:function(t){return this.self._31=t},get__32:function(){return this.self._32},set__32:function(t){return this.self._32=t},get__33:function(){return this.self._33},set__33:function(t){return this.self._33=t},__class__:xn,__properties__:{set__33:"set__33",get__33:"get__33",set__32:"set__32",get__32:"get__32",set__31:"set__31",get__31:"get__31",set__30:"set__30",get__30:"get__30",set__23:"set__23",get__23:"get__23",set__22:"set__22",get__22:"get__22",set__21:"set__21",get__21:"get__21",set__20:"set__20",get__20:"get__20",set__13:"set__13",get__13:"get__13",set__12:"set__12",get__12:"get__12",set__11:"set__11",get__11:"get__11",set__10:"set__10",get__10:"get__10",set__03:"set__03",get__03:"get__03",set__02:"set__02",get__02:"get__02",set__01:"set__01",get__01:"get__01",set__00:"set__00",get__00:"get__00"}};var Sn=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n};(i["iron.math.Quat"]=Sn).__name__="iron.math.Quat",Sn.prototype={set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},fromAxisAngle:function(t,e){var i=Fr.sin(.5*e);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=Fr.cos(.5*e),this.normalize()},fromMat:function(t){return Sn.helpMat.setFrom(t),Sn.helpMat.toRotation(),this.fromRotationMat(Sn.helpMat)},fromRotationMat:function(t){var e=t.get__00(),i=t.get__10(),n=t.get__20(),r=t.get__01(),s=t.get__11(),a=t.get__21(),o=t.get__02(),l=t.get__12(),h=t.get__22(),u=e+s+h,_=0;return 0<u?(_=.5/Fr.sqrt(u+1),this.w=.25/_,this.x=(l-a)*_,this.y=(n-o)*_,this.z=(r-i)*_):s<e&&h<e?(_=2*Fr.sqrt(1+e-s-h),this.w=(l-a)/_,this.x=.25*_,this.y=(i+r)/_,this.z=(n+o)/_):h<s?(_=2*Fr.sqrt(1+s-e-h),this.w=(n-o)/_,this.x=(i+r)/_,this.y=.25*_,this.z=(a+l)/_):(_=2*Fr.sqrt(1+h-e-s),this.w=(r-i)/_,this.x=(n+o)/_,this.y=(a+l)/_,this.z=.25*_),this},mult:function(t){return this.multquats(this,t)},multquats:function(t,e){var i=t.x,n=t.y,r=t.z,s=t.w,a=e.x,o=e.y,l=e.z,h=e.w;return this.x=i*h+s*a+n*l-r*o,this.y=s*o-i*l+n*h+r*a,this.z=s*l+i*o-n*a+r*h,this.w=s*h-i*a-n*o-r*l,this},normalize:function(){var t=Fr.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0==t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},getEuler:function(){var t=Fr.get_NaN(),e=0,i=0,n=this.x*this.y+this.z*this.w;if(.499<n&&(t=2*Fr.atan2(this.x,this.w),e=1.5707963267948966,i=0),n<-.499&&(t=-2*Fr.atan2(this.x,this.w),e=-1.5707963267948966,i=0),Fr.isNaN(t)){var r=2*this.z*this.z,s=this.y*this.y;t=Fr.atan2(2*this.y*this.w-2*this.x*this.z,1-2*s-r),s=this.x*this.x,i=Fr.atan2(2*this.x*this.w-2*this.y*this.z,1-2*s-r),e=Fr.asin(2*n)}return new bn(i,t,e)},fromEuler:function(t,e,i){var n=t/2,r=Fr.cos(n),s=Fr.sin(n);n=e/2;var a=Fr.cos(n),o=Fr.sin(n);n=i/2;var l=Fr.cos(n),h=Fr.sin(n);return this.x=s*a*l+r*o*h,this.y=r*o*l+s*a*h,this.z=r*a*h-s*o*l,this.w=r*a*l-s*o*h,this},lerp:function(t,e,i){var n=t.x,r=t.y,s=t.z,a=t.w;return t.dot(e)<0&&(n=-n,r=-r,s=-s,a=-a),this.x=n+(e.x-n)*i,this.y=r+(e.y-r)*i,this.z=s+(e.z-s)*i,this.w=a+(e.w-a)*i,this.normalize()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},fromTo:function(t,e){var i=Sn.helpVec0,n=t.dot(e);return n<-.999999?(i.crossvecs(Sn.xAxis,t),i.length()<1e-6&&i.crossvecs(Sn.yAxis,t),i.normalize(),this.fromAxisAngle(i,3.141592653589793)):.999999<n?this.set(0,0,0,1):(i.crossvecs(t,e),this.set(i.x,i.y,i.z,1+n),this.normalize()),this},__class__:Sn};var kn=function(t){this.value=xn.identity(),c.call(this,t)};(i["armory.logicnode.TransformNode"]=kn).__name__="armory.logicnode.TransformNode",kn.__super__=c,kn.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get(),n=this.inputs[2].get();return null==e||null==i||null==n?null:(kn.q.fromEuler(i.x,i.y,i.z),this.value.compose(e,kn.q,n),this.value)},set:function(t){_s.__cast(t,xn).decompose(kn.v1,kn.q,kn.v2),this.inputs[0].set(kn.v1),this.inputs[1].set(kn.q.getEuler()),this.inputs[2].set(kn.v2)},__class__:kn});var Tn=function(t){c.call(this,t)};(i["armory.logicnode.TranslateObjectNode"]=Tn).__name__="armory.logicnode.TranslateObjectNode",Tn.__super__=c,Tn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get();null!=e&&null!=i&&(e.transform.loc.add(i),e.transform.buildMatrix(),this.runOutput(0))},__class__:Tn});var Cn=function(t){this.vec=new bn,this.loc=new bn,c.call(this,t)};(i["armory.logicnode.TranslateOnLocalAxisNode"]=Cn).__name__="armory.logicnode.TranslateOnLocalAxisNode",Cn.__super__=c,Cn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=this.inputs[3].get(),r=this.inputs[4].get();null!=e&&(1==n?this.loc.setFrom(e.transform.world.look()):2==n?this.loc.setFrom(e.transform.world.up()):3==n&&this.loc.setFrom(e.transform.world.right()),r&&(this.loc.x=-this.loc.x,this.loc.y=-this.loc.y,this.loc.z=-this.loc.z),this.vec.x=this.loc.x*i,this.vec.y=this.loc.y*i,this.vec.z=this.loc.z*i,e.transform.loc.add(this.vec),e.transform.buildMatrix(),this.runOutput(0))},__class__:Cn});var In=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.VectorClampToSizeNode"]=In).__name__="armory.logicnode.VectorClampToSizeNode",In.__super__=c,In.prototype=r(c.prototype,{get:function(t){this.v=this.inputs[0].get();var e=this.inputs[1].get(),i=this.inputs[2].get();return this.v.clamp(e,i),this.v},__class__:In});var Nn=function(t){c.call(this,t)};(i["armory.logicnode.VectorFromTransformNode"]=Nn).__name__="armory.logicnode.VectorFromTransformNode",Nn.__super__=c,Nn.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;switch(this.property0){case"Look":return e.look();case"Quaternion":return(new Sn).fromMat(e);case"Right":return e.right();case"Up":return e.up()}return null},__class__:Nn});var On=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.VectorMathNode"]=On).__name__="armory.logicnode.VectorMathNode",On.__super__=c,On.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();if(null==e||null==i)return null;this.v.setFrom(e);var n=0;switch(this.property0){case"Add":this.v.add(i);break;case"Average":this.v.add(i),this.v.x*=.5,this.v.y*=.5,this.v.z*=.5;break;case"Cross Product":this.v.cross(i);break;case"Dot Product":n=this.v.dot(i),this.v.set(n,n,n);break;case"Length":n=this.v.length();break;case"Multiply":this.v.x*=i.x,this.v.y*=i.y,this.v.z*=i.z;break;case"Normalize":this.v.normalize();break;case"Subtract":this.v.sub(i)}return 0==t?this.v:n},__class__:On});var En=function(t){this.ease=null,this.v=new bn,c.call(this,t)};(i["armory.logicnode.VectorMixNode"]=En).__name__="armory.logicnode.VectorMixNode",En.__super__=c,En.prototype=r(c.prototype,{init:function(){switch(this.property0){case"Back":this.ease="In"==this.property1?hs.easeBackIn:"Out"==this.property1?hs.easeBackOut:hs.easeBackInOut;break;case"Circ":this.ease="In"==this.property1?hs.easeCircIn:"Out"==this.property1?hs.easeCircOut:hs.easeCircInOut;break;case"Cubic":this.ease="In"==this.property1?hs.easeCubicIn:"Out"==this.property1?hs.easeCubicOut:hs.easeCubicInOut;break;case"Expo":this.ease="In"==this.property1?hs.easeExpoIn:"Out"==this.property1?hs.easeExpoOut:hs.easeExpoInOut;break;case"Linear":this.ease=hs.easeLinear;break;case"Quad":this.ease="In"==this.property1?hs.easeQuadIn:"Out"==this.property1?hs.easeQuadOut:hs.easeQuadInOut;break;case"Quart":this.ease="In"==this.property1?hs.easeQuartIn:"Out"==this.property1?hs.easeQuartOut:hs.easeQuartInOut;break;case"Quint":this.ease="In"==this.property1?hs.easeQuintIn:"Out"==this.property1?hs.easeQuintOut:hs.easeQuintInOut;break;case"Sine":this.ease="In"==this.property1?hs.easeSineIn:"Out"==this.property1?hs.easeSineOut:hs.easeSineInOut;break;default:this.ease=hs.easeLinear}},get:function(t){null==this.ease&&this.init();var e=this.inputs[0].get(),i=this.inputs[1].get(),n=this.inputs[2].get();if(null==i||null==n)return null;var r=this.ease(e);return this.v.x=i.x+(n.x-i.x)*r,this.v.y=i.y+(n.y-i.y)*r,this.v.z=i.z+(n.z-i.z)*r,"true"==this.property2&&this.v.clamp(0,1),this.v},__class__:En});var Mn=function(t,e,i,n){this.value=new bn,c.call(this,t),null!=e&&(this.addInput(new St(t,e),0),this.addInput(new St(t,i),0),this.addInput(new St(t,n),0))};(i["armory.logicnode.VectorNode"]=Mn).__name__="armory.logicnode.VectorNode",Mn.__super__=c,Mn.prototype=r(c.prototype,{get:function(t){return this.value.x=this.inputs[0].get(),this.value.y=this.inputs[1].get(),this.value.z=this.inputs[2].get(),this.value},set:function(t){this.inputs[0].set(t.x),this.inputs[1].set(t.y),this.inputs[2].set(t.z)},__class__:Mn});var Ln=function(t){c.call(this,t)};(i["armory.logicnode.VirtualButtonNode"]=Ln).__name__="armory.logicnode.VirtualButtonNode",Ln.__super__=c,Ln.prototype=r(c.prototype,{get:function(t){var e=Jr.getVirtualButton(this.property1);if(null==e)return!1;switch(this.property0){case"Down":return e.down;case"Released":return e.released;case"Started":return e.started}return!1},__class__:Ln});var An=function(t){this.lastOverlap=!1,c.call(this,t)};(i["armory.logicnode.VolumeTriggerNode"]=An).__name__="armory.logicnode.VolumeTriggerNode",An.__super__=c,An.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),i=this.inputs[1].get();if(null==e)return!1;null==i&&(i=this.tree.object);var n=e.transform,r=i.transform,s=n.overlap(r),a=!1;switch(this.property0){case"Enter":a=s&&!this.lastOverlap;break;case"Leave":a=!s&&this.lastOverlap;break;case"Overlap":a=s}return this.lastOverlap=s,a},__class__:An});var Bn=function(t){c.call(this,t)};(i["armory.logicnode.WhileNode"]=Bn).__name__="armory.logicnode.WhileNode",Bn.__super__=c,Bn.prototype=r(c.prototype,{run:function(t){for(var e=this.inputs[1].get();e;)if(this.runOutput(0),e=this.inputs[1].get(),this.tree.loopBreak){this.tree.loopBreak=!1;break}this.runOutput(1)},__class__:Bn});var Rn=function(t){c.call(this,t)};(i["armory.logicnode.WindowInfoNode"]=Rn).__name__="armory.logicnode.WindowInfoNode",Rn.__super__=c,Rn.prototype=r(c.prototype,{get:function(t){return 0==t?Us.windowWidth():Us.windowHeight()},__class__:Rn});var Fn=function(t){this.v=new bn,c.call(this,t)};(i["armory.logicnode.WorldToScreenSpaceNode"]=Fn).__name__="armory.logicnode.WorldToScreenSpaceNode",Fn.__super__=c,Fn.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var i=xr.active.camera;return this.v.setFrom(e),this.v.applyproj(i.V),this.v.applyproj(i.P),this.v},__class__:Fn});var Pn=function(t){c.call(this,t)};(i["armory.logicnode.WriteFileNode"]=Pn).__name__="armory.logicnode.WriteFileNode",Pn.__super__=c,Pn.prototype=r(c.prototype,{run:function(t){this.inputs[1].get(),this.inputs[2].get()},__class__:Pn});var Dn=function(t){c.call(this,t)};(i["armory.logicnode.WriteJsonNode"]=Dn).__name__="armory.logicnode.WriteJsonNode",Dn.__super__=c,Dn.prototype=r(c.prototype,{run:function(t){this.inputs[1].get();var e=this.inputs[2].get(),i=JSON.stringify(e);Jn.trace(i,{fileName:"Sources/armory/logicnode/WriteJsonNode.hx",lineNumber:14,className:"armory.logicnode.WriteJsonNode",methodName:"run"})},__class__:Dn});var Wn=function(t){c.call(this,t)};(i["armory.logicnode.WriteStorageNode"]=Wn).__name__="armory.logicnode.WriteStorageNode",Wn.__super__=c,Wn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),i=this.inputs[2].get(),n=os.get_data();null!=n&&(V.setField(n,e,i),os.save(),this.runOutput(0))},__class__:Wn});var Vn=function(){};(i["armory.object.Uniforms"]=Vn).__name__="armory.object.Uniforms",Vn.register=function(){Kr.externalTextureLinks=[Vn.textureLink],Kr.externalVec3Links=[Vn.vec3Link],Kr.externalFloatLinks=[Vn.floatLink]},Vn.textureLink=function(t,e,i){return"_smaaSearch"==i?xr.active.embedded.get("smaa_search.png"):"_smaaArea"==i?xr.active.embedded.get("smaa_area.png"):"_lensTexture"==i?xr.active.embedded.get("lenstexture.jpg"):"_lutTexture"==i?xr.active.embedded.get("luttexture.jpg"):"_cloudsTexture"==i?xr.active.embedded.get("cloudstexture.png"):null},Vn.vec3Link=function(t,e,i){return null},Vn.floatLink=function(t,e,i){return null};var Hn=function(){};(i["armory.renderpath.Inc"]=Hn).__name__="armory.renderpath.Inc",Hn.init=function(t){Hn.path=t},Hn.bindShadowMap=function(){for(var t=0,e=xr.active.lights;t<e.length;){var i=e[t];if(++t,i.visible&&i.data.raw.cast_shadow&&"sun"==i.data.raw.type){var n="shadowMap";Hn.path.bindTarget(n,n);break}}for(var r=0,s=Hn.pointIndex;r<s;){var a="shadowMapPoint["+r+++"]";Hn.path.bindTarget(a,a)}for(var o=0,l=Hn.spotIndex;o<l;){var h="shadowMapSpot["+o+++"]";Hn.path.bindTarget(h,h)}},Hn.shadowMapName=function(t){return"sun"==t.data.raw.type?"shadowMap":"point"==t.data.raw.type?"shadowMapPoint["+Hn.pointIndex+"]":"shadowMapSpot["+Hn.spotIndex+"]"},Hn.getShadowMap=function(t){var e=Hn.shadowMapName(t),i=Hn.path.renderTargets.get(e);if(null==i)if(Hn.path.light.data.raw.shadowmap_cube){var n=Hn.path.light.data.raw.shadowmap_size,r=new wr;r.name=e,r.width=n,r.height=n,r.format="DEPTH16",r.is_cubemap=!0,i=Hn.path.createRenderTarget(r)}else{var s=Hn.path.light.data.raw.shadowmap_size,a=s,o=new wr;o.name=e,o.width=s,o.height=a,o.format="DEPTH16",i=Hn.path.createRenderTarget(o)}return e},Hn.drawShadowMap=function(){Hn.pointIndex=0;for(var t=Hn.spotIndex=0,e=xr.active.lights;t<e.length;){var i=e[t];if(++t,i.visible&&i.data.raw.cast_shadow){Hn.path.light=i;for(var n=Hn.getShadowMap(i),r=i.data.raw.shadowmap_cube?6:1,s=0,a=r;s<a;){var o=s++;1<r&&(Hn.path.currentFace=o),Hn.path.setTarget(n),Hn.path.clearTarget(null,1),Hn.path.drawMeshes("shadowmap")}Hn.path.currentFace=-1,"point"==i.data.raw.type?Hn.pointIndex++:"spot"==i.data.raw.type&&Hn.spotIndex++}}};var zn=function(){};(i["armory.renderpath.RenderPathForward"]=zn).__name__="armory.renderpath.RenderPathForward",zn.drawMeshes=function(){zn.path.drawMeshes("mesh")},zn.init=function(t){zn.path=t},zn.commands=function(){Hn.drawShadowMap(),zn.path.setTarget(""),zn.path.clearTarget(-1,1),Hn.bindShadowMap(),Gn.drawMeshes()};var Gn=function(){};(i["armory.renderpath.RenderPathCreator"]=Gn).__name__="armory.renderpath.RenderPathCreator",Gn.get=function(){return Gn.path=new yr,Hn.init(Gn.path),zn.init(Gn.path),Gn.path.commands=zn.commands,Gn.path};var Un=function(){};(i["armory.system.Event"]=Un).__name__="armory.system.Event",Un.get=function(t){return Un.events.get(t)},Un.add=function(t,e,i){null==i&&(i=-1);var n={name:t,onEvent:e,mask:i},r=Un.events.get(t);return null!=r?r.push(n):Un.events.set(t,[n]),n},Un.removeListener=function(t){var e=Un.events.get(t.name);null!=e&&ht.remove(e,t)};var jn=function(){};(i["armory.system.Logic"]=jn).__name__="armory.system.Logic",jn.getNode=function(t){for(var e=0,i=jn.nodes;e<i.length;){var n=i[e];if(++e,n.id==t)return n}return null},jn.getInputLink=function(t){for(var e=0,i=jn.links;e<i.length;){var n=i[e];if(++e,n.to_id==t.node_id){var r=jn.getNode(t.node_id);if(r.inputs.length<=n.to_socket)return null;if(r.inputs[n.to_socket]==t)return n}}return null},jn.getOutputLinks=function(t){for(var e=[],i=0,n=jn.links;i<n.length;){var r=n[i];if(++i,r.from_id==t.node_id){var s=jn.getNode(t.node_id);if(s.outputs.length<=r.from_socket)continue;s.outputs[r.from_socket]==t&&e.push(r)}}return e},jn.safesrc=function(t){return q.replace(t," ","")},jn.node_name=function(t){return jn.safesrc(t.name)+t.id},jn.parse=function(t,e){null==e&&(e=!0),jn.nodes=t.nodes,jn.links=t.links,jn.parsed_nodes=[],jn.parsed_labels=new ur,jn.nodeMap=new ur;var i=jn.get_root_nodes(t);if(jn.tree=new ue,e)jn.tree.notifyOnAdd(function(){for(var t=0;t<i.length;){var e=i[t];++t,jn.build_node(e)}});else for(var n=0;n<i.length;){var r=i[n];++n,jn.build_node(r)}return jn.tree},jn.build_node=function(t){var e=jn.node_name(t);if(-1!=jn.parsed_nodes.indexOf(e))return e;jn.parsed_nodes.push(e);var i=jn.createClassInstance(t.type,[jn.tree]);jn.nodeMap.set(e,i);for(var n=0,r=t.buttons;n<r.length;){var s=r[n];++n,"property0"==s.name&&V.setProperty(i,s.name,s.data[s.default_value])}for(var a=0,o=t.buttons;a<o.length;){var l=o[a];++a,"property1"==l.name&&V.setProperty(i,l.name,l.data[l.default_value])}for(var h=0,u=t.buttons;h<u.length;){var _=u[h];++h,"property2"==_.name&&V.setProperty(i,_.name,_.data[_.default_value])}for(var c=0,d=t.buttons;c<d.length;){var p=d[c];++c,"property3"==p.name&&V.setProperty(i,p.name,p.data[p.default_value])}for(var f=0,g=t.buttons;f<g.length;){var m=g[f];++f,"property4"==m.name&&V.setProperty(i,m.name,m.data[m.default_value])}for(var v=null,y=0,w=0,b=t.inputs.length;w<b;){var x=w++,S=t.inputs[x],k=jn.getInputLink(S);if(null!=k){var T=jn.getNode(k.from_id),C=T.outputs[k.from_socket];v=jn.nodeMap.get(jn.build_node(T));for(var I=0,N=T.outputs.length;I<N;){var O=I++;if(T.outputs[O]==C){y=O;break}}}else v=jn.build_default_node(S),y=0;i.addInput(v,y)}for(var E=0,M=t.outputs;E<M.length;){var L=M[E];++E;var A=[],B=jn.getOutputLinks(L);if(null!=B&&0<B.length)for(var R=0;R<B.length;){var F=B[R];++R;var P=jn.getNode(F.to_id),D=jn.build_node(P);A.push(jn.nodeMap.get(D))}else A.push(jn.build_default_node(L));i.addOutputs(A)}return e},jn.get_root_nodes=function(t){for(var e=[],i=0,n=t.nodes;i<n.length;){var r=n[i];++i;for(var s=!1,a=0,o=r.outputs;a<o.length;){var l=o[a];++a;var h=jn.getOutputLinks(l);if(null!=h&&0<h.length){s=!0;break}}s||e.push(r)}return e},jn.build_default_node=function(t){var e=null;return"OBJECT"==t.type?e=jn.createClassInstance("ObjectNode",[jn.tree,t.default_value]):"ANIMACTION"==t.type?e=jn.createClassInstance("StringNode",[jn.tree,t.default_value]):"VECTOR"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=jn.createClassInstance("VectorNode",[jn.tree,t.default_value[0],t.default_value[1],t.default_value[2]])):"RGBA"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=jn.createClassInstance("ColorNode",[jn.tree,t.default_value[0],t.default_value[1],t.default_value[2],t.default_value[3]])):"RGB"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=jn.createClassInstance("ColorNode",[jn.tree,t.default_value[0],t.default_value[1],t.default_value[2]])):e="VALUE"==t.type?jn.createClassInstance("FloatNode",[jn.tree,t.default_value]):"INT"==t.type?jn.createClassInstance("IntegerNode",[jn.tree,t.default_value]):"BOOLEAN"==t.type?jn.createClassInstance("BooleanNode",[jn.tree,t.default_value]):"STRING"==t.type?jn.createClassInstance("StringNode",[jn.tree,t.default_value]):jn.createClassInstance("NullNode",[jn.tree]),e},jn.createClassInstance=function(t,e){var i=J.resolveClass(jn.packageName+"."+t);return null==i?null:J.createInstance(i,e)};var Xn=function(){};(i["armory.system.Starter"]=Xn).__name__="armory.system.Starter",Xn.main=function(n,r,s,a,o,l,h,u,_,c){Xn.tasks=1,Xn.tasks--,function(){if(!(0<Xn.tasks)){null==d.raw&&(d.raw={});var t=d.raw;null==t.window_mode&&(t.window_mode=r),null==t.window_resizable&&(t.window_resizable=s),null==t.window_minimizable&&(t.window_minimizable=a),null==t.window_maximizable&&(t.window_maximizable=o),null==t.window_w&&(t.window_w=l),null==t.window_h&&(t.window_h=h),null==t.window_msaa&&(t.window_msaa=u),null==t.window_vsync&&(t.window_vsync=_),Vn.register();var e=0==t.window_mode?0:1,i=0;t.window_resizable&&(i|=1),t.window_maximizable&&(i|=4),t.window_minimizable&&(i|=2),Us.start(new Gs("ArmorLogic",t.window_w,t.window_h,new Qs(null,null,null,null,null,null,null,i,e),new Es(null,t.window_vsync,null,null,null,t.window_msaa)),function(t){Xs.gl2||Jn.trace("WebGL 2 is not supported on this browser",{fileName:"Sources/armory/system/Starter.hx",lineNumber:41,className:"armory.system.Starter",methodName:"main"}),vr.init(function(){xr.setActive(n,function(t){yr.setActive(c())})})})}}()};var Yn=function(t){this.onReady=null,this.canvas=null;var l=this;u.call(this),Tr.getBlob(t+".json",function(o){Tr.getFont("font_default.ttf",function(t){l.cui=new xo({font:t,theme:bo.light});var i=JSON.parse(o.toString());if(null==i.assets||0==i.assets.length)l.canvas=i;else for(var n=0,e=0,r=i.assets;e<r.length;){var s=[r[e]];++e;var a=s[0].name;Tr.getImage(a,function(e){return function(t){vo.assetMap.set(e[0].id,t),(n+=1)>=i.assets.length&&(l.canvas=i)}}(s))}})}),this.notifyOnRender2D(function(t){if(null!=l.canvas){for(var e=vo.draw(l.cui,l.canvas,t),i=0;i<e.length;){var n=e[i];++i;var r=Un.get(n);if(null!=r)for(var s=0;s<r.length;){var a=r[s];++s,a.onEvent()}}null!=l.onReady&&(l.onReady(),l.onReady=null)}})};(i["armory.trait.internal.CanvasScript"]=Yn).__name__="armory.trait.internal.CanvasScript",Yn.__super__=u,Yn.prototype=r(u.prototype,{get_ready:function(){return null!=this.canvas},getElement:function(t){for(var e=0,i=this.canvas.elements;e<i.length;){var n=i[e];if(++e,n.name==t)return n}return null},__class__:Yn,__properties__:{get_ready:"get_ready"}});var Zn=function(){u.call(this)};(i["armory.trait.navigation.Navigation"]=Zn).__name__="armory.trait.navigation.Navigation",Zn.__super__=u,Zn.prototype=r(u.prototype,{__class__:Zn});var Kn=function(){u.call(this)};(i["armory.trait.physics.PhysicsWorld"]=Kn).__name__="armory.trait.physics.PhysicsWorld",Kn.__super__=u,Kn.prototype=r(u.prototype,{__class__:Kn});var Qn=function(){u.call(this)};(i["armory.trait.physics.RigidBody"]=Qn).__name__="armory.trait.physics.RigidBody",Qn.__super__=u,Qn.prototype=r(u.prototype,{__class__:Qn});var qn=function(){};(i["haxe.IMap"]=qn).__name__="haxe.IMap";var Jn=function(){};(i["haxe.Log"]=Jn).__name__="haxe.Log",Jn.formatOutput=function(t,e){var i=pt.string(t);if(null==e)return i;var n=e.fileName+":"+e.lineNumber;if(null!=e&&null!=e.customParams)for(var r=0,s=e.customParams;r<s.length;){var a=s[r];++r,i+=", "+pt.string(a)}return n+": "+i},Jn.trace=function(t,e){var i=Jn.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};var $n=function(){this.buf=new o,this.cache=[],this.useCache=$n.USE_CACHE,this.useEnumIndex=$n.USE_ENUM_INDEX,this.shash=new ur,this.scount=0};(i["haxe.Serializer"]=$n).__name__="haxe.Serializer",$n.run=function(t){var e=new $n;return e.serialize(t),e.toString()},$n.prototype={toString:function(){return this.buf.toString()},serializeString:function(t){var e=this.shash.get(t);if(null!=e)return this.buf.add("R"),void this.buf.add(e);this.shash.set(t,this.scount++),this.buf.add("y"),t=q.urlEncode(t),this.buf.add(t.length),this.buf.add(":"),this.buf.add(t)},serializeRef:function(t){for(var e=typeof t,i=0,n=this.cache.length;i<n;){var r=i++,s=this.cache[r];if(typeof s==e&&s==t)return this.buf.add("r"),this.buf.add(r),!0}return this.cache.push(t),!1},serializeFields:function(t){for(var e=0,i=V.fields(t);e<i.length;){var n=i[e];++e,this.serializeString(n),this.serialize(V.field(t,n))}this.buf.add("g")},serialize:function(t){var e=J.typeof(t);switch(e._hx_index){case 0:this.buf.add("n");break;case 1:var i=t;if(0==i)return void this.buf.add("z");this.buf.add("i"),this.buf.add(i);break;case 2:var n=t;isNaN(n)?this.buf.add("k"):isFinite(n)?(this.buf.add("d"),this.buf.add(n)):this.buf.add(n<0?"m":"p");break;case 3:this.buf.add(t?"t":"f");break;case 4:if(pt.is(t,Oo)){var r=J.getClassName(t);this.buf.add("A"),this.serializeString(r)}else if(pt.is(t,Eo))this.buf.add("B"),this.serializeString(J.getEnumName(t));else{if(this.useCache&&this.serializeRef(t))return;this.buf.add("o"),this.serializeFields(t)}break;case 5:throw new us("Cannot serialize function");case 6:var s=e.c;if(s==String)return void this.serializeString(t);if(this.useCache&&this.serializeRef(t))return;switch(s){case Array:var a=0;this.buf.add("a");for(var o=0,l=t.length;o<l;){var h=o++;null==t[h]?++a:(0<a&&(1==a?this.buf.add("n"):(this.buf.add("u"),this.buf.add(a)),a=0),this.serialize(t[h]))}0<a&&(1==a?this.buf.add("n"):(this.buf.add("u"),this.buf.add(a))),this.buf.add("h");break;case Date:var u=t;this.buf.add("v"),this.buf.add(u.getTime());break;case rr:this.buf.add("q");for(var _=t,c=_.keys();c.hasNext();){var d=c.next();this.buf.add(":"),this.buf.add(d),this.serialize(_.get(d))}this.buf.add("h");break;case sr:this.buf.add("l");for(var p=t.iterator();p.hasNext();){var f=p.next();this.serialize(f)}this.buf.add("h");break;case lr:this.buf.add("M");for(var g=t,m=g.keys();m.hasNext();){var v=m.next(),y=V.field(v,"__id__");V.deleteField(v,"__id__"),this.serialize(v),V.setField(v,"__id__",y),this.serialize(g.get(v))}this.buf.add("h");break;case ur:this.buf.add("b");for(var w=t,b=w.keys();b.hasNext();){var x=b.next();this.serializeString(x),this.serialize(w.get(x))}this.buf.add("h");break;case ir:var S=t;this.buf.add("s"),this.buf.add(Math.ceil(8*S.length/6)),this.buf.add(":");var k=0,T=S.length-2,C=$n.BASE64_CODES;if(null==C){C=new Array($n.BASE64.length);for(var I=0,N=$n.BASE64.length;I<N;){var O=I++;C[O]=ht.cca($n.BASE64,O)}$n.BASE64_CODES=C}for(;k<T;){var E=S.get(k++),M=S.get(k++),L=S.get(k++);this.buf.addChar(C[E>>2]),this.buf.addChar(C[63&(E<<4|M>>4)]),this.buf.addChar(C[63&(M<<2|L>>6)]),this.buf.addChar(C[63&L])}if(k==T){var A=S.get(k++),B=S.get(k++);this.buf.addChar(C[A>>2]),this.buf.addChar(C[63&(A<<4|B>>4)]),this.buf.addChar(C[B<<2&63])}else if(k==T+1){var R=S.get(k++);this.buf.addChar(C[R>>2]),this.buf.addChar(C[R<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=t.hxSerialize?(this.buf.add("C"),this.serializeString(J.getClassName(s)),this.useCache&&this.cache.push(t),t.hxSerialize(this),this.buf.add("g")):(this.buf.add("c"),this.serializeString(J.getClassName(s)),this.useCache&&this.cache.push(t),this.serializeFields(t))}break;case 7:var F=e.e;if(this.useCache){if(this.serializeRef(t))return;this.cache.pop()}this.buf.add(this.useEnumIndex?"j":"w"),this.serializeString(J.getEnumName(F)),this.useEnumIndex?(this.buf.add(":"),this.buf.add(t._hx_index)):this.serializeString(J.enumConstructor(t)),this.buf.add(":");var P=J.enumParameters(t);this.buf.add(P.length);for(var D=0;D<P.length;){var W=P[D];++D,this.serialize(W)}this.useCache&&this.cache.push(t);break;default:throw new us("Cannot serialize "+pt.string(t))}},__class__:$n};var tr=function(){};(i["haxe._Unserializer.DefaultResolver"]=tr).__name__="haxe._Unserializer.DefaultResolver",tr.prototype={resolveClass:function(t){return J.resolveClass(t)},resolveEnum:function(t){return J.resolveEnum(t)},__class__:tr};var er=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=er.DEFAULT_RESOLVER;null==e&&(e=new tr,er.DEFAULT_RESOLVER=e),this.resolver=e};(i["haxe.Unserializer"]=er).__name__="haxe.Unserializer",er.initCodes=function(){for(var t=[],e=0,i=er.BASE64.length;e<i;){var n=e++;t[q.fastCodeAt(er.BASE64,n)]=n}return t},er.run=function(t){return new er(t).unserialize()},er.prototype={get:function(t){return q.fastCodeAt(this.buf,t)},readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var n=this.get(this.pos);if(q.isEof(n))break;if(45!=n){if(n<48||57<n)break;t=10*t+(n-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.get(this.pos);if(q.isEof(e))break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return pt.parseFloat(ht.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new us("Invalid object");if(103==this.get(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new us("Invalid object key");var i=this.unserialize();V.setField(t,e,i)}this.pos++},unserializeEnum:function(t,e){if(58!=this.get(this.pos++))throw new us("Invalid enum format");var i=this.readDigits();if(0==i)return J.createEnum(t,e);for(var n=[];0<i--;)n.push(this.unserialize());return J.createEnum(t,e,n)},unserialize:function(){switch(this.get(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new us("Class not found "+t);return e;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new us("Enum not found "+i);return n;case 67:var r=this.unserialize(),s=this.resolver.resolveClass(r);if(null==s)throw new us("Class not found "+r);var a=J.createEmptyInstance(s);if(this.cache.push(a),a.hxUnserialize(this),103!=this.get(this.pos++))throw new us("Invalid custom data");return a;case 77:var o=new lr;this.cache.push(o);for(this.buf;104!=this.get(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var h=this.readDigits();if(h<0||h>=this.scache.length)throw new us("Invalid string reference");return this.scache[h];case 97:this.buf;var u=[];for(this.cache.push(u);;){var _=this.get(this.pos);if(104==_){this.pos++;break}if(117==_){this.pos++;var c=this.readDigits();u[u.length+c-1]=null}else u.push(this.unserialize())}return u;case 98:var d=new ur;this.cache.push(d);for(this.buf;104!=this.get(this.pos);){var p=this.unserialize();d.set(p,this.unserialize())}return this.pos++,d;case 99:var f=this.unserialize(),g=this.resolver.resolveClass(f);if(null==g)throw new us("Class not found "+f);var m=J.createEmptyInstance(g);return this.cache.push(m),this.unserializeObject(m),m;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var v=this.unserialize(),y=this.resolver.resolveEnum(v);if(null==y)throw new us("Enum not found "+v);this.pos++;var w=this.readDigits(),b=J.getEnumConstructs(y)[w];if(null==b)throw new us("Unknown enum index "+v+"@"+w);var x=this.unserializeEnum(y,b);return this.cache.push(x),x;case 107:return NaN;case 108:var S=new sr;this.cache.push(S);for(this.buf;104!=this.get(this.pos);)S.add(this.unserialize());return this.pos++,S;case 109:return-1/0;case 110:return null;case 111:var k={};return this.cache.push(k),this.unserializeObject(k),k;case 112:return 1/0;case 113:var T=new rr;this.cache.push(T);this.buf;for(var C=this.get(this.pos++);58==C;){var I=this.readDigits();T.set(I,this.unserialize()),C=this.get(this.pos++)}if(104!=C)throw new us("Invalid IntMap format");return T;case 114:var N=this.readDigits();if(N<0||N>=this.cache.length)throw new us("Invalid reference");return this.cache[N];case 115:var O=this.readDigits(),E=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<O)throw new us("Invalid bytes length");var M=er.CODES;null==M&&(M=er.initCodes(),er.CODES=M);for(var L=this.pos,A=3&O,B=3*(O>>2)+(2<=A?A-1:0),R=L+(O-A),F=ir.alloc(B),P=0;L<R;){var D=M[q.fastCodeAt(E,L++)],W=M[q.fastCodeAt(E,L++)];F.set(P++,D<<2|W>>4);var V=M[q.fastCodeAt(E,L++)];F.set(P++,W<<4|V>>2);var H=M[q.fastCodeAt(E,L++)];F.set(P++,V<<6|H)}if(2<=A){var z=M[q.fastCodeAt(E,L++)],G=M[q.fastCodeAt(E,L++)];if(F.set(P++,z<<2|G>>4),3==A){var U=M[q.fastCodeAt(E,L++)];F.set(P++,G<<4|U>>2)}}return this.pos+=O,this.cache.push(F),F;case 116:return!0;case 118:var j;return 48<=this.get(this.pos)&&this.get(this.pos)<=57&&48<=this.get(this.pos+1)&&this.get(this.pos+1)<=57&&48<=this.get(this.pos+2)&&this.get(this.pos+2)<=57&&48<=this.get(this.pos+3)&&this.get(this.pos+3)<=57&&45==this.get(this.pos+4)?(j=ht.strDate(ht.substr(this.buf,this.pos,19)),this.pos+=19):j=new Date(this.readFloat()),this.cache.push(j),j;case 119:var X=this.unserialize(),Y=this.resolver.resolveEnum(X);if(null==Y)throw new us("Enum not found "+X);var Z=this.unserializeEnum(Y,this.unserialize());return this.cache.push(Z),Z;case 120:throw us.wrap(this.unserialize());case 121:var K=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<K)throw new us("Invalid string length");var Q=ht.substr(this.buf,this.pos,K);return this.pos+=K,Q=q.urlDecode(Q),this.scache.push(Q),Q;case 122:return 0}throw this.pos--,new us("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:er};var ir=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(i["haxe.io.Bytes"]=ir).__name__="haxe.io.Bytes",ir.alloc=function(t){return new ir(new ArrayBuffer(t))},ir.ofString=function(t,e){if(e==nr.RawNative){for(var i=new Uint8Array(t.length<<1),n=0,r=t.length;n<r;){var s=n++,a=q.fastCodeAt(t,s);i[s<<1]=255&a,i[s<<1|1]=a>>8}return new ir(i.buffer)}for(var o=[],l=0;l<t.length;){var h=q.fastCodeAt(t,l++);55296<=h&&h<=56319&&(h=h-55232<<10|1023&q.fastCodeAt(t,l++)),h<=127?o.push(h):(h<=2047?o.push(192|h>>6):(h<=65535?o.push(224|h>>12):(o.push(240|h>>18),o.push(128|h>>12&63)),o.push(128|h>>6&63)),o.push(128|63&h))}return new ir(new Uint8Array(o).buffer)},ir.ofData=function(t){var e=t.hxBytes;return null!=e?e:new ir(t)},ir.prototype={get:function(t){return this.b[t]},set:function(t,e){this.b[t]=e},blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new us(fr.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new us(fr.OutsideBounds);return new ir(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},initData:function(){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength))},setInt32:function(t,e){this.initData(),this.data.setInt32(t,e,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw new us(fr.OutsideBounds);null==i&&(i=nr.UTF8);var n="",r=this.b,s=t,a=t+e;switch(i._hx_index){case 0:for(;s<a;){var o=r[s++];if(o<128){if(0==o)break;n+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&r[s++];n+=String.fromCodePoint(l)}else if(o<240){var h=(31&o)<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(h)}else{var u=(15&o)<<18|(127&r[s++])<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(u)}}break;case 1:for(;s<a;){var _=r[s++]|r[s++]<<8;n+=String.fromCodePoint(_)}}return n},toString:function(){return this.getString(0,this.length)},getData:function(){return this.b.bufferValue},__class__:ir};var nr=w["haxe.io.Encoding"]={__ename__:"haxe.io.Encoding",__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}},rr=function(){this.h={}};(i["haxe.ds.IntMap"]=rr).__name__="haxe.ds.IntMap",rr.__interfaces__=[qn],rr.prototype={set:function(t,e){this.h[t]=e},get:function(t){return this.h[t]},exists:function(t){return this.h.hasOwnProperty(t)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return ht.iter(t)},__class__:rr};var sr=function(){this.length=0};(i["haxe.ds.List"]=sr).__name__="haxe.ds.List",sr.prototype={add:function(t){var e=new ar(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},iterator:function(){return new or(this.h)},__class__:sr};var ar=function(t,e){this.item=t,this.next=e};(i["haxe.ds._List.ListNode"]=ar).__name__="haxe.ds._List.ListNode",ar.prototype={__class__:ar};var or=function(t){this.head=t};(i["haxe.ds._List.ListIterator"]=or).__name__="haxe.ds._List.ListIterator",or.prototype={hasNext:function(){return null!=this.head},next:function(){var t=this.head.item;return this.head=this.head.next,t},__class__:or};var lr=function(){this.h={__keys__:{}}};(i["haxe.ds.ObjectMap"]=lr).__name__="haxe.ds.ObjectMap",lr.__interfaces__=[qn],lr.assignId=function(t){return t.__id__=++lr.count},lr.getId=function(t){return t.__id__},lr.prototype={set:function(t,e){var i=lr.getId(t)||lr.assignId(t);this.h[i]=e,this.h.__keys__[i]=t},get:function(t){return this.h[lr.getId(t)]},keys:function(){var t=[];for(var e in this.h.__keys__)this.h.hasOwnProperty(e)&&t.push(this.h.__keys__[e]);return ht.iter(t)},__class__:lr};var hr=function(t,e){this.map=t,this.keys=e,this.index=0,this.count=e.length};(i["haxe.ds._StringMap.StringMapIterator"]=hr).__name__="haxe.ds._StringMap.StringMapIterator",hr.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:hr};var ur=function(){this.h={}};(i["haxe.ds.StringMap"]=ur).__name__="haxe.ds.StringMap",ur.__interfaces__=[qn],ur.prototype={isReserved:function(t){return null!=Mo[t]},set:function(t,e){this.isReserved(t)?this.setReserved(t,e):this.h[t]=e},get:function(t){return this.isReserved(t)?this.getReserved(t):this.h[t]},setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},remove:function(t){return this.isReserved(t)?(t="$"+t,!(null==this.rh||!this.rh.hasOwnProperty(t))&&(delete this.rh[t],!0)):!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){return ht.iter(this.arrayKeys())},arrayKeys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(e);if(null!=this.rh)for(var e in this.rh)36==e.charCodeAt(0)&&t.push(e.substr(1));return t},iterator:function(){return new hr(this,this.arrayKeys())},__class__:ur};var _r=function(){this.pos=0,this.size=0};(i["haxe.io.BytesBuffer"]=_r).__name__="haxe.io.BytesBuffer",_r.prototype={addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var n=new ArrayBuffer(i),r=new Uint8Array(n);0<this.size&&r.set(this.u8),this.size=i,this.buffer=n,this.u8=r,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return ir.alloc(0);var t=new ir(this.buffer);return t.length=this.pos,t},__class__:_r};var cr=function(){};(i["haxe.io.Input"]=cr).__name__="haxe.io.Input",cr.prototype={readByte:function(){throw new us("Not implemented")},readBytes:function(t,e,i){var n=i,r=t.b;if(e<0||i<0||e+i>t.length)throw new us(fr.OutsideBounds);try{for(;0<n;)r[e]=this.readByte(),++e,--n}catch(t){var s=t instanceof us?t.val:t;if(!(s instanceof pr))throw t}return i-n},set_bigEndian:function(t){return this.bigEndian=t},readFullBytes:function(t,e,i){for(;0<i;){var n=this.readBytes(t,e,i);if(0==n)throw new us(fr.Blocked);e+=n,i-=n}},read:function(t){for(var e=ir.alloc(t),i=0;0<t;){var n=this.readBytes(e,i,t);if(0==n)throw new us(fr.Blocked);i+=n,t-=n}return e},readFloat:function(){return gr.i32ToFloat(this.readInt32())},readInt8:function(){var t=this.readByte();return 128<=t?t-256:t},readInt16:function(){var t=this.readByte(),e=this.readByte(),i=this.bigEndian?e|t<<8:t|e<<8;return 0!=(32768&i)?i-65536:i},readUInt16:function(){var t=this.readByte(),e=this.readByte();return this.bigEndian?e|t<<8:t|e<<8},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|e<<16|t<<24:t|e<<8|i<<16|n<<24},readString:function(t,e){var i=ir.alloc(t);return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:cr,__properties__:{set_bigEndian:"set_bigEndian"}};var dr=function(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw new us(fr.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i};(i["haxe.io.BytesInput"]=dr).__name__="haxe.io.BytesInput",dr.__super__=cr,dr.prototype=r(cr.prototype,{get_position:function(){return this.pos},get_length:function(){return this.totlen},set_position:function(t){return t<0?t=0:t>this.get_length()&&(t=this.get_length()),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new us(new pr);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new us(fr.OutsideBounds);if(0==this.len&&0<i)throw new us(new pr);this.len<i&&(i=this.len);for(var n=this.b,r=t.b,s=0,a=i;s<a;){var o=s++;r[e+o]=n[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:dr,__properties__:r(cr.prototype.__properties__,{get_length:"get_length",set_position:"set_position",get_position:"get_position"})});var pr=function(){};(i["haxe.io.Eof"]=pr).__name__="haxe.io.Eof",pr.prototype={toString:function(){return"Eof"},__class__:pr};var fr=w["haxe.io.Error"]={__ename__:"haxe.io.Error",__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(S=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:n}},S.__params__=["e"],S)},gr=function(){};(i["haxe.io.FPHelper"]=gr).__name__="haxe.io.FPHelper",gr.i32ToFloat=function(t){return gr.helper.setInt32(0,t,!0),gr.helper.getFloat32(0,!0)};var mr={};(i["haxe.io._UInt8Array.UInt8Array_Impl_"]=mr).__name__="haxe.io._UInt8Array.UInt8Array_Impl_",mr.fromBytes=function(t,e,i){return null==e&&(e=0),null==i&&(i=t.length-e),new Uint8Array(t.getData(),e,i)};var vr=function(t){t(),Us.notifyOnFrames(vr.render),Ps.addTimeTask(vr.update,0,ls.get_delta())};(i["iron.App"]=vr).__name__="iron.App",vr.w=function(){return _.w()},vr.h=function(){return _.h()},vr.x=function(){return _.x()},vr.y=function(){return _.y()},vr.init=function(t){new vr(t)},vr.update=function(){if(null!=xr.active&&xr.active.ready&&!vr.pauseUpdates){xr.active.updateFrame();for(var t=0,e=vr.traitUpdates.length;t<e;){if(0<vr.traitInits.length){for(var i=0,n=vr.traitInits;i<n.length;){var r=n[i];if(++i,!(0<vr.traitInits.length))break;r()}vr.traitInits.splice(0,vr.traitInits.length)}vr.traitUpdates[t](),e<=vr.traitUpdates.length?++t:e=vr.traitUpdates.length}for(t=0,e=vr.traitLateUpdates.length;t<e;)vr.traitLateUpdates[t](),e<=vr.traitLateUpdates.length?++t:e=vr.traitLateUpdates.length;if(null!=vr.onEndFrames)for(var s=0,a=vr.onEndFrames;s<a.length;){var o=a[s];++s,o()}-1==vr.lastw&&(vr.lastw=vr.w(),vr.lasth=vr.h()),vr.lastw==vr.w()&&vr.lasth==vr.h()||null!=xr.active&&null!=xr.active.camera&&xr.active.camera.buildProjection(),vr.lastw=vr.w(),vr.lasth=vr.h()}},vr.render=function(t){var e=t[0];if(vr.framebuffer=e,ls.update(),null!=xr.active&&xr.active.ready){if(0<vr.traitInits.length){for(var i=0,n=vr.traitInits;i<n.length;){var r=n[i];if(++i,!(0<vr.traitInits.length))break;r()}vr.traitInits.splice(0,vr.traitInits.length)}xr.active.renderFrame(e.get_g4());for(var s=0,a=vr.traitRenders;s<a.length;){var o=a[s];if(++s,!(0<vr.traitRenders.length))break;o(e.get_g4())}vr.render2D(e)}else vr.render2D(e)},vr.render2D=function(t){if(0<vr.traitRenders2D.length){t.get_g2().begin(!1);for(var e=0,i=vr.traitRenders2D;e<i.length;){var n=i[e];if(++e,!(0<vr.traitRenders2D.length))break;n(t.get_g2())}t.get_g2().end()}},vr.notifyOnInit=function(t){vr.traitInits.push(t)},vr.removeInit=function(t){ht.remove(vr.traitInits,t)},vr.notifyOnUpdate=function(t){vr.traitUpdates.push(t)},vr.removeUpdate=function(t){ht.remove(vr.traitUpdates,t)},vr.notifyOnLateUpdate=function(t){vr.traitLateUpdates.push(t)},vr.removeLateUpdate=function(t){ht.remove(vr.traitLateUpdates,t)},vr.removeRender=function(t){ht.remove(vr.traitRenders,t)},vr.notifyOnRender2D=function(t){vr.traitRenders2D.push(t)},vr.removeRender2D=function(t){ht.remove(vr.traitRenders2D,t)},vr.notifyOnReset=function(t){null==vr.onResets&&(vr.onResets=[]),vr.onResets.push(t)},vr.notifyOnEndFrame=function(t){null==vr.onEndFrames&&(vr.onEndFrames=[]),vr.onEndFrames.push(t)},vr.prototype={__class__:vr};var yr=function(){this.depthBuffers=[],this.depthToRenderTarget=new ur,this.renderTargets=new ur,this.commands=null,this.loading=0,this.paused=!1,this.drawOrder=1,this.lastFrameTime=0,this.viewportScaled=!1,this.scissorSet=!1,this.lastH=0,this.lastW=0,this.isProbe=!1,this.isProbeCube=!1,this.isProbePlanar=!1,this.point=null,this.sun=null,this.light=null,this.currentTarget=null,this.frame=0,this.frameTime=0,this.frameScissorH=0,this.frameScissorW=0,this.frameScissorY=0,this.frameScissorX=0,this.frameScissor=!1};(i["iron.RenderPath"]=yr).__name__="iron.RenderPath",yr.setActive=function(t){yr.active=t},yr.sortMeshesDistance=function(t){t.sort(function(t,e){return t.cameraDistance>=e.cameraDistance?1:-1})},yr.sortMeshesShader=function(t){t.sort(function(t,e){return t.materials[0].name>=e.materials[0].name?1:-1})},yr.prototype={get_ready:function(){return 0==this.loading},renderFrame:function(t){if(this.get_ready()&&!this.paused&&0!=vr.w()&&0!=vr.h()){0<this.lastW&&(this.lastW!=vr.w()||this.lastH!=vr.h())&&this.resize(),this.lastW=vr.w(),this.lastH=vr.h(),this.frameTime=ls.time()-this.lastFrameTime,this.lastFrameTime=ls.time();var e=xr.active.camera;this.isProbePlanar=null!=e&&null!=e.renderTarget,this.isProbeCube=null!=e&&null!=e.renderTargetCube,this.isProbe=this.isProbePlanar||this.isProbeCube,this.isProbePlanar?this.frameG=e.renderTarget.get_g4():this.isProbeCube?this.frameG=e.renderTargetCube.get_g4():this.frameG=t,this.currentG=this.frameG,this.currentW=vr.w(),this.currentH=vr.h(),this.currentD=1,this.currentFace=-1,this.meshesSorted=!1;for(var i=0,n=xr.active.lights;i<n.length;){var r=n[i];++i,r.visible&&r.buildMatrix(xr.active.camera),"sun"==r.data.raw.type?this.sun=r:this.point=r}this.light=xr.active.lights[0],this.commands(),this.isProbe||this.frame++}},setTarget:function(t,e,i){if(null==i&&(i=1),""==t)this.currentG=this.frameG,this.currentD=1,this.currentTarget=null,this.currentFace=-1,this.isProbeCube?(this.currentW=xr.active.camera.renderTargetCube.get_width(),this.currentH=xr.active.camera.renderTargetCube.get_height(),this.begin(this.currentG,null,xr.active.camera.currentFace)):(this.currentW=vr.w(),this.currentH=vr.h(),this.frameScissor&&this.setFrameScissor(),this.begin(this.currentG),this.isProbe||(this.setCurrentViewport(vr.w(),vr.h()),this.setCurrentScissor(vr.w(),vr.h())));else{var n=this.renderTargets.get(t);this.currentTarget=n;var r=null;if(null!=e){r=[];for(var s=0;s<e.length;){var a=e[s];++s;var o=this.renderTargets.get(a);r.push(o.image)}}this.currentG=n.isCubeMap?n.cubeMap.get_g4():n.image.get_g4(),this.currentW=n.isCubeMap?n.cubeMap.get_width():n.image.get_width(),this.currentH=n.isCubeMap?n.cubeMap.get_height():n.image.get_height(),n.is3D&&(this.currentD=n.image.get_depth()),this.begin(this.currentG,r,this.currentFace)}if(1!=i){this.viewportScaled=!0;var l=pt.int(this.currentW*i),h=pt.int(this.currentH*i);this.currentG.viewport(0,h,l,h),this.currentG.scissor(0,h,l,h)}else this.viewportScaled&&(this.viewportScaled=!1,this.setCurrentViewport(this.currentW,this.currentH),this.setCurrentScissor(this.currentW,this.currentH));this.bindParams=null},begin:function(t,e,i){null==i&&(i=-1),0<=i?t.beginFace(i):t.begin(e)},end:function(t){t.end(),this.scissorSet&&(t.disableScissor(),this.scissorSet=!1),this.bindParams=null},setCurrentViewport:function(t,e){this.currentG.viewport(vr.x(),this.currentH-e-vr.y(),t,e)},setCurrentScissor:function(t,e){this.currentG.scissor(vr.x(),this.currentH-e-vr.y(),t,e),this.scissorSet=!0},setFrameScissor:function(){this.frameG.scissor(this.frameScissorX,this.currentH-(this.frameScissorH-this.frameScissorY),this.frameScissorW,this.frameScissorH)},clearTarget:function(t,e){if(-1==t)if(null!=xr.active.world)t=xr.active.world.raw.background_color;else if(null!=xr.active.camera){var i=xr.active.camera.data.raw.clear_color;null!=i&&(t=Ts.fromFloats(i[0],i[1],i[2]))}this.currentG.clear(t,e,null)},drawMeshes:function(t){if(!("shadowmap"==t)||null!=this.light&&this.light.data.raw.cast_shadow&&this.light.visible&&0!=this.light.data.raw.strength){0<=this.currentFace&&null!=this.light&&this.light.setCubeFace(this.currentFace,xr.active.camera);var e=this.currentG;this.submitDraw(t),this.end(e)}},submitDraw:function(t){var e=xr.active.camera,i=xr.active.meshes,n=this.currentG;if(Gr.lastPipeline=null,!this.meshesSorted&&null!=e){for(var r=e.transform.worldx(),s=e.transform.worldy(),a=e.transform.worldz(),o=0;o<i.length;){var l=i[o];++o,l.computeCameraDistance(r,s,a)}1==this.drawOrder?yr.sortMeshesShader(i):yr.sortMeshesDistance(i),this.meshesSorted=!0}for(var h=0;h<i.length;){var u=i[h];++h,u.render(n,t,this.bindParams)}},bindTarget:function(t,e){null!=this.bindParams?(this.bindParams.push(t),this.bindParams.push(e)):this.bindParams=[t,e]},resize:function(){for(var t=this.renderTargets.iterator();t.hasNext();){var e=t.next();0==e.raw.width&&(e.image.unload(),e.image=this.createImage(e.raw,e.depthStencil),""!=e.depthStencilFrom&&e.image.setDepthStencilFrom(this.depthToRenderTarget.get(e.depthStencilFrom).image))}},createRenderTarget:function(t){var e=this.createTarget(t);return this.renderTargets.set(t.name,e),e},createTarget:function(t){var e=new br(t);if(null!=t.depth_buffer){e.hasDepth=!0;var i=this.depthToRenderTarget.get(t.depth_buffer);if(null==i)for(var n=0,r=this.depthBuffers;n<r.length;){var s=r[n];if(++n,s.name==t.depth_buffer){this.depthToRenderTarget.set(s.name,e),e.depthStencil=this.getDepthStencilFormat(s.format),e.image=this.createImage(t,e.depthStencil);break}}else e.depthStencil=0,e.depthStencilFrom=t.depth_buffer,e.image=this.createImage(t,e.depthStencil),e.image.setDepthStencilFrom(i.image)}else e.hasDepth=!1,null!=t.depth&&1<t.depth&&(e.is3D=!0),t.is_cubemap?(e.isCubeMap=!0,e.depthStencil=0,e.cubeMap=this.createCubeMap(t,e.depthStencil)):(e.depthStencil=0,e.image=this.createImage(t,e.depthStencil));return e},createImage:function(t,e){var i=0==t.width?vr.w():t.width,n=0==t.height?vr.h():t.height,r=null!=t.depth?t.depth:0;if(null!=t.displayp&&(n<i?(i=pt.int(i*(t.displayp/n)),n=t.displayp):(n=pt.int(n*(t.displayp/i)),i=t.displayp)),null!=t.scale&&(i=pt.int(i*t.scale),n=pt.int(n*t.scale),r=pt.int(r*t.scale)),null!=t.depth&&1<t.depth){var s=Ss.create3D(i,n,r,null!=t.format?this.getTextureFormat(t.format):0);return t.mipmaps&&s.generateMipmaps(1e3),s}return null!=t.is_image&&t.is_image?Ss.create(i,n,null!=t.format?this.getTextureFormat(t.format):0):Ss.createRenderTarget(i,n,null!=t.format?this.getTextureFormat(t.format):0,e)},createCubeMap:function(t,e){return xa.createRenderTarget(t.width,null!=t.format?this.getTextureFormat(t.format):0,e)},getTextureFormat:function(t){switch(t){case"A16":return 6;case"A32":return 5;case"A8":return 1;case"DEPTH16":return 3;case"R16":return 6;case"R32":return 5;case"R8":return 1;case"RGBA128":return 2;case"RGBA32":return 0;case"RGBA64":return 4;default:return 0}},getDepthStencilFormat:function(t){if(null==t||""==t)return 1;switch(t){case"DEPTH16":return 5;case"DEPTH24":default:return 1}},__class__:yr,__properties__:{get_ready:"get_ready"}};var wr=function(){this.is_cubemap=null,this.is_image=null,this.depth=null,this.mipmaps=null,this.depth_buffer=null,this.displayp=null,this.scale=null,this.format=null};(i["iron.RenderTargetRaw"]=wr).__name__="iron.RenderTargetRaw",wr.prototype={__class__:wr};var br=function(t){this.isCubeMap=!1,this.is3D=!1,this.hasDepth=!1,this.cubeMap=null,this.image=null,this.depthStencilFrom="",this.raw=t};(i["iron.RenderTarget"]=br).__name__="iron.RenderTarget",br.prototype={__class__:br};var xr=function(){this.traitRemoves=[],this.traitInits=[],this.groups=null,this.uid=xr.uidCounter++,this.meshes=[],this.lights=[],this.cameras=[],this.speakers=[],this.empties=[],this.animations=[],this.armatures=[],this.embedded=new ur,this.root=new Dr,this.root.name="Root",this.traitInits=[],this.traitRemoves=[],null==xr.global&&(xr.global=new Dr)};(i["iron.Scene"]=xr).__name__="iron.Scene",xr.create=function(r,s){xr.active=new xr,xr.active.ready=!1,xr.active.raw=r,Tr.getWorld(r.name,r.world_ref,function(t){xr.active.world=t,xr.active.addScene(r.name,null,function(t){0==xr.active.cameras.length&&Jn.trace('No camera found for scene "'+r.name+'"',{fileName:"Sources/iron/Scene.hx",lineNumber:100,className:"iron.Scene",methodName:"create"}),xr.active.camera=xr.active.getCamera(r.camera_ref),xr.active.ready=!0;for(var e=0,i=xr.active.traitInits;e<i.length;){var n=i[e];++e,n()}xr.active.traitInits=[],xr.active.sceneParent=t,s(t)})})},xr.setActive=function(t,e){xr.framePassed&&(xr.framePassed=!1,null!=xr.active&&xr.active.remove(),Tr.getSceneRaw(t,function(t){xr.create(t,function(t){null!=e&&e(t)})}))},xr.generateTransform=function(t,e){e.world=null!=t.transform?xn.fromFloat32Array(t.transform.values):xn.identity(),e.world.decompose(e.loc,e.rot,e.scale),null!=t.local_only&&(e.localOnly=t.local_only),null!=e.object.parent&&e.update()},xr.createTraits=function(t,e){if(null!=t)for(var i=0;i<t.length;){var n=t[i];if(++i,"Script"==n.type){var r=[];if(null!=n.parameters)for(var s=0,a=n.parameters;s<a.length;){var o=a[s];++s,r.push(xr.parseArg(o))}var l=xr.createTraitClassInstance(n.class_name,r);if(null==l){Jn.trace("Error: Trait '"+n.class_name+"' referenced in object '"+e.name+"' not found",{fileName:"Sources/iron/Scene.hx",lineNumber:639,className:"iron.Scene",methodName:"createTraits"});continue}if(null!=n.props)for(var h=0,u=pt.int(n.props.length/2);h<u;){var _=h++,c=n.props[2*_],d=n.props[2*_+1];""!=d&&V.setProperty(l,c,xr.parseArg(d))}e.addTrait(l)}}},xr.parseArg=function(t){if("true"==t)return!0;if("false"==t)return!1;if("null"==t)return null;if("'"==t.charAt(0))return q.replace(t,"'","");if('"'==t.charAt(0))return q.replace(t,'"',"");if("["==t.charAt(0)){t=q.replace(t,"[",""),t=q.replace(t,"]","");for(var e=[],i=(t=q.replace(t," ","")).split(","),n=0;n<i.length;){var r=i[n];++n,e.push(xr.parseArg(r))}return e}var s=pt.parseFloat(t),a=pt.parseInt(t);return s==a?a:s},xr.createConstraints=function(t,e){if(null!=t){e.constraints=[];for(var i=0;i<t.length;){var n=t[i];++i;var r=new Hr(n);e.constraints.push(r)}}},xr.createTraitClassInstance=function(t,e){var i=J.resolveClass(t);return null==i?null:J.createInstance(i,e)},xr.prototype={remove:function(){for(var t=0,e=this.traitRemoves;t<e.length;){var i=e[t];++t,i()}for(var n=0,r=this.meshes;n<r.length;){var s=r[n];++n,s.remove()}for(var a=0,o=this.lights;a<o.length;){var l=o[a];++a,l.remove()}for(var h=0,u=this.cameras;h<u.length;){var _=u[h];++h,_.remove()}for(var c=0,d=this.speakers;c<d.length;){var p=d[c];++c,p.remove()}for(var f=0,g=this.empties;f<g.length;){var m=g[f];++f,m.remove()}this.groups=null,this.root.remove()},updateFrame:function(){if(this.ready){for(var t=0,e=this.animations;t<e.length;){var i=e[t];++t,i.update(ls.get_delta())}for(var n=0,r=this.empties;n<r.length;){var s=r[n];++n,null!=s&&null!=s.parent&&s.transform.update()}}},renderFrame:function(t){this.ready&&null!=yr.active&&(xr.framePassed=!0,null!=this.camera?this.camera.renderFrame(t):yr.active.renderFrame(t))},addObject:function(t){var e=new Dr;return null!=t?t.addChild(e):this.root.addChild(e),e},getChild:function(t){return this.root.getChild(t)},getTrait:function(t){return 0<this.root.children.length?this.root.children[0].getTrait(t):null},getCamera:function(t){for(var e=0,i=this.cameras;e<i.length;){var n=i[e];if(++e,n.name==t)return n}return null},addMeshObject:function(t,e,i){var n=new Gr(t,e);return null!=i?i.addChild(n):this.root.addChild(n),n},addLightObject:function(t,e){var i=new zr(t);return null!=e?e.addChild(i):this.root.addChild(i),i},addCameraObject:function(t,e){var i=new Wr(t);return null!=e?e.addChild(i):this.root.addChild(i),i},addSpeakerObject:function(t,e){var i=new jr(t);return null!=e?e.addChild(i):this.root.addChild(i),i},addScene:function(t,e,i){var d=this;null==e&&((e=this.addObject()).name=t),Tr.getSceneRaw(t,function(c){xr.createTraits(c.traits,e),d.loadEmbeddedData(c.embedded_datas,function(){var h=0,u=d.getObjectsCount(c.objects),_=null;_=function(t,e,i,n){if(null!=e)for(var r=0,s=e.length;r<s;){var a=[e[r++]];if(null==a[0].spawn||0!=a[0].spawn){var o=a[0],l=function(e){return function(t){null!=t&&_(t,e[0].children,e[0],n),(h+=1)==u&&n()}}(a);d.createObject(o,c,t,i,l)}else(h+=1)==u&&n()}},null==c.objects||0==c.objects.length?i(e):_(e,c.objects,null,function(){i(e)})})})},getObjectsCount:function(t,e){if(null==e&&(e=!0),null==t)return 0;for(var i=t.length,n=0;n<t.length;){var r=t[n];++n,e&&null!=r.spawn&&0==r.spawn||null!=r.children&&(i+=this.getObjectsCount(r.children))}return i},spawnObject:function(t,e,i,a){null==a&&(a=!0);var n=this,o=0,r=this.getObj(this.raw,t),l=a?this.getObjectsCount([r],!1):1,h=null;(h=function(r,t,e,s){n.createObject(r,n.raw,t,e,function(t){if(a&&null!=r.children)for(var e=0,i=r.children;e<i.length;){var n=i[e];++e,h(n,t,r,s)}(o+=1)==l&&null!=s&&s(t)})})(r,e,null,i)},getObj:function(t,e){return this.traverseObjs(t.objects,e)},traverseObjs:function(t,e){for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n;if(null!=n.children){var r=this.traverseObjs(n.children,e);if(null!=r)return r}}return null},createObject:function(_,t,c,d,p){var f=this,g=t.name;if("camera_object"==_.type)Tr.getCamera(g,_.data_ref,function(t){var e=f.addCameraObject(t,c);f.returnObject(e,_,p)});else if("light_object"==_.type)Tr.getLight(g,_.data_ref,function(t){var e=f.addLightObject(t,c);f.returnObject(e,_,p)});else if("mesh_object"==_.type)if(null==_.material_refs||0==_.material_refs.length){var e=this.addObject(c);this.returnObject(e,_,p)}else for(var m=new Array(_.material_refs.length),a=0,i=0,n=_.material_refs.length;i<n;){var r=[i++],s=_.material_refs[r[0]],o=function(s){return function(t){if(m[s[0]]=t,(a+=1)==_.material_refs.length){var e=_.data_ref.split("/"),l="",h="";if(2==e.length?(l=e[0],h=e[1]):(l=g,h=_.data_ref),null!=d&&null!=d.bone_actions)for(var u=[],i=0,n=d.bone_actions;i<n.length;){var r=n[i];++i,Tr.getSceneRaw(r,function(t){if(u.push(t),u.length==d.bone_actions.length){for(var e=null,i=0,n=f.armatures;i<n.length;){var r=n[i];if(++i,r.uid==c.uid){e=r;break}}if(null==e){for(var s=0,a=f.armatures;s<a.length;){var o=a[s];if(++s,o.name==c.name){c.name+="."+c.uid;break}}e=new Sr(c.uid,c.name,u),f.armatures.push(e)}f.returnMeshObject(l,h,g,e,m,c,_,p)}})}else f.returnMeshObject(l,h,g,null,m,c,_,p)}}}(r);Tr.getMaterial(g,s,o)}else if("speaker_object"==_.type){var l=this.addSpeakerObject(Tr.getSpeakerRawByName(t.speaker_datas,_.data_ref),c);this.returnObject(l,_,p)}else if("object"==_.type){var h=this.addObject(c);this.returnObject(h,_,function(e){if(null!=_.group_ref){var i=0,n=f.getGroupObjectRefs(_.group_ref);if(0==n.length)p(e);else for(var t=0;t<n.length;){var r=n[t];++t,f.spawnObject(r,e,function(t){(i+=1)==n.length&&p(e)})}}else p(e)})}else p(null)},getGroupObjectRefs:function(t){for(var e=0,i=this.raw.groups;e<i.length;){var n=i[e];if(++e,n.name==t)return n.object_refs}return null},returnMeshObject:function(t,e,n,r,s,a,o,l){var h=this;Tr.getMesh(t,e,function(t){if(t.isSkinned){var e=t.geom;null!=r?e.addArmature(r):e.addAction(t.format.objects,"none")}var i=h.addMeshObject(t,s,a);null!=o.tilesheet_ref&&_s.__cast(i,Gr).setupTilesheet(n,o.tilesheet_ref,o.tilesheet_action_ref),h.returnObject(i,o,l)})},returnObject:function(i,n,r){var s=this;if(null!=i&&null!=n.object_actions){for(var a=[];a.length<n.object_actions.length;)a.push(null);for(var o=0,t=0,e=n.object_actions.length;t<e;){var l=[t++],h=n.object_actions[l[0]];"null"!=h?Tr.getSceneRaw(h,function(e){return function(t){a[e[0]]=t,(o+=1)==n.object_actions.length&&s.returnObjectLoaded(i,n,a,r)}}(l)):o+=1}}else this.returnObjectLoaded(i,n,null,r)},returnObjectLoaded:function(t,e,i,n){if(null!=t){if(t.raw=e,t.name=e.name,null!=e.visible&&(t.visible=e.visible),null!=e.visible_mesh&&(t.visibleMesh=e.visible_mesh),null!=e.visible_shadow&&(t.visibleShadow=e.visible_shadow),xr.createConstraints(e.constraints,t),xr.generateTransform(e,t.transform),t.setupAnimation(i),null!=e.groups){null==this.groups&&(this.groups=new ur);for(var r=0,s=e.groups;r<s.length;){var a=s[r];++r;var o=this.groups.get(a);null==o&&(o=[],this.groups.set(a,o)),o.push(t)}}if(null!=e.properties){t.properties=new ur;for(var l=0,h=e.properties;l<h.length;){var u=h[l];++l,t.properties.set(u.name,u.value)}}xr.createTraits(e.traits,t)}n(t)},loadEmbeddedData:function(i,n){var r=this;if(null!=i)for(var s=0,t=0;t<i.length;){var e=[i[t]];++t,Tr.getImage(e[0],function(e){return function(t){r.embedded.set(e[0],t),(s+=1)==i.length&&n()}}(e))}else n()},notifyOnInit:function(t){this.ready?t():this.traitInits.push(t)},__class__:xr};var Sr=function(t,e,i){this.actions=[],this.uid=t,this.name=e;for(var n=0;n<i.length;){var r=i[n];++n;for(var s=0,a=r.objects;s<a.length;){var o=a[s];++s,Sr.setParents(o)}var l=[[]];Sr.traverseBones(r.objects,function(e){return function(t){e[0].push(t)}}(l)),this.actions.push({name:r.name,bones:l[0],mats:null})}};(i["iron.data.Armature"]=Sr).__name__="iron.data.Armature",Sr.setParents=function(t){if(null!=t.children)for(var e=0,i=t.children;e<i.length;){var n=i[e];++e,n.parent=t,Sr.setParents(n)}},Sr.traverseBones=function(t,e){for(var i=0,n=t.length;i<n;){var r=i++;Sr.traverseBonesStep(t[r],e)}},Sr.traverseBonesStep=function(t,e){if("bone_object"==t.type&&e(t),null!=t.children)for(var i=0,n=t.children.length;i<n;){var r=i++;Sr.traverseBonesStep(t.children[r],e)}},Sr.prototype={__class__:Sr};var kr=function(t,e){this.raw=t,this.name=t.name,e(this)};(i["iron.data.CameraData"]=kr).__name__="iron.data.CameraData",kr.parse=function(t,i,n){Tr.getSceneRaw(t,function(t){var e=Tr.getCameraRawByName(t.camera_datas,i);null==e&&(Jn.trace('Camera data "'+i+'" not found!',{fileName:"Sources/iron/data/CameraData.hx",lineNumber:20,className:"iron.data.CameraData",methodName:"parse"}),n(null)),new kr(e,n)})},kr.prototype={__class__:kr};var Tr=function(){};(i["iron.data.Data"]=Tr).__name__="iron.data.Data",Tr.getMesh=function(t,e,i){var r=t+e,n=Tr.cachedMeshes.get(r);if(null==n){var s=Tr.loadingMeshes.get(r);null==s?(Tr.loadingMeshes.set(r,[i]),Er.parse(t,e,function(t){Tr.cachedMeshes.set(r,t),t.handle=r;for(var e=0,i=Tr.loadingMeshes.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingMeshes.remove(r)})):s.push(i)}else i(n)},Tr.getLight=function(t,e,i){var r=t+e,n=Tr.cachedLights.get(r);if(null==n){var s=Tr.loadingLights.get(r);null==s?(Tr.loadingLights.set(r,[i]),Ir.parse(t,e,function(t){Tr.cachedLights.set(r,t);for(var e=0,i=Tr.loadingLights.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingLights.remove(r)})):s.push(i)}else i(n)},Tr.getCamera=function(t,e,i){var r=t+e,n=Tr.cachedCameras.get(r);if(null==n){var s=Tr.loadingCameras.get(r);null==s?(Tr.loadingCameras.set(r,[i]),kr.parse(t,e,function(t){Tr.cachedCameras.set(r,t);for(var e=0,i=Tr.loadingCameras.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingCameras.remove(r)})):s.push(i)}else i(n)},Tr.getMaterial=function(t,e,i){var r=t+e,n=Tr.cachedMaterials.get(r);if(null==n){var s=Tr.loadingMaterials.get(r);null==s?(Tr.loadingMaterials.set(r,[i]),Nr.parse(t,e,function(t){Tr.cachedMaterials.set(r,t);for(var e=0,i=Tr.loadingMaterials.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingMaterials.remove(r)})):s.push(i)}else i(n)},Tr.getWorld=function(t,e,i){if(null!=e){var r=t+e,n=Tr.cachedWorlds.get(r);if(null==n){var s=Tr.loadingWorlds.get(r);null==s?(Tr.loadingWorlds.set(r,[i]),Ar.parse(t,e,function(t){Tr.cachedWorlds.set(r,t);for(var e=0,i=Tr.loadingWorlds.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingWorlds.remove(r)})):s.push(i)}else i(n)}else i(null)},Tr.getShader=function(t,e,i,n){var r=e;null!=n&&(r+="2");var s=Tr.cachedShaders.get(r);if(null==s){var a=Tr.loadingShaders.get(r);null==a?(Tr.loadingShaders.set(r,[i]),Mr.parse(t,e,function(t){Tr.cachedShaders.set(r,t);for(var e=0,i=Tr.loadingShaders.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingShaders.remove(r)},n)):a.push(i)}else i(s)},Tr.getSceneRaw=function(n,t){var e=Tr.cachedSceneRaws.get(n);if(null==e){var i=Tr.loadingSceneRaws.get(n);if(null==i){Tr.loadingSceneRaws.set(n,[t]);var r=q.endsWith(n,".zip"),s=q.endsWith(n,".json"),a=r||s||q.endsWith(n,".arm")?"":".arm";Tr.getBlob(n+a,function(t){var e=null;if(s){var i=t.toString();e="{"==i.charAt(0)?JSON.parse(i):Qr.decode(t.toBytes())}else e=Qr.decode(t.toBytes());Tr.returnSceneRaw(n,e)})}else i.push(t)}else t(e)},Tr.returnSceneRaw=function(t,e){Tr.cachedSceneRaws.set(t,e);for(var i=0,n=Tr.loadingSceneRaws.get(t);i<n.length;){var r=n[i];++i,r(e)}Tr.loadingSceneRaws.remove(t)},Tr.getMeshRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getLightRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getCameraRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getMaterialRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getWorldRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getShaderRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getSpeakerRawByName=function(t,e){if(""==e)return t[0];for(var i=0;i<t.length;){var n=t[i];if(++i,n.name==e)return n}return null},Tr.getBlob=function(r,t){var e=Tr.cachedBlobs.get(r);if(null==e){var i=Tr.loadingBlobs.get(r);if(null==i){Tr.loadingBlobs.set(r,[t]);var n="/"==r.charAt(0)||":"==r.charAt(1)?r:Tr.dataPath+r;ws.loadBlobFromPath(n,function(t){Tr.cachedBlobs.set(r,t);for(var e=0,i=Tr.loadingBlobs.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingBlobs.remove(r),Tr.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:378,className:"iron.data.Data",methodName:"getBlob"})}else i.push(t)}else t(e)},Tr.getImage=function(r,t,e,i){null==i&&(i="RGBA32"),null==e&&(e=!1);var n=Tr.cachedImages.get(r);if(null==n){var s=Tr.loadingImages.get(r);if(null==s){Tr.loadingImages.set(r,[t]);var a="/"==r.charAt(0)||":"==r.charAt(1)?r:Tr.dataPath+r;ws.loadImageFromPath(a,e,function(t){Tr.cachedImages.set(r,t);for(var e=0,i=Tr.loadingImages.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingImages.remove(r),Tr.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:403,className:"iron.data.Data",methodName:"getImage"})}else s.push(t)}else t(n)},Tr.getSound=function(t,e){e(null)},Tr.getFont=function(r,t){var e=Tr.cachedFonts.get(r);if(null==e){var i=Tr.loadingFonts.get(r);if(null==i){Tr.loadingFonts.set(r,[t]);var n="/"==r.charAt(0)||":"==r.charAt(1)?r:Tr.dataPath+r;ws.loadFontFromPath(n,function(t){Tr.cachedFonts.set(r,t);for(var e=0,i=Tr.loadingFonts.get(r);e<i.length;){var n=i[e];++e,n(t)}Tr.loadingFonts.remove(r),Tr.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:494,className:"iron.data.Data",methodName:"getFont"})}else i.push(t)}else t(e)};var Cr=function(t,e,i,n,r,s,a,o,l,h,u,_){this.mats=null,this.actions=null,this.skeletonBoneLens=null,this.skeletonBoneRefs=null,this.skeletonTransformsI=null,this.skinBoneWeights=null,this.skinBoneIndices=null,this.skinBoneCounts=null,this.instanceCount=0,this.instanced=!1,this.instancedVB=null,this.numTris=0,this.ready=!1,this.name="",this.count=-1,this.start=0,this.vertexBufferMap=new ur,null==_&&(_=0),this.indices=e,this.materialIndices=i,this.usage=_,this.positions=n,this.normals=r,this.uvs=s,this.uvs1=a,this.cols=o,this.tangents=l,this.bones=h,this.weights=u,this.data=t,this.struct=Cr.getVertexStructure(null!=n,null!=r,null!=s,null!=a,null!=o,null!=l,null!=h,null!=u),this.structLength=pt.int(this.struct.byteSize()/2),this.structStr="";for(var c=0,d=this.struct.elements;c<d.length;){var p=d[c];++c,this.structStr+=p.name}};(i["iron.data.Geometry"]=Cr).__name__="iron.data.Geometry",Cr.getVertexStructure=function(t,e,i,n,r,s,a,o){null==o&&(o=!1),null==a&&(a=!1),null==s&&(s=!1),null==r&&(r=!1),null==n&&(n=!1),null==i&&(i=!1),null==e&&(e=!1),null==t&&(t=!1);var l=new Va;return t&&l.add("pos",6),e&&l.add("nor",5),i&&l.add("tex",5),n&&l.add("tex1",5),r&&l.add("col",6),s&&l.add("tang",6),a&&l.add("bone",6),o&&l.add("weight",6),l},Cr.buildVertices=function(t,e,i,n,r,s,a,o,l,h,u){null==u&&(u=!1),null==h&&(h=0);for(var _=-1+h,c=0,d=pt.int(e.length/4);c<d;){var p=c++;t[++_]=e[4*p],t[++_]=e[4*p+1],t[++_]=e[4*p+2],t[++_]=e[4*p+3],null!=i&&(t[++_]=i[2*p],t[++_]=i[2*p+1]),null!=n?(t[++_]=n[2*p],t[++_]=n[2*p+1]):u&&(t[++_]=0,t[++_]=0),null!=r&&(t[++_]=r[2*p],t[++_]=r[2*p+1]),null!=s&&(t[++_]=s[3*p],t[++_]=s[3*p+1],t[++_]=s[3*p+2],t[++_]=0),null!=a&&(t[++_]=a[3*p],t[++_]=a[3*p+1],t[++_]=a[3*p+2],t[++_]=0),null!=o&&(t[++_]=o[4*p],t[++_]=o[4*p+1],t[++_]=o[4*p+2],t[++_]=o[4*p+3]),null!=l&&(t[++_]=l[4*p],t[++_]=l[4*p+1],t[++_]=l[4*p+2],t[++_]=l[4*p+3])}},Cr.prototype={setupInstanced:function(t,e,i){var n=new Va;n.instanced=!0,this.instanced=!0,n.add("ipos",2),2!=e&&4!=e||n.add("irot",2),3!=e&&4!=e||n.add("iscl",2),this.instanceCount=pt.int(t.length/pt.int(n.byteSize()/4)),this.instancedVB=new Pa(this.instanceCount,n,i,1);for(var r=this.instancedVB.lock(),s=0,a=r.length;s<a;){var o=s++;r[o]=t[o]}this.instancedVB.unlock()},hasAttrib:function(t,e){for(var i=0;i<e.length;){var n=e[i];if(++i,n.name==t)return!0}return!1},get:function(t){for(var e="",i=0;i<t.length;){var n=t[i];++i,e+=n.name}var r=this.vertexBufferMap.get(e);if(null==r){var s=this.hasAttrib("pos",t),a=this.hasAttrib("nor",t),o=this.hasAttrib("tex",t),l=this.hasAttrib("tex1",t),h=this.hasAttrib("col",t),u=this.hasAttrib("tang",t),_=this.hasAttrib("bone",t),c=this.hasAttrib("weight",t),d=Cr.getVertexStructure(s,a,o,l,h,u,_,c);r=new Pa(pt.int(this.positions.length/4),d,this.usage),this.vertices=r.lockInt16(),Cr.buildVertices(this.vertices,s?this.positions:null,a?this.normals:null,o?this.uvs:null,l?this.uvs1:null,h?this.cols:null,u?this.tangents:null,_?this.bones:null,c?this.weights:null,0,o&&null==this.uvs),r.unlock(),this.vertexBufferMap.set(e,r),o&&null==this.uvs&&Jn.trace("Armory Warning: Geometry "+this.name+" is missing UV map",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:321,className:"iron.data.Geometry",methodName:"get"}),h&&null==this.cols&&Jn.trace("Armory Warning: Geometry "+this.name+" is missing vertex colors",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:322,className:"iron.data.Geometry",methodName:"get"})}return r},build:function(){if(!this.ready){this.vertexBuffer=new Pa(pt.int(this.positions.length/4),this.struct,this.usage),this.vertices=this.vertexBuffer.lockInt16(),Cr.buildVertices(this.vertices,this.positions,this.normals,this.uvs,this.uvs1,this.cols,this.tangents,this.bones,this.weights),this.vertexBuffer.unlock(),this.vertexBufferMap.set(this.structStr,this.vertexBuffer),this.indexBuffers=[];for(var t=0,e=this.indices;t<e.length;){var i=e[t];if(++t,0!=i.length){var n=new Ea(i.length,this.usage);this.numTris+=pt.int(i.length/3);for(var r=n.lock(),s=0,a=r.length;s<a;){var o=s++;r[o]=i[o]}n.unlock(),this.indexBuffers.push(n)}}null!=this.data.raw.instanced_data&&this.setupInstanced(this.data.raw.instanced_data,this.data.raw.instanced_type,this.usage),this.ready=!0}},addArmature:function(t){for(var e=0,i=t.actions;e<i.length;){var n=i[e];++e,this.addAction(n.bones,n.name)}},addAction:function(t,e){if(null!=t&&(null==this.actions&&(this.actions=new ur,this.mats=new ur),null==this.actions.get(e))){for(var i=[],n=0,r=this.skeletonBoneRefs;n<r.length;){var s=r[n];++n;for(var a=0;a<t.length;){var o=t[a];++a,o.name==s&&i.push(o)}}this.actions.set(e,i);for(var l=[],h=0;h<i.length;){var u=i[h];++h,l.push(xn.fromFloat32Array(u.transform.values))}this.mats.set(e,l)}},initSkeletonTransforms:function(t){this.skeletonTransformsI=[];for(var e=0;e<t.length;){var i=t[e];++e;var n=xn.fromFloat32Array(i);this.skeletonTransformsI.push(n)}},__class__:Cr};var Ir=function(t,e){this.colorTexture=null;var i=this;this.raw=t,this.name=t.name,null!=t.color_texture?Tr.getImage(t.color_texture,function(t){i.colorTexture=t,e(i)}):e(this)};(i["iron.data.LightData"]=Ir).__name__="iron.data.LightData",Ir.parse=function(t,i,n){Tr.getSceneRaw(t,function(t){var e=Tr.getLightRawByName(t.light_datas,i);null==e&&(Jn.trace('Light data "'+i+'" not found!',{fileName:"Sources/iron/data/LightData.hx",lineNumber:40,className:"iron.data.LightData",methodName:"parse"}),n(null)),new Ir(e,n)})},Ir.prototype={__class__:Ir};var Nr=function(a,o,t){null==t&&(t=""),this.contexts=null;var l=this;this.uid=++Nr.uidCounter,this.raw=a,this.name=a.name;var e=a.shader.split("/"),i="",n="";2==e.length?(i=e[0],n=e[1]):(i=t,n=a.shader),Tr.getShader(i,n,function(t){for(l.shader=t,l.contexts=[];l.contexts.length<a.contexts.length;)l.contexts.push(null);for(var i=0,e=0,n=a.contexts.length;e<n;){var r=[e++],s=a.contexts[r[0]];new Or(s,function(e){return function(t){l.contexts[e[0]]=t,(i+=1)==a.contexts.length&&o(l)}}(r))}},a.override_context)};(i["iron.data.MaterialData"]=Nr).__name__="iron.data.MaterialData",Nr.parse=function(i,n,r){Tr.getSceneRaw(i,function(t){var e=Tr.getMaterialRawByName(t.material_datas,n);null==e&&(Jn.trace('Material data "'+n+'" not found!',{fileName:"Sources/iron/data/MaterialData.hx",lineNumber:58,className:"iron.data.MaterialData",methodName:"parse"}),r(null)),new Nr(e,r,i)})},Nr.prototype={getContext:function(t){for(var e=0,i=this.contexts;e<i.length;){var n=i[e];if(++e,ht.substr(n.raw.name,0,t.length)==t)return n}return null},__class__:Nr};var Or=function(h,u){this.id=0,this.textures=null;var _=this;if(this.raw=h,this.id=Or.num++,null!=h.bind_textures&&0<h.bind_textures.length){var t=new Array(h.bind_textures.length);this.textures=t;for(var c=0,e=0,i=h.bind_textures.length;e<i;){var n=[e++],r=[h.bind_textures[n[0]]];""!=r[0].file?Tr.getImage(r[0].file,function(o,l){return function(n){if(_.textures[l[0]]=n,c+=1,null!=o[0].mipmaps){for(var r=[];r.length<o[0].mipmaps.length;)r.push(null);for(var s=0,t=0,e=o[0].mipmaps.length;t<e;){var i=[t++],a=o[0].mipmaps[i[0]];Tr.getImage(a,function(e,i){return function(t){r[e[0]]=t,(s+=1)==i[0].mipmaps.length&&(n.setMipmaps(r),i[0].mipmaps=null,i[0].generate_mipmaps=!1,c==h.bind_textures.length&&u(_))}}(i,o))}}else 1==o[0].generate_mipmaps&&null!=n&&(n.generateMipmaps(1e3),o[0].mipmaps=null,o[0].generate_mipmaps=!1),c==h.bind_textures.length&&u(_)}}(r,n),!1,null!=r[0].format?r[0].format:"RGBA32"):(c+=1)==h.bind_textures.length&&u(this)}}else u(this)};(i["iron.data.MaterialContext"]=Or).__name__="iron.data.MaterialContext",Or.prototype={setTextureParameters:function(t,e,i,n){i.setTextureParameters(t,n,this.raw.bind_textures[e])},__class__:Or};var Er=function(t,e){this.scaleTex=1,this.scalePos=1,this.refcount=0,this.raw=t,this.name=t.name,null!=t.scale_pos&&(this.scalePos=t.scale_pos),null!=t.scale_tex&&(this.scaleTex=t.scale_tex);for(var i=[],n=[],r=0,s=t.index_arrays;r<s.length;){var a=s[r];++r,i.push(a.values),n.push(a.material)}var o=this.getVertexArrayValues("pos"),l=this.getVertexArrayValues("nor"),h=this.getVertexArrayValues("tex"),u=this.getVertexArrayValues("tex1"),_=this.getVertexArrayValues("col"),c=this.getVertexArrayValues("tang");this.isSkinned=null!=t.skin;var d=0;null!=t.dynamic_usage&&1==t.dynamic_usage&&(d=1);var p=d,f=null,g=null;if(this.isSkinned){var m=4*pt.int(o.length/4);f=new Int16Array(m),g=new Int16Array(m);for(var v=0,y=0,w=0,b=pt.int(o.length/4);w<b;){for(var x=w++,S=t.skin.bone_count_array[x],k=v,T=v+S;k<T;){var C=k++;f[y]=t.skin.bone_index_array[C],g[y]=t.skin.bone_weight_array[C],++y}for(var I=S;I<4;){I++;f[y]=0,g[y]=0,++y}v+=S}}this.geom=new Cr(this,i,n,o,l,h,u,_,c,f,g,p),this.geom.name=this.name,e(this)};(i["iron.data.MeshData"]=Er).__name__="iron.data.MeshData",Er.parse=function(t,n,r){Tr.getSceneRaw(t,function(e){var i=Tr.getMeshRawByName(e.mesh_datas,n);null==i&&(Jn.trace('Mesh data "'+n+'" not found!',{fileName:"Sources/iron/data/MeshData.hx",lineNumber:104,className:"iron.data.MeshData",methodName:"parse"}),r(null)),new Er(i,function(t){t.format=e,null!=i.skin&&(t.geom.skinBoneCounts=i.skin.bone_count_array,t.geom.skinBoneIndices=i.skin.bone_index_array,t.geom.skinBoneWeights=i.skin.bone_weight_array,t.geom.skeletonBoneRefs=i.skin.bone_ref_array,t.geom.skeletonBoneLens=i.skin.bone_len_array,t.geom.initSkeletonTransforms(i.skin.transformsI)),r(t)})})},Er.prototype={getVertexArrayValues:function(t){for(var e=0,i=this.raw.vertex_arrays;e<i.length;){var n=i[e];if(++e,n.attrib==t)return n.values}return null},__class__:Er};var Mr=function(i,n,t){this.contexts=[];var r=this;this.raw=i,this.name=i.name;for(var e=0,s=i.contexts;e<s.length;){s[e];++e,this.contexts.push(null)}for(var a=0,o=0,l=i.contexts.length;o<l;){var h=[o++],u=i.contexts[h[0]];new Lr(u,function(e){return function(t){r.contexts[e[0]]=t,(a+=1)==i.contexts.length&&n(r)}}(h),t)}};(i["iron.data.ShaderData"]=Mr).__name__="iron.data.ShaderData",Mr.parse=function(t,i,n,r){Tr.getSceneRaw(t,function(t){var e=Tr.getShaderRawByName(t.shader_datas,i);null==e&&(Jn.trace('Shader data "'+i+'" not found!',{fileName:"Sources/iron/data/ShaderData.hx",lineNumber:47,className:"iron.data.ShaderData",methodName:"parse"}),n(null)),new Mr(e,n,r)})},Mr.prototype={getContext:function(t){for(var e=0,i=this.contexts;e<i.length;){var n=i[e];if(++e,n.raw.name==t)return n}return null},__class__:Mr};var Lr=function(t,e,i){this.instancingType=0,this.raw=t,this.overrideContext=i,this.parseVertexStructure(),this.compile(e)};(i["iron.data.ShaderContext"]=Lr).__name__="iron.data.ShaderContext",Lr.prototype={compile:function(t){if(null!=this.pipeState&&this.pipeState.delete(),this.pipeState=new La,this.constants=[],this.textureUnits=[],0<this.instancingType){var e=new Va;e.add("ipos",2),2!=this.instancingType&&4!=this.instancingType||e.add("irot",2),3!=this.instancingType&&4!=this.instancingType||e.add("iscl",2),e.instanced=!0,this.pipeState.inputLayout=[this.structure,e]}else this.pipeState.inputLayout=[this.structure];if(this.pipeState.depthWrite=this.raw.depth_write,this.pipeState.depthMode=this.getCompareMode(this.raw.compare_mode),null!=this.raw.stencil_mode&&("always"==this.raw.stencil_mode?this.pipeState.stencilMode=0:"equal"==this.raw.stencil_mode?this.pipeState.stencilMode=2:"not_equal"==this.raw.stencil_mode&&(this.pipeState.stencilMode=3)),null!=this.raw.stencil_pass&&("replace"==this.raw.stencil_pass?this.pipeState.stencilBothPass=2:"keep"==this.raw.stencil_pass&&(this.pipeState.stencilBothPass=0)),null!=this.raw.stencil_fail&&"keep"==this.raw.stencil_fail&&(this.pipeState.stencilDepthFail=0,this.pipeState.stencilFail=0),null!=this.raw.stencil_reference_value&&(this.pipeState.stencilReferenceValue=Aa.Static(this.raw.stencil_reference_value)),this.pipeState.cullMode=this.getCullMode(this.raw.cull_mode),null!=this.raw.blend_source&&(this.pipeState.blendSource=this.getBlendingFactor(this.raw.blend_source)),null!=this.raw.blend_destination&&(this.pipeState.blendDestination=this.getBlendingFactor(this.raw.blend_destination)),null!=this.raw.blend_operation&&(this.pipeState.blendOperation=this.getBlendingOperation(this.raw.blend_operation)),null!=this.raw.alpha_blend_source&&(this.pipeState.alphaBlendSource=this.getBlendingFactor(this.raw.alpha_blend_source)),null!=this.raw.alpha_blend_destination&&(this.pipeState.alphaBlendDestination=this.getBlendingFactor(this.raw.alpha_blend_destination)),null!=this.raw.alpha_blend_operation&&(this.pipeState.alphaBlendOperation=this.getBlendingOperation(this.raw.alpha_blend_operation)),null!=this.raw.color_write_red&&this.pipeState.set_colorWriteMaskRed(this.raw.color_write_red),null!=this.raw.color_write_green&&this.pipeState.set_colorWriteMaskGreen(this.raw.color_write_green),null!=this.raw.color_write_blue&&this.pipeState.set_colorWriteMaskBlue(this.raw.color_write_blue),null!=this.raw.color_write_alpha&&this.pipeState.set_colorWriteMaskAlpha(this.raw.color_write_alpha),null!=this.raw.color_writes_red)for(var i=0,n=this.raw.color_writes_red.length;i<n;){var r=i++;this.pipeState.colorWriteMasksRed[r]=this.raw.color_writes_red[r]}if(null!=this.raw.color_writes_green)for(var s=0,a=this.raw.color_writes_green.length;s<a;){var o=s++;this.pipeState.colorWriteMasksGreen[o]=this.raw.color_writes_green[o]}if(null!=this.raw.color_writes_blue)for(var l=0,h=this.raw.color_writes_blue.length;l<h;){var u=l++;this.pipeState.colorWriteMasksBlue[u]=this.raw.color_writes_blue[u]}if(null!=this.raw.color_writes_alpha)for(var _=0,c=this.raw.color_writes_alpha.length;_<c;){var d=_++;this.pipeState.colorWriteMasksAlpha[d]=this.raw.color_writes_alpha[d]}if(null!=this.raw.conservative_raster&&(this.pipeState.conservativeRasterization=this.raw.conservative_raster),this.raw.shader_from_source)this.pipeState.fragmentShader=Sa.fromSource(this.raw.fragment_shader),this.pipeState.vertexShader=Wa.fromSource(this.raw.vertex_shader),this.finishCompile(t);else{var p=q.replace(this.raw.fragment_shader,".","_");this.pipeState.fragmentShader=V.field(Ds,p);var f=q.replace(this.raw.vertex_shader,".","_");if(this.pipeState.vertexShader=V.field(Ds,f),null!=this.raw.geometry_shader){var g=q.replace(this.raw.geometry_shader,".","_");this.pipeState.geometryShader=V.field(Ds,g)}if(null!=this.raw.tesscontrol_shader){var m=q.replace(this.raw.tesscontrol_shader,".","_");this.pipeState.tessellationControlShader=V.field(Ds,m)}if(null!=this.raw.tesseval_shader){var v=q.replace(this.raw.tesseval_shader,".","_");this.pipeState.tessellationEvaluationShader=V.field(Ds,v)}this.finishCompile(t)}},finishCompile:function(t){if(null!=this.overrideContext&&null!=this.overrideContext.cull_mode&&(this.pipeState.cullMode=this.getCullMode(this.overrideContext.cull_mode)),this.pipeState.compile(),null!=this.raw.constants)for(var e=0,i=this.raw.constants;e<i.length;){var n=i[e];++e,this.addConstant(n)}if(null!=this.raw.texture_units)for(var r=0,s=this.raw.texture_units;r<s.length;){var a=s[r];++r,this.addTexture(a)}t(this)},parseData:function(t){return"float1"==t?0:"float2"==t?1:"float3"==t?2:"float4"==t?3:"short2norm"==t?5:"short4norm"==t?6:0},parseVertexStructure:function(){this.structure=new Va;for(var t=!1,e=!1,i=!1,n=0,r=this.raw.vertex_elements;n<r.length;){var s=r[n];++n,"ipos"!=s.name?"irot"!=s.name?"iscl"!=s.name?this.structure.add(s.name,this.parseData(s.data)):i=!0:e=!0:t=!0}!t||e||i?t&&e&&!i?this.instancingType=2:t&&!e&&i?this.instancingType=3:t&&e&&i&&(this.instancingType=4):this.instancingType=1},getCompareMode:function(t){switch(t){case"always":return 0;case"equal":return 2;case"greater":return 6;case"greater_equal":return 7;case"less":return 4;case"less_equal":return 5;case"never":return 1;case"not_equal":return 3;default:return 4}},getCullMode:function(t){switch(t){case"clockwise":return 0;case"none":return 2;default:return 1}},getBlendingOperation:function(t){switch(t){case"add":return 0;case"max":return 4;case"min":return 3;case"reverse_subtract":return 2;case"subtract":return 1;default:return 0}},getBlendingFactor:function(t){switch(t){case"blend_one":return 1;case"blend_zero":return 2;case"destination_alpha":return 4;case"destination_color":return 8;case"inverse_destination_alpha":return 6;case"inverse_destination_color":return 10;case"inverse_source_alpha":return 5;case"inverse_source_color":return 9;case"source_alpha":return 3;case"source_color":return 7;default:return 0}},getTextureAddresing:function(t){switch(t){case"mirror":return 1;case"repeat":return 0;default:return 2}},getTextureFilter:function(t){switch(t){case"linear":return 1;case"point":return 0;default:return 2}},getMipmapFilter:function(t){switch(t){case"no":return 0;case"point":return 1;default:return 2}},addConstant:function(t){this.constants.push(this.pipeState.getConstantLocation(t.name))},addTexture:function(t){var e=this.pipeState.getTextureUnit(t.name);this.textureUnits.push(e)},setTextureParameters:function(t,e,i){var n=this.textureUnits[e];t.setTextureParameters(n,null==i.u_addressing?0:this.getTextureAddresing(i.u_addressing),null==i.v_addressing?0:this.getTextureAddresing(i.v_addressing),null==i.min_filter?1:this.getTextureFilter(i.min_filter),null==i.mag_filter?1:this.getTextureFilter(i.mag_filter),null==i.mipmap_filter?0:this.getMipmapFilter(i.mipmap_filter))},__class__:Lr};var Ar=function(t,e){var i=this;this.raw=t,this.name=t.name,null!=t.probe?new Br(t.probe,function(t){i.probe=t,i.loadEnvmap(e)}):this.loadEnvmap(e)};(i["iron.data.WorldData"]=Ar).__name__="iron.data.WorldData",Ar.parse=function(t,i,n){Tr.getSceneRaw(t,function(t){var e=Tr.getWorldRawByName(t.world_datas,i);null==e&&(Jn.trace('World data "'+i+'" not found!',{fileName:"Sources/iron/data/WorldData.hx",lineNumber:45,className:"iron.data.WorldData",methodName:"parse"}),n(null)),new Ar(e,n)})},Ar.getEmptyIrradiance=function(){if(null==Ar.emptyIrr){var t=new Float32Array(28);Ar.emptyIrr=t;for(var e=0,i=Ar.emptyIrr.length;e<i;){var n=e++;Ar.emptyIrr[n]=0}}return Ar.emptyIrr},Ar.prototype={loadEnvmap:function(e){var i=this;null!=this.raw.envmap?Tr.getImage(this.raw.envmap,function(t){i.envmap=t,e(i)}):e(this)},__class__:Ar};var Br=function(o,l){this.radianceMipmaps=[];var h=this;this.raw=o,this.setIrradiance(function(t){h.irradiance=t,null!=o.radiance?Tr.getImage(o.radiance,function(t){for(h.radiance=t;h.radianceMipmaps.length<o.radiance_mipmaps;)h.radianceMipmaps.push(null);for(var e=o.radiance.substring(o.radiance.length-4),i=o.radiance.substring(0,o.radiance.length-4),n=0,r=0,s=o.radiance_mipmaps;r<s;){var a=[r++];Tr.getImage(i+"_"+a[0]+e,function(e){return function(t){h.radianceMipmaps[e[0]]=t,(n+=1)==o.radiance_mipmaps&&(h.radiance.setMipmaps(h.radianceMipmaps),l(h))}}(a),!0)}}):l(h)})};(i["iron.data.Probe"]=Br).__name__="iron.data.Probe",Br.prototype={setIrradiance:function(n){if(null==this.raw.irradiance){for(var t=[.775966,1.16761,1.498638,.133694,.215281,.056659,-.022268,-.019376,-.010651,279e-6,185e-6,0,0,-393e-6,-775e-6,.010973,.027268,.043918,.085267,.07367,.038877,0,0,0,.135177,.115614,.060794],e=new Float32Array(t.length),i=0,r=e.length;i<r;){var s=i++;e[s]=t[s]}n(e)}else{var a=q.endsWith(this.raw.irradiance,".json")?"":".arm";Tr.getBlob(this.raw.irradiance+a,function(t){var e=""==a?JSON.parse(t.toString()):Qr.decode(t.toBytes()),i=new Float32Array(28);i[0]=e.irradiance[0],i[1]=e.irradiance[1],i[2]=e.irradiance[2],i[3]=e.irradiance[3],i[4]=e.irradiance[4],i[5]=e.irradiance[5],i[6]=e.irradiance[6],i[7]=e.irradiance[7],i[8]=e.irradiance[8],i[9]=e.irradiance[9],i[10]=e.irradiance[10],i[11]=e.irradiance[11],i[12]=e.irradiance[12],i[13]=e.irradiance[13],i[14]=e.irradiance[14],i[15]=e.irradiance[15],i[16]=e.irradiance[16],i[17]=e.irradiance[17],i[18]=e.irradiance[18],i[19]=e.irradiance[19],i[20]=e.irradiance[20],i[21]=e.irradiance[21],i[22]=e.irradiance[22],i[23]=e.irradiance[23],i[24]=e.irradiance[24],i[25]=e.irradiance[25],i[26]=e.irradiance[26],i[27]=0,n(i)})}},__class__:Br};var Rr=function(t,e,i,n,r,s,a,o,l){this.self=new Zr(t,e,i,n,r,s,a,o,l)};(i["iron.math.Mat3"]=Rr).__name__="iron.math.Mat3",Rr.identity=function(){return new Rr(1,0,0,0,1,0,0,0,1)},Rr.prototype={setFrom4:function(t){this.set__00(t.get__00()),this.set__01(t.get__01()),this.set__02(t.get__02()),this.set__10(t.get__10()),this.set__11(t.get__11()),this.set__12(t.get__12()),this.set__20(t.get__20()),this.set__21(t.get__21()),this.set__22(t.get__22())},set__00:function(t){return this.self._00=t},set__01:function(t){return this.self._01=t},set__02:function(t){return this.self._02=t},set__10:function(t){return this.self._10=t},set__11:function(t){return this.self._11=t},set__12:function(t){return this.self._12=t},set__20:function(t){return this.self._20=t},set__21:function(t){return this.self._21=t},set__22:function(t){return this.self._22=t},__class__:Rr,__properties__:{set__22:"set__22",set__21:"set__21",set__20:"set__20",set__12:"set__12",set__11:"set__11",set__10:"set__10",set__02:"set__02",set__01:"set__01",set__00:"set__00"}};var Fr=function(){};(i["iron.math.Math"]=Fr).__name__="iron.math.Math",Fr.__properties__={get_NaN:"get_NaN"},Fr.get_NaN=function(){return NaN},Fr.asin=function(t){return Math.asin(t)},Fr.atan2=function(t,e){return Math.atan2(t,e)},Fr.cos=function(t){return Math.cos(t)},Fr.sin=function(t){return Math.sin(t)},Fr.sqrt=function(t){return Math.sqrt(t)},Fr.tan=function(t){return Math.tan(t)},Fr.isNaN=function(t){return isNaN(t)},Fr.clamp=function(t,e,i){return t<e?e:i<t?i:t},Fr.fract=function(t){return t-pt.int(t)};var Pr=function(){this.markerEvents=null,this.lastFrameIndex=-1,this.blendFactor=0,this.blendAction="",this.blendCurrent=0,this.blendTime=0,this.paused=!1,this.onComplete=null,this.frameIndex=0,this.loop=!0,this.speed=1,this.time=0,this.action="",xr.active.animations.push(this),this.frameTime=xr.active.raw.frame_time,this.play()};(i["iron.object.Animation"]=Pr).__name__="iron.object.Animation",Pr.prototype={play:function(t,e,i,n,r){null==r&&(r=!0),null==n&&(n=1),null==i&&(i=0),null==t&&(t=""),0<i?(this.blendTime=i,this.blendCurrent=0,this.blendAction=this.action):this.frameIndex=-1,this.action=t,this.onComplete=e,this.speed=n,this.loop=r,this.paused=!1},blend:function(t,e,i){this.blendTime=1,this.blendFactor=i},pause:function(){this.paused=!0},resume:function(){this.paused=!1},remove:function(){ht.remove(xr.active.animations,this)},update:function(t){this.paused||0==this.speed||(this.time+=t*this.speed,0<this.blendTime&&0==this.blendFactor&&(this.blendCurrent+=t,this.blendCurrent>=this.blendTime&&(this.blendTime=0)))},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-1:this.frameIndex<=0},checkFrameIndex:function(t){return 0<this.speed?this.frameIndex+1<t.length&&this.time>t[this.frameIndex+1]*this.frameTime:-1<this.frameIndex-1&&this.time<t[this.frameIndex-1]*this.frameTime},rewind:function(t){this.frameIndex=0<this.speed?0:t.frames.length-1,this.time=t.frames[this.frameIndex]*this.frameTime},updateTrack:function(t){if(null!=t){var e=t.tracks[0];-1==this.frameIndex&&this.rewind(e);for(var i=0<this.speed?1:-1;this.checkFrameIndex(e.frames);)this.frameIndex+=i;if(null!=this.markerEvents&&null!=t.marker_names&&this.frameIndex!=this.lastFrameIndex){for(var n=0,r=t.marker_frames.length;n<r;){var s=n++;if(this.frameIndex==t.marker_frames[s])for(var a=this.markerEvents.get(t.marker_names[s]),o=0;o<a.length;){var l=a[o];++o,l()}}this.lastFrameIndex=this.frameIndex}this.isTrackEnd(e)&&(this.loop||0<this.blendTime?this.rewind(e):(this.frameIndex-=i,this.paused=!0),null!=this.onComplete&&0==this.blendTime&&this.onComplete())}},updateAnimSampled:function(t,e){if(null!=t){var i=t.tracks[0],n=0<this.speed?1:-1,r=this.time,s=this.frameIndex,a=i.frames[s]*this.frameTime,o=(r-a)/(i.frames[s+n]*this.frameTime-a);Pr.m1.setF32(i.values,16*s),Pr.m2.setF32(i.values,16*(s+n)),Pr.m1.decompose(Pr.vpos,Pr.q1,Pr.vscl),Pr.m2.decompose(Pr.vpos2,Pr.q2,Pr.vscl2),Pr.vp.lerp(Pr.vpos,Pr.vpos2,o),Pr.vs.lerp(Pr.vscl,Pr.vscl2,o),Pr.q3.lerp(Pr.q1,Pr.q2,o),e.fromQuat(Pr.q3),e.scale(Pr.vs),e.set__30(Pr.vp.x),e.set__31(Pr.vp.y),e.set__32(Pr.vp.z)}},notifyOnMarker:function(t,e){null==this.markerEvents&&(this.markerEvents=new ur);var i=this.markerEvents.get(t);null==i&&(i=[],this.markerEvents.set(t,i)),i.push(e)},currentFrame:function(){return pt.int(this.time/this.frameTime)},__class__:Pr};var Dr=function(){this.isEmpty=!1,this.properties=null,this.culledShadow=!1,this.culledMesh=!1,this.culled=!1,this.visibleShadow=!0,this.visibleMesh=!0,this.visible=!0,this.animation=null,this.lods=null,this.children=[],this.parent=null,this.traits=[],this.constraints=null,this.name="",this.raw=null,this.uid=Dr.uidCounter++,this.urandom=Dr.seededRandom(),this.transform=new Yr(this),this.isEmpty=J.getClass(this)==Dr,this.isEmpty&&null!=xr.active&&xr.active.empties.push(this)};(i["iron.object.Object"]=Dr).__name__="iron.object.Object",Dr.seededRandom=function(){return Dr.seed=(9301*Dr.seed+49297)%233280,Dr.seed/233280},Dr.prototype={addChild:function(t,e){null==e&&(e=!1),t.parent!=this&&(this.children.push(t),t.parent=this,e&&t.transform.applyParentInverse())},removeChild:function(t,e){null==e&&(e=!1),e&&t.transform.applyParent(),t.parent=null,t.transform.buildMatrix(),ht.remove(this.children,t)},remove:function(){for(this.isEmpty&&null!=xr.active&&ht.remove(xr.active.empties,this),null!=this.animation&&this.animation.remove();0<this.children.length;)this.children[0].remove();for(;0<this.traits.length;)this.traits[0].remove();null!=this.parent&&(ht.remove(this.parent.children,this),this.parent=null)},getChild:function(t){if(this.name==t)return this;for(var e=0,i=this.children;e<i.length;){var n=i[e];++e;var r=n.getChild(t);if(null!=r)return r}return null},addTrait:function(t){if(this.traits.push(t),t.object=this,null!=t._add){for(var e=0,i=t._add;e<i.length;){var n=i[e];++e,n()}t._add=null}},removeTrait:function(t){if(null!=t._init){for(var e=0,i=t._init;e<i.length;){var n=i[e];++e,vr.removeInit(n)}t._init=null}if(null!=t._update){for(var r=0,s=t._update;r<s.length;){var a=s[r];++r,vr.removeUpdate(a)}t._update=null}if(null!=t._lateUpdate){for(var o=0,l=t._lateUpdate;o<l.length;){var h=l[o];++o,vr.removeLateUpdate(h)}t._lateUpdate=null}if(null!=t._render){for(var u=0,_=t._render;u<_.length;){var c=_[u];++u,vr.removeRender(c)}t._render=null}if(null!=t._render2D){for(var d=0,p=t._render2D;d<p.length;){var f=p[d];++d,vr.removeRender2D(f)}t._render2D=null}if(null!=t._remove){for(var g=0,m=t._remove;g<m.length;){var v=m[g];++g,v()}t._remove=null}ht.remove(this.traits,t)},getTrait:function(t){for(var e=0,i=this.traits;e<i.length;){var n=i[e];if(++e,J.getClass(n)==t)return n}return null},getParentArmature:function(t){return null},setupAnimation:function(t){null!=t&&(this.animation=new Ur(this,t))},__class__:Dr};var Wr=function(t){this.currentFace=0,this.renderTargetCube=null,this.renderTarget=null,this.frustumPlanes=null,this.prevV=null,Dr.call(this),this.data=t,this.buildProjection(),this.V=xn.identity(),this.VP=xn.identity(),t.raw.frustum_culling&&(this.frustumPlanes=[],this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr)),xr.active.cameras.push(this)};(i["iron.object.CameraObject"]=Wr).__name__="iron.object.CameraObject",Wr.buildViewFrustum=function(t,e){var i=t.get__03()+t.get__00(),n=t.get__13()+t.get__10(),r=t.get__23()+t.get__20(),s=t.get__33()+t.get__30();e[0].setComponents(i,n,r,s);var a=t.get__03()-t.get__00(),o=t.get__13()-t.get__10(),l=t.get__23()-t.get__20(),h=t.get__33()-t.get__30();e[1].setComponents(a,o,l,h);var u=t.get__03()-t.get__01(),_=t.get__13()-t.get__11(),c=t.get__23()-t.get__21(),d=t.get__33()-t.get__31();e[2].setComponents(u,_,c,d);var p=t.get__03()+t.get__01(),f=t.get__13()+t.get__11(),g=t.get__23()+t.get__21(),m=t.get__33()+t.get__31();e[3].setComponents(p,f,g,m);var v=t.get__02(),y=t.get__12(),w=t.get__22(),b=t.get__32();e[4].setComponents(v,y,w,b);var x=t.get__03()-t.get__02(),S=t.get__13()-t.get__12(),k=t.get__23()-t.get__22(),T=t.get__33()-t.get__32();e[5].setComponents(x,S,k,T);for(var C=0;C<e.length;){var I=e[C];++C,I.normalize()}},Wr.sphereInFrustum=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=0),null==n&&(n=0),null==i&&(i=1);for(var a=e.radius*i,o=0;o<t.length;){var l=t[o];if(++o,Wr.sphereCenter.set(e.worldx()+n,e.worldy()+r,e.worldz()+s),l.distanceToSphere(Wr.sphereCenter,a)+2*a<0)return!1}return!0},Wr.setCubeFace=function(t,e,i,n){null==n&&(n=!1),Wr.vcenter.setFrom(e);var r=n?-1:1;switch(i){case 0:Wr.vcenter.addf(r,0,0),Wr.vup.set(0,-1*r,0);break;case 1:Wr.vcenter.addf(-1*r,0,0),Wr.vup.set(0,-1*r,0);break;case 2:Wr.vcenter.addf(0,r,0),Wr.vup.set(0,0,r);break;case 3:Wr.vcenter.addf(0,-1*r,0),Wr.vup.set(0,0,-1*r);break;case 4:Wr.vcenter.addf(0,0,r),Wr.vup.set(0,-1*r,0);break;case 5:Wr.vcenter.addf(0,0,-1*r),Wr.vup.set(0,-1*r,0)}t.setLookAt(e,Wr.vcenter,Wr.vup)},Wr.__super__=Dr,Wr.prototype=r(Dr.prototype,{buildProjection:function(t){if(null!=this.data.raw.ortho)this.P=xn.ortho(this.data.raw.ortho[0],this.data.raw.ortho[1],this.data.raw.ortho[2],this.data.raw.ortho[3],this.data.raw.near_plane,this.data.raw.far_plane);else{null==t&&(t=vr.w()/vr.h());var e=null!=this.data.raw.aspect?this.data.raw.aspect:t;this.P=xn.persp(this.data.raw.fov,e,this.data.raw.near_plane,this.data.raw.far_plane)}},remove:function(){ht.remove(xr.active.cameras,this),Dr.prototype.remove.call(this)},renderFrame:function(t){this.buildMatrix(),null==this.prevV&&(this.prevV=xn.identity(),this.prevV.setFrom(this.V)),yr.active.renderFrame(t),this.prevV.setFrom(this.V)},buildMatrix:function(){this.transform.buildMatrix();var t=this.transform.world.getScale();1==t.x&&1==t.y&&1==t.z||(Wr.temp.set(1/t.x,1/t.y,1/t.z),this.transform.world.scale(Wr.temp)),this.V.getInverse(this.transform.world),this.VP.multmats(this.P,this.V),this.data.raw.frustum_culling&&Wr.buildViewFrustum(this.VP,this.frustumPlanes)},rightWorld:function(){return new bn(this.transform.world.get__00(),this.transform.world.get__01(),this.transform.world.get__02())},upWorld:function(){return new bn(this.transform.world.get__10(),this.transform.world.get__11(),this.transform.world.get__12())},lookWorld:function(){return new bn(-this.transform.world.get__20(),-this.transform.world.get__21(),-this.transform.world.get__22())},__class__:Wr});var Vr=function(){this.constant=0,this.normal=new bn(1,0,0)};(i["iron.object.FrustumPlane"]=Vr).__name__="iron.object.FrustumPlane",Vr.prototype={normalize:function(){var t=1/this.normal.length();this.normal.mult(t),this.constant*=t},distanceToSphere:function(t,e){return this.normal.dot(t)+this.constant-e},setComponents:function(t,e,i,n){this.normal.set(t,e,i),this.constant=n},__class__:Vr};var Hr=function(t){this.target=null,this.raw=t};(i["iron.object.Constraint"]=Hr).__name__="iron.object.Constraint",Hr.prototype={apply:function(t){if(null==this.target&&null!=this.raw.target&&(this.target=xr.active.getChild(this.raw.target).transform),"COPY_LOCATION"==this.raw.type){if(this.raw.use_x&&(t.world.set__30(this.target.loc.x),this.raw.use_offset)){var e=t.world;e.set__30(e.get__30()+t.loc.x)}if(this.raw.use_y&&(t.world.set__31(this.target.loc.y),this.raw.use_offset)){var i=t.world;i.set__31(i.get__31()+t.loc.y)}if(this.raw.use_z&&(t.world.set__32(this.target.loc.z),this.raw.use_offset)){var n=t.world;n.set__32(n.get__32()+t.loc.z)}}},__class__:Hr};var zr=function(t){this.frustumPlanes=null,this.VP=xn.identity(),this.P=null,this.V=xn.identity(),this.camSlicedP=null,Dr.call(this);var e=(this.data=t).raw.type,i=t.raw.fov;"sun"==e?(null==zr.corners&&(zr.corners=[],zr.corners.push(new bn),zr.corners.push(new bn),zr.corners.push(new bn),zr.corners.push(new bn),zr.corners.push(new bn),zr.corners.push(new bn),zr.corners.push(new bn),zr.corners.push(new bn)),this.P=xn.identity()):"point"==e||"area"==e?this.P=xn.persp(i,1,t.raw.near_plane,t.raw.far_plane):"spot"==e&&(this.P=xn.persp(i,1,t.raw.near_plane,t.raw.far_plane)),xr.active.lights.push(this)};(i["iron.object.LightObject"]=zr).__name__="iron.object.LightObject",zr.setCorners=function(){zr.corners[0].set(-1,-1,1),zr.corners[1].set(-1,-1,-1),zr.corners[2].set(-1,1,1),zr.corners[3].set(-1,1,-1),zr.corners[4].set(1,-1,1),zr.corners[5].set(1,-1,-1),zr.corners[6].set(1,1,1),zr.corners[7].set(1,1,-1)},zr.__super__=Dr,zr.prototype=r(Dr.prototype,{remove:function(){null!=xr.active&&ht.remove(xr.active.lights,this),Dr.prototype.remove.call(this)},buildMatrix:function(t){this.transform.buildMatrix(),"sun"==this.data.raw.type?this.setCascade(t,0):(this.V.getInverse(this.transform.world),this.updateViewFrustum(t))},setCascade:function(t,e){if(zr.m.setFrom(t.V),null==this.camSlicedP){var i=t.data.raw.ortho;if(null==i){var n=t.data.raw.fov,r=this.data.raw.near_plane,s=this.data.raw.far_plane,a=null!=t.data.raw.aspect?t.data.raw.aspect:vr.w()/vr.h();this.camSlicedP=xn.persp(n,a,r,s)}else this.camSlicedP=xn.ortho(i[0],i[1],i[2],i[3],this.data.raw.near_plane,this.data.raw.far_plane)}zr.m.multmat(this.camSlicedP),zr.m.getInverse(zr.m),this.V.getInverse(this.transform.world),this.V.toRotation(),zr.m.multmat(this.V),zr.setCorners();for(var o=0,l=zr.corners;o<l.length;){var h=l[o];++o,h.applymat4(zr.m),h.set(h.x/h.w,h.y/h.w,h.z/h.w)}for(var u=zr.corners[0].x,_=zr.corners[0].y,c=zr.corners[0].z,d=zr.corners[0].x,p=zr.corners[0].y,f=zr.corners[0].z,g=0,m=zr.corners;g<m.length;){var v=m[g];++g,v.x<u&&(u=v.x),v.x>d&&(d=v.x),v.y<_&&(_=v.y),v.y>p&&(p=v.y),v.z<c&&(c=v.z),v.z>f&&(f=v.z)}var y=bn.distance(zr.corners[0],zr.corners[7]),w=.5*(y-(d-u)),b=.5*(y-(p-_));u-=w,d+=w,_-=b,p+=b;var x=this.data.raw.shadowmap_size,S=(d-u)/x,k=(p-_)/x,T=(f-c)/x;u=Math.floor(u/S)*S,_=Math.floor(_/k)*k,c=Math.floor(c/T)*T,d=Math.floor(d/S)*S,p=Math.floor(p/k)*k,f=Math.floor(f/T)*T;var C=(d-u)/2*zr.cascadeBounds,I=(p-_)/2*zr.cascadeBounds,N=(f-c)/2*zr.cascadeBounds;this.V.set__30(-(u+C)),this.V.set__31(-(_+I)),this.V.set__32(-(c+N)),zr.m=xn.ortho(-C,C,-I,I,4*-N,N),this.P.setFrom(zr.m),this.updateViewFrustum(t)},updateViewFrustum:function(t){this.VP.multmats(this.P,this.V),t.data.raw.frustum_culling&&(null==this.frustumPlanes&&(this.frustumPlanes=[],this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr),this.frustumPlanes.push(new Vr)),Wr.buildViewFrustum(this.VP,this.frustumPlanes))},setCubeFace:function(t,e){zr.eye.set(this.transform.worldx(),this.transform.worldy(),this.transform.worldz()),Wr.setCubeFace(this.V,zr.eye,t),this.updateViewFrustum(e)},look:function(){return new bn(this.V.get__02(),this.V.get__12(),this.V.get__22())},__class__:zr});var Gr=function(t,e){this.force_context=null,this.skip_context=null,this.tilesheet=null,this.frustumCulling=!0,this.screenSize=0,this.data=null,Dr.call(this),this.materials=e,this.setData(t),xr.active.meshes.push(this)};(i["iron.object.MeshObject"]=Gr).__name__="iron.object.MeshObject",Gr.__super__=Dr,Gr.prototype=r(Dr.prototype,{setData:function(t){(this.data=t).refcount++,t.geom.build(),this.transform.scaleWorld=t.scalePos},remove:function(){null!=this.tilesheet&&this.tilesheet.remove(),null!=xr.active&&ht.remove(xr.active.meshes,this),this.data.refcount--,Dr.prototype.remove.call(this)},setupAnimation:function(t){Dr.prototype.setupAnimation.call(this,t)},setupTilesheet:function(t,e,i){this.tilesheet=new Xr(t,e,i)},isLodMaterial:function(){return null!=this.raw&&null!=this.raw.lod_material&&1==this.raw.lod_material},setCulled:function(t,e){return t?this.culledShadow=e:this.culledMesh=e,this.culled=this.culledMesh&&this.culledShadow,e},cullMaterial:function(t){var e=this.materials;if(!this.isLodMaterial()&&!this.validContext(e[0],t))return!0;var i="shadowmap"==t;return this.visibleMesh||i?!this.visibleShadow&&i?this.setCulled(i,!0):this.skip_context==t?this.setCulled(i,!0):null!=this.force_context&&this.force_context!=t?this.setCulled(i,!0):"voxel"==t&&null!=this.raw&&1==this.raw.mobile?this.setCulled(i,!0):this.setCulled(i,!1):this.setCulled(i,!0)},cullMesh:function(t,e,i){if(null==e)return!1;if(e.data.raw.frustum_culling&&this.frustumCulling){var n=this.data.isSkinned?2:1;"voxel"==t&&(n*=100);var r="shadowmap"==t,s=r?i.frustumPlanes:e.frustumPlanes;if(r&&"sun"!=i.data.raw.type&&(i.transform.radius=i.data.raw.far_plane,!Wr.sphereInFrustum(e.frustumPlanes,i.transform)))return this.setCulled(r,!0);if(!this.data.geom.instanced&&!Wr.sphereInFrustum(s,this.transform,n))return this.setCulled(r,!0)}return this.culled=!1,this.culled},skipContext:function(t,e){return null!=e.raw.skip_context&&e.raw.skip_context==t},getContexts:function(t,e,i,n){for(var r=0;r<e.length;){var s=e[r];++r;for(var a=0,o=s.raw.contexts.length;a<o;){var l=a++;if(ht.substr(s.raw.contexts[l].name,0,t.length)==t){i.push(s.contexts[l]),n.push(s.shader.getContext(t));break}}}},render:function(t,e,i){if(null!=this.data&&this.data.geom.ready&&this.visible&&!this.cullMesh(e,xr.active.camera,yr.active.light)){this.raw;if(null!=this.tilesheet&&this.tilesheet.update(),!this.cullMaterial(e)){var n=this.materials,r=this;if(null!=this.raw&&null!=this.raw.lods&&0<this.raw.lods.length){if(this.computeScreenSize(xr.active.camera),this.initLods(),"voxel"==e)r=this.lods[this.lods.length-1];else for(var s=0,a=this.raw.lods.length;s<a;){var o=s++;if(this.screenSize>this.raw.lods[o].screen_size)break;r=this.lods[o],this.isLodMaterial()&&(n=r.materials)}if(null==r)return}if(!this.isLodMaterial()||this.validContext(n[0],e)){var l=[],h=[];this.getContexts(e,n,l,h),Kr.posUnpack=this.data.scalePos,Kr.texUnpack=this.data.scaleTex,this.transform.update();for(var u=r.data,_=0,c=u.geom.indexBuffers.length;_<c;){var d=_++,p=u.geom.materialIndices[d];if(!(h.length<=p)&&!(this.materials.length>p&&this.skipContext(e,this.materials[p]))){var f=h[p],g=f.raw.vertex_elements;f.pipeState!=Gr.lastPipeline&&(t.setPipeline(f.pipeState),Gr.lastPipeline=f.pipeState),Kr.setContextConstants(t,f,i),Kr.setObjectConstants(t,f,this),p<l.length&&Kr.setMaterialConstants(t,f,l[p]),u.geom.instanced?t.setVertexBuffers([u.geom.get(g),u.geom.instancedVB]):t.setVertexBuffer(u.geom.get(g)),t.setIndexBuffer(u.geom.indexBuffers[d]),u.geom.instanced?t.drawIndexedVerticesInstanced(u.geom.instanceCount,u.geom.start,u.geom.count):t.drawIndexedVertices(u.geom.start,u.geom.count)}}}}}},validContext:function(t,e){return null!=t.getContext(e)},computeCameraDistance:function(t,e,i){this.cameraDistance=bn.distancef(t,e,i,this.transform.worldx(),this.transform.worldy(),this.transform.worldz())},computeScreenSize:function(t){var e=this.transform,i=e.dim.x*e.dim.y*e.dim.z;this.screenSize=i*(1/this.cameraDistance),this.screenSize=1<this.screenSize?1:this.screenSize},initLods:function(){if(null==this.lods){this.lods=[];for(var t=0,e=this.raw.lods;t<e.length;){var i=e[t];++t,""==i.object_ref?this.lods.push(null):this.lods.push(xr.active.getChild(i.object_ref))}}},__class__:Gr});var Ur=function(t,e){this.bezierFrameIndex=-1,this.s0=0,this.object=t,this.oactions=e,this.isSkinned=!1,Pr.call(this)};(i["iron.object.ObjectAnimation"]=Ur).__name__="iron.object.ObjectAnimation",Ur.__super__=Pr,Ur.prototype=r(Pr.prototype,{getAction:function(t){for(var e=0,i=this.oactions;e<i.length;){var n=i[e];if(++e,null!=n&&n.objects[0].name==t)return n.objects[0]}return null},play:function(t,e,i,n,r){null==r&&(r=!0),null==n&&(n=1),null==i&&(i=0),null==t&&(t=""),Pr.prototype.play.call(this,t,e,i,n,r),""==this.action&&null!=this.oactions[0]&&(this.action=this.oactions[0].objects[0].name),this.oaction=this.getAction(this.action),null!=this.oaction&&(this.isSampled=null!=this.oaction.sampled&&this.oaction.sampled)},update:function(t){this.object.visible&&!this.object.culled&&null!=this.oaction&&(Pr.prototype.update.call(this,t),this.paused||this.isSkinned||this.updateObjectAnim())},updateObjectAnim:function(){if(this.isSampled){this.updateTrack(this.oaction.anim),this.updateAnimSampled(this.oaction.anim,this.object.transform.world),this.object.transform.world.decompose(this.object.transform.loc,this.object.transform.rot,this.object.transform.scale);for(var t=0,e=this.object.children;t<e.length;){var i=e[t];++t,i.transform.buildMatrix()}}else this.updateAnimNonSampled(this.oaction.anim,this.object.transform),this.object.transform.buildMatrix()},interpolateLinear:function(t,e,i,n,r){var s=(t-e)/(i-e);return(1-s)*n+s*r},interpolateBezier:function(t,e,i,n,r,s,a,o,l){this.frameIndex!=this.bezierFrameIndex&&(this.bezierFrameIndex=this.frameIndex,this.s0=(t-e)/(i-e));var h=(i-3*a+3*s-e)*(this.s0*this.s0*this.s0)+3*(a-2*s+e)*(this.s0*this.s0)+3*(s-e)*this.s0+e-t,u=3*(i-3*a+3*s-e)*(this.s0*this.s0)+6*(a-2*s+e)*this.s0+3*(s-e),_=this.s0-h/u;return(1-(this.s0=_))*(1-_)*(1-_)*n+3*_*(1-_)*(1-_)*o+_*_*3*(1-_)*l+_*_*_*r},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-2:this.frameIndex<=0},checkFrameIndexT:function(t,e){return 0<this.speed?this.frameIndex<t.length-2&&e>t[this.frameIndex+1]*this.frameTime:1<this.frameIndex&&e>t[this.frameIndex-1]*this.frameTime},updateAnimNonSampled:function(t,e){if(null!=t){var i=t.end*this.frameTime-t.begin*this.frameTime;if(t.has_delta){var n=e;null==n.dloc&&(n.dloc=new bn,n.drot=new Sn,n.dscale=new bn),n.dloc.set(0,0,0),n.dscale.set(0,0,0),n._deulerX=n._deulerY=n._deulerZ=0}for(var r=0,s=t.tracks;r<s.length;){var a=s[r];++r,-1==this.frameIndex&&this.rewind(a);for(var o=0<this.speed?1:-1,l=this.time+t.begin*this.frameTime;this.checkFrameIndexT(a.frames,l);)this.frameIndex+=o;if(!(this.frameIndex>=a.frames.length)){if(this.time>i)return null!=this.onComplete&&this.onComplete(),void(this.loop?this.rewind(a):(this.frameIndex-=o,this.paused=!0));var h=this.frameIndex,u=a.frames[h]*this.frameTime,_=a.frames[h+o]*this.frameTime,c=a.values[h],d=a.values[h+o],p=0;switch(a.curve){case"bezier":var f=a.frames_control_plus[h]*this.frameTime,g=a.frames_control_minus[h+o]*this.frameTime,m=a.values_control_plus[h],v=a.values_control_minus[h+o];p=this.interpolateBezier(l,u,_,c,d,f,g,m,v);break;case"linear":p=this.interpolateLinear(l,u,_,c,d)}switch(a.target){case"dxloc":e.dloc.x=p;break;case"dxrot":e._deulerX=p;break;case"dxscl":e.dscale.x=p;break;case"dyloc":e.dloc.y=p;break;case"dyrot":e._deulerY=p;break;case"dyscl":e.dscale.y=p;break;case"dzloc":e.dloc.z=p;break;case"dzrot":e._deulerZ=p;break;case"dzscl":e.dscale.z=p;break;case"xloc":e.loc.x=p;break;case"xrot":e.setRotation(p,e._eulerY,e._eulerZ);break;case"xscl":e.scale.x=p;break;case"yloc":e.loc.y=p;break;case"yrot":e.setRotation(e._eulerX,p,e._eulerZ);break;case"yscl":e.scale.y=p;break;case"zloc":e.loc.z=p;break;case"zrot":e.setRotation(e._eulerX,e._eulerY,p);break;case"zscl":e.scale.z=p}}}}},__class__:Ur});var jr=function(t){this.paused=!1,this.channels=[],this.sound=null;var e=this;Dr.call(this),this.data=t,xr.active.speakers.push(this),""!=t.sound&&Tr.getSound(t.sound,function(t){e.sound=t,vr.notifyOnInit(ko(e,e.init))})};(i["iron.object.SpeakerObject"]=jr).__name__="iron.object.SpeakerObject",jr.__super__=Dr,jr.prototype=r(Dr.prototype,{init:function(){this.visible&&this.data.play_on_start&&this.play()},play:function(){if(null!=this.sound&&!this.data.muted)if(this.paused){for(var t=0,e=this.channels;t<e.length;){var i=e[t];++t,i.play()}this.paused=!1}else{var n=qr.play(this.sound,this.data.loop,this.data.stream);this.channels.push(n),0<this.data.attenuation&&1==this.channels.length&&vr.notifyOnUpdate(ko(this,this.update))}},pause:function(){for(var t=0,e=this.channels;t<e.length;){var i=e[t];++t,i.pause()}this.paused=!0},stop:function(){for(var t=0,e=this.channels;t<e.length;){var i=e[t];++t,i.stop()}this.channels.splice(0,this.channels.length)},update:function(){if(!this.paused){for(var t=0,e=this.channels;t<e.length;){var i=e[t];++t,i.get_finished()&&ht.remove(this.channels,i)}if(0!=this.channels.length){var n=xr.active.camera.transform.world.getLoc(),r=this.transform.world.getLoc(),s=bn.distance(n,r);s*=this.data.attenuation;for(var a=1-Math.min(s/100,1),o=0,l=this.channels;o<l.length;){var h=l[o];++o,h.set_volume(a*this.data.volume)}}else vr.removeUpdate(ko(this,this.update))}},remove:function(){null!=xr.active&&ht.remove(xr.active.speakers,this),Dr.prototype.remove.call(this)},__class__:jr});var Xr=function(t,r,s){this.onActionComplete=null,this.time=0,this.frame=0,this.paused=!1,this.action=null,this.tileY=0,this.tileX=0;var a=this;this.ready=!1,Tr.getSceneRaw(t,function(t){for(var e=0,i=t.tilesheet_datas;e<i.length;){var n=i[e];if(++e,n.name==r){a.raw=n,a.play(s),a.ready=!0;break}}})};(i["iron.object.Tilesheet"]=Xr).__name__="iron.object.Tilesheet",Xr.prototype={play:function(t,e){this.onActionComplete=e;for(var i=0,n=this.raw.actions;i<n.length;){var r=n[i];if(++i,r.name==t){this.action=r;break}}this.setFrame(this.action.start),this.paused=!1},pause:function(){this.paused=!0},resume:function(){this.paused=!1},remove:function(){},update:function(){!this.ready||this.paused||this.action.start>=this.action.end||(this.time+=ls.get_delta(),this.time>=1/this.raw.framerate&&this.setFrame(this.frame+1))},setFrame:function(t){this.frame=t,this.time=0;var e=this.frame%this.raw.tilesx,i=pt.int(this.frame/this.raw.tilesx);this.tileX=e*(1/this.raw.tilesx),this.tileY=i*(1/this.raw.tilesy),this.frame>=this.action.end&&this.action.start<this.action.end&&(null!=this.onActionComplete&&this.onActionComplete(),this.action.loop?this.setFrame(this.action.start):this.paused=!0)},__class__:Xr};var Yr=function(t){this.dscale=null,this.drot=null,this.dloc=null,this.boneParent=null,this.appendMats=null,this.prependMats=null,this.scaleWorld=1,this.localOnly=!1,this.object=t,this.reset()};(i["iron.object.Transform"]=Yr).__name__="iron.object.Transform",Yr.prototype={reset:function(){this.world=xn.identity(),this.worldUnpack=xn.identity(),this.local=xn.identity(),this.loc=new bn,this.rot=new Sn,this.scale=new bn(1,1,1),this.dim=new bn(2,2,2),this.radius=1,this.dirty=!0},update:function(){this.dirty&&this.buildMatrix()},composeDelta:function(){this.dloc.addvecs(this.loc,this.dloc),this.dscale.addvecs(this.dscale,this.scale),this.drot.fromEuler(this._deulerX,this._deulerY,this._deulerZ),this.drot.multquats(this.rot,this.drot),this.local.compose(this.dloc,this.drot,this.dscale)},buildMatrix:function(){if(null==this.dloc?this.local.compose(this.loc,this.rot,this.scale):this.composeDelta(),null!=this.prependMats){Yr.temp.setIdentity();for(var t=0,e=this.prependMats;t<e.length;){var i=e[t];++t,Yr.temp.multmat(i)}Yr.temp.multmat(this.local),this.local.setFrom(Yr.temp)}if(null!=this.appendMats)for(var n=0,r=this.appendMats;n<r.length;){var s=r[n];++n,this.local.multmat(s)}if(null!=this.boneParent&&this.local.multmats(this.boneParent,this.local),null==this.object.parent||this.localOnly?this.world.setFrom(this.local):this.world.multmats3x4(this.local,this.object.parent.transform.world),this.worldUnpack.setFrom(this.world),1!=this.scaleWorld){var a=this.worldUnpack;a.set__00(a.get__00()*this.scaleWorld);var o=this.worldUnpack;o.set__01(o.get__01()*this.scaleWorld);var l=this.worldUnpack;l.set__02(l.get__02()*this.scaleWorld);var h=this.worldUnpack;h.set__03(h.get__03()*this.scaleWorld);var u=this.worldUnpack;u.set__10(u.get__10()*this.scaleWorld);var _=this.worldUnpack;_.set__11(_.get__11()*this.scaleWorld);var c=this.worldUnpack;c.set__12(c.get__12()*this.scaleWorld);var d=this.worldUnpack;d.set__13(d.get__13()*this.scaleWorld);var p=this.worldUnpack;p.set__20(p.get__20()*this.scaleWorld);var f=this.worldUnpack;f.set__21(f.get__21()*this.scaleWorld);var g=this.worldUnpack;g.set__22(g.get__22()*this.scaleWorld);var m=this.worldUnpack;m.set__23(m.get__23()*this.scaleWorld)}if(null!=this.object.constraints)for(var v=0,y=this.object.constraints;v<y.length;){var w=y[v];++v,w.apply(this)}this.computeDim();for(var b=0,x=this.object.children;b<x.length;){var S=x[b];++b,S.transform.buildMatrix()}this.dirty=!1},setMatrix:function(t){this.local.setFrom(t),this.decompose(),this.buildMatrix()},multMatrix:function(t){this.local.multmat(t),this.decompose(),this.buildMatrix()},decompose:function(){this.local.decompose(this.loc,this.rot,this.scale)},setRotation:function(t,e,i){this.rot.fromEuler(t,e,i),this._eulerX=t,this._eulerY=e,this._eulerZ=i,this.dirty=!0},computeRadius:function(){this.radius=Math.sqrt(this.dim.x*this.dim.x+this.dim.y*this.dim.y+this.dim.z*this.dim.z)},computeDim:function(){if(null!=this.object.raw){var t=this.object.raw.dimensions;null==t?this.dim.set(2*this.scale.x,2*this.scale.y,2*this.scale.z):this.dim.set(t[0]*this.scale.x,t[1]*this.scale.y,t[2]*this.scale.z),this.computeRadius()}else this.computeRadius()},applyParentInverse:function(){var t=this.object.parent.transform;t.buildMatrix(),Yr.temp.getInverse(t.world),this.local.multmat(Yr.temp),this.decompose(),this.buildMatrix()},applyParent:function(){var t=this.object.parent.transform;this.local.multmat(t.world),this.decompose()},overlap:function(t){var e=this;return e.worldx()+e.dim.x/2>t.worldx()-t.dim.x/2&&e.worldx()-e.dim.x/2<t.worldx()+t.dim.x/2&&e.worldy()+e.dim.y/2>t.worldy()-t.dim.y/2&&e.worldy()-e.dim.y/2<t.worldy()+t.dim.y/2&&e.worldz()+e.dim.z/2>t.worldz()-t.dim.z/2&&e.worldz()-e.dim.z/2<t.worldz()+t.dim.z/2},worldx:function(){return this.world.get__30()},worldy:function(){return this.world.get__31()},worldz:function(){return this.world.get__32()},__class__:Yr};var Zr=function(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l};(i["kha.math.FastMatrix3"]=Zr).__name__="kha.math.FastMatrix3",Zr.prototype={__class__:Zr};var Kr=function(){};(i["iron.object.Uniforms"]=Kr).__name__="iron.object.Uniforms",Kr.setContextConstants=function(t,e,i){if(null!=e.raw.constants)for(var n=0,r=e.raw.constants.length;n<r;){var s=n++,a=e.raw.constants[s];Kr.setContextConstant(t,e.constants[s],a)}if(null!=i)for(var o=0,l=pt.int(i.length/2);o<l;){var h=2*o++,u=i[h],_=i[h+1],c=!1;"_"==u.charAt(0)&&(c=!0,u=ht.substr(u,1,null));var d=c?yr.active.depthToRenderTarget.get(u):yr.active.renderTargets.get(u);Kr.bindRenderTarget(t,d,e,_,c)}if(null!=e.raw.texture_units)for(var p=0,f=e.raw.texture_units.length;p<f;){var g=p++,m=e.raw.texture_units[g].link;if(null!=m)if("_envmapRadiance"==m){var v=xr.active.world;null!=v&&(t.setTexture(e.textureUnits[g],v.probe.radiance),t.setTextureParameters(e.textureUnits[g],0,0,1,1,2))}else if("_envmap"==m){var y=xr.active.world;null!=y&&t.setTexture(e.textureUnits[g],y.envmap)}else"_envmapBrdf"==m?t.setTexture(e.textureUnits[g],xr.active.embedded.get("brdf.png")):"_noise8"==m?(t.setTexture(e.textureUnits[g],xr.active.embedded.get("noise8.png")),t.setTextureParameters(e.textureUnits[g],0,0,1,1,0)):"_noise64"==m?(t.setTexture(e.textureUnits[g],xr.active.embedded.get("noise64.png")),t.setTextureParameters(e.textureUnits[g],0,0,1,1,0)):"_blueNoise64"==m?(t.setTexture(e.textureUnits[g],xr.active.embedded.get("blue_noise64.png")),t.setTextureParameters(e.textureUnits[g],0,0,1,1,0)):"_noise256"==m?(t.setTexture(e.textureUnits[g],xr.active.embedded.get("noise256.png")),t.setTextureParameters(e.textureUnits[g],0,0,1,1,0)):"_iesTexture"==m&&(t.setTexture(e.textureUnits[g],xr.active.embedded.get("iestexture.png")),t.setTextureParameters(e.textureUnits[g],0,0,1,1,0))}},Kr.setObjectConstants=function(t,e,i){if(null!=e.raw.constants)for(var n=0,r=e.raw.constants.length;n<r;){var s=n++,a=e.raw.constants[s];Kr.setObjectConstant(t,i,e.constants[s],a)}if(null!=Kr.externalTextureLinks&&null!=e.raw.texture_units)for(var o=0,l=e.raw.texture_units.length;o<l;){var h=o++,u=e.raw.texture_units[h].link;if(null!=u)for(var _=0,c=Kr.externalTextureLinks;_<c.length;){var d=c[_];++_;var p=d(i,Kr.currentMat(i),u);if(null!=p){t.setTexture(e.textureUnits[h],p);break}}}},Kr.bindRenderTarget=function(t,e,i,n,r){if(null!=e)for(var s=i.raw.texture_units,a=0,o=s.length;a<o;){var l=a++;if(n==s[l].name){var h=null!=s[l].is_image&&s[l].is_image,u=!1;1<e.raw.depth&&(t.setTexture3DParameters(i.textureUnits[l],2,2,2,1,0,2),u=!0),h?(t.setImageTexture(i.textureUnits[l],e.image),t.setTexture3DParameters(i.textureUnits[l],2,2,2,1,0,2),u=!0):e.isCubeMap?r?t.setCubeMapDepth(i.textureUnits[l],e.cubeMap):t.setCubeMap(i.textureUnits[l],e.cubeMap):r?t.setTextureDepth(i.textureUnits[l],e.image):t.setTexture(i.textureUnits[l],e.image),u||null==e.raw.mipmaps||1!=e.raw.mipmaps||h||(t.setTextureParameters(i.textureUnits[l],2,2,1,1,2),u=!0),u||(q.startsWith(n,"shadowMap")?(e.isCubeMap?t.setCubeMapCompareMode(i.textureUnits[l],!0):(t.setTextureParameters(i.textureUnits[l],2,2,1,1,0),t.setTextureCompareMode(i.textureUnits[l],!0)),u=!0):r&&(t.setTextureParameters(i.textureUnits[l],2,2,0,0,0),u=!0)),u||(t.setTextureParameters(i.textureUnits[l],2,2,1,1,0),u=!0)}}},Kr.setContextConstant=function(t,e,i){if(null==i.link)return!0;var n=xr.active.camera,r=yr.active.light;if("mat4"==i.type){var s=null;if("_viewMatrix"==i.link)s=n.V;else if("_transposeInverseViewMatrix"==i.link)Kr.helpMat.setFrom(n.V),Kr.helpMat.getInverse(Kr.helpMat),Kr.helpMat.transpose(),s=Kr.helpMat;else if("_inverseViewMatrix"==i.link)Kr.helpMat.getInverse(n.V),s=Kr.helpMat;else if("_transposeViewMatrix"==i.link)Kr.helpMat.setFrom(n.V),Kr.helpMat.transpose3x3(),s=Kr.helpMat;else if("_projectionMatrix"==i.link)s=n.P;else if("_inverseProjectionMatrix"==i.link)Kr.helpMat.getInverse(n.P),s=Kr.helpMat;else if("_inverseViewProjectionMatrix"==i.link)Kr.helpMat.setFrom(n.V),Kr.helpMat.multmat(n.P),Kr.helpMat.getInverse(Kr.helpMat),s=Kr.helpMat;else if("_viewProjectionMatrix"==i.link)s=n.VP;else if("_prevViewProjectionMatrix"==i.link)Kr.helpMat.setFrom(n.prevV),Kr.helpMat.multmat(n.P),s=Kr.helpMat;else if("_lightViewProjectionMatrix"==i.link)null!=r&&(s=r.VP);else if("_biasLightViewProjectionMatrix"==i.link)null!=r&&(Kr.helpMat.setFrom(r.VP),Kr.helpMat.multmat(Kr.biasMat),s=Kr.helpMat);else if("_lightVolumeWorldViewProjectionMatrix"==i.link){if(null!=r){var a=r.transform,o=r.data.raw.type;if("spot"==o){Kr.helpVec.set(a.worldx(),a.worldy(),a.worldz());Kr.helpVec2.set(r.data.raw.far_plane,2*r.data.raw.far_plane,2*r.data.raw.far_plane),Kr.helpMat.compose(Kr.helpVec,Kr.helpQuat,Kr.helpVec2)}else if("point"==o||"area"==o){Kr.helpVec.set(a.worldx(),a.worldy(),a.worldz());Kr.helpVec2.set(r.data.raw.far_plane,2*r.data.raw.far_plane,2*r.data.raw.far_plane),Kr.helpMat.compose(Kr.helpVec,Kr.helpQuat,Kr.helpVec2)}Kr.helpMat.multmat(n.V),Kr.helpMat.multmat(n.P),s=Kr.helpMat}}else if("_skydomeMatrix"==i.link){var l=n.transform;Kr.helpVec.set(l.worldx(),l.worldy(),l.worldz()-3.5);var h=.95*n.data.raw.far_plane;Kr.helpVec2.set(h,h,h),Kr.helpMat.compose(Kr.helpVec,Kr.helpQuat,Kr.helpVec2),Kr.helpMat.multmat(n.V),Kr.helpMat.multmat(n.P),s=Kr.helpMat}else"_lightViewMatrix"==i.link?null!=r&&(s=r.V):"_lightProjectionMatrix"==i.link&&null!=r&&(s=r.P);if(null!=s)return t.setMatrix(e,s.self),!0}else if("vec4"==i.type){Kr.helpVec.set(0,0,0)}else if("vec3"==i.type){var u=null;if(Kr.helpVec.set(0,0,0),"_lightPosition"==i.link)null!=r&&(Kr.helpVec.set(r.transform.worldx(),r.transform.worldy(),r.transform.worldz()),u=Kr.helpVec);else if("_lightDirection"==i.link)null!=r&&(Kr.helpVec=r.look().normalize(),u=Kr.helpVec);else if("_lightColor"==i.link){if(null!=r){var _=r.visible?r.data.raw.strength:0;Kr.helpVec.set(r.data.raw.color[0]*_,r.data.raw.color[1]*_,r.data.raw.color[2]*_),u=Kr.helpVec}}else if("_sunDirection"==i.link){var c=yr.active.sun;null!=c&&(Kr.helpVec=c.look().normalize(),u=Kr.helpVec)}else if("_sunColor"==i.link){var d=yr.active.sun;if(null!=d){var p=d.visible?d.data.raw.strength:0;Kr.helpVec.set(d.data.raw.color[0]*p,d.data.raw.color[1]*p,d.data.raw.color[2]*p),u=Kr.helpVec}}else if("_pointPosition"==i.link){var f=yr.active.point;null!=f&&(Kr.helpVec.set(f.transform.worldx(),f.transform.worldy(),f.transform.worldz()),u=Kr.helpVec)}else if("_spotDirection"==i.link){var g=yr.active.point;null!=g&&(Kr.helpVec=g.look().normalize(),u=Kr.helpVec)}else if("_pointColor"==i.link){var m=yr.active.point;if(null!=m){var v=m.visible?m.data.raw.strength:0;Kr.helpVec.set(m.data.raw.color[0]*v,m.data.raw.color[1]*v,m.data.raw.color[2]*v),u=Kr.helpVec}}else if("_cameraPosition"==i.link)Kr.helpVec.set(n.transform.worldx(),n.transform.worldy(),n.transform.worldz()),u=Kr.helpVec;else if("_cameraLook"==i.link)Kr.helpVec=n.lookWorld().normalize(),u=Kr.helpVec;else if("_cameraUp"==i.link)Kr.helpVec=n.upWorld().normalize(),u=Kr.helpVec;else if("_cameraRight"==i.link)Kr.helpVec=n.rightWorld().normalize(),u=Kr.helpVec;else if("_backgroundCol"==i.link)null!=n.data.raw.clear_color&&Kr.helpVec.set(n.data.raw.clear_color[0],n.data.raw.clear_color[1],n.data.raw.clear_color[2]),u=Kr.helpVec;else if("_hosekSunDirection"==i.link){var y=xr.active.world;null!=y&&(Kr.helpVec.set(y.raw.sun_direction[0],y.raw.sun_direction[1],y.raw.sun_direction[2]),u=Kr.helpVec)}if(null!=u)return t.setFloat3(e,u.x,u.y,u.z),!0}else if("vec2"==i.type){var w=null;if(Kr.helpVec.set(0,0,0),"_vec2x"==i.link)(w=Kr.helpVec).x=1,w.y=0;else if("_vec2xInv"==i.link)(w=Kr.helpVec).x=1/yr.active.currentW,w.y=0;else if("_vec2x2"==i.link)(w=Kr.helpVec).x=2,w.y=0;else if("_vec2x2Inv"==i.link)(w=Kr.helpVec).x=2/yr.active.currentW,w.y=0;else if("_vec2y"==i.link)(w=Kr.helpVec).x=0,w.y=1;else if("_vec2yInv"==i.link)(w=Kr.helpVec).x=0,w.y=1/yr.active.currentH;else if("_vec2y2"==i.link)(w=Kr.helpVec).x=0,w.y=2;else if("_vec2y2Inv"==i.link)(w=Kr.helpVec).x=0,w.y=2/yr.active.currentH;else if("_vec2y3"==i.link)(w=Kr.helpVec).x=0,w.y=3;else if("_vec2y3Inv"==i.link)(w=Kr.helpVec).x=0,w.y=3/yr.active.currentH;else if("_windowSize"==i.link)(w=Kr.helpVec).x=vr.w(),w.y=vr.h();else if("_windowSizeInv"==i.link)(w=Kr.helpVec).x=1/vr.w(),w.y=1/vr.h();else if("_screenSize"==i.link)(w=Kr.helpVec).x=yr.active.currentW,w.y=yr.active.currentH;else if("_screenSizeInv"==i.link)(w=Kr.helpVec).x=1/yr.active.currentW,w.y=1/yr.active.currentH;else if("_aspectRatio"==i.link)(w=Kr.helpVec).x=yr.active.currentH/yr.active.currentW,w.y=yr.active.currentW/yr.active.currentH,w.x=1<w.x?1:w.x,w.y=1<w.y?1:w.y;else if("_cameraPlane"==i.link)(w=Kr.helpVec).x=n.data.raw.near_plane,w.y=n.data.raw.far_plane;else if("_cameraPlaneProj"==i.link){var b=n.data.raw.near_plane,x=n.data.raw.far_plane;(w=Kr.helpVec).x=x/(x-b),w.y=-x*b/(x-b)}else if("_lightPlane"==i.link)null!=r&&((w=Kr.helpVec).x=r.data.raw.near_plane,w.y=r.data.raw.far_plane);else if("_lightPlaneProj"==i.link){if(null!=r){var S=r.data.raw.near_plane,k=r.data.raw.far_plane,T=k+S,C=k-S,I=2*k*S;(w=Kr.helpVec).x=T/C,w.y=I/C}}else if("_spotData"==i.link){var N=yr.active.point;null!=N&&((w=Kr.helpVec).x=N.data.raw.spot_size,w.y=w.x-N.data.raw.spot_blend)}else"_shadowMapSize"==i.link&&null!=r&&r.data.raw.cast_shadow&&((w=Kr.helpVec).x=w.y=r.data.raw.shadowmap_size);if(null!=w)return t.setFloat2(e,w.x,w.y),!0}else if("float"==i.type){var O=null;if("_time"==i.link)O=ls.time();else if("_deltaTime"==i.link)O=ls.get_delta();else if("_lightRadius"==i.link)O=null==r?0:r.data.raw.far_plane;else if("_lightShadowsBias"==i.link)O=null==r?0:r.data.raw.shadows_bias;else if("_sunShadowsBias"==i.link){var E=yr.active.sun;O=null==E?0:E.data.raw.shadows_bias}else if("_pointShadowsBias"==i.link){var M=yr.active.point;O=null==M?0:M.data.raw.shadows_bias}else"_lightSize"==i.link?null!=r&&null!=r.data.raw.light_size&&(O=r.data.raw.light_size):"_envmapStrength"==i.link?O=null==xr.active.world?0:xr.active.world.probe.raw.strength:"_aspectRatioF"==i.link?O=yr.active.currentW/yr.active.currentH:"_aspectRatioWindowF"==i.link?O=vr.w()/vr.h():"_frameScale"==i.link&&(O=yr.active.frameTime/ls.get_delta());if(null!=O)return t.setFloat(e,O),!0}else if("floats"==i.type){var L=null;if("_envmapIrradiance"==i.link&&(L=null==xr.active.world?Ar.getEmptyIrradiance():xr.active.world.probe.irradiance),null!=L)return t.setFloats(e,L),!0}else if("int"==i.type){var A=null;if("_lightCastShadow"==i.link)A=null!=r&&r.data.raw.cast_shadow?r.data.raw.shadowmap_cube?2:1:0;else if("_envmapNumMipmaps"==i.link){var B=xr.active.world;A=null!=B?B.probe.raw.radiance_mipmaps+1-2:1}if(null!=A)return t.setInt(e,A),!0}return!1},Kr.setObjectConstant=function(t,e,i,n){if(null!=n.link){var r=xr.active.camera,s=yr.active.light;if("mat4"==n.type){var a=null;if("_worldMatrix"==n.link)a=e.transform.worldUnpack;else if("_inverseWorldMatrix"==n.link)Kr.helpMat.getInverse(e.transform.worldUnpack),a=Kr.helpMat;else if("_worldViewProjectionMatrix"==n.link)Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(r.V),Kr.helpMat.multmat(r.P),a=Kr.helpMat;else if("_worldViewProjectionMatrixSphere"==n.link)Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(r.V),Kr.helpMat.set__00(1),Kr.helpMat.set__10(0),Kr.helpMat.set__20(0),Kr.helpMat.set__01(0),Kr.helpMat.set__11(1),Kr.helpMat.set__21(0),Kr.helpMat.set__02(0),Kr.helpMat.set__12(0),Kr.helpMat.set__22(1),Kr.helpMat.multmat(r.P),a=Kr.helpMat;else if("_worldViewProjectionMatrixCylinder"==n.link)Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(r.V),Kr.helpMat.set__00(1),Kr.helpMat.set__20(0),Kr.helpMat.set__01(0),Kr.helpMat.set__21(0),Kr.helpMat.set__02(0),Kr.helpMat.set__22(1),Kr.helpMat.multmat(r.P),a=Kr.helpMat;else if("_worldViewMatrix"==n.link)Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(r.V),a=Kr.helpMat;else if("_lightWorldViewProjectionMatrix"==n.link)null!=s&&(null==e?Kr.helpMat.setIdentity():Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(s.VP),a=Kr.helpMat);else if("_lightWorldViewProjectionMatrixSphere"==n.link)null!=s&&(Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(r.V),Kr.helpMat.set__00(1),Kr.helpMat.set__10(0),Kr.helpMat.set__20(0),Kr.helpMat.set__01(0),Kr.helpMat.set__11(1),Kr.helpMat.set__21(0),Kr.helpMat.set__02(0),Kr.helpMat.set__12(0),Kr.helpMat.set__22(1),Kr.helpMat2.getInverse(r.V),Kr.helpMat.multmat(Kr.helpMat2),Kr.helpMat.multmat(s.VP),a=Kr.helpMat);else if("_lightWorldViewProjectionMatrixCylinder"==n.link)null!=s&&(Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(r.V),Kr.helpMat.set__00(1),Kr.helpMat.set__20(0),Kr.helpMat.set__01(0),Kr.helpMat.set__21(0),Kr.helpMat.set__02(0),Kr.helpMat.set__22(1),Kr.helpMat2.getInverse(r.V),Kr.helpMat.multmat(Kr.helpMat2),Kr.helpMat.multmat(s.VP),a=Kr.helpMat);else if("_biasLightWorldViewProjectionMatrix"==n.link)null!=s&&(null==e?Kr.helpMat.setIdentity():Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(s.VP),Kr.helpMat.multmat(Kr.biasMat),a=Kr.helpMat);else if(q.startsWith(n.link,"_biasLightWorldViewProjectionMatrixSpot")){var o=Kr.getSpot(ht.cca(n.link,n.link.length-1)-48);null!=o&&(null==e?Kr.helpMat.setIdentity():Kr.helpMat.setFrom(e.transform.worldUnpack),Kr.helpMat.multmat(o.VP),Kr.helpMat.multmat(Kr.biasMat),a=Kr.helpMat)}else if(q.startsWith(n.link,"_biasLightViewProjectionMatrixSpot")){var l=Kr.getSpot(ht.cca(n.link,n.link.length-1)-48);null!=l&&(Kr.helpMat.setFrom(l.VP),Kr.helpMat.multmat(Kr.biasMat),a=Kr.helpMat)}else if(null!=Kr.externalMat4Links)for(var h=0,u=Kr.externalMat4Links;h<u.length;){var _=u[h];if(++h,null!=(a=_(e,Kr.currentMat(e),n.link)))break}if(null==a)return;t.setMatrix(i,a.self)}else if("mat3"==n.type){var c=null;if("_normalMatrix"==n.link&&(Kr.helpMat.setFrom(e.transform.world),Kr.helpMat.getInverse(Kr.helpMat),Kr.helpMat.transpose3x3(),Kr.helpMat3.setFrom4(Kr.helpMat),c=Kr.helpMat3),"_viewMatrix3"==n.link&&(Kr.helpMat3.setFrom4(r.V),c=Kr.helpMat3),null==c)return;t.setMatrix3(i,c.self)}else if("vec4"==n.type){var d=null;if(Kr.helpVec.set(0,0,0),null!=Kr.externalVec4Links)for(var p=0,f=Kr.externalVec4Links;p<f.length;){var g=f[p];if(++p,null!=(d=g(e,Kr.currentMat(e),n.link)))break}if(null==d)return;t.setFloat4(i,d.x,d.y,d.z,d.w)}else if("vec3"==n.type){var m=null;if(Kr.helpVec.set(0,0,0),"_dim"==n.link){var v=e.transform.dim,y=e.transform.scale;Kr.helpVec.set(v.x/y.x,v.y/y.y,v.z/y.z),m=Kr.helpVec}else if("_halfDim"==n.link){var w=e.transform.dim,b=e.transform.scale;Kr.helpVec.set(w.x/b.x/2,w.y/b.y/2,w.z/b.z/2),m=Kr.helpVec}else if("_worldPosition"==n.link)Kr.helpVec.set(e.transform.worldx(),e.transform.worldy(),e.transform.worldz()),m=Kr.helpVec;else if(null!=Kr.externalVec3Links)for(var x=0,S=Kr.externalVec3Links;x<S.length;){var k=S[x];if(++x,null!=(m=k(e,Kr.currentMat(e),n.link)))break}if(null==m)return;t.setFloat3(i,m.x,m.y,m.z)}else if("vec2"==n.type){var T=null,C=0;if("_tilesheetOffset"==n.link){var I=_s.__cast(e,Gr).tilesheet;T=I.tileX,C=I.tileY}else if(null!=Kr.externalVec2Links)for(var N=0,O=Kr.externalVec2Links;N<O.length;){var E=O[N];++N;var M=E(e,Kr.currentMat(e),n.link);if(null!=M){T=M.x,C=M.y;break}}if(null==T)return;t.setFloat2(i,T,C)}else if("float"==n.type){var L=null;if("_objectInfoIndex"==n.link)L=e.uid;else if("_objectInfoMaterialIndex"==n.link)L=Kr.currentMat(e).uid;else if("_objectInfoRandom"==n.link)L=e.urandom;else if("_posUnpack"==n.link)L=null!=Kr.posUnpack?Kr.posUnpack:1;else if("_texUnpack"==n.link)L=null!=Kr.texUnpack?Kr.texUnpack:1;else if(null!=Kr.externalFloatLinks)for(var A=0,B=Kr.externalFloatLinks;A<B.length;){var R=B[A];++A;var F=R(e,Kr.currentMat(e),n.link);if(null!=F){L=F;break}}if(null==L)return;t.setFloat(i,L)}else if("floats"==n.type){var P=null;if(null==P&&null!=Kr.externalFloatsLinks)for(var D=0,W=Kr.externalFloatsLinks;D<W.length;){var V=W[D];if(++D,null!=(P=V(e,Kr.currentMat(e),n.link)))break}if(null==P)return;t.setFloats(i,P)}else if("int"==n.type){var H=null;if("_uid"==n.link)H=e.uid;else if(null!=Kr.externalIntLinks)for(var z=0,G=Kr.externalIntLinks;z<G.length;){var U=G[z];++z;var j=U(e,Kr.currentMat(e),n.link);if(null!=j){H=j;break}}if(null==H)return;t.setInt(i,H)}}},Kr.setMaterialConstants=function(t,e,i){if(null!=i.raw.bind_constants)for(var n=0,r=i.raw.bind_constants.length;n<r;){for(var s=n++,a=i.raw.bind_constants[s],o=-1,l=0,h=e.raw.constants.length;l<h;){var u=l++;if(e.raw.constants[u].name==a.name){o=u;break}}if(-1!=o){var _=e.raw.constants[o];Kr.setMaterialConstant(t,e.constants[o],_,a)}}if(null!=i.textures)for(var c=0,d=i.textures.length;c<d;)for(var p=c++,f=i.raw.bind_textures[p].name,g=0,m=e.textureUnits.length;g<m;){var v=g++;if(f==e.raw.texture_units[v].name){t.setTexture(e.textureUnits[v],i.textures[p]),i.setTextureParameters(t,p,e,v);break}}},Kr.getSpot=function(t){for(var e=0,i=0,n=xr.active.lights;i<n.length;){var r=n[i];if(++i,"spot"==r.data.raw.type){if(e==t)return r;++e}}return null},Kr.currentMat=function(t){return null!=t&&t instanceof Gr?_s.__cast(t,Gr).materials[0]:null},Kr.setMaterialConstant=function(t,e,i,n){switch(i.type){case"bool":t.setBool(e,n.bool);break;case"float":t.setFloat(e,n.float);break;case"int":t.setInt(e,n.int);break;case"vec2":t.setFloat2(e,n.vec2[0],n.vec2[1]);break;case"vec3":t.setFloat3(e,n.vec3[0],n.vec3[1],n.vec3[2]);break;case"vec4":t.setFloat4(e,n.vec4[0],n.vec4[1],n.vec4[2],n.vec4[3])}};var Qr=function(){};(i["iron.system.ArmPack"]=Qr).__name__="iron.system.ArmPack",Qr.decode=function(t){var e=new dr(t);return e.set_bigEndian(!1),Qr.read(e)},Qr.read=function(t,e,i){null==i&&(i=""),null==e&&(e="");try{var n=t.readByte();switch(n){case 192:return null;case 194:return!1;case 195:return!0;case 196:return t.read(t.readByte());case 197:return t.read(t.readUInt16());case 198:return t.read(t.readInt32());case 202:return t.readFloat();case 204:return t.readByte();case 205:return t.readUInt16();case 206:return t.readInt32();case 208:return t.readInt8();case 209:return t.readInt16();case 210:return t.readInt32();case 217:return t.readString(t.readByte());case 218:return t.readString(t.readUInt16());case 219:return t.readString(t.readInt32());case 220:return Qr.readArray(t,t.readUInt16(),e,i);case 221:return Qr.readArray(t,t.readInt32(),e,i);case 222:return Qr.readMap(t,t.readUInt16(),e,i);case 223:return Qr.readMap(t,t.readInt32(),e,i);default:if(n<128)return n;if(n<144)return Qr.readMap(t,15&n,e,i);if(n<160)return Qr.readArray(t,15&n,e,i);if(n<192)return t.readString(31&n);if(223<n)return-256|n}}catch(t){var r=t instanceof us?t.val:t;if(!(r instanceof pr))throw t}return null},Qr.readArray=function(t,e,i,n){null==n&&(n=""),null==i&&(i="");var r=t.readByte(),s=t;if(s.set_position(s.get_position()-1),202==r){var a=t;a.set_position(a.get_position()+1);for(var o=new Float32Array(e),l=0,h=e;l<h;){o[l++]=t.readFloat()}return o}if(210==r){var u=t;u.set_position(u.get_position()+1);for(var _=new Uint32Array(e),c=0,d=e;c<d;){_[c++]=t.readInt32()}return _}if(209==r){var p=t;p.set_position(p.get_position()+1);for(var f=new Int16Array(e),g=0,m=e;g<m;){f[g++]=t.readInt16()}return f}for(var v=[],y=0,w=e;y<w;){y++;v.push(Qr.read(t,i,n))}return v},Qr.readMap=function(t,e,i,n){null==n&&(n=""),null==i&&(i="");for(var r={},s=0,a=e;s<a;){s++;var o=pt.string(Qr.read(t)),l=Qr.read(t,o,i);V.setField(r,o,l)}return r};var qr=function(){};(i["iron.system.Audio"]=qr).__name__="iron.system.Audio",qr.play=function(t,e,i){return null==i&&(i=!1),null==e&&(e=!1),null};var Jr=function(){};(i["iron.system.Input"]=Jr).__name__="iron.system.Input",Jr.reset=function(){Jr.occupied=!1,null!=Jr.mouse&&Jr.mouse.reset(),null!=Jr.pen&&Jr.pen.reset(),null!=Jr.keyboard&&Jr.keyboard.reset();for(var t=0,e=Jr.gamepads;t<e.length;){var i=e[t];++t,i.reset()}},Jr.endFrame=function(){null!=Jr.mouse&&Jr.mouse.endFrame(),null!=Jr.pen&&Jr.pen.endFrame(),null!=Jr.keyboard&&Jr.keyboard.endFrame();for(var t=0,e=Jr.gamepads;t<e.length;){var i=e[t];++t,i.endFrame()}if(null!=Jr.virtualButtons)for(var n=Jr.virtualButtons.iterator();n.hasNext();){var r=n.next();r.started=r.released=!1}},Jr.getMouse=function(){return Jr.registered||Jr.register(),null==Jr.mouse&&(Jr.mouse=new es),Jr.mouse},Jr.getSurface=function(){return Jr.registered||Jr.register(),Jr.getMouse()},Jr.getKeyboard=function(){return Jr.registered||Jr.register(),null==Jr.keyboard&&(Jr.keyboard=new ns),Jr.keyboard},Jr.getGamepad=function(t){if(null==t&&(t=0),4<=t)return null;for(Jr.registered||Jr.register();Jr.gamepads.length<=t;)Jr.gamepads.push(new ss(Jr.gamepads.length));return Jr.gamepads[t].connected?Jr.gamepads[t]:null},Jr.getSensor=function(){return Jr.registered||Jr.register(),null==Jr.sensor&&(Jr.sensor=new as),Jr.sensor},Jr.getVirtualButton=function(t){return Jr.registered||Jr.register(),null==Jr.virtualButtons?null:Jr.virtualButtons.get(t)},Jr.register=function(){Jr.registered=!0,vr.notifyOnEndFrame(Jr.endFrame),vr.notifyOnReset(Jr.reset)};var $r=function(){this.down=!1,this.released=!1,this.started=!1};(i["iron.system.VirtualButton"]=$r).__name__="iron.system.VirtualButton",$r.prototype={__class__:$r};var ts=function(){this.virtualButtons=null};(i["iron.system.VirtualInput"]=ts).__name__="iron.system.VirtualInput",ts.prototype={downVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons.get(t);null!=e&&(e.down=!0,e.started=!0)}},upVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons.get(t);null!=e&&(e.down=!1,e.released=!0)}},__class__:ts};var es=function(){this.lastY=-1,this.lastX=-1,this.hidden=!1,this.locked=!1,this.wheelDelta=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1,!1,!1],this.buttonsStarted=[!1,!1,!1],this.buttonsDown=[!1,!1,!1],ts.call(this),ja.get().notify(ko(this,this.downListener),ko(this,this.upListener),ko(this,this.moveListener),ko(this,this.wheelListener))};(i["iron.system.Mouse"]=es).__name__="iron.system.Mouse",es.__super__=ts,es.prototype=r(ts.prototype,{endFrame:function(){var t=this.buttonsStarted[1]=this.buttonsStarted[2]=!1;this.buttonsStarted[0]=t;var e=this.buttonsReleased[1]=this.buttonsReleased[2]=!1;this.buttonsReleased[0]=e,this.moved=!1,this.movementX=0,this.movementY=0,this.wheelDelta=0},reset:function(){var t=this.buttonsDown[1]=this.buttonsDown[2]=!1;this.buttonsDown[0]=t,this.endFrame()},buttonIndex:function(t){return"left"==t?0:"right"==t?1:2},down:function(t){return null==t&&(t="left"),this.buttonsDown[this.buttonIndex(t)]},started:function(t){return null==t&&(t="left"),this.buttonsStarted[this.buttonIndex(t)]},released:function(t){return null==t&&(t="left"),this.buttonsReleased[this.buttonIndex(t)]},lock:function(){ja.get().canLock()&&(ja.get().lock(),this.locked=!0,this.hidden=!0)},unlock:function(){ja.get().canLock()&&(ja.get().unlock(),this.locked=!1,this.hidden=!1)},hide:function(){ja.get().hideSystemCursor(),this.hidden=!0},show:function(){ja.get().showSystemCursor(),this.hidden=!1},downListener:function(t,e,i){this.buttonsDown[t]=!0,this.buttonsStarted[t]=!0,this.x=e-vr.x(),this.y=i-vr.y(),0==t&&(this.lastX=e,this.lastY=i),this.downVirtual(es.buttons[t])},upListener:function(t,e,i){this.buttonsDown[t]=!1,this.buttonsReleased[t]=!0,this.x=e-vr.x(),this.y=i-vr.y(),this.upVirtual(es.buttons[t])},moveListener:function(t,e,i,n){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.locked?(this.movementX=i,this.movementY=n):(this.movementX=t-this.lastX,this.movementY=e-this.lastY),this.lastX=t,this.lastY=e,this.x=t-vr.x(),this.y=e-vr.y(),this.moved=!0},wheelListener:function(t){this.wheelDelta=t},__class__:es});var is=function(){this.lastY=-1,this.lastX=-1,this.pressure=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1],this.buttonsStarted=[!1],this.buttonsDown=[!1],ts.call(this),Ya.get().notify(ko(this,this.downListener),ko(this,this.upListener),ko(this,this.moveListener))};(i["iron.system.Pen"]=is).__name__="iron.system.Pen",is.__super__=ts,is.prototype=r(ts.prototype,{endFrame:function(){this.buttonsStarted[0]=!1,this.buttonsReleased[0]=!1,this.moved=!1,this.movementX=0,this.movementY=0},reset:function(){this.buttonsDown[0]=!1,this.endFrame()},downListener:function(t,e,i){this.buttonsDown[0]=!0,this.buttonsStarted[0]=!0,this.x=t-vr.x(),this.y=e-vr.y(),this.pressure=i},upListener:function(t,e,i){this.buttonsDown[0]=!1,this.buttonsReleased[0]=!0,this.x=t-vr.x(),this.y=e-vr.y(),this.pressure=i},moveListener:function(t,e,i){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.movementX=t-this.lastX,this.movementY=e-this.lastY,this.lastX=t,this.lastY=e,this.x=t-vr.x(),this.y=e-vr.y(),this.moved=!0,this.pressure=i},__class__:is});var ns=function(){this.keysFrame=[],this.keysReleased=new ur,this.keysStarted=new ur,this.keysDown=new ur,ts.call(this),this.reset(),Ua.get().notify(ko(this,this.downListener),ko(this,this.upListener),ko(this,this.pressListener))};(i["iron.system.Keyboard"]=ns).__name__="iron.system.Keyboard",ns.keyCode=function(t){return 32==t?"space":8==t?"backspace":9==t?"tab":13==t?"enter":16==t?"shift":17==t?"control":18==t?"alt":27==t?"escape":46==t?"delete":38==t?"up":40==t?"down":37==t?"left":39==t?"right":1==t?"back":188==t?"comma":190==t?"period":48==t?"0":49==t?"1":50==t?"2":51==t?"3":52==t?"4":53==t?"5":54==t?"6":55==t?"7":56==t?"8":57==t?"9":112==t?"f1":113==t?"f2":114==t?"f3":115==t?"f4":116==t?"f5":117==t?"f6":118==t?"f7":119==t?"f8":120==t?"f9":121==t?"f10":122==t?"f11":123==t?"f12":String.fromCodePoint(t).toLowerCase()},ns.__super__=ts,ns.prototype=r(ts.prototype,{endFrame:function(){if(0<this.keysFrame.length){for(var t=0,e=this.keysFrame;t<e.length;){var i=e[t];++t,this.keysStarted.set(i,!1),this.keysReleased.set(i,!1)}this.keysFrame.splice(0,this.keysFrame.length)}},reset:function(){for(var t=0,e=ns.keys;t<e.length;){var i=e[t];++t,this.keysDown.set(i,!1),this.keysStarted.set(i,!1),this.keysReleased.set(i,!1)}this.endFrame()},down:function(t){return this.keysDown.get(t)},started:function(t){return this.keysStarted.get(t)},released:function(t){return this.keysReleased.get(t)},downListener:function(t){var e=ns.keyCode(t);this.keysFrame.push(e),this.keysStarted.set(e,!0),this.keysDown.set(e,!0),this.downVirtual(e)},upListener:function(t){var e=ns.keyCode(t);this.keysFrame.push(e),this.keysReleased.set(e,!0),this.keysDown.set(e,!1),this.upVirtual(e)},pressListener:function(t){},__class__:ns});var rs=function(){this.movementY=0,this.movementX=0,this.moved=!1,this.lastY=0,this.lastX=0,this.y=0,this.x=0};(i["iron.system.GamepadStick"]=rs).__name__="iron.system.GamepadStick",rs.prototype={__class__:rs};var ss=function(t,e){null==e&&(e=!1),this.num=0,this.connected=!1,this.rightStick=new rs,this.leftStick=new rs,this.buttonsFrame=[],this.buttonsReleased=[],this.buttonsStarted=[],this.buttonsDown=[],ts.call(this);for(var i=0,n=ss.buttons;i<n.length;){n[i];++i,this.buttonsDown.push(0),this.buttonsStarted.push(!1),this.buttonsReleased.push(!1)}this.num=t,this.reset(),e?this.connected=!0:this.connect()};(i["iron.system.Gamepad"]=ss).__name__="iron.system.Gamepad",ss.__super__=ts,ss.prototype=r(ts.prototype,{connect:function(){var t=za.get(this.num);null!=t&&(this.connected=!0,t.notify(ko(this,this.axisListener),ko(this,this.buttonListener)))},endFrame:function(){if(0<this.buttonsFrame.length){for(var t=0,e=this.buttonsFrame;t<e.length;){var i=e[t];++t,this.buttonsStarted[i]=!1,this.buttonsReleased[i]=!1}this.buttonsFrame.splice(0,this.buttonsFrame.length)}this.leftStick.moved=!1,this.leftStick.movementX=0,this.leftStick.movementY=0,this.rightStick.moved=!1,this.rightStick.movementX=0,this.rightStick.movementY=0},reset:function(){for(var t=0,e=this.buttonsDown.length;t<e;){var i=t++;this.buttonsDown[i]=0,this.buttonsStarted[i]=!1,this.buttonsReleased[i]=!1}this.endFrame()},buttonIndex:function(t){for(var e=0,i=ss.buttons.length;e<i;){var n=e++;if(ss.buttons[n]==t)return n}return 0},down:function(t){return this.buttonsDown[this.buttonIndex(t)]},started:function(t){return this.buttonsStarted[this.buttonIndex(t)]},released:function(t){return this.buttonsReleased[this.buttonIndex(t)]},axisListener:function(t,e){var i=t<=1?this.leftStick:this.rightStick;0==t||2==t?(i.lastX=i.x,i.x=e,i.movementX=i.x-i.lastX):1!=t&&3!=t||(i.lastY=i.y,i.y=e,i.movementY=i.y-i.lastY),i.moved=!0},buttonListener:function(t,e){this.buttonsFrame.push(t),0<(this.buttonsDown[t]=e)?this.buttonsStarted[t]=!0:this.buttonsReleased[t]=!0,0==e?this.upVirtual(ss.buttons[t]):1==e&&this.downVirtual(ss.buttons[t])},__class__:ss});var as=function(){this.z=0,this.y=0,this.x=0,Za.get(Ka.Accelerometer).notify(ko(this,this.listener))};(i["iron.system.Sensor"]=as).__name__="iron.system.Sensor",as.prototype={listener:function(t,e,i){this.x=t,this.y=e,this.z=i},__class__:as};var os=function(){};(i["iron.system.Storage"]=os).__name__="iron.system.Storage",os.__properties__={get_data:"get_data"},os.init=function(){os.file=zs.defaultFile(),null!=os.file&&(os._data=os.file.readObject(),null==os._data&&(os._data={}),os.save())},os.save=function(){null!=os.file&&os.file.writeObject(os._data)},os.get_data=function(){return null==os.file&&os.init(),os._data};var ls=function(){};(i["iron.system.Time"]=ls).__name__="iron.system.Time",ls.__properties__={get_delta:"get_delta"},ls.get_delta=function(){return.016666666666666666*ls.scale},ls.time=function(){return Ps.time()},ls.realTime=function(){return Ps.realTime()},ls.update=function(){ls.realDelta=ls.realTime()-ls.last,ls.last=ls.realTime()};var hs=function(){};(i["iron.system.Tween"]=hs).__name__="iron.system.Tween",hs.register=function(){hs.registered=!0,vr.notifyOnUpdate(hs.update),vr.notifyOnReset(function(){vr.notifyOnUpdate(hs.update),hs.reset()})},hs.to=function(t){if(hs.registered||hs.register(),t._time=0,t.isPlaying=!(null!=t.delay&&0<t.delay),null==t.ease&&(t.ease=0),null!=t.target&&null!=t.props){t._comps=[],t._x=[],t._y=[],t._z=[],t._w=[],t._normalize=[];for(var e=0,i=V.fields(t.props);e<i.length;){var n=i[e];++e;var r=V.getProperty(t.target,n);r instanceof bn||r instanceof Sn?(t._comps.push(4),t._x.push(r.x),t._y.push(r.y),t._z.push(r.z),t._w.push(r.w),t._normalize.push(r instanceof Sn)):(t._comps.push(1),t._x.push(r),t._y.push(0),t._z.push(0),t._w.push(0))}}return hs.anims.push(t),t},hs.timer=function(t,e){return hs.to({target:null,props:null,duration:0,delay:t,done:e})},hs.reset=function(){hs.anims=[]},hs.update=function(){for(var t=ls.get_delta(),e=hs.anims.length;0<e--&&0<hs.anims.length;){var i=hs.anims[e];if(!(0<i.delay&&(i.delay-=t,0<i.delay))){if(i._time+=t,i.isPlaying=i._time<i.duration,null!=i.target){i.target instanceof Yr&&(i.target.dirty=!0);for(var n=V.fields(i.props),r=0,s=n.length;r<s;){var a=r++,o=n[a],l=i._time/i.duration;if(1<l&&(l=1),1==i._comps[a]){var h=i._x[a],u=h+(V.getProperty(i.props,o)-h)*hs.eases[i.ease](l);V.setProperty(i.target,o,u)}else{var _=V.getProperty(i.props,o),c=V.getProperty(_,"x"),d=V.getProperty(_,"y"),p=V.getProperty(_,"z"),f=V.getProperty(_,"w");if(i._normalize[a])i._x[a]*c+i._y[a]*d+i._z[a]*p+i._w[a]*f<0&&(c=-c,d=-d,p=-p,f=-f);var g=i._x[a]+(c-i._x[a])*hs.eases[i.ease](l),m=i._y[a]+(d-i._y[a])*hs.eases[i.ease](l),v=i._z[a]+(p-i._z[a])*hs.eases[i.ease](l),y=i._w[a]+(f-i._w[a])*hs.eases[i.ease](l);if(i._normalize[a]){var w=Math.sqrt(g*g+m*m+v*v+y*y);0<w&&(g*=w=1/w,m*=w,v*=w,y*=w)}var b=V.getProperty(i.target,o);V.setProperty(b,"x",g),V.setProperty(b,"y",m),V.setProperty(b,"z",v),V.setProperty(b,"w",y)}}}i.isPlaying?null!=i.tick&&i.tick():(hs.anims.splice(e,1),--e,i.isPlaying=!1,null!=i.done&&i.done())}}},hs.easeLinear=function(t){return t},hs.easeSineIn=function(t){return 0==t?0:1==t?1:1-Math.cos(t*Math.PI/2)},hs.easeSineOut=function(t){return 0==t?0:1==t?1:Math.sin(t*(.5*Math.PI))},hs.easeSineInOut=function(t){return 0==t?0:1==t?1:-.5*(Math.cos(Math.PI*t)-1)},hs.easeQuadIn=function(t){return t*t},hs.easeQuadOut=function(t){return-t*(t-2)},hs.easeQuadInOut=function(t){return t<.5?2*t*t:--t*t*-2+1},hs.easeCubicIn=function(t){return t*t*t},hs.easeCubicOut=function(t){return--t*t*t+1},hs.easeCubicInOut=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},hs.easeQuartIn=function(t){return(t*=t)*t},hs.easeQuartOut=function(t){return 1-(t=--t*t)*t},hs.easeQuartInOut=function(t){return(t*=2)<1?.5*(t*=t)*t:-.5*((t=(t-=2)*t)*t-2)},hs.easeQuintIn=function(t){return t*(t*=t)*t},hs.easeQuintOut=function(t){return--t*(t*=t)*t+1},hs.easeQuintInOut=function(t){return(t*=2)<1?.5*t*(t*=t)*t:.5*(t-=2)*(t*=t)*t+1},hs.easeExpoIn=function(t){return 0==t?0:Math.pow(2,10*(t-1))},hs.easeExpoOut=function(t){return 1==t?1:1-Math.pow(2,-10*t)},hs.easeExpoInOut=function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},hs.easeCircIn=function(t){return-(Math.sqrt(1-t*t)-1)},hs.easeCircOut=function(t){return Math.sqrt(1-(t-1)*(t-1))},hs.easeCircInOut=function(t){return t<=.5?(Math.sqrt(1-t*t*4)-1)/-2:(Math.sqrt(1-(2*t-2)*(2*t-2))+1)/2},hs.easeBackIn=function(t){return 0==t?0:1==t?1:t*t*(2.70158*t-1.70158)},hs.easeBackOut=function(t){return 0==t?0:1==t?1:--t*t*(2.70158*t+1.70158)+1},hs.easeBackInOut=function(t){return 0==t?0:1==t?1:(t*=2)<1?t*t*(3.5949095*t-2.5949095)*.5:.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)};var us=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,us)};(i["js._Boot.HaxeError"]=us).__name__="js._Boot.HaxeError",us.wrap=function(t){return t instanceof Error?t:new us(t)},us.__super__=Error,us.prototype=r(Error.prototype,{__class__:us});var _s=function(){};(i["js.Boot"]=_s).__name__="js.Boot",_s.isClass=function(t){return t.__name__},_s.isEnum=function(t){return t.__ename__},_s.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=_s.__nativeClassName(t);return null!=i?_s.__resolveNativeClass(i):null},_s.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var i=typeof t;switch("function"==i&&(_s.isClass(t)||_s.isEnum(t))&&(i="object"),i){case"function":return"<function>";case"object":if(t.__enum__){var n=w[t.__enum__],r=n.__constructs__[t._hx_index],s=n[r];if(s.__params__){e+="\t";for(var a=r+"(",o=[],l=0,h=s.__params__;l<h.length;){var u=h[l];++l,o.push(_s.__string_rec(t[u],e))}return a+o.join(",")+")"}return r}if(t instanceof Array){var _="[";e+="\t";for(var c=0,d=t.length;c<d;){var p=c++;_+=(0<p?",":"")+_s.__string_rec(t[p],e)}return _+="]"}var f;try{f=t.toString}catch(t){t instanceof us&&t.val;return"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f){var g=t.toString();if("[object Object]"!=g)return g}var m=null,v="{\n";e+="\t";var y=null!=t.hasOwnProperty;for(var m in t)y&&!t.hasOwnProperty(m)||"prototype"!=m&&"__class__"!=m&&"__super__"!=m&&"__interfaces__"!=m&&"__properties__"!=m&&(2!=v.length&&(v+=", \n"),v+=e+m+" : "+_s.__string_rec(t[m],e));return v+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},_s.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var n=0,r=i.length;n<r;){var s=i[n++];if(s==e||_s.__interfLoop(s,e))return!0}return _s.__interfLoop(t.__super__,e)},_s.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case No:return"boolean"==typeof t;case Co:return!0;case Io:return"number"==typeof t;case To:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(_s.__interfLoop(_s.getClass(t),e))return!0}else if("object"==typeof e&&_s.__isNativeObj(e)&&t instanceof e)return!0;return e==Oo&&null!=t.__name__||(e==Eo&&null!=t.__ename__||w[t.__enum__]==e)}},_s.__cast=function(t,e){if(_s.__instanceof(t,e))return t;throw new us("Cannot cast "+pt.string(t)+" to "+pt.string(e))},_s.__nativeClassName=function(t){var e=_s.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},_s.__isNativeObj=function(t){return null!=_s.__nativeClassName(t)},_s.__resolveNativeClass=function(t){return e[t]};var cs=function(){};(i["js.Browser"]=cs).__name__="js.Browser",cs.getLocalStorage=function(){try{var t=window.localStorage;if(t.getItem(""),0==t.length){var e="_hx_"+Math.random();t.setItem(e,e),t.removeItem(e)}return t}catch(t){t instanceof us&&t.val;return null}};var ds=function(){};(i["js.Lib"]=ds).__name__="js.Lib",ds.__properties__={get_undefined:"get_undefined"},ds.get_undefined=function(){};var ps=function(){};(i["js.html._ArrayBuffer.ArrayBufferCompat"]=ps).__name__="js.html._ArrayBuffer.ArrayBufferCompat",ps.sliceImpl=function(t,e){var i=new Uint8Array(this,t,null==e?null:e-t),n=new Uint8Array(i.byteLength);return n.set(i),n.buffer};var fs=function(){this.names=[]};(i["kha._Assets.ImageList"]=fs).__name__="kha._Assets.ImageList",fs.prototype={get:function(t){return V.field(this,t)},__class__:fs};var gs=function(){this.names=[]};(i["kha._Assets.SoundList"]=gs).__name__="kha._Assets.SoundList",gs.prototype={get:function(t){return V.field(this,t)},__class__:gs};var ms=function(){this.names=[]};(i["kha._Assets.BlobList"]=ms).__name__="kha._Assets.BlobList",ms.prototype={get:function(t){return V.field(this,t)},__class__:ms};var vs=function(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null};(i["kha._Assets.FontList"]=vs).__name__="kha._Assets.FontList",vs.prototype={get:function(t){return V.field(this,t)},font_defaultLoad:function(e,t){ws.loadFont("font_default",function(t){e()},ws.reporter(t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"font_defaultLoad"}),{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},__class__:vs};var ys=function(){this.names=[]};(i["kha._Assets.VideoList"]=ys).__name__="kha._Assets.VideoList",ys.prototype={get:function(t){return V.field(this,t)},__class__:ys};var ws=function(){};(i["kha.Assets"]=ws).__name__="kha.Assets",ws.loadImageFromPath=function(t,e,i,n,r){var s={files:[t],readable:e};Bs.loadImageFromDescription(s,i,ws.reporter(n,r))},ws.loadBlobFromPath=function(t,e,i,n){var r={files:[t]};Bs.loadBlobFromDescription(r,e,ws.reporter(i,n))},ws.loadFont=function(e,i,t,n){var r=V.field(ws.fonts,e+"Description");Bs.loadFontFromDescription(r,function(t){V.setField(ws.fonts,e,t),i(t)},ws.reporter(t,n))},ws.loadFontFromPath=function(t,e,i,n){var r={files:[t]};Bs.loadFontFromDescription(r,e,ws.reporter(i,n))},ws.reporter=function(t,e){if(null!=t)return t;var i=Jn.trace,n=e;return function(t){i(t,n)}};var bs=function(){};(i["kha.Canvas"]=bs).__name__="kha.Canvas",bs.prototype={__class__:bs,__properties__:{get_width:"get_width",get_height:"get_height",get_g4:"get_g4"}};var xs=function(){};(i["kha.Resource"]=xs).__name__="kha.Resource";var Ss=function(){};(i["kha.Image"]=Ss).__name__="kha.Image",Ss.__interfaces__=[xs,bs],Ss.__properties__={get_nonPow2Supported:"get_nonPow2Supported"},Ss.create=function(t,e,i,n){return null==i&&(i=0),null==n&&(n=0),null==Xs.gl?new ks(t,e,i,!1):new Zs(t,e,i,!1,0,1)},Ss.create3D=function(t,e,i,n,r){return null},Ss.createRenderTarget=function(t,e,i,n,r,s){return null==s&&(s=0),null==r&&(r=1),null==n&&(n=0),null==i&&(i=0),null==Xs.gl?new ks(t,e,i,!0):new Zs(t,e,i,!0,n,r)},Ss.fromImage=function(t,e){if(null==Xs.gl){var i=new ks(t.width,t.height,0,!1);return i.image=t,i.createTexture(),i}var n=new Zs(t.width,t.height,0,!1,0,1);return n.image=t,n.createTexture(),n},Ss.fromBytes=function(t,e,i,n,r){if(null==n&&(n=0),null==r&&(r=0),null!=Xs.gl){var s=new Zs(e,i,n,!1,0,1);return s.image=s.bytesToArray(t),s.createTexture(),s}return null},Ss.get_nonPow2Supported=function(){return null!=Xs.gl},Ss.prototype={unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},generateMipmaps:function(t){},setMipmaps:function(t){},setDepthStencilFrom:function(t){},get_width:function(){return 0},get_height:function(){return 0},get_depth:function(){return 1},get_realWidth:function(){return 0},get_realHeight:function(){return 0},get_g2:function(){return null},get_g4:function(){return null},__class__:Ss,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var ks=function(t,e,i,n){this.g2canvas=null,this.myWidth=t,this.myHeight=e,this.format=i,this.renderTarget=n,this.image=null,this.video=null,n&&this.createTexture()};(i["kha.CanvasImage"]=ks).__name__="kha.CanvasImage",ks.init=function(){var t=window.document.createElement("canvas");null!=t&&(ks.context=t.getContext("2d"),t.width=2048,t.height=2048,ks.context.globalCompositeOperation="copy")},ks.__super__=Ss,ks.prototype=r(Ss.prototype,{get_g2:function(){if(null==this.g2canvas){var t=window.document.createElement("canvas"),e=(this.image=t).getContext("2d");t.width=this.get_width(),t.height=this.get_height(),this.g2canvas=new eo(e)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){null!=Xs.gl&&(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=Xs.gl.createFramebuffer(),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),Xs.gl.bindFramebuffer(36160,null)):null!=this.video?Xs.gl.texImage2D(3553,0,6408,6408,5121,this.video):Xs.gl.texImage2D(3553,0,6408,6408,5121,this.image),Xs.gl.bindTexture(3553,null))},lock:function(t){return null==t&&(t=0),this.bytes=ir.alloc(0==this.format?4*this.get_width()*this.get_height():this.get_width()*this.get_height()),this.bytes},unlock:function(){if(null!=Xs.gl){if(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),Xs.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Uint8Array(this.bytes.getData())),1282==Xs.gl.getError()){for(var t=ir.alloc(this.get_width()*this.get_height()*4),e=0,i=this.get_height();e<i;)for(var n=e++,r=0,s=this.get_width();r<s;){var a=r++,o=this.bytes.get(n*this.get_width()+a);t.set(n*this.get_width()*4+4*a,o),t.set(n*this.get_width()*4+4*a+1,o),t.set(n*this.get_width()*4+4*a+2,o),t.set(n*this.get_width()*4+4*a+3,255)}Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Uint8Array(t.getData()))}Xs.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:ks});var Ts=t.kha._Color.Color_Impl_={};(i["kha._Color.Color_Impl_"]=Ts).__name__="kha._Color.Color_Impl_",Ts.fromBytes=function(t,e,i,n){return null==n&&(n=255),Ts._new(n<<24|t<<16|e<<8|i)},Ts.fromFloats=function(t,e,i,n){return null==n&&(n=1),Ts._new(pt.int(255*n)<<24|pt.int(255*t)<<16|pt.int(255*e)<<8|pt.int(255*i))},Ts._new=function(t){return t};var Cs=function(){};(i["kha.CompilerDefines"]=Cs).__name__="kha.CompilerDefines";var Is=function(){};(i["kha.Display"]=Is).__name__="kha.Display",Is.__properties__={get_all:"get_all",get_primary:"get_primary"},Is.get_primary=function(){return Is.instance},Is.get_all=function(){return[Is.get_primary()]},Is.prototype={get_width:function(){return window.screen.width},get_height:function(){return window.screen.height},get_frequency:function(){return 60},__class__:Is,__properties__:{get_frequency:"get_frequency",get_height:"get_height",get_width:"get_width"}};var Ns=function(){};(i["kha.DisplayMode"]=Ns).__name__="kha.DisplayMode";var Os=function(t,e,i,n,r){this.window=t,this.graphics1=e,this.graphics2=i,this.graphics4=n,this.graphics5=r};(i["kha.Framebuffer"]=Os).__name__="kha.Framebuffer",Os.__interfaces__=[bs],Os.prototype={init:function(t,e,i,n){this.graphics1=t,this.graphics2=e,this.graphics4=i,this.graphics5=n},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return Us.windowWidth(this.window)},get_height:function(){return Us.windowHeight(this.window)},__class__:Os,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2"}};var Es=function(t,e,i,n,r,s){null==s&&(s=1),null==r&&(r=8),null==n&&(n=16),null==i&&(i=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=i,this.depthBufferBits=n,this.stencilBufferBits=r,this.samplesPerPixel=s};(i["kha.FramebufferOptions"]=Es).__name__="kha.FramebufferOptions",Es.prototype={__class__:Es};var Ms=function(){};(i["kha.AlignedQuad"]=Ms).__name__="kha.AlignedQuad",Ms.prototype={__class__:Ms};var Ls=function(t,e,i,n,r,s,a,o){this.mySize=t,this.width=r,this.height=s,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var h=a[l];++l,h.yoff+=this.baseline}this.texture=Ss.create(r,s,1);for(var u=this.texture.lock(),_=0,c=0,d=s;c<d;){c++;for(var p=0,f=r;p<f;){p++;u.set(_,o.readU8(_)),++_}}this.texture.unlock()};(i["kha.KravurImage"]=Ls).__name__="kha.KravurImage",Ls.prototype={getTexture:function(){return this.texture},getBakedQuad:function(t,e,i,n){if(e>=this.chars.length)return null;var r=1/this.width,s=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(n+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*r,t.t0=a.y0*s,t.s1=a.x1*r,t.t1=a.y1*s,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=Ls.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var i=1,n=pt.int(Ls.charBlocks.length/2);i<n;){var r=i++,s=Ls.charBlocks[2*r-1],a=Ls.charBlocks[2*r];a-1<t&&(e+=a-1-s)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,i=0,n=t.length;i<n;){var r=i++;e+=this.getCharWidth(ht.cca(t,r))}return e},__class__:Ls};var As=function(t){this.images=new rr,this.blob=t};(i["kha.Kravur"]=As).__name__="kha.Kravur",As.__interfaces__=[xs],As.prototype={_get:function(t){var e=sa.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var i=(Ls.charBlocks=[e[0]])[0]+1,n=1,r=e.length;n<r;){var s=n++;e[s]!=i?(Ls.charBlocks.push(e[s-1]),Ls.charBlocks.push(e[s]),i=e[s]+1):++i}Ls.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(!this.images.exists(a)){for(var o=64,l=32,h=new Array(e.length),u=0,_=h.length;u<_;){h[u++]=new da}for(var c=null,d=-1;d<=0;)l<o?l*=2:o*=2,c=qa.alloc(o*l),d=wa.stbtt_BakeFontBitmap(this.blob,0,t,c,o,l,e,h);var p=new pa;wa.stbtt_InitFont(p,this.blob,0);var f=wa.stbtt_GetFontVMetrics(p),g=wa.stbtt_ScaleForPixelHeight(p,t),m=Math.round(f.ascent*g),v=Math.round(f.descent*g),y=Math.round(f.lineGap*g),w=new Ls(pt.int(t),m,v,y,o,l,h,c);return this.images.set(a,w),w}return this.images.get(a)},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},unload:function(){this.blob=null,this.images=null},__class__:As};var Bs=function(){};(i["kha.LoaderImpl"]=Bs).__name__="kha.LoaderImpl",Bs.loadImageFromDescription=function(e,n,i){var r=V.hasField(e,"readable")&&e.readable;if(q.endsWith(e.files[0],".hdr"))Bs.loadBlobFromDescription(e,function(t){var e=Ja.parse(t.toBytes()),i=Ss.fromBytes(ir.ofData(e.data.buffer),e.width,e.height,2,r?1:0);n(i)},i);else{var s=window.document.createElement("img");s.onerror=function(t){i({url:e.files[0],error:t})},s.onload=function(t){var e=Ss.fromImage(s,r);n(e)},s.src=e.files[0],s.crossOrigin=""}},Bs.loadRemote=function(o,l,h){var u=new XMLHttpRequest;u.open("GET",o.files[0],!0),u.responseType="arraybuffer",u.onreadystatechange=function(){if(4==u.readyState)if(200<=u.status&&u.status<400||0==u.status&&""==u.statusText){var t=null,e=u.response;if(null!=e){var i=new Uint8Array(e);t=ir.ofData(i)}else{if(null==u.responseBody)return void h({url:o.files[0]});var n=VBArray(u.responseBody).toArray();t=ir.alloc(n.length);for(var r=0,s=n.length;r<s;){var a=r++;t.set(a,n[a])}}l(new qa(t))}else h({url:o.files[0]})},u.send(null)},Bs.loadBlobFromDescription=function(t,e,i){Bs.loadRemote(t,e,i)},Bs.loadFontFromDescription=function(t,e,i){Bs.loadBlobFromDescription(t,function(t){e(new As(t))},i)};var Rs=function(){};(i["kha.TimeTask"]=Rs).__name__="kha.TimeTask",Rs.prototype={__class__:Rs};var Fs=function(t,e,i){this.task=t,this.priority=e,this.id=i,this.active=!0,this.paused=!1};(i["kha.FrameTask"]=Fs).__name__="kha.FrameTask",Fs.prototype={__class__:Fs};var Ps=function(){};(i["kha.Scheduler"]=Ps).__name__="kha.Scheduler",Ps.init=function(){Ps.deltas=[];for(var t=0,e=Ps.DIF_COUNT;t<e;){var i=t++;Ps.deltas[i]=0}Ps.stopped=!0,Ps.frame_tasks_sorted=!0,Ps.current=Ps.lastTime=Ps.realTime(),Ps.currentFrameTaskId=0,Ps.currentTimeTaskId=0,Ps.currentGroupId=0,Ps.timeTasks=[],Ps.pausedTimeTasks=[],Ps.outdatedTimeTasks=[],Ps.timeTasksScratchpad=[],Ps.frameTasks=[],Ps.toDeleteFrame=[]},Ps.start=function(t){null==t&&(t=!1),Ps.vsync=Ks.get(0).get_vSynced();var e=Is.get_primary().get_frequency();57<=e&&e<=63&&(e=60),Ps.onedifhz=1/e,Ps.stopped=!1,Ps.resetTime(),Ps.lastTime=Ps.realTime()-Ps.startTime;for(var i=0,n=Ps.DIF_COUNT;i<n;){var r=i++;Ps.deltas[r]=0}if(t){for(var s=0,a=Ps.timeTasks;s<a.length;){var o=a[s];++s,o.paused=!1}for(var l=0,h=Ps.frameTasks;l<h.length;){var u=h[l];++l,u.paused=!1}}},Ps.executeFrame=function(){var t=Ps.realTime()-Ps.startTime-Ps.lastTime,e=Ps.current;if(0<=t){if(null==go.the())if(t>Ps.maxframetime)Ps.startTime+=t-Ps.maxframetime,e+=t=Ps.maxframetime;else if(Ps.vsync){for(var i=Ps.onedifhz;i<t-Ps.onedifhz;)i+=Ps.onedifhz;t=i;for(var n=0,r=Ps.DIF_COUNT-2;n<r;){var s=n++;t+=Ps.deltas[s],Ps.deltas[s]=Ps.deltas[s+1]}t+=Ps.deltas[Ps.DIF_COUNT-2],t/=Ps.DIF_COUNT,Ps.deltas[Ps.DIF_COUNT-2]=i,e+=t}else{for(var a=0,o=Ps.DIF_COUNT-1;a<o;){var l=a++;Ps.deltas[l]=Ps.deltas[l+1]}Ps.deltas[Ps.DIF_COUNT-1]=t;for(var h=0,u=0,_=Ps.DIF_COUNT;u<_;){var c=u++;h+=Ps.deltas[c]}e+=h/=Ps.DIF_COUNT}else e+=t;Ps.lastTime=e,Ps.stopped||(Ps.current=e);for(var d=0,p=Ps.pausedTimeTasks;d<p.length;){var f=p[d];++d,f.next+=t}if(Ps.stopped)for(var g=0,m=Ps.timeTasks;g<m.length;){var v=m[g];++g,v.next+=t}Ps.executeTimeTasks(e);for(var y=0,w=Ps.outdatedTimeTasks;y<w.length;){var b=w[y];++y,b.next<e-10&&Ps.timeTasksScratchpad.push(b)}for(var x=0,S=Ps.timeTasksScratchpad;x<S.length;){var k=S[x];++x,ht.remove(Ps.outdatedTimeTasks,k)}for(;0<Ps.timeTasksScratchpad.length;)ht.remove(Ps.timeTasksScratchpad,Ps.timeTasksScratchpad[0])}Ps.sortFrameTasks();for(var T=0,C=Ps.frameTasks;T<C.length;){var I=C[T];++T,Ps.stopped||I.paused||!I.active||I.task()||(I.active=!1)}for(var N=0,O=Ps.frameTasks;N<O.length;){var E=O[N];++N,E.active||Ps.toDeleteFrame.push(E)}for(;0<Ps.toDeleteFrame.length;)ht.remove(Ps.frameTasks,Ps.toDeleteFrame.pop())},Ps.executeTimeTasks=function(t){for(;0<Ps.timeTasks.length&&(Ps.activeTimeTask=Ps.timeTasks[0],Ps.activeTimeTask.next<=t);)Ps.activeTimeTask.next+=Ps.activeTimeTask.period,ht.remove(Ps.timeTasks,Ps.activeTimeTask),Ps.activeTimeTask.active&&Ps.activeTimeTask.task()?0<Ps.activeTimeTask.period&&(0==Ps.activeTimeTask.duration||Ps.activeTimeTask.duration>=Ps.activeTimeTask.start+Ps.activeTimeTask.next)?Ps.insertSorted(Ps.timeTasks,Ps.activeTimeTask):Ps.archiveTimeTask(Ps.activeTimeTask,t):(Ps.activeTimeTask.active=!1,Ps.archiveTimeTask(Ps.activeTimeTask,t));Ps.activeTimeTask=null},Ps.archiveTimeTask=function(t,e){},Ps.time=function(){return Ps.current},Ps.realTime=function(){return Us.get_time()},Ps.resetTime=function(){var t=Us.get_time(),e=t-Ps.startTime;Ps.startTime=t;for(var i=0,n=Ps.timeTasks;i<n.length;){var r=n[i];++i,r.start-=e,r.next-=e}for(var s=0,a=Ps.DIF_COUNT;s<a;){var o=s++;Ps.deltas[o]=0}Ps.current=0,Ps.lastTime=0},Ps.addBreakableTimeTaskToGroup=function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=new Rs;return s.active=!0,s.task=e,s.id=++Ps.currentTimeTaskId,s.groupId=t,s.start=Ps.current+i,(s.period=0)!=n&&(s.period=n),(s.duration=0)!=r&&(s.duration=s.start+r),s.next=s.start,Ps.insertSorted(Ps.timeTasks,s),s.id},Ps.addTimeTaskToGroup=function(t,e,i,n,r){return null==r&&(r=0),null==n&&(n=0),Ps.addBreakableTimeTaskToGroup(t,function(){return e(),!0},i,n,r)},Ps.addTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),Ps.addTimeTaskToGroup(0,t,e,i,n)},Ps.insertSorted=function(t,e){for(var i=0,n=t.length;i<n;){var r=i++;if(t[r].next>e.next)return void t.splice(r,0,e)}t.push(e)},Ps.sortFrameTasks=function(){Ps.frame_tasks_sorted||(Ps.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),Ps.frame_tasks_sorted=!0)};w["kha.ScreenRotation"]={__ename__:"kha.ScreenRotation",__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:n},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:n},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:n},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:n}};var Ds=function(){};(i["kha.Shaders"]=Ds).__name__="kha.Shaders",Ds.init=function(){var t=[],e=V.field(Ds,"Material_mesh_vertData0"),i=er.run(e);t.push(qa.fromBytes(i)),Ds.Material_mesh_vert=new Wa(t,["Material_mesh-webgl2.vert.essl"]);var n=[],r=V.field(Ds,"Material_shadowmap_vertData0"),s=er.run(r);n.push(qa.fromBytes(s)),Ds.Material_shadowmap_vert=new Wa(n,["Material_shadowmap-webgl2.vert.essl"]);var a=[],o=V.field(Ds,"Material_mesh_fragData0"),l=er.run(o);a.push(qa.fromBytes(l)),Ds.Material_mesh_frag=new Sa(a,["Material_mesh-webgl2.frag.essl"]);var h=[],u=V.field(Ds,"Material_shadowmap_fragData0"),_=er.run(u);h.push(qa.fromBytes(_)),Ds.Material_shadowmap_frag=new Sa(h,["Material_shadowmap-webgl2.frag.essl"]);var c=[],d=V.field(Ds,"painter_colored_fragData0"),p=er.run(d);c.push(qa.fromBytes(p)),Ds.painter_colored_frag=new Sa(c,["painter-colored-webgl2.frag.essl"]);var f=[],g=V.field(Ds,"painter_colored_vertData0"),m=er.run(g);f.push(qa.fromBytes(m)),Ds.painter_colored_vert=new Wa(f,["painter-colored-webgl2.vert.essl"]);var v=[],y=V.field(Ds,"painter_image_fragData0"),w=er.run(y);v.push(qa.fromBytes(w)),Ds.painter_image_frag=new Sa(v,["painter-image-webgl2.frag.essl"]);var b=[],x=V.field(Ds,"painter_text_fragData0"),S=er.run(x);b.push(qa.fromBytes(S)),Ds.painter_text_frag=new Sa(b,["painter-text-webgl2.frag.essl"]);var k=[],T=V.field(Ds,"painter_image_vertData0"),C=er.run(T);k.push(qa.fromBytes(C)),Ds.painter_image_vert=new Wa(k,["painter-image-webgl2.vert.essl"]);var I=[],N=V.field(Ds,"painter_text_vertData0"),O=er.run(N);I.push(qa.fromBytes(O)),Ds.painter_text_vert=new Wa(I,["painter-text-webgl2.vert.essl"]);var E=[],M=V.field(Ds,"painter_video_fragData0"),L=er.run(M);E.push(qa.fromBytes(L)),Ds.painter_video_frag=new Sa(E,["painter-video-webgl2.frag.essl"]);var A=[],B=V.field(Ds,"painter_video_vertData0"),R=er.run(B);A.push(qa.fromBytes(R)),Ds.painter_video_vert=new Wa(A,["painter-video-webgl2.vert.essl"])};var Ws=function(){};(i["kha.Sound"]=Ws).__name__="kha.Sound",Ws.__interfaces__=[xs],Ws.prototype={__class__:Ws};var Vs=function(){};(i["kha.StorageFile"]=Vs).__name__="kha.StorageFile",Vs.prototype={read:function(){return null},write:function(t){},writeString:function(t){var e=ir.ofString(t);this.write(qa.fromBytes(e))},readString:function(){var t=this.read();return null==t?null:t.toString()},writeObject:function(t){this.writeString($n.run(t))},readObject:function(){var t=this.readString();if(null==t)return null;try{return er.run(t)}catch(t){t instanceof us&&t.val;return null}},__class__:Vs};var Hs=function(t){this.name=t};(i["kha.LocalStorageFile"]=Hs).__name__="kha.LocalStorageFile",Hs.encode=function(t){for(var e,i,n=[0,10,13,61],r="",s=new Uint8Array(t),a=0,o=s.length;a<o;){i=s[a++],l.has(n,e=(i+42)%256)?(e=(e+64)%256,r+="="+String.fromCodePoint(e)):r+=String.fromCodePoint(e)}return r},Hs.decode=function(t){for(var e,i=new _r,n=!1,r=0,s=t.length;r<s;){var a=r++;13!=(e=q.fastCodeAt(t,a))&&10!=e&&(61!=e||n?(n&&(n=!1,e-=64),e<42&&0<e?i.addByte(e+214):i.addByte(e-42)):n=!0)}return i.getBytes()},Hs.__super__=Vs,Hs.prototype=r(Vs.prototype,{read:function(){var t=cs.getLocalStorage();if(null==t)return null;var e=t.getItem(Us.get_title()+"_"+this.name);return null==e?null:qa.fromBytes(Hs.decode(e))},write:function(t){var e=cs.getLocalStorage();null!=e&&e.setItem(Us.get_title()+"_"+this.name,Hs.encode(t.bytes.getData()))},__class__:Hs});var zs=function(){};(i["kha.Storage"]=zs).__name__="kha.Storage",zs.namedFile=function(t){return new Hs(t)},zs.defaultFile=function(){return zs.namedFile("default.kha")};var Gs=function(t,e,i,n,r){null==i&&(i=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==n?new Qs(null,null,null,null,null,null,null,null,null):n,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<i?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==r?new Es(null,null,null,null,null,null):r};(i["kha.SystemOptions"]=Gs).__name__="kha.SystemOptions",Gs.prototype={__class__:Gs};var Us=function(){};(i["kha.System"]=Us).__name__="kha.System",Us.__properties__={get_time:"get_time",get_title:"get_title"},Us.start=function(t,e){Us.theTitle=t.title,Xs.init(t,e)},Us.get_title=function(){return Us.theTitle},Us.notifyOnFrames=function(t){Us.renderListeners.push(t)},Us.notifyOnCutCopyPaste=function(t,e,i){Us.cutListener=t,Us.copyListener=e,Us.pasteListener=i},Us.render=function(t){for(var e=0,i=Us.renderListeners;e<i.length;){var n=i[e];++e,n(t)}},Us.foreground=function(){for(var t=0,e=Us.foregroundListeners;t<e.length;){var i=e[t];++t,i()}},Us.background=function(){for(var t=0,e=Us.backgroundListeners;t<e.length;){var i=e[t];++t,i()}},Us.shutdown=function(){for(var t=0,e=Us.shutdownListeners;t<e.length;){var i=e[t];++t,i()}},Us.get_time=function(){return Xs.getTime()},Us.windowWidth=function(t){return null==t&&(t=0),Ks.get(t).get_width()},Us.windowHeight=function(t){return null==t&&(t=0),Ks.get_all()[t].get_height()},Us.stop=function(){return Xs.requestShutdown()};var js=function(){this.axes=[],this.buttons=[]};(i["kha.GamepadStates"]=js).__name__="kha.GamepadStates",js.prototype={__class__:js};var Xs=function(){};(i["kha.SystemImpl"]=Xs).__name__="kha.SystemImpl",Xs.init=function(t,e){Xs.options=t,Xs.mobile=Xs.isMobile(),Xs.ios=Xs.isIOS(),Xs.chrome=Xs.isChrome(),Xs.firefox=Xs.isFirefox(),Xs.ie=Xs.isIE(),Xs.initSecondStep(e)},Xs.initSecondStep=function(t){Xs.init2(Xs.options.window.width,Xs.options.window.height),t(Xs.window)},Xs.initSensor=function(){Xs.ios?window.ondevicemotion=function(t){Za._changed(0,-t.accelerationIncludingGravity.x,-t.accelerationIncludingGravity.y,-t.accelerationIncludingGravity.z)}:window.ondevicemotion=function(t){Za._changed(0,t.accelerationIncludingGravity.x,t.accelerationIncludingGravity.y,t.accelerationIncludingGravity.z)},window.ondeviceorientation=function(t){Za._changed(1,t.beta,t.gamma,t.alpha)}},Xs.isMobile=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("Android")||0<=t.indexOf("webOS")||0<=t.indexOf("BlackBerry")||0<=t.indexOf("Windows Phone")||!!Xs.isIOS()},Xs.isIOS=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("iPhone")||0<=t.indexOf("iPad")||0<=t.indexOf("iPod")},Xs.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},Xs.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},Xs.isIE=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("MSIE ")||0<=t.indexOf("Trident/")},Xs.setCanvas=function(t){Xs.khanvas=t},Xs.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},Xs.requestShutdown=function(){return window.close(),!0},Xs.init2=function(t,e,i){if(Xs.keyboard=new Ua,Xs.mouse=new Xa,Xs.surface=new Qa,Xs.gamepads=[],Xs.gamepadStates=[],Xs.gamepads[0]=new za(0),Xs.gamepadStates[0]=new js,Xs.gamepads[1]=new za(1),Xs.gamepadStates[1]=new js,Xs.gamepads[2]=new za(2),Xs.gamepadStates[2]=new js,Xs.gamepads[3]=new za(3),Xs.gamepadStates[3]=new js,window.addEventListener("gamepadconnected",function(t){za.sendConnectEvent(t.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(t){za.sendDisconnectEvent(t.gamepad.index)}),Xs.ie){Xs.pressedKeys=[];for(var n=0;n<256;){n++;Xs.pressedKeys.push(!1)}for(var r=0;r<256;){r++;Xs.pressedKeys.push(null)}}var s=window.document;if(s.addEventListener("copy",function(t){if(null!=Us.copyListener){var e=Us.copyListener();null!=e&&t.clipboardData.setData("text/plain",e),t.preventDefault()}}),s.addEventListener("cut",function(t){if(null!=Us.cutListener){var e=Us.cutListener();null!=e&&t.clipboardData.setData("text/plain",e),t.preventDefault()}}),s.addEventListener("paste",function(t){if(null!=Us.pasteListener){var e=t.clipboardData.getData("text/plain");Us.pasteListener(e),t.preventDefault()}}),Xs.firefox){var a=Xs.getCanvasElement();a.addEventListener("keydown",function(t){if((t.ctrlKey||t.metaKey)&&(67==t.keyCode||88==t.keyCode||86==t.keyCode)){var e=s.createElement("textarea"),i=function(t){s.body.removeChild(e),a.focus()};67==t.keyCode?e.oncopy=i:88==t.keyCode?e.oncut=i:86==t.keyCode&&(e.onpaste=i),s.body.appendChild(e),e.select()}})}ks.init(),Ps.init(),Xs.loadFinished(t,e)},Xs.getMouse=function(t){return 0!=t?null:Xs.mouse},Xs.getKeyboard=function(t){return 0!=t?null:Xs.keyboard},Xs.checkGamepad=function(t){for(var e=0,i=t.axes.length;e<i;){var n=e++;if(null!=t.axes[n]){var r=t.axes[n];n%2==1&&(r=-r),Xs.gamepadStates[t.index].axes[n]!=r&&(Xs.gamepadStates[t.index].axes[n]=r,Xs.gamepads[t.index].sendAxisEvent(n,r))}}for(var s=0,a=t.buttons.length;s<a;){var o=s++;null!=t.buttons[o]&&Xs.gamepadStates[t.index].buttons[o]!=t.buttons[o].value&&(Xs.gamepadStates[t.index].buttons[o]=t.buttons[o].value,Xs.gamepads[t.index].sendButtonEvent(o,t.buttons[o].value))}t.axes.length<=4&&7<t.buttons.length&&(Xs.gamepadStates[t.index].axes[4]=t.buttons[6].value,Xs.gamepads[t.index].sendAxisEvent(4,t.buttons[6].value),Xs.gamepadStates[t.index].axes[5]=t.buttons[7].value,Xs.gamepads[t.index].sendAxisEvent(5,t.buttons[7].value))},Xs.getCanvasElement=function(){return null!=Xs.khanvas?Xs.khanvas:window.document.getElementById(Cs.canvas_id)},Xs.loadFinished=function(t,e){var l=Xs.getCanvasElement(),i=!(l.style.cursor="default");try{Xs.gl=l.getContext("webgl2",{alpha:!1,antialias:1<Xs.options.framebuffer.samplesPerPixel,stencil:!0}),Xs.gl.pixelStorei(37441,1),Xs.halfFloat={HALF_FLOAT_OES:5131},Xs.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},Xs.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},Xs.elementIndexUint=!0,Xs.gl.getExtension("EXT_color_buffer_float"),Xs.gl.getExtension("OES_texture_float_linear"),Xs.gl.getExtension("OES_texture_half_float_linear"),Xs.anisotropicFilter=Xs.gl.getExtension("EXT_texture_filter_anisotropic"),null==Xs.anisotropicFilter&&(Xs.anisotropicFilter=Xs.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),i=!0,Xs.gl2=!0,Ds.init()}catch(t){t instanceof us&&t.val;Jn.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"kha/SystemImpl.hx",lineNumber:354,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!Xs.gl2)try{Xs.gl=l.getContext("experimental-webgl",{alpha:!1,antialias:1<Xs.options.framebuffer.samplesPerPixel,stencil:!0}),Xs.gl.pixelStorei(37441,1),Xs.gl.getExtension("OES_texture_float"),Xs.gl.getExtension("OES_texture_float_linear"),Xs.halfFloat=Xs.gl.getExtension("OES_texture_half_float"),Xs.gl.getExtension("OES_texture_half_float_linear"),Xs.depthTexture=Xs.gl.getExtension("WEBGL_depth_texture"),Xs.gl.getExtension("EXT_shader_texture_lod"),Xs.gl.getExtension("OES_standard_derivatives"),Xs.anisotropicFilter=Xs.gl.getExtension("EXT_texture_filter_anisotropic"),null==Xs.anisotropicFilter&&(Xs.anisotropicFilter=Xs.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),Xs.drawBuffers=Xs.gl.getExtension("WEBGL_draw_buffers"),Xs.elementIndexUint=Xs.gl.getExtension("OES_element_index_uint"),i=!0,Ds.init()}catch(t){t instanceof us&&t.val;Jn.trace("Could not initialize WebGL, falling back to <canvas>.",{fileName:"kha/SystemImpl.hx",lineNumber:376,className:"kha.SystemImpl",methodName:"loadFinished"})}if(Xs.setCanvas(l),Xs.window=new Ks(t,e,l),i){var n=new lo;Xs.frame=new Os(0,null,null,n),Xs.frame.init(new aa(Xs.frame),new ho(Xs.frame),n)}else{io.Kravur=As,As=io;var r=new eo(l.getContext("2d"));Xs.frame=new Os(0,null,r,null),Xs.frame.init(new aa(Xs.frame),r,null)}!Xs.mobile&&Js._init()?(Xs._hasWebAudio=!0,$s._init()):Xs.mobile?(Xs._hasWebAudio=!1,no._init(),$s=no):(Xs._hasWebAudio=!1,$s=to),_o.instance=new co,Ps.start();var s=window,h=s.requestAnimationFrame;null==h&&(h=s.mozRequestAnimationFrame),null==h&&(h=s.webkitRequestAnimationFrame),null==h&&(h=s.msRequestAnimationFrame);var u=null;u=function(t){var e=window;null==h?e.setTimeout(u,16.666666666666668):h(u);var i=Xs.getGamepads();if(null!=i)for(var n=0,r=i.length;n<r;){var s=i[n++];null!=s&&Xs.checkGamepad(s)}if(Ps.executeFrame(),ko(l,l.getContext)){var a=l.clientWidth,o=l.clientHeight;l.width==a&&l.height==o||(l.width=a,l.height=o),Us.render([Xs.frame]),null!=Xs.gl&&(Xs.gl.clearColor(1,1,1,1),Xs.gl.colorMask(!1,!1,!1,!0),Xs.gl.clear(16384),Xs.gl.colorMask(!0,!0,!0,!0))}},null==h?s.setTimeout(u,16.666666666666668):h(u),l.focus(),l.oncontextmenu=function(t){t.stopPropagation(),t.preventDefault()},l.onmousedown=Xs.mouseDown,l.onmousemove=Xs.mouseMove,null!=Xs.keyboard&&(l.onkeydown=Xs.keyDown,l.onkeyup=Xs.keyUp,l.onkeypress=Xs.keyPress),l.onblur=Xs.onBlur,l.onfocus=Xs.onFocus,l.onmousewheel=l.onwheel=Xs.mouseWheel,l.onmouseleave=Xs.mouseLeave,l.addEventListener("wheel mousewheel",Xs.mouseWheel,!1),l.addEventListener("touchstart",Xs.touchDown,!1),l.addEventListener("touchend",Xs.touchUp,!1),l.addEventListener("touchmove",Xs.touchMove,!1),l.addEventListener("touchcancel",Xs.touchCancel,!1),window.addEventListener("unload",function(){Us.shutdown()})},Xs.lockMouse=function(){ko(S=Xs.khanvas,S.requestPointerLock)?Xs.khanvas.requestPointerLock():Xs.khanvas.mozRequestPointerLock?Xs.khanvas.mozRequestPointerLock():Xs.khanvas.webkitRequestPointerLock&&Xs.khanvas.webkitRequestPointerLock()},Xs.unlockMouse=function(){document.exitPointerLock?document.exitPointerLock():document.mozExitPointerLock?document.mozExitPointerLock():document.webkitExitPointerLock&&document.webkitExitPointerLock()},Xs.canLockMouse=function(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},Xs.setMouseXY=function(t){var e=Xs.khanvas.getBoundingClientRect(),i=Xs.khanvas.clientLeft,n=Xs.khanvas.clientTop;Xs.mouseX=pt.int((t.clientX-e.left-i)*Xs.khanvas.width/(e.width-2*i)),Xs.mouseY=pt.int((t.clientY-e.top-n)*Xs.khanvas.height/(e.height-2*n))},Xs.unlockiOSSound=function(){if(Xs.ios&&!Xs.iosSoundEnabled){var t=no._context.createBuffer(1,1,22050),e=no._context.createBufferSource();e.buffer=t,e.connect(no._context.destination),e.start(),e.stop(),Xs.iosSoundEnabled=!0}},Xs.unlockSound=function(){if(!Xs.soundEnabled){var t=Js._context;null==t&&(t=$s._context),null!=t&&t.resume().then(function(t){Xs.soundEnabled=!0}).catch(function(t){Jn.trace(t,{fileName:"kha/SystemImpl.hx",lineNumber:615,className:"kha.SystemImpl",methodName:"unlockSound"})})}Xs.unlockiOSSound()},Xs.mouseLeave=function(){Xs.mouse.sendLeaveEvent(0)},Xs.mouseWheel=function(t){return Xs.insideInputEvent=!0,t.preventDefault(),0==t.deltaMode?t.deltaY<0?Xs.mouse.sendWheelEvent(0,-1):0<t.deltaY&&Xs.mouse.sendWheelEvent(0,1):1==t.deltaMode&&(Xs.minimumScroll=pt.int(Math.min(Xs.minimumScroll,Math.abs(t.deltaY))),Xs.mouse.sendWheelEvent(0,pt.int(t.deltaY/Xs.minimumScroll))),Xs.insideInputEvent=!1},Xs.mouseDown=function(t){Xs.insideInputEvent=!0,Xs.unlockSound(),Xs.setMouseXY(t),1==t.which?(t.ctrlKey?(Xs.leftMouseCtrlDown=!0,Xs.mouse.sendDownEvent(0,1,Xs.mouseX,Xs.mouseY)):(Xs.leftMouseCtrlDown=!1,Xs.mouse.sendDownEvent(0,0,Xs.mouseX,Xs.mouseY)),null!=Xs.khanvas.setCapture?Xs.khanvas.setCapture():Xs.khanvas.ownerDocument.addEventListener("mousemove",Xs.documentMouseMove,!0),Xs.khanvas.ownerDocument.addEventListener("mouseup",Xs.mouseLeftUp)):2==t.which?(Xs.mouse.sendDownEvent(0,2,Xs.mouseX,Xs.mouseY),Xs.khanvas.ownerDocument.addEventListener("mouseup",Xs.mouseMiddleUp)):3==t.which&&(Xs.mouse.sendDownEvent(0,1,Xs.mouseX,Xs.mouseY),Xs.khanvas.ownerDocument.addEventListener("mouseup",Xs.mouseRightUp)),Xs.insideInputEvent=!1},Xs.mouseLeftUp=function(t){Xs.unlockSound(),1==t.which&&(Xs.insideInputEvent=!0,Xs.khanvas.ownerDocument.removeEventListener("mouseup",Xs.mouseLeftUp),null!=Xs.khanvas.releaseCapture?Xs.khanvas.ownerDocument.releaseCapture():Xs.khanvas.ownerDocument.removeEventListener("mousemove",Xs.documentMouseMove,!0),Xs.leftMouseCtrlDown?Xs.mouse.sendUpEvent(0,1,Xs.mouseX,Xs.mouseY):Xs.mouse.sendUpEvent(0,0,Xs.mouseX,Xs.mouseY),Xs.leftMouseCtrlDown=!1,Xs.insideInputEvent=!1)},Xs.mouseMiddleUp=function(t){Xs.unlockSound(),2==t.which&&(Xs.insideInputEvent=!0,Xs.khanvas.ownerDocument.removeEventListener("mouseup",Xs.mouseMiddleUp),Xs.mouse.sendUpEvent(0,2,Xs.mouseX,Xs.mouseY),Xs.insideInputEvent=!1)},Xs.mouseRightUp=function(t){Xs.unlockSound(),3==t.which&&(Xs.insideInputEvent=!0,Xs.khanvas.ownerDocument.removeEventListener("mouseup",Xs.mouseRightUp),Xs.mouse.sendUpEvent(0,1,Xs.mouseX,Xs.mouseY),Xs.insideInputEvent=!1)},Xs.documentMouseMove=function(t){t.stopPropagation(),Xs.mouseMove(t)},Xs.mouseMove=function(t){Xs.insideInputEvent=!0;var e=Xs.mouseX,i=Xs.mouseY;Xs.setMouseXY(t);var n=t.movementX,r=t.movementY;null==t.movementX&&(n=null!=t.mozMovementX?t.mozMovementX:null!=t.webkitMovementX?t.webkitMovementX:Xs.mouseX-e,r=null!=t.mozMovementY?t.mozMovementY:null!=t.webkitMovementY?t.webkitMovementY:Xs.mouseY-i),Xs.firefox&&(n=pt.int(n*window.devicePixelRatio),r=pt.int(r*window.devicePixelRatio)),Xs.mouse.sendMoveEvent(0,Xs.mouseX,Xs.mouseY,n,r),Xs.insideInputEvent=!1},Xs.setTouchXY=function(t){var e=Xs.khanvas.getBoundingClientRect(),i=Xs.khanvas.clientLeft,n=Xs.khanvas.clientTop;Xs.touchX=pt.int((t.clientX-e.left-i)*Xs.khanvas.width/(e.width-2*i)),Xs.touchY=pt.int((t.clientY-e.top-n)*Xs.khanvas.height/(e.height-2*n))},Xs.touchDown=function(t){Xs.insideInputEvent=!0,Xs.unlockSound(),t.stopPropagation(),t.preventDefault();for(var e=0,i=t.changedTouches;e<i.length;){var n=i[e];++e;var r=n.identifier;Xs.ios&&(-1==(r=Xs.iosTouchs.indexOf(-1))&&(r=Xs.iosTouchs.length),Xs.iosTouchs[r]=n.identifier),Xs.setTouchXY(n),Xs.mouse.sendDownEvent(0,0,Xs.touchX,Xs.touchY),Xs.surface.sendTouchStartEvent(r,Xs.touchX,Xs.touchY)}Xs.insideInputEvent=!1},Xs.touchUp=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();for(var e=0,i=t.changedTouches;e<i.length;){var n=i[e];++e;var r=n.identifier;Xs.ios&&(r=Xs.iosTouchs.indexOf(r),Xs.iosTouchs[r]=-1),Xs.setTouchXY(n),Xs.mouse.sendUpEvent(0,0,Xs.touchX,Xs.touchY),Xs.surface.sendTouchEndEvent(r,Xs.touchX,Xs.touchY)}Xs.insideInputEvent=!1},Xs.touchMove=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();for(var e=0,i=0,n=t.changedTouches;i<n.length;){var r=n[i];if(++i,Xs.setTouchXY(r),0==e){var s=Xs.touchX-Xs.lastFirstTouchX,a=Xs.touchY-Xs.lastFirstTouchY;Xs.lastFirstTouchX=Xs.touchX,Xs.lastFirstTouchY=Xs.touchY,Xs.mouse.sendMoveEvent(0,Xs.touchX,Xs.touchY,s,a)}var o=r.identifier;Xs.ios&&(o=Xs.iosTouchs.indexOf(o)),Xs.surface.sendMoveEvent(o,Xs.touchX,Xs.touchY),++e}Xs.insideInputEvent=!1},Xs.touchCancel=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();for(var e=0,i=t.changedTouches;e<i.length;){var n=i[e];++e;var r=n.identifier;Xs.ios&&(r=Xs.iosTouchs.indexOf(r)),Xs.setTouchXY(n),Xs.mouse.sendUpEvent(0,0,Xs.touchX,Xs.touchY),Xs.surface.sendTouchEndEvent(r,Xs.touchX,Xs.touchY)}Xs.iosTouchs=[],Xs.insideInputEvent=!1},Xs.onBlur=function(){Us.background()},Xs.onFocus=function(){Us.foreground()},Xs.keyDown=function(t){if((t.keyCode<112||123<t.keyCode)&&null!=t.key&&1!=t.key.length&&t.preventDefault(),t.stopPropagation(),Xs.ie){if(Xs.pressedKeys[t.keyCode])return void t.preventDefault();Xs.pressedKeys[t.keyCode]=!0}else if(t.repeat)return void t.preventDefault();Xs.keyboard.sendDownEvent(t.keyCode)},Xs.keyUp=function(t){t.preventDefault(),t.stopPropagation(),Xs.ie&&(Xs.pressedKeys[t.keyCode]=!1),Xs.keyboard.sendUpEvent(t.keyCode)},Xs.keyPress=function(t){if(0!=t.which){t.preventDefault(),t.stopPropagation();var e=t.which;Xs.keyboard.sendPressEvent(String.fromCodePoint(e))}},Xs.getGamepads=function(){return Xs.chrome&&_o.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null},Xs.getPen=function(t){return null};var Ys=function(){};(i["kha.Video"]=Ys).__name__="kha.Video",Ys.__interfaces__=[xs],Ys.prototype={__class__:Ys};var Zs=function(t,e,i,n,r,s){this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=e,this.format=i,this.renderTarget=n,this.samples=s,this.image=null,this.video=null,this.depthStencilFormat=r,Zs.init(),n&&this.createTexture()};(i["kha.WebGLImage"]=Zs).__name__="kha.WebGLImage",Zs.init=function(){null==Zs.context&&(Zs.canvas=window.document.createElement("canvas"),null!=Zs.canvas&&(Zs.context=Zs.canvas.getContext("2d"),Zs.canvas.width=4096,Zs.canvas.height=4096,Zs.context.globalCompositeOperation="copy"))},Zs.formatByteSize=function(t){switch(t){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},Zs.__super__=Ss,Zs.prototype=r(Ss.prototype,{get_g2:function(){return null==this.graphics2&&(this.graphics2=new ho(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new lo(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=Xs.gl){if(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=Xs.gl.createFramebuffer(),Xs.gl.bindFramebuffer(36160,this.frameBuffer),this.format){case 0:Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:Xs.gl.texImage2D(3553,0,Xs.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:Xs.gl.texImage2D(3553,0,Xs.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:Xs.gl.texImage2D(3553,0,Xs.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,Xs.halfFloat.HALF_FLOAT_OES,null);break;case 5:Xs.gl.texImage2D(3553,0,Xs.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,Xs.gl2?6403:6406,5126,null);break;case 6:Xs.gl.texImage2D(3553,0,Xs.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,Xs.gl2?6403:6406,Xs.halfFloat.HALF_FLOAT_OES,null);break;default:Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(3==this.format){if(Xs.gl.texParameteri(3553,10240,9728),Xs.gl.texParameteri(3553,10241,9728),Xs.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!Xs.gl2){var t=Xs.gl.createTexture();Xs.gl.bindTexture(3553,t),Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,3553,t,0),Xs.gl.bindTexture(3553,this.texture)}}else Xs.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=Xs.gl.checkFramebufferStatus(36160)&&Jn.trace("WebGL error: Framebuffer incomplete",{fileName:"kha/WebGLImage.hx",lineNumber:225,className:"kha.WebGLImage",methodName:"createTexture"}),Xs.gl.bindRenderbuffer(36161,null),Xs.gl.bindFramebuffer(36160,null)}else if(null!=this.video)Xs.gl.texImage2D(3553,0,6408,6408,5121,this.video);else switch(this.format){case 0:this.image instanceof Uint8Array?Xs.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):Xs.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 1:Xs.gl.texImage2D(3553,0,6409,this.myWidth,this.myHeight,0,6409,5121,this.image);break;case 2:Xs.gl.texImage2D(3553,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:Xs.gl.texImage2D(3553,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:Xs.gl.texImage2D(3553,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,Xs.gl2?6403:6406,5126,this.image);break;case 6:Xs.gl.texImage2D(3553,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,Xs.gl2?6403:6406,Xs.halfFloat.HALF_FLOAT_OES,this.image);break;default:Xs.gl.texImage2D(3553,0,6408,6408,5121,this.image)}Xs.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:null==Xs.depthTexture?(this.renderBuffer=Xs.gl.createRenderbuffer(),Xs.gl.bindRenderbuffer(36161,this.renderBuffer),Xs.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),Xs.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.depthTexture),1==t?Xs.gl.texImage2D(3553,0,Xs.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):Xs.gl.texImage2D(3553,0,Xs.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),Xs.gl.texParameteri(3553,10240,9728),Xs.gl.texParameteri(3553,10241,9728),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==Xs.depthTexture?(this.renderBuffer=Xs.gl.createRenderbuffer(),Xs.gl.bindRenderbuffer(36161,this.renderBuffer),Xs.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),Xs.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.depthTexture),Xs.gl.texImage2D(3553,0,Xs.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,Xs.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),Xs.gl.texParameteri(3553,10240,9728),Xs.gl.texParameteri(3553,10241,9728),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(3553,this.texture),null!=this.video&&Xs.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(t){this.depthTexture=_s.__cast(t,Zs).depthTexture,Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0)},bytesToArray:function(t){switch(this.format){case 0:case 1:return new Uint8Array(t.getData());case 2:case 4:case 5:case 6:return new Float32Array(t.getData());default:return new Uint8Array(t.getData())}},lock:function(t){return null==t&&(t=0),this.bytes=ir.alloc(Zs.formatByteSize(this.format)*this.get_width()*this.get_height()),this.bytes},unlock:function(){if(null!=Xs.gl){switch(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),this.format){case 0:Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(Xs.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==Xs.gl.getError()){for(var t=ir.alloc(this.get_width()*this.get_height()*4),e=0,i=this.get_height();e<i;)for(var n=e++,r=0,s=this.get_width();r<s;){var a=r++,o=this.bytes.get(n*this.get_width()+a);t.set(n*this.get_width()*4+4*a,o),t.set(n*this.get_width()*4+4*a+1,o),t.set(n*this.get_width()*4+4*a+2,o),t.set(n*this.get_width()*4+4*a+3,255)}Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(t))}break;case 2:Xs.gl.texImage2D(3553,0,Xs.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:Xs.gl.texImage2D(3553,0,Xs.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,Xs.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:Xs.gl.texImage2D(3553,0,Xs.gl2?33326:6406,this.get_width(),this.get_height(),0,Xs.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:Xs.gl.texImage2D(3553,0,Xs.gl2?33325:6406,this.get_width(),this.get_height(),0,Xs.gl2?6403:6406,Xs.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}Xs.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){null!=this.texture&&Xs.gl.deleteTexture(this.texture),null!=this.depthTexture&&Xs.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&Xs.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&Xs.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(t){Xs.gl.bindTexture(3553,this.texture),Xs.gl.generateMipmap(3553)},setMipmaps:function(t){if(Xs.gl.bindTexture(3553,this.texture),2==this.format)for(var e=0,i=t.length;e<i;){var n=e++;Xs.gl.texImage2D(3553,n+1,Xs.gl2?34836:6408,t[n].get_width(),t[n].get_height(),0,6408,5126,_s.__cast(t[n],Zs).image)}else if(4==this.format)for(var r=0,s=t.length;r<s;){var a=r++;Xs.gl.texImage2D(3553,a+1,Xs.gl2?34842:6408,t[a].get_width(),t[a].get_height(),0,6408,Xs.halfFloat.HALF_FLOAT_OES,_s.__cast(t[a],Zs).image)}else for(var o=0,l=t.length;o<l;){var h=o++;Xs.gl.texImage2D(3553,h+1,6408,6408,5121,_s.__cast(t[h],Zs).image)}},__class__:Zs});var Ks=function(t,e,i){this.canvas=i,this.defaultWidth=t,this.defaultHeight=e,Ks.windows.push(this)};(i["kha.Window"]=Ks).__name__="kha.Window",Ks.__properties__={get_all:"get_all"},Ks.get=function(t){return Ks.windows[t]},Ks.get_all=function(){return Ks.windows},Ks.prototype={get_width:function(){return 0==this.canvas.clientWidth?this.defaultWidth:this.canvas.clientWidth},get_height:function(){return 0==this.canvas.clientHeight?this.defaultHeight:this.canvas.clientHeight},get_vSynced:function(){return!0},__class__:Ks,__properties__:{get_vSynced:"get_vSynced",get_height:"get_height",get_width:"get_width"}};var Qs=function(t,e,i,n,r,s,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==r&&(r=600),null==n&&(n=800),null==i&&(i=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=null,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=i,this.width=n,this.height=r,this.display=null==s?Is.get_primary():s,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};(i["kha.WindowOptions"]=Qs).__name__="kha.WindowOptions",Qs.prototype={__class__:Qs};var qs=function(){};(i["kha.audio1.AudioChannel"]=qs).__name__="kha.audio1.AudioChannel",qs.prototype={__class__:qs,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var Js=function(){};(i["kha.audio2.Audio"]=Js).__name__="kha.audio2.Audio",Js.initContext=function(){try{return void(Js._context=new AudioContext)}catch(t){t instanceof us&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof us&&t.val}},Js._init=function(){if(Js.initContext(),null==Js._context)return!1;return Js.buffer=new ea(8192,2,pt.int(Js._context.sampleRate)),Js.processingNode=Js._context.createScriptProcessor(2048,0,2),Js.processingNode.onaudioprocess=function(t){var e=t.outputBuffer.getChannelData(0),i=t.outputBuffer.getChannelData(1);if(null!=Js.audioCallback){Js.audioCallback(2*t.outputBuffer.length,Js.buffer);for(var n=0,r=t.outputBuffer.length;n<r;){var s=n++;e[s]=Js.buffer.data[Js.buffer.readLocation],Js.buffer.readLocation+=1,i[s]=Js.buffer.data[Js.buffer.readLocation],Js.buffer.readLocation+=1,Js.buffer.readLocation>=Js.buffer.size&&(Js.buffer.readLocation=0)}}else for(var a=0,o=t.outputBuffer.length;a<o;){var l=a++;e[l]=0,i[l]=0}},Js.processingNode.connect(Js._context.destination),!0};var $s=function(){};(i["kha.audio2.Audio1"]=$s).__name__="kha.audio2.Audio1",$s._init=function(){var t=new Array(16);$s.soundChannels=t;var e=new Array(16);$s.streamChannels=e;var i=new Array(16);$s.internalSoundChannels=i;var n=new Array(16);$s.internalStreamChannels=n;var r=new Float32Array(512);$s.sampleCache1=r;var s=new Float32Array(512);$s.sampleCache2=s,Js.audioCallback=$s.mix},$s.max=function(t,e){return e<t?t:e},$s.min=function(t,e){return t<e?t:e},$s.mix=function(t,e){if($s.sampleCache1.length<t){var i=new Float32Array(t);$s.sampleCache1=i;var n=new Float32Array(t);$s.sampleCache2=n}for(var r=0,s=t;r<s;){var a=r++;$s.sampleCache2[a]=0}$s.internalSoundChannels[0]=$s.soundChannels[0],$s.internalSoundChannels[1]=$s.soundChannels[1],$s.internalSoundChannels[2]=$s.soundChannels[2],$s.internalSoundChannels[3]=$s.soundChannels[3],$s.internalSoundChannels[4]=$s.soundChannels[4],$s.internalSoundChannels[5]=$s.soundChannels[5],$s.internalSoundChannels[6]=$s.soundChannels[6],$s.internalSoundChannels[7]=$s.soundChannels[7],$s.internalSoundChannels[8]=$s.soundChannels[8],$s.internalSoundChannels[9]=$s.soundChannels[9],$s.internalSoundChannels[10]=$s.soundChannels[10],$s.internalSoundChannels[11]=$s.soundChannels[11],$s.internalSoundChannels[12]=$s.soundChannels[12],$s.internalSoundChannels[13]=$s.soundChannels[13],$s.internalSoundChannels[14]=$s.soundChannels[14],$s.internalSoundChannels[15]=$s.soundChannels[15],$s.internalStreamChannels[0]=$s.streamChannels[0],$s.internalStreamChannels[1]=$s.streamChannels[1],$s.internalStreamChannels[2]=$s.streamChannels[2],$s.internalStreamChannels[3]=$s.streamChannels[3],$s.internalStreamChannels[4]=$s.streamChannels[4],$s.internalStreamChannels[5]=$s.streamChannels[5],$s.internalStreamChannels[6]=$s.streamChannels[6],$s.internalStreamChannels[7]=$s.streamChannels[7],$s.internalStreamChannels[8]=$s.streamChannels[8],$s.internalStreamChannels[9]=$s.streamChannels[9],$s.internalStreamChannels[10]=$s.streamChannels[10],$s.internalStreamChannels[11]=$s.streamChannels[11],$s.internalStreamChannels[12]=$s.streamChannels[12],$s.internalStreamChannels[13]=$s.streamChannels[13],$s.internalStreamChannels[14]=$s.streamChannels[14],$s.internalStreamChannels[15]=$s.streamChannels[15];for(var o=0,l=$s.internalSoundChannels;o<l.length;){var h=l[o];if(++o,null!=h&&!h.get_finished()){h.nextSamples($s.sampleCache1,t,e.samplesPerSecond);for(var u=0,_=t;u<_;){var c=u++;$s.sampleCache2[c]+=$s.sampleCache1[c]*h.get_volume()}}}for(var d=0,p=$s.internalStreamChannels;d<p.length;){var f=p[d];if(++d,null!=f&&!f.get_finished()){f.nextSamples($s.sampleCache1,t,e.samplesPerSecond);for(var g=0,m=t;g<m;){var v=g++;$s.sampleCache2[v]+=$s.sampleCache1[v]*f.get_volume()}}}for(var y=0,w=t;y<w;){var b=y++;e.data[e.writeLocation]=$s.max($s.min($s.sampleCache2[b],1),-1),e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},$s._playAgain=function(t){for(var e=0;e<16;){var i=e++;if(null==$s.soundChannels[i]||$s.soundChannels[i].get_finished()||$s.soundChannels[i]==t){$s.soundChannels[i]=t;break}}};var ta=function(t){this.paused=!1,this.looping=t,this.myVolume=1,this.myPosition=0};(i["kha.audio2.AudioChannel"]=ta).__name__="kha.audio2.AudioChannel",ta.__interfaces__=[qs],ta.prototype={nextSamples:function(t,e,i){if(this.paused)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0,a=0;s<e;){for(var o=this.data.length-this.myPosition,l=o<e-s?o:e-s;a<l;)t[s]=this.data[this.myPosition],++this.myPosition,++a,++s;if(!this.looping)break;a=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;s<e;)t[s]=0,++s}},play:function(){this.paused=!1,this.get_finished()&&(this.myPosition=0,$s._playAgain(this))},pause:function(){this.paused=!0},stop:function(){this.myPosition=this.data.length},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.myPosition>=this.data.length},__class__:ta,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var ea=function(t,e,i){this.size=t;var n=new Float32Array(t);this.data=n,this.channels=e,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(i["kha.audio2.Buffer"]=ea).__name__="kha.audio2.Buffer",ea.prototype={__class__:ea};var ia=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e};(i["kha.audio2.StreamChannel"]=ia).__name__="kha.audio2.StreamChannel",ia.__interfaces__=[qs],ia.prototype={nextSamples:function(t,e,i){if(this.paused)for(var n=0,r=e;n<r;){t[n++]=0}else;},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.atend},__class__:ia,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var na=function(){};(i["kha.audio2.ogg.vorbis.data.Header"]=na).__name__="kha.audio2.ogg.vorbis.data.Header";var ra=function(){};(i["kha.graphics1.Graphics"]=ra).__name__="kha.graphics1.Graphics";var sa=function(){this.transformations=[],this.transformations.push(new Zr(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(i["kha.graphics2.Graphics"]=sa).__name__="kha.graphics2.Graphics",sa.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},drawImage:function(t,e,i){this.drawSubImage(t,e,i,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,i,n,r,s,a){this.drawScaledSubImage(t,n,r,s,a,e,i,s,a)},drawScaledImage:function(t,e,i,n,r){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,i,n,r)},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){},drawRect:function(t,e,i,n,r){null==r&&(r=1)},fillRect:function(t,e,i,n){},drawString:function(t,e,i){},drawLine:function(t,e,i,n,r){null==r&&(r=1)},fillTriangle:function(t,e,i,n,r,s){},set_imageScaleQuality:function(t){return la.High},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},pushTransformation:function(t){var e=new Zr(1,0,0,0,1,0,0,0,1);e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(e),this.transformations.push(e)},popTransformation:function(){var t=this.transformations.pop();return this.setTransformation(this.get_transformation()),t},get_transformation:function(){return this.transformations[this.transformations.length-1]},rotation:function(t,e,i){var n=new Zr(1,0,e,0,1,i,0,0,1),r=new Zr(Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1),s=new Zr(n._00*r._00+n._10*r._01+n._20*r._02,n._00*r._10+n._10*r._11+n._20*r._12,n._00*r._20+n._10*r._21+n._20*r._22,n._01*r._00+n._11*r._01+n._21*r._02,n._01*r._10+n._11*r._11+n._21*r._12,n._01*r._20+n._11*r._21+n._21*r._22,n._02*r._00+n._12*r._01+n._22*r._02,n._02*r._10+n._12*r._11+n._22*r._12,n._02*r._20+n._12*r._21+n._22*r._22),a=new Zr(1,0,-e,0,1,-i,0,0,1),o=new Zr(s._00*a._00+s._10*a._01+s._20*a._02,s._00*a._10+s._10*a._11+s._20*a._12,s._00*a._20+s._10*a._21+s._20*a._22,s._01*a._00+s._11*a._01+s._21*a._02,s._01*a._10+s._11*a._11+s._21*a._12,s._01*a._20+s._11*a._21+s._21*a._22,s._02*a._00+s._12*a._01+s._22*a._02,s._02*a._10+s._12*a._11+s._22*a._12,s._02*a._20+s._12*a._21+s._22*a._22),l=this.get_transformation();return new Zr(o._00*l._00+o._10*l._01+o._20*l._02,o._00*l._10+o._10*l._11+o._20*l._12,o._00*l._20+o._10*l._21+o._20*l._22,o._01*l._00+o._11*l._01+o._21*l._02,o._01*l._10+o._11*l._11+o._21*l._12,o._01*l._20+o._11*l._21+o._21*l._22,o._02*l._00+o._12*l._01+o._22*l._02,o._02*l._10+o._12*l._11+o._22*l._12,o._02*l._20+o._12*l._21+o._22*l._22)},pushRotation:function(t,e,i){this.pushTransformation(this.rotation(t,e,i))},get_opacity:function(){return this.opacities[this.opacities.length-1]},setTransformation:function(t){},__class__:sa,__properties__:{get_opacity:"get_opacity",get_transformation:"get_transformation",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_imageScaleQuality:"set_imageScaleQuality"}};var aa=function(t){this.canvas=t};(i["kha.graphics2.Graphics1"]=aa).__name__="kha.graphics2.Graphics1",aa.__interfaces__=[ra],aa.prototype={__class__:aa};var oa=function(){};(i["kha.graphics2.GraphicsExtension"]=oa).__name__="kha.graphics2.GraphicsExtension",oa.fillCircle=function(t,e,i,n,r){if(null==r&&(r=0),null!=Xs.gl){r<=0&&(r=Math.floor(10*Math.sqrt(n)));for(var s=2*Math.PI/r,a=Math.cos(s),o=Math.sin(s),l=n,h=0,u=0,_=r;u<_;){u++;var c=l+e,d=h+i,p=l;l=a*l-o*h,h=a*h+o*p,t.fillTriangle(c,d,l+e,h+i,e,i)}}else{t.fillCircle(e,i,n)}};var la=w["kha.graphics2.ImageScaleQuality"]={__ename__:"kha.graphics2.ImageScaleQuality",__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:n},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:n}},ha=function(){};(i["kha.graphics2.truetype.VectorOfIntPointer"]=ha).__name__="kha.graphics2.truetype.VectorOfIntPointer",ha.prototype={__class__:ha};var ua=function(){};(i["kha.graphics2.truetype.Stbtt_temp_rect"]=ua).__name__="kha.graphics2.truetype.Stbtt_temp_rect",ua.prototype={__class__:ua};var _a=function(){};(i["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=_a).__name__="kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics",_a.prototype={__class__:_a};var ca=function(){};(i["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=ca).__name__="kha.graphics2.truetype.Stbtt_temp_font_v_metrics",ca.prototype={__class__:ca};var da=function(){};(i["kha.graphics2.truetype.Stbtt_bakedchar"]=da).__name__="kha.graphics2.truetype.Stbtt_bakedchar",da.prototype={__class__:da};var pa=function(){};(i["kha.graphics2.truetype.Stbtt_fontinfo"]=pa).__name__="kha.graphics2.truetype.Stbtt_fontinfo",pa.prototype={__class__:pa};var fa=function(){};(i["kha.graphics2.truetype.Stbtt_vertex"]=fa).__name__="kha.graphics2.truetype.Stbtt_vertex",fa.prototype={__class__:fa};var ga=function(){};(i["kha.graphics2.truetype.Stbtt__bitmap"]=ga).__name__="kha.graphics2.truetype.Stbtt__bitmap",ga.prototype={__class__:ga};var ma=function(){};(i["kha.graphics2.truetype.Stbtt__edge"]=ma).__name__="kha.graphics2.truetype.Stbtt__edge",ma.prototype={__class__:ma};var va=function(){};(i["kha.graphics2.truetype.Stbtt__active_edge"]=va).__name__="kha.graphics2.truetype.Stbtt__active_edge",va.prototype={__class__:va};var ya=function(){};(i["kha.graphics2.truetype.Stbtt__point"]=ya).__name__="kha.graphics2.truetype.Stbtt__point",ya.prototype={__class__:ya};var wa=function(){};(i["kha.graphics2.truetype.StbTruetype"]=wa).__name__="kha.graphics2.truetype.StbTruetype",wa.STBTT_assert=function(t){if(!t)throw new us("Error")},wa.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},wa.ttCHAR=function(t,e){null==e&&(e=0);var i=t.readU8(e);return 128<=i?i-256:i},wa.ttUSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e);return t.readU8(e+1)|i<<8},wa.ttSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1)|i<<8;return 0!=(32768&n)?n-65536:n},wa.ttULONG=function(t,e){return null==e&&(e=0),wa.ttLONG(t,e)},wa.ttLONG=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|n<<16|i<<24},wa.stbtt_tag4=function(t,e,i,n,r,s){return t.readU8(e)==i&&t.readU8(e+1)==n&&t.readU8(e+2)==r&&t.readU8(e+3)==s},wa.stbtt_tag=function(t,e,i){return wa.stbtt_tag4(t,e,ht.cca(i,0),ht.cca(i,1),ht.cca(i,2),ht.cca(i,3))},wa.stbtt__find_table=function(t,e,i){for(var n=e+12,r=0,s=wa.ttUSHORT(t,e+4);r<s;){var a=n+16*r++;if(wa.stbtt_tag(t,a,i))return wa.ttULONG(t,a+8)}return 0},wa.stbtt_InitFont=function(t,e,i){t.data=e,t.fontstart=i;var n=wa.stbtt__find_table(e,i,"cmap");if(t.loca=wa.stbtt__find_table(e,i,"loca"),t.head=wa.stbtt__find_table(e,i,"head"),t.glyf=wa.stbtt__find_table(e,i,"glyf"),t.hhea=wa.stbtt__find_table(e,i,"hhea"),t.hmtx=wa.stbtt__find_table(e,i,"hmtx"),t.kern=wa.stbtt__find_table(e,i,"kern"),0==n||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var r=wa.stbtt__find_table(e,i,"maxp");t.numGlyphs=0!=r?wa.ttUSHORT(e,r+4):65535;for(var s=wa.ttUSHORT(e,n+2),a=t.index_map=0,o=s;a<o;){var l=n+4+8*a++;switch(wa.ttUSHORT(e,l)){case 0:t.index_map=n+wa.ttULONG(e,l+4);break;case 3:switch(wa.ttUSHORT(e,l+2)){case 1:case 10:t.index_map=n+wa.ttULONG(e,l+4)}}}return 0!=t.index_map&&(t.indexToLocFormat=wa.ttUSHORT(e,t.head+50),!0)},wa.stbtt_FindGlyphIndex=function(t,e){var i=t.data,n=t.index_map,r=wa.ttUSHORT(i,n);if(0==r)return e<wa.ttUSHORT(i,n+2)-6?wa.ttBYTE(i,n+6+e):0;if(6==r){var s=wa.ttUSHORT(i,n+6),a=wa.ttUSHORT(i,n+8);return s<=e&&e<s+a?wa.ttUSHORT(i,n+10+2*(e-s)):0}if(2==r)return wa.STBTT_assert(!1),0;if(4==r){var o=wa.ttUSHORT(i,n+6)>>1,l=wa.ttUSHORT(i,n+8)>>1,h=wa.ttUSHORT(i,n+10),u=wa.ttUSHORT(i,n+12)>>1,_=n+14,c=_;if(65535<e)return 0;for(e>=wa.ttUSHORT(i,c+2*u)&&(c+=2*u),c-=2;0!=h;){l>>=1,wa.ttUSHORT(i,c+2*l)<e&&(c+=2*l),--h}var d=(c+=2)-_>>1;wa.STBTT_assert(e<=wa.ttUSHORT(i,_+2*d));var p=wa.ttUSHORT(i,n+14+2*o+2+2*d);if(e<p)return 0;var f=wa.ttUSHORT(i,n+14+6*o+2+2*d);return 0==f?e+wa.ttSHORT(i,n+14+4*o+2+2*d):wa.ttUSHORT(i,f+2*(e-p)+n+14+6*o+2+2*d)}if(12==r||13==r){for(var g=0,m=wa.ttULONG(i,n+12);g<m;){var v=g+(m-g>>1),y=wa.ttULONG(i,n+16+12*v),w=wa.ttULONG(i,n+16+12*v+4);if(e<y)m=v;else{if(!(w<e)){var b=wa.ttULONG(i,n+16+12*v+8);return 12==r?b+e-y:b}g=v+1}}return 0}return wa.STBTT_assert(!1),0},wa.stbtt_setvertex=function(t,e,i,n,r,s){t.type=e,t.x=i,t.y=n,t.cx=r,t.cy=s},wa.stbtt__GetGlyfOffset=function(t,e){var i,n;return e>=t.numGlyphs?-1:2<=t.indexToLocFormat?-1:(0==t.indexToLocFormat?(i=t.glyf+2*wa.ttUSHORT(t.data,t.loca+2*e),n=t.glyf+2*wa.ttUSHORT(t.data,t.loca+2*e+2)):(i=t.glyf+wa.ttULONG(t.data,t.loca+4*e),n=t.glyf+wa.ttULONG(t.data,t.loca+4*e+4)),i==n?-1:i)},wa.stbtt_GetGlyphBox=function(t,e,i){var n=wa.stbtt__GetGlyfOffset(t,e);return!(n<0)&&(i.x0=wa.ttSHORT(t.data,n+2),i.y0=wa.ttSHORT(t.data,n+4),i.x1=wa.ttSHORT(t.data,n+6),i.y1=wa.ttSHORT(t.data,n+8),!0)},wa.stbtt__close_shape=function(t,e,i,n,r,s,a,o,l,h){return n?(i&&wa.stbtt_setvertex(t[e++],3,l+a>>1,h+o>>1,l,h),wa.stbtt_setvertex(t[e++],3,r,s,a,o)):i?wa.stbtt_setvertex(t[e++],3,r,s,l,h):wa.stbtt_setvertex(t[e++],2,r,s,0,0),e},wa.copyVertices=function(t,e,i,n){for(var r=0,s=n;r<s;){var a=r++;e[i+a]=t[a]}},wa.stbtt_GetGlyphShape=function(t,e){var i,n=t.data,r=null,s=0,a=wa.stbtt__GetGlyfOffset(t,e);if(a<0)return null;var o=wa.ttSHORT(n,a);if(0<o){var l,h=0,u=0,_=0,c=!1,d=!1,p=0;i=n.sub(a+10,n.get_length()-(a+10));var f=wa.ttUSHORT(n,a+10+2*o),g=n.sub(a+10+2*o+2+f,n.get_length()-(a+10+2*o+2+f)),m=1+wa.ttUSHORT(i,2*o-2),v=m+2*o;if(null==(r=new Array(v)))return null;for(var y=0,w=r.length;y<w;){r[y++]=new fa}var b=_=0;l=v-m;for(var x=0,S=m;x<S;){var k=x++;0==b?0!=(8&(h=g.readU8(p++)))&&(b=g.readU8(p++)):--b,r[l+k].type=h}for(var T=0,C=0,I=m;C<I;){var N=C++;if(0!=(2&(h=r[l+N].type))){var O=g.readU8(p++);T+=0!=(16&h)?O:-O}else if(0==(16&h)){var E=g.readU8(p),M=g.readU8(p+1)|E<<8;T+=0!=(32768&M)?M-65536:M,p+=2}r[l+N].x=T}for(var L=0,A=0,B=m;A<B;){var R=A++;if(0!=(4&(h=r[l+R].type))){var F=g.readU8(p++);L+=0!=(32&h)?F:-F}else if(0==(32&h)){var P=g.readU8(p),D=g.readU8(p+1)|P<<8;L+=0!=(32768&D)?D-65536:D,p+=2}r[l+R].y=L}for(var W=s=0,V=W,H=V,z=H,G=z,U=G,j=0;j<m;)h=r[l+j].type,T=r[l+j].x,L=r[l+j].y,_==j?(0!=j&&(s=wa.stbtt__close_shape(r,s,c,d,U,G,V,W,z,H)),(d=0==(1&h))?(V=T,W=L,0==(1&r[l+j+1].type)?(U=T+r[l+j+1].x>>1,G=L+r[l+j+1].y>>1):(U=r[l+j+1].x,G=r[l+j+1].y,++j)):(U=T,G=L),wa.stbtt_setvertex(r[s++],1,U,G,0,0),c=!1,_=1+wa.ttUSHORT(i,2*u),++u):0==(1&h)?(c&&wa.stbtt_setvertex(r[s++],3,z+T>>1,H+L>>1,z,H),z=T,H=L,c=!0):(c?wa.stbtt_setvertex(r[s++],3,T,L,z,H):wa.stbtt_setvertex(r[s++],2,T,L,0,0),c=!1),++j;s=wa.stbtt__close_shape(r,s,c,d,U,G,V,W,z,H)}else if(-1==o){var X=1,Y=n.sub(a+10,n.get_length()-(a+10)),Z=0;for(s=0,r=null;0!=X;){var K,Q,q=null,J=1,$=0,tt=0,et=1,it=0,nt=0,rt=wa.ttSHORT(Y,Z);Z+=2;var st=wa.ttSHORT(Y,Z);Z+=2,0!=(2&rt)?0!=(1&rt)?(it=wa.ttSHORT(Y,Z),Z+=2,nt=wa.ttSHORT(Y,Z),Z+=2):(it=wa.ttCHAR(Y,Z),++Z,nt=wa.ttCHAR(Y,Z),++Z):wa.STBTT_assert(!1),0!=(8&rt)?(J=et=wa.ttSHORT(Y,Z)/16384,Z+=2,$=tt=0):0!=(64&rt)?(J=wa.ttSHORT(Y,Z)/16384,Z+=2,$=tt=0,et=wa.ttSHORT(Y,Z)/16384,Z+=2):0!=(128&rt)&&(J=wa.ttSHORT(Y,Z)/16384,Z+=2,$=wa.ttSHORT(Y,Z)/16384,Z+=2,tt=wa.ttSHORT(Y,Z)/16384,Z+=2,et=wa.ttSHORT(Y,Z)/16384,Z+=2);var at=Math.sqrt(J*J+$*$),ot=Math.sqrt(tt*tt+et*et);if(0<(K=null==(Q=wa.stbtt_GetGlyphShape(t,st))?0:Q.length)){for(var lt=0,ht=K;lt<ht;){var ut=Q[lt++],_t=ut.x,ct=ut.y;ut.x=pt.int(at*(J*_t+tt*ct+it)),ut.y=pt.int(ot*($*_t+et*ct+nt)),_t=ut.cx,ct=ut.cy,ut.cx=pt.int(at*(J*_t+tt*ct+it)),ut.cy=pt.int(ot*($*_t+et*ct+nt))}if(null==(q=new Array(s+K)))return null;0<s&&wa.copyVertices(r,q,0,s),wa.copyVertices(Q,q,s,K),r=q,s+=K}X=32&rt}}else o<0&&wa.STBTT_assert(!1);if(null==r)return null;if(wa.STBTT_assert(r.length>=s),s<r.length){var dt=new Array(s);return wa.copyVertices(r,dt,0,s),dt}return r},wa.stbtt_GetGlyphHMetrics=function(t,e){var i=wa.ttUSHORT(t.data,t.hhea+34),n=new _a;return e<i?(n.advanceWidth=wa.ttSHORT(t.data,t.hmtx+4*e),n.leftSideBearing=wa.ttSHORT(t.data,t.hmtx+4*e+2)):(n.advanceWidth=wa.ttSHORT(t.data,t.hmtx+4*(i-1)),n.leftSideBearing=wa.ttSHORT(t.data,t.hmtx+4*i+2*(e-i))),n},wa.stbtt_GetFontVMetrics=function(t){var e=new ca;return e.ascent=wa.ttSHORT(t.data,t.hhea+4),e.descent=wa.ttSHORT(t.data,t.hhea+6),e.lineGap=wa.ttSHORT(t.data,t.hhea+8),e},wa.stbtt_ScaleForPixelHeight=function(t,e){return e/(wa.ttSHORT(t.data,t.hhea+4)-wa.ttSHORT(t.data,t.hhea+6))},wa.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,i,n,r,s){var a=new ua;if(wa.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,h=a.y0,u=a.y1;a.x0=Math.floor(o*i+r),a.y0=Math.floor(-u*n+s),a.x1=Math.ceil(l*i+r),a.y1=Math.ceil(-h*n+s)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},wa.stbtt_GetGlyphBitmapBox=function(t,e,i,n){return wa.stbtt_GetGlyphBitmapBoxSubpixel(t,e,i,n,0,0)},wa.stbtt__new_active=function(t,e,i,n){var r=new va,s=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==r||(r.fdx=s,r.fdy=0!=s?1/s:0,r.fx=t[e].x0+s*(n-t[e].y0),r.fx-=i,r.direction=t[e].invert?1:-1,r.sy=t[e].y0,r.ey=t[e].y1,r.next=null),r},wa.stbtt__handle_clipped_edge=function(t,e,i,n,r,s,a,o){if(s!=o&&(wa.STBTT_assert(s<o),wa.STBTT_assert(n.sy<=n.ey),!(s>n.ey||o<n.sy)))if(s<n.sy&&(r+=(a-r)*(n.sy-s)/(o-s),s=n.sy),o>n.ey&&(a+=(a-r)*(n.ey-o)/(o-s),o=n.ey),r==i?wa.STBTT_assert(a<=i+1):r==i+1?wa.STBTT_assert(i<=a):r<=i?wa.STBTT_assert(a<=i):i+1<=r?wa.STBTT_assert(i+1<=a):wa.STBTT_assert(i<=a&&a<=i+1),r<=i&&a<=i){var l=e+i,h=t;h[l]=h[l]+n.direction*(o-s)}else if(!(i+1<=r&&i+1<=a)){wa.STBTT_assert(i<=r&&r<=i+1&&i<=a&&a<=i+1);var u=e+i,_=t;_[u]=_[u]+n.direction*(o-s)*(1-(r-i+(a-i))/2)}},wa.stbtt__fill_active_edges_new=function(t,e,i,n,r,s){for(var a=s+1;null!=r;){if(wa.STBTT_assert(r.ey>=s),0==r.fdx){var o=r.fx;o<n&&(0<=o?(wa.stbtt__handle_clipped_edge(t,0,pt.int(o),r,o,s,o,a),wa.stbtt__handle_clipped_edge(e,i-1,pt.int(o+1),r,o,s,o,a)):wa.stbtt__handle_clipped_edge(e,i-1,0,r,o,s,o,a))}else{var l,h,u,_,c=r.fx,d=r.fdx,p=c+d,f=r.fdy;if(wa.STBTT_assert(r.sy<=a&&r.ey>=s),r.sy>s?(l=c+d*(r.sy-s),u=r.sy):(l=c,u=s),r.ey<a?(h=c+d*(r.ey-s),_=r.ey):(h=p,_=a),0<=l&&0<=h&&l<n&&h<n)if(pt.int(l)==pt.int(h)){var g=pt.int(l),m=_-u;wa.STBTT_assert(0<=g&&g<n);var v=g,y=t;y[v]=y[v]+r.direction*(1-(l-g+(h-g))/2)*m;var w=i+g,b=e;b[w]=b[w]+r.direction*m}else{if(h<l){var x=u=a-(u-s);u=_=a-(_-s),_=x,x=h,h=l,l=x,d=-d,f=-f,x=c,c=p,p=x}var S=pt.int(l),k=pt.int(h),T=(S+1-c)*f+s,C=r.direction,I=C*(T-u),N=S,O=t;O[N]=O[N]+I*(1-(l-S+(S+1-S))/2);for(var E=C*f,M=S+1,L=k;M<L;){var A=M++,B=t;B[A]=B[A]+(I+E/2),I+=E}T+=f*(k-(S+1)),wa.STBTT_assert(Math.abs(I)<=1.01);var R=k,F=t;F[R]=F[R]+(I+C*(1-(k-k+(h-k))/2)*(_-T));var P=i+k,D=e;D[P]=D[P]+C*(_-u)}else for(var W=0,V=n;W<V;){var H=W++,z=s,G=H,U=H+1,j=p,X=a,Y=(H-c)/d+s,Z=(H+1-c)/d+s;c<G&&U<j?(wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,G,Y),wa.stbtt__handle_clipped_edge(t,0,H,r,G,Y,U,Z),wa.stbtt__handle_clipped_edge(t,0,H,r,U,Z,j,X)):j<G&&U<c?(wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,U,Z),wa.stbtt__handle_clipped_edge(t,0,H,r,U,Z,G,Y),wa.stbtt__handle_clipped_edge(t,0,H,r,G,Y,j,X)):c<G&&G<j?(wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,G,Y),wa.stbtt__handle_clipped_edge(t,0,H,r,G,Y,j,X)):j<G&&G<c?(wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,G,Y),wa.stbtt__handle_clipped_edge(t,0,H,r,G,Y,j,X)):c<U&&U<j?(wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,U,Z),wa.stbtt__handle_clipped_edge(t,0,H,r,U,Z,j,X)):j<U&&U<c?(wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,U,Z),wa.stbtt__handle_clipped_edge(t,0,H,r,U,Z,j,X)):wa.stbtt__handle_clipped_edge(t,0,H,r,c,z,j,X)}}r=r.next}},wa.stbtt__rasterize_sorted_edges=function(t,e,i,n,r,s){var a,o,l=null,h=0,u=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var _=a;o=t.w;var c=s;for(e[u+i].y0=s+t.h+1;h<t.h;){for(var d=c+0,p=c+1,f=l,g=null,m=0,v=t.w;m<v;){a[m++]=0}for(var y=0,w=t.w+1;y<w;){_[o+y++]=0}for(;null!=f;){var b=f;b.ey<=d?(null==g?l=b.next:g.next=b.next,f=b.next,wa.STBTT_assert(0!=b.direction),b.direction=0):f=(g=f).next}for(;e[u].y0<=p;){if(e[u].y0!=e[u].y1){var x=wa.stbtt__new_active(e,u,r,d);wa.STBTT_assert(x.ey>=d),x.next=l,l=x}++u}null!=l&&wa.stbtt__fill_active_edges_new(a,_,o+1,t.w,l,d);for(var S=0,k=0,T=t.w;k<T;){var C=k++;S+=_[o+C];var I=a[C]+S;I=255*Math.abs(I)+.5;var N=pt.int(I);255<N&&(N=255),t.pixels.writeU8(t.pixels_offset+h*t.stride+C,N)}for(g=null,f=l;null!=f;){var O=f;O.fx+=O.fdx,f=(g=f).next}++c,++h}},wa.STBTT__COMPARE=function(t,e){return t.y0<e.y0},wa.stbtt__sort_edges_ins_sort=function(t,e){for(var i,n=1,r=e;n<r;){var s=n++,a=t[s],o=a;for(i=s;0<i;){var l=t[i-1];if(!wa.STBTT__COMPARE(o,l))break;t[i]=t[i-1],--i}s!=i&&(t[i]=a)}},wa.stbtt__sort_edges_quicksort=function(t,e,i){for(;12<i;){var n,r=i>>1,s=wa.STBTT__COMPARE(t[e],t[e+r]),a=wa.STBTT__COMPARE(t[e+r],t[e+i-1]);if(s!=a){var o=wa.STBTT__COMPARE(t[e],t[e+i-1])==a?0:i-1;n=t[e+o],t[e+o]=t[e+r],t[e+r]=n}n=t[e],t[e]=t[e+r],t[e+r]=n;for(var l=1,h=i-1;;){for(;wa.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;wa.STBTT__COMPARE(t[e],t[e+h]);)--h;if(h<=l)break;n=t[e+l],t[e+l]=t[e+h],t[e+h]=n,++l,--h}h<i-l?(wa.stbtt__sort_edges_quicksort(t,e,h),e+=l,i-=l):(wa.stbtt__sort_edges_quicksort(t,e+l,i-l),i=h)}},wa.stbtt__sort_edges=function(t,e){wa.stbtt__sort_edges_quicksort(t,0,e),wa.stbtt__sort_edges_ins_sort(t,e)},wa.stbtt__rasterize=function(t,e,i,n,r,s,a,o,l,h,u){for(var _,c=u?-s:s,d=0,p=0,f=n;p<f;){d+=i[p++]}var g=new Array(d+1);if(null!=g){for(var m=0,v=g.length;m<v;){g[m++]=new ma}for(var y=d=0,w=0,b=n;w<b;){var x=w++,S=e,k=0+y;y+=i[x],_=i[x]-1;for(var T=0,C=i[x];T<C;){var I=T++,N=I,O=_;S[k+_].y!=S[k+I].y?(g[d].invert=!1,(u?S[k+_].y>S[k+I].y:S[k+_].y<S[k+I].y)&&(g[d].invert=!0,N=_,O=I),g[d].x0=S[k+N].x*r+a,g[d].y0=1*(S[k+N].y*c+o),g[d].x1=S[k+O].x*r+a,g[d].y1=1*(S[k+O].y*c+o),++d,_=I):_=I}}wa.stbtt__sort_edges(g,d),wa.stbtt__rasterize_sorted_edges(t,g,d,1,l,h)}},wa.stbtt__add_point=function(t,e,i,n){null!=t&&(t[e].x=i,t[e].y=n)},wa.stbtt__tesselate_curve=function(t,e,i,n,r,s,a,o,l,h){var u=(i+2*r+a)/4,_=(n+2*s+o)/4,c=(i+a)/2-u,d=(n+o)/2-_;return 16<h||(l<c*c+d*d?(wa.stbtt__tesselate_curve(t,e,i,n,(i+r)/2,(n+s)/2,u,_,l,h+1),wa.stbtt__tesselate_curve(t,e,u,_,(r+a)/2,(s+o)/2,a,o,l,h+1)):(wa.stbtt__add_point(t,e.value,a,o),e.value+=1)),1},wa.stbtt_FlattenCurves=function(t,e,i,n,r){for(var s=null,a=0,o=i*i,l=0,h=0,u=0,_=e;u<_;){1==t[u++].type&&++l}if(0==(r.value=l))return null;var c=new Array(l);if(n.value=c,null==n.value)return r.value=0,null;for(var d=0;d<2;){var p=0,f=0;if(1==d++){if(null==(s=new Array(a)))return n.value=null,r.value=0,null;for(var g=0,m=s.length;g<m;){s[g++]=new ya}}l=-1;for(var v=a=0,y=e;v<y;){var w=v++;switch(t[w].type){case 1:0<=l&&(n.value[l]=a-h),++l,h=a,p=t[w].x,f=t[w].y,wa.stbtt__add_point(s,a++,p,f);break;case 2:p=t[w].x,f=t[w].y,wa.stbtt__add_point(s,a++,p,f);break;case 3:var b={value:a};wa.stbtt__tesselate_curve(s,b,p,f,t[w].cx,t[w].cy,t[w].x,t[w].y,o,0),a=b.value,p=t[w].x,f=t[w].y}}n.value[l]=a-h}return s},wa.stbtt_Rasterize=function(t,e,i,n,r,s,a,o,l,h,u){var _,c=s<r?s:r,d=0,p={value:d},f=new ha,g=wa.stbtt_FlattenCurves(i,n,e/c,f,p);d=p.value,_=f.value,null!=g&&wa.stbtt__rasterize(t,g,_,d,r,s,a,o,l,h,u)},wa.stbtt_MakeGlyphBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,h,u){var _,c,d=wa.stbtt_GetGlyphShape(t,u),p=null==d?0:d.length,f=new ga,g=wa.stbtt_GetGlyphBitmapBoxSubpixel(t,u,a,o,l,h);_=g.x0,c=g.y0,f.pixels=e,f.pixels_offset=i,f.w=n,f.h=r,f.stride=s,0!=f.w&&0!=f.h&&wa.stbtt_Rasterize(f,.35,d,p,a,o,l,h,_,c,!0)},wa.stbtt_MakeGlyphBitmap=function(t,e,i,n,r,s,a,o,l){wa.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},wa.stbtt_BakeFontBitmap=function(t,e,i,n,r,s,a,o){var l=new pa;if(!wa.stbtt_InitFont(l,t,e))return-1;for(var h=0,u=r*s;h<u;){var _=h++;n.writeU8(_,0)}for(var c=1,d=c,p=1,f=wa.stbtt_ScaleForPixelHeight(l,i),g=0,m=0;m<a.length;){var v=a[m];++m;var y=wa.stbtt_FindGlyphIndex(l,v),w=wa.stbtt_GetGlyphHMetrics(l,y),b=w.advanceWidth,x=(w.leftSideBearing,wa.stbtt_GetGlyphBitmapBox(l,y,f,f)),S=x.x0,k=x.y0,T=x.x1-S,C=x.y1-k;if(r<=d+T+1&&(c=p,d=1),s<=c+C+1)return-g;wa.STBTT_assert(d+T<r),wa.STBTT_assert(c+C<s),wa.stbtt_MakeGlyphBitmap(l,n,d+c*r,T,C,r,f,f,y),o[g].x0=d,o[g].y0=c,o[g].x1=d+T,o[g].y1=c+C,o[g].xadvance=f*b,o[g].xoff=S,o[g].yoff=k,d=d+T+1,p<c+C+1&&(p=c+C+1),++g}return p};var ba=function(){};(i["kha.graphics4.ConstantLocation"]=ba).__name__="kha.graphics4.ConstantLocation";var xa=function(t,e,i,n){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=t,this.format=e,this.renderTarget=i,this.depthStencilFormat=n,i&&this.createTexture()};(i["kha.graphics4.CubeMap"]=xa).__name__="kha.graphics4.CubeMap",xa.__interfaces__=[xs,bs],xa.createRenderTarget=function(t,e,i,n){return null==n&&(n=0),null==e&&(e=0),null==i&&(i=0),new xa(t,e,!0,i)},xa.prototype={createTexture:function(){if(null!=Xs.gl){if(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(34067,this.texture),Xs.gl.texParameteri(34067,10240,9729),Xs.gl.texParameteri(34067,10241,9729),Xs.gl.texParameteri(34067,10242,33071),Xs.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=Xs.gl.createFramebuffer(),Xs.gl.bindFramebuffer(36160,this.frameBuffer),this.format){case 0:Xs.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null);break;case 2:Xs.gl.texImage2D(34069,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34070,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34071,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34072,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34073,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34074,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null);break;case 3:Xs.gl.texImage2D(34069,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34070,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34071,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34072,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34073,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34074,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);break;case 4:Xs.gl.texImage2D(34069,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34070,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34071,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34072,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34073,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34074,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null);break;case 5:Xs.gl.texImage2D(34069,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34070,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34071,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34072,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34073,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34074,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null);break;case 6:Xs.gl.texImage2D(34069,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34070,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34071,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34072,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34073,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34074,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null);break;default:Xs.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}if(3==this.format&&(Xs.gl.texParameteri(34067,10240,9728),Xs.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!Xs.gl2)){var t=Xs.gl.createTexture();Xs.gl.bindTexture(34067,t),Xs.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34069,t,0),Xs.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34070,t,0),Xs.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34071,t,0),Xs.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34072,t,0),Xs.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34073,t,0),Xs.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34074,t,0),Xs.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),Xs.gl.bindFramebuffer(36160,null)}Xs.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(34067,this.depthTexture),1==t?Xs.gl.texImage2D(34067,0,Xs.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):Xs.gl.texImage2D(34067,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texParameteri(34067,10240,9728),Xs.gl.texParameteri(34067,10241,9728),Xs.gl.texParameteri(34067,10242,33071),Xs.gl.texParameteri(34067,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(34067,this.depthTexture),Xs.gl.texImage2D(34067,0,Xs.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,Xs.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),Xs.gl.texParameteri(34067,10240,9728),Xs.gl.texParameteri(34067,10241,9728),Xs.gl.texParameteri(34067,10242,33071),Xs.gl.texParameteri(34067,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(34067,this.texture)},setDepth:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(34067,this.depthTexture)},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){return null==this.graphics4&&(this.graphics4=new lo(this)),this.graphics4},__class__:xa,__properties__:{get_g4:"get_g4",get_height:"get_height",get_width:"get_width"}};var Sa=function(t,e){this.sources=[];for(var i=0;i<t.length;){var n=t[i];++i,this.sources.push(n.toString())}this.type=35632,this.shader=null,this.files=e};(i["kha.graphics4.FragmentShader"]=Sa).__name__="kha.graphics4.FragmentShader",Sa.fromSource=function(t){var e=new Sa([],["runtime-string"]);return e.sources.push(t),e},Sa.prototype={__class__:Sa};var ka=function(){};(i["kha.graphics4.GeometryShader"]=ka).__name__="kha.graphics4.GeometryShader";var Ta=function(){};(i["kha.graphics4.Graphics"]=Ta).__name__="kha.graphics4.Graphics",Ta.prototype={__class__:Ta};var Ca=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,Ca.bufferIndex=0,Ca.initShaders(),this.initBuffers(),this.projectionLocation=Ca.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ca.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.ImageShaderPainter"]=Ca).__name__="kha.graphics4.ImageShaderPainter",Ca.initShaders=function(){null==Ca.structure&&(Ca.structure=Oa.createImageVertexStructure()),null==Ca.shaderPipeline&&(Ca.shaderPipeline=Oa.createImagePipeline(Ca.structure),Ca.shaderPipeline.compile())},Ca.prototype={get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ca.rectVertexBuffer){Ca.rectVertexBuffer=new Pa(6e3,Ca.structure,1),Ca.rectVertices=Ca.rectVertexBuffer.lock(),Ca.indexBuffer=new Ea(9e3,0);for(var t=Ca.indexBuffer.lock(),e=0;e<1500;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ca.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Ca.bufferIndex*4;Ca.rectVertices[l]=t,Ca.rectVertices[l+1]=e,Ca.rectVertices[l+2]=-5,Ca.rectVertices[l+9]=i,Ca.rectVertices[l+10]=n,Ca.rectVertices[l+11]=-5,Ca.rectVertices[l+18]=r,Ca.rectVertices[l+19]=s,Ca.rectVertices[l+20]=-5,Ca.rectVertices[l+27]=a,Ca.rectVertices[l+28]=o,Ca.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Ca.bufferIndex*4;Ca.rectVertices[r+3]=t,Ca.rectVertices[r+4]=n,Ca.rectVertices[r+12]=t,Ca.rectVertices[r+13]=e,Ca.rectVertices[r+21]=i,Ca.rectVertices[r+22]=e,Ca.rectVertices[r+30]=i,Ca.rectVertices[r+31]=n},setRectColor:function(t,e,i,n){var r=9*Ca.bufferIndex*4;Ca.rectVertices[r+5]=t,Ca.rectVertices[r+6]=e,Ca.rectVertices[r+7]=i,Ca.rectVertices[r+8]=n,Ca.rectVertices[r+14]=t,Ca.rectVertices[r+15]=e,Ca.rectVertices[r+16]=i,Ca.rectVertices[r+17]=n,Ca.rectVertices[r+23]=t,Ca.rectVertices[r+24]=e,Ca.rectVertices[r+25]=i,Ca.rectVertices[r+26]=n,Ca.rectVertices[r+32]=t,Ca.rectVertices[r+33]=e,Ca.rectVertices[r+34]=i,Ca.rectVertices[r+35]=n},drawBuffer:function(){Ca.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ca.rectVertexBuffer),this.g.setIndexBuffer(Ca.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ca.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Ca.lastTexture),this.g.setTextureParameters(this.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ca.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Ca.bufferIndex=0,Ca.rectVertices=Ca.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},drawImage:function(t,e,i,n,r,s,a,o,l,h,u){var _=t;(1500<=Ca.bufferIndex+1||null!=Ca.lastTexture&&_!=Ca.lastTexture)&&this.drawBuffer(),this.setRectColor(.00392156862745098*((16711680&u)>>>16),.00392156862745098*((65280&u)>>>8),.00392156862745098*(255&u),.00392156862745098*(u>>>24)*h),this.setRectTexCoords(0,0,_.get_width()/_.get_realWidth(),_.get_height()/_.get_realHeight()),this.setRectVertices(e,i,n,r,s,a,o,l),++Ca.bufferIndex,Ca.lastTexture=_},drawImage2:function(t,e,i,n,r,s,a,o,l,h,u,_,c,d,p){var f=t;(1500<=Ca.bufferIndex+1||null!=Ca.lastTexture&&f!=Ca.lastTexture)&&this.drawBuffer(),this.setRectTexCoords(e/f.get_realWidth(),i/f.get_realHeight(),(e+n)/f.get_realWidth(),(i+r)/f.get_realHeight()),this.setRectColor(.00392156862745098*((16711680&p)>>>16),.00392156862745098*((65280&p)>>>8),.00392156862745098*(255&p),.00392156862745098*(p>>>24)*d),this.setRectVertices(s,a,o,l,h,u,_,c),++Ca.bufferIndex,Ca.lastTexture=f},end:function(){0<Ca.bufferIndex&&this.drawBuffer(),Ca.lastTexture=null},__class__:Ca,__properties__:{get_pipeline:"get_pipeline"}};var Ia=function(t){this.myPipeline=null,this.g=t,Ia.bufferIndex=0,Ia.triangleBufferIndex=0,Ia.initShaders(),this.initBuffers(),this.projectionLocation=Ia.shaderPipeline.getConstantLocation("projectionMatrix")};(i["kha.graphics4.ColoredShaderPainter"]=Ia).__name__="kha.graphics4.ColoredShaderPainter",Ia.initShaders=function(){null==Ia.structure&&(Ia.structure=Oa.createColoredVertexStructure()),null==Ia.shaderPipeline&&(Ia.shaderPipeline=Oa.createColoredPipeline(Ia.structure),Ia.shaderPipeline.compile())},Ia.prototype={get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ia.rectVertexBuffer){Ia.rectVertexBuffer=new Pa(400,Ia.structure,1),Ia.rectVertices=Ia.rectVertexBuffer.lock(),Ia.indexBuffer=new Ea(600,0);for(var t=Ia.indexBuffer.lock(),e=0;e<100;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ia.indexBuffer.unlock(),Ia.triangleVertexBuffer=new Pa(300,Ia.structure,1),Ia.triangleVertices=Ia.triangleVertexBuffer.lock(),Ia.triangleIndexBuffer=new Ea(300,0);for(var n=Ia.triangleIndexBuffer.lock(),r=0;r<100;){var s=r++;n[3*s]=3*s,n[3*s+1]=3*s+1,n[3*s+2]=3*s+2}Ia.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=7*Ia.bufferIndex*4;Ia.rectVertices[l]=t,Ia.rectVertices[l+1]=e,Ia.rectVertices[l+2]=-5,Ia.rectVertices[l+7]=i,Ia.rectVertices[l+8]=n,Ia.rectVertices[l+9]=-5,Ia.rectVertices[l+14]=r,Ia.rectVertices[l+15]=s,Ia.rectVertices[l+16]=-5,Ia.rectVertices[l+21]=a,Ia.rectVertices[l+22]=o,Ia.rectVertices[l+23]=-5},setRectColors:function(t,e){var i=7*Ia.bufferIndex*4,n=t*(.00392156862745098*(e>>>24));Ia.rectVertices[i+3]=.00392156862745098*((16711680&e)>>>16),Ia.rectVertices[i+4]=.00392156862745098*((65280&e)>>>8),Ia.rectVertices[i+5]=.00392156862745098*(255&e),Ia.rectVertices[i+6]=n,Ia.rectVertices[i+10]=.00392156862745098*((16711680&e)>>>16),Ia.rectVertices[i+11]=.00392156862745098*((65280&e)>>>8),Ia.rectVertices[i+12]=.00392156862745098*(255&e),Ia.rectVertices[i+13]=n,Ia.rectVertices[i+17]=.00392156862745098*((16711680&e)>>>16),Ia.rectVertices[i+18]=.00392156862745098*((65280&e)>>>8),Ia.rectVertices[i+19]=.00392156862745098*(255&e),Ia.rectVertices[i+20]=n,Ia.rectVertices[i+24]=.00392156862745098*((16711680&e)>>>16),Ia.rectVertices[i+25]=.00392156862745098*((65280&e)>>>8),Ia.rectVertices[i+26]=.00392156862745098*(255&e),Ia.rectVertices[i+27]=n},setTriVertices:function(t,e,i,n,r,s){var a=7*Ia.triangleBufferIndex*3;Ia.triangleVertices[a]=t,Ia.triangleVertices[a+1]=e,Ia.triangleVertices[a+2]=-5,Ia.triangleVertices[a+7]=i,Ia.triangleVertices[a+8]=n,Ia.triangleVertices[a+9]=-5,Ia.triangleVertices[a+14]=r,Ia.triangleVertices[a+15]=s,Ia.triangleVertices[a+16]=-5},setTriColors:function(t,e){var i=7*Ia.triangleBufferIndex*3,n=t*(.00392156862745098*(e>>>24));Ia.triangleVertices[i+3]=.00392156862745098*((16711680&e)>>>16),Ia.triangleVertices[i+4]=.00392156862745098*((65280&e)>>>8),Ia.triangleVertices[i+5]=.00392156862745098*(255&e),Ia.triangleVertices[i+6]=n,Ia.triangleVertices[i+10]=.00392156862745098*((16711680&e)>>>16),Ia.triangleVertices[i+11]=.00392156862745098*((65280&e)>>>8),Ia.triangleVertices[i+12]=.00392156862745098*(255&e),Ia.triangleVertices[i+13]=n,Ia.triangleVertices[i+17]=.00392156862745098*((16711680&e)>>>16),Ia.triangleVertices[i+18]=.00392156862745098*((65280&e)>>>8),Ia.triangleVertices[i+19]=.00392156862745098*(255&e),Ia.triangleVertices[i+20]=n},drawBuffer:function(t){t||this.endTris(!0),Ia.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ia.rectVertexBuffer),this.g.setIndexBuffer(Ia.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ia.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ia.bufferIndex*3),Ia.bufferIndex=0,Ia.rectVertices=Ia.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||this.endRects(!0),Ia.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(Ia.triangleVertexBuffer),this.g.setIndexBuffer(Ia.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ia.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Ia.triangleBufferIndex),Ia.triangleBufferIndex=0,Ia.triangleVertices=Ia.triangleVertexBuffer.lock()},fillRect:function(t,e,i,n,r,s,a,o,l,h){0<Ia.triangleBufferIndex&&this.drawTriBuffer(!0),100<=Ia.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(i,n,r,s,a,o,l,h),++Ia.bufferIndex},fillTriangle:function(t,e,i,n,r,s,a,o){0<Ia.bufferIndex&&this.drawBuffer(!0),100<=Ia.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(i,n,r,s,a,o),++Ia.triangleBufferIndex},endTris:function(t){0<Ia.triangleBufferIndex&&this.drawTriBuffer(t)},endRects:function(t){0<Ia.bufferIndex&&this.drawBuffer(t)},end:function(){this.endTris(!1),this.endRects(!1)},__class__:Ia,__properties__:{get_pipeline:"get_pipeline"}};var Na=function(t){this.bakedQuadCache=new Ms,this.bilinear=!1,this.myPipeline=null,this.g=t,Na.bufferIndex=0,Na.initShaders(),this.initBuffers(),this.projectionLocation=Na.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Na.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.TextShaderPainter"]=Na).__name__="kha.graphics4.TextShaderPainter",Na.initShaders=function(){null==Na.structure&&(Na.structure=Oa.createTextVertexStructure()),null==Na.shaderPipeline&&(Na.shaderPipeline=Oa.createTextPipeline(Na.structure),Na.shaderPipeline.compile())},Na.findIndex=function(t){sa.fontGlyphs;for(var e=Ls.charBlocks,i=0,n=0,r=pt.int(e.length/2);n<r;){var s=n++,a=e[2*s],o=e[2*s+1];if(a<=t&&t<=o)return i+t-a;i+=o-a+1}return 0},Na.prototype={get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Na.rectVertexBuffer){Na.rectVertexBuffer=new Pa(400,Na.structure,1),Na.rectVertices=Na.rectVertexBuffer.lock(),Na.indexBuffer=new Ea(600,0);for(var t=Na.indexBuffer.lock(),e=0;e<100;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Na.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Na.bufferIndex*4;Na.rectVertices[l]=t,Na.rectVertices[l+1]=e,Na.rectVertices[l+2]=-5,Na.rectVertices[l+9]=i,Na.rectVertices[l+10]=n,Na.rectVertices[l+11]=-5,Na.rectVertices[l+18]=r,Na.rectVertices[l+19]=s,Na.rectVertices[l+20]=-5,Na.rectVertices[l+27]=a,Na.rectVertices[l+28]=o,Na.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Na.bufferIndex*4;Na.rectVertices[r+3]=t,Na.rectVertices[r+4]=n,Na.rectVertices[r+12]=t,Na.rectVertices[r+13]=e,Na.rectVertices[r+21]=i,Na.rectVertices[r+22]=e,Na.rectVertices[r+30]=i,Na.rectVertices[r+31]=n},setRectColors:function(t,e){var i=9*Na.bufferIndex*4,n=t*(.00392156862745098*(e>>>24));Na.rectVertices[i+5]=.00392156862745098*((16711680&e)>>>16),Na.rectVertices[i+6]=.00392156862745098*((65280&e)>>>8),Na.rectVertices[i+7]=.00392156862745098*(255&e),Na.rectVertices[i+8]=n,Na.rectVertices[i+14]=.00392156862745098*((16711680&e)>>>16),Na.rectVertices[i+15]=.00392156862745098*((65280&e)>>>8),Na.rectVertices[i+16]=.00392156862745098*(255&e),Na.rectVertices[i+17]=n,Na.rectVertices[i+23]=.00392156862745098*((16711680&e)>>>16),Na.rectVertices[i+24]=.00392156862745098*((65280&e)>>>8),Na.rectVertices[i+25]=.00392156862745098*(255&e),Na.rectVertices[i+26]=n,Na.rectVertices[i+32]=.00392156862745098*((16711680&e)>>>16),Na.rectVertices[i+33]=.00392156862745098*((65280&e)>>>8),Na.rectVertices[i+34]=.00392156862745098*(255&e),Na.rectVertices[i+35]=n},drawBuffer:function(){Na.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Na.rectVertexBuffer),this.g.setIndexBuffer(Na.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Na.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Na.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*Na.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Na.bufferIndex=0,Na.rectVertices=Na.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=_s.__cast(t,As)},startString:function(t){this.text=t},charCodeAt:function(t){return ht.cca(this.text,t)},stringLength:function(){return this.text.length},endString:function(){this.text=null},drawString:function(t,e,i,n,r,s){var a=this.font._get(this.fontSize),o=a.getTexture();null!=Na.lastTexture&&o!=Na.lastTexture&&this.drawBuffer(),Na.lastTexture=o;var l=n,h=r;this.startString(t);for(var u=0,_=this.stringLength();u<_;){var c=u++,d=a.getBakedQuad(this.bakedQuadCache,Na.findIndex(this.charCodeAt(c)),l,h);if(null!=d){100<=Na.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,i),this.setRectTexCoords(d.s0*o.get_width()/o.get_realWidth(),d.t0*o.get_height()/o.get_realHeight(),d.s1*o.get_width()/o.get_realWidth(),d.t1*o.get_height()/o.get_realHeight());var p=new po(d.x0,d.y1),f=s._02*p.x+s._12*p.y+s._22,g=(s._00*p.x+s._10*p.y+s._20)/f,m=(s._01*p.x+s._11*p.y+s._21)/f,v=new po(g,m),y=new po(d.x0,d.y0),w=s._02*y.x+s._12*y.y+s._22,b=(s._00*y.x+s._10*y.y+s._20)/w,x=(s._01*y.x+s._11*y.y+s._21)/w,S=new po(b,x),k=new po(d.x1,d.y0),T=s._02*k.x+s._12*k.y+s._22,C=(s._00*k.x+s._10*k.y+s._20)/T,I=(s._01*k.x+s._11*k.y+s._21)/T,N=new po(C,I),O=new po(d.x1,d.y1),E=s._02*O.x+s._12*O.y+s._22,M=(s._00*O.x+s._10*O.y+s._20)/E,L=(s._01*O.x+s._11*O.y+s._21)/E,A=new po(M,L);this.setRectVertices(v.x,v.y,S.x,S.y,N.x,N.y,A.x,A.y),l+=d.xadvance,++Na.bufferIndex}}this.endString()},end:function(){0<Na.bufferIndex&&this.drawBuffer(),Na.lastTexture=null},__class__:Na,__properties__:{get_pipeline:"get_pipeline"}};var Oa=function(t){this.myImageScaleQuality=la.High,sa.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new Ca(this.g),this.coloredPainter=new Ia(this.g),this.textPainter=new Na(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new wn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==Oa.videoPipeline&&(Oa.videoPipeline=Oa.createImagePipeline(Oa.createImageVertexStructure()),Oa.videoPipeline.fragmentShader=Ds.painter_video_frag,Oa.videoPipeline.vertexShader=Ds.painter_video_vert,Oa.videoPipeline.compile())};(i["kha.graphics4.Graphics2"]=Oa).__name__="kha.graphics4.Graphics2",Oa.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},Oa.createImageVertexStructure=function(){var t=new Va;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Oa.createImagePipeline=function(t){var e=new La;return e.fragmentShader=Ds.painter_image_frag,e.vertexShader=Ds.painter_image_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Oa.createColoredVertexStructure=function(){var t=new Va;return t.add("vertexPosition",2),t.add("vertexColor",3),t},Oa.createColoredPipeline=function(t){var e=new La;return e.fragmentShader=Ds.painter_colored_frag,e.vertexShader=Ds.painter_colored_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},Oa.createTextVertexStructure=function(){var t=new Va;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Oa.createTextPipeline=function(t){var e=new La;return e.fragmentShader=Ds.painter_text_frag,e.vertexShader=Ds.painter_text_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},Oa.__super__=sa,Oa.prototype=r(sa.prototype,{setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof Os){var i=this.projectionMatrix,n=wn.orthogonalProjection(0,t,e,0,.1,1e3);i._00=n._00,i._10=n._10,i._20=n._20,i._30=n._30,i._01=n._01,i._11=n._11,i._21=n._21,i._31=n._31,i._02=n._02,i._12=n._12,i._22=n._22,i._32=n._32,i._03=n._03,i._13=n._13,i._23=n._23,i._33=n._33}else if(Ss.get_nonPow2Supported()||(t=Oa.upperPowerOfTwo(t),e=Oa.upperPowerOfTwo(e)),this.g.renderTargetsInvertedY()){var r=this.projectionMatrix,s=wn.orthogonalProjection(0,t,0,e,.1,1e3);r._00=s._00,r._10=s._10,r._20=s._20,r._30=s._30,r._01=s._01,r._11=s._11,r._21=s._21,r._31=s._31,r._02=s._02,r._12=s._12,r._22=s._22,r._32=s._32,r._03=s._03,r._13=s._13,r._23=s._23,r._33=s._33}else{var a=this.projectionMatrix,o=wn.orthogonalProjection(0,t,e,0,.1,1e3);a._00=o._00,a._10=o._10,a._20=o._20,a._30=o._30,a._01=o._01,a._11=o._11,a._21=o._21,a._31=o._31,a._02=o._02,a._12=o._12,a._22=o._22,a._32=o._32,a._03=o._03,a._13=o._13,a._23=o._23,a._33=o._33}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,i){this.coloredPainter.end(),this.textPainter.end();var n=e+t.get_width(),r=i+t.get_height(),s=this.get_transformation(),a=new po(e,r),o=s._02*a.x+s._12*a.y+s._22,l=(s._00*a.x+s._10*a.y+s._20)/o,h=(s._01*a.x+s._11*a.y+s._21)/o,u=new po(l,h),_=this.get_transformation(),c=new po(e,i),d=_._02*c.x+_._12*c.y+_._22,p=(_._00*c.x+_._10*c.y+_._20)/d,f=(_._01*c.x+_._11*c.y+_._21)/d,g=new po(p,f),m=this.get_transformation(),v=new po(n,i),y=m._02*v.x+m._12*v.y+m._22,w=(m._00*v.x+m._10*v.y+m._20)/y,b=(m._01*v.x+m._11*v.y+m._21)/y,x=new po(w,b),S=this.get_transformation(),k=new po(n,r),T=S._02*k.x+S._12*k.y+S._22,C=(S._00*k.x+S._10*k.y+S._20)/T,I=(S._01*k.x+S._11*k.y+S._21)/T,N=new po(C,I);this.imagePainter.drawImage(t,u.x,u.y,g.x,g.y,x.x,x.y,N.x,N.y,this.get_opacity(),this.get_color())},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){this.coloredPainter.end(),this.textPainter.end();var h=this.get_transformation(),u=new po(s,a+l),_=h._02*u.x+h._12*u.y+h._22,c=(h._00*u.x+h._10*u.y+h._20)/_,d=(h._01*u.x+h._11*u.y+h._21)/_,p=new po(c,d),f=this.get_transformation(),g=new po(s,a),m=f._02*g.x+f._12*g.y+f._22,v=(f._00*g.x+f._10*g.y+f._20)/m,y=(f._01*g.x+f._11*g.y+f._21)/m,w=new po(v,y),b=this.get_transformation(),x=new po(s+o,a),S=b._02*x.x+b._12*x.y+b._22,k=(b._00*x.x+b._10*x.y+b._20)/S,T=(b._01*x.x+b._11*x.y+b._21)/S,C=new po(k,T),I=this.get_transformation(),N=new po(s+o,a+l),O=I._02*N.x+I._12*N.y+I._22,E=(I._00*N.x+I._10*N.y+I._20)/O,M=(I._01*N.x+I._11*N.y+I._21)/O,L=new po(E,M);this.imagePainter.drawImage2(t,e,i,n,r,p.x,p.y,w.x,w.y,C.x,C.y,L.x,L.y,this.get_opacity(),this.get_color())},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=this.get_transformation(),a=new po(t-r/2,e+r/2),o=s._02*a.x+s._12*a.y+s._22,l=(s._00*a.x+s._10*a.y+s._20)/o,h=(s._01*a.x+s._11*a.y+s._21)/o,u=new po(l,h),_=this.get_transformation(),c=new po(t-r/2,e-r/2),d=_._02*c.x+_._12*c.y+_._22,p=(_._00*c.x+_._10*c.y+_._20)/d,f=(_._01*c.x+_._11*c.y+_._21)/d,g=new po(p,f),m=this.get_transformation(),v=new po(t+i+r/2,e-r/2),y=m._02*v.x+m._12*v.y+m._22,w=(m._00*v.x+m._10*v.y+m._20)/y,b=(m._01*v.x+m._11*v.y+m._21)/y,x=new po(w,b),S=this.get_transformation(),k=new po(t+i+r/2,e+r/2),T=S._02*k.x+S._12*k.y+S._22,C=(S._00*k.x+S._10*k.y+S._20)/T,I=(S._01*k.x+S._11*k.y+S._21)/T,N=new po(C,I);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,g.x,g.y,x.x,x.y,N.x,N.y);var O=this.get_transformation(),E=new po(t-r/2,e+n-r/2),M=O._02*E.x+O._12*E.y+O._22,L=(O._00*E.x+O._10*E.y+O._20)/M,A=(O._01*E.x+O._11*E.y+O._21)/M;u=new po(L,A);var B=this.get_transformation(),R=new po(t-r/2,e+r/2),F=B._02*R.x+B._12*R.y+B._22,P=(B._00*R.x+B._10*R.y+B._20)/F,D=(B._01*R.x+B._11*R.y+B._21)/F;g=new po(P,D);var W=this.get_transformation(),V=new po(t+r/2,e+r/2),H=W._02*V.x+W._12*V.y+W._22,z=(W._00*V.x+W._10*V.y+W._20)/H,G=(W._01*V.x+W._11*V.y+W._21)/H;x=new po(z,G);var U=this.get_transformation(),j=new po(t+r/2,e+n-r/2),X=U._02*j.x+U._12*j.y+U._22,Y=(U._00*j.x+U._10*j.y+U._20)/X,Z=(U._01*j.x+U._11*j.y+U._21)/X;N=new po(Y,Z),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,g.x,g.y,x.x,x.y,N.x,N.y);var K=this.get_transformation(),Q=new po(t-r/2,e+n+r/2),q=K._02*Q.x+K._12*Q.y+K._22,J=(K._00*Q.x+K._10*Q.y+K._20)/q,$=(K._01*Q.x+K._11*Q.y+K._21)/q;u=new po(J,$);var tt=this.get_transformation(),et=new po(t-r/2,e+n-r/2),it=tt._02*et.x+tt._12*et.y+tt._22,nt=(tt._00*et.x+tt._10*et.y+tt._20)/it,rt=(tt._01*et.x+tt._11*et.y+tt._21)/it;g=new po(nt,rt);var st=this.get_transformation(),at=new po(t+i+r/2,e+n-r/2),ot=st._02*at.x+st._12*at.y+st._22,lt=(st._00*at.x+st._10*at.y+st._20)/ot,ht=(st._01*at.x+st._11*at.y+st._21)/ot;x=new po(lt,ht);var ut=this.get_transformation(),_t=new po(t+i+r/2,e+n+r/2),ct=ut._02*_t.x+ut._12*_t.y+ut._22,dt=(ut._00*_t.x+ut._10*_t.y+ut._20)/ct,pt=(ut._01*_t.x+ut._11*_t.y+ut._21)/ct;N=new po(dt,pt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,g.x,g.y,x.x,x.y,N.x,N.y);var ft=this.get_transformation(),gt=new po(t+i-r/2,e+n-r/2),mt=ft._02*gt.x+ft._12*gt.y+ft._22,vt=(ft._00*gt.x+ft._10*gt.y+ft._20)/mt,yt=(ft._01*gt.x+ft._11*gt.y+ft._21)/mt;u=new po(vt,yt);var wt=this.get_transformation(),bt=new po(t+i-r/2,e+r/2),xt=wt._02*bt.x+wt._12*bt.y+wt._22,St=(wt._00*bt.x+wt._10*bt.y+wt._20)/xt,kt=(wt._01*bt.x+wt._11*bt.y+wt._21)/xt;g=new po(St,kt);var Tt=this.get_transformation(),Ct=new po(t+i+r/2,e+r/2),It=Tt._02*Ct.x+Tt._12*Ct.y+Tt._22,Nt=(Tt._00*Ct.x+Tt._10*Ct.y+Tt._20)/It,Ot=(Tt._01*Ct.x+Tt._11*Ct.y+Tt._21)/It;x=new po(Nt,Ot);var Et=this.get_transformation(),Mt=new po(t+i+r/2,e+n-r/2),Lt=Et._02*Mt.x+Et._12*Mt.y+Et._22,At=(Et._00*Mt.x+Et._10*Mt.y+Et._20)/Lt,Bt=(Et._01*Mt.x+Et._11*Mt.y+Et._21)/Lt;N=new po(At,Bt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,g.x,g.y,x.x,x.y,N.x,N.y)},fillRect:function(t,e,i,n){this.imagePainter.end(),this.textPainter.end();var r=this.get_transformation(),s=new po(t,e+n),a=r._02*s.x+r._12*s.y+r._22,o=(r._00*s.x+r._10*s.y+r._20)/a,l=(r._01*s.x+r._11*s.y+r._21)/a,h=new po(o,l),u=this.get_transformation(),_=new po(t,e),c=u._02*_.x+u._12*_.y+u._22,d=(u._00*_.x+u._10*_.y+u._20)/c,p=(u._01*_.x+u._11*_.y+u._21)/c,f=new po(d,p),g=this.get_transformation(),m=new po(t+i,e),v=g._02*m.x+g._12*m.y+g._22,y=(g._00*m.x+g._10*m.y+g._20)/v,w=(g._01*m.x+g._11*m.y+g._21)/v,b=new po(y,w),x=this.get_transformation(),S=new po(t+i,e+n),k=x._02*S.x+x._12*S.y+x._22,T=(x._00*S.x+x._10*S.y+x._20)/k,C=(x._01*S.x+x._11*S.y+x._21)/k,I=new po(T,C);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h.x,h.y,f.x,f.y,b.x,b.y,I.x,I.y)},drawString:function(t,e,i){this.imagePainter.end(),this.coloredPainter.end(),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,i,this.get_transformation())},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return sa.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,i,n,r){var s;null==r&&(r=1),this.imagePainter.end(),this.textPainter.end(),(s=n==e?new po(0,-1):new po(1,-(i-t)/(n-e))).set_length(r);var a=new po(t+.5*s.x,e+.5*s.y),o=new po(i+.5*s.x,n+.5*s.y),l=new po(a.x-s.x,a.y-s.y),h=new po(o.x-s.x,o.y-s.y),u=this.get_transformation(),_=u._02*a.x+u._12*a.y+u._22,c=(u._00*a.x+u._10*a.y+u._20)/_,d=(u._01*a.x+u._11*a.y+u._21)/_;a=new po(c,d);var p=this.get_transformation(),f=p._02*o.x+p._12*o.y+p._22,g=(p._00*o.x+p._10*o.y+p._20)/f,m=(p._01*o.x+p._11*o.y+p._21)/f;o=new po(g,m);var v=this.get_transformation(),y=v._02*l.x+v._12*l.y+v._22,w=(v._00*l.x+v._10*l.y+v._20)/y,b=(v._01*l.x+v._11*l.y+v._21)/y;l=new po(w,b);var x=this.get_transformation(),S=x._02*h.x+x._12*h.y+x._22,k=(x._00*h.x+x._10*h.y+x._20)/S,T=(x._01*h.x+x._11*h.y+x._21)/S;h=new po(k,T),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,o.x,o.y,l.x,l.y),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),l.x,l.y,o.x,o.y,h.x,h.y)},fillTriangle:function(t,e,i,n,r,s){this.imagePainter.end(),this.textPainter.end();var a=this.get_transformation(),o=new po(t,e),l=a._02*o.x+a._12*o.y+a._22,h=(a._00*o.x+a._10*o.y+a._20)/l,u=(a._01*o.x+a._11*o.y+a._21)/l,_=new po(h,u),c=this.get_transformation(),d=new po(i,n),p=c._02*d.x+c._12*d.y+c._22,f=(c._00*d.x+c._10*d.y+c._20)/p,g=(c._01*d.x+c._11*d.y+c._21)/p,m=new po(f,g),v=this.get_transformation(),y=new po(r,s),w=v._02*y.x+v._12*y.y+v._22,b=(v._00*y.x+v._10*y.y+v._20)/w,x=(v._01*y.x+v._11*y.y+v._21)/w,S=new po(b,x);this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),_.x,_.y,m.x,m.y,S.x,S.y)},set_imageScaleQuality:function(t){return this.imagePainter.setBilinearFilter(t==la.High),this.textPainter.setBilinearFilter(t==la.High),this.myImageScaleQuality=t},begin:function(t,e){null==t&&(t=!0),this.g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end(),this.coloredPainter.end()},end:function(){this.flush(),this.g.end()},__class__:Oa});var Ea=function(t,e,i){null==i&&(i=!1),this.usage=e,this.mySize=t,this.buffer=Xs.gl.createBuffer();var n=new Uint32Array(t);this._data=n};(i["kha.graphics4.IndexBuffer"]=Ea).__name__="kha.graphics4.IndexBuffer",Ea.prototype={lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t,t+e)},unlock:function(){Xs.gl.bindBuffer(34963,this.buffer);var t=null==Xs.elementIndexUint?new Uint16Array(this._data):this._data;Xs.gl.bufferData(34963,t,1==this.usage?35048:35044)},set:function(){Xs.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:Ea};var Ma=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=Aa.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};(i["kha.graphics4.PipelineStateBase"]=Ma).__name__="kha.graphics4.PipelineStateBase",Ma.prototype={get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},__class__:Ma,__properties__:{set_colorWriteMaskAlpha:"set_colorWriteMaskAlpha",get_colorWriteMaskAlpha:"get_colorWriteMaskAlpha",set_colorWriteMaskBlue:"set_colorWriteMaskBlue",get_colorWriteMaskBlue:"get_colorWriteMaskBlue",set_colorWriteMaskGreen:"set_colorWriteMaskGreen",get_colorWriteMaskGreen:"get_colorWriteMaskGreen",set_colorWriteMaskRed:"set_colorWriteMaskRed",get_colorWriteMaskRed:"get_colorWriteMaskRed"}};var La=function(){this.program=null,Ma.call(this),this.textures=[],this.textureValues=[]};(i["kha.graphics4.PipelineState"]=La).__name__="kha.graphics4.PipelineState",La.__super__=Ma,La.prototype=r(Ma.prototype,{delete:function(){null!=this.program&&Xs.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&Xs.gl.deleteProgram(this.program),this.program=Xs.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),Xs.gl.attachShader(this.program,this.vertexShader.shader),Xs.gl.attachShader(this.program,this.fragmentShader.shader);for(var t=0,e=0,i=this.inputLayout;e<i.length;){var n=i[e];++e;for(var r=0,s=n.elements;r<s.length;){var a=s[r];++r,Xs.gl.bindAttribLocation(this.program,t,a.name),4==a.data?t+=4:++t}}if(Xs.gl.linkProgram(this.program),!Xs.gl.getProgramParameter(this.program,35714))throw new us("Could not link the shader program:\n"+Xs.gl.getProgramInfoLog(this.program))},set:function(){Xs.gl.useProgram(this.program);for(var t=0,e=this.textureValues.length;t<e;){var i=t++;Xs.gl.uniform1i(this.textureValues[i],i)}Xs.gl.colorMask(this.get_colorWriteMaskRed(),this.get_colorWriteMaskGreen(),this.get_colorWriteMaskBlue(),this.get_colorWriteMaskAlpha())},compileShader:function(t){if(null==t.shader){for(var e=Xs.gl.createShader(t.type),i=0!=Xs.gl.getShaderPrecisionFormat(35632,36338).precision,n=t.files,r=0,s=n.length;r<s;){var a=r++;if(Xs.gl2){if(0<=n[a].indexOf("-webgl2")||0<=n[a].indexOf("runtime-string")){Xs.gl.shaderSource(e,t.sources[a]);break}}else{if(!i&&(0<=n[a].indexOf("-relaxed")||0<=n[a].indexOf("runtime-string"))){Xs.gl.shaderSource(e,t.sources[a]);break}if(i&&(n[a].indexOf("-relaxed")<0||0<=n[a].indexOf("runtime-string"))){Xs.gl.shaderSource(e,t.sources[a]);break}}}if(Xs.gl.compileShader(e),!Xs.gl.getShaderParameter(e,35713))throw new us("Could not compile shader:\n"+Xs.gl.getShaderInfoLog(e));t.shader=e}},getConstantLocation:function(t){var e=Xs.gl.getUniformLocation(this.program,t);null==e&&Jn.trace("Warning: Uniform "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:92,className:"kha.graphics4.PipelineState",methodName:"getConstantLocation"});for(var i=5126,n=0,r=Xs.gl.getProgramParameter(this.program,35718);n<r;){var s=n++,a=Xs.gl.getActiveUniform(this.program,s);if(a.name==t||a.name==t+"[0]"){i=a.type;break}}return new oo(e,i)},getTextureUnit:function(t){var e=this.findTexture(t);if(e<0){var i=Xs.gl.getUniformLocation(this.program,t);null==i&&Jn.trace("Warning: Sampler "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:111,className:"kha.graphics4.PipelineState",methodName:"getTextureUnit"}),e=this.textures.length,this.textureValues.push(i),this.textures.push(t)}return new uo(e)},findTexture:function(t){for(var e=0,i=this.textures.length;e<i;){var n=e++;if(this.textures[n]==t)return n}return-1},__class__:La});var Aa=w["kha.graphics4.StencilValue"]={__ename__:"kha.graphics4.StencilValue",__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:n},Static:(S=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:n}},S.__params__=["value"],S)},Ba=function(){};(i["kha.graphics4.TessellationControlShader"]=Ba).__name__="kha.graphics4.TessellationControlShader";var Ra=function(){};(i["kha.graphics4.TessellationEvaluationShader"]=Ra).__name__="kha.graphics4.TessellationEvaluationShader";var Fa=function(){};(i["kha.graphics4.TextureUnit"]=Fa).__name__="kha.graphics4.TextureUnit";var Pa=function(t,e,i,n,r){null==r&&(r=!1),null==n&&(n=0),this.usage=i,this.instanceDataStepRate=n,this.mySize=t;for(var s=this.myStride=0,a=e.elements;s<a.length;){var o=a[s];switch(++s,o.data){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64;break;case 5:this.myStride+=4;break;case 6:this.myStride+=8}}this.buffer=Xs.gl.createBuffer();var l=new Float32Array(pt.int(t*this.myStride/4));this._data=l,this.sizes=[],this.offsets=[],this.types=[],this.sizes[e.elements.length-1]=0,this.offsets[e.elements.length-1]=0;for(var h=this.types[e.elements.length-1]=0,u=0,_=0,c=e.elements;_<c.length;){var d,p,f=c[_];switch(++_,f.data){case 0:d=1,p=5126;break;case 1:d=2,p=5126;break;case 2:d=3,p=5126;break;case 3:d=4,p=5126;break;case 4:d=16,p=5126;break;case 5:d=2,p=5122;break;case 6:d=4,p=5122}switch(this.sizes[u]=d,this.offsets[u]=h,this.types[u]=p,f.data){case 0:h+=4;break;case 1:h+=8;break;case 2:h+=12;break;case 3:h+=16;break;case 4:h+=64;break;case 5:h+=4;break;case 6:h+=8}++u}};(i["kha.graphics4.VertexBuffer"]=Pa).__name__="kha.graphics4.VertexBuffer",Pa.prototype={lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t*this.stride(),(t+e)*this.stride())},lockInt16:function(t,e){return new Int16Array(this.lock(t,e).buffer)},unlock:function(){Xs.gl.bindBuffer(34962,this.buffer),Xs.gl.bufferData(34962,this._data,1==this.usage?35048:35044)},stride:function(){return this.myStride},set:function(t){var e=!!Xs.gl2||Xs.gl.getExtension("ANGLE_instanced_arrays");Xs.gl.bindBuffer(34962,this.buffer);for(var i=0,n=0,r=this.sizes.length;n<r;){var s=n++;if(4<this.sizes[s])for(var a=this.sizes[s],o=0;0<a;)Xs.gl.enableVertexAttribArray(t+i),Xs.gl.vertexAttribPointer(t+i,4,5126,!1,this.myStride,this.offsets[s]+o),e&&(Xs.gl2?Xs.gl.vertexAttribDivisor(t+i,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+i,this.instanceDataStepRate)),a-=4,o+=16,++i;else{var l=5126!=this.types[s];Xs.gl.enableVertexAttribArray(t+i),Xs.gl.vertexAttribPointer(t+i,this.sizes[s],this.types[s],l,this.myStride,this.offsets[s]),e&&(Xs.gl2?Xs.gl.vertexAttribDivisor(t+i,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+i,this.instanceDataStepRate)),++i}}return i},__class__:Pa};var Da=function(t,e){this.name=t,this.data=e};(i["kha.graphics4.VertexElement"]=Da).__name__="kha.graphics4.VertexElement",Da.prototype={__class__:Da};var Wa=function(t,e){this.sources=[];for(var i=0;i<t.length;){var n=t[i];++i,this.sources.push(n.toString())}this.type=35633,this.shader=null,this.files=e};(i["kha.graphics4.VertexShader"]=Wa).__name__="kha.graphics4.VertexShader",Wa.fromSource=function(t){var e=new Wa([],["runtime-string"]);return e.sources.push(t),e},Wa.prototype={__class__:Wa};var Va=function(){this.elements=[],this.instanced=!1};(i["kha.graphics4.VertexStructure"]=Va).__name__="kha.graphics4.VertexStructure",Va.prototype={add:function(t,e){this.elements.push(new Da(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,i=this.elements.length;e<i;){var n=e++;t+=this.dataByteSize(this.elements[n].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64;case 5:return 4;case 6:return 8}},get:function(t){return this.elements[t]},__class__:Va};var Ha=function(){};(i["kha.graphics5.Graphics"]=Ha).__name__="kha.graphics5.Graphics";var za=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],za.instances[t]=this};(i["kha.input.Gamepad"]=za).__name__="kha.input.Gamepad",za.get=function(t){return null==t&&(t=0),t>=za.instances.length?null:za.instances[t]},za.sendConnectEvent=function(t){za.instances[t].connected=!0;for(var e=0,i=za.connectListeners;e<i.length;){var n=i[e];++e,n(t)}},za.sendDisconnectEvent=function(t){za.instances[t].connected=!1;for(var e=0,i=za.disconnectListeners;e<i.length;){var n=i[e];++e,n(t)}},za.prototype={notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},sendAxisEvent:function(t,e){for(var i=0,n=this.axisListeners;i<n.length;){var r=n[i];++i,r(t,e)}},sendButtonEvent:function(t,e){for(var i=0,n=this.buttonListeners;i<n.length;){var r=n[i];++i,r(t,e)}},__class__:za};var Ga=function(){this.__id=fo.nextId++,this._inputBuffer=ir.alloc(1)};(i["kha.netsync.Controller"]=Ga).__name__="kha.netsync.Controller",Ga.prototype={_id:function(){return this.__id},__class__:Ga};var Ua=t.kha.input.Keyboard=function(){Ga.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Ua.instance=this};(i["kha.input.Keyboard"]=Ua).__name__="kha.input.Keyboard",Ua.get=function(t){return null==t&&(t=0),Xs.getKeyboard(t)},Ua.__super__=Ga,Ua.prototype=r(Ga.prototype,{notify:function(t,e,i){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=i&&this.pressListeners.push(i)},show:function(){},hide:function(){},sendDownEvent:function(t){if(null!=go.the()){var e=ir.alloc(5);e.setInt32(0,0),e.set(4,t),go.the().sendControllerUpdate(this._id(),e)}for(var i=0,n=this.downListeners;i<n.length;){var r=n[i];++i,r(t)}},sendUpEvent:function(t){if(null!=go.the()){var e=ir.alloc(5);e.setInt32(0,1),e.set(4,t),go.the().sendControllerUpdate(this._id(),e)}for(var i=0,n=this.upListeners;i<n.length;){var r=n[i];++i,r(t)}},sendPressEvent:function(t){if(null!=go.the()){var e=ir.alloc(5);e.setInt32(0,2),e.set(4,ht.cca(t,0)),go.the().sendControllerUpdate(this._id(),e)}for(var i=0,n=this.pressListeners;i<n.length;){var r=n[i];++i,r(t)}},__class__:Ua});var ja=t.kha.input.Mouse=function(){Ga.call(this),ja.instance=this};(i["kha.input.Mouse"]=ja).__name__="kha.input.Mouse",ja.get=function(t){return null==t&&(t=0),Xs.getMouse(t)},ja.__super__=Ga,ja.prototype=r(Ga.prototype,{notify:function(t,e,i,n,r){this.notifyWindowed(0,t,e,i,n,r)},notifyWindowed:function(t,e,i,n,r,s){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}if(null!=r){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(r)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(s)}},lock:function(){},unlock:function(){},canLock:function(){return!1},hideSystemCursor:function(){},showSystemCursor:function(){},sendLeaveEvent:function(t){if(null!=go.the()){var e=ir.alloc(8);e.setInt32(0,0),e.setInt32(4,t),go.the().sendControllerUpdate(this._id(),e)}if(null!=this.windowLeaveListeners)for(var i=0,n=this.windowLeaveListeners[t];i<n.length;){var r=n[i];++i,r()}},sendDownEvent:function(t,e,i,n){if(null!=go.the()){var r=ir.alloc(20);r.setInt32(0,1),r.setInt32(4,t),r.setInt32(8,e),r.setInt32(12,i),r.setInt32(16,n),go.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowDownListeners)for(var s=0,a=this.windowDownListeners[t];s<a.length;){var o=a[s];++s,o(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=go.the()){var r=ir.alloc(20);r.setInt32(0,2),r.setInt32(4,t),r.setInt32(8,e),r.setInt32(12,i),r.setInt32(16,n),go.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowUpListeners)for(var s=0,a=this.windowUpListeners[t];s<a.length;){var o=a[s];++s,o(e,i,n)}},sendMoveEvent:function(t,e,i,n,r){if(null!=go.the()){var s=ir.alloc(24);s.setInt32(0,3),s.setInt32(4,t),s.setInt32(8,e),s.setInt32(12,i),s.setInt32(16,n),s.setInt32(20,r),go.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowMoveListeners)for(var a=0,o=this.windowMoveListeners[t];a<o.length;){var l=o[a];++a,l(e,i,n,r)}},sendWheelEvent:function(t,e){if(null!=go.the()){var i=ir.alloc(12);i.setInt32(0,4),i.setInt32(4,t),i.setInt32(8,e),go.the().sendControllerUpdate(this._id(),i)}if(null!=this.windowWheelListeners)for(var n=0,r=this.windowWheelListeners[t];n<r.length;){var s=r[n];++n,s(e)}},__class__:ja});var Xa=function(){ja.call(this)};(i["kha.input.MouseImpl"]=Xa).__name__="kha.input.MouseImpl",Xa.__super__=ja,Xa.prototype=r(ja.prototype,{lock:function(){Xs.lockMouse()},unlock:function(){Xs.unlockMouse()},canLock:function(){return Xs.canLockMouse()},hideSystemCursor:function(){Xs.khanvas.style.cursor="none"},showSystemCursor:function(){Xs.khanvas.style.cursor="default"},__class__:Xa});var Ya=function(){Ya.instance=this};(i["kha.input.Pen"]=Ya).__name__="kha.input.Pen",Ya.get=function(t){return null==t&&(t=0),Xs.getPen(t)},Ya.prototype={notify:function(t,e,i){this.notifyWindowed(0,t,e,i)},notifyWindowed:function(t,e,i,n){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}},__class__:Ya};var Za=function(){this.listeners=[]};(i["kha.input.Sensor"]=Za).__name__="kha.input.Sensor",Za.get=function(t){switch(t._hx_index){case 0:return Za.accelerometer;case 1:return Za.gyroscope}},Za._changed=function(t,e,i,n){for(var r=0,s=Za.get(0==t?Ka.Accelerometer:Ka.Gyroscope).listeners;r<s.length;){var a=s[r];++r,a(e,i,n)}},Za.prototype={notify:function(t){Za.isInited||(Xs.initSensor(),Za.isInited=!0),this.listeners.push(t)},__class__:Za};var Ka=w["kha.input.SensorType"]={__ename__:"kha.input.SensorType",__constructs__:["Accelerometer","Gyroscope"],Accelerometer:{_hx_index:0,__enum__:"kha.input.SensorType",toString:n},Gyroscope:{_hx_index:1,__enum__:"kha.input.SensorType",toString:n}},Qa=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],Qa.instance=this};(i["kha.input.Surface"]=Qa).__name__="kha.input.Surface",Qa.prototype={sendTouchStartEvent:function(t,e,i){for(var n=0,r=this.touchStartListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendTouchEndEvent:function(t,e,i){for(var n=0,r=this.touchEndListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendMoveEvent:function(t,e,i){for(var n=0,r=this.moveListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},__class__:Qa};var qa=function(t){this.bytes=t};(i["kha.internal.BytesBlob"]=qa).__name__="kha.internal.BytesBlob",qa.__interfaces__=[xs],qa.fromBytes=function(t){return new qa(t)},qa.alloc=function(t){return new qa(ir.alloc(t))},qa.prototype={sub:function(t,e){return new qa(this.bytes.sub(t,e))},get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.set(t,e)},readU8:function(t){var e=this.bytes.get(t);return++t,e},toString:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},__class__:qa,__properties__:{get_length:"get_length"}};var Ja=function(){};(i["kha.internal.HdrFormat"]=Ja).__name__="kha.internal.HdrFormat",Ja.readBuf=function(t){for(var e=0;t[e++]=255&Ja.buffer[Ja.fileOffset],++Ja.fileOffset<Ja.bufferLength&&e<t.length;);return e},Ja.readBufOffset=function(t,e,i){for(var n=0;t[e+n++]=255&Ja.buffer[Ja.fileOffset],++Ja.fileOffset<Ja.bufferLength&&n<i;);return n},Ja.readPixelsRaw=function(t,e,i,n){var r=4*n,s=Ja.readBufOffset(e,i,r);s<r&&Jn.trace("Error reading raw pixels: got "+s+" bytes, expected "+r,{fileName:"kha/internal/HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},Ja.readPixelsRawRLE=function(t,e,i,n,r){var s,a,o,l=new Uint8Array(4),h=null,u=new Uint8Array(2);for(t.length;0<r;){if(Ja.readBuf(l)<l.length)return void Jn.trace("Error reading bytes: expected "+l.length,{fileName:"kha/internal/HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=l[0]||2!=l[1]||0!=(128&l[2]))return e[i++]=255&l[0],e[i++]=255&l[1],e[i++]=255&l[2],e[i++]=255&l[3],void Ja.readPixelsRaw(t,e,i,n*r-1);if(((255&l[2])<<8|255&l[3])!=n)return void Jn.trace("Wrong scanline width "+((255&l[2])<<8|255&l[3])+", expected "+n,{fileName:"kha/internal/HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==h)h=new Uint8Array(4*n);for(var _=s=0;_<4;){for(a=(_+++1)*n;s<a;){if(Ja.readBuf(u)<u.length)return void Jn.trace("Error reading 2-byte buffer",{fileName:"kha/internal/HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(128<(255&u[0])){if(0==(o=(255&u[0])-128)||a-s<o)return void Jn.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;0<o--;)h[s++]=255&u[1]}else{if(0==(o=255&u[0])||a-s<o)return void Jn.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(h[s++]=255&u[1],0<--o){if(Ja.readBufOffset(h,s,o)<o)return void Jn.trace("Error reading non-run data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});s+=o}}}}for(var c=0,d=n;c<d;){var p=c++;e[i]=255&h[p],e[i+1]=255&h[p+n],e[i+2]=255&h[p+2*n],e[i+3]=255&h[p+3*n],i+=4}--r}},Ja.readLine=function(){for(var t="";;){var e=Ja.buffer[Ja.fileOffset];if(10==e){++Ja.fileOffset;break}if(t+=String.fromCodePoint(e),!(++Ja.fileOffset<Ja.bufferLength))break}return t},Ja.parse=function(t){Ja.buffer=mr.fromBytes(t),Ja.bufferLength=Ja.buffer.length;for(var e=Ja.fileOffset=0,i=0,n=!1,r=0;r<20;){r++;var s=Ja.readLine();if(Ja.formatPattern.match(s))n=!0;else if(Ja.exposurePattern.match(s))pt.parseFloat(Ja.exposurePattern.matched(1));else if(Ja.widthHeightPattern.match(s)){i=pt.parseInt(Ja.widthHeightPattern.matched(1)),e=pt.parseInt(Ja.widthHeightPattern.matched(2));break}}if(!n)return Jn.trace("File is not run length encoded!",{fileName:"kha/internal/HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var a=new Uint8Array(e*i*4),o=e,l=i;Ja.readPixelsRawRLE(Ja.buffer,a,0,o,l);for(var h=new Float32Array(e*i*4),u=0;u<a.length;){var _=a[u]/255,c=a[u+1]/255,d=a[u+2]/255,p=a[u+3],f=Math.pow(2,p-128);_*=f,c*=f,d*=f,h[u]=_,h[u+1]=c,h[u+2]=d,h[u+3]=1,u+=4}return{width:e,height:i,data:h}};var $a=function(t){this.stopped=!1,this.element=t};(i["kha.js.AEAudioChannel"]=$a).__name__="kha.js.AEAudioChannel",$a.__interfaces__=[qs],$a.prototype={play:function(){this.stopped=!1,Xs.mobile?Xs.insideInputEvent?(this.element.play(),Xs.mobileAudioPlaying=!0):Xs.mobileAudioPlaying?this.element.play():$a.todo.push(this):this.element.play()},pause:function(){try{this.element.pause()}catch(t){Jn.trace(t instanceof us?t.val:t,{fileName:"kha/js/AEAudioChannel.hx",lineNumber:39,className:"kha.js.AEAudioChannel",methodName:"pause"})}},stop:function(){try{this.element.pause(),this.element.currentTime=0,this.stopped=!0}catch(t){Jn.trace(t instanceof us?t.val:t,{fileName:"kha/js/AEAudioChannel.hx",lineNumber:50,className:"kha.js.AEAudioChannel",methodName:"stop"})}},get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},get_position:function(){return this.element.currentTime},set_volume:function(t){return this.element.volume=t},get_finished:function(){return!!this.stopped||this.get_position()>=this.get_length()},__class__:$a,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_position:"get_position",get_length:"get_length"}};var to=function(){};(i["kha.js.AudioElementAudio"]=to).__name__="kha.js.AudioElementAudio",to.play=function(t,e){return null==e&&(e=!1),to.stream(t,e)},to.stream=function(t,e){null==e&&(e=!1),t.element.loop=e;var i=new $a(t.element);return i.play(),i};var eo=function(t){this.bakedQuadCache=new Ms,sa.call(this),this.canvas=t,(eo.instance=this).myColor=Ts.fromBytes(0,0,0)};(i["kha.js.CanvasGraphics"]=eo).__name__="kha.js.CanvasGraphics",eo.__super__=sa,eo.prototype=r(sa.prototype,{begin:function(t,e){null==t&&(t=!0),t&&this.clear(e)},clear:function(t){null==t&&(t=0),this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",.00392156862745098*(t>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(t,e,i){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(_s.__cast(t,ks).image,e,i),this.canvas.globalAlpha=1},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){this.canvas.globalAlpha=this.get_opacity();try{if(o<0||l<0){this.canvas.save(),this.canvas.translate(s,a);var h=0,u=0;o<0&&(this.canvas.scale(-1,1),h=-o),l<0&&(this.canvas.scale(1,-1),u=-l),this.canvas.drawImage(_s.__cast(t,ks).image,e,i,n,r,h,u,o,l),this.canvas.restore()}else this.canvas.drawImage(_s.__cast(t,ks).image,e,i,n,r,s,a,o,l)}catch(t){t instanceof us&&t.val}this.canvas.globalAlpha=1},set_color:function(t){return this.myColor=t,this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",t},get_color:function(){return this.myColor},set_imageScaleQuality:function(t){return t==la.Low?(this.canvas.mozImageSmoothingEnabled=!1,this.canvas.webkitImageSmoothingEnabled=!1,this.canvas.msImageSmoothingEnabled=!1,this.canvas.imageSmoothingEnabled=!1):(this.canvas.mozImageSmoothingEnabled=!0,this.canvas.webkitImageSmoothingEnabled=!0,this.canvas.msImageSmoothingEnabled=!0,this.canvas.imageSmoothingEnabled=!0),this.scaleQuality=t},drawRect:function(t,e,i,n,r){null==r&&(r=1),this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.rect(t,e,i,n),this.canvas.stroke(),this.canvas.lineWidth=s},fillRect:function(t,e,i,n){var r=this.get_opacity();this.canvas.globalAlpha=r*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(t,e,i,n),this.canvas.globalAlpha=this.get_opacity()},fillCircle:function(t,e,i){this.canvas.beginPath(),this.canvas.arc(t,e,i,0,2*Math.PI,!1),this.canvas.fill()},drawString:function(t,e,i){var n=this.webfont.getImage(this.get_fontSize(),this.myColor);if(0<n.width)for(var r=e,s=i,a=0,o=t.length;a<o;){var l=a++,h=this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,sa.fontGlyphs.indexOf(ht.cca(t,l)),r,s);null!=h&&(0<h.s1-h.s0&&0<h.t1-h.t0&&0<h.x1-h.x0&&0<h.y1-h.y0&&this.canvas.drawImage(n,h.s0*n.width,h.t0*n.height,(h.s1-h.s0)*n.width,(h.t1-h.t0)*n.height,h.x0,h.y0,h.x1-h.x0,h.y1-h.y0),r+=h.xadvance)}},set_font:function(t){return this.webfont=_s.__cast(t,io),this.webfont},get_font:function(){return this.webfont},drawLine:function(t,e,i,n,r){null==r&&(r=1),this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.moveTo(t,e),this.canvas.lineTo(i,n),this.canvas.moveTo(0,0),this.canvas.stroke(),this.canvas.lineWidth=s},fillTriangle:function(t,e,i,n,r,s){this.canvas.beginPath(),this.canvas.closePath(),this.canvas.fill()},setTransformation:function(t){this.canvas.setTransform(t._00,t._01,t._10,t._11,t._20,t._21)},__class__:eo});var io=function(t){this.images=new rr,this.kravur=new io.Kravur(t)};(i["kha.js.Font"]=io).__name__="kha.js.Font",io.__interfaces__=[xs],io.prototype={getImage:function(t,e){var i=1e4*t+sa.fontGlyphs.length;if(!this.images.exists(i)){var n=this.images,r=new rr;n.set(i,r)}if(!this.images.get(i).exists(e)){var s=this.kravur._get(t),a=window.document.createElement("canvas");a.width=s.width,a.height=s.height;var o=a.getContext("2d");o.fillStyle="black",o.fillRect(0,0,s.width,s.height);for(var l=o.getImageData(0,0,s.width,s.height),h=_s.__cast(s.getTexture(),ks).bytes,u=0,_=h.length;u<_;){var c=u++;l.data[4*c]=(16711680&e)>>>16,l.data[4*c+1]=(65280&e)>>>8,l.data[4*c+2]=255&e,l.data[4*c+3]=h.get(c)}o.putImageData(l,0,0);var d=window.document.createElement("img");return d.src=a.toDataURL("image/png"),this.images.get(i).set(e,d),d}return this.images.get(i).get(e)},__class__:io};var no=function(){};(i["kha.js.MobileWebAudio"]=no).__name__="kha.js.MobileWebAudio",no._init=function(){try{return void(no._context=new AudioContext)}catch(t){t instanceof us&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof us&&t.val}},no.play=function(t,e){null==e&&(e=!1);var i=new ro(t,e);return i.play(),i},no.stream=function(t,e){return null==e&&(e=!1),no.play(t,e)};var ro=function(t,e){this.stopped=!1,this.paused=!1,this.buffer=t._buffer,this.loop=e,this.createSource()};(i["kha.js.MobileWebAudioChannel"]=ro).__name__="kha.js.MobileWebAudioChannel",ro.__interfaces__=[qs],ro.prototype={createSource:function(){var t=this;this.source=no._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){t.stopped=!0},this.gain=no._context.createGain(),this.source.connect(this.gain),this.gain.connect(no._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=no._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=no._context.currentTime,this.source.start())},pause:function(){this.pauseTime=no._context.currentTime-this.startTime,this.paused=!0,this.source.stop()},stop:function(){this.paused=!1,this.stopped=!0,this.source.stop()},set_volume:function(t){return this.gain.gain.value=t},get_finished:function(){return this.stopped},__class__:ro,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var so=function(t,e,i){var n=this;Ws.call(this);var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onerror=function(){i({url:t})},r.onload=function(){n.compressedData=ir.ofData(r.response),n.uncompressedData=null,no._context.decodeAudioData(n.compressedData.getData(),function(t){n._buffer=t,e(n)},function(){i({url:t,error:"Audio format not supported"})})},r.send(null)};(i["kha.js.MobileWebAudioSound"]=so).__name__="kha.js.MobileWebAudioSound",so.__super__=Ws,so.prototype=r(Ws.prototype,{__class__:so});var ao=function(t,e,i){Ws.call(this),this.done=e,this.failed=i,ao.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var n=0;n<t.length;){var r=t[n];++n,""!=this.element.canPlayType("audio/ogg")&&q.endsWith(r,".ogg")&&this.filenames.push(r),""!=this.element.canPlayType("audio/mp4")&&q.endsWith(r,".mp4")&&this.filenames.push(r)}this.element.addEventListener("error",ko(this,this.errorListener),!1),this.element.addEventListener("canplay",ko(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(i["kha.js.Sound"]=ao).__name__="kha.js.Sound",ao.__super__=Ws,ao.prototype=r(Ws.prototype,{errorListener:function(t){if(4==this.element.error.code)for(var e=0,i=this.filenames.length-1;e<i;){var n=e++;if(this.element.src==this.filenames[n])return void(this.element.src=this.filenames[n+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ko(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ko(this,this.canPlayThroughListener),!1),this.done(this),ht.remove(ao.loading,this)},__class__:ao});var oo=function(t,e){this.value=t,this.type=e};(i["kha.js.graphics4.ConstantLocation"]=oo).__name__="kha.js.graphics4.ConstantLocation",oo.__interfaces__=[ba],oo.prototype={__class__:oo};var lo=function(t){this.matrix3Cache=new Float32Array(9),this.matrixCache=new Float32Array(16),this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.currentPipeline=null,this.renderTarget=t,this.init(),Xs.gl2?this.instancedExtension=!0:(this.instancedExtension=Xs.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=Xs.gl.getExtension("EXT_blend_minmax"))};(i["kha.js.graphics4.Graphics"]=lo).__name__="kha.js.graphics4.Graphics",lo.__interfaces__=[Ta],lo.getBlendFunc=function(t){switch(t){case 1:return 1;case 0:case 2:return 0;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},lo.getBlendOp=function(t){switch(t){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},lo.prototype={init:function(){if(null!=this.renderTarget)if(this.isCubeMap=this.renderTarget instanceof xa,this.isCubeMap){var t=_s.__cast(this.renderTarget,xa);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture,this.isDepthAttachment=t.isDepthAttachment}else{var e=_s.__cast(this.renderTarget,Zs);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture}},begin:function(t){if(Xs.gl.enable(3042),Xs.gl.blendFunc(770,771),null==this.renderTarget)Xs.gl.bindFramebuffer(36160,null),Xs.gl.viewport(0,0,Us.windowWidth(),Us.windowHeight());else if(Xs.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),Xs.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=t){Xs.gl.framebufferTexture2D(36160,Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var e=0,i=t.length;e<i;){var n=e++;Xs.gl.framebufferTexture2D(36160,Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL+n+1,3553,_s.__cast(t[n],Zs).texture,0)}for(var r=[Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL],s=0,a=t.length;s<a;){var o=s++;r.push(Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL+o+1)}Xs.gl2?Xs.gl.drawBuffers(r):Xs.drawBuffers.drawBuffersWEBGL(r)}},beginFace:function(t){Xs.gl.enable(3042),Xs.gl.blendFunc(770,771),Xs.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),Xs.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+t,this.renderTargetTexture,0),Xs.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},end:function(){},clear:function(t,e,i){var n=0;null!=t&&(n|=16384,Xs.gl.colorMask(!0,!0,!0,!0),Xs.gl.clearColor(.00392156862745098*((16711680&t)>>>16),.00392156862745098*((65280&t)>>>8),.00392156862745098*(255&t),.00392156862745098*(t>>>24))),null!=e&&(n|=256,Xs.gl.enable(2929),Xs.gl.depthMask(!0),Xs.gl.clearDepth(e)),null!=i&&(n|=1024,Xs.gl.enable(2960),Xs.gl.stencilMask(255),Xs.gl.clearStencil(i)),Xs.gl.clear(n),Xs.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?Xs.gl.enable(2929):Xs.gl.disable(2929),Xs.gl.depthMask(this.depthMask)},viewport:function(t,e,i,n){null==this.renderTarget?Xs.gl.viewport(t,Us.windowHeight(0)-e-n,i,n):Xs.gl.viewport(t,e,i,n)},scissor:function(t,e,i,n){Xs.gl.enable(3089),null==this.renderTarget?Xs.gl.scissor(t,Us.windowHeight(0)-e-n,i,n):Xs.gl.scissor(t,e,i,n)},disableScissor:function(){Xs.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},setDepthMode:function(t,e){switch(e){case 0:t?Xs.gl.enable(2929):Xs.gl.disable(2929),this.depthTest=t,Xs.gl.depthFunc(519);break;case 1:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(512);break;case 2:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(514);break;case 3:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(517);break;case 4:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(513);break;case 5:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(515);break;case 6:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(516);break;case 7:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(518)}Xs.gl.depthMask(t),this.depthMask=t},setBlendingMode:function(t,e,i,n,r,s){1==t&&2==e?Xs.gl.disable(3042):(Xs.gl.enable(3042),Xs.gl.blendFuncSeparate(lo.getBlendFunc(t),lo.getBlendFunc(e),lo.getBlendFunc(n),lo.getBlendFunc(r)),Xs.gl.blendEquationSeparate(lo.getBlendOp(i),lo.getBlendOp(s)))},setVertexBuffer:function(t){_s.__cast(t,Pa).set(0)},setVertexBuffers:function(t){for(var e=0,i=0;i<t.length;){var n=t[i];++i,e+=_s.__cast(n,Pa).set(e)}},setIndexBuffer:function(t){this.indicesCount=t.count(),_s.__cast(t,Ea).set()},setTexture:function(t,e){null==e?(Xs.gl.activeTexture(33984+_s.__cast(t,uo).value),Xs.gl.bindTexture(3553,null)):_s.__cast(e,Zs).set(_s.__cast(t,uo).value)},setTextureDepth:function(t,e){_s.__cast(e,Zs).setDepth(_s.__cast(t,uo).value)},setImageTexture:function(t,e){},setTextureParameters:function(t,e,i,n,r,s){switch(Xs.gl.activeTexture(33984+_s.__cast(t,uo).value),e){case 0:Xs.gl.texParameteri(3553,10242,10497);break;case 1:Xs.gl.texParameteri(3553,10242,33648);break;case 2:Xs.gl.texParameteri(3553,10242,33071)}switch(i){case 0:Xs.gl.texParameteri(3553,10243,10497);break;case 1:Xs.gl.texParameteri(3553,10243,33648);break;case 2:Xs.gl.texParameteri(3553,10243,33071)}switch(n){case 0:switch(s){case 0:Xs.gl.texParameteri(3553,10241,9728);break;case 1:Xs.gl.texParameteri(3553,10241,9984);break;case 2:Xs.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(s){case 0:Xs.gl.texParameteri(3553,10241,9729);break;case 1:Xs.gl.texParameteri(3553,10241,9985);break;case 2:Xs.gl.texParameteri(3553,10241,9987)}2==n&&Xs.gl.texParameteri(3553,Xs.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(r){case 0:Xs.gl.texParameteri(3553,10240,9728);break;case 1:case 2:Xs.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(t,e,i,n,r,s,a){},setTextureCompareMode:function(t,e){e?(Xs.gl.texParameteri(3553,34892,34894),Xs.gl.texParameteri(3553,34893,515)):Xs.gl.texParameteri(3553,34892,0)},setCubeMapCompareMode:function(t,e){e?(Xs.gl.texParameteri(34067,34892,34894),Xs.gl.texParameteri(34067,34893,515)):Xs.gl.texParameteri(34067,34892,0)},setCubeMap:function(t,e){null==e?(Xs.gl.activeTexture(33984+_s.__cast(t,uo).value),Xs.gl.bindTexture(34067,null)):e.set(_s.__cast(t,uo).value)},setCubeMapDepth:function(t,e){e.setDepth(_s.__cast(t,uo).value)},setCullMode:function(t){switch(t){case 0:Xs.gl.enable(2884),Xs.gl.cullFace(1029);break;case 1:Xs.gl.enable(2884),Xs.gl.cullFace(1028);break;case 2:Xs.gl.disable(2884)}},setPipeline:function(t){this.setCullMode(t.cullMode),this.setDepthMode(t.depthWrite,t.depthMode),this.setStencilParameters(t.stencilMode,t.stencilBothPass,t.stencilDepthFail,t.stencilFail,t.stencilReferenceValue,t.stencilReadMask,t.stencilWriteMask),this.setBlendingMode(t.blendSource,t.blendDestination,t.blendOperation,t.alphaBlendSource,t.alphaBlendDestination,t.alphaBlendOperation),(this.currentPipeline=t).set(),this.colorMaskRed=t.get_colorWriteMaskRed(),this.colorMaskGreen=t.get_colorWriteMaskGreen(),this.colorMaskBlue=t.get_colorWriteMaskBlue(),this.colorMaskAlpha=t.get_colorWriteMaskAlpha()},setBool:function(t,e){Xs.gl.uniform1i(_s.__cast(t,oo).value,e?1:0)},setInt:function(t,e){Xs.gl.uniform1i(_s.__cast(t,oo).value,e)},setFloat:function(t,e){Xs.gl.uniform1f(_s.__cast(t,oo).value,e)},setFloat2:function(t,e,i){Xs.gl.uniform2f(_s.__cast(t,oo).value,e,i)},setFloat3:function(t,e,i,n){Xs.gl.uniform3f(_s.__cast(t,oo).value,e,i,n)},setFloat4:function(t,e,i,n,r){Xs.gl.uniform4f(_s.__cast(t,oo).value,e,i,n,r)},setFloats:function(t,e){var i=_s.__cast(t,oo);switch(i.type){case 35664:Xs.gl.uniform2fv(i.value,e);break;case 35665:Xs.gl.uniform3fv(i.value,e);break;case 35666:Xs.gl.uniform4fv(i.value,e);break;case 35676:Xs.gl.uniformMatrix4fv(i.value,!1,e);break;default:Xs.gl.uniform1fv(i.value,e)}},setMatrix:function(t,e){this.matrixCache[0]=e._00,this.matrixCache[1]=e._01,this.matrixCache[2]=e._02,this.matrixCache[3]=e._03,this.matrixCache[4]=e._10,this.matrixCache[5]=e._11,this.matrixCache[6]=e._12,this.matrixCache[7]=e._13,this.matrixCache[8]=e._20,this.matrixCache[9]=e._21,this.matrixCache[10]=e._22,this.matrixCache[11]=e._23,this.matrixCache[12]=e._30,this.matrixCache[13]=e._31,this.matrixCache[14]=e._32,this.matrixCache[15]=e._33,Xs.gl.uniformMatrix4fv(_s.__cast(t,oo).value,!1,this.matrixCache)},setMatrix3:function(t,e){this.matrix3Cache[0]=e._00,this.matrix3Cache[1]=e._01,this.matrix3Cache[2]=e._02,this.matrix3Cache[3]=e._10,this.matrix3Cache[4]=e._11,this.matrix3Cache[5]=e._12,this.matrix3Cache[6]=e._20,this.matrix3Cache[7]=e._21,this.matrix3Cache[8]=e._22,Xs.gl.uniformMatrix3fv(_s.__cast(t,oo).value,!1,this.matrix3Cache)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0);var i=null==Xs.elementIndexUint?5123:5125,n=5123==i?2:4;Xs.gl.drawElements(4,-1==e?this.indicesCount:e,i,t*n)},convertStencilAction:function(t){switch(t){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},convertCompareMode:function(t){switch(t){case 0:return 519;case 1:return 512;case 2:return 514;case 3:return 517;case 4:return 513;case 5:return 515;case 6:return 516;case 7:return 518}},setStencilParameters:function(t,e,i,n,r,s,a){if(null==a&&(a=255),null==s&&(s=255),0==t&&0==e&&0==i&&0==n)Xs.gl.disable(2960);else{Xs.gl.enable(2960);var o=this.convertCompareMode(t);switch(Xs.gl.stencilMask(a),Xs.gl.stencilOp(this.convertStencilAction(n),this.convertStencilAction(i),this.convertStencilAction(e)),r._hx_index){case 0:Xs.gl.stencilFunc(o,0,s);break;case 1:var l=r.value;Xs.gl.stencilFunc(o,l,s)}}},drawIndexedVerticesInstanced:function(t,e,i){if(null==i&&(i=-1),null==e&&(e=0),this.instancedRenderingAvailable()){var n=null==Xs.elementIndexUint?5123:5125,r=null==Xs.elementIndexUint?2:4;Xs.gl2?Xs.gl.drawElementsInstanced(4,-1==i?this.indicesCount:i,n,e*r,t):this.instancedExtension.drawElementsInstancedANGLE(4,-1==i?this.indicesCount:i,n,e*r,t)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:lo};var ho=function(t){Oa.call(this,t)};(i["kha.js.graphics4.Graphics2"]=ho).__name__="kha.js.graphics4.Graphics2",ho.__super__=Oa,ho.prototype=r(Oa.prototype,{begin:function(t,e){null==t&&(t=!0),Xs.gl.colorMask(!0,!0,!0,!0),Xs.gl.disable(2929),Xs.gl.depthFunc(519),Oa.prototype.begin.call(this,t,e)},__class__:ho});var uo=function(t){this.value=t};(i["kha.js.graphics4.TextureUnit"]=uo).__name__="kha.js.graphics4.TextureUnit",uo.__interfaces__=[Fa],uo.prototype={__class__:uo};var _o=function(){};(i["kha.vr.VrInterface"]=_o).__name__="kha.vr.VrInterface",_o.prototype={IsVrEnabled:function(){return!1},__class__:_o};var co=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,_o.call(this)};(i["kha.js.vr.VrInterface"]=co).__name__="kha.js.vr.VrInterface",co.__super__=_o,co.prototype=r(_o.prototype,{getVRDisplays:function(){var n=this;navigator.getVRDisplays().then(function(t){if(0<t.length){n.frameData=new VRFrameData,n.vrDisplay=t[0],n.vrDisplay.depthNear=.1,n.vrDisplay.depthFar=1024;var e=n.vrDisplay.getEyeParameters("left"),i=n.vrDisplay.getEyeParameters("right");n.width=Xs.khanvas.width,n.height=Xs.khanvas.height,n.vrWidth=pt.int(2*Math.max(e.renderWidth,i.renderWidth)),n.vrHeight=pt.int(Math.max(e.renderHeight,i.renderHeight))}else Jn.trace("There are no VR displays connected.",{fileName:"kha/js/vr/VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:co});var po=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(i["kha.math.FastVector2"]=po).__name__="kha.math.FastVector2",po.prototype={get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=this.get_length();if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},__class__:po,__properties__:{set_length:"set_length",get_length:"get_length"}};var fo=function(){};(i["kha.netsync.ControllerBuilder"]=fo).__name__="kha.netsync.ControllerBuilder";var go=function(t,e,i){this.controllers=new rr,(go.instance=this).maxPlayers=t,this.address=e,this.port=i};(i["kha.netsync.Session"]=go).__name__="kha.netsync.Session",go.the=function(){return go.instance},go.prototype={sendControllerUpdate:function(t,e){if(this.controllers.exists(t)){if(this.controllers.get(t)._inputBuffer.length<this.controllers.get(t)._inputBufferIndex+4+e.length){var i=ir.alloc(this.controllers.get(t)._inputBufferIndex+4+e.length);i.blit(0,this.controllers.get(t)._inputBuffer,0,this.controllers.get(t)._inputBufferIndex),this.controllers.get(t)._inputBuffer=i}this.controllers.get(t)._inputBuffer.setInt32(this.controllers.get(t)._inputBufferIndex,e.length),this.controllers.get(t)._inputBuffer.blit(this.controllers.get(t)._inputBufferIndex+4,e,0,e.length),this.controllers.get(t)._inputBufferIndex+=4+e.length}},__class__:go};var mo=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(i["zui.Handle"]=mo).__name__="zui.Handle",mo.prototype={nest:function(t,e){for(null==this.children&&(this.children=[]);this.children.length<=t;)this.children.push(null);return null==this.children[t]&&(this.children[t]=new mo(e)),this.children[t]},__class__:mo};var vo=function(){};(i["zui.Canvas"]=vo).__name__="zui.Canvas",vo.draw=function(t,e,i){-1==vo.screenW&&(vo.screenW=Us.windowWidth(),vo.screenH=Us.windowHeight()),vo.events=[],(vo._ui=t).begin(i),t.g=i;for(var n=0,r=e.elements;n<r.length;){var s=r[n];++n,null==s.parent&&vo.drawElement(t,e,s)}return t.end(),vo.events},vo.drawElement=function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=0),null!=i&&0!=i.visible){t._x=e.x+vo.scaled(i.x)+vo.scaled(n),t._y=e.y+vo.scaled(i.y)+vo.scaled(r),t._w=vo.scaled(i.width);var s=vo.scaled(e.width),a=vo.scaled(e.height);switch(i.anchor){case 1:t._x-=(s-vo.screenW)/2;break;case 2:t._x-=s-vo.screenW;break;case 3:t._y-=(a-vo.screenH)/2;break;case 4:t._x-=(s-vo.screenW)/2,t._y-=(a-vo.screenH)/2;break;case 5:t._x-=s-vo.screenW,t._y-=(a-vo.screenH)/2;break;case 6:t._y-=a-vo.screenH;break;case 7:t._x-=(s-vo.screenW)/2,t._y-=a-vo.screenH;break;case 8:t._x-=s-vo.screenW,t._y-=a-vo.screenH}var o=null!=i.rotation&&0!=i.rotation;switch(o&&t.g.pushRotation(i.rotation,t._x+vo.scaled(i.width)/2,t._y+vo.scaled(i.height)/2),i.type){case 0:var l=t.ops.font,h=t.fontSize,u=t.t.TEXT_COL;null!=i.asset&&q.endsWith(i.asset,".ttf")&&(t.ops.font=vo.getAsset(e,i.asset)),t.fontSize=vo.scaled(i.height),t.t.TEXT_COL=i.color,t.text(vo.getText(e,i)),t.ops.font=l,t.fontSize=h,t.t.TEXT_COL=u;break;case 1:var _=vo.getAsset(e,i.asset),c=null!=i.asset&&q.endsWith(i.asset,".ttf");if(null!=_&&!c){t.imageScrollAlign=!1;var d=null!=i.color?i.color:-1;if(3==t.image(_,d,vo.scaled(i.height))){var p=i.event;null!=p&&""!=p&&vo.events.push(p)}t.imageScrollAlign=!0}break;case 2:var f=t.t.BUTTON_H;if(t.t.BUTTON_H=vo.scaled(i.height),t.button(vo.getText(e,i))){var g=i.event;null!=g&&""!=g&&vo.events.push(g)}t.t.BUTTON_H=f;break;case 3:break;case 6:t.check(vo.h.nest(i.id),vo.getText(e,i));break;case 7:t.inlineRadio(vo.h.nest(i.id),vo.getText(e,i).split(";"));break;case 8:t.combo(vo.h.nest(i.id),vo.getText(e,i).split(";"));break;case 9:var m=t.g.get_color();t.g.set_color(i.color),t.g.fillRect(t._x,t._y,t._w,vo.scaled(i.height)),t.g.set_color(m);break;case 10:t.slider(vo.h.nest(i.id),vo.getText(e,i),0,1,!0);break;case 11:t.textInput(vo.h.nest(i.id),vo.getText(e,i))}if(null!=i.children)for(var v=0,y=i.children;v<y.length;){var w=y[v];++v,vo.drawElement(t,e,vo.elemById(e,w),i.x+n,i.y+r)}o&&t.g.popTransformation()}},vo.getText=function(t,e){return e.text},vo.getAsset=function(t,e){for(var i=0,n=t.assets;i<n.length;){var r=n[i];if(++i,r.name==e)return vo.assetMap.get(r.id)}return null},vo.elemById=function(t,e){for(var i=0,n=t.elements;i<n.length;){var r=n[i];if(++i,r.id==e)return r}return null},vo.scaled=function(t){return pt.int(t*vo._ui.SCALE)};var yo=function(){};(i["zui.Ext"]=yo).__name__="zui.Ext",yo.colorWheel=function(t,e,i,n,r){null==r&&(r=!1),null==i&&(i=!1),null==n&&(n=t._w),yo.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),yo.ar);var s=yo.ar[0],a=yo.ar[1],o=yo.ar[2],l=.00392156862745098*(e.color>>>24),h=t._x,u=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(n-=t.SCROLL_W(),h+=t.SCROLL_W()/2),t.image(t.ops.color_wheel,Ts.fromFloats(o,o,o));var _=h+n/2,c=u+(t._y-u)/2,d=.7*n,p=d/2,f=_,g=c+a*p,m=s*(2*Math.PI),v=Math.cos(m)*(f-_)-Math.sin(m)*(g-c)+_,y=Math.sin(m)*(f-_)+Math.cos(m)*(g-c)+c;f=v,g=y,t.g.set_color(-16777216),t.g.fillRect(f-3,g-3,6,6),t.g.set_color(-1),t.g.fillRect(f-2,g-2,4,4),r&&(i?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var w=e.nest(0);w.value=Math.round(100*o)/100,o=t.slider(w,"Value",0,1,!0),i&&(l=t.slider(e.nest(1,{value:Math.round(100*l)/100}),"Alpha",0,1,!0));var b=_+t._windowX,x=c+t._windowY;if(t.inputStarted&&t.getInputInRect(b-p,x-p,d,d)&&(yo.wheelSelectedHande=e),t.inputReleased&&(yo.wheelSelectedHande=null),t.inputDown&&yo.wheelSelectedHande==e){a=Math.min(yo.dist(b,x,t.inputX,t.inputY),p)/p;var S=Math.atan2(t.inputX-b,t.inputY-x);S<0&&(S=Math.PI+(Math.PI-Math.abs(S))),s=(S=2*Math.PI-S)/(2*Math.PI),e.changed=t.changed=!0}return yo.hsvToRgb(s,a,o,yo.ar),e.color=Ts.fromFloats(yo.ar[0],yo.ar[1],yo.ar[2],l),t.text("",2,e.color),e.color},yo.dist=function(t,e,i,n){var r=t-i,s=e-n;return Math.sqrt(r*r+s*s)},yo.fract=function(t){return t-pt.int(t)},yo.mix=function(t,e,i){return t*(1-i)+e*i},yo.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},yo.step=function(t,e){return e<t?0:1},yo.hsvToRgb=function(t,e,i,n){var r=Math.abs(6*yo.fract(t+1)-3),s=Math.abs(6*yo.fract(t+.6666666666666666)-3),a=Math.abs(6*yo.fract(t+.3333333333333333)-3);n[0]=i*yo.mix(1,yo.clamp(r-1,0,1),e),n[1]=i*yo.mix(1,yo.clamp(s-1,0,1),e),n[2]=i*yo.mix(1,yo.clamp(a-1,0,1),e)},yo.rgbToHsv=function(t,e,i,n){var r=yo.mix(i,e,yo.step(i,e)),s=yo.mix(e,i,yo.step(i,e)),a=yo.mix(-1,0,yo.step(i,e)),o=yo.mix(.6666666666666666,-.3333333333333333,yo.step(i,e)),l=yo.mix(r,t,yo.step(r,t)),h=yo.mix(s,s,yo.step(r,t)),u=yo.mix(o,a,yo.step(r,t)),_=yo.mix(t,r,yo.step(r,t)),c=l-Math.min(_,h);n[0]=Math.abs(u+(_-h)/(6*c+1e-10)),n[1]=c/(l+1e-10),n[2]=l};var wo=function(){this.nodeId=-1,this.lastNodesCount=0,this.handle=new mo,this.snapY=0,this.snapX=0,this.snapSocket=0,this.snapToId=-1,this.snapFromId=-1,this.linkDrag=null,this.SCALE=1,this.uih=0,this.uiw=0,this.zoom=1,this.panY=0,this.panX=0,this.nodeSelected=null,this.nodeDrag=null};(i["zui.Nodes"]=wo).__name__="zui.Nodes",wo.prototype={PAN_X:function(){var t=(1-this.zoom)*this.uiw/2.5;return this.panX*this.SCALE+t},PAN_Y:function(){var t=(1-this.zoom)*this.uih/2.5;return this.panY*this.SCALE+t},LINE_H:function(){return pt.int(22*this.SCALE)},BUTTONS_H:function(t){for(var e=0,i=0,n=t.buttons;i<n.length;){var r=n[i];++i,"RGBA"==r.type?e+=132*this.SCALE:"VECTOR"==r.type?e+=4*this.LINE_H():"RAMP"==r.type?e+=9.5*this.LINE_H():"CURVES"==r.type?e+=8*this.LINE_H():e+=this.LINE_H()}return pt.int(e)},NODE_H:function(t){return pt.int(2*this.LINE_H()+t.inputs.length*this.LINE_H()+t.outputs.length*this.LINE_H()+this.BUTTONS_H(t))},NODE_W:function(){return pt.int(140*this.SCALE)},NODE_X:function(t){return t.x*this.SCALE+this.PAN_X()},NODE_Y:function(t){return t.y*this.SCALE+this.PAN_Y()},SOCKET_Y:function(t){return 2*this.LINE_H()+t*this.LINE_H()},p:function(t){return t*this.SCALE},getNode:function(t,e){for(var i=0;i<t.length;){var n=t[i];if(++i,n.id==e)return n}return null},getNodeId:function(t){if(-1==this.nodeId)for(var e=0;e<t.length;){var i=t[e];++e,this.nodeId<i.id&&(this.nodeId=i.id)}return++this.nodeId},getLinkId:function(t){for(var e=0,i=0;i<t.length;){var n=t[i];++i,n.id>=e&&(e=n.id+1)}return e},getSocketId:function(t){for(var e=0,i=0;i<t.length;){var n=t[i];++i;for(var r=0,s=n.inputs;r<s.length;){var a=s[r];++r,a.id>=e&&(e=a.id+1)}for(var o=0,l=n.outputs;o<l.length;){var h=l[o];++o,h.id>=e&&(e=h.id+1)}}return e},bakeElements:function(t){t.g.end(),wo.elementsBaked=!0,wo.socketImage=Ss.createRenderTarget(20,20);var e=wo.socketImage.get_g2();e.begin(!0,0),e.set_color(-16777216),oa.fillCircle(e,10,10,10),e.set_color(-1),oa.fillCircle(e,10,10,8),e.end(),t.g.begin(!1)},nodeCanvas:function(t,e){wo.elementsBaked||this.bakeElements(t),this.lastNodesCount>e.nodes.length&&(t.changed=!0),this.lastNodesCount=e.nodes.length;var i=t._windowX,n=t._windowY;t.inputDownR&&(this.panX+=t.inputDX/this.SCALE,this.panY+=t.inputDY/this.SCALE),0!=t.inputWheelDelta&&(this.zoom+=-t.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.uiw=t._w,this.uih=t._h),this.SCALE=t.ops.scaleFactor*this.zoom;var r=t.SCALE;t.setScale(this.SCALE),t.elementsBaked=!0,t.g.set_font(t.ops.font),t.g.set_fontSize(t.fontSize);for(var s=0,a=e.links;s<a.length;){var o=a[s];++s;var l=this.getNode(e.nodes,o.from_id),h=this.getNode(e.nodes,o.to_id),u=null==l?t.inputX:i+this.NODE_X(l)+this.NODE_W(),_=null==l?t.inputY:n+this.NODE_Y(l)+this.SOCKET_Y(o.from_socket),c=null==h?t.inputX:i+this.NODE_X(h),d=null==h?t.inputY:n+this.NODE_Y(h)+this.SOCKET_Y(o.to_socket+h.outputs.length)+this.BUTTONS_H(h);if(this.linkDrag==o){-1!=this.snapFromId&&(u=this.snapX,_=this.snapY),-1!=this.snapToId&&(c=this.snapX,d=this.snapY),this.snapFromId=this.snapToId=-1;for(var p=0,f=e.nodes;p<f.length;){var g=f[p];++p;var m=g.inputs,v=g.outputs,y=this.NODE_H(g),w=i+this.NODE_X(g)-this.LINE_H()/2,b=n+this.NODE_Y(g)-this.LINE_H()/2,x=this.NODE_W()+this.LINE_H(),S=y+this.LINE_H();if(t.getInputInRect(w,b,x,S))if(null==l&&g.id!=h.id)for(var k=0,T=v.length;k<T;){var C=k++,I=i+this.NODE_X(g)+this.NODE_W(),N=n+this.NODE_Y(g)+this.SOCKET_Y(C),O=I-this.LINE_H()/2,E=N-this.LINE_H()/2;if(t.getInputInRect(O,E,this.LINE_H(),this.LINE_H())){this.snapX=I,this.snapY=N,this.snapFromId=g.id,this.snapSocket=C;break}}else if(null==h&&g.id!=l.id)for(var M=0,L=m.length;M<L;){var A=M++,B=i+this.NODE_X(g),R=n+this.NODE_Y(g)+this.SOCKET_Y(A+v.length)+this.BUTTONS_H(g),F=B-this.LINE_H()/2,P=R-this.LINE_H()/2;if(t.getInputInRect(F,P,this.LINE_H(),this.LINE_H())){this.snapX=B,this.snapY=R,this.snapToId=g.id,this.snapSocket=A;break}}}}var D=null!=this.nodeSelected&&(o.from_id==this.nodeSelected.id||o.to_id==this.nodeSelected.id);this.drawLink(t,u-i,_-n,c-i,d-n,D)}for(var W=0,V=e.nodes;W<V.length;){var H=V[W];++W;var z=H.inputs,G=H.outputs,U=this.NODE_H(H);if(t.inputStarted&&t.getInputInRect(i+this.NODE_X(H)-this.LINE_H()/2,n+this.NODE_Y(H),this.NODE_W()+this.LINE_H(),this.LINE_H())&&(this.nodeDrag=H,this.nodeSelected=this.nodeDrag),t.inputStarted&&t.getInputInRect(i+this.NODE_X(H)-this.LINE_H()/2,n+this.NODE_Y(H)-this.LINE_H()/2,this.NODE_W()+this.LINE_H(),U+this.LINE_H())){for(var j=0,X=G.length;j<X;){var Y=j++,Z=i+this.NODE_X(H)+this.NODE_W(),K=n+this.NODE_Y(H)+this.SOCKET_Y(Y);if(t.getInputInRect(Z-this.LINE_H()/2,K-this.LINE_H()/2,this.LINE_H(),this.LINE_H())){var Q={id:this.getLinkId(e.links),from_id:H.id,from_socket:Y,to_id:-1,to_socket:-1};e.links.push(Q),this.linkDrag=Q;break}}if(null==this.linkDrag)for(var q=0,J=z.length;q<J;){var $=q++,tt=i+this.NODE_X(H),et=n+this.NODE_Y(H)+this.SOCKET_Y($+G.length)+this.BUTTONS_H(H);if(t.getInputInRect(tt-this.LINE_H()/2,et-this.LINE_H()/2,this.LINE_H(),this.LINE_H())){for(var it=0,nt=e.links;it<nt.length;){var rt=nt[it];if(++it,rt.to_id==H.id&&rt.to_socket==$){rt.to_id=rt.to_socket=-1,this.linkDrag=rt;break}}if(null!=this.linkDrag)break;var st={id:this.getLinkId(e.links),from_id:-1,from_socket:-1,to_id:H.id,to_socket:$};e.links.push(st),this.linkDrag=st;break}}}else if(t.inputReleased){if(-1!=this.snapToId){for(var at=0,ot=e.links;at<ot.length;){var lt=ot[at];if(++at,lt.to_id==this.snapToId&&lt.to_socket==this.snapSocket){ht.remove(e.links,lt);break}}this.linkDrag.to_id=this.snapToId,this.linkDrag.to_socket=this.snapSocket,t.changed=!0}else-1!=this.snapFromId?(this.linkDrag.from_id=this.snapFromId,this.linkDrag.from_socket=this.snapSocket,t.changed=!0):null!=this.linkDrag&&(ht.remove(e.links,this.linkDrag),t.changed=!0);this.snapToId=this.snapFromId=-1,this.linkDrag=null,this.nodeDrag=null}this.nodeDrag!=H||t.inputDownR||(H.x+=pt.int(t.inputDX/this.SCALE),H.y+=pt.int(t.inputDY/this.SCALE)),this.drawNode(t,H,e)}t.setScale(r),t.elementsBaked=!0},drawNode:function(t,e,i){t._windowX,t._windowY;var n=this.NODE_W(),r=t.g,s=this.NODE_H(e),a=this.NODE_X(e),o=this.NODE_Y(e),l=e.name,h=this.LINE_H();r.set_color(e==this.nodeSelected?-5592406:-14671840),r.fillRect(a-1,o-1,n+2,s+2),r.set_color(e.color),r.fillRect(a,o,n,h),r.set_color(-14671840),r.fillRect(a,o+h,n,s-h),r.set_color(-1579033);var u=r.get_font().width(t.fontSize,l);r.drawString(l,a+n/2-u/2,o+this.p(4)),o+=h;for(var _=0,c=e.outputs;_<c.length;){var d=c[_];++_,o+=h,r.set_color(d.color),r.drawScaledImage(wo.socketImage,a+n-this.p(5),o-this.p(5),this.p(10),this.p(10))}o-=h*e.outputs.length,r.set_color(-1579033);for(var p=0,f=e.outputs;p<f.length;){var g=f[p];++p,o+=h;var m=t.ops.font.width(t.fontSize,g.name);r.drawString(g.name,a+n-m-this.p(12),o-this.p(7))}var v=this.handle.nest(e.id);o-=h/3;for(var y=0,w=e.buttons.length;y<w;){var b=y++,x=e.buttons[b];if("RGBA"==x.type){o+=h,t._x=a,t._y=o,t._w=n;var S=e.outputs[x.output].default_value;v.color=Ts.fromFloats(S[0],S[1],S[2]),yo.colorWheel(t,v,!1),S[0]=.00392156862745098*((16711680&v.color)>>>16),S[1]=.00392156862745098*((65280&v.color)>>>8),S[2]=.00392156862745098*(255&v.color)}else if("VECTOR"==x.type){o+=h,t._x=a,t._y=o,t._w=n;var k=null!=x.min?x.min:0,T=null!=x.max?x.max:1,C=t.t.LABEL_COL,I=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,t.text(x.name);var N=x.default_value[0];x.default_value[0]=t.slider(v.nest(b).nest(0,{value:N}),"X",k,T,!0,100,!0,0);var O=x.default_value[1];x.default_value[1]=t.slider(v.nest(b).nest(1,{value:O}),"Y",k,T,!0,100,!0,0);var E=x.default_value[2];x.default_value[2]=t.slider(v.nest(b).nest(2,{value:E}),"Z",k,T,!0,100,!0,0),t.t.LABEL_COL=C,t.t.TEXT_OFFSET=I,null!=x.output&&(e.outputs[x.output].default_value=x.default_value),o+=3*h}else if("VALUE"==x.type){o+=h,t._x=a,t._y=o,t._w=n;var M=e.outputs[x.output],L=null!=x.min?x.min:0,A=null!=x.max?x.max:1,B=t.t.LABEL_COL,R=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,M.default_value=t.slider(v.nest(0,{value:M.default_value}),"Value",L,A,!0,100,!0,0),t.t.LABEL_COL=B,t.t.TEXT_OFFSET=R}else if("STRING"==x.type){o+=h,t._x=a,t._y=o,t._w=n;var F=null!=x.output?e.outputs[x.output]:null;x.default_value=t.textInput(v.nest(0,{text:null!=F?F.default_value:""}),x.name),null!=F&&(F.default_value=x.default_value)}else if("ENUM"==x.type){o+=h,t._x=a,t._y=o,t._w=n;var P=x.data instanceof Array&&null==x.data.__enum__,D=P?x.data:wo.getEnumTexts();x.default_value=t.combo(v.nest(b,{position:x.default_value}),D,x.name),P||(x.data=wo.mapEnum(D[x.default_value]))}else if("BOOL"==x.type)o+=h,t._x=a,t._y=o,t._w=n,t.check(v.nest(0,{selected:x.default_value}),x.name);else if("RAMP"==x.type){o+=h,t._x=a,t._y=o,t._w=n;for(var W=x.default_value,V=n/this.SCALE,H=0;H<W.length;){var z=W[H];++H;var G=z[4],U=Ts.fromFloats(z[0],z[1],z[2]);t.fill(G*V,0,(1-G)*V,h-2*this.SCALE,U)}t._y+=h;var j=v.nest(2);if(t.row([.25,.25,.5]),t.button("+")){var X=W[W.length-1];W.push([X[0],X[1],X[2],X[3],1]),j.value+=1}t.button("-")&&1<W.length&&(W.pop(),j.value-=1),x.data=t.combo(v.nest(1,{position:x.data}),["Linear","Constant"],"Interpolate"),t.row([.5,.5]);var Y=W[pt.int(t.slider(j,"Index",0,W.length-1,!1,1,!0,0))];v.nest(3).value=Y[4],Y[4]=t.slider(v.nest(3),"Pos",0,1,!0,100,!0,0);var Z=v.nest(4);Z.color=Ts.fromFloats(Y[0],Y[1],Y[2]),yo.colorWheel(t,Z,!1),Y[0]=.00392156862745098*((16711680&Z.color)>>>16),Y[1]=.00392156862745098*((65280&Z.color)>>>8),Y[2]=.00392156862745098*(255&Z.color),o+=8*h+.5*h}else if("CURVES"==x.type){o+=h,t._x=a,t._y=o,t._w=n,t.row([.3333333333333333,.3333333333333333,.3333333333333333]),t.radio(v.nest(1),0,"X"),t.radio(v.nest(1),1,"Y"),t.radio(v.nest(1),2,"Z");var K=v.nest(1).position,Q=x.default_value[K],q=pt.int(Q.length/2);t._y+=5*h,t.row([.2,.2,.6]),t.button("+")&&(Q.push(0),Q.push(0)),t.button("-")&&4<Q.length&&(Q.pop(),Q.pop());var J=pt.int(t.slider(v.nest(2).nest(K,{position:0}),"Index",0,q-1,!1,1,!0,0));t.row([.5,.5]),v.nest(3).value=Q[2*J],v.nest(4).value=Q[2*J+1],Q[2*J]=t.slider(v.nest(3,{value:0}),"X",-1,1,!0,100,!0,0),Q[2*J+1]=t.slider(v.nest(4,{value:0}),"Y",-1,1,!0,100,!0,0),o+=7*h}}o+=h/3;for(var $=0,tt=e.inputs.length;$<tt;){var et=$++,it=e.inputs[et];o+=h,r.set_color(it.color),r.drawScaledImage(wo.socketImage,a-this.p(5),o-this.p(5),this.p(10),this.p(10));for(var nt=!1,rt=0,st=i.links;rt<st.length;){var at=st[rt];if(++rt,at.to_id==e.id&&at.to_socket==et){nt=!0;break}}if(nt||"VALUE"!=it.type)r.set_color(-1579033),r.drawString(it.name,a+this.p(12),o-this.p(7));else{t._x=a+this.p(6),t._y=o-this.p(9),t._w=pt.int(n-this.p(6));var ot=it,lt=null!=ot.min?ot.min:0,ht=null!=ot.max?ot.max:1,ut=t.t.LABEL_COL,_t=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,ot.default_value=t.slider(v.nest(et,{value:ot.default_value}),it.name,lt,ht,!0,100,!0,0),t.t.LABEL_COL=ut,t.t.TEXT_OFFSET=_t}}},drawLink:function(t,e,i,n,r,s){null==s&&(s=!1);var a=t.g;a.set_color(s?-861033043:-864585865),a.drawLine(e,i,n,r,1),a.set_color(s?-1716671059:-1720223881),a.drawLine(e+.5,i,n+.5,r,1),a.drawLine(e-.5,i,n-.5,r,1),a.drawLine(e,i+.5,n,r+.5,1),a.drawLine(e,i-.5,n,r-.5,1)},removeNode:function(t,e){if(null!=t){for(var i=0;i<e.links.length;){var n=e.links[i];n.from_id==t.id||n.to_id==t.id?e.links.splice(i,1):++i}ht.remove(e.nodes,t)}},__class__:wo};var bo=function(){};(i["zui.Themes"]=bo).__name__="zui.Themes";var xo=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.alwaysRedraw=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=bo.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.scaleTexture&&(t.scaleTexture=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),this.bakeElements()};(i["zui.Zui"]=xo).__name__="zui.Zui",xo.prototype={setScale:function(t){this.ops.scaleFactor=t,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=pt.int(this.t.FONT_SIZE*this.ops.scaleFactor);var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.ELEMENT_H()-e)/2,this.arrowOffsetY=(this.ELEMENT_H()-this.ARROW_SIZE())/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.ARROW_SIZE())/this.SCALE,this.buttonOffsetY=(this.ELEMENT_H()-this.BUTTON_H())/2,this.checkOffsetY=(this.ELEMENT_H()-this.CHECK_SIZE())/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.CHECK_SIZE()-this.CHECK_SELECT_SIZE())/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.ELEMENT_H()-this.CHECK_SIZE())/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.CHECK_SIZE()-this.CHECK_SELECT_SIZE())/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=Ss.createRenderTarget(pt.int(this.CHECK_SELECT_SIZE()),pt.int(this.CHECK_SELECT_SIZE()),null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),t.end(),this.elementsBaked=!0},registerInput:function(){ja.get().notifyWindowed(this.ops.khaWindowId,ko(this,this.onMouseDown),ko(this,this.onMouseUp),ko(this,this.onMouseMove),ko(this,this.onMouseWheel)),Ua.get().notify(ko(this,this.onKeyDown),ko(this,this.onKeyUp),ko(this,this.onKeyPress)),Us.notifyOnCutCopyPaste(ko(this,this.onCut),ko(this,this.onCopy),ko(this,this.onPaste)),this.inputRegistered=!0},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),t&&this.endInput(),null!=this.tabPressedHandle&&(this.tabPressedHandle=null)},endInput:function(){this.isKeyDown=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,xo.textToPaste="",xo.isCut=!1},beginLayout:function(t,e,i,n){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=t,this._windowX=0,this._windowY=0,this._windowW=n,this._x=e,this._y=i,this._w=n},endLayout:function(t){null==t&&(t=!0),t&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyDown},windowDirty:function(t,e,i,n,r){var s=e+t.dragX,a=i+t.dragY,o=this.getInputInRect(s,a,n,r)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,i,n,r,s){return null==s&&(s=!1),null!=t.texture&&n==t.texture.get_width()&&r==t.texture.get_height()||this.resize(t,n,r,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=i+t.dragY,this._windowW=n,this._windowH=r,this.windowHeader=0,this.windowDirty(t,e,i,n,r)&&(t.redraws=2),0!=t.redraws&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(n=pt.int(this.ELEMENT_W())),this._w=t.scrollEnabled?n-this.SCROLL_W():n,this._h=r,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=s)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?t.dragging=!0:this.inputReleased&&(t.dragging=!1),t.dragging&&(t.redraws=2,t.dragX+=pt.int(this.inputDX),t.dragY+=pt.int(this.inputDY)),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var i=this._y-e.scrollOffset;if(i<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var n=i-this._windowH,r=-e.scrollOffset/n,s=this._windowH*Math.abs(this._windowH/i);s=Math.max(s,this.ELEMENT_H());var a=this._windowH-s,o=n/a,l=a*r;this.inputStarted&&this.getInputInRect(this._windowX+this._windowW-this.SCROLL_W(),l+this._windowY,this.SCROLL_W(),s)&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.scrolling?this.scroll(this.inputDY*o,i):0!=this.inputWheelDelta&&this.scroll(this.inputWheelDelta*this.ELEMENT_H(),i),0<e.scrollOffset?e.scrollOffset=0:i+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-i),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-this.SCROLL_W(),this._windowY,this.SCROLL_W(),this._windowH),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this._windowW-this.SCROLL_W()-this.scrollAlign,l,this.SCROLL_W(),s)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(e.texture,this._windowX,this._windowY,e.texture.get_width()/this.ops.scaleTexture,e.texture.get_height()/this.ops.scaleTexture),""!=this.tooltipText||null!=this.tooltipImg?(this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=Ps.time()),Ps.time()-this.tooltipTime>this.t.TOOLTIP_DELAY&&(""!=this.tooltipText?this.drawTooltip():this.drawTooltipImage())):this.tooltipShown=!1,t&&this.globalG.end()}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+this.BUTTON_H()),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+this.BUTTON_H(),this._windowW-2*this.buttonOffsetY,this.LINE_STRENGTH());for(var i=0,n=this.tabNames.length;i<n;){var r=i++;this._x=t,this._w=pt.int(this.ops.font.width(this.fontSize,this.tabNames[r])+2*this.buttonOffsetY+14*this.SCALE);var s=this.getReleased(),a=this.getPushed(),o=this.getHover();if(s){var l=this.tabHandle.nest(this.tabHandle.position);l.scrollOffset=this.currentWindow.scrollOffset,l=this.tabHandle.nest(r),this.tabScroll=l.scrollOffset,this.tabHandle.position=r,this.currentWindow.redraws=3}var h=this.tabHandle.position==r;this.g.set_color(a?this.t.ACCENT_HOVER_COL:o?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),t+=this._w+5,this.drawRect(this.g,!h,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w,this.BUTTON_H()),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,this.tabNames[r],this.TEXT_OFFSET(),0,0),h&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+this.BUTTON_H(),this._w-1,this.LINE_STRENGTH()))}this._x=0,this._y=e,this._w=pt.int(this.currentWindow.scrollEnabled?this._windowW-this.SCROLL_W():this._windowW)}},image:function(t,e,i){null==e&&(e=-1);var n=t.get_width()*this.SCALE,r=t.get_height()*this.SCALE,s=Math.min(n,this._w),a=this._x;if(this.imageScrollAlign&&(s=Math.min(n,this._w-2*this.buttonOffsetY),a+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var o=-1==this.curRatio?1:this.ratios[this.curRatio];s-=this.SCROLL_W()*o,a+=this.SCROLL_W()*o/2}var l=null==i?s/n:i/r;if(null==i?i=r*l:s=n*l,!this.isVisible(i))return this.endElement(i),0;var h=this.getStarted(i),u=this.getPushed(i),_=this.getReleased(i);this.getHover();this.g.set_color(e);var c=i;return this.imageInvertY?this.g.drawScaledImage(t,a,this._y+c,s,-c):this.g.drawScaledImage(t,a,this._y,s,c),this.endElement(i),h?1:_?3:u?2:0},text:function(t,e,i){null==i&&(i=0),null==e&&(e=0),this.isVisible(this.ELEMENT_H())&&(this.getReleased(),0!=i&&(this.g.set_color(i),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.TEXT_OFFSET(),0,e)),this.endElement()},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed=!1,this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=Ua.get()&&Ua.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyDown&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(e=ht.substr(e,0,this.cursorX-1)+ht.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=ht.substr(e,0,this.highlightAnchor)+ht.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=ht.substr(e,0,this.highlightAnchor)+ht.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&null!=this.char&&""!=this.char&&32<=ht.cca(this.char,0)&&127!=ht.cca(this.char,0)&&(e=ht.substr(e,0,this.highlightAnchor)+this.char+ht.substr(e,this.cursorX,null),this.cursorX++),this.isShiftDown&&(37==this.key||39==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=xo.textToPaste&&(e=ht.substr(e,0,this.highlightAnchor)+xo.textToPaste+ht.substr(e,this.cursorX,null),this.cursorX+=xo.textToPaste.length,this.highlightAnchor=this.cursorX,xo.textToPaste=""),this.highlightAnchor==this.cursorX?xo.textToCopy=e:this.highlightAnchor<this.cursorX?xo.textToCopy=e.substring(this.highlightAnchor,this.cursorX):xo.textToCopy=e.substring(this.cursorX,this.highlightAnchor),xo.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=ht.substr(e,0,this.highlightAnchor)+ht.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.highlightAnchor,e.length));var i=this.TEXT_OFFSET(),n=this.ELEMENT_H(),r=n-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var s=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(s=this.highlightAnchor,a=this.cursorX);var o=ht.substr(e,s,a-s),l=this.g.get_font().width(this.g.get_fontSize(),o),h=this.g.get_font().width(this.g.get_fontSize(),ht.substr(e,0,s)),u=0==t?this._x+h+i:this._x+this._w-l-i;2==t&&(u-=this.g.get_font().width(this.g.get_fontSize(),ht.substr(e,a,e.length))),this.g.fillRect(u,this._y+this.cursorY*n+1.5*this.buttonOffsetY,l*this.SCALE,r)}if(Ps.time()%(2*this.t.FLASH_SPEED)<this.t.FLASH_SPEED){this.g.set_color(this.t.TEXT_COL);var _=0==t?ht.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),c=this.g.get_font().width(this.g.get_fontSize(),_),d=0==t?this._x+c+i:this._x+this._w-c-i;this.g.fillRect(d,this._y+this.cursorY*n+1.5*this.buttonOffsetY,this.SCALE,r)}this.textSelectedCurrentText=e},textInput:function(t,e,i){if(null==i&&(i=0),null==e&&(e=""),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.text;var n=this.getHover();this.g.set_color(n?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H());var r=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&r&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(i),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var s=2==i?0:2,a=0==s?7:0;this.drawString(this.g,e,a,0,s)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,i):this.drawString(this.g,this.textSelectedCurrentText,null,0,i),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=Ua.get()&&Ua.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e){if(null==e&&(e=1),!this.isVisible(this.ELEMENT_H()))return this.endElement(),!1;var i=this.getReleased(),n=this.getPushed(),r=this.getHover();return this.g.set_color(n?this.t.BUTTON_PRESSED_COL:r?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL),this.drawRect(this.g,this.t.FILL_BUTTON_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H()),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.TEXT_OFFSET(),0,e),this.endElement(),i},check:function(t,e){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawCheck(t.selected,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,i){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawRadio(t.position==e,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,i,this.titleOffsetX,0),this.endElement(),t.position==e},inlineRadio:function(t,e){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position;this.getReleased()?(++t.position>=e.length&&(t.position=0),t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawInlineRadio(e[t.position],i),this.endElement(),t.position},combo:function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=!1),null==i&&(i=""),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position;this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=r,this.comboSelectedTexts=e,this.comboSelectedLabel=i,this.comboSelectedX=pt.int(this._x+this._windowX),this.comboSelectedY=pt.int(this._y+this._windowY+this.ELEMENT_H()+this.ELEMENT_OFFSET()),this.comboSelectedW=pt.int(this._w)),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()?this.g.set_color(this.t.ACCENT_HOVER_COL):this.g.set_color(this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H());var s=this._x+this._w-this.arrowOffsetX-8,a=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(s,a,s+this.ARROW_SIZE(),a,s+this.ARROW_SIZE()/2,a+this.ARROW_SIZE()/2),this.g.set_color(this.t.TEXT_COL),n&&""!=i&&(0==r&&(this._x-=15),this.drawString(this.g,i,null,0,0==r?2:0),0==r&&(this._x+=15)),2==r&&(this._x-=15),this.drawString(this.g,e[t.position],null,0,r),2==r&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,i,n,r,s,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==s&&(s=100),null==r&&(r=!1),null==n&&(n=1),null==i&&(i=0),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.value;if(this.getStarted()&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.changed=!1,t.scrolling){var h=n-i,u=this._x+this._windowX+this.buttonOffsetY,_=h/(this._w-2*this.buttonOffsetY),c=i+(this.inputX-u)*_;t.value=Math.round(c*s)/s,t.value<i?t.value=i:t.value>n&&(t.value=n),t.changed=this.changed=!0}var d=this.getHover();this.drawSlider(t.value,i,n,r,d),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t));var p=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(p),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=pt.parseFloat(t.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,p):this.drawString(this.g,this.textSelectedCurrentText,null,0,p)),this.endElement(),t.value},drawCheck:function(t,e){var i=this._x+this.checkOffsetX,n=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,i,n,this.CHECK_SIZE(),this.CHECK_SIZE()),t&&(this.g.set_color(-1),this.g.drawImage(this.checkSelectImage,i+this.checkSelectOffsetX,n+this.checkSelectOffsetY))},drawRadio:function(t,e){var i=this._x+this.radioOffsetX,n=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,i,n,this.CHECK_SIZE(),this.CHECK_SIZE()),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(i+this.radioSelectOffsetX,n+this.radioSelectOffsetY,this.CHECK_SELECT_SIZE(),this.CHECK_SELECT_SIZE()))},drawInlineRadio:function(t,e){e?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())):(this.g.set_color(this.t.ACCENT_COL),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,1)},drawSlider:function(t,e,i,n,r){var s=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,s,a,o,this.BUTTON_H()),this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=(t-e)/(i-e),h=8*this.SCALE,u=n?s:s+(o-h)*l,_=n?o*l:h;_=Math.min(_,o),this.g.fillRect(u,a,_,this.BUTTON_H())},drawCombo:function(){var t=this.g;this.globalG.set_color(-14540254);var e=this.ELEMENT_H()+this.ELEMENT_OFFSET();this.globalG.begin(!1),this.globalG.fillRect(this.comboSelectedX,this.comboSelectedY,this.comboSelectedW,(this.comboSelectedTexts.length+1)*e),this.beginLayout(this.globalG,this.comboSelectedX,this.comboSelectedY,this.comboSelectedW),this.inputEnabled=!0;for(var i=0,n=this.comboSelectedTexts.length;i<n;){var r=i++;if(this.button(this.comboSelectedTexts[r],this.comboSelectedAlign)){this.comboToSubmit=r,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.text(this.comboSelectedLabel),this.inputReleased&&!xo.comboFirst?(this.comboSelectedHandle=null,xo.comboFirst=!0):xo.comboFirst=!1,this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=t},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,i=0;i<t.length;){var n=t[i];++i;var r=this.ops.font.width(this.fontSize,n);e<r&&(e=r)}this.tooltipX=Math.min(this.tooltipX,Us.windowWidth()-e-20),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.ELEMENT_H()*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var s=0,a=t.length;s<a;){var o=s++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}},drawTooltipImage:function(){this.tooltipX=Math.min(this.tooltipX,Us.windowWidth()-this.tooltipImg.get_width()-20),this.globalG.set_color(-16777216),this.globalG.fillRect(this.tooltipX,this.tooltipY,this.tooltipImg.get_width(),this.tooltipImg.get_height()),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+this.tooltipImg.get_height(),this.tooltipImg.get_width(),-this.tooltipImg.get_height()):this.globalG.drawImage(this.tooltipImg,this.tooltipX,this.tooltipY)},drawString:function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=pt.int(this._w/pt.int(this.fontSize/2));e.length>s&&(e=e.substring(0,s)+".."),null==i&&(i=this.t.TEXT_OFFSET),i*=this.SCALE,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==r?i=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==r&&(i=this._w-this.ops.font.width(this.fontSize,e)-this.TEXT_OFFSET()),t.drawString(e,this._x+i,this._y+this.fontOffsetY+n)},endElement:function(t){null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==t&&(t=this.ELEMENT_H()+this.ELEMENT_OFFSET()),this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=pt.int(this.wBeforeSplit*this.ratios[this.curRatio])):this._x+=this._w+this.ELEMENT_OFFSET():this._y+=this.ELEMENT_H()+this.ELEMENT_OFFSET()},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=pt.int(this._w*t[this.curRatio])},fill:function(t,e,i,n,r){this.g.set_color(r),this.g.fillRect(this._x+t*this.SCALE,this._y+e*this.SCALE,i*this.SCALE,n*this.SCALE),this.g.set_color(-1)},drawRect:function(t,e,i,n,r,s,a){null==a&&(a=0),0==a&&(a=this.LINE_STRENGTH()),e?t.fillRect(i,n,r,s):t.drawRect(i,n,r,s,a)},isVisible:function(t){return null==this.currentWindow||0<this._y+t&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.ELEMENT_H()),!!(this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.ELEMENT_H()),this.isHovered=this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,i,n,r){return null==r&&(r=1),!!(this.inputEnabled&&this.inputX>=t*r&&this.inputX<(t+i)*r&&this.inputY>=e*r)&&this.inputY<(e+n)*r},onMouseDown:function(t,e,i){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0;var n=pt.int(e*this.ops.scaleTexture),r=pt.int(i*this.ops.scaleTexture);this.setInputPosition(n,r),this.inputInitialX=n,this.inputInitialY=r},onMouseUp:function(t,e,i){0==t?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),e==this.inputInitialX&&i==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(pt.int(e*this.ops.scaleTexture),pt.int(i*this.ops.scaleTexture)),this.deselectText()},onMouseMove:function(t,e,i,n){this.setInputPosition(pt.int(t*this.ops.scaleTexture),pt.int(e*this.ops.scaleTexture))},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyDown=!0,t){case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 32:this.char=" "}},onKeyUp:function(t){switch(t){case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyDown=!0},onCut:function(){return xo.isCut=!0,this.onCopy()},onCopy:function(){return xo.textToCopy},onPaste:function(t){xo.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.SCALE},ELEMENT_H:function(){return this.t.ELEMENT_H*this.SCALE},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.SCALE},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.SCALE},BUTTON_H:function(){return this.t.BUTTON_H*this.SCALE},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.SCALE},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.SCALE},SCROLL_W:function(){return pt.int(this.t.SCROLL_W*this.SCALE)},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},LINE_STRENGTH:function(){return this.t.LINE_STRENGTH*this.SCALE},resize:function(t,e,i,n){null==n&&(n=0),t.redraws=2,null!=t.texture&&t.texture.unload(),t.texture=Ss.createRenderTarget(e,i,0,0,1,n),t.texture.get_g2().set_imageScaleQuality(la.High)},__class__:xo};var So=0;function ko(t,e){return null==e?null:(null==e.__id__&&(e.__id__=So++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}i.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=i.String=String,String.__name__="String",i.Array=Array,Array.__name__="Array",Date.prototype.__class__=i.Date=Date,Date.__name__="Date";var To={},Co={},Io=Number,No=Boolean,Oo={},Eo={};lr.count=0;var Mo={};Object.defineProperty(us.prototype,"message",{get:function(){return String(this.val)}}),null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=ps.sliceImpl),_.lastW=-1,_.lastH=-1,wt.displayIndex=0,Di.registered=!1,Di.map=new ur,Vi.registered=!1,Vi.map=new ur,Vi.node="",zi.registered=!1,zi.map=new ur,xn.helpVec=new bn,xn.helpMat=xn.identity(),Sn.helpVec0=new bn,Sn.helpMat=xn.identity(),Sn.xAxis=bn.xAxis(),Sn.yAxis=bn.yAxis(),kn.q=new Sn,kn.v1=new bn,kn.v2=new bn,Hn.pointIndex=0,Hn.spotIndex=0,Gn.drawMeshes=zn.drawMeshes,Un.events=new ur,jn.packageName="armory.logicnode",$n.USE_CACHE=!1,$n.USE_ENUM_INDEX=!1,$n.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",er.DEFAULT_RESOLVER=new tr,er.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",gr.helper=new DataView(new ArrayBuffer(8)),vr.traitInits=[],vr.traitUpdates=[],vr.traitLateUpdates=[],vr.traitRenders=[],vr.traitRenders2D=[],vr.pauseUpdates=!1,vr.lastw=-1,vr.lasth=-1,xr.uidCounter=0,xr.framePassed=!0,Tr.cachedSceneRaws=new ur,Tr.cachedMeshes=new ur,Tr.cachedLights=new ur,Tr.cachedCameras=new ur,Tr.cachedMaterials=new ur,Tr.cachedWorlds=new ur,Tr.cachedShaders=new ur,Tr.cachedBlobs=new ur,Tr.cachedImages=new ur,Tr.cachedFonts=new ur,Tr.dataPath="",Tr.loadingMeshes=new ur,Tr.loadingLights=new ur,Tr.loadingCameras=new ur,Tr.loadingMaterials=new ur,Tr.loadingWorlds=new ur,Tr.loadingShaders=new ur,Tr.loadingSceneRaws=new ur,Tr.assetsLoaded=0,Tr.loadingBlobs=new ur,Tr.loadingImages=new ur,Tr.loadingFonts=new ur,Nr.uidCounter=0,Or.num=0,Pr.m1=xn.identity(),Pr.m2=xn.identity(),Pr.vpos=new bn,Pr.vpos2=new bn,Pr.vscl=new bn,Pr.vscl2=new bn,Pr.q1=new Sn,Pr.q2=new Sn,Pr.q3=new Sn,Pr.vp=new bn,Pr.vs=new bn,Dr.uidCounter=0,Dr.seed=1,Wr.temp=new bn,Wr.sphereCenter=new bn,Wr.vcenter=new bn,Wr.vup=new bn,zr.cascadeBounds=1,zr.m=xn.identity(),zr.eye=new bn,Yr.temp=xn.identity(),Kr.biasMat=new xn(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Kr.helpMat=xn.identity(),Kr.helpMat2=xn.identity(),Kr.helpMat3=Rr.identity(),Kr.helpVec=new bn,Kr.helpVec2=new bn,Kr.helpQuat=new Sn,Jr.occupied=!1,Jr.gamepads=[],Jr.registered=!1,es.buttons=["left","right","middle"],ns.keys=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","period","comma","space","backspace","tab","enter","shift","control","alt","escape","delete","back","up","right","left","down","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12"],ss.buttonsPS=["cross","circle","square","triangle","l1","r1","l2","r2","share","options","l3","r3","up","down","left","right","home","touchpad"],ss.buttons=ss.buttonsPS,ls.scale=1,ls.last=0,ls.realDelta=0,hs.eases=[hs.easeLinear,hs.easeSineIn,hs.easeSineOut,hs.easeSineInOut,hs.easeQuadIn,hs.easeQuadOut,hs.easeQuadInOut,hs.easeCubicIn,hs.easeCubicOut,hs.easeCubicInOut,hs.easeQuartIn,hs.easeQuartOut,hs.easeQuartInOut,hs.easeQuintIn,hs.easeQuintOut,hs.easeQuintInOut,hs.easeExpoIn,hs.easeExpoOut,hs.easeExpoInOut,hs.easeCircIn,hs.easeCircOut,hs.easeCircInOut,hs.easeBackIn,hs.easeBackOut,hs.easeBackInOut],hs.anims=[],hs.registered=!1,_s.__toStr={}.toString,ws.fonts=new vs,Cs.canvas_id="khanvas",Is.instance=new Is,Ps.DIF_COUNT=3,Ps.maxframetime=.5,Ps.startTime=0,Ds.Material_mesh_vertData0="s399:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CgppbiB2ZWM0IHBvczsKb3V0IHZlYzMgd3Bvc2l0aW9uOwpvdXQgdmVjMyB3bm9ybWFsOwppbiB2ZWMyIG5vcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgc3BvcyA9IHZlYzQocG9zLnh5eiwgMS4wKTsKICAgIHdwb3NpdGlvbiA9IHZlYzQoVyAqIHNwb3MpLnh5ejsKICAgIHdub3JtYWwgPSBub3JtYWxpemUoTiAqIHZlYzMobm9yLCBwb3MudykpOwogICAgZ2xfUG9zaXRpb24gPSBXVlAgKiBzcG9zOwp9Cgo",Ds.Material_shadowmap_vertData0="s180:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgTFdWUDsKCmluIHZlYzQgcG9zOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCBzcG9zID0gdmVjNChwb3MueHl6LCAxLjApOwogICAgZ2xfUG9zaXRpb24gPSBMV1ZQICogc3BvczsKfQoK",Ds.Material_mesh_fragData0="s2231:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMzIHBvaW50UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHBvaW50QmlhczsKdW5pZm9ybSBoaWdocCB2ZWMyIGxpZ2h0UHJvajsKdW5pZm9ybSBoaWdocCBzYW1wbGVyQ3ViZVNoYWRvdyBzaGFkb3dNYXBQb2ludFsxXTsKdW5pZm9ybSBoaWdocCB2ZWMzIHBvaW50Q29sOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKb3V0IGhpZ2hwIHZlYzQgZnJhZ0NvbG9yOwoKaGlnaHAgZmxvYXQgbHBUb0RlcHRoKGlub3V0IGhpZ2hwIHZlYzMgbHAsIGhpZ2hwIHZlYzIgbGlnaHRQcm9qXzEpCnsKICAgIGxwID0gYWJzKGxwKTsKICAgIGhpZ2hwIGZsb2F0IHpjb21wID0gbWF4KGxwLngsIG1heChscC55LCBscC56KSk7CiAgICB6Y29tcCA9IGxpZ2h0UHJval8xLnggLSAobGlnaHRQcm9qXzEueSAvIHpjb21wKTsKICAgIHJldHVybiAoemNvbXAgKiAwLjUpICsgMC41Owp9CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZvaWQgbWFpbigpCnsKICAgIGhpZ2hwIHZlYzMgbiA9IG5vcm1hbGl6ZSh3bm9ybWFsKTsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC44MDAwMDAwMTE5MjA5Mjg5NTUwNzgxMjUpOwogICAgaGlnaHAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDAuMDsKICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gdmVjMygwLjApOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIHZlYzMgbGQgPSBwb2ludFBvcyAtIHdwb3NpdGlvbjsKICAgIGhpZ2hwIHZlYzMgbCA9IG5vcm1hbGl6ZShsZCk7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbCksIDAuMCk7CiAgICBoaWdocCB2ZWMzIHBhcmFtID0gbGQgLSAoKG4gKiBwb2ludEJpYXMpICogODAuMCk7CiAgICBoaWdocCBmbG9hdCBfOTYgPSBscFRvRGVwdGgocGFyYW0sIGxpZ2h0UHJvaik7CiAgICBoaWdocCBmbG9hdCBjb21wYXJlID0gXzk2OwogICAgaGlnaHAgdmVjNCBfMTE5ID0gdmVjNCgoLWwpICsgKChuICogcG9pbnRCaWFzKSAqIDgwLjApLCBjb21wYXJlKTsKICAgIHZpc2liaWxpdHkgPSB0ZXh0dXJlKHNoYWRvd01hcFBvaW50WzBdLCB2ZWM0KF8xMTkueHl6LCBfMTE5LncpKTsKICAgIGRpcmVjdCArPSAoKCgoYmFzZWNvbCAqIGRvdE5MKSAqIHBvaW50Q29sKSAqIGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIHBvaW50UG9zKSkpICogdmlzaWJpbGl0eSk7CiAgICBmcmFnQ29sb3IgPSB2ZWM0KGRpcmVjdCArICgoYmFzZWNvbCAqIDAuNSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICBoaWdocCB2ZWMzIF8xNTQgPSBwb3coZnJhZ0NvbG9yLnh5eiwgdmVjMygwLjQ1NDU0NTQ2ODA5MTk2NDcyMTY3OTY4NzUpKTsKICAgIGZyYWdDb2xvciA9IHZlYzQoXzE1NC54LCBfMTU0LnksIF8xNTQueiwgZnJhZ0NvbG9yLncpOwp9Cgo",Ds.Material_shadowmap_fragData0="s107:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdm9pZCBtYWluKCkKewp9Cgo",Ds.painter_colored_fragData0="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",Ds.painter_colored_vertData0="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Ds.painter_image_fragData0="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",Ds.painter_text_fragData0="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",Ds.painter_image_vertData0="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",Ds.painter_text_vertData0="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",Ds.painter_video_fragData0="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",Ds.painter_video_vertData0="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",Us.renderListeners=[],Us.foregroundListeners=[],Us.backgroundListeners=[],Us.shutdownListeners=[],Xs.mobile=!1,Xs.ios=!1,Xs.mobileAudioPlaying=!1,Xs.chrome=!1,Xs.firefox=!1,Xs.ie=!1,Xs.insideInputEvent=!1,Xs.leftMouseCtrlDown=!1,Xs.minimumScroll=999,Xs.lastFirstTouchX=0,Xs.lastFirstTouchY=0,Xs.iosSoundEnabled=!1,Xs.soundEnabled=!1,Xs.iosTouchs=[],Ks.windows=[],sa.fontGlyphs=function(t){for(var e=[],i=32;i<256;){var n=i++;e.push(n)}return e}(),za.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},za.instances=[],za.connectListeners=[],za.disconnectListeners=[],Ua.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},ja.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},Za.isInited=!1,Za.accelerometer=new Za,Za.gyroscope=new Za,Ja.exposurePattern=new s("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),Ja.formatPattern=new s("FORMAT=32-bit_rle_rgbe","i"),Ja.widthHeightPattern=new s("-Y ([0-9]+) \\+X ([0-9]+)","i"),$a.todo=[],ao.loading=[],fo.nextId=0,mo.global=new mo,vo.assetMap=new rr,vo.events=[],vo.screenW=-1,vo.screenH=-1,vo.h=new mo,yo.ar=[0,0,0],wo.elementsBaked=!1,bo.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:2,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:8,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-14671840,WINDOW_TINT_COL:-1,ACCENT_COL:-12566464,ACCENT_HOVER_COL:-11513776,ACCENT_SELECT_COL:-10066330,PANEL_BG_COL:-16777216,PANEL_TEXT_COL:-1118482,BUTTON_COL:-13948117,BUTTON_TEXT_COL:-3487289,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-3487289,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-14277082},bo.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:16,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887},xo.textToPaste="",xo.textToCopy="",xo.isCut=!1,xo.comboFirst=!0,a.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
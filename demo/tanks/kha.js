!function(t,e){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};var a,i={},n=function(){return d_.__string_rec(this,"")},I={};function s(t,e){function a(){}a.prototype=t;var i=new a;for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var r=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};(i.EReg=r).__name__=!0,r.prototype={r:null,match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&0<=t&&t<this.r.m.length)return this.r.m[t];throw new Jt("EReg::matched")},__class__:r};var q=function(){};(i.HxOverrides=q).__name__=!0,q.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),a=new Date;return a.setTime(0),a.setUTCHours(e[0]),a.setUTCMinutes(e[1]),a.setUTCSeconds(e[2]),a;case 10:var i=t.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var n=t.split(" "),s=n[0].split("-"),r=n[1].split(":");return new Date(s[0],s[1]-1,s[2],r[0],r[1],r[2]);default:throw new Jt("Invalid date format : "+t)}},q.cca=function(t,e){var a=t.charCodeAt(e);if(a==a)return a},q.substr=function(t,e,a){if(null==a)a=t.length;else if(a<0){if(0!=e)return"";a=t.length+a}return t.substr(e,a)},q.remove=function(t,e){var a=t.indexOf(e);return-1!=a&&(t.splice(a,1),!0)},q.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var o=function(){};(i.Main=o).__name__=!0,o.main=function(){f_.skinMaxBones=8,C.numAssets=16,C.drawLoading=z.render,C.main("Scene",0,!1,!0,!1,960,540,1,!0,x.get)},Math.__name__=!0;var Ft=function(){};(i.Reflect=Ft).__name__=!0,Ft.field=function(t,e){try{return t[e]}catch(t){t instanceof Jt&&t.val;return null}},Ft.getProperty=function(t,e){var a;return null==t?null:!!t.__properties__&&(a=t.__properties__["get_"+e])?t[a]():t[e]},Ft.setProperty=function(t,e,a){var i;!!t.__properties__&&(i=t.__properties__["set_"+e])?t[i](a):t[e]=a},Ft.fields=function(t){var e=[];if(null!=t){var a=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&a.call(t,i)&&e.push(i)}return e},Ft.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)};var X=function(){};(i.Std=X).__name__=!0,X.string=function(t){return d_.__string_rec(t,"")},X.parseInt=function(t){var e=parseInt(t,10);return 0!=e||120!=q.cca(t,1)&&88!=q.cca(t,1)||(e=parseInt(t)),isNaN(e)?null:e};var O=function(){};(i.StringTools=O).__name__=!0,O.endsWith=function(t,e){var a=e.length,i=t.length;return a<=i&&q.substr(t,i-a,a)==e},O.replace=function(t,e,a){return t.split(e).join(a)};var E=function(){};(i.Type=E).__name__=!0,E.createInstance=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(e)))},E.createEnum=function(t,e,a){var i=Ft.field(t,e);if(null==i)throw new Jt("No such constructor "+e);if(Ft.isFunction(i)){if(null==a)throw new Jt("Constructor "+e+" need parameters");return i.apply(t,a)}if(null!=a&&0!=a.length)throw new Jt("Constructor "+e+" does not need parameters");return i},E.getInstanceFields=function(t){var e=[];for(var a in t.prototype)e.push(a);return q.remove(e,"__class__"),q.remove(e,"__properties__"),e};var Lt={};(i["_UInt.UInt_Impl_"]=Lt).__name__=!0,Lt.gt=function(t,e){var a=t<0;return a!=e<0?a:e<t},Lt.gte=function(t,e){var a=t<0;return a!=e<0?a:e<=t},Lt.toFloat=function(t){return t<0?4294967296+t:t+0};var c=function(){this._render2D=null,this._render=null,this._lateUpdate=null,this._update=null,this._remove=null,this._init=null,this._add=null};(i["iron.Trait"]=c).__name__=!0,c.prototype={object:null,_add:null,_init:null,_remove:null,_update:null,_lateUpdate:null,_render:null,_render2D:null,remove:function(){this.object.removeTrait(this)},notifyOnAdd:function(t){null==this._add&&(this._add=[]),this._add.push(t)},notifyOnInit:function(t){null==this._init&&(this._init=[]),this._init.push(t),P.notifyOnInit(t)},notifyOnRemove:function(t){null==this._remove&&(this._remove=[]),this._remove.push(t)},notifyOnUpdate:function(t){null==this._update&&(this._update=[]),this._update.push(t),P.notifyOnUpdate(t)},__class__:c};var l=function(){c.call(this)};(i["arm.FireTrait"]=l).__name__=!0,l.__super__=c,l.prototype=s(c.prototype,{fire:function(){var f=this;h_.active.spawnObject("Bullet",null,function(t){t.visible=!0,f.object.transform.buildMatrix();var e=t.transform.loc,a=f.object.transform.world,i=a.self._30,n=a.self._31,s=a.self._32;a.self._33;e.x=i,e.y=n,e.z=s,t.transform.buildMatrix();var r=t.getTrait(be);null!=r&&r.syncTransform();var o=f.object.transform.world,l=o.self._10,_=o.self._11,h=o.self._12;l*=17,_*=17,h*=17,r.setLinearVelocity(l,_,h),Wt.timer(2,ns(t,t.remove))})},__class__:l});var _=function(){var i=this;c.call(this),this.notifyOnUpdate(function(){var t=zt.getKeyboard(),e=zt.getGamepad(0),a=i.object.getTrait(v);(t.down("left")||0<e.down("left"))&&a.turnLeft(),(t.down("right")||0<e.down("right"))&&a.turnRight(),(t.down("up")||0<e.down("up"))&&a.forward(),(t.down("down")||0<e.down("down"))&&a.backward()})};(i["arm.Player1Controls"]=_).__name__=!0,_.__super__=c,_.prototype=s(c.prototype,{__class__:_});var h=function(){var a=this;c.call(this),this.notifyOnUpdate(function(){var t=zt.getKeyboard(),e=zt.getGamepad(0);(t.started("m")||e.started("cross"))&&a.object.getTrait(l).fire()})};(i["arm.Player1Fire"]=h).__name__=!0,h.__super__=c,h.prototype=s(c.prototype,{__class__:h});var f=function(){var i=this;c.call(this),this.notifyOnUpdate(function(){var t=zt.getKeyboard(),e=zt.getGamepad(1),a=i.object.getTrait(v);(t.down("a")||0<e.down("left"))&&a.turnLeft(),(t.down("d")||0<e.down("right"))&&a.turnRight(),(t.down("w")||0<e.down("up"))&&a.forward(),(t.down("s")||0<e.down("down"))&&a.backward()})};(i["arm.Player2Controls"]=f).__name__=!0,f.__super__=c,f.prototype=s(c.prototype,{__class__:f});var u=function(){var a=this;c.call(this),this.notifyOnUpdate(function(){var t=zt.getKeyboard(),e=zt.getGamepad(1);(t.started("f")||e.started("cross"))&&a.object.getTrait(l).fire()})};(i["arm.Player2Fire"]=u).__name__=!0,u.__super__=c,u.prototype=s(c.prototype,{__class__:u});var p=function(t,e,a,i,n,s,r,o,l,_,h,f,u,c,d,g){this._00=t,this._10=e,this._20=a,this._30=i,this._01=n,this._11=s,this._21=r,this._31=o,this._02=l,this._12=_,this._22=h,this._32=f,this._03=u,this._13=c,this._23=d,this._33=g};(i["kha.math.FastMatrix4"]=p).__name__=!0,p.orthogonalProjection=function(t,e,a,i,n,s){return new p(2/(e-t),0,0,-(e+t)/(e-t),0,2/(i-a),0,-(i+a)/(i-a),0,0,-2/(s-n),-(s+n)/(s-n),0,0,0,1)},p.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:p};var lo=function(t,e,a,i){null==i&&(i=1),null==a&&(a=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=a,this.w=i};(i["iron.math.Vec4"]=lo).__name__=!0,lo.distance=function(t,e){var a=t.x-e.x,i=t.y-e.y,n=t.z-e.z;return Math.sqrt(a*a+i*i+n*n)},lo.distancef=function(t,e,a,i,n,s){var r=t-i,o=e-n,l=a-s;return Math.sqrt(r*r+o*o+l*l)},lo.xAxis=function(){return new lo(1,0,0)},lo.yAxis=function(){return new lo(0,1,0)},lo.zAxis=function(){return new lo(0,0,1)},lo.prototype={x:null,y:null,z:null,w:null,__class__:lo};var da=function(t,e,a,i,n,s,r,o,l,_,h,f,u,c,d,g){this.self=new p(t,e,a,i,n,s,r,o,l,_,h,f,u,c,d,g)};(i["iron.math.Mat4"]=da).__name__=!0,da.prototype={self:null,__class__:da};var A=function(t,e,a,i){null==i&&(i=1),null==a&&(a=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=a,this.w=i};(i["iron.math.Quat"]=A).__name__=!0,A.prototype={x:null,y:null,z:null,w:null,__class__:A};var v=function(){var t=this;c.call(this),this.notifyOnInit(function(){t.transform=t.object.transform})};(i["arm.TankTrait"]=v).__name__=!0,v.__super__=c,v.prototype=s(c.prototype,{transform:null,turnLeft:function(){var t=v.q,e=0,a=Math.cos(e),i=Math.sin(e);e=0;var n=Math.cos(e),s=Math.sin(e);e=.015;var r=Math.cos(e),o=Math.sin(e);t.x=i*n*r+a*s*o,t.y=a*s*r+i*n*o,t.z=a*n*o-i*s*r,t.w=a*n*r-i*s*o;var l=this.transform.rot,_=v.q,h=l.x,f=l.y,u=l.z,c=l.w,d=_.x,g=_.y,p=_.z,m=_.w;l.x=h*m+c*d+f*p-u*g,l.y=c*g-h*p+f*m+u*d,l.z=c*p+h*g-f*d+u*m,l.w=c*m-h*d-f*g-u*p,this.transform.buildMatrix(),this.syncRigidBody()},turnRight:function(){var t=v.q,e=0,a=Math.cos(e),i=Math.sin(e);e=0;var n=Math.cos(e),s=Math.sin(e);e=-.015;var r=Math.cos(e),o=Math.sin(e);t.x=i*n*r+a*s*o,t.y=a*s*r+i*n*o,t.z=a*n*o-i*s*r,t.w=a*n*r-i*s*o;var l=this.transform.rot,_=v.q,h=l.x,f=l.y,u=l.z,c=l.w,d=_.x,g=_.y,p=_.z,m=_.w;l.x=h*m+c*d+f*p-u*g,l.y=c*g-h*p+f*m+u*d,l.z=c*p+h*g-f*d+u*m,l.w=c*m-h*d-f*g-u*p,this.transform.buildMatrix(),this.syncRigidBody()},forward:function(){var t=this.transform.world,e=t.self._10,a=t.self._11,i=t.self._12;e*=.05,a*=.05,i*=.05;var n=this.transform.loc;n.x+=e,n.y+=a,n.z+=i,this.transform.buildMatrix(),this.syncRigidBody()},backward:function(){var t=this.transform.world,e=t.self._10,a=t.self._11,i=t.self._12;e*=-.05,a*=-.05,i*=-.05;var n=this.transform.loc;n.x+=e,n.y+=a,n.z+=i,this.transform.buildMatrix(),this.syncRigidBody()},syncRigidBody:function(){var t=this.object.getTrait(be);null!=t&&t.syncTransform()},__class__:v});var m=function(){};(i["armory.data.Config"]=m).__name__=!0;var b=function(){};(i["armory.object.Uniforms"]=b).__name__=!0,b.register=function(){c_.externalTextureLinks=[b.textureLink],c_.externalVec3Links=[b.vec3Link],c_.externalFloatLinks=[b.floatLink]},b.textureLink=function(t,e,a){if("_smaaSearch"==a){var i=h_.active.embedded;return null!=fs["smaa_search.png"]?i.getReserved("smaa_search.png"):i.h["smaa_search.png"]}if("_smaaArea"==a){var n=h_.active.embedded;return null!=fs["smaa_area.png"]?n.getReserved("smaa_area.png"):n.h["smaa_area.png"]}if("_lensTexture"==a){var s=h_.active.embedded;return null!=fs["lenstexture.jpg"]?s.getReserved("lenstexture.jpg"):s.h["lenstexture.jpg"]}if("_lutTexture"==a){var r=h_.active.embedded;return null!=fs["luttexture.jpg"]?r.getReserved("luttexture.jpg"):r.h["luttexture.jpg"]}if("_cloudsTexture"==a){var o=h_.active.embedded;return null!=fs["cloudstexture.png"]?o.getReserved("cloudstexture.png"):o.h["cloudstexture.png"]}return null},b.vec3Link=function(t,e,a){var i=null;return"_hosekA"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.A.x,i.y=g.data.A.y,i.z=g.data.A.z)):"_hosekB"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.B.x,i.y=g.data.B.y,i.z=g.data.B.z)):"_hosekC"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.C.x,i.y=g.data.C.y,i.z=g.data.C.z)):"_hosekD"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.D.x,i.y=g.data.D.y,i.z=g.data.D.z)):"_hosekE"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.E.x,i.y=g.data.E.y,i.z=g.data.E.z)):"_hosekF"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.F.x,i.y=g.data.F.y,i.z=g.data.F.z)):"_hosekG"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.G.x,i.y=g.data.G.y,i.z=g.data.G.z)):"_hosekH"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.H.x,i.y=g.data.H.y,i.z=g.data.H.z)):"_hosekI"==a?(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.I.x,i.y=g.data.I.y,i.z=g.data.I.z)):"_hosekZ"==a&&(null==g.data&&g.recompute(h_.active.world),null!=g.data&&((i=c_.helpVec).x=g.data.Z.x,i.y=g.data.Z.y,i.z=g.data.Z.z)),i},b.floatLink=function(t,e,a){return null};var d=function(){this.Z=new vi,this.I=new vi,this.H=new vi,this.G=new vi,this.F=new vi,this.E=new vi,this.D=new vi,this.C=new vi,this.B=new vi,this.A=new vi};(i["armory.renderpath.HosekWilkieRadianceData"]=d).__name__=!0,d.prototype={A:null,B:null,C:null,D:null,E:null,F:null,G:null,H:null,I:null,Z:null,evaluateSpline:function(t,e,a,i){return Math.pow(1-i,5)*t[e+0*a]+5*Math.pow(1-i,4)*Math.pow(i,1)*t[e+a]+10*Math.pow(1-i,3)*Math.pow(i,2)*t[e+2*a]+10*Math.pow(1-i,2)*Math.pow(i,3)*t[e+3*a]+5*Math.pow(1-i,1)*Math.pow(i,4)*t[e+4*a]+Math.pow(i,5)*t[e+5*a]},clamp:function(t,e,a){return t<=e?e:a<=t?a:t},clampF:function(t,e,a){return t<=e?e:a<=t?a:t},evaluate:function(t,e,a,i,n,s){var r=Math.pow(Math.max(0,1-s/(Math.PI/2)),.3333333333333333),o=this.clamp(0|i,1,10),l=0|Math.min(o+1,10),_=this.clampF(i-o,0,1),h=e,f=e+6*a*10;return this.evaluateSpline(t,h+6*a*(o-1),a,r)*(1-n)*(1-_)+this.evaluateSpline(t,f+6*a*(o-1),a,r)*n*(1-_)+this.evaluateSpline(t,h+6*a*(l-1),a,r)*(1-n)*_+this.evaluateSpline(t,f+6*a*(l-1),a,r)*n*_},hosek_wilkie:function(t,e,a,i,n,s,r,o,l,_,h,f){var u=1+a*a,c=u/Math.pow(1+h.x*h.x-2*a*h.x,1.5),d=u/Math.pow(1+h.y*h.y-2*a*h.y,1.5),g=u/Math.pow(1+h.z*h.z-2*a*h.z,1.5),p=(1+i.x*Math.exp(n.x/(t+.01)))*(s.x+r.x*Math.exp(o.x*e)+l.x*(a*a)+_.x*c+f.x*Math.sqrt(Math.max(0,t))),m=(1+i.y*Math.exp(n.y/(t+.01)))*(s.y+r.y*Math.exp(o.y*e)+l.y*(a*a)+_.y*d+f.y*Math.sqrt(Math.max(0,t))),v=(1+i.z*Math.exp(n.z/(t+.01)))*(s.z+r.z*Math.exp(o.z*e)+l.z*(a*a)+_.z*g+f.z*Math.sqrt(Math.max(0,t)));return new vi(p,m,v)},setVector:function(t,e,a){0==e?t.x=a:1==e?t.y=a:t.z=a},recompute:function(t,e,a,i){for(var n=0;n<3;){var s=n++;this.setVector(this.A,s,this.evaluate(M.datasetsRGB[s],0,9,e,a,t)),this.setVector(this.B,s,this.evaluate(M.datasetsRGB[s],1,9,e,a,t)),this.setVector(this.C,s,this.evaluate(M.datasetsRGB[s],2,9,e,a,t)),this.setVector(this.D,s,this.evaluate(M.datasetsRGB[s],3,9,e,a,t)),this.setVector(this.E,s,this.evaluate(M.datasetsRGB[s],4,9,e,a,t)),this.setVector(this.F,s,this.evaluate(M.datasetsRGB[s],5,9,e,a,t)),this.setVector(this.G,s,this.evaluate(M.datasetsRGB[s],6,9,e,a,t)),this.setVector(this.H,s,this.evaluate(M.datasetsRGB[s],8,9,e,a,t)),this.setVector(this.I,s,this.evaluate(M.datasetsRGB[s],7,9,e,a,t)),this.setVector(this.Z,s,this.evaluate(M.datasetsRGBRad[s],0,1,e,a,t))}if(0!=i){var r=this.hosek_wilkie(Math.cos(t),0,1,this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H,this.I);r.x*=this.Z.x,r.y*=this.Z.y,r.z*=this.Z.z;var o=.2126*r.x+.7152*r.y+.0722*r.z;this.Z.x/=o,this.Z.y/=o,this.Z.z/=o;var l=this.Z;this.Z=new vi(l.x*i,l.y*i,l.z*i)}},__class__:d};var g=function(){};(i["armory.renderpath.HosekWilkie"]=g).__name__=!0,g.recompute=function(t){if(null!=t&&null!=t.raw.sun_direction){null==g.data&&(g.data=new d);var e=Math.acos(t.raw.sun_direction[2]);g.data.recompute(e,t.raw.turbidity,t.raw.ground_albedo,1.15)}};var M=function(){};(i["armory.renderpath.HosekWilkieData"]=M).__name__=!0;var y=function(){};(i["armory.renderpath.Inc"]=y).__name__=!0,y.init=function(t){y.path=t},y.bindShadowMap=function(){"shadowMapCube"==y.shadowMapName()?(y.path.bindTarget("arm_empty","shadowMap"),y.path.bindTarget("shadowMapCube","shadowMapCube")):(y.path.bindTarget("arm_empty_cube","shadowMapCube"),y.path.bindTarget("shadowMap","shadowMap"))},y.shadowMapName=function(){return(0<h_.active.lights.length?h_.active.lights[y.path.currentLightIndex]:null).data.raw.shadowmap_cube?"shadowMapCube":"shadowMap"},y.getShadowMap=function(){var t=y.shadowMapName(),e=y.path.renderTargets,a=null!=fs[t]?e.getReserved(t):e.h[t];if(null==a)if((0<h_.active.lights.length?h_.active.lights[y.path.currentLightIndex]:null).data.raw.shadowmap_cube){var i=0|(0<h_.active.lights.length?h_.active.lights[y.path.currentLightIndex]:null).data.raw.shadowmap_size,n=new F;n.name=t,n.width=i,n.height=i,n.format="DEPTH16",n.is_cubemap=!0,a=y.path.createRenderTarget(n)}else{var s=(0<h_.active.lights.length?h_.active.lights[y.path.currentLightIndex]:null).data.raw.shadowmap_size,r=s,o=new F;o.name=t,o.width=s,o.height=r,o.format="DEPTH16",a=y.path.createRenderTarget(o)}return t},y.initEmpty=function(){var t=new F;t.name="arm_empty",t.width=1,t.height=1,t.format="DEPTH16",y.path.createRenderTarget(t);var e=new F;e.name="arm_empty_cube",e.width=1,e.height=1,e.format="DEPTH16",e.is_cubemap=!0,y.path.createRenderTarget(e)},y.drawShadowMap=function(t){for(var e=(0<h_.active.lights.length?h_.active.lights[y.path.currentLightIndex]:null).data.raw.shadowmap_cube?6:1,a=0,i=e;a<i;){var n=a++;1<e&&(y.path.currentFace=n),y.path.setTarget(y.getShadowMap()),y.path.clearTarget(null,1),y.path.drawMeshes("shadowmap")}y.path.currentFace=-1};var w=function(){};(i["armory.renderpath.RenderPathForward"]=w).__name__=!0,w.drawMeshes=function(){w.path.drawMeshes("mesh")},w.init=function(t){w.path=t,y.initEmpty(),w.path.createDepthBuffer("main","DEPTH24");var e=new F;e.name="lbuf",e.width=0,e.height=0,e.format="RGBA64",e.displayp=null;e.depth_buffer="main",w.path.createRenderTarget(e),w.path.loadShader("shader_datas/compositor_pass/compositor_pass")},w.commands=function(){var t=0<h_.active.lights.length;t&&y.drawShadowMap(h_.active.lights[0]),w.path.setTarget("lbuf"),w.path.clearTarget(-1,1),t&&y.bindShadowMap(),x.drawMeshes();x.finalTarget=w.path.currentTarget,w.path.setTarget(""),w.path.bindTarget("lbuf","tex"),w.path.drawShader("shader_datas/compositor_pass/compositor_pass")};var x=function(){};(i["armory.renderpath.RenderPathCreator"]=x).__name__=!0,x.get=function(){return x.path=new _o,y.init(x.path),w.init(x.path),x.path.commands=w.commands,x.path};var C=function(){};(i["armory.system.Starter"]=C).__name__=!0,C.main=function(r,o,l,_,h,f,u,c,d,g){C.tasks=1,C.tasks--,function(){if(!(0<C.tasks)){null==m.raw&&(m.raw={});var t=m.raw;null==t.window_mode&&(t.window_mode=o),null==t.window_resizable&&(t.window_resizable=l),null==t.window_minimizable&&(t.window_minimizable=_),null==t.window_maximizable&&(t.window_maximizable=h),null==t.window_w&&(t.window_w=f),null==t.window_h&&(t.window_h=u),null==t.window_msaa&&(t.window_msaa=c),null==t.window_vsync&&(t.window_vsync=d),b.register();var e=0==t.window_mode?0:1,a=0;t.window_resizable&&(a|=1),t.window_maximizable&&(a|=4),t.window_minimizable&&(a|=2);var i=t.window_w,n=t.window_h,s=new we(null,null,null,null,null,null,null,a,e);co.start(new pe("tanks",i,n,s,new le(null,t.window_vsync,null,null,null,t.window_msaa)),function(t){P.init(function(){var e=null;e=function(t){null!=h_.active&&h_.active.ready?P.removeRender2D(e):C.drawLoading(t,at.assetsLoaded,C.numAssets)},P.notifyOnRender2D(e),h_.setActive(r,function(t){_o.setActive(g())})})})}}()};var Z=function(){c.call(this),this.notifyOnUpdate(ns(this,this.update))};(i["armory.trait.ArcBall"]=Z).__name__=!0,Z.__super__=c,Z.prototype=s(c.prototype,{update:function(){if(!zt.occupied){var t=zt.getMouse();if(t.down()){this.object.transform.rotate(new lo(0,0,1),-t.movementX/100),this.object.transform.buildMatrix();var e=this.object.transform.world;this.object.transform.rotate(new lo(e.self._00,e.self._01,e.self._02),-t.movementY/100),this.object.transform.buildMatrix()}}},__class__:Z});var z=function(){};(i["armory.trait.internal.LoadingScreen"]=z).__name__=!0,z.render=function(t,e,a){t.set_color(-3200189),t.fillRect(0,co.windowHeight()-6,co.windowWidth()/a*e,6)};var B=function(t,e){this.a=t,this.b=e};(i["armory.trait.physics.oimo.ContactPair"]=B).__name__=!0,B.prototype={a:null,b:null,posA:null,posB:null,nor:null,impulse:null,__class__:B};var Ot=function(){if(this.hitPointWorld=new lo,this.preUpdates=null,c.call(this),null==Ot.active)this.createPhysics();else{for(var t=Ot.active.rbMap.iterator();t.hasNext();){var e=t.next();this.removeRigidBody(e)}this.world=Ot.active.world}this.rbMap=new $,(Ot.active=this)._lateUpdate=[ns(this,this.lateUpdate)],P.traitLateUpdates.splice(0,0,ns(this,this.lateUpdate))};(i["armory.trait.physics.oimo.PhysicsWorld"]=Ot).__name__=!0,Ot.__super__=c,Ot.prototype=s(c.prototype,{world:null,rbMap:null,preUpdates:null,hitPointWorld:null,createPhysics:function(){var t=h_.active.raw.gravity,e=null==t?new Et(0,0,-9.81):new Et(t[0],t[1],t[2]);this.world=new mn(2,e)},addRigidBody:function(t){this.world.addRigidBody(t.body),this.rbMap.h[t.id]=t},removeRigidBody:function(t){null!=this.world&&this.world.removeRigidBody(t.body),this.rbMap.remove(t.id)},getContacts:function(t){return[]},getContactPairs:function(t){return[]},lateUpdate:function(){if(null!=this.preUpdates)for(var t=0,e=this.preUpdates;t<e.length;){var a=e[t];++t,a()}this.world.step(.016666666666666666);for(var i=this.rbMap.iterator();i.hasNext();){i.next().physicsUpdate()}},pickClosest:function(t,e){return null},rayCast:function(t,e){return null},notifyOnPreUpdate:function(t){null==this.preUpdates&&(this.preUpdates=[]),this.preUpdates.push(t)},removePreUpdate:function(t){q.remove(this.preUpdates,t)},__class__:Ot});var k=function(t,e,a,i){null==i&&(i=1),null==a&&(a=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=a,this.w=i,k.numCreations++};(i["oimo.common.Quat"]=k).__name__=!0,k.prototype={x:null,y:null,z:null,w:null,__class__:k};var Et=function(t,e,a){null==a&&(a=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=a,Et.numCreations++};(i["oimo.common.Vec3"]=Et).__name__=!0,Et.prototype={x:null,y:null,z:null,init:function(t,e,a){return this.x=t,this.y=e,this.z=a,this},zero:function(){return this.x=0,this.y=0,this.z=0,this},__class__:Et};var be=function(t,e,a,i,n,s,r,o,l,_,h,f,u){null==f&&(f=!1),null==h&&(h=1),null==o&&(o=!1),null==r&&(r=.1),null==s&&(s=.04),null==n&&(n=0),null==i&&(i=0),null==a&&(a=.5),null==e&&(e=0),null==t&&(t=1),this.onReady=null,this.id=0,this.ready=!1,this.body=null,this.transform=null,c.call(this),this.mass=t,this.shape=e,this.friction=a,this.restitution=i,this.collisionMargin=n,this.linearDamping=s,this.angularDamping=r,this.animated=o,this.notifyOnAdd(ns(this,this.init))};(i["armory.trait.physics.oimo.RigidBody"]=be).__name__=!0,be.__super__=c,be.prototype=s(c.prototype,{shape:null,physics:null,transform:null,mass:null,friction:null,restitution:null,collisionMargin:null,linearDamping:null,angularDamping:null,animated:null,body:null,ready:null,id:null,onReady:null,withMargin:function(t){return t-t*this.collisionMargin},notifyOnReady:function(t){this.onReady=t,this.ready&&this.onReady()},init:function(){if(!this.ready){this.ready=!0,this.transform=this.object.transform,this.physics=Ot.active;var t=new as;if(t.friction=this.friction,t.restitution=this.restitution,t.density=0<this.mass?this.mass:1,0==this.shape){var e=this.transform.dim.x,a=this.transform.dim.y,i=this.transform.dim.z;be.v1.init((e-e*this.collisionMargin)/2,(a-a*this.collisionMargin)/2,(i-i*this.collisionMargin)/2),t.geometry=new Gi(be.v1)}else if(1==this.shape){var n=this.transform.dim.x;t.geometry=new ji((n-n*this.collisionMargin)/2)}else if(2==this.shape||3==this.shape){for(var s=d_.__cast(this.object,u_).data.geom.positions,r=this.transform.scale.x*(1-this.collisionMargin),o=this.transform.scale.y*(1-this.collisionMargin),l=this.transform.scale.z*(1-this.collisionMargin),_=[],h=0,f=s.length/3|0;h<f;){var u=h++;_.push(new Et(s[3*u]*r,s[3*u+1]*o,s[3*u+2]*l))}t.geometry=new Ti(_)}else if(4==this.shape){var c=this.transform.dim.x,d=this.transform.dim.y;t.geometry=new Di((c-c*this.collisionMargin)/2,(d-d*this.collisionMargin)/2)}else if(5==this.shape){var g=this.transform.dim.x,p=this.transform.dim.y;t.geometry=new Vi((g-g*this.collisionMargin)/2,(p-p*this.collisionMargin)/2)}else if(6==this.shape){var m=this.transform.dim.x,v=this.transform.dim.y;t.geometry=new Wi((m-m*this.collisionMargin)/2,(v-v*this.collisionMargin)/2)}var b=new $n;b.type=0<this.mass?ts.DYNAMIC:ts.STATIC,b.position.init(this.transform.world.self._30,this.transform.world.self._31,this.transform.world.self._32),this.body=new qn(b);var I=be.q1;I.x=this.transform.rot.x,I.y=this.transform.rot.y,I.z=this.transform.rot.z,I.w=this.transform.rot.w;var M,y,w,x,C,A,Z,z,B,k,S,X,Y,N,L,G,W,D,T,V,K,j,R=this.body,H=be.q1,P=(M=H.x,y=H.y,w=H.z,x=H.w,2*M),F=2*y,O=2*w,E=M*P,U=y*F,J=w*O,Q=M*F,q=y*O,$=M*O,tt=x*P,et=x*F,at=x*O;R._transform._rotation00=1-U-J,R._transform._rotation01=Q-at,R._transform._rotation02=$+et,R._transform._rotation10=Q+at,R._transform._rotation11=1-E-J,R._transform._rotation12=q-tt,R._transform._rotation20=$-et,R._transform._rotation21=q+tt,R._transform._rotation22=1-E-U,C=R._transform._rotation00*R._invLocalInertia00+R._transform._rotation01*R._invLocalInertia10+R._transform._rotation02*R._invLocalInertia20,A=R._transform._rotation00*R._invLocalInertia01+R._transform._rotation01*R._invLocalInertia11+R._transform._rotation02*R._invLocalInertia21,Z=R._transform._rotation00*R._invLocalInertia02+R._transform._rotation01*R._invLocalInertia12+R._transform._rotation02*R._invLocalInertia22,z=R._transform._rotation10*R._invLocalInertia00+R._transform._rotation11*R._invLocalInertia10+R._transform._rotation12*R._invLocalInertia20,B=R._transform._rotation10*R._invLocalInertia01+R._transform._rotation11*R._invLocalInertia11+R._transform._rotation12*R._invLocalInertia21,k=R._transform._rotation10*R._invLocalInertia02+R._transform._rotation11*R._invLocalInertia12+R._transform._rotation12*R._invLocalInertia22,S=R._transform._rotation20*R._invLocalInertia00+R._transform._rotation21*R._invLocalInertia10+R._transform._rotation22*R._invLocalInertia20,X=R._transform._rotation20*R._invLocalInertia01+R._transform._rotation21*R._invLocalInertia11+R._transform._rotation22*R._invLocalInertia21,Y=R._transform._rotation20*R._invLocalInertia02+R._transform._rotation21*R._invLocalInertia12+R._transform._rotation22*R._invLocalInertia22,R._invInertia00=C,R._invInertia01=A,R._invInertia02=Z,R._invInertia10=z,R._invInertia11=B,R._invInertia12=k,R._invInertia20=S,R._invInertia21=X,R._invInertia22=Y,N=R._invInertia00*R._transform._rotation00+R._invInertia01*R._transform._rotation01+R._invInertia02*R._transform._rotation02,L=R._invInertia00*R._transform._rotation10+R._invInertia01*R._transform._rotation11+R._invInertia02*R._transform._rotation12,G=R._invInertia00*R._transform._rotation20+R._invInertia01*R._transform._rotation21+R._invInertia02*R._transform._rotation22,W=R._invInertia10*R._transform._rotation00+R._invInertia11*R._transform._rotation01+R._invInertia12*R._transform._rotation02,D=R._invInertia10*R._transform._rotation10+R._invInertia11*R._transform._rotation11+R._invInertia12*R._transform._rotation12,T=R._invInertia10*R._transform._rotation20+R._invInertia11*R._transform._rotation21+R._invInertia12*R._transform._rotation22,V=R._invInertia20*R._transform._rotation00+R._invInertia21*R._transform._rotation01+R._invInertia22*R._transform._rotation02,K=R._invInertia20*R._transform._rotation10+R._invInertia21*R._transform._rotation11+R._invInertia22*R._transform._rotation12,j=R._invInertia20*R._transform._rotation20+R._invInertia21*R._transform._rotation21+R._invInertia22*R._transform._rotation22,R._invInertia00=N,R._invInertia01=L,R._invInertia02=G,R._invInertia10=W,R._invInertia11=D,R._invInertia12=T,R._invInertia20=V,R._invInertia21=K,R._invInertia22=j,R._invInertia00*=R._rotFactor.x,R._invInertia01*=R._rotFactor.x,R._invInertia02*=R._rotFactor.x,R._invInertia10*=R._rotFactor.y,R._invInertia11*=R._rotFactor.y,R._invInertia12*=R._rotFactor.y,R._invInertia20*=R._rotFactor.z,R._invInertia21*=R._rotFactor.z,R._invInertia22*=R._rotFactor.z;var it=R._ptransform,nt=R._transform;it._positionX=nt._positionX,it._positionY=nt._positionY,it._positionZ=nt._positionZ,it._rotation00=nt._rotation00,it._rotation01=nt._rotation01,it._rotation02=nt._rotation02,it._rotation10=nt._rotation10,it._rotation11=nt._rotation11,it._rotation12=nt._rotation12,it._rotation20=nt._rotation20,it._rotation21=nt._rotation21,it._rotation22=nt._rotation22;for(var st=R._shapeList;null!=st;){var rt,ot,lt,_t,ht,ft,ut,ct,dt,gt,pt,mt,vt=st._next,bt=st._ptransform,It=st._localTransform,Mt=R._ptransform;rt=Mt._rotation00*It._rotation00+Mt._rotation01*It._rotation10+Mt._rotation02*It._rotation20,ot=Mt._rotation00*It._rotation01+Mt._rotation01*It._rotation11+Mt._rotation02*It._rotation21,lt=Mt._rotation00*It._rotation02+Mt._rotation01*It._rotation12+Mt._rotation02*It._rotation22,_t=Mt._rotation10*It._rotation00+Mt._rotation11*It._rotation10+Mt._rotation12*It._rotation20,ht=Mt._rotation10*It._rotation01+Mt._rotation11*It._rotation11+Mt._rotation12*It._rotation21,ft=Mt._rotation10*It._rotation02+Mt._rotation11*It._rotation12+Mt._rotation12*It._rotation22,ut=Mt._rotation20*It._rotation00+Mt._rotation21*It._rotation10+Mt._rotation22*It._rotation20,ct=Mt._rotation20*It._rotation01+Mt._rotation21*It._rotation11+Mt._rotation22*It._rotation21,dt=Mt._rotation20*It._rotation02+Mt._rotation21*It._rotation12+Mt._rotation22*It._rotation22,bt._rotation00=rt,bt._rotation01=ot,bt._rotation02=lt,bt._rotation10=_t,bt._rotation11=ht,bt._rotation12=ft,bt._rotation20=ut,bt._rotation21=ct,bt._rotation22=dt,gt=Mt._rotation00*It._positionX+Mt._rotation01*It._positionY+Mt._rotation02*It._positionZ,pt=Mt._rotation10*It._positionX+Mt._rotation11*It._positionY+Mt._rotation12*It._positionZ,mt=Mt._rotation20*It._positionX+Mt._rotation21*It._positionY+Mt._rotation22*It._positionZ,bt._positionX=gt,bt._positionY=pt,bt._positionZ=mt,bt._positionX+=Mt._positionX,bt._positionY+=Mt._positionY,bt._positionZ+=Mt._positionZ;var yt,wt,xt,Ct,At,Zt,zt,Bt,kt,St,Xt,Yt,Nt,Lt,Gt,Wt,Dt,Tt,Vt=st._transform,Kt=st._localTransform,jt=R._transform;if(yt=jt._rotation00*Kt._rotation00+jt._rotation01*Kt._rotation10+jt._rotation02*Kt._rotation20,wt=jt._rotation00*Kt._rotation01+jt._rotation01*Kt._rotation11+jt._rotation02*Kt._rotation21,xt=jt._rotation00*Kt._rotation02+jt._rotation01*Kt._rotation12+jt._rotation02*Kt._rotation22,Ct=jt._rotation10*Kt._rotation00+jt._rotation11*Kt._rotation10+jt._rotation12*Kt._rotation20,At=jt._rotation10*Kt._rotation01+jt._rotation11*Kt._rotation11+jt._rotation12*Kt._rotation21,Zt=jt._rotation10*Kt._rotation02+jt._rotation11*Kt._rotation12+jt._rotation12*Kt._rotation22,zt=jt._rotation20*Kt._rotation00+jt._rotation21*Kt._rotation10+jt._rotation22*Kt._rotation20,Bt=jt._rotation20*Kt._rotation01+jt._rotation21*Kt._rotation11+jt._rotation22*Kt._rotation21,kt=jt._rotation20*Kt._rotation02+jt._rotation21*Kt._rotation12+jt._rotation22*Kt._rotation22,Vt._rotation00=yt,Vt._rotation01=wt,Vt._rotation02=xt,Vt._rotation10=Ct,Vt._rotation11=At,Vt._rotation12=Zt,Vt._rotation20=zt,Vt._rotation21=Bt,Vt._rotation22=kt,St=jt._rotation00*Kt._positionX+jt._rotation01*Kt._positionY+jt._rotation02*Kt._positionZ,Xt=jt._rotation10*Kt._positionX+jt._rotation11*Kt._positionY+jt._rotation12*Kt._positionZ,Yt=jt._rotation20*Kt._positionX+jt._rotation21*Kt._positionY+jt._rotation22*Kt._positionZ,Vt._positionX=St,Vt._positionY=Xt,Vt._positionZ=Yt,Vt._positionX+=jt._positionX,Vt._positionY+=jt._positionY,Vt._positionZ+=jt._positionZ,st._geom._computeAabb(st._aabb,st._ptransform),Nt=st._aabb._minX,Lt=st._aabb._minY,Gt=st._aabb._minZ,Wt=st._aabb._maxX,Dt=st._aabb._maxY,Tt=st._aabb._maxZ,st._geom._computeAabb(st._aabb,st._transform),st._aabb._minX=Nt<st._aabb._minX?Nt:st._aabb._minX,st._aabb._minY=Lt<st._aabb._minY?Lt:st._aabb._minY,st._aabb._minZ=Gt<st._aabb._minZ?Gt:st._aabb._minZ,st._aabb._maxX=Wt>st._aabb._maxX?Wt:st._aabb._maxX,st._aabb._maxY=Dt>st._aabb._maxY?Dt:st._aabb._maxY,st._aabb._maxZ=Tt>st._aabb._maxZ?Tt:st._aabb._maxZ,null!=st._proxy){var Rt,Ht,Pt;Rt=st._transform._positionX-st._ptransform._positionX,Ht=st._transform._positionY-st._ptransform._positionY,Pt=st._transform._positionZ-st._ptransform._positionZ;var Ft=st.displacement;Ft.x=Rt,Ft.y=Ht,Ft.z=Pt,st._rigidBody._world._broadPhase.moveProxy(st._proxy,st._aabb,st.displacement)}st=vt}R._sleeping=!1,R._sleepTime=0,this.body.addShape(new es(t)),this.id=be.nextId++,this.physics.addRigidBody(this),this.notifyOnRemove(ns(this,this.removeFromWorld)),null!=this.onReady&&this.onReady()}},physicsUpdate:function(){if(this.ready)if(null!=this.object.animation||this.animated)this.syncTransform();else{var t,e,a,i=this.body;Et.numCreations++,t=i._transform._positionX,e=i._transform._positionY,a=i._transform._positionZ;var n,s,r,o,l,_,h,f,u=this.body;k.numCreations++;var c,d=u._transform._rotation00,g=u._transform._rotation11,p=u._transform._rotation22,m=d+g+p;0<m?(f=.5*(c=Math.sqrt(m+1)),c=.5/c,l=(u._transform._rotation21-u._transform._rotation12)*c,_=(u._transform._rotation02-u._transform._rotation20)*c,h=(u._transform._rotation10-u._transform._rotation01)*c):g<d?p<d?(l=.5*(c=Math.sqrt(d-g-p+1)),c=.5/c,_=(u._transform._rotation01+u._transform._rotation10)*c,h=(u._transform._rotation02+u._transform._rotation20)*c,f=(u._transform._rotation21-u._transform._rotation12)*c):(h=.5*(c=Math.sqrt(p-d-g+1)),c=.5/c,l=(u._transform._rotation02+u._transform._rotation20)*c,_=(u._transform._rotation12+u._transform._rotation21)*c,f=(u._transform._rotation10-u._transform._rotation01)*c):p<g?(_=.5*(c=Math.sqrt(g-p-d+1)),c=.5/c,l=(u._transform._rotation01+u._transform._rotation10)*c,h=(u._transform._rotation12+u._transform._rotation21)*c,f=(u._transform._rotation02-u._transform._rotation20)*c):(h=.5*(c=Math.sqrt(p-d-g+1)),c=.5/c,l=(u._transform._rotation02+u._transform._rotation20)*c,_=(u._transform._rotation12+u._transform._rotation21)*c,f=(u._transform._rotation10-u._transform._rotation01)*c),n=l,s=_,r=h,o=f;var v=this.transform.loc;v.x=t,v.y=e,v.z=a,v.w=1;var b=this.transform.rot;if(b.x=n,b.y=s,b.z=r,b.w=o,null!=this.object.parent){var I=this.object.parent.transform;this.transform.loc.x-=I.world.self._30,this.transform.loc.y-=I.world.self._31,this.transform.loc.z-=I.world.self._32}this.transform.buildMatrix()}},removeFromWorld:function(){null!=this.physics&&this.physics.removeRigidBody(this)},activate:function(){var t=this.body;t._sleeping=!1,t._sleepTime=0},disableGravity:function(){},setActivationState:function(t){},applyImpulse:function(t,e){this.activate(),null==e&&(e=this.transform.loc),be.v1.init(e.x,e.y,e.z),be.v2.init(t.x,t.y,t.z),this.body.applyImpulse(be.v1,be.v2)},setLinearFactor:function(t,e,a){},setAngularFactor:function(t,e,a){be.v1.init(t,e,a);var i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b,I,M=this.body,y=be.v1,w=M._rotFactor;w.x=y.x,w.y=y.y,w.z=y.z,i=M._transform._rotation00*M._invLocalInertia00+M._transform._rotation01*M._invLocalInertia10+M._transform._rotation02*M._invLocalInertia20,n=M._transform._rotation00*M._invLocalInertia01+M._transform._rotation01*M._invLocalInertia11+M._transform._rotation02*M._invLocalInertia21,s=M._transform._rotation00*M._invLocalInertia02+M._transform._rotation01*M._invLocalInertia12+M._transform._rotation02*M._invLocalInertia22,r=M._transform._rotation10*M._invLocalInertia00+M._transform._rotation11*M._invLocalInertia10+M._transform._rotation12*M._invLocalInertia20,o=M._transform._rotation10*M._invLocalInertia01+M._transform._rotation11*M._invLocalInertia11+M._transform._rotation12*M._invLocalInertia21,l=M._transform._rotation10*M._invLocalInertia02+M._transform._rotation11*M._invLocalInertia12+M._transform._rotation12*M._invLocalInertia22,_=M._transform._rotation20*M._invLocalInertia00+M._transform._rotation21*M._invLocalInertia10+M._transform._rotation22*M._invLocalInertia20,h=M._transform._rotation20*M._invLocalInertia01+M._transform._rotation21*M._invLocalInertia11+M._transform._rotation22*M._invLocalInertia21,f=M._transform._rotation20*M._invLocalInertia02+M._transform._rotation21*M._invLocalInertia12+M._transform._rotation22*M._invLocalInertia22,M._invInertia00=i,M._invInertia01=n,M._invInertia02=s,M._invInertia10=r,M._invInertia11=o,M._invInertia12=l,M._invInertia20=_,M._invInertia21=h,M._invInertia22=f,u=M._invInertia00*M._transform._rotation00+M._invInertia01*M._transform._rotation01+M._invInertia02*M._transform._rotation02,c=M._invInertia00*M._transform._rotation10+M._invInertia01*M._transform._rotation11+M._invInertia02*M._transform._rotation12,d=M._invInertia00*M._transform._rotation20+M._invInertia01*M._transform._rotation21+M._invInertia02*M._transform._rotation22,g=M._invInertia10*M._transform._rotation00+M._invInertia11*M._transform._rotation01+M._invInertia12*M._transform._rotation02,p=M._invInertia10*M._transform._rotation10+M._invInertia11*M._transform._rotation11+M._invInertia12*M._transform._rotation12,m=M._invInertia10*M._transform._rotation20+M._invInertia11*M._transform._rotation21+M._invInertia12*M._transform._rotation22,v=M._invInertia20*M._transform._rotation00+M._invInertia21*M._transform._rotation01+M._invInertia22*M._transform._rotation02,b=M._invInertia20*M._transform._rotation10+M._invInertia21*M._transform._rotation11+M._invInertia22*M._transform._rotation12,I=M._invInertia20*M._transform._rotation20+M._invInertia21*M._transform._rotation21+M._invInertia22*M._transform._rotation22,M._invInertia00=u,M._invInertia01=c,M._invInertia02=d,M._invInertia10=g,M._invInertia11=p,M._invInertia12=m,M._invInertia20=v,M._invInertia21=b,M._invInertia22=I,M._invInertia00*=M._rotFactor.x,M._invInertia01*=M._rotFactor.x,M._invInertia02*=M._rotFactor.x,M._invInertia10*=M._rotFactor.y,M._invInertia11*=M._rotFactor.y,M._invInertia12*=M._rotFactor.y,M._invInertia20*=M._rotFactor.z,M._invInertia21*=M._rotFactor.z,M._invInertia22*=M._rotFactor.z,M._sleeping=!1,M._sleepTime=0},getLinearVelocity:function(){var t,e,a,i=this.body;return Et.numCreations++,t=i._velX,e=i._velY,a=i._velZ,new lo(t,e,a)},setLinearVelocity:function(t,e,a){be.v1.init(t,e,a);var i=this.body;if(1==i._type)i._velX=0,i._velY=0,i._velZ=0;else{var n=be.v1;i._velX=n.x,i._velY=n.y,i._velZ=n.z}i._sleeping=!1,i._sleepTime=0},setAngularVelocity:function(t,e,a){be.v1.init(t,e,a);var i=this.body;if(1==i._type)i._angVelX=0,i._angVelY=0,i._angVelZ=0;else{var n=be.v1;i._angVelX=n.x,i._angVelY=n.y,i._angVelZ=n.z}i._sleeping=!1,i._sleepTime=0},setFriction:function(t){},syncTransform:function(){be.v1.init(this.transform.world.self._30,this.transform.world.self._31,this.transform.world.self._32);var t=this.body,e=be.v1;t._transform._positionX=e.x,t._transform._positionY=e.y,t._transform._positionZ=e.z;var a=t._ptransform,i=t._transform;a._positionX=i._positionX,a._positionY=i._positionY,a._positionZ=i._positionZ,a._rotation00=i._rotation00,a._rotation01=i._rotation01,a._rotation02=i._rotation02,a._rotation10=i._rotation10,a._rotation11=i._rotation11,a._rotation12=i._rotation12,a._rotation20=i._rotation20,a._rotation21=i._rotation21,a._rotation22=i._rotation22;for(var n=t._shapeList;null!=n;){var s,r,o,l,_,h,f,u,c,d,g,p,m=n._next,v=n._ptransform,b=n._localTransform,I=t._ptransform;s=I._rotation00*b._rotation00+I._rotation01*b._rotation10+I._rotation02*b._rotation20,r=I._rotation00*b._rotation01+I._rotation01*b._rotation11+I._rotation02*b._rotation21,o=I._rotation00*b._rotation02+I._rotation01*b._rotation12+I._rotation02*b._rotation22,l=I._rotation10*b._rotation00+I._rotation11*b._rotation10+I._rotation12*b._rotation20,_=I._rotation10*b._rotation01+I._rotation11*b._rotation11+I._rotation12*b._rotation21,h=I._rotation10*b._rotation02+I._rotation11*b._rotation12+I._rotation12*b._rotation22,f=I._rotation20*b._rotation00+I._rotation21*b._rotation10+I._rotation22*b._rotation20,u=I._rotation20*b._rotation01+I._rotation21*b._rotation11+I._rotation22*b._rotation21,c=I._rotation20*b._rotation02+I._rotation21*b._rotation12+I._rotation22*b._rotation22,v._rotation00=s,v._rotation01=r,v._rotation02=o,v._rotation10=l,v._rotation11=_,v._rotation12=h,v._rotation20=f,v._rotation21=u,v._rotation22=c,d=I._rotation00*b._positionX+I._rotation01*b._positionY+I._rotation02*b._positionZ,g=I._rotation10*b._positionX+I._rotation11*b._positionY+I._rotation12*b._positionZ,p=I._rotation20*b._positionX+I._rotation21*b._positionY+I._rotation22*b._positionZ,v._positionX=d,v._positionY=g,v._positionZ=p,v._positionX+=I._positionX,v._positionY+=I._positionY,v._positionZ+=I._positionZ;var M,y,w,x,C,A,Z,z,B,k,S,X,Y,N,L,G,W,D,T=n._transform,V=n._localTransform,K=t._transform;if(M=K._rotation00*V._rotation00+K._rotation01*V._rotation10+K._rotation02*V._rotation20,y=K._rotation00*V._rotation01+K._rotation01*V._rotation11+K._rotation02*V._rotation21,w=K._rotation00*V._rotation02+K._rotation01*V._rotation12+K._rotation02*V._rotation22,x=K._rotation10*V._rotation00+K._rotation11*V._rotation10+K._rotation12*V._rotation20,C=K._rotation10*V._rotation01+K._rotation11*V._rotation11+K._rotation12*V._rotation21,A=K._rotation10*V._rotation02+K._rotation11*V._rotation12+K._rotation12*V._rotation22,Z=K._rotation20*V._rotation00+K._rotation21*V._rotation10+K._rotation22*V._rotation20,z=K._rotation20*V._rotation01+K._rotation21*V._rotation11+K._rotation22*V._rotation21,B=K._rotation20*V._rotation02+K._rotation21*V._rotation12+K._rotation22*V._rotation22,T._rotation00=M,T._rotation01=y,T._rotation02=w,T._rotation10=x,T._rotation11=C,T._rotation12=A,T._rotation20=Z,T._rotation21=z,T._rotation22=B,k=K._rotation00*V._positionX+K._rotation01*V._positionY+K._rotation02*V._positionZ,S=K._rotation10*V._positionX+K._rotation11*V._positionY+K._rotation12*V._positionZ,X=K._rotation20*V._positionX+K._rotation21*V._positionY+K._rotation22*V._positionZ,T._positionX=k,T._positionY=S,T._positionZ=X,T._positionX+=K._positionX,T._positionY+=K._positionY,T._positionZ+=K._positionZ,n._geom._computeAabb(n._aabb,n._ptransform),Y=n._aabb._minX,N=n._aabb._minY,L=n._aabb._minZ,G=n._aabb._maxX,W=n._aabb._maxY,D=n._aabb._maxZ,n._geom._computeAabb(n._aabb,n._transform),n._aabb._minX=Y<n._aabb._minX?Y:n._aabb._minX,n._aabb._minY=N<n._aabb._minY?N:n._aabb._minY,n._aabb._minZ=L<n._aabb._minZ?L:n._aabb._minZ,n._aabb._maxX=G>n._aabb._maxX?G:n._aabb._maxX,n._aabb._maxY=W>n._aabb._maxY?W:n._aabb._maxY,n._aabb._maxZ=D>n._aabb._maxZ?D:n._aabb._maxZ,null!=n._proxy){var j,R,H;j=n._transform._positionX-n._ptransform._positionX,R=n._transform._positionY-n._ptransform._positionY,H=n._transform._positionZ-n._ptransform._positionZ;var P=n.displacement;P.x=j,P.y=R,P.z=H,n._rigidBody._world._broadPhase.moveProxy(n._proxy,n._aabb,n.displacement)}n=m}t._sleeping=!1,t._sleepTime=0;var F=be.q1;F.x=this.transform.rot.x,F.y=this.transform.rot.y,F.z=this.transform.rot.z,F.w=this.transform.rot.w;var O,E,U,J,Q,q,$,tt,et,at,it,nt,st,rt,ot,lt,_t,ht,ft,ut,ct,dt,gt=this.body,pt=be.q1,mt=(O=pt.x,E=pt.y,U=pt.z,J=pt.w,2*O),vt=2*E,bt=2*U,It=O*mt,Mt=E*vt,yt=U*bt,wt=O*vt,xt=E*bt,Ct=O*bt,At=J*mt,Zt=J*vt,zt=J*bt;gt._transform._rotation00=1-Mt-yt,gt._transform._rotation01=wt-zt,gt._transform._rotation02=Ct+Zt,gt._transform._rotation10=wt+zt,gt._transform._rotation11=1-It-yt,gt._transform._rotation12=xt-At,gt._transform._rotation20=Ct-Zt,gt._transform._rotation21=xt+At,gt._transform._rotation22=1-It-Mt,Q=gt._transform._rotation00*gt._invLocalInertia00+gt._transform._rotation01*gt._invLocalInertia10+gt._transform._rotation02*gt._invLocalInertia20,q=gt._transform._rotation00*gt._invLocalInertia01+gt._transform._rotation01*gt._invLocalInertia11+gt._transform._rotation02*gt._invLocalInertia21,$=gt._transform._rotation00*gt._invLocalInertia02+gt._transform._rotation01*gt._invLocalInertia12+gt._transform._rotation02*gt._invLocalInertia22,tt=gt._transform._rotation10*gt._invLocalInertia00+gt._transform._rotation11*gt._invLocalInertia10+gt._transform._rotation12*gt._invLocalInertia20,et=gt._transform._rotation10*gt._invLocalInertia01+gt._transform._rotation11*gt._invLocalInertia11+gt._transform._rotation12*gt._invLocalInertia21,at=gt._transform._rotation10*gt._invLocalInertia02+gt._transform._rotation11*gt._invLocalInertia12+gt._transform._rotation12*gt._invLocalInertia22,it=gt._transform._rotation20*gt._invLocalInertia00+gt._transform._rotation21*gt._invLocalInertia10+gt._transform._rotation22*gt._invLocalInertia20,nt=gt._transform._rotation20*gt._invLocalInertia01+gt._transform._rotation21*gt._invLocalInertia11+gt._transform._rotation22*gt._invLocalInertia21,st=gt._transform._rotation20*gt._invLocalInertia02+gt._transform._rotation21*gt._invLocalInertia12+gt._transform._rotation22*gt._invLocalInertia22,gt._invInertia00=Q,gt._invInertia01=q,gt._invInertia02=$,gt._invInertia10=tt,gt._invInertia11=et,gt._invInertia12=at,gt._invInertia20=it,gt._invInertia21=nt,gt._invInertia22=st,rt=gt._invInertia00*gt._transform._rotation00+gt._invInertia01*gt._transform._rotation01+gt._invInertia02*gt._transform._rotation02,ot=gt._invInertia00*gt._transform._rotation10+gt._invInertia01*gt._transform._rotation11+gt._invInertia02*gt._transform._rotation12,lt=gt._invInertia00*gt._transform._rotation20+gt._invInertia01*gt._transform._rotation21+gt._invInertia02*gt._transform._rotation22,_t=gt._invInertia10*gt._transform._rotation00+gt._invInertia11*gt._transform._rotation01+gt._invInertia12*gt._transform._rotation02,ht=gt._invInertia10*gt._transform._rotation10+gt._invInertia11*gt._transform._rotation11+gt._invInertia12*gt._transform._rotation12,ft=gt._invInertia10*gt._transform._rotation20+gt._invInertia11*gt._transform._rotation21+gt._invInertia12*gt._transform._rotation22,ut=gt._invInertia20*gt._transform._rotation00+gt._invInertia21*gt._transform._rotation01+gt._invInertia22*gt._transform._rotation02,ct=gt._invInertia20*gt._transform._rotation10+gt._invInertia21*gt._transform._rotation11+gt._invInertia22*gt._transform._rotation12,dt=gt._invInertia20*gt._transform._rotation20+gt._invInertia21*gt._transform._rotation21+gt._invInertia22*gt._transform._rotation22,gt._invInertia00=rt,gt._invInertia01=ot,gt._invInertia02=lt,gt._invInertia10=_t,gt._invInertia11=ht,gt._invInertia12=ft,gt._invInertia20=ut,gt._invInertia21=ct,gt._invInertia22=dt,gt._invInertia00*=gt._rotFactor.x,gt._invInertia01*=gt._rotFactor.x,gt._invInertia02*=gt._rotFactor.x,gt._invInertia10*=gt._rotFactor.y,gt._invInertia11*=gt._rotFactor.y,gt._invInertia12*=gt._rotFactor.y,gt._invInertia20*=gt._rotFactor.z,gt._invInertia21*=gt._rotFactor.z,gt._invInertia22*=gt._rotFactor.z;var Bt=gt._ptransform,kt=gt._transform;Bt._positionX=kt._positionX,Bt._positionY=kt._positionY,Bt._positionZ=kt._positionZ,Bt._rotation00=kt._rotation00,Bt._rotation01=kt._rotation01,Bt._rotation02=kt._rotation02,Bt._rotation10=kt._rotation10,Bt._rotation11=kt._rotation11,Bt._rotation12=kt._rotation12,Bt._rotation20=kt._rotation20,Bt._rotation21=kt._rotation21,Bt._rotation22=kt._rotation22;for(var St=gt._shapeList;null!=St;){var Xt,Yt,Nt,Lt,Gt,Wt,Dt,Tt,Vt,Kt,jt,Rt,Ht=St._next,Pt=St._ptransform,Ft=St._localTransform,Ot=gt._ptransform;Xt=Ot._rotation00*Ft._rotation00+Ot._rotation01*Ft._rotation10+Ot._rotation02*Ft._rotation20,Yt=Ot._rotation00*Ft._rotation01+Ot._rotation01*Ft._rotation11+Ot._rotation02*Ft._rotation21,Nt=Ot._rotation00*Ft._rotation02+Ot._rotation01*Ft._rotation12+Ot._rotation02*Ft._rotation22,Lt=Ot._rotation10*Ft._rotation00+Ot._rotation11*Ft._rotation10+Ot._rotation12*Ft._rotation20,Gt=Ot._rotation10*Ft._rotation01+Ot._rotation11*Ft._rotation11+Ot._rotation12*Ft._rotation21,Wt=Ot._rotation10*Ft._rotation02+Ot._rotation11*Ft._rotation12+Ot._rotation12*Ft._rotation22,Dt=Ot._rotation20*Ft._rotation00+Ot._rotation21*Ft._rotation10+Ot._rotation22*Ft._rotation20,Tt=Ot._rotation20*Ft._rotation01+Ot._rotation21*Ft._rotation11+Ot._rotation22*Ft._rotation21,Vt=Ot._rotation20*Ft._rotation02+Ot._rotation21*Ft._rotation12+Ot._rotation22*Ft._rotation22,Pt._rotation00=Xt,Pt._rotation01=Yt,Pt._rotation02=Nt,Pt._rotation10=Lt,Pt._rotation11=Gt,Pt._rotation12=Wt,Pt._rotation20=Dt,Pt._rotation21=Tt,Pt._rotation22=Vt,Kt=Ot._rotation00*Ft._positionX+Ot._rotation01*Ft._positionY+Ot._rotation02*Ft._positionZ,jt=Ot._rotation10*Ft._positionX+Ot._rotation11*Ft._positionY+Ot._rotation12*Ft._positionZ,Rt=Ot._rotation20*Ft._positionX+Ot._rotation21*Ft._positionY+Ot._rotation22*Ft._positionZ,Pt._positionX=Kt,Pt._positionY=jt,Pt._positionZ=Rt,Pt._positionX+=Ot._positionX,Pt._positionY+=Ot._positionY,Pt._positionZ+=Ot._positionZ;var Et,Ut,Jt,Qt,qt,$t,te,ee,ae,ie,ne,se,re,oe,le,_e,he,fe,ue=St._transform,ce=St._localTransform,de=gt._transform;if(Et=de._rotation00*ce._rotation00+de._rotation01*ce._rotation10+de._rotation02*ce._rotation20,Ut=de._rotation00*ce._rotation01+de._rotation01*ce._rotation11+de._rotation02*ce._rotation21,Jt=de._rotation00*ce._rotation02+de._rotation01*ce._rotation12+de._rotation02*ce._rotation22,Qt=de._rotation10*ce._rotation00+de._rotation11*ce._rotation10+de._rotation12*ce._rotation20,qt=de._rotation10*ce._rotation01+de._rotation11*ce._rotation11+de._rotation12*ce._rotation21,$t=de._rotation10*ce._rotation02+de._rotation11*ce._rotation12+de._rotation12*ce._rotation22,te=de._rotation20*ce._rotation00+de._rotation21*ce._rotation10+de._rotation22*ce._rotation20,ee=de._rotation20*ce._rotation01+de._rotation21*ce._rotation11+de._rotation22*ce._rotation21,ae=de._rotation20*ce._rotation02+de._rotation21*ce._rotation12+de._rotation22*ce._rotation22,ue._rotation00=Et,ue._rotation01=Ut,ue._rotation02=Jt,ue._rotation10=Qt,ue._rotation11=qt,ue._rotation12=$t,ue._rotation20=te,ue._rotation21=ee,ue._rotation22=ae,ie=de._rotation00*ce._positionX+de._rotation01*ce._positionY+de._rotation02*ce._positionZ,ne=de._rotation10*ce._positionX+de._rotation11*ce._positionY+de._rotation12*ce._positionZ,se=de._rotation20*ce._positionX+de._rotation21*ce._positionY+de._rotation22*ce._positionZ,ue._positionX=ie,ue._positionY=ne,ue._positionZ=se,ue._positionX+=de._positionX,ue._positionY+=de._positionY,ue._positionZ+=de._positionZ,St._geom._computeAabb(St._aabb,St._ptransform),re=St._aabb._minX,oe=St._aabb._minY,le=St._aabb._minZ,_e=St._aabb._maxX,he=St._aabb._maxY,fe=St._aabb._maxZ,St._geom._computeAabb(St._aabb,St._transform),St._aabb._minX=re<St._aabb._minX?re:St._aabb._minX,St._aabb._minY=oe<St._aabb._minY?oe:St._aabb._minY,St._aabb._minZ=le<St._aabb._minZ?le:St._aabb._minZ,St._aabb._maxX=_e>St._aabb._maxX?_e:St._aabb._maxX,St._aabb._maxY=he>St._aabb._maxY?he:St._aabb._maxY,St._aabb._maxZ=fe>St._aabb._maxZ?fe:St._aabb._maxZ,null!=St._proxy){var ge,pe,me;ge=St._transform._positionX-St._ptransform._positionX,pe=St._transform._positionY-St._ptransform._positionY,me=St._transform._positionZ-St._ptransform._positionZ;var ve=St.displacement;ve.x=ge,ve.y=pe,ve.z=me,St._rigidBody._world._broadPhase.moveProxy(St._proxy,St._aabb,St.displacement)}St=Ht}gt._sleeping=!1,gt._sleepTime=0,this.activate()},__class__:be});var S=function(){};(i["haxe.IMap"]=S).__name__=!0;var Y=function(t,e){this.high=t,this.low=e};(i["haxe._Int64.___Int64"]=Y).__name__=!0,Y.prototype={high:null,low:null,__class__:Y};var Fe=function(){};(i["haxe.Log"]=Fe).__name__=!0,Fe.formatOutput=function(t,e){var a=X.string(t);if(null==e)return a;var i=e.fileName+":"+e.lineNumber;if(null!=e&&null!=e.customParams)for(var n=0,s=e.customParams;n<s.length;){var r=s[n];++n,a+=", "+X.string(r)}return i+": "+a},Fe.trace=function(t,e){var a=Fe.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(a)};var N=function(){};(i["haxe._Unserializer.DefaultResolver"]=N).__name__=!0,N.prototype={resolveClass:function(t){return i[t]},resolveEnum:function(t){return I[t]},__class__:N};var Ut=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=Ut.DEFAULT_RESOLVER;null==e&&(e=new N,Ut.DEFAULT_RESOLVER=e),this.resolver=e};(i["haxe.Unserializer"]=Ut).__name__=!0,Ut.initCodes=function(){for(var t=[],e=0,a=Ut.BASE64.length;e<a;){var i=e++;t[Ut.BASE64.charCodeAt(i)]=i}return t},Ut.run=function(t){return new Ut(t).unserialize()},Ut.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var t=0,e=!1,a=this.pos;;){var i=this.buf.charCodeAt(this.pos);if(i!=i)break;if(45!=i){if(i<48||57<i)break;t=10*t+(i-48),this.pos++}else{if(this.pos!=a)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return parseFloat(q.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new Jt("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new Jt("Invalid object key");var a=this.unserialize();t[e]=a}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new Jt("Invalid enum format");var a=this.readDigits();if(0==a)return E.createEnum(t,e);for(var i=[];0<a--;)i.push(this.unserialize());return E.createEnum(t,e,i)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new Jt("Class not found "+t);return e;case 66:var a=this.unserialize(),i=this.resolver.resolveEnum(a);if(null==i)throw new Jt("Enum not found "+a);return i;case 67:var n=this.unserialize(),s=this.resolver.resolveClass(n);if(null==s)throw new Jt("Class not found "+n);var r=Object.create(s.prototype);if(this.cache.push(r),r.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new Jt("Invalid custom data");return r;case 77:var o=new Be;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var _=this.readDigits();if(_<0||_>=this.scache.length)throw new Jt("Invalid string reference");return this.scache[_];case 97:this.buf;var h=[];for(this.cache.push(h);;){var f=this.buf.charCodeAt(this.pos);if(104==f){this.pos++;break}if(117==f){this.pos++;var u=this.readDigits();h[h.length+u-1]=null}else h.push(this.unserialize())}return h;case 98:var c=new et;this.cache.push(c);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var d=this.unserialize(),g=this.unserialize();null!=fs[d]?c.setReserved(d,g):c.h[d]=g}return this.pos++,c;case 99:var p=this.unserialize(),m=this.resolver.resolveClass(p);if(null==m)throw new Jt("Class not found "+p);var v=Object.create(m.prototype);return this.cache.push(v),this.unserializeObject(v),v;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var b=this.unserialize(),I=this.resolver.resolveEnum(b);if(null==I)throw new Jt("Enum not found "+b);this.pos++;var M=this.readDigits(),y=I.__constructs__.slice()[M];if(null==y)throw new Jt("Unknown enum index "+b+"@"+M);var w=this.unserializeEnum(I,y);return this.cache.push(w),w;case 107:return NaN;case 108:var x=new tt;this.cache.push(x);for(this.buf;104!=this.buf.charCodeAt(this.pos);)x.add(this.unserialize());return this.pos++,x;case 109:return-1/0;case 110:return null;case 111:var C={};return this.cache.push(C),this.unserializeObject(C),C;case 112:return 1/0;case 113:var A=new $;this.cache.push(A);this.buf;for(var Z=this.buf.charCodeAt(this.pos++);58==Z;){var z=this.readDigits(),B=this.unserialize();A.h[z]=B,Z=this.buf.charCodeAt(this.pos++)}if(104!=Z)throw new Jt("Invalid IntMap format");return A;case 114:var k=this.readDigits();if(k<0||k>=this.cache.length)throw new Jt("Invalid reference");return this.cache[k];case 115:var S=this.readDigits(),X=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<S)throw new Jt("Invalid bytes length");var Y=Ut.CODES;null==Y&&(Y=Ut.initCodes(),Ut.CODES=Y);for(var N=this.pos,L=3&S,G=N+(S-L),W=new nt(new us(3*(S>>2)+(2<=L?L-1:0))),D=0;N<G;){var T=Y[X.charCodeAt(N++)],V=Y[X.charCodeAt(N++)];W.b[D++]=255&(T<<2|V>>4);var K=Y[X.charCodeAt(N++)];W.b[D++]=255&(V<<4|K>>2);var j=Y[X.charCodeAt(N++)];W.b[D++]=255&(K<<6|j)}if(2<=L){var R=Y[X.charCodeAt(N++)],H=Y[X.charCodeAt(N++)];if(W.b[D++]=255&(R<<2|H>>4),3==L){var P=Y[X.charCodeAt(N++)];W.b[D++]=255&(H<<4|P>>2)}}return this.pos+=S,this.cache.push(W),W;case 116:return!0;case 118:var F;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(F=q.strDate(q.substr(this.buf,this.pos,19)),this.pos+=19):F=new Date(this.readFloat()),this.cache.push(F),F;case 119:var O=this.unserialize(),E=this.resolver.resolveEnum(O);if(null==E)throw new Jt("Enum not found "+O);var U=this.unserializeEnum(E,this.unserialize());return this.cache.push(U),U;case 120:throw Jt.wrap(this.unserialize());case 121:var J=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<J)throw new Jt("Invalid string length");var Q=q.substr(this.buf,this.pos,J);return this.pos+=J,Q=decodeURIComponent(Q.split("+").join(" ")),this.scache.push(Q),Q;case 122:return 0}throw this.pos--,new Jt("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:Ut};var nt=function(t){this.length=t.byteLength,this.b=new gs(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(i["haxe.io.Bytes"]=nt).__name__=!0,nt.ofData=function(t){var e=t.hxBytes;return null!=e?e:new nt(t)},nt.prototype={length:null,b:null,data:null,blit:function(t,e,a,i){if(t<0||a<0||i<0||t+i>this.length||a+i>e.length)throw new Jt(j.OutsideBounds);0==a&&i==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(a,a+i),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new Jt(j.OutsideBounds);return new nt(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},getFloat:function(t){return null==this.data&&(this.data=new cs(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},setInt32:function(t,e){null==this.data&&(this.data=new cs(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(t,e,!0)},getString:function(t,e){if(t<0||e<0||t+e>this.length)throw new Jt(j.OutsideBounds);for(var a="",i=this.b,n=String.fromCharCode,s=t,r=t+e;s<r;){var o=i[s++];if(o<128){if(0==o)break;a+=n(o)}else if(o<224)a+=n((63&o)<<6|127&i[s++]);else if(o<240){a+=n((31&o)<<12|(127&i[s++])<<6|127&i[s++])}else{var l=(15&o)<<18|(127&i[s++])<<12|(127&i[s++])<<6|127&i[s++];a+=n(55232+(l>>10)),a+=n(1023&l|56320)}}return a},toString:function(){return this.getString(0,this.length)},__class__:nt};var $=function(){this.h={}};(i["haxe.ds.IntMap"]=$).__name__=!0,$.__interfaces__=[S],$.prototype={h:null,remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return q.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:$};var tt=function(){this.length=0};(i["haxe.ds.List"]=tt).__name__=!0,tt.prototype={h:null,q:null,length:null,add:function(t){var e=new L(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},iterator:function(){return new G(this.h)},__class__:tt};var L=function(t,e){this.item=t,this.next=e};(i["haxe.ds._List.ListNode"]=L).__name__=!0,L.prototype={item:null,next:null,__class__:L};var G=function(t){this.head=t};(i["haxe.ds._List.ListIterator"]=G).__name__=!0,G.prototype={head:null,hasNext:function(){return null!=this.head},next:function(){var t=this.head.item;return this.head=this.head.next,t},__class__:G};var Be=function(){this.h={__keys__:{}}};(i["haxe.ds.ObjectMap"]=Be).__name__=!0,Be.__interfaces__=[S],Be.prototype={h:null,set:function(t,e){var a=t.__id__||(t.__id__=++Be.count);this.h[a]=e,this.h.__keys__[a]=t},__class__:Be};var W=function(t,e){this.map=t,this.keys=e,this.index=0,this.count=e.length};(i["haxe.ds._StringMap.StringMapIterator"]=W).__name__=!0,W.prototype={map:null,keys:null,index:null,count:null,hasNext:function(){return this.index<this.count},next:function(){var t=this.map,e=this.keys[this.index++];return null!=fs[e]?t.getReserved(e):t.h[e]},__class__:W};var et=function(){this.h={}};(i["haxe.ds.StringMap"]=et).__name__=!0,et.__interfaces__=[S],et.prototype={h:null,rh:null,setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},remove:function(t){return null!=fs[t]?(t="$"+t,!(null==this.rh||!this.rh.hasOwnProperty(t))&&(delete this.rh[t],!0)):!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},arrayKeys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(e);if(null!=this.rh)for(var e in this.rh)36==e.charCodeAt(0)&&t.push(e.substr(1));return t},__class__:et};var D=function(){this.pos=0,this.size=0};(i["haxe.io.BytesBuffer"]=D).__name__=!0,D.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},addBytes:function(t,e,a){if(e<0||a<0||e+a>t.length)throw new Jt(j.OutsideBounds);if(this.pos+a>this.size&&this.grow(a),0!=this.size){var i=new gs(t.b.buffer,t.b.byteOffset+e,a);this.u8.set(i,this.pos),this.pos+=a}},grow:function(t){for(var e=this.pos+t,a=0==this.size?16:this.size;a<e;)a=3*a>>1;var i=new us(a),n=new gs(i);0<this.size&&n.set(this.u8),this.size=a,this.buffer=i,this.u8=n,this.view=new cs(this.buffer)},getBytes:function(){if(0==this.size)return new nt(new us(0));var t=new nt(this.buffer);return t.length=this.pos,t},__class__:D};var T=function(){};(i["haxe.io.Input"]=T).__name__=!0,T.prototype={bigEndian:null,readByte:function(){throw new Jt("Not implemented")},readBytes:function(t,e,a){var i=a,n=t.b;if(e<0||a<0||e+a>t.length)throw new Jt(j.OutsideBounds);try{for(;0<i;)n[e]=this.readByte(),++e,--i}catch(t){var s=t instanceof Jt?t.val:t;if(!(s instanceof K))throw t}return a-i},set_bigEndian:function(t){return this.bigEndian=t},readFullBytes:function(t,e,a){for(;0<a;){var i=this.readBytes(t,e,a);if(0==i)throw new Jt(j.Blocked);e+=i,a-=i}},read:function(t){for(var e=new nt(new us(t)),a=0;0<t;){var i=this.readBytes(e,a,t);if(0==i)throw new Jt(j.Blocked);a+=i,t-=i}return e},readFloat:function(){return R.i32ToFloat(this.readInt32())},readInt8:function(){var t=this.readByte();return 128<=t?t-256:t},readInt16:function(){var t=this.readByte(),e=this.readByte(),a=this.bigEndian?e|t<<8:t|e<<8;return 0!=(32768&a)?a-65536:a},readUInt16:function(){var t=this.readByte(),e=this.readByte();return this.bigEndian?e|t<<8:t|e<<8},readInt32:function(){var t=this.readByte(),e=this.readByte(),a=this.readByte(),i=this.readByte();return this.bigEndian?i|a<<8|e<<16|t<<24:t|e<<8|a<<16|i<<24},readString:function(t){var e=new nt(new us(t));return this.readFullBytes(e,0,t),e.toString()},__class__:T,__properties__:{set_bigEndian:"set_bigEndian"}};var st=function(t,e,a){if(null==e&&(e=0),null==a&&(a=t.length-e),e<0||a<0||e+a>t.length)throw new Jt(j.OutsideBounds);this.b=t.b,this.pos=e,this.len=a,this.totlen=a};(i["haxe.io.BytesInput"]=st).__name__=!0,st.__super__=T,st.prototype=s(T.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(t){return t<0?t=0:t>this.totlen&&(t=this.totlen),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new Jt(new K);return this.len--,this.b[this.pos++]},readBytes:function(t,e,a){if(e<0||a<0||e+a>t.length)throw new Jt(j.OutsideBounds);if(0==this.len&&0<a)throw new Jt(new K);this.len<a&&(a=this.len);for(var i=this.b,n=t.b,s=0,r=a;s<r;){var o=s++;n[e+o]=i[this.pos+o]}return this.pos+=a,this.len-=a,a},__class__:st,__properties__:s(T.prototype.__properties__,{set_position:"set_position"})});var V=function(){};(i["haxe.io.Output"]=V).__name__=!0,V.prototype={bigEndian:null,writeByte:function(t){throw new Jt("Not implemented")},writeBytes:function(t,e,a){if(e<0||a<0||e+a>t.length)throw new Jt(j.OutsideBounds);for(var i=t.b,n=a;0<n;)this.writeByte(i[e]),++e,--n;return a},write:function(t){for(var e=t.length,a=0;0<e;){var i=this.writeBytes(t,a,e);if(0==i)throw new Jt(j.Blocked);a+=i,e-=i}},writeFloat:function(t){this.writeInt32(R.floatToI32(t))},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},__class__:V};var rt=function(){this.b=new D};(i["haxe.io.BytesOutput"]=rt).__name__=!0,rt.__super__=V,rt.prototype=s(V.prototype,{b:null,writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,a){return this.b.addBytes(t,e,a),a},getBytes:function(){return this.b.getBytes()},__class__:rt});var K=function(){};(i["haxe.io.Eof"]=K).__name__=!0,K.prototype={toString:function(){return"Eof"},__class__:K};var j=I["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(a=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:n}},a.__params__=["e"],a)},R=function(){};(i["haxe.io.FPHelper"]=R).__name__=!0,R.i32ToFloat=function(t){return R.helper.setInt32(0,t,!0),R.helper.getFloat32(0,!0)},R.floatToI32=function(t){return R.helper.setFloat32(0,t,!0),R.helper.getInt32(0,!0)};var H={};(i["haxe.io._UInt8Array.UInt8Array_Impl_"]=H).__name__=!0,H.fromBytes=function(t,e,a){return null==e&&(e=0),null==a&&(a=t.length-e),new gs(t.b.bufferValue,e,a)};var P=function(t){t(),co.notifyOnFrames(P.render),uo.addTimeTask(P.update,0,.016666666666666666*fo.scale)};(i["iron.App"]=P).__name__=!0,P.init=function(t){new P(t)},P.update=function(){if(null!=h_.active&&h_.active.ready&&!P.pauseUpdates){fo.update(),h_.active.updateFrame();for(var t=0,e=P.traitUpdates.length;t<e;){if(0<P.traitInits.length){for(var a=0,i=P.traitInits;a<i.length;){var n=i[a];if(++a,!(0<P.traitInits.length))break;n()}P.traitInits.splice(0,P.traitInits.length)}P.traitUpdates[t](),e<=P.traitUpdates.length?++t:e=P.traitUpdates.length}for(t=0,e=P.traitLateUpdates.length;t<e;)P.traitLateUpdates[t](),e<=P.traitLateUpdates.length?++t:e=P.traitLateUpdates.length;if(null!=P.onEndFrames)for(var s=0,r=P.onEndFrames;s<r.length;){var o=r[s];++s,o()}-1==P.lastw&&(P.lastw=co.windowWidth(),P.lasth=co.windowHeight()),P.lastw==co.windowWidth()&&P.lasth==co.windowHeight()||null!=h_.active&&null!=h_.active.camera&&h_.active.camera.buildProjection(),P.lastw=co.windowWidth(),P.lasth=co.windowHeight()}},P.render=function(t){var e=t[0];if(P.framebuffer=e,null!=h_.active&&h_.active.ready){if(0<P.traitInits.length){for(var a=0,i=P.traitInits;a<i.length;){var n=i[a];if(++a,!(0<P.traitInits.length))break;n()}P.traitInits.splice(0,P.traitInits.length)}h_.active.renderFrame(e.get_g4());for(var s=0,r=P.traitRenders;s<r.length;){var o=r[s];if(++s,!(0<P.traitRenders.length))break;o(e.get_g4())}P.render2D(e)}else P.render2D(e)},P.render2D=function(t){if(0<P.traitRenders2D.length){t.get_g2().begin(!1);for(var e=0,a=P.traitRenders2D;e<a.length;){var i=a[e];if(++e,!(0<P.traitRenders2D.length))break;i(t.get_g2())}t.get_g2().end()}},P.notifyOnInit=function(t){P.traitInits.push(t)},P.removeInit=function(t){q.remove(P.traitInits,t)},P.notifyOnUpdate=function(t){P.traitUpdates.push(t)},P.removeUpdate=function(t){q.remove(P.traitUpdates,t)},P.removeLateUpdate=function(t){q.remove(P.traitLateUpdates,t)},P.removeRender=function(t){q.remove(P.traitRenders,t)},P.notifyOnRender2D=function(t){P.traitRenders2D.push(t)},P.removeRender2D=function(t){q.remove(P.traitRenders2D,t)},P.notifyOnReset=function(t){null==P.onResets&&(P.onResets=[]),P.onResets.push(t)},P.notifyOnEndFrame=function(t){null==P.onEndFrames&&(P.onEndFrames=[]),P.onEndFrames.push(t)},P.prototype={__class__:P};var _o=function(){this.depthBuffers=[],this.depthToRenderTarget=new et,this.renderTargets=new et,this.commands=null,this.cachedShaderContexts=new et,this.loading=0,this.paused=!1,this.drawOrder=1,this.lastFrameTime=0,this.viewportScaled=!1,this.scissorSet=!1,this.lastH=0,this.lastW=0,this.currentLightIndex=0,this.currentTarget=null,this.frameTime=0,this.frameScissorH=0,this.frameScissorW=0,this.frameScissorY=0,this.frameScissorX=0,this.frameScissor=!1};(i["iron.RenderPath"]=_o).__name__=!0,_o.setActive=function(t){_o.active=t},_o.sortMeshesDistance=function(t,e){for(var a=e.transform.world.self._30,i=e.transform.world.self._31,n=e.transform.world.self._32,s=0;s<t.length;){var r=t[s];++s;var o=a-r.transform.world.self._30,l=i-r.transform.world.self._31,_=n-r.transform.world.self._32;r.cameraDistance=Math.sqrt(o*o+l*l+_*_)}t.sort(function(t,e){return t.cameraDistance>=e.cameraDistance?1:-1})},_o.sortMeshesShader=function(t){h_.active.meshes.sort(function(t,e){return t.materials[0].name>=e.materials[0].name?1:-1})},_o.prototype={frameScissor:null,frameScissorX:null,frameScissorY:null,frameScissorW:null,frameScissorH:null,frameTime:null,currentTarget:null,currentCube:null,currentFace:null,currentLightIndex:null,currentW:null,currentH:null,currentD:null,lastW:null,lastH:null,bindParams:null,meshesSorted:null,scissorSet:null,viewportScaled:null,currentG:null,frameG:null,lastFrameTime:null,drawOrder:null,paused:null,get_ready:function(){return 0==this.loading},loading:null,cachedShaderContexts:null,commands:null,renderTargets:null,depthToRenderTarget:null,renderFrame:function(t){if(this.get_ready()&&!this.paused&&0!=co.windowWidth()&&0!=co.windowHeight()){0<this.lastW&&(this.lastW!=co.windowWidth()||this.lastH!=co.windowHeight())&&this.resize(),this.lastW=co.windowWidth(),this.lastH=co.windowHeight(),this.frameTime=uo.time()-this.lastFrameTime,this.lastFrameTime=uo.time(),this.frameG=null==h_.active.camera||null==h_.active.camera.data.renderTarget?t:h_.active.camera.data.renderTarget.get_g4(),this.currentG=this.frameG,this.currentW=co.windowWidth(),this.currentH=co.windowHeight(),this.currentD=1,this.currentCube=!1,this.currentFace=-1,this.meshesSorted=!1;for(var e=this.currentLightIndex=0,a=h_.active.lights;e<a.length;){var i=a[e];++e,i.visible&&i.buildMatrices(h_.active.camera)}this.commands()}},setTarget:function(t,e,a){if(null==a&&(a=1),""==t){this.currentG=this.frameG,this.currentW=co.windowWidth(),this.currentH=co.windowHeight(),this.currentD=1,this.currentTarget=null,this.currentCube=!1,this.currentFace=-1,this.frameScissor&&this.setFrameScissor(),this.currentG.begin(null)}else{var i=this.renderTargets,n=null!=fs[t]?i.getReserved(t):i.h[t];this.currentTarget=n;var s=null;if(null!=e){s=[];for(var r=0;r<e.length;){var o=e[r];++r;var l=this.renderTargets,_=null!=fs[o]?l.getReserved(o):l.h[o];s.push(_.image)}}this.currentG=n.isCubeMap?n.cubeMap.get_g4():n.image.get_g4(),this.currentW=n.isCubeMap?n.cubeMap.get_width():n.image.get_width(),this.currentH=n.isCubeMap?n.cubeMap.get_height():n.image.get_height(),n.is3D&&(this.currentD=n.image.get_depth()),this.currentCube=n.isCubeMap;var h=this.currentG,f=this.currentFace;0<=f?h.beginFace(5-f):h.begin(s)}if(1!=a){this.viewportScaled=!0;var u=this.currentW*a|0,c=this.currentH*a|0;this.currentG.viewport(0,c,u,c),this.currentG.scissor(0,c,u,c)}else this.viewportScaled&&(this.viewportScaled=!1,this.setCurrentViewport(this.currentW,this.currentH),this.setCurrentScissor(this.currentW,this.currentH));this.bindParams=null},setCurrentViewport:function(t,e){this.currentG.viewport(0,this.currentH-e,t,e)},setCurrentScissor:function(t,e){this.currentG.scissor(0,this.currentH-e,t,e),this.scissorSet=!0},setFrameScissor:function(){this.frameG.scissor(this.frameScissorX,this.currentH-(this.frameScissorH-this.frameScissorY),this.frameScissorW,this.frameScissorH)},clearTarget:function(t,e){if(-1==t)if(null!=h_.active.world)t=h_.active.world.raw.background_color;else if(null!=h_.active.camera){var a=h_.active.camera.data.raw.clear_color;null!=a&&(t=ie.fromFloats(a[0],a[1],a[2]))}this.currentG.clear(t,e,null)},drawMeshes:function(t){var e=0<h_.active.lights.length?h_.active.lights[this.currentLightIndex]:null;if((null==e||e.visible||!(0<this.currentLightIndex))&&(!("shadowmap"==t)||null!=e&&e.data.raw.cast_shadow)){0<=this.currentFace&&null!=e&&e.setCubeFace(5-this.currentFace,h_.active.camera);var a=this.currentG;this.submitDraw(t),a.end(),this.scissorSet&&(a.disableScissor(),this.scissorSet=!1),this.bindParams=null}},submitDraw:function(t){var e=0<h_.active.lights.length?h_.active.lights[this.currentLightIndex]:null,a=this.currentG;u_.lastPipeline=null,this.meshesSorted||null==h_.active.camera||(1==this.drawOrder?_o.sortMeshesShader(h_.active.meshes):_o.sortMeshesDistance(h_.active.meshes,h_.active.camera),this.meshesSorted=!0);for(var i=0,n=h_.active.meshes;i<n.length;){var s=n[i];++i,s.render(a,t,h_.active.camera,e,this.bindParams)}},bindTarget:function(t,e){null!=this.bindParams?(this.bindParams.push(t),this.bindParams.push(e)):this.bindParams=[t,e]},drawShader:function(t){var e=this.cachedShaderContexts,a=null!=fs[t]?e.getReserved(t):e.h[t];null==ot.screenAlignedVB&&ot.createScreenAlignedData();var i=this.currentG;i.setPipeline(a.context.pipeState);var n=0<h_.active.lights.length?h_.active.lights[this.currentLightIndex]:null;c_.setContextConstants(i,a.context,h_.active.camera,n,this.bindParams),c_.setObjectConstants(i,a.context,null,h_.active.camera,n),i.setVertexBuffer(ot.screenAlignedVB),i.setIndexBuffer(ot.screenAlignedIB),i.drawIndexedVertices(),i.end(),this.scissorSet&&(i.disableScissor(),this.scissorSet=!1),this.bindParams=null},loadShader:function(t){var e=this;this.loading++;var a=this.cachedShaderContexts,i=null!=fs[t]?a.getReserved(t):a.h[t];if(null==i){i=new J;var n=this.cachedShaderContexts;null!=fs[t]?n.setReserved(t,i):n.h[t]=i;var s=t.split("/");at.getShader(s[0],s[1],function(t){i.context=t.getContext(s[2]),e.loading--})}else this.loading--},resize:function(){for(var t=this.renderTargets,e=new W(t,t.arrayKeys());e.hasNext();){var a=e.next();if(0==a.raw.width&&(a.image.unload(),a.image=this.createImage(a.raw,a.depthStencil),""!=a.depthStencilFrom)){var i=a.depthStencilFrom,n=this.depthToRenderTarget;a.image.setDepthStencilFrom((null!=fs[i]?n.getReserved(i):n.h[i]).image)}}},createRenderTarget:function(t){var e=this.createTarget(t),a=t.name,i=this.renderTargets;return null!=fs[a]?i.setReserved(a,e):i.h[a]=e,e},depthBuffers:null,createDepthBuffer:function(t,e){this.depthBuffers.push({name:t,format:e})},createTarget:function(t){var e=new U(t);if(null!=t.depth_buffer){e.hasDepth=!0;var a=t.depth_buffer,i=this.depthToRenderTarget,n=null!=fs[a]?i.getReserved(a):i.h[a];if(null==n)for(var s=0,r=this.depthBuffers;s<r.length;){var o=r[s];if(++s,o.name==t.depth_buffer){var l=o.name,_=this.depthToRenderTarget;null!=fs[l]?_.setReserved(l,e):_.h[l]=e;var h,f=o.format;if(null==f||""==f)h=1;else switch(f){case"DEPTH16":h=5;break;case"DEPTH24":h=1;break;default:h=1}e.depthStencil=h,e.image=this.createImage(t,e.depthStencil);break}}else e.depthStencil=0,e.depthStencilFrom=t.depth_buffer,e.image=this.createImage(t,e.depthStencil),e.image.setDepthStencilFrom(n.image)}else e.hasDepth=!1,null!=t.depth&&1<t.depth&&(e.is3D=!0),t.is_cubemap?(e.isCubeMap=!0,e.depthStencil=0,e.cubeMap=this.createCubeMap(t,e.depthStencil)):(e.depthStencil=0,e.image=this.createImage(t,e.depthStencil));return e},createImage:function(t,e){var a,i=0==t.width?co.windowWidth():t.width,n=0==t.height?co.windowHeight():t.height,s=null!=t.depth?t.depth:0;if(null!=t.displayp&&(n<i?(i=i*(t.displayp/n)|0,n=t.displayp):(n=n*(t.displayp/i)|0,i=t.displayp)),null!=t.scale&&(i=i*t.scale|0,n=n*t.scale|0,s=s*t.scale|0),null!=t.depth&&1<t.depth){var r;if(null!=t.format){var o;switch(t.format){case"A16":o=Va.A16;break;case"A32":o=Va.A32;break;case"A8":o=Va.L8;break;case"DEPTH16":o=Va.DEPTH16;break;case"R16":o=Va.A16;break;case"R32":o=Va.A32;break;case"R8":o=Va.L8;break;case"RGBA128":o=Va.RGBA128;break;case"RGBA32":o=Va.RGBA32;break;case"RGBA64":o=Va.RGBA64;break;default:o=Va.RGBA32}r=o}else r=Va.RGBA32;var l=ee.create3D(i,n,s,r);return t.mipmaps&&l.generateMipmaps(1e3),l}if(null!=t.is_image&&t.is_image){var _;if(null!=t.format){var h;switch(t.format){case"A16":h=Va.A16;break;case"A32":h=Va.A32;break;case"A8":h=Va.L8;break;case"DEPTH16":h=Va.DEPTH16;break;case"R16":h=Va.A16;break;case"R32":h=Va.A32;break;case"R8":h=Va.L8;break;case"RGBA128":h=Va.RGBA128;break;case"RGBA32":h=Va.RGBA32;break;case"RGBA64":h=Va.RGBA64;break;default:h=Va.RGBA32}_=h}else _=Va.RGBA32;return ee.create(i,n,_)}if(null!=t.format){var f;switch(t.format){case"A16":f=Va.A16;break;case"A32":f=Va.A32;break;case"A8":f=Va.L8;break;case"DEPTH16":f=Va.DEPTH16;break;case"R16":f=Va.A16;break;case"R32":f=Va.A32;break;case"R8":f=Va.L8;break;case"RGBA128":f=Va.RGBA128;break;case"RGBA32":f=Va.RGBA32;break;case"RGBA64":f=Va.RGBA64;break;default:f=Va.RGBA32}a=f}else a=Va.RGBA32;return ee.createRenderTarget(i,n,a,e)},createCubeMap:function(t,e){var a;if(null!=t.format){var i;switch(t.format){case"A16":i=Va.A16;break;case"A32":i=Va.A32;break;case"A8":i=Va.L8;break;case"DEPTH16":i=Va.DEPTH16;break;case"R16":i=Va.A16;break;case"R32":i=Va.A32;break;case"R8":i=Va.L8;break;case"RGBA128":i=Va.RGBA128;break;case"RGBA32":i=Va.RGBA32;break;case"RGBA64":i=Va.RGBA64;break;default:i=Va.RGBA32}a=i}else a=Va.RGBA32;return ya.createRenderTarget(t.width,a,e)},__class__:_o,__properties__:{get_ready:"get_ready"}};var F=function(){this.is_cubemap=null,this.is_image=null,this.depth=null,this.mipmaps=null,this.depth_buffer=null,this.displayp=null,this.scale=null,this.format=null};(i["iron.RenderTargetRaw"]=F).__name__=!0,F.prototype={name:null,width:null,height:null,format:null,scale:null,displayp:null,depth_buffer:null,mipmaps:null,depth:null,is_image:null,is_cubemap:null,__class__:F};var U=function(t){this.isCubeMap=!1,this.is3D=!1,this.hasDepth=!1,this.cubeMap=null,this.image=null,this.depthStencilFrom="",this.raw=t};(i["iron.RenderTarget"]=U).__name__=!0,U.prototype={raw:null,depthStencil:null,depthStencilFrom:null,image:null,cubeMap:null,hasDepth:null,is3D:null,isCubeMap:null,__class__:U};var J=function(){};(i["iron.CachedShaderContext"]=J).__name__=!0,J.prototype={context:null,__class__:J};var h_=function(){this.traitRemoves=[],this.traitInits=[],this.groups=null,this.uid=h_.uidCounter++,this.meshes=[],this.lights=[],this.cameras=[],this.speakers=[],this.decals=[],this.empties=[],this.animations=[],this.armatures=[],this.embedded=new et,this.root=new mt,this.root.name="Root",this.traitInits=[],this.traitRemoves=[],null==h_.global&&(h_.global=new mt)};(i["iron.Scene"]=h_).__name__=!0,h_.create=function(n,s){h_.active=new h_,h_.active.ready=!1,h_.active.raw=n,at.getWorld(n.name,n.world_ref,function(t){h_.active.world=t,h_.active.addScene(n.name,null,function(t){0==h_.active.cameras.length&&Fe.trace('No camera found for scene "'+n.name+'"',{fileName:"Sources/iron/Scene.hx",lineNumber:81,className:"iron.Scene",methodName:"create"}),h_.active.camera=h_.active.getCamera(n.camera_ref),h_.active.ready=!0;for(var e=0,a=h_.active.traitInits;e<a.length;){var i=a[e];++e,i()}h_.active.traitInits=[],h_.active.sceneParent=t,s(t)})})},h_.setActive=function(t,e){h_.framePassed&&(h_.framePassed=!1,null!=h_.active&&h_.active.remove(),at.getSceneRaw(t,function(t){h_.create(t,function(t){null!=e&&e(t)})}))},h_.generateTransform=function(t,e){var a;if(null!=t.transform){var i=t.transform.values;a=new da(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}else a=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);e.world=a;var n=e.world,s=e.loc,r=e.rot,o=e.scale;s.x=n.self._30,s.y=n.self._31,s.z=n.self._32;var l=da.helpVec;l.x=n.self._00,l.y=n.self._01,l.z=n.self._02,l.w=1;var _=l;o.x=Math.sqrt(_.x*_.x+_.y*_.y+_.z*_.z);var h=da.helpVec;h.x=n.self._10,h.y=n.self._11,h.z=n.self._12,h.w=1;var f=h;o.y=Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z);var u=da.helpVec;u.x=n.self._20,u.y=n.self._21,u.z=n.self._22,u.w=1;var c=u;o.z=Math.sqrt(c.x*c.x+c.y*c.y+c.z*c.z);var d=n.self,g=d._12,p=d._22,m=d._32,v=d._13,b=d._23,I=d._33,M=d._11*(p*I-m*b)-d._21*(g*I-m*v)+d._31*(g*b-p*v),y=d._12,w=d._22,x=d._32,C=d._13,A=d._23,Z=d._33,z=d._10*(w*Z-x*A)-d._20*(y*Z-x*C)+d._30*(y*A-w*C),B=d._11,k=d._21,S=d._31,X=d._13,Y=d._23,N=d._33,L=d._10*(k*N-S*Y)-d._20*(B*N-S*X)+d._30*(B*Y-k*X),G=d._11,W=d._21,D=d._31,T=d._12,V=d._22,K=d._32,j=d._10*(W*K-D*V)-d._20*(G*K-D*T)+d._30*(G*V-W*T);d._00*M-d._01*z+d._02*L-d._03*j<0&&(o.x=-o.x);var R=1/o.x;da.helpMat.self._00=n.self._00*R,da.helpMat.self._01=n.self._01*R,da.helpMat.self._02=n.self._02*R,R=1/o.y,da.helpMat.self._10=n.self._10*R,da.helpMat.self._11=n.self._11*R,da.helpMat.self._12=n.self._12*R,R=1/o.z,da.helpMat.self._20=n.self._20*R,da.helpMat.self._21=n.self._21*R,da.helpMat.self._22=n.self._22*R;var H=da.helpMat,P=H.self._00,F=H.self._10,O=H.self._20,E=H.self._01,U=H.self._11,J=H.self._21,Q=H.self._02,q=H.self._12,$=H.self._22,tt=P+U+$,et=0;0<tt?(et=.5/Math.sqrt(tt+1),r.w=.25/et,r.x=(q-J)*et,r.y=(O-Q)*et,r.z=(E-F)*et):U<P&&$<P?(et=2*Math.sqrt(1+P-U-$),r.w=(q-J)/et,r.x=.25*et,r.y=(F+E)/et,r.z=(O+Q)/et):$<U?(et=2*Math.sqrt(1+U-P-$),r.w=(O-Q)/et,r.x=(F+E)/et,r.y=.25*et,r.z=(J+q)/et):(et=2*Math.sqrt(1+$-P-U),r.w=(E-F)/et,r.x=(O+Q)/et,r.y=(J+q)/et,r.z=.25*et),null!=t.local_only&&(e.localOnly=t.local_only),null!=e.object.parent&&e.update()},h_.createTraits=function(t,e){if(null!=t)for(var a=0;a<t.length;){var i=t[a];if(++a,"Script"==i.type){var n=[];if(null!=i.parameters)for(var s=0,r=i.parameters;s<r.length;){var o=r[s];++s,n.push(h_.parseArg(o))}var l=h_.createTraitClassInstance(i.class_name,n);if(null==l){Fe.trace("Error: Trait '"+i.class_name+"' referenced in object '"+e.name+"' not found",{fileName:"Sources/iron/Scene.hx",lineNumber:597,className:"iron.Scene",methodName:"createTraits"});continue}if(null!=i.props)for(var _=0,h=i.props.length/2|0;_<h;){var f=_++,u=i.props[2*f],c=i.props[2*f+1];""!=c&&Ft.setProperty(l,u,h_.parseArg(c))}e.addTrait(l)}}},h_.parseArg=function(t){if("true"==t)return!0;if("false"==t)return!1;if("null"==t)return null;if("'"==t.charAt(0))return O.replace(t,"'","");if('"'==t.charAt(0))return O.replace(t,'"',"");if("["==t.charAt(0)){t=O.replace(t,"[",""),t=O.replace(t,"]","");for(var e=[],a=(t=O.replace(t," ","")).split(","),i=0;i<a.length;){var n=a[i];++i,e.push(h_.parseArg(n))}return e}var s=parseFloat(t),r=X.parseInt(t);return s==r?r:s},h_.createConstraints=function(t,e){if(null!=t){e.constraints=[];for(var a=0;a<t.length;){var i=t[a];++a;var n=new It(i);e.constraints.push(n)}}},h_.createTraitClassInstance=function(t,e){var a=i[t];return null==a?null:E.createInstance(a,e)},h_.prototype={uid:null,raw:null,root:null,sceneParent:null,camera:null,world:null,meshes:null,lights:null,cameras:null,speakers:null,decals:null,empties:null,animations:null,armatures:null,groups:null,embedded:null,ready:null,traitInits:null,traitRemoves:null,remove:function(){for(var t=0,e=this.traitRemoves;t<e.length;){var a=e[t];++t,a()}for(var i=0,n=this.meshes;i<n.length;){var s=n[i];++i,s.remove()}for(var r=0,o=this.lights;r<o.length;){var l=o[r];++r,l.remove()}for(var _=0,h=this.cameras;_<h.length;){var f=h[_];++_,f.remove()}for(var u=0,c=this.speakers;u<c.length;){var d=c[u];++u,d.remove()}for(var g=0,p=this.decals;g<p.length;){var m=p[g];++g,m.remove()}for(var v=0,b=this.empties;v<b.length;){var I=b[v];++v,I.remove()}this.groups=null,this.root.remove()},updateFrame:function(){if(this.ready){for(var t=0,e=this.animations;t<e.length;){var a=e[t];++t,a.update(.016666666666666666*fo.scale)}for(var i=0,n=this.empties;i<n.length;){var s=n[i];++i,null!=s&&null!=s.parent&&s.transform.update()}}},renderFrame:function(t){if(this.ready&&null!=_o.active){h_.framePassed=!0;for(var e=this.camera,a=0,i=this.cameras;a<i.length;){var n=i[a];++a,null!=n.data.renderTarget&&(this.camera=n,this.camera.renderFrame(t))}this.camera=e,null!=this.camera?this.camera.renderFrame(t):_o.active.renderFrame(t)}},addObject:function(t){var e=new mt;return null!=t?t.addChild(e):this.root.addChild(e),e},getChild:function(t){return this.root.getChild(t)},getCamera:function(t){for(var e=0,a=this.cameras;e<a.length;){var i=a[e];if(++e,i.name==t)return i}return null},addMeshObject:function(t,e,a){var i=new u_(t,e);return null!=a?a.addChild(i):this.root.addChild(i),i},addLightObject:function(t,e){var a=new sa(t);return null!=e?e.addChild(a):this.root.addChild(a),a},addCameraObject:function(t,e){var a=new vt(t);return null!=e?e.addChild(a):this.root.addChild(a),a},addSpeakerObject:function(t,e){var a=new wt(t);return null!=e?e.addChild(a):this.root.addChild(a),a},addScene:function(t,e,a){var c=this;null==e&&((e=this.addObject()).name=t),at.getSceneRaw(t,function(u){h_.createTraits(u.traits,e),c.loadEmbeddedData(u.embedded_datas,function(){var _=0,h=c.getObjectsCount(u.objects),f=null;f=function(t,e,a,i){if(null!=e)for(var n=0,s=e.length;n<s;){var r=[e[n++]];if(null==r[0].spawn||0!=r[0].spawn){var o=r[0],l=function(e){return function(t){null!=t&&f(t,e[0].children,e[0],i),(_+=1)==h&&i()}}(r);c.createObject(o,u,t,a,l)}else(_+=1)==h&&i()}},null==u.objects||0==u.objects.length?a(e):f(e,u.objects,null,function(){a(e)})})})},getObjectsCount:function(t,e){if(null==e&&(e=!0),null==t)return 0;for(var a=t.length,i=0;i<t.length;){var n=t[i];++i,e&&null!=n.spawn&&0==n.spawn||null!=n.children&&(a+=this.getObjectsCount(n.children))}return a},spawnObject:function(t,e,a,r){null==r&&(r=!0);var i=this,o=0,n=this.getObj(this.raw,t),l=r?this.getObjectsCount([n],!1):1,_=null;(_=function(n,t,s){i.createObject(n,i.raw,t,null,function(t){if(r&&null!=n.children)for(var e=0,a=n.children;e<a.length;){var i=a[e];++e,_(i,t,s)}(o+=1)==l&&null!=s&&s(t)})})(n,e,a)},getObj:function(t,e){return this.traverseObjs(t.objects,e)},traverseObjs:function(t,e){for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i;if(null!=i.children){var n=this.traverseObjs(i.children,e);if(null!=n)return n}}return null},createObject:function(_,t,h,f,u){var c=this,d=t.name;if("camera_object"==_.type)at.getCamera(d,_.data_ref,function(t){var e=c.addCameraObject(t,h);c.returnObject(e,_,u)});else if("light_object"==_.type)at.getLight(d,_.data_ref,function(t){var e=c.addLightObject(t,h);c.returnObject(e,_,u)});else if("mesh_object"==_.type)if(null==_.material_refs||0==_.material_refs.length){var e=this.addObject(h);this.returnObject(e,_,u)}else for(var g=new Array(_.material_refs.length),p=0,a=0,i=_.material_refs.length;a<i;){var n=[a++],s=_.material_refs[n[0]],r=function(l){return function(t){if(g[l[0]]=t,(p+=1)==_.material_refs.length){var e=_.data_ref.split("/"),a="",i="";if(2==e.length?(a=e[0],i=e[1]):(a=d,i=_.data_ref),null!=f&&null!=f.bone_actions)for(var n=[],s=0,r=f.bone_actions;s<r.length;){var o=r[s];++s,at.getSceneRaw(o,function(t){if(n.push(t),n.length==f.bone_actions.length){var e=new Q(f.name,n);c.armatures.push(e),c.returnMeshObject(a,i,d,e,g,h,_,u)}})}else c.returnMeshObject(a,i,d,null,g,h,_,u)}}}(n);at.getMaterial(d,s,r)}else if("speaker_object"==_.type){var o=this.addSpeakerObject(at.getSpeakerRawByName(t.speaker_datas,_.data_ref),h);this.returnObject(o,_,u)}else if("object"==_.type){var l=this.addObject(h);this.returnObject(l,_,function(e){if(null!=_.group_ref){var a=0,i=c.getGroupObjectRefs(_.group_ref);if(0==i.length)u(e);else for(var t=0;t<i.length;){var n=i[t];++t,c.spawnObject(n,e,function(t){(a+=1)==i.length&&u(e)})}}else u(e)})}else u(null)},getGroupObjectRefs:function(t){for(var e=0,a=this.raw.groups;e<a.length;){var i=a[e];if(++e,i.name==t)return i.object_refs}return null},returnMeshObject:function(t,e,i,n,s,r,o,l){var _=this;at.getMesh(t,e,function(t){if(t.isSkinned){var e=t.geom;null!=n?e.addArmature(n):e.addAction(t.format.objects,"none")}var a=_.addMeshObject(t,s,r);null!=o.tilesheet_ref&&d_.__cast(a,u_).setupTilesheet(i,o.tilesheet_ref,o.tilesheet_action_ref),_.returnObject(a,o,l)})},returnObject:function(a,i,n){var s=this;if(null!=a&&null!=i.object_actions){for(var r=[];r.length<i.object_actions.length;)r.push(null);for(var o=0,t=0,e=i.object_actions.length;t<e;){var l=[t++],_=i.object_actions[l[0]];"null"!=_?at.getSceneRaw(_,function(e){return function(t){r[e[0]]=t,(o+=1)==i.object_actions.length&&s.returnObjectLoaded(a,i,r,n)}}(l)):o+=1}}else this.returnObjectLoaded(a,i,null,n)},returnObjectLoaded:function(t,e,a,i){if(null!=t){if(t.raw=e,t.name=e.name,null!=e.visible&&(t.visible=e.visible),null!=e.visible_mesh&&(t.visibleMesh=e.visible_mesh),null!=e.visible_shadow&&(t.visibleShadow=e.visible_shadow),h_.createConstraints(e.constraints,t),h_.generateTransform(e,t.transform),t.setupAnimation(a),null!=e.groups){null==this.groups&&(this.groups=new et);for(var n=0,s=e.groups;n<s.length;){var r=s[n];++n;var o=this.groups,l=null!=fs[r]?o.getReserved(r):o.h[r];if(null==l){l=[];var _=this.groups;null!=fs[r]?_.setReserved(r,l):_.h[r]=l}l.push(t)}}h_.createTraits(e.traits,t)}i(t)},loadEmbeddedData:function(i,n){var s=this;if(null!=i)for(var r=0,t=0;t<i.length;){var e=[i[t]];++t,at.getImage(e[0],function(a){return function(t){var e=s.embedded;null!=fs[a[0]]?e.setReserved(a[0],t):e.h[a[0]]=t,(r+=1)==i.length&&n()}}(e))}else n()},notifyOnInit:function(t){this.ready?t():this.traitInits.push(t)},__class__:h_};var Q=function(t,e){this.matsReady=!1,this.actions=[],this.name=t;for(var a=0;a<e.length;){var i=e[a];++a;for(var n=0,s=i.objects;n<s.length;){var r=s[n];++n,Q.setParents(r)}var o=[[]];Q.traverseBones(i.objects,function(e){return function(t){e[0].push(t)}}(o)),this.actions.push({name:i.name,bones:o[0],mats:null})}};(i["iron.data.Armature"]=Q).__name__=!0,Q.setParents=function(t){if(null!=t.children)for(var e=0,a=t.children;e<a.length;){var i=a[e];++e,i.parent=t,Q.setParents(i)}},Q.traverseBones=function(t,e){for(var a=0,i=t.length;a<i;){var n=a++;Q.traverseBonesStep(t[n],e)}},Q.traverseBonesStep=function(t,e){if("bone_object"==t.type&&e(t),null!=t.children)for(var a=0,i=t.children.length;a<i;){var n=a++;Q.traverseBonesStep(t.children[n],e)}},Q.prototype={name:null,actions:null,matsReady:null,initMats:function(){if(!this.matsReady){this.matsReady=!0;for(var t=0,e=this.actions;t<e.length;){var a=e[t];if(++t,null==a.mats){a.mats=[];for(var i=0,n=a.bones;i<n.length;){var s=n[i];++i;var r=s.transform.values;a.mats.push(new da(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]))}}}}},getAction:function(t){for(var e=0,a=this.actions;e<a.length;){var i=a[e];if(++e,i.name==t)return i}return null},__class__:Q};var at=function(){};(i["iron.data.Data"]=at).__name__=!0,at.getMesh=function(l,_,t){var h=l+_,e=at.cachedMeshes,a=null!=fs[h]?e.getReserved(h):e.h[h];if(null==a){var i=at.loadingMeshes,n=null!=fs[h]?i.getReserved(h):i.h[h];if(null==n){var s=at.loadingMeshes,r=l+_,o=[t];null!=fs[r]?s.setReserved(r,o):s.h[r]=o,ut.parse(l,_,function(t){var e=at.cachedMeshes,a=l+_;null!=fs[a]?e.setReserved(a,t):e.h[a]=t,t.handle=h;for(var i=0,n=at.loadingMeshes,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];i<r.length;){var o=r[i];++i,o(t)}at.loadingMeshes.remove(l+_)})}else n.push(t)}else t(a)},at.getLight=function(l,_,t){var e=at.cachedLights,a=l+_,i=null!=fs[a]?e.getReserved(a):e.h[a];if(null==i){var n=at.loadingLights,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];if(null==r){var o=at.loadingLights,h=l+_,f=[t];null!=fs[h]?o.setReserved(h,f):o.h[h]=f,_t.parse(l,_,function(t){var e=at.cachedLights,a=l+_;null!=fs[a]?e.setReserved(a,t):e.h[a]=t;for(var i=0,n=at.loadingLights,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];i<r.length;){var o=r[i];++i,o(t)}at.loadingLights.remove(l+_)})}else r.push(t)}else t(i)},at.getCamera=function(l,_,t){var e=at.cachedCameras,a=l+_,i=null!=fs[a]?e.getReserved(a):e.h[a];if(null==i){var n=at.loadingCameras,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];if(null==r){var o=at.loadingCameras,h=l+_,f=[t];null!=fs[h]?o.setReserved(h,f):o.h[h]=f,it.parse(l,_,function(t){var e=at.cachedCameras,a=l+_;null!=fs[a]?e.setReserved(a,t):e.h[a]=t;for(var i=0,n=at.loadingCameras,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];i<r.length;){var o=r[i];++i,o(t)}at.loadingCameras.remove(l+_)})}else r.push(t)}else t(i)},at.getMaterial=function(l,_,t){var e=at.cachedMaterials,a=l+_,i=null!=fs[a]?e.getReserved(a):e.h[a];if(null==i){var n=at.loadingMaterials,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];if(null==r){var o=at.loadingMaterials,h=l+_,f=[t];null!=fs[h]?o.setReserved(h,f):o.h[h]=f,ht.parse(l,_,function(t){var e=at.cachedMaterials,a=l+_;null!=fs[a]?e.setReserved(a,t):e.h[a]=t;for(var i=0,n=at.loadingMaterials,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];i<r.length;){var o=r[i];++i,o(t)}at.loadingMaterials.remove(l+_)})}else r.push(t)}else t(i)},at.getWorld=function(l,_,t){if(null!=_){var e=at.cachedWorlds,a=l+_,i=null!=fs[a]?e.getReserved(a):e.h[a];if(null==i){var n=at.loadingWorlds,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];if(null==r){var o=at.loadingWorlds,h=l+_,f=[t];null!=fs[h]?o.setReserved(h,f):o.h[h]=f,ho.parse(l,_,function(t){var e=at.cachedWorlds,a=l+_;null!=fs[a]?e.setReserved(a,t):e.h[a]=t;for(var i=0,n=at.loadingWorlds,s=l+_,r=null!=fs[s]?n.getReserved(s):n.h[s];i<r.length;){var o=r[i];++i,o(t)}at.loadingWorlds.remove(l+_)})}else r.push(t)}else t(i)}else t(null)},at.getShader=function(t,e,a,i){var r=e;null!=i&&(r+="2");var n=at.cachedShaders,s=null!=fs[r]?n.getReserved(r):n.h[r];if(null==s){var o=at.loadingShaders,l=null!=fs[r]?o.getReserved(r):o.h[r];if(null==l){var _=at.loadingShaders,h=[a];null!=fs[r]?_.setReserved(r,h):_.h[r]=h,ct.parse(t,e,function(t){var e=at.cachedShaders;null!=fs[r]?e.setReserved(r,t):e.h[r]=t;for(var a=0,i=at.loadingShaders,n=null!=fs[r]?i.getReserved(r):i.h[r];a<n.length;){var s=n[a];++a,s(t)}at.loadingShaders.remove(r)},i)}else l.push(a)}else a(s)},at.getSceneRaw=function(s,t){var e=at.cachedSceneRaws,a=null!=fs[s]?e.getReserved(s):e.h[s];if(null==a){var i=at.loadingSceneRaws,n=null!=fs[s]?i.getReserved(s):i.h[s];if(null==n){var r=at.loadingSceneRaws,o=[t];null!=fs[s]?r.setReserved(s,o):r.h[s]=o;var l=O.endsWith(s,".zip"),_=O.endsWith(s,".json"),h=l||_||O.endsWith(s,".arm")?"":".arm";at.getBlob(s+h,function(t){var e=null;if(_){var a=t.toString();if("{"==a.charAt(0))e=JSON.parse(a);else{var i=new st(t.toBytes());i.set_bigEndian(!0),e=At.read(i)}}else{var n=new st(t.toBytes());n.set_bigEndian(!0),e=At.read(n)}at.returnSceneRaw(s,e)})}else n.push(t)}else t(a)},at.returnSceneRaw=function(t,e){var a=at.cachedSceneRaws;null!=fs[t]?a.setReserved(t,e):a.h[t]=e;for(var i=0,n=at.loadingSceneRaws,s=null!=fs[t]?n.getReserved(t):n.h[t];i<s.length;){var r=s[i];++i,r(e)}at.loadingSceneRaws.remove(t)},at.getMeshRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getLightRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getCameraRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getMaterialRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getWorldRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getShaderRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getSpeakerRawByName=function(t,e){if(""==e)return t[0];for(var a=0;a<t.length;){var i=t[a];if(++a,i.name==e)return i}return null},at.getBlob=function(r,t){var e=at.cachedBlobs,a=null!=fs[r]?e.getReserved(r):e.h[r];if(null==a){var i=at.loadingBlobs,n=null!=fs[r]?i.getReserved(r):i.h[r];if(null==n){var s=at.loadingBlobs,o=[t];null!=fs[r]?s.setReserved(r,o):s.h[r]=o;var l="/"==r.charAt(0)||":"==r.charAt(1)?r:at.dataPath+r;qt.loadBlobFromPath(l,function(t){var e=at.cachedBlobs;null!=fs[r]?e.setReserved(r,t):e.h[r]=t;for(var a=0,i=at.loadingBlobs,n=null!=fs[r]?i.getReserved(r):i.h[r];a<n.length;){var s=n[a];++a,s(t)}at.loadingBlobs.remove(r),at.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:393,className:"iron.data.Data",methodName:"getBlob"})}else n.push(t)}else t(a)},at.getImage=function(r,t,e,a){null==a&&(a="RGBA32"),null==e&&(e=!1);var i=at.cachedImages,n=null!=fs[r]?i.getReserved(r):i.h[r];if(null==n){var s=at.loadingImages,o=null!=fs[r]?s.getReserved(r):s.h[r];if(null==o){var l=at.loadingImages,_=[t];null!=fs[r]?l.setReserved(r,_):l.h[r]=_;var h="/"==r.charAt(0)||":"==r.charAt(1)?r:at.dataPath+r;qt.loadImageFromPath(h,e,function(t){var e=at.cachedImages;null!=fs[r]?e.setReserved(r,t):e.h[r]=t;for(var a=0,i=at.loadingImages,n=null!=fs[r]?i.getReserved(r):i.h[r];a<n.length;){var s=n[a];++a,s(t)}at.loadingImages.remove(r),at.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:418,className:"iron.data.Data",methodName:"getImage"})}else o.push(t)}else t(n)},at.getSound=function(r,t){O.endsWith(r,".wav")&&(r=r.substring(0,r.length-4)+".ogg");var e=at.cachedSounds,a=null!=fs[r]?e.getReserved(r):e.h[r];if(null==a){var i=at.loadingSounds,n=null!=fs[r]?i.getReserved(r):i.h[r];if(null==n){var s=at.loadingSounds,o=[t];null!=fs[r]?s.setReserved(r,o):s.h[r]=o;var l="/"==r.charAt(0)||":"==r.charAt(1)?r:at.dataPath+r;qt.loadSoundFromPath(l,function(s){s.uncompress(function(){var t=at.cachedSounds;null!=fs[r]?t.setReserved(r,s):t.h[r]=s;for(var e=0,a=at.loadingSounds,i=null!=fs[r]?a.getReserved(r):a.h[r];e<i.length;){var n=i[e];++e,n(s)}at.loadingSounds.remove(r),at.assetsLoaded++})},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:453,className:"iron.data.Data",methodName:"getSound"})}else n.push(t)}else t(a)},at.prototype={__class__:at};var it=function(t,e,a){null==a&&(a=""),this.renderTarget=null,at.call(this),this.raw=t,this.name=t.name,t.render_to_texture&&(this.renderTarget=ee.createRenderTarget(t.texture_resolution_x,t.texture_resolution_y,Va.RGBA32,0)),e(this)};(i["iron.data.CameraData"]=it).__name__=!0,it.parse=function(a,i,n){at.getSceneRaw(a,function(t){var e=at.getCameraRawByName(t.camera_datas,i);null==e&&(Fe.trace('Camera data "'+i+'" not found!',{fileName:"Sources/iron/data/CameraData.hx",lineNumber:30,className:"iron.data.CameraData",methodName:"parse"}),n(null)),new it(e,n,a)})},it.__super__=at,it.prototype=s(at.prototype,{name:null,raw:null,renderTarget:null,__class__:it});var ot=function(){};(i["iron.data.ConstData"]=ot).__name__=!0,ot.createScreenAlignedData=function(){var t=[-1,-1,3,-1,-1,3],e=[0,1,2],a=new Fa;a.add("pos",1),ot.screenAlignedVB=new Ra(t.length/(a.byteSize()/4|0)|0,a,ja.StaticUsage);for(var i=ot.screenAlignedVB.lock(),n=0,s=i.length;n<s;){var r=n++;i[r]=t[r]}ot.screenAlignedVB.unlock(),ot.screenAlignedIB=new Sa(e.length,ja.StaticUsage);for(var o=ot.screenAlignedIB.lock(),l=0,_=o.length;l<_;){var h=l++;o[h]=e[h]}ot.screenAlignedIB.unlock()};var lt=function(t,e,a,i,n,s,r,o,l,_,h,f,u){this.mats=null,this.actions=null,this.skeletonBoneLens=null,this.skeletonBoneRefs=null,this.skeletonTransformsI=null,this.skinBoneWeights=null,this.skinBoneIndices=null,this.skinBoneCounts=null,this.instanceCount=0,this.instanced=!1,this.instancedVB=null,this.numTris=0,this.ready=!1,this.name="",this.count=-1,this.start=0,this.vertexBufferMap=new et,null==h&&(h=ja.StaticUsage),this.indices=t,this.materialIndices=e,this.usage=h,this.positions=a,this.normals=i,this.uvs=n,this.uvs1=s,this.cols=r,this.tangents=o,this.bones=l,this.weights=_,this.instancedData=f,this.instancedType=u,this.struct=lt.getVertexStructure(null!=a,null!=i,null!=n,null!=s,null!=r,null!=o,null!=l,null!=_),this.structLength=this.struct.byteSize()/4|0,this.structStr="";for(var c=0,d=this.struct.elements;c<d.length;){var g=d[c];++c,this.structStr+=g.name}};(i["iron.data.Geometry"]=lt).__name__=!0,lt.getVertexStructure=function(t,e,a,i,n,s,r,o){null==o&&(o=!1),null==r&&(r=!1),null==s&&(s=!1),null==n&&(n=!1),null==i&&(i=!1),null==a&&(a=!1),null==e&&(e=!1),null==t&&(t=!1);var l=new Fa;return t&&l.add("pos",2),e&&l.add("nor",2),a&&l.add("tex",1),i&&l.add("tex1",1),n&&l.add("col",2),s&&l.add("tang",2),r&&l.add("bone",3),o&&l.add("weight",3),l},lt.buildVertices=function(t,e,a,i,n,s,r,o,l,_,h){null==h&&(h=!1),null==_&&(_=0);for(var f=-1+_,u=0,c=e.length/3|0;u<c;){var d=u++;t[++f]=e[3*d],t[++f]=e[3*d+1],t[++f]=e[3*d+2],null!=a&&(t[++f]=a[3*d],t[++f]=a[3*d+1],t[++f]=a[3*d+2]),null!=i?(t[++f]=i[2*d],t[++f]=i[2*d+1]):h&&(t[++f]=0,t[++f]=0),null!=n&&(t[++f]=n[2*d],t[++f]=n[2*d+1]),null!=s&&(t[++f]=s[3*d],t[++f]=s[3*d+1],t[++f]=s[3*d+2]),null!=r&&(t[++f]=r[3*d],t[++f]=r[3*d+1],t[++f]=r[3*d+2]),null!=o&&(t[++f]=o[4*d],t[++f]=o[4*d+1],t[++f]=o[4*d+2],t[++f]=o[4*d+3]),null!=l&&(t[++f]=l[4*d],t[++f]=l[4*d+1],t[++f]=l[4*d+2],t[++f]=l[4*d+3])}},lt.prototype={vertexBuffer:null,vertexBufferMap:null,indexBuffers:null,start:null,count:null,name:null,ready:null,vertices:null,indices:null,numTris:null,materialIndices:null,struct:null,structLength:null,structStr:null,usage:null,instancedVB:null,instanced:null,instanceCount:null,positions:null,normals:null,uvs:null,uvs1:null,cols:null,tangents:null,bones:null,weights:null,instancedData:null,instancedType:null,skinBoneCounts:null,skinBoneIndices:null,skinBoneWeights:null,skeletonTransformsI:null,skeletonBoneRefs:null,skeletonBoneLens:null,actions:null,mats:null,setupInstanced:function(t,e,a){this.instanced=!0,this.instanceCount=t.length/3|0;var i=new Fa;i.instanced=!0,i.add("ipos",2),2!=e&&4!=e||i.add("irot",2),3!=e&&4!=e||i.add("iscl",2),this.instancedVB=new Ra(this.instanceCount,i,a,1);for(var n=this.instancedVB.lock(),s=0,r=n.length;s<r;){var o=s++;n[o]=t[o]}this.instancedVB.unlock()},hasAttrib:function(t,e){for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return!0}return!1},get:function(t){for(var e="",a=0;a<t.length;){var i=t[a];++a,e+=i.name}var n=this.vertexBufferMap,s=null!=fs[e]?n.getReserved(e):n.h[e];if(null==s){var r=this.hasAttrib("pos",t),o=this.hasAttrib("nor",t),l=this.hasAttrib("tex",t),_=this.hasAttrib("tex1",t),h=this.hasAttrib("col",t),f=this.hasAttrib("tang",t),u=this.hasAttrib("bone",t),c=this.hasAttrib("weight",t),d=lt.getVertexStructure(r,o,l,_,h,f,u,c);s=new Ra(this.positions.length/3|0,d,this.usage),this.vertices=s.lock(),lt.buildVertices(this.vertices,r?this.positions:null,o?this.normals:null,l?this.uvs:null,_?this.uvs1:null,h?this.cols:null,f?this.tangents:null,u?this.bones:null,c?this.weights:null,0,l&&null==this.uvs),s.unlock();var g=this.vertexBufferMap;null!=fs[e]?g.setReserved(e,s):g.h[e]=s,l&&null==this.uvs&&Fe.trace("Armory Warning: Geometry "+this.name+" is missing UV map",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:320,className:"iron.data.Geometry",methodName:"get"}),h&&null==this.cols&&Fe.trace("Armory Warning: Geometry "+this.name+" is missing vertex colors",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:321,className:"iron.data.Geometry",methodName:"get"})}return s},build:function(){if(!this.ready){this.vertexBuffer=new Ra(this.positions.length/3|0,this.struct,this.usage),this.vertices=this.vertexBuffer.lock(),lt.buildVertices(this.vertices,this.positions,this.normals,this.uvs,this.uvs1,this.cols,this.tangents,this.bones,this.weights),this.vertexBuffer.unlock();var t=this.structStr,e=this.vertexBuffer,a=this.vertexBufferMap;null!=fs[t]?a.setReserved(t,e):a.h[t]=e,this.indexBuffers=[];for(var i=0,n=this.indices;i<n.length;){var s=n[i];if(++i,0!=s.length){var r=new Sa(s.length,this.usage);this.numTris+=s.length/3|0,r._data=s,r.unlock(),this.indexBuffers.push(r)}}null!=this.instancedData&&this.setupInstanced(this.instancedData,this.instancedType,this.usage),this.ready=!0}},addArmature:function(t){for(var e=0,a=t.actions;e<a.length;){var i=a[e];++e,this.addAction(i.bones,i.name)}},addAction:function(t,e){if(null!=t){null==this.actions&&(this.actions=new et,this.mats=new et);var a=this.actions;if(null==(null!=fs[e]?a.getReserved(e):a.h[e])){for(var i=[],n=0,s=this.skeletonBoneRefs;n<s.length;){var r=s[n];++n;for(var o=0;o<t.length;){var l=t[o];++o,l.name==r&&i.push(l)}}var _=this.actions;null!=fs[e]?_.setReserved(e,i):_.h[e]=i;for(var h=[],f=0;f<i.length;){var u=i[f];++f;var c=u.transform.values;h.push(new da(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15]))}var d=this.mats;null!=fs[e]?d.setReserved(e,h):d.h[e]=h}}},initSkeletonTransforms:function(t){this.skeletonTransformsI=[];for(var e=0;e<t.length;){var a=t[e];++e;var i=new da(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]);this.skeletonTransformsI.push(i)}},__class__:lt};var _t=function(t,e){this.colorTexture=null;var a=this;at.call(this),this.raw=t,this.name=t.name,null!=t.color_texture?at.getImage(t.color_texture,function(t){a.colorTexture=t,e(a)}):e(this)};(i["iron.data.LightData"]=_t).__name__=!0,_t.parse=function(t,a,i){at.getSceneRaw(t,function(t){var e=at.getLightRawByName(t.light_datas,a);null==e&&(Fe.trace('Light data "'+a+'" not found!',{fileName:"Sources/iron/data/LightData.hx",lineNumber:42,className:"iron.data.LightData",methodName:"parse"}),i(null)),new _t(e,i)})},_t.__super__=at,_t.prototype=s(at.prototype,{name:null,raw:null,colorTexture:null,__class__:_t});var ht=function(r,o,t){null==t&&(t=""),this.contexts=null;var l=this;at.call(this),this.uid=++ht.uidCounter,this.raw=r,this.name=r.name;var e=r.shader.split("/"),a="",i="";2==e.length?(a=e[0],i=e[1]):(a=t,i=r.shader),at.getShader(a,i,function(t){for(l.shader=t,l.contexts=[];l.contexts.length<r.contexts.length;)l.contexts.push(null);for(var a=0,e=0,i=r.contexts.length;e<i;){var n=[e++],s=r.contexts[n[0]];new ft(s,function(e){return function(t){l.contexts[e[0]]=t,(a+=1)==r.contexts.length&&o(l)}}(n))}},r.override_context)};(i["iron.data.MaterialData"]=ht).__name__=!0,ht.parse=function(a,i,n){at.getSceneRaw(a,function(t){var e=at.getMaterialRawByName(t.material_datas,i);null==e&&(Fe.trace('Material data "'+i+'" not found!',{fileName:"Sources/iron/data/MaterialData.hx",lineNumber:60,className:"iron.data.MaterialData",methodName:"parse"}),n(null)),new ht(e,n,a)})},ht.__super__=at,ht.prototype=s(at.prototype,{uid:null,name:null,raw:null,shader:null,contexts:null,getContext:function(t){for(var e=0,a=this.contexts;e<a.length;){var i=a[e];if(++e,q.substr(i.raw.name,0,t.length)==t)return i}return null},__class__:ht});var ft=function(_,h){this.id=0,this.textures=null;var f=this;if(this.raw=_,this.id=ft.num++,null!=_.bind_textures&&0<_.bind_textures.length){var t=new Array(_.bind_textures.length);this.textures=t;for(var u=0,e=0,a=_.bind_textures.length;e<a;){var i=[e++],n=[_.bind_textures[i[0]]];""!=n[0].file?at.getImage(n[0].file,function(o,l){return function(i){if(f.textures[l[0]]=i,u+=1,null!=o[0].mipmaps){for(var n=[];n.length<o[0].mipmaps.length;)n.push(null);for(var s=0,t=0,e=o[0].mipmaps.length;t<e;){var a=[t++],r=o[0].mipmaps[a[0]];at.getImage(r,function(e,a){return function(t){n[e[0]]=t,(s+=1)==a[0].mipmaps.length&&(i.setMipmaps(n),a[0].mipmaps=null,a[0].generate_mipmaps=!1,u==_.bind_textures.length&&h(f))}}(a,o))}}else 1==o[0].generate_mipmaps&&null!=i&&(i.generateMipmaps(1e3),o[0].mipmaps=null,o[0].generate_mipmaps=!1),u==_.bind_textures.length&&h(f)}}(n,i),!1,null!=n[0].format?n[0].format:"RGBA32"):(u+=1)==_.bind_textures.length&&h(this)}}else h(this)};(i["iron.data.MaterialContext"]=ft).__name__=!0,ft.prototype={raw:null,textures:null,id:null,setTextureParameters:function(t,e,a,i){a.setTextureParameters(t,i,this.raw.bind_textures[e])},__class__:ft};var ut=function(t,e){this.refcount=0,at.call(this),this.raw=t,this.name=t.name;for(var a=[],i=[],n=0,s=t.index_arrays;n<s.length;){var r=s[n];++n,a.push(r.values),i.push(r.material)}var o=this.getVertexArrayValues("pos"),l=this.getVertexArrayValues("nor"),_=this.getVertexArrayValues("tex"),h=this.getVertexArrayValues("tex1"),f=this.getVertexArrayValues("col"),u=this.getVertexArrayValues("tang");this.isSkinned=null!=t.skin;var c=ja.StaticUsage;null!=t.dynamic_usage&&1==t.dynamic_usage&&(c=ja.DynamicUsage);var d=c,g=null,p=null;if(this.isSkinned){var m=4*(o.length/3|0);g=new ds(m),p=new ds(m);for(var v=0,b=0,I=0,M=o.length/3|0;I<M;){for(var y=I++,w=t.skin.bone_count_array[y],x=v,C=v+w;x<C;){var A=x++;g[b]=t.skin.bone_index_array[A],p[b]=t.skin.bone_weight_array[A],++b}for(var Z=w;Z<4;){Z++;g[b]=0,p[b]=0,++b}v+=w}}this.geom=new lt(a,i,o,l,_,h,f,u,g,p,d,t.instanced_data,t.instanced_type),this.geom.name=this.name,e(this)};(i["iron.data.MeshData"]=ut).__name__=!0,ut.parse=function(t,i,n){at.getSceneRaw(t,function(e){var a=at.getMeshRawByName(e.mesh_datas,i);null==a&&(Fe.trace('Mesh data "'+i+'" not found!',{fileName:"Sources/iron/data/MeshData.hx",lineNumber:104,className:"iron.data.MeshData",methodName:"parse"}),n(null)),new ut(a,function(t){t.format=e,null!=a.skin&&(t.geom.skinBoneCounts=a.skin.bone_count_array,t.geom.skinBoneIndices=a.skin.bone_index_array,t.geom.skinBoneWeights=a.skin.bone_weight_array,t.geom.skeletonBoneRefs=a.skin.bone_ref_array,t.geom.skeletonBoneLens=a.skin.bone_len_array,t.geom.initSkeletonTransforms(a.skin.transformsI)),n(t)})})},ut.__super__=at,ut.prototype=s(at.prototype,{name:null,raw:null,format:null,geom:null,refcount:null,handle:null,isSkinned:null,getVertexArrayValues:function(t){for(var e=0,a=this.raw.vertex_arrays;e<a.length;){var i=a[e];if(++e,i.attrib==t)return i.values}return null},__class__:ut});var ct=function(a,i,t){this.contexts=[];var n=this;at.call(this),this.raw=a,this.name=a.name;for(var e=0,s=a.contexts;e<s.length;){s[e];++e,this.contexts.push(null)}for(var r=0,o=0,l=a.contexts.length;o<l;){var _=[o++],h=a.contexts[_[0]];new dt(h,function(e){return function(t){n.contexts[e[0]]=t,(r+=1)==a.contexts.length&&i(n)}}(_),t)}};(i["iron.data.ShaderData"]=ct).__name__=!0,ct.parse=function(t,a,i,n){at.getSceneRaw(t,function(t){var e=at.getShaderRawByName(t.shader_datas,a);null==e&&(Fe.trace('Shader data "'+a+'" not found!',{fileName:"Sources/iron/data/ShaderData.hx",lineNumber:49,className:"iron.data.ShaderData",methodName:"parse"}),i(null)),new ct(e,i,n)})},ct.__super__=at,ct.prototype=s(at.prototype,{name:null,raw:null,contexts:null,getContext:function(t){for(var e=0,a=this.contexts;e<a.length;){var i=a[e];if(++e,i.raw.name==t)return i}return null},__class__:ct});var dt=function(t,e,a){this.instancingType=0,this.raw=t,this.overrideContext=a,"rect"==t.name?(this.structure=dt.getStructureRect(),this.instancingType=0):this.parseVertexStructure(),this.compile(e)};(i["iron.data.ShaderContext"]=dt).__name__=!0,dt.getStructureRect=function(){return null==dt.structureRect&&(dt.structureRect=new Fa,dt.structureRect.add("pos",1)),dt.structureRect},dt.prototype={raw:null,pipeState:null,constants:null,textureUnits:null,paramsSet:null,structure:null,instancingType:null,overrideContext:null,compile:function(t){if(null!=this.pipeState&&this.pipeState.delete(),this.pipeState=new Na,this.constants=[],this.textureUnits=[],this.paramsSet=[],0<this.instancingType){var e=new Fa;e.add("ipos",2),2!=this.instancingType&&4!=this.instancingType||e.add("irot",2),3!=this.instancingType&&4!=this.instancingType||e.add("iscl",2),e.instanced=!0,this.pipeState.inputLayout=[this.structure,e]}else this.pipeState.inputLayout=[this.structure];if(this.pipeState.depthWrite=this.raw.depth_write,this.pipeState.depthMode=this.getCompareMode(this.raw.compare_mode),null!=this.raw.stencil_mode&&("always"==this.raw.stencil_mode?this.pipeState.stencilMode=Ia.Always:"equal"==this.raw.stencil_mode?this.pipeState.stencilMode=Ia.Equal:"not_equal"==this.raw.stencil_mode&&(this.pipeState.stencilMode=Ia.NotEqual)),null!=this.raw.stencil_pass&&("replace"==this.raw.stencil_pass?this.pipeState.stencilBothPass=La.Replace:"keep"==this.raw.stencil_pass&&(this.pipeState.stencilBothPass=La.Keep)),null!=this.raw.stencil_fail&&"keep"==this.raw.stencil_fail&&(this.pipeState.stencilDepthFail=La.Keep,this.pipeState.stencilFail=La.Keep),null!=this.raw.stencil_reference_value&&(this.pipeState.stencilReferenceValue=this.raw.stencil_reference_value),this.pipeState.cullMode=this.getCullMode(this.raw.cull_mode),null!=this.raw.blend_source&&(this.pipeState.blendSource=this.getBlendingFactor(this.raw.blend_source)),null!=this.raw.blend_destination&&(this.pipeState.blendDestination=this.getBlendingFactor(this.raw.blend_destination)),null!=this.raw.blend_operation&&(this.pipeState.blendOperation=this.getBlendingOperation(this.raw.blend_operation)),null!=this.raw.alpha_blend_source&&(this.pipeState.alphaBlendSource=this.getBlendingFactor(this.raw.alpha_blend_source)),null!=this.raw.alpha_blend_destination&&(this.pipeState.alphaBlendDestination=this.getBlendingFactor(this.raw.alpha_blend_destination)),null!=this.raw.alpha_blend_operation&&(this.pipeState.alphaBlendOperation=this.getBlendingOperation(this.raw.alpha_blend_operation)),null!=this.raw.color_write_red&&(this.pipeState.colorWriteMaskRed=this.raw.color_write_red),null!=this.raw.color_write_green&&(this.pipeState.colorWriteMaskGreen=this.raw.color_write_green),null!=this.raw.color_write_blue&&(this.pipeState.colorWriteMaskBlue=this.raw.color_write_blue),null!=this.raw.color_write_alpha&&(this.pipeState.colorWriteMaskAlpha=this.raw.color_write_alpha),null!=this.raw.conservative_raster&&(this.pipeState.conservativeRasterization=this.raw.conservative_raster),this.raw.shader_from_source)this.pipeState.fragmentShader=xa.fromSource(this.raw.fragment_shader),this.pipeState.vertexShader=Pa.fromSource(this.raw.vertex_shader),this.finishCompile(t);else{var a=O.replace(this.raw.fragment_shader,".","_");this.pipeState.fragmentShader=Ft.field(de,a);var i=O.replace(this.raw.vertex_shader,".","_");if(this.pipeState.vertexShader=Ft.field(de,i),null!=this.raw.geometry_shader){var n=O.replace(this.raw.geometry_shader,".","_");this.pipeState.geometryShader=Ft.field(de,n)}if(null!=this.raw.tesscontrol_shader){var s=O.replace(this.raw.tesscontrol_shader,".","_");this.pipeState.tessellationControlShader=Ft.field(de,s)}if(null!=this.raw.tesseval_shader){var r=O.replace(this.raw.tesseval_shader,".","_");this.pipeState.tessellationEvaluationShader=Ft.field(de,r)}this.finishCompile(t)}},finishCompile:function(t){if(null!=this.overrideContext&&null!=this.overrideContext.cull_mode&&(this.pipeState.cullMode=this.getCullMode(this.overrideContext.cull_mode)),this.pipeState.compile(),null!=this.raw.constants)for(var e=0,a=this.raw.constants;e<a.length;){var i=a[e];++e,this.addConstant(i)}if(null!=this.raw.texture_units)for(var n=0,s=this.raw.texture_units;n<s.length;){var r=s[n];++n,this.addTexture(r)}t(this)},sizeToVD:function(t){return 1==t?0:2==t?1:3==t?2:4==t?3:0},parseVertexStructure:function(){this.structure=new Fa;for(var t=!1,e=0,a=this.raw.vertex_structure;e<a.length;){var i=a[e];++e,"ipos"!=i.name?"irot"!=i.name&&"iscl"!=i.name?this.structure.add(i.name,this.sizeToVD(i.size)):t=!0:t=!0}t&&(this.instancingType=1)},getCompareMode:function(t){switch(t){case"always":return Ia.Always;case"equal":return Ia.Equal;case"greater":return Ia.Greater;case"greater_equal":return Ia.GreaterEqual;case"less":return Ia.Less;case"less_equal":return Ia.LessEqual;case"never":return Ia.Never;case"not_equal":return Ia.NotEqual;default:return Ia.Less}},getCullMode:function(t){switch(t){case"clockwise":return wa.Clockwise;case"none":return wa.None;default:return wa.CounterClockwise}},getBlendingOperation:function(t){switch(t){case"add":return ba.Add;case"max":return ba.Max;case"min":return ba.Min;case"reverse_subtract":return ba.ReverseSubtract;case"subtract":return ba.Subtract;default:return ba.Add}},getBlendingFactor:function(t){switch(t){case"blend_one":return va.BlendOne;case"blend_zero":return va.BlendZero;case"destination_alpha":return va.DestinationAlpha;case"destination_color":return va.DestinationColor;case"inverse_destination_alpha":return va.InverseDestinationAlpha;case"inverse_destination_color":return va.InverseDestinationColor;case"inverse_source_alpha":return va.InverseSourceAlpha;case"inverse_source_color":return va.InverseSourceColor;case"source_alpha":return va.SourceAlpha;case"source_color":return va.SourceColor;default:return va.Undefined}},getTextureAddresing:function(t){switch(t){case"mirror":return Da.Mirror;case"repeat":return Da.Repeat;default:return Da.Clamp}},getTextureFilter:function(t){switch(t){case"linear":return Ta.LinearFilter;case"point":return Ta.PointFilter;default:return Ta.AnisotropicFilter}},getMipmapFilter:function(t){switch(t){case"no":return Xa.NoMipFilter;case"point":return Xa.PointMipFilter;default:return Xa.LinearMipFilter}},addConstant:function(t){this.constants.push(this.pipeState.getConstantLocation(t.name))},addTexture:function(t){var e=this.pipeState.getTextureUnit(t.name);this.textureUnits.push(e),this.paramsSet.push(!1)},setTextureParameters:function(t,e,a){var i=this.textureUnits[e];t.setTextureParameters(i,null==a.u_addressing?Da.Repeat:this.getTextureAddresing(a.u_addressing),null==a.v_addressing?Da.Repeat:this.getTextureAddresing(a.v_addressing),null==a.min_filter?Ta.LinearFilter:this.getTextureFilter(a.min_filter),null==a.mag_filter?Ta.LinearFilter:this.getTextureFilter(a.mag_filter),null==a.mipmap_filter?Xa.NoMipFilter:this.getMipmapFilter(a.mipmap_filter))},__class__:dt};var ho=function(e,a){this.vec=new lo,this.shirr=null;var i=this;if(at.call(this),this.raw=e,this.name=e.name,null!=e.probes&&0<e.probes.length){this.probes=[];for(var t=0,n=e.probes;t<n.length;){var s=n[t];++t,new gt(s,function(t){i.probes.push(t),i.probes.length==e.probes.length&&i.loadEnvmap(a)})}}else this.loadEnvmap(a)};(i["iron.data.WorldData"]=ho).__name__=!0,ho.parse=function(t,a,i){at.getSceneRaw(t,function(t){var e=at.getWorldRawByName(t.world_datas,a);null==e&&(Fe.trace('World data "'+a+'" not found!',{fileName:"Sources/iron/data/WorldData.hx",lineNumber:51,className:"iron.data.WorldData",methodName:"parse"}),i(null)),new ho(e,i)})},ho.getEmptyIrradiance=function(){if(null==ho.emptyIrr){var t=new ds(28);ho.emptyIrr=t;for(var e=0,a=ho.emptyIrr.length;e<a;){var i=e++;ho.emptyIrr[i]=0}}return ho.emptyIrr},ho.__super__=at,ho.prototype=s(at.prototype,{name:null,raw:null,envmap:null,probes:null,loadEnvmap:function(e){var a=this;null!=this.raw.envmap?at.getImage(this.raw.envmap,function(t){a.envmap=t,e(a)}):e(this)},getGlobalProbe:function(){return this.probes[0]},shirr:null,getSHIrradiance:function(){if(null==this.shirr){var t=new ds(28);this.shirr=t;for(var e=this.probes[0],a=0,i=e.irradiance.length;a<i;){var n=a++;this.shirr[n]=e.irradiance[n]}}return this.shirr},vec:null,getProbeID:function(t){this.vec.x=t.world.self._30,this.vec.y=t.world.self._31,this.vec.z=t.world.self._32;for(var e=t.dim,a=1,i=this.probes.length;a<i;){var n=a++,s=this.probes[n];if(!(this.vec.x+e.x/2<s.volumeMin.x||this.vec.x-e.x/2>s.volumeMax.x||this.vec.y+e.y/2<s.volumeMin.y||this.vec.y-e.y/2>s.volumeMax.y||this.vec.z+e.z/2<s.volumeMin.z||this.vec.z-e.z/2>s.volumeMax.z))return n}return 0},getProbeVolumeCenter:function(t){return this.probes[this.getProbeID(t)].volumeCenter},getProbeVolumeSize:function(t){return this.probes[this.getProbeID(t)].volume},getProbeStrength:function(t){return this.probes[this.getProbeID(t)].raw.strength},getProbeBlending:function(t){return this.probes[this.getProbeID(t)].raw.blending},__class__:ho});var gt=function(l,_){var h=this;this.raw=l,this.setIrradiance(function(t){h.irradiance=t,null!=l.radiance?at.getImage(l.radiance,function(t){h.radiance=t;for(var a=[];a.length<l.radiance_mipmaps;)a.push(null);for(var e=l.radiance.substring(l.radiance.length-4),i=l.radiance.substring(0,l.radiance.length-4),n=0,s=0,r=l.radiance_mipmaps;s<r;){var o=[s++];at.getImage(i+"_"+o[0]+e,function(e){return function(t){a[e[0]]=t,(n+=1)==l.radiance_mipmaps&&(h.radiance.setMipmaps(a),h.mipsSet(_))}}(o),!0)}}):h.mipsSet(_)})};(i["iron.data.Probe"]=gt).__name__=!0,gt.prototype={raw:null,radiance:null,irradiance:null,volume:null,volumeCenter:null,volumeMin:null,volumeMax:null,mipsSet:function(t){this.volume=new lo(this.raw.volume[0],this.raw.volume[1],this.raw.volume[2]),this.volumeCenter=new lo(this.raw.volume_center[0],this.raw.volume_center[1],this.raw.volume_center[2]),this.volumeMin=new lo(this.volumeCenter.x-this.volume.x,this.volumeCenter.y-this.volume.y,this.volumeCenter.z-this.volume.z),this.volumeMax=new lo(this.volumeCenter.x+this.volume.x,this.volumeCenter.y+this.volume.y,this.volumeCenter.z+this.volume.z),t(this)},setIrradiance:function(r){if(""==this.raw.irradiance){for(var t=[.775966,1.16761,1.498638,.133694,.215281,.056659,-.022268,-.019376,-.010651,279e-6,185e-6,0,0,-393e-6,-775e-6,.010973,.027268,.043918,.085267,.07367,.038877,0,0,0,.135177,.115614,.060794],e=new ds(t.length),a=0,i=e.length;a<i;){var n=a++;e[n]=t[n]}r(e)}else{var o=O.endsWith(this.raw.irradiance,".json")?"":".arm";at.getBlob(this.raw.irradiance+o,function(t){var e;if(""==o)e=JSON.parse(t.toString());else{var a=new st(t.toBytes());a.set_bigEndian(!0),e=At.read(a)}for(var i=new ds(28),n=0;n<27;){var s=n++;i[s]=e.irradiance[s]}i[27]=0,r(i)})}},__class__:gt};var pt=function(t,e,a,i,n,s,r,o,l){this.self=new Ct(t,e,a,i,n,s,r,o,l)};(i["iron.math.Mat3"]=pt).__name__=!0,pt.prototype={self:null,__class__:pt};var Pe=function(){this.markerEvents=null,this.lastFrameIndex=-1,this.blendFactor=0,this.blendAction="",this.blendCurrent=0,this.blendTime=0,this.paused=!1,this.onComplete=null,this.frameIndex=0,this.loop=!0,this.speed=1,this.time=0,this.action="",h_.active.animations.push(this),this.frameTime=h_.active.raw.frame_time,this.play()};(i["iron.object.Animation"]=Pe).__name__=!0,Pe.prototype={isSkinned:null,isSampled:null,action:null,armature:null,time:null,speed:null,loop:null,frameIndex:null,onComplete:null,paused:null,frameTime:null,blendTime:null,blendCurrent:null,blendAction:null,blendFactor:null,lastFrameIndex:null,markerEvents:null,play:function(t,e,a,i,n){null==n&&(n=!0),null==i&&(i=1),null==a&&(a=0),null==t&&(t=""),0<a?(this.blendTime=a,this.blendCurrent=0,this.blendAction=this.action):this.frameIndex=-1,this.action=t,this.onComplete=e,this.speed=i,this.loop=n,this.paused=!1},remove:function(){q.remove(h_.active.animations,this)},update:function(t){this.paused||0==this.speed||(this.time+=t*this.speed,0<this.blendTime&&0==this.blendFactor&&(this.blendCurrent+=t,this.blendCurrent>=this.blendTime&&(this.blendTime=0)))},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-1:this.frameIndex<=0},rewind:function(t){this.frameIndex=0<this.speed?0:t.frames.length-1,this.time=t.frames[this.frameIndex]*this.frameTime},updateTrack:function(t){if(null!=t){var e=t.tracks[0];-1==this.frameIndex&&this.rewind(e);for(var a=0<this.speed?1:-1;;){var i=e.frames;if(!(0<this.speed?this.frameIndex+1<i.length&&this.time>i[this.frameIndex+1]*this.frameTime:-1<this.frameIndex-1&&this.time<i[this.frameIndex-1]*this.frameTime))break;this.frameIndex+=a}if(null!=this.markerEvents&&null!=t.marker_names&&this.frameIndex!=this.lastFrameIndex){for(var n=0,s=t.marker_frames.length;n<s;){var r=n++;if(this.frameIndex==t.marker_frames[r])for(var o=t.marker_names[r],l=this.markerEvents,_=null!=fs[o]?l.getReserved(o):l.h[o],h=0;h<_.length;){var f=_[h];++h,f()}}this.lastFrameIndex=this.frameIndex}this.isTrackEnd(e)&&(this.loop||0<this.blendTime?this.rewind(e):(this.frameIndex-=a,this.paused=!0),null!=this.onComplete&&0==this.blendTime&&this.onComplete())}},updateAnimSampled:function(t,e){if(null!=t){var a=t.tracks[0],i=0<this.speed?1:-1,n=this.time,s=this.frameIndex,r=a.frames[s]*this.frameTime,o=(n-r)/(a.frames[s+i]*this.frameTime-r),l=Pe.m1,_=a.values,h=16*s;l.self._00=_[h],l.self._10=_[1+h],l.self._20=_[2+h],l.self._30=_[3+h],l.self._01=_[4+h],l.self._11=_[5+h],l.self._21=_[6+h],l.self._31=_[7+h],l.self._02=_[8+h],l.self._12=_[9+h],l.self._22=_[10+h],l.self._32=_[11+h],l.self._03=_[12+h],l.self._13=_[13+h],l.self._23=_[14+h],l.self._33=_[15+h];var f=Pe.m2,u=a.values,c=16*(s+i);f.self._00=u[c],f.self._10=u[1+c],f.self._20=u[2+c],f.self._30=u[3+c],f.self._01=u[4+c],f.self._11=u[5+c],f.self._21=u[6+c],f.self._31=u[7+c],f.self._02=u[8+c],f.self._12=u[9+c],f.self._22=u[10+c],f.self._32=u[11+c],f.self._03=u[12+c],f.self._13=u[13+c],f.self._23=u[14+c],f.self._33=u[15+c];var d=Pe.m1,g=Pe.vpos,p=Pe.q1,m=Pe.vscl;g.x=d.self._30,g.y=d.self._31,g.z=d.self._32;var v=da.helpVec;v.x=d.self._00,v.y=d.self._01,v.z=d.self._02,v.w=1;var b=v;m.x=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);var I=da.helpVec;I.x=d.self._10,I.y=d.self._11,I.z=d.self._12,I.w=1;var M=I;m.y=Math.sqrt(M.x*M.x+M.y*M.y+M.z*M.z);var y=da.helpVec;y.x=d.self._20,y.y=d.self._21,y.z=d.self._22,y.w=1;var w=y;m.z=Math.sqrt(w.x*w.x+w.y*w.y+w.z*w.z);var x=d.self,C=x._12,A=x._22,Z=x._32,z=x._13,B=x._23,k=x._33,S=x._11*(A*k-Z*B)-x._21*(C*k-Z*z)+x._31*(C*B-A*z),X=x._12,Y=x._22,N=x._32,L=x._13,G=x._23,W=x._33,D=x._10*(Y*W-N*G)-x._20*(X*W-N*L)+x._30*(X*G-Y*L),T=x._11,V=x._21,K=x._31,j=x._13,R=x._23,H=x._33,P=x._10*(V*H-K*R)-x._20*(T*H-K*j)+x._30*(T*R-V*j),F=x._11,O=x._21,E=x._31,U=x._12,J=x._22,Q=x._32,q=x._10*(O*Q-E*J)-x._20*(F*Q-E*U)+x._30*(F*J-O*U);x._00*S-x._01*D+x._02*P-x._03*q<0&&(m.x=-m.x);var $=1/m.x;da.helpMat.self._00=d.self._00*$,da.helpMat.self._01=d.self._01*$,da.helpMat.self._02=d.self._02*$,$=1/m.y,da.helpMat.self._10=d.self._10*$,da.helpMat.self._11=d.self._11*$,da.helpMat.self._12=d.self._12*$,$=1/m.z,da.helpMat.self._20=d.self._20*$,da.helpMat.self._21=d.self._21*$,da.helpMat.self._22=d.self._22*$;var tt=da.helpMat,et=tt.self._00,at=tt.self._10,it=tt.self._20,nt=tt.self._01,st=tt.self._11,rt=tt.self._21,ot=tt.self._02,lt=tt.self._12,_t=tt.self._22,ht=et+st+_t,ft=0;0<ht?(ft=.5/Math.sqrt(ht+1),p.w=.25/ft,p.x=(lt-rt)*ft,p.y=(it-ot)*ft,p.z=(nt-at)*ft):st<et&&_t<et?(ft=2*Math.sqrt(1+et-st-_t),p.w=(lt-rt)/ft,p.x=.25*ft,p.y=(at+nt)/ft,p.z=(it+ot)/ft):_t<st?(ft=2*Math.sqrt(1+st-et-_t),p.w=(it-ot)/ft,p.x=(at+nt)/ft,p.y=.25*ft,p.z=(rt+lt)/ft):(ft=2*Math.sqrt(1+_t-et-st),p.w=(nt-at)/ft,p.x=(it+ot)/ft,p.y=(rt+lt)/ft,p.z=.25*ft);var ut=Pe.m2,ct=Pe.vpos2,dt=Pe.q2,gt=Pe.vscl2;ct.x=ut.self._30,ct.y=ut.self._31,ct.z=ut.self._32;var pt=da.helpVec;pt.x=ut.self._00,pt.y=ut.self._01,pt.z=ut.self._02,pt.w=1;var mt=pt;gt.x=Math.sqrt(mt.x*mt.x+mt.y*mt.y+mt.z*mt.z);var vt=da.helpVec;vt.x=ut.self._10,vt.y=ut.self._11,vt.z=ut.self._12,vt.w=1;var bt=vt;gt.y=Math.sqrt(bt.x*bt.x+bt.y*bt.y+bt.z*bt.z);var It=da.helpVec;It.x=ut.self._20,It.y=ut.self._21,It.z=ut.self._22,It.w=1;var Mt=It;gt.z=Math.sqrt(Mt.x*Mt.x+Mt.y*Mt.y+Mt.z*Mt.z);var yt=ut.self,wt=yt._12,xt=yt._22,Ct=yt._32,At=yt._13,Zt=yt._23,zt=yt._33,Bt=yt._11*(xt*zt-Ct*Zt)-yt._21*(wt*zt-Ct*At)+yt._31*(wt*Zt-xt*At),kt=yt._12,St=yt._22,Xt=yt._32,Yt=yt._13,Nt=yt._23,Lt=yt._33,Gt=yt._10*(St*Lt-Xt*Nt)-yt._20*(kt*Lt-Xt*Yt)+yt._30*(kt*Nt-St*Yt),Wt=yt._11,Dt=yt._21,Tt=yt._31,Vt=yt._13,Kt=yt._23,jt=yt._33,Rt=yt._10*(Dt*jt-Tt*Kt)-yt._20*(Wt*jt-Tt*Vt)+yt._30*(Wt*Kt-Dt*Vt),Ht=yt._11,Pt=yt._21,Ft=yt._31,Ot=yt._12,Et=yt._22,Ut=yt._32,Jt=yt._10*(Pt*Ut-Ft*Et)-yt._20*(Ht*Ut-Ft*Ot)+yt._30*(Ht*Et-Pt*Ot);yt._00*Bt-yt._01*Gt+yt._02*Rt-yt._03*Jt<0&&(gt.x=-gt.x);var Qt=1/gt.x;da.helpMat.self._00=ut.self._00*Qt,da.helpMat.self._01=ut.self._01*Qt,da.helpMat.self._02=ut.self._02*Qt,Qt=1/gt.y,da.helpMat.self._10=ut.self._10*Qt,da.helpMat.self._11=ut.self._11*Qt,da.helpMat.self._12=ut.self._12*Qt,Qt=1/gt.z,da.helpMat.self._20=ut.self._20*Qt,da.helpMat.self._21=ut.self._21*Qt,da.helpMat.self._22=ut.self._22*Qt;var qt=da.helpMat,$t=qt.self._00,te=qt.self._10,ee=qt.self._20,ae=qt.self._01,ie=qt.self._11,ne=qt.self._21,se=qt.self._02,re=qt.self._12,oe=qt.self._22,le=$t+ie+oe,_e=0;0<le?(_e=.5/Math.sqrt(le+1),dt.w=.25/_e,dt.x=(re-ne)*_e,dt.y=(ee-se)*_e,dt.z=(ae-te)*_e):ie<$t&&oe<$t?(_e=2*Math.sqrt(1+$t-ie-oe),dt.w=(re-ne)/_e,dt.x=.25*_e,dt.y=(te+ae)/_e,dt.z=(ee+se)/_e):oe<ie?(_e=2*Math.sqrt(1+ie-$t-oe),dt.w=(ee-se)/_e,dt.x=(te+ae)/_e,dt.y=.25*_e,dt.z=(ne+re)/_e):(_e=2*Math.sqrt(1+oe-$t-ie),dt.w=(ae-te)/_e,dt.x=(ee+se)/_e,dt.y=(ne+re)/_e,dt.z=.25*_e);var he=Pe.vp,fe=Pe.vpos,ue=Pe.vpos2;he.x=fe.x+(ue.x-fe.x)*o,he.y=fe.y+(ue.y-fe.y)*o,he.z=fe.z+(ue.z-fe.z)*o;var ce=Pe.vs,de=Pe.vscl,ge=Pe.vscl2;ce.x=de.x+(ge.x-de.x)*o,ce.y=de.y+(ge.y-de.y)*o,ce.z=de.z+(ge.z-de.z)*o;var pe=Pe.q3,me=Pe.q1,ve=Pe.q2,be=me.x,Ie=me.y,Me=me.z,ye=me.w;me.x*ve.x+me.y*ve.y+me.z*ve.z+me.w*ve.w<0&&(be=-be,Ie=-Ie,Me=-Me,ye=-ye),pe.x=be+(ve.x-be)*o,pe.y=Ie+(ve.y-Ie)*o,pe.z=Me+(ve.z-Me)*o,pe.w=ye+(ve.w-ye)*o;var we=Math.sqrt(pe.x*pe.x+pe.y*pe.y+pe.z*pe.z+pe.w*pe.w);0==we?(pe.x=0,pe.y=0,pe.z=0,pe.w=0):(we=1/we,pe.x*=we,pe.y*=we,pe.z*=we,pe.w*=we);var xe=Pe.q3,Ce=xe.x,Ae=xe.y,Ze=xe.z,ze=xe.w,Be=Ce+Ce,ke=Ae+Ae,Se=Ze+Ze,Xe=Ce*Be,Ye=Ce*ke,Ne=Ce*Se,Le=Ae*ke,Ge=Ae*Se,We=Ze*Se,De=ze*Be,Te=ze*ke,Ve=ze*Se;e.self._00=1-(Le+We),e.self._10=Ye-Ve,e.self._20=Ne+Te,e.self._01=Ye+Ve,e.self._11=1-(Xe+We),e.self._21=Ge-De,e.self._02=Ne-Te,e.self._12=Ge+De,e.self._22=1-(Xe+Le),e.self._03=0,e.self._13=0,e.self._23=0,e.self._30=0,e.self._31=0,e.self._32=0,e.self._33=1;var Ke=Pe.vs,je=Ke.x,Re=Ke.y,He=Ke.z;e.self._00*=je,e.self._01*=je,e.self._02*=je,e.self._03*=je,e.self._10*=Re,e.self._11*=Re,e.self._12*=Re,e.self._13*=Re,e.self._20*=He,e.self._21*=He,e.self._22*=He,e.self._23*=He,e.self._30=Pe.vp.x,e.self._31=Pe.vp.y,e.self._32=Pe.vp.z}},__class__:Pe};var f_=function(t){null==t&&(t=""),this.onUpdates=null,this.constraintMats=null,this.constraintTargetsI=null,this.constraintTargets=null,this.boneChildren=null,this.matsFastBlendSort=[],this.matsFastBlend=[],this.matsFastSort=[],this.matsFast=[],this.applyParent=null,this.absMats=null,this.skeletonMatsBlend=null,this.skeletonBonesBlend=null,this.skeletonMats=null,this.skeletonBones=null,Pe.call(this),this.isSampled=!1;for(var e=0,a=h_.active.armatures;e<a.length;){var i=a[e];if(++e,i.name==t){this.armature=i;break}}};(i["iron.object.BoneAnimation"]=f_).__name__=!0,f_.__super__=Pe,f_.prototype=s(Pe.prototype,{object:null,data:null,skinBuffer:null,skeletonBones:null,skeletonMats:null,skeletonBonesBlend:null,skeletonMatsBlend:null,absMats:null,applyParent:null,matsFast:null,matsFastSort:null,matsFastBlend:null,matsFastBlendSort:null,boneChildren:null,constraintTargets:null,constraintTargetsI:null,constraintMats:null,setSkin:function(t){var e=this;if(this.object=t,this.data=null!=t?t.data:null,this.isSkinned=null!=this.data&&this.data.isSkinned,this.isSkinned){var a=new ds(8*f_.skinMaxBones);this.skinBuffer=a;for(var i=0,n=this.skinBuffer.length;i<n;){var s=i++;this.skinBuffer[s]=0}var r=this.object.transform.rot;r.x=0,r.y=0,r.z=0,r.w=1,this.object.transform.buildMatrix();var o=t.parent.raw.bone_actions;null!=o&&0<o.length&&at.getSceneRaw(o[0],function(t){e.play(t.name)})}},addBoneChild:function(t,e){null==this.boneChildren&&(this.boneChildren=new et);var a=this.boneChildren,i=null!=fs[t]?a.getReserved(t):a.h[t];if(null==i){i=[];var n=this.boneChildren;null!=fs[t]?n.setReserved(t,i):n.h[t]=i}i.push(e)},updateBoneChildren:function(t,e){var a=t.name,i=this.boneChildren,n=null!=fs[a]?i.getReserved(a):i.h[a];if(null!=n)for(var s=0;s<n.length;){var r=n[s];++s;var o=r.transform;if(null==o.boneParent&&(o.boneParent=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),null!=r.raw.parent_bone_tail)if(r.raw.parent_bone_connected||this.isSkinned){var l=r.raw.parent_bone_tail,_=o.boneParent;_.self._00=1,_.self._01=0,_.self._02=0,_.self._03=0,_.self._10=0,_.self._11=1,_.self._12=0,_.self._13=0,_.self._20=0,_.self._21=0,_.self._22=1,_.self._23=0,_.self._30=l[0],_.self._31=l[1],_.self._32=l[2],_.self._33=1;var h=o.boneParent,f=h.self._00,u=h.self._01,c=h.self._02,d=h.self._03,g=h.self._10,p=h.self._11,m=h.self._12,v=h.self._13,b=h.self._20,I=h.self._21,M=h.self._22,y=h.self._23,w=h.self._30,x=h.self._31,C=h.self._32,A=h.self._33,Z=e.self._00,z=e.self._10,B=e.self._20,k=e.self._30;h.self._00=f*Z+u*z+c*B+d*k,h.self._10=g*Z+p*z+m*B+v*k,h.self._20=b*Z+I*z+M*B+y*k,h.self._30=w*Z+x*z+C*B+A*k,Z=e.self._01,z=e.self._11,B=e.self._21,k=e.self._31,h.self._01=f*Z+u*z+c*B+d*k,h.self._11=g*Z+p*z+m*B+v*k,h.self._21=b*Z+I*z+M*B+y*k,h.self._31=w*Z+x*z+C*B+A*k,Z=e.self._02,z=e.self._12,B=e.self._22,k=e.self._32,h.self._02=f*Z+u*z+c*B+d*k,h.self._12=g*Z+p*z+m*B+v*k,h.self._22=b*Z+I*z+M*B+y*k,h.self._32=w*Z+x*z+C*B+A*k,Z=e.self._03,z=e.self._13,B=e.self._23,k=e.self._33,h.self._03=f*Z+u*z+c*B+d*k,h.self._13=g*Z+p*z+m*B+v*k,h.self._23=b*Z+I*z+M*B+y*k,h.self._33=w*Z+x*z+C*B+A*k}else{var S=r.raw.parent_bone_tail_pose,X=o.boneParent;X.self._00=e.self._00,X.self._01=e.self._01,X.self._02=e.self._02,X.self._03=e.self._03,X.self._10=e.self._10,X.self._11=e.self._11,X.self._12=e.self._12,X.self._13=e.self._13,X.self._20=e.self._20,X.self._21=e.self._21,X.self._22=e.self._22,X.self._23=e.self._23,X.self._30=e.self._30,X.self._31=e.self._31,X.self._32=e.self._32,X.self._33=e.self._33;var Y=o.boneParent,N=S[0],L=S[1],G=S[2];Y.self._00+=N*Y.self._03,Y.self._01+=L*Y.self._03,Y.self._02+=G*Y.self._03,Y.self._10+=N*Y.self._13,Y.self._11+=L*Y.self._13,Y.self._12+=G*Y.self._13,Y.self._20+=N*Y.self._23,Y.self._21+=L*Y.self._23,Y.self._22+=G*Y.self._23,Y.self._30+=N*Y.self._33,Y.self._31+=L*Y.self._33,Y.self._32+=G*Y.self._33}else{var W=o.boneParent;W.self._00=e.self._00,W.self._01=e.self._01,W.self._02=e.self._02,W.self._03=e.self._03,W.self._10=e.self._10,W.self._11=e.self._11,W.self._12=e.self._12,W.self._13=e.self._13,W.self._20=e.self._20,W.self._21=e.self._21,W.self._22=e.self._22,W.self._23=e.self._23,W.self._30=e.self._30,W.self._31=e.self._31,W.self._32=e.self._32,W.self._33=e.self._33}o.buildMatrix()}},numParents:function(t){for(var e=0,a=t.parent;null!=a;)++e,a=a.parent;return e},setMats:function(){for(var n=this;this.matsFast.length<this.skeletonBones.length;)this.matsFast.push(new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),this.matsFastSort.push(this.matsFastSort.length);if(this.matsFastSort.sort(function(t,e){var a=n.numParents(n.skeletonBones[t]),i=n.numParents(n.skeletonBones[e]);return a<i?-1:i<a?1:0}),null!=this.skeletonBonesBlend){for(;this.matsFastBlend.length<this.skeletonBonesBlend.length;)this.matsFastBlend.push(new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),this.matsFastBlendSort.push(this.matsFastBlendSort.length);this.matsFastBlendSort.sort(function(t,e){var a=n.numParents(n.skeletonBonesBlend[t]),i=n.numParents(n.skeletonBonesBlend[e]);return a<i?-1:i<a?1:0})}},setAction:function(t){if(this.isSkinned){var e=this.data.geom.actions;this.skeletonBones=null!=fs[t]?e.getReserved(t):e.h[t];var a=this.data.geom.mats;this.skeletonMats=null!=fs[t]?a.getReserved(t):a.h[t],this.skeletonBonesBlend=null,this.skeletonMatsBlend=null}else{this.armature.initMats();var i=this.armature.getAction(t);this.skeletonBones=i.bones,this.skeletonMats=i.mats}this.setMats()},setActionBlend:function(t){if(this.isSkinned){this.skeletonBonesBlend=this.skeletonBones,this.skeletonMatsBlend=this.skeletonMats;var e=this.data.geom.actions;this.skeletonBones=null!=fs[t]?e.getReserved(t):e.h[t];var a=this.data.geom.mats;this.skeletonMats=null!=fs[t]?a.getReserved(t):a.h[t]}else{this.armature.initMats();var i=this.armature.getAction(t);this.skeletonBones=i.bones,this.skeletonMats=i.mats}this.setMats()},play:function(t,e,a,i,n){null==n&&(n=!0),null==i&&(i=1),null==a&&(a=.2),null==t&&(t=""),Pe.prototype.play.call(this,t,e,a,i,n),""!=t&&(0<a?this.setActionBlend(t):this.setAction(t)),this.blendFactor=0},update:function(t){if(this.isSkinned||null!=this.skeletonBones||this.setAction(this.armature.actions[0].name),(null==this.object||this.object.visible&&!this.object.culled)&&null!=this.skeletonBones&&0!=this.skeletonBones.length&&(Pe.prototype.update.call(this,t),!this.paused&&0!=this.speed)){for(var e=this.skeletonBones,a=0,i=this.skeletonBones;a<i.length;){var n=i[a];if(++a,null!=n.anim){this.updateTrack(n.anim);break}}if(e==this.skeletonBones){for(var s=0,r=this.skeletonBones.length;s<r;){var o=s++;this.updateAnimSampled(this.skeletonBones[o].anim,this.skeletonMats[o])}if(0<this.blendTime&&null!=this.skeletonBonesBlend){for(var l=0,_=this.skeletonBonesBlend;l<_.length;){var h=_[l];if(++l,null!=h.anim){this.updateTrack(h.anim);break}}for(var f=0,u=this.skeletonBonesBlend.length;f<u;){var c=f++;this.updateAnimSampled(this.skeletonBonesBlend[c].anim,this.skeletonMatsBlend[c])}}if(this.updateConstraints(),null!=this.onUpdates)for(var d=0,g=this.onUpdates;d<g.length;){var p=g[d];++d,p()}for(var m=0,v=this.skeletonBones.length;m<v;){var b=m++;this.multParent(this.matsFastSort[b],this.matsFast,this.skeletonBones,this.skeletonMats)}if(null!=this.skeletonBonesBlend)for(var I=0,M=this.skeletonBonesBlend.length;I<M;){var y=I++;this.multParent(this.matsFastBlendSort[y],this.matsFastBlend,this.skeletonBonesBlend,this.skeletonMatsBlend)}this.isSkinned?this.updateSkinGpu():this.updateBonesOnly()}}},multParent:function(t,e,a,i){var n=e[t];if(null!=this.applyParent&&!this.applyParent[t]){var s=i[t];return n.self._00=s.self._00,n.self._01=s.self._01,n.self._02=s.self._02,n.self._03=s.self._03,n.self._10=s.self._10,n.self._11=s.self._11,n.self._12=s.self._12,n.self._13=s.self._13,n.self._20=s.self._20,n.self._21=s.self._21,n.self._22=s.self._22,n.self._23=s.self._23,n.self._30=s.self._30,n.self._31=s.self._31,n.self._32=s.self._32,void(n.self._33=s.self._33)}var r=a[t].parent,o=this.getBoneIndex(r,a);if(null==r||-1==o){var l=i[t];n.self._00=l.self._00,n.self._01=l.self._01,n.self._02=l.self._02,n.self._03=l.self._03,n.self._10=l.self._10,n.self._11=l.self._11,n.self._12=l.self._12,n.self._13=l.self._13,n.self._20=l.self._20,n.self._21=l.self._21,n.self._22=l.self._22,n.self._23=l.self._23,n.self._30=l.self._30,n.self._31=l.self._31,n.self._32=l.self._32,n.self._33=l.self._33}else{var _=e[o],h=i[t],f=h.self._00,u=h.self._01,c=h.self._02,d=h.self._03,g=h.self._10,p=h.self._11,m=h.self._12,v=h.self._13,b=h.self._20,I=h.self._21,M=h.self._22,y=h.self._23,w=h.self._30,x=h.self._31,C=h.self._32,A=h.self._33,Z=_.self._00,z=_.self._10,B=_.self._20,k=_.self._30;n.self._00=f*Z+u*z+c*B+d*k,n.self._10=g*Z+p*z+m*B+v*k,n.self._20=b*Z+I*z+M*B+y*k,n.self._30=w*Z+x*z+C*B+A*k,Z=_.self._01,z=_.self._11,B=_.self._21,k=_.self._31,n.self._01=f*Z+u*z+c*B+d*k,n.self._11=g*Z+p*z+m*B+v*k,n.self._21=b*Z+I*z+M*B+y*k,n.self._31=w*Z+x*z+C*B+A*k,Z=_.self._02,z=_.self._12,B=_.self._22,k=_.self._32,n.self._02=f*Z+u*z+c*B+d*k,n.self._12=g*Z+p*z+m*B+v*k,n.self._22=b*Z+I*z+M*B+y*k,n.self._32=w*Z+x*z+C*B+A*k,Z=_.self._03,z=_.self._13,B=_.self._23,k=_.self._33,n.self._03=f*Z+u*z+c*B+d*k,n.self._13=g*Z+p*z+m*B+v*k,n.self._23=b*Z+I*z+M*B+y*k,n.self._33=w*Z+x*z+C*B+A*k}},updateConstraints:function(){if(null!=this.data){var t=this.data.raw.skin.constraints;if(null!=t){if(null==this.constraintTargets){this.constraintTargets=[],this.constraintTargetsI=[];for(var e=0;e<t.length;){var a=t[e];++e;var i=h_.active.getChild(a.target);this.constraintTargets.push(i);var n=null;if(null!=i){var s=i.raw.transform.values,r=(n=new da(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11],s[12],s[13],s[14],s[15])).self._00,o=n.self._01,l=n.self._02,_=n.self._03,h=n.self._10,f=n.self._11,u=n.self._12,c=n.self._13,d=n.self._20,g=n.self._21,p=n.self._22,m=n.self._23,v=n.self._30,b=n.self._31,I=n.self._32,M=n.self._33,y=r*f-o*h,w=r*u-l*h,x=r*c-_*h,C=o*u-l*f,A=o*c-_*f,Z=l*c-_*u,z=d*b-g*v,B=d*I-p*v,k=d*M-m*v,S=g*I-p*b,X=g*M-m*b,Y=p*M-m*I,N=y*Y-w*X+x*S+C*k-A*B+Z*z;0==N?(n.self._00=1,n.self._01=0,n.self._02=0,n.self._03=0,n.self._10=0,n.self._11=1,n.self._12=0,n.self._13=0,n.self._20=0,n.self._21=0,n.self._22=1,n.self._23=0,n.self._30=0,n.self._31=0,n.self._32=0,n.self._33=1):(N=1/N,n.self._00=(f*Y-u*X+c*S)*N,n.self._01=(l*X-o*Y-_*S)*N,n.self._02=(b*Z-I*A+M*C)*N,n.self._03=(p*A-g*Z-m*C)*N,n.self._10=(u*k-h*Y-c*B)*N,n.self._11=(r*Y-l*k+_*B)*N,n.self._12=(I*x-v*Z-M*w)*N,n.self._13=(d*Z-p*x+m*w)*N,n.self._20=(h*X-f*k+c*z)*N,n.self._21=(o*k-r*X-_*z)*N,n.self._22=(v*A-b*x+M*y)*N,n.self._23=(g*x-d*A-m*y)*N,n.self._30=(f*B-h*S-u*z)*N,n.self._31=(r*S-o*B+l*z)*N,n.self._32=(b*w-v*C-I*y)*N,n.self._33=(d*C-g*w+p*y)*N)}this.constraintTargetsI.push(n)}this.constraintMats=new Be}for(var L=0,G=t.length;L<G;){var W=L++,D=t[W],T=this.getBone(D.bone);if(null!=T){var V=this.constraintTargets[W];if(null!=V&&"CHILD_OF"==D.type){var K=this.constraintMats.h[T.__id__];null==K&&(K=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.constraintMats.set(T,K));var j=this.object.parent.transform.world;K.self._00=j.self._00,K.self._01=j.self._01,K.self._02=j.self._02,K.self._03=j.self._03,K.self._10=j.self._10,K.self._11=j.self._11,K.self._12=j.self._12,K.self._13=j.self._13,K.self._20=j.self._20,K.self._21=j.self._21,K.self._22=j.self._22,K.self._23=j.self._23,K.self._30=j.self._30,K.self._31=j.self._31,K.self._32=j.self._32,K.self._33=j.self._33;var R=this.constraintTargetsI[W],H=K.self._00,P=K.self._01,F=K.self._02,O=K.self._03,E=K.self._10,U=K.self._11,J=K.self._12,Q=K.self._13,q=K.self._20,$=K.self._21,tt=K.self._22,et=K.self._23,at=K.self._30,it=K.self._31,nt=K.self._32,st=K.self._33,rt=R.self._00,ot=R.self._10,lt=R.self._20,_t=R.self._30;K.self._00=H*rt+P*ot+F*lt+O*_t,K.self._10=E*rt+U*ot+J*lt+Q*_t,K.self._20=q*rt+$*ot+tt*lt+et*_t,K.self._30=at*rt+it*ot+nt*lt+st*_t,rt=R.self._01,ot=R.self._11,lt=R.self._21,_t=R.self._31,K.self._01=H*rt+P*ot+F*lt+O*_t,K.self._11=E*rt+U*ot+J*lt+Q*_t,K.self._21=q*rt+$*ot+tt*lt+et*_t,K.self._31=at*rt+it*ot+nt*lt+st*_t,rt=R.self._02,ot=R.self._12,lt=R.self._22,_t=R.self._32,K.self._02=H*rt+P*ot+F*lt+O*_t,K.self._12=E*rt+U*ot+J*lt+Q*_t,K.self._22=q*rt+$*ot+tt*lt+et*_t,K.self._32=at*rt+it*ot+nt*lt+st*_t,rt=R.self._03,ot=R.self._13,lt=R.self._23,_t=R.self._33,K.self._03=H*rt+P*ot+F*lt+O*_t,K.self._13=E*rt+U*ot+J*lt+Q*_t,K.self._23=q*rt+$*ot+tt*lt+et*_t,K.self._33=at*rt+it*ot+nt*lt+st*_t;var ht=V.transform.world,ft=K.self._00,ut=K.self._01,ct=K.self._02,dt=K.self._03,gt=K.self._10,pt=K.self._11,mt=K.self._12,vt=K.self._13,bt=K.self._20,It=K.self._21,Mt=K.self._22,yt=K.self._23,wt=K.self._30,xt=K.self._31,Ct=K.self._32,At=K.self._33,Zt=ht.self._00,zt=ht.self._10,Bt=ht.self._20,kt=ht.self._30;K.self._00=ft*Zt+ut*zt+ct*Bt+dt*kt,K.self._10=gt*Zt+pt*zt+mt*Bt+vt*kt,K.self._20=bt*Zt+It*zt+Mt*Bt+yt*kt,K.self._30=wt*Zt+xt*zt+Ct*Bt+At*kt,Zt=ht.self._01,zt=ht.self._11,Bt=ht.self._21,kt=ht.self._31,K.self._01=ft*Zt+ut*zt+ct*Bt+dt*kt,K.self._11=gt*Zt+pt*zt+mt*Bt+vt*kt,K.self._21=bt*Zt+It*zt+Mt*Bt+yt*kt,K.self._31=wt*Zt+xt*zt+Ct*Bt+At*kt,Zt=ht.self._02,zt=ht.self._12,Bt=ht.self._22,kt=ht.self._32,K.self._02=ft*Zt+ut*zt+ct*Bt+dt*kt,K.self._12=gt*Zt+pt*zt+mt*Bt+vt*kt,K.self._22=bt*Zt+It*zt+Mt*Bt+yt*kt,K.self._32=wt*Zt+xt*zt+Ct*Bt+At*kt,Zt=ht.self._03,zt=ht.self._13,Bt=ht.self._23,kt=ht.self._33,K.self._03=ft*Zt+ut*zt+ct*Bt+dt*kt,K.self._13=gt*Zt+pt*zt+mt*Bt+vt*kt,K.self._23=bt*Zt+It*zt+Mt*Bt+yt*kt,K.self._33=wt*Zt+xt*zt+Ct*Bt+At*kt;var St=f_.m1,Xt=this.object.parent.transform.world,Yt=Xt.self._00,Nt=Xt.self._01,Lt=Xt.self._02,Gt=Xt.self._03,Wt=Xt.self._10,Dt=Xt.self._11,Tt=Xt.self._12,Vt=Xt.self._13,Kt=Xt.self._20,jt=Xt.self._21,Rt=Xt.self._22,Ht=Xt.self._23,Pt=Xt.self._30,Ft=Xt.self._31,Ot=Xt.self._32,Et=Xt.self._33,Ut=Yt*Dt-Nt*Wt,Jt=Yt*Tt-Lt*Wt,Qt=Yt*Vt-Gt*Wt,qt=Nt*Tt-Lt*Dt,$t=Nt*Vt-Gt*Dt,te=Lt*Vt-Gt*Tt,ee=Kt*Ft-jt*Pt,ae=Kt*Ot-Rt*Pt,ie=Kt*Et-Ht*Pt,ne=jt*Ot-Rt*Ft,se=jt*Et-Ht*Ft,re=Rt*Et-Ht*Ot,oe=Ut*re-Jt*se+Qt*ne+qt*ie-$t*ae+te*ee;0==oe?(St.self._00=1,St.self._01=0,St.self._02=0,St.self._03=0,St.self._10=0,St.self._11=1,St.self._12=0,St.self._13=0,St.self._20=0,St.self._21=0,St.self._22=1,St.self._23=0,St.self._30=0,St.self._31=0,St.self._32=0,St.self._33=1):(oe=1/oe,St.self._00=(Dt*re-Tt*se+Vt*ne)*oe,St.self._01=(Lt*se-Nt*re-Gt*ne)*oe,St.self._02=(Ft*te-Ot*$t+Et*qt)*oe,St.self._03=(Rt*$t-jt*te-Ht*qt)*oe,St.self._10=(Tt*ie-Wt*re-Vt*ae)*oe,St.self._11=(Yt*re-Lt*ie+Gt*ae)*oe,St.self._12=(Ot*Qt-Pt*te-Et*Jt)*oe,St.self._13=(Kt*te-Rt*Qt+Ht*Jt)*oe,St.self._20=(Wt*se-Dt*ie+Vt*ee)*oe,St.self._21=(Nt*ie-Yt*se-Gt*ee)*oe,St.self._22=(Pt*$t-Ft*Qt+Et*Ut)*oe,St.self._23=(jt*Qt-Kt*$t-Ht*Ut)*oe,St.self._30=(Dt*ae-Wt*ne-Tt*ee)*oe,St.self._31=(Yt*ne-Nt*ae+Lt*ee)*oe,St.self._32=(Ft*Jt-Pt*qt-Ot*Ut)*oe,St.self._33=(Kt*qt-jt*Jt+Rt*Ut)*oe);var le=f_.m1,_e=K.self._00,he=K.self._01,fe=K.self._02,ue=K.self._03,ce=K.self._10,de=K.self._11,ge=K.self._12,pe=K.self._13,me=K.self._20,ve=K.self._21,be=K.self._22,Ie=K.self._23,Me=K.self._30,ye=K.self._31,we=K.self._32,xe=K.self._33,Ce=le.self._00,Ae=le.self._10,Ze=le.self._20,ze=le.self._30;K.self._00=_e*Ce+he*Ae+fe*Ze+ue*ze,K.self._10=ce*Ce+de*Ae+ge*Ze+pe*ze,K.self._20=me*Ce+ve*Ae+be*Ze+Ie*ze,K.self._30=Me*Ce+ye*Ae+we*Ze+xe*ze,Ce=le.self._01,Ae=le.self._11,Ze=le.self._21,ze=le.self._31,K.self._01=_e*Ce+he*Ae+fe*Ze+ue*ze,K.self._11=ce*Ce+de*Ae+ge*Ze+pe*ze,K.self._21=me*Ce+ve*Ae+be*Ze+Ie*ze,K.self._31=Me*Ce+ye*Ae+we*Ze+xe*ze,Ce=le.self._02,Ae=le.self._12,Ze=le.self._22,ze=le.self._32,K.self._02=_e*Ce+he*Ae+fe*Ze+ue*ze,K.self._12=ce*Ce+de*Ae+ge*Ze+pe*ze,K.self._22=me*Ce+ve*Ae+be*Ze+Ie*ze,K.self._32=Me*Ce+ye*Ae+we*Ze+xe*ze,Ce=le.self._03,Ae=le.self._13,Ze=le.self._23,ze=le.self._33,K.self._03=_e*Ce+he*Ae+fe*Ze+ue*ze,K.self._13=ce*Ce+de*Ae+ge*Ze+pe*ze,K.self._23=me*Ce+ve*Ae+be*Ze+Ie*ze,K.self._33=Me*Ce+ye*Ae+we*Ze+xe*ze}}}}}},onUpdates:null,updateBonesOnly:function(){if(null!=this.boneChildren)for(var t=0,e=this.skeletonBones.length;t<e;){var a=t++,i=this.skeletonBones[a],n=f_.m,s=this.matsFast[a];n.self._00=s.self._00,n.self._01=s.self._01,n.self._02=s.self._02,n.self._03=s.self._03,n.self._10=s.self._10,n.self._11=s.self._11,n.self._12=s.self._12,n.self._13=s.self._13,n.self._20=s.self._20,n.self._21=s.self._21,n.self._22=s.self._22,n.self._23=s.self._23,n.self._30=s.self._30,n.self._31=s.self._31,n.self._32=s.self._32,n.self._33=s.self._33,this.updateBoneChildren(i,f_.m)}},updateSkinGpu:function(){var t=this.skeletonBones,e=this.blendCurrent/this.blendTime;e=e*e*(3-2*e),0!=this.blendFactor&&(e=1-this.blendFactor);for(var a=0,i=t.length;a<i;){var n=a++;if(null!=this.constraintMats){var s=this.constraintMats.h[t[n].__id__];if(null!=s){this.updateSkinBuffer(s,n);continue}}var r=f_.m,o=this.matsFast[n];if(r.self._00=o.self._00,r.self._01=o.self._01,r.self._02=o.self._02,r.self._03=o.self._03,r.self._10=o.self._10,r.self._11=o.self._11,r.self._12=o.self._12,r.self._13=o.self._13,r.self._20=o.self._20,r.self._21=o.self._21,r.self._22=o.self._22,r.self._23=o.self._23,r.self._30=o.self._30,r.self._31=o.self._31,r.self._32=o.self._32,r.self._33=o.self._33,0<this.blendTime&&null!=this.skeletonBonesBlend){var l=f_.m1,_=this.matsFastBlend[n];l.self._00=_.self._00,l.self._01=_.self._01,l.self._02=_.self._02,l.self._03=_.self._03,l.self._10=_.self._10,l.self._11=_.self._11,l.self._12=_.self._12,l.self._13=_.self._13,l.self._20=_.self._20,l.self._21=_.self._21,l.self._22=_.self._22,l.self._23=_.self._23,l.self._30=_.self._30,l.self._31=_.self._31,l.self._32=_.self._32,l.self._33=_.self._33;var h=f_.m1,f=f_.vpos,u=f_.q1,c=f_.vscl;f.x=h.self._30,f.y=h.self._31,f.z=h.self._32;var d=da.helpVec;d.x=h.self._00,d.y=h.self._01,d.z=h.self._02,d.w=1;var g=d;c.x=Math.sqrt(g.x*g.x+g.y*g.y+g.z*g.z);var p=da.helpVec;p.x=h.self._10,p.y=h.self._11,p.z=h.self._12,p.w=1;var m=p;c.y=Math.sqrt(m.x*m.x+m.y*m.y+m.z*m.z);var v=da.helpVec;v.x=h.self._20,v.y=h.self._21,v.z=h.self._22,v.w=1;var b=v;c.z=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);var I=h.self,M=I._12,y=I._22,w=I._32,x=I._13,C=I._23,A=I._33,Z=I._11*(y*A-w*C)-I._21*(M*A-w*x)+I._31*(M*C-y*x),z=I._12,B=I._22,k=I._32,S=I._13,X=I._23,Y=I._33,N=I._10*(B*Y-k*X)-I._20*(z*Y-k*S)+I._30*(z*X-B*S),L=I._11,G=I._21,W=I._31,D=I._13,T=I._23,V=I._33,K=I._10*(G*V-W*T)-I._20*(L*V-W*D)+I._30*(L*T-G*D),j=I._11,R=I._21,H=I._31,P=I._12,F=I._22,O=I._32,E=I._10*(R*O-H*F)-I._20*(j*O-H*P)+I._30*(j*F-R*P);I._00*Z-I._01*N+I._02*K-I._03*E<0&&(c.x=-c.x);var U=1/c.x;da.helpMat.self._00=h.self._00*U,da.helpMat.self._01=h.self._01*U,da.helpMat.self._02=h.self._02*U,U=1/c.y,da.helpMat.self._10=h.self._10*U,da.helpMat.self._11=h.self._11*U,da.helpMat.self._12=h.self._12*U,U=1/c.z,da.helpMat.self._20=h.self._20*U,da.helpMat.self._21=h.self._21*U,da.helpMat.self._22=h.self._22*U;var J=da.helpMat,Q=J.self._00,q=J.self._10,$=J.self._20,tt=J.self._01,et=J.self._11,at=J.self._21,it=J.self._02,nt=J.self._12,st=J.self._22,rt=Q+et+st,ot=0;0<rt?(ot=.5/Math.sqrt(rt+1),u.w=.25/ot,u.x=(nt-at)*ot,u.y=($-it)*ot,u.z=(tt-q)*ot):et<Q&&st<Q?(ot=2*Math.sqrt(1+Q-et-st),u.w=(nt-at)/ot,u.x=.25*ot,u.y=(q+tt)/ot,u.z=($+it)/ot):st<et?(ot=2*Math.sqrt(1+et-Q-st),u.w=($-it)/ot,u.x=(q+tt)/ot,u.y=.25*ot,u.z=(at+nt)/ot):(ot=2*Math.sqrt(1+st-Q-et),u.w=(tt-q)/ot,u.x=($+it)/ot,u.y=(at+nt)/ot,u.z=.25*ot);var lt=f_.m,_t=f_.vpos2,ht=f_.q2,ft=f_.vscl2;_t.x=lt.self._30,_t.y=lt.self._31,_t.z=lt.self._32;var ut=da.helpVec;ut.x=lt.self._00,ut.y=lt.self._01,ut.z=lt.self._02,ut.w=1;var ct=ut;ft.x=Math.sqrt(ct.x*ct.x+ct.y*ct.y+ct.z*ct.z);var dt=da.helpVec;dt.x=lt.self._10,dt.y=lt.self._11,dt.z=lt.self._12,dt.w=1;var gt=dt;ft.y=Math.sqrt(gt.x*gt.x+gt.y*gt.y+gt.z*gt.z);var pt=da.helpVec;pt.x=lt.self._20,pt.y=lt.self._21,pt.z=lt.self._22,pt.w=1;var mt=pt;ft.z=Math.sqrt(mt.x*mt.x+mt.y*mt.y+mt.z*mt.z);var vt=lt.self,bt=vt._12,It=vt._22,Mt=vt._32,yt=vt._13,wt=vt._23,xt=vt._33,Ct=vt._11*(It*xt-Mt*wt)-vt._21*(bt*xt-Mt*yt)+vt._31*(bt*wt-It*yt),At=vt._12,Zt=vt._22,zt=vt._32,Bt=vt._13,kt=vt._23,St=vt._33,Xt=vt._10*(Zt*St-zt*kt)-vt._20*(At*St-zt*Bt)+vt._30*(At*kt-Zt*Bt),Yt=vt._11,Nt=vt._21,Lt=vt._31,Gt=vt._13,Wt=vt._23,Dt=vt._33,Tt=vt._10*(Nt*Dt-Lt*Wt)-vt._20*(Yt*Dt-Lt*Gt)+vt._30*(Yt*Wt-Nt*Gt),Vt=vt._11,Kt=vt._21,jt=vt._31,Rt=vt._12,Ht=vt._22,Pt=vt._32,Ft=vt._10*(Kt*Pt-jt*Ht)-vt._20*(Vt*Pt-jt*Rt)+vt._30*(Vt*Ht-Kt*Rt);vt._00*Ct-vt._01*Xt+vt._02*Tt-vt._03*Ft<0&&(ft.x=-ft.x);var Ot=1/ft.x;da.helpMat.self._00=lt.self._00*Ot,da.helpMat.self._01=lt.self._01*Ot,da.helpMat.self._02=lt.self._02*Ot,Ot=1/ft.y,da.helpMat.self._10=lt.self._10*Ot,da.helpMat.self._11=lt.self._11*Ot,da.helpMat.self._12=lt.self._12*Ot,Ot=1/ft.z,da.helpMat.self._20=lt.self._20*Ot,da.helpMat.self._21=lt.self._21*Ot,da.helpMat.self._22=lt.self._22*Ot;var Et=da.helpMat,Ut=Et.self._00,Jt=Et.self._10,Qt=Et.self._20,qt=Et.self._01,$t=Et.self._11,te=Et.self._21,ee=Et.self._02,ae=Et.self._12,ie=Et.self._22,ne=Ut+$t+ie,se=0;0<ne?(se=.5/Math.sqrt(ne+1),ht.w=.25/se,ht.x=(ae-te)*se,ht.y=(Qt-ee)*se,ht.z=(qt-Jt)*se):$t<Ut&&ie<Ut?(se=2*Math.sqrt(1+Ut-$t-ie),ht.w=(ae-te)/se,ht.x=.25*se,ht.y=(Jt+qt)/se,ht.z=(Qt+ee)/se):ie<$t?(se=2*Math.sqrt(1+$t-Ut-ie),ht.w=(Qt-ee)/se,ht.x=(Jt+qt)/se,ht.y=.25*se,ht.z=(te+ae)/se):(se=2*Math.sqrt(1+ie-Ut-$t),ht.w=(qt-Jt)/se,ht.x=(Qt+ee)/se,ht.y=(te+ae)/se,ht.z=.25*se);var re=f_.v1,oe=f_.vpos,le=f_.vpos2;re.x=oe.x+(le.x-oe.x)*e,re.y=oe.y+(le.y-oe.y)*e,re.z=oe.z+(le.z-oe.z)*e;var _e=f_.v2,he=f_.vscl,fe=f_.vscl2;_e.x=he.x+(fe.x-he.x)*e,_e.y=he.y+(fe.y-he.y)*e,_e.z=he.z+(fe.z-he.z)*e;var ue=f_.q3,ce=f_.q1,de=f_.q2,ge=ce.x,pe=ce.y,me=ce.z,ve=ce.w;ce.x*de.x+ce.y*de.y+ce.z*de.z+ce.w*de.w<0&&(ge=-ge,pe=-pe,me=-me,ve=-ve),ue.x=ge+(de.x-ge)*e,ue.y=pe+(de.y-pe)*e,ue.z=me+(de.z-me)*e,ue.w=ve+(de.w-ve)*e;var be=Math.sqrt(ue.x*ue.x+ue.y*ue.y+ue.z*ue.z+ue.w*ue.w);0==be?(ue.x=0,ue.y=0,ue.z=0,ue.w=0):(be=1/be,ue.x*=be,ue.y*=be,ue.z*=be,ue.w*=be);var Ie=f_.m,Me=f_.q3,ye=Me.x,we=Me.y,xe=Me.z,Ce=Me.w,Ae=ye+ye,Ze=we+we,ze=xe+xe,Be=ye*Ae,ke=ye*Ze,Se=ye*ze,Xe=we*Ze,Ye=we*ze,Ne=xe*ze,Le=Ce*Ae,Ge=Ce*Ze,We=Ce*ze;Ie.self._00=1-(Xe+Ne),Ie.self._10=ke-We,Ie.self._20=Se+Ge,Ie.self._01=ke+We,Ie.self._11=1-(Be+Ne),Ie.self._21=Ye-Le,Ie.self._02=Se-Ge,Ie.self._12=Ye+Le,Ie.self._22=1-(Be+Xe),Ie.self._03=0,Ie.self._13=0,Ie.self._23=0,Ie.self._30=0,Ie.self._31=0,Ie.self._32=0,Ie.self._33=1;var De=f_.m,Te=f_.v2,Ve=Te.x,Ke=Te.y,je=Te.z;De.self._00*=Ve,De.self._01*=Ve,De.self._02*=Ve,De.self._03*=Ve,De.self._10*=Ke,De.self._11*=Ke,De.self._12*=Ke,De.self._13*=Ke,De.self._20*=je,De.self._21*=je,De.self._22*=je,De.self._23*=je,f_.m.self._30=f_.v1.x,f_.m.self._31=f_.v1.y,f_.m.self._32=f_.v1.z}if(null!=this.absMats&&n<this.absMats.length){var Re=this.absMats[n],He=f_.m;Re.self._00=He.self._00,Re.self._01=He.self._01,Re.self._02=He.self._02,Re.self._03=He.self._03,Re.self._10=He.self._10,Re.self._11=He.self._11,Re.self._12=He.self._12,Re.self._13=He.self._13,Re.self._20=He.self._20,Re.self._21=He.self._21,Re.self._22=He.self._22,Re.self._23=He.self._23,Re.self._30=He.self._30,Re.self._31=He.self._31,Re.self._32=He.self._32,Re.self._33=He.self._33}null!=this.boneChildren&&this.updateBoneChildren(t[n],f_.m);var Pe=f_.m,Fe=f_.m,Oe=this.data.geom.skeletonTransformsI[n],Ee=Oe.self._00,Ue=Oe.self._01,Je=Oe.self._02,Qe=Oe.self._03,qe=Oe.self._10,$e=Oe.self._11,ta=Oe.self._12,ea=Oe.self._13,aa=Oe.self._20,ia=Oe.self._21,na=Oe.self._22,sa=Oe.self._23,ra=Oe.self._30,oa=Oe.self._31,la=Oe.self._32,_a=Oe.self._33,ha=Fe.self._00,fa=Fe.self._10,ua=Fe.self._20,ca=Fe.self._30;Pe.self._00=Ee*ha+Ue*fa+Je*ua+Qe*ca,Pe.self._10=qe*ha+$e*fa+ta*ua+ea*ca,Pe.self._20=aa*ha+ia*fa+na*ua+sa*ca,Pe.self._30=ra*ha+oa*fa+la*ua+_a*ca,ha=Fe.self._01,fa=Fe.self._11,ua=Fe.self._21,ca=Fe.self._31,Pe.self._01=Ee*ha+Ue*fa+Je*ua+Qe*ca,Pe.self._11=qe*ha+$e*fa+ta*ua+ea*ca,Pe.self._21=aa*ha+ia*fa+na*ua+sa*ca,Pe.self._31=ra*ha+oa*fa+la*ua+_a*ca,ha=Fe.self._02,fa=Fe.self._12,ua=Fe.self._22,ca=Fe.self._32,Pe.self._02=Ee*ha+Ue*fa+Je*ua+Qe*ca,Pe.self._12=qe*ha+$e*fa+ta*ua+ea*ca,Pe.self._22=aa*ha+ia*fa+na*ua+sa*ca,Pe.self._32=ra*ha+oa*fa+la*ua+_a*ca,ha=Fe.self._03,fa=Fe.self._13,ua=Fe.self._23,ca=Fe.self._33,Pe.self._03=Ee*ha+Ue*fa+Je*ua+Qe*ca,Pe.self._13=qe*ha+$e*fa+ta*ua+ea*ca,Pe.self._23=aa*ha+ia*fa+na*ua+sa*ca,Pe.self._33=ra*ha+oa*fa+la*ua+_a*ca,this.updateSkinBuffer(f_.m,n)}},updateSkinBuffer:function(t,e){var a=f_.vpos,i=f_.q1,n=f_.vscl;a.x=t.self._30,a.y=t.self._31,a.z=t.self._32;var s=da.helpVec;s.x=t.self._00,s.y=t.self._01,s.z=t.self._02,s.w=1;var r=s;n.x=Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z);var o=da.helpVec;o.x=t.self._10,o.y=t.self._11,o.z=t.self._12,o.w=1;var l=o;n.y=Math.sqrt(l.x*l.x+l.y*l.y+l.z*l.z);var _=da.helpVec;_.x=t.self._20,_.y=t.self._21,_.z=t.self._22,_.w=1;var h=_;n.z=Math.sqrt(h.x*h.x+h.y*h.y+h.z*h.z);var f=t.self,u=f._12,c=f._22,d=f._32,g=f._13,p=f._23,m=f._33,v=f._11*(c*m-d*p)-f._21*(u*m-d*g)+f._31*(u*p-c*g),b=f._12,I=f._22,M=f._32,y=f._13,w=f._23,x=f._33,C=f._10*(I*x-M*w)-f._20*(b*x-M*y)+f._30*(b*w-I*y),A=f._11,Z=f._21,z=f._31,B=f._13,k=f._23,S=f._33,X=f._10*(Z*S-z*k)-f._20*(A*S-z*B)+f._30*(A*k-Z*B),Y=f._11,N=f._21,L=f._31,G=f._12,W=f._22,D=f._32,T=f._10*(N*D-L*W)-f._20*(Y*D-L*G)+f._30*(Y*W-N*G);f._00*v-f._01*C+f._02*X-f._03*T<0&&(n.x=-n.x);var V=1/n.x;da.helpMat.self._00=t.self._00*V,da.helpMat.self._01=t.self._01*V,da.helpMat.self._02=t.self._02*V,V=1/n.y,da.helpMat.self._10=t.self._10*V,da.helpMat.self._11=t.self._11*V,da.helpMat.self._12=t.self._12*V,V=1/n.z,da.helpMat.self._20=t.self._20*V,da.helpMat.self._21=t.self._21*V,da.helpMat.self._22=t.self._22*V;var K=da.helpMat,j=K.self._00,R=K.self._10,H=K.self._20,P=K.self._01,F=K.self._11,O=K.self._21,E=K.self._02,U=K.self._12,J=K.self._22,Q=j+F+J,q=0;0<Q?(q=.5/Math.sqrt(Q+1),i.w=.25/q,i.x=(U-O)*q,i.y=(H-E)*q,i.z=(P-R)*q):F<j&&J<j?(q=2*Math.sqrt(1+j-F-J),i.w=(U-O)/q,i.x=.25*q,i.y=(R+P)/q,i.z=(H+E)/q):J<F?(q=2*Math.sqrt(1+F-j-J),i.w=(H-E)/q,i.x=(R+P)/q,i.y=.25*q,i.z=(O+U)/q):(q=2*Math.sqrt(1+J-j-F),i.w=(P-R)/q,i.x=(H+E)/q,i.y=(O+U)/q,i.z=.25*q);var $=f_.q1,tt=Math.sqrt($.x*$.x+$.y*$.y+$.z*$.z+$.w*$.w);0==tt?($.x=0,$.y=0,$.z=0,$.w=0):(tt=1/tt,$.x*=tt,$.y*=tt,$.z*=tt,$.w*=tt);var et=f_.q2;et.x=f_.vpos.x,et.y=f_.vpos.y,et.z=f_.vpos.z,et.w=0;var at=f_.q2,it=f_.q2,nt=f_.q1,st=it.x,rt=it.y,ot=it.z,lt=it.w,_t=nt.x,ht=nt.y,ft=nt.z,ut=nt.w;at.x=st*ut+lt*_t+rt*ft-ot*ht,at.y=lt*ht-st*ft+rt*ut+ot*_t,at.z=lt*ft+st*ht-rt*_t+ot*ut,at.w=lt*ut-st*_t-rt*ht-ot*ft,this.skinBuffer[8*e]=f_.q1.x,this.skinBuffer[8*e+1]=f_.q1.y,this.skinBuffer[8*e+2]=f_.q1.z,this.skinBuffer[8*e+3]=f_.q1.w,this.skinBuffer[8*e+4]=.5*f_.q2.x,this.skinBuffer[8*e+5]=.5*f_.q2.y,this.skinBuffer[8*e+6]=.5*f_.q2.z,this.skinBuffer[8*e+7]=.5*f_.q2.w},getBone:function(t){if(null==this.skeletonBones)return null;for(var e=0,a=this.skeletonBones;e<a.length;){var i=a[e];if(++e,i.name==t)return i}return null},getBoneIndex:function(t,e){if(null==e&&(e=this.skeletonBones),null!=e)for(var a=0,i=e.length;a<i;){var n=a++;if(e[n]==t)return n}return-1},__class__:f_});var mt=function(){this.isEmpty=!1,this.culledShadow=!1,this.culledMesh=!1,this.culled=!1,this.visibleShadow=!0,this.visibleMesh=!0,this.visible=!0,this.animation=null,this.lods=null,this.children=[],this.parent=null,this.traits=[],this.constraints=null,this.name="",this.raw=null,this.uid=mt.uidCounter++,this.urandom=mt.seededRandom(),this.transform=new je(this),this.isEmpty=d_.getClass(this)==mt,this.isEmpty&&null!=h_.active&&h_.active.empties.push(this)};(i["iron.object.Object"]=mt).__name__=!0,mt.seededRandom=function(){return mt.seed=(9301*mt.seed+49297)%233280,mt.seed/233280},mt.prototype={uid:null,urandom:null,raw:null,name:null,transform:null,constraints:null,traits:null,parent:null,children:null,lods:null,animation:null,visible:null,visibleMesh:null,visibleShadow:null,culled:null,culledMesh:null,culledShadow:null,isEmpty:null,addChild:function(t,e){null==e&&(e=!1),t.parent!=this&&(this.children.push(t),t.parent=this,e&&t.transform.applyParentInverse())},remove:function(){for(this.isEmpty&&null!=h_.active&&q.remove(h_.active.empties,this),null!=this.animation&&this.animation.remove();0<this.children.length;)this.children[0].remove();for(;0<this.traits.length;)this.traits[0].remove();null!=this.parent&&(q.remove(this.parent.children,this),this.parent=null)},getChild:function(t){if(this.name==t)return this;for(var e=0,a=this.children;e<a.length;){var i=a[e];++e;var n=i.getChild(t);if(null!=n)return n}return null},addTrait:function(t){if(this.traits.push(t),t.object=this,null!=t._add){for(var e=0,a=t._add;e<a.length;){var i=a[e];++e,i()}t._add=null}},removeTrait:function(t){if(null!=t._init){for(var e=0,a=t._init;e<a.length;){var i=a[e];++e,P.removeInit(i)}t._init=null}if(null!=t._update){for(var n=0,s=t._update;n<s.length;){var r=s[n];++n,P.removeUpdate(r)}t._update=null}if(null!=t._lateUpdate){for(var o=0,l=t._lateUpdate;o<l.length;){var _=l[o];++o,P.removeLateUpdate(_)}t._lateUpdate=null}if(null!=t._render){for(var h=0,f=t._render;h<f.length;){var u=f[h];++h,P.removeRender(u)}t._render=null}if(null!=t._render2D){for(var c=0,d=t._render2D;c<d.length;){var g=d[c];++c,P.removeRender2D(g)}t._render2D=null}if(null!=t._remove){for(var p=0,m=t._remove;p<m.length;){var v=m[p];++p,v()}t._remove=null}q.remove(this.traits,t)},getTrait:function(t){for(var e=0,a=this.traits;e<a.length;){var i=a[e];if(++e,(null==i?null:d_.getClass(i))==t)return i}return null},getParentArmature:function(t){for(var e=0,a=h_.active.animations;e<a.length;){var i=a[e];if(++e,null!=i.armature&&i.armature.name==t)return i}return null},setupAnimation:function(t){var e=this;null!=this.raw.parent_bone&&h_.active.notifyOnInit(function(){var t=e.getParentArmature(e.parent.name);null!=t&&t.addBoneChild(e.raw.parent_bone,e)}),null!=t&&(this.animation=new yt(this,t))},__class__:mt};var vt=function(t){if(this.frustumPlanes=null,this.prevV=null,mt.call(this),this.data=t,this.buildProjection(),this.V=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.VP=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),t.raw.frustum_culling){this.frustumPlanes=[];for(var e=0;e<6;){e++;this.frustumPlanes.push(new bt)}}h_.active.cameras.push(this)};(i["iron.object.CameraObject"]=vt).__name__=!0,vt.buildViewFrustum=function(t,e){var a=e[0],i=a.normal;i.x=t.self._03+t.self._00,i.y=t.self._13+t.self._10,i.z=t.self._23+t.self._20,i.w=1,a.constant=t.self._33+t.self._30;var n=e[1],s=n.normal;s.x=t.self._03-t.self._00,s.y=t.self._13-t.self._10,s.z=t.self._23-t.self._20,s.w=1,n.constant=t.self._33-t.self._30;var r=e[2],o=r.normal;o.x=t.self._03-t.self._01,o.y=t.self._13-t.self._11,o.z=t.self._23-t.self._21,o.w=1,r.constant=t.self._33-t.self._31;var l=e[3],_=l.normal;_.x=t.self._03+t.self._01,_.y=t.self._13+t.self._11,_.z=t.self._23+t.self._21,_.w=1,l.constant=t.self._33+t.self._31;var h=e[4],f=h.normal;f.x=t.self._02,f.y=t.self._12,f.z=t.self._22,f.w=1,h.constant=t.self._32;var u=e[5],c=u.normal;c.x=t.self._03-t.self._02,c.y=t.self._13-t.self._12,c.z=t.self._23-t.self._22,c.w=1,u.constant=t.self._33-t.self._32;for(var d=0;d<e.length;){var g=e[d];++d,g.normalize()}},vt.sphereInFrustum=function(t,e,a,i,n,s){null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),null==a&&(a=1);for(var r=e.radius*a,o=0;o<t.length;){var l=t[o];++o;var _=vt.sphereCenter;if(_.x=e.world.self._30+i,_.y=e.world.self._31+n,_.z=e.world.self._32+s,_.w=1,l.distanceToSphere(vt.sphereCenter,r)+2*r<0)return!1}return!0},vt.__super__=mt,vt.prototype=s(mt.prototype,{data:null,P:null,V:null,prevV:null,VP:null,frustumPlanes:null,buildProjection:function(t){null==t&&(t=co.windowWidth()/co.windowHeight());var e=null!=this.data.raw.aspect?this.data.raw.aspect:t;if(null!=this.data.raw.ortho_scale){var a=this.data.raw.ortho_scale,i=-1*e*a,n=e*a,s=-1*a,r=-1*this.data.raw.far_plane,o=this.data.raw.far_plane,l=n-i,_=a-s,h=o-r,f=-(n+i)/l,u=-(a+s)/_,c=-(o+r)/h;this.P=new da(2/l,0,0,f,0,2/_,0,u,0,0,-2/h,c,0,0,0,1)}else{var d=this.data.raw.near_plane,g=this.data.raw.far_plane,p=1/Math.tan(this.data.raw.fov/2),m=p/e;this.P=new da(m,0,0,0,0,p,0,0,0,0,(g+d)/(d-g),2*g*d/(d-g),0,0,-1,0)}},remove:function(){q.remove(h_.active.cameras,this),mt.prototype.remove.call(this)},renderFrame:function(t){if(this.buildMatrix(),null==this.prevV){this.prevV=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);var e=this.prevV,a=this.V;e.self._00=a.self._00,e.self._01=a.self._01,e.self._02=a.self._02,e.self._03=a.self._03,e.self._10=a.self._10,e.self._11=a.self._11,e.self._12=a.self._12,e.self._13=a.self._13,e.self._20=a.self._20,e.self._21=a.self._21,e.self._22=a.self._22,e.self._23=a.self._23,e.self._30=a.self._30,e.self._31=a.self._31,e.self._32=a.self._32,e.self._33=a.self._33}_o.active.renderFrame(t);var i=this.prevV,n=this.V;i.self._00=n.self._00,i.self._01=n.self._01,i.self._02=n.self._02,i.self._03=n.self._03,i.self._10=n.self._10,i.self._11=n.self._11,i.self._12=n.self._12,i.self._13=n.self._13,i.self._20=n.self._20,i.self._21=n.self._21,i.self._22=n.self._22,i.self._23=n.self._23,i.self._30=n.self._30,i.self._31=n.self._31,i.self._32=n.self._32,i.self._33=n.self._33},buildMatrix:function(){this.transform.buildMatrix();var t=this.transform.world,e=Math.sqrt(t.self._00*t.self._00+t.self._10*t.self._10+t.self._20*t.self._20),a=Math.sqrt(t.self._01*t.self._01+t.self._11*t.self._11+t.self._21*t.self._21),i=Math.sqrt(t.self._02*t.self._02+t.self._12*t.self._12+t.self._22*t.self._22),n=vt.temp;n.x=1/e,n.y=1/a,n.z=1/i,n.w=1;var s=this.transform.world,r=vt.temp,o=r.x,l=r.y,_=r.z;s.self._00*=o,s.self._01*=o,s.self._02*=o,s.self._03*=o,s.self._10*=l,s.self._11*=l,s.self._12*=l,s.self._13*=l,s.self._20*=_,s.self._21*=_,s.self._22*=_,s.self._23*=_;var h=this.V,f=this.transform.world,u=f.self._00,c=f.self._01,d=f.self._02,g=f.self._03,p=f.self._10,m=f.self._11,v=f.self._12,b=f.self._13,I=f.self._20,M=f.self._21,y=f.self._22,w=f.self._23,x=f.self._30,C=f.self._31,A=f.self._32,Z=f.self._33,z=u*m-c*p,B=u*v-d*p,k=u*b-g*p,S=c*v-d*m,X=c*b-g*m,Y=d*b-g*v,N=I*C-M*x,L=I*A-y*x,G=I*Z-w*x,W=M*A-y*C,D=M*Z-w*C,T=y*Z-w*A,V=z*T-B*D+k*W+S*G-X*L+Y*N;0==V?(h.self._00=1,h.self._01=0,h.self._02=0,h.self._03=0,h.self._10=0,h.self._11=1,h.self._12=0,h.self._13=0,h.self._20=0,h.self._21=0,h.self._22=1,h.self._23=0,h.self._30=0,h.self._31=0,h.self._32=0,h.self._33=1):(V=1/V,h.self._00=(m*T-v*D+b*W)*V,h.self._01=(d*D-c*T-g*W)*V,h.self._02=(C*Y-A*X+Z*S)*V,h.self._03=(y*X-M*Y-w*S)*V,h.self._10=(v*G-p*T-b*L)*V,h.self._11=(u*T-d*G+g*L)*V,h.self._12=(A*k-x*Y-Z*B)*V,h.self._13=(I*Y-y*k+w*B)*V,h.self._20=(p*D-m*G+b*N)*V,h.self._21=(c*G-u*D-g*N)*V,h.self._22=(x*X-C*k+Z*z)*V,h.self._23=(M*k-I*X-w*z)*V,h.self._30=(m*L-p*W-v*N)*V,h.self._31=(u*W-c*L+d*N)*V,h.self._32=(C*B-x*S-A*z)*V,h.self._33=(I*S-M*B+y*z)*V);var K=this.VP,j=this.P,R=this.V,H=R.self._00,P=R.self._01,F=R.self._02,O=R.self._03,E=R.self._10,U=R.self._11,J=R.self._12,Q=R.self._13,q=R.self._20,$=R.self._21,tt=R.self._22,et=R.self._23,at=R.self._30,it=R.self._31,nt=R.self._32,st=R.self._33,rt=j.self._00,ot=j.self._10,lt=j.self._20,_t=j.self._30;K.self._00=H*rt+P*ot+F*lt+O*_t,K.self._10=E*rt+U*ot+J*lt+Q*_t,K.self._20=q*rt+$*ot+tt*lt+et*_t,K.self._30=at*rt+it*ot+nt*lt+st*_t,rt=j.self._01,ot=j.self._11,lt=j.self._21,_t=j.self._31,K.self._01=H*rt+P*ot+F*lt+O*_t,K.self._11=E*rt+U*ot+J*lt+Q*_t,K.self._21=q*rt+$*ot+tt*lt+et*_t,K.self._31=at*rt+it*ot+nt*lt+st*_t,rt=j.self._02,ot=j.self._12,lt=j.self._22,_t=j.self._32,K.self._02=H*rt+P*ot+F*lt+O*_t,K.self._12=E*rt+U*ot+J*lt+Q*_t,K.self._22=q*rt+$*ot+tt*lt+et*_t,K.self._32=at*rt+it*ot+nt*lt+st*_t,rt=j.self._03,ot=j.self._13,lt=j.self._23,_t=j.self._33,K.self._03=H*rt+P*ot+F*lt+O*_t,K.self._13=E*rt+U*ot+J*lt+Q*_t,K.self._23=q*rt+$*ot+tt*lt+et*_t,K.self._33=at*rt+it*ot+nt*lt+st*_t,this.data.raw.frustum_culling&&vt.buildViewFrustum(this.VP,this.frustumPlanes)},__class__:vt});var bt=function(){this.constant=0,this.normal=new lo(1,0,0)};(i["iron.object.FrustumPlane"]=bt).__name__=!0,bt.prototype={normal:null,constant:null,normalize:function(){var t=this.normal,e=1/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),a=this.normal;a.x*=e,a.y*=e,a.z*=e,this.constant*=e},distanceToSphere:function(t,e){var a=this.normal;return a.x*t.x+a.y*t.y+a.z*t.z+this.constant-e},__class__:bt};var It=function(t){this.target=null,this.raw=t};(i["iron.object.Constraint"]=It).__name__=!0,It.prototype={raw:null,target:null,apply:function(t){if(null==this.target&&null!=this.raw.target&&(this.target=h_.active.getChild(this.raw.target).transform),"COPY_LOCATION"==this.raw.type){if(this.raw.use_x)if(t.world.self._30=this.target.loc.x,this.raw.use_offset)t.world.self._30+=t.loc.x;if(this.raw.use_y)if(t.world.self._31=this.target.loc.y,this.raw.use_offset)t.world.self._31+=t.loc.y;if(this.raw.use_z)if(t.world.self._32=this.target.loc.z,this.raw.use_offset)t.world.self._32+=t.loc.z}},__class__:It};var Mt=function(){mt.call(this)};(i["iron.object.DecalObject"]=Mt).__name__=!0,Mt.__super__=mt,Mt.prototype=s(mt.prototype,{__class__:Mt});var sa=function(t){this.frustumPlanes=null,this.VP=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.P=null,this.V=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.camSlicedP=null,mt.call(this);var e=(this.data=t).raw.type,a=t.raw.fov;if("sun"==e){if(null==sa.corners){sa.corners=[];for(var i=0;i<8;){i++;sa.corners.push(new lo)}}this.P=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}else if("point"==e||"area"==e){var n=t.raw.near_plane,s=t.raw.far_plane,r=1/Math.tan(a/2),o=r/1;this.P=new da(o,0,0,0,0,r,0,0,0,0,(s+n)/(n-s),2*s*n/(n-s),0,0,-1,0)}else if("spot"==e){var l=t.raw.near_plane,_=t.raw.far_plane,h=1/Math.tan(a/2),f=h/1;this.P=new da(f,0,0,0,0,h,0,0,0,0,(_+l)/(l-_),2*_*l/(l-_),0,0,-1,0)}h_.active.lights.push(this)};(i["iron.object.LightObject"]=sa).__name__=!0,sa.setCorners=function(){var t=sa.corners[0];t.x=-1,t.y=-1,t.z=1,t.w=1;var e=sa.corners[1];e.x=-1,e.y=-1,e.z=-1,e.w=1;var a=sa.corners[2];a.x=-1,a.y=1,a.z=1,a.w=1;var i=sa.corners[3];i.x=-1,i.y=1,i.z=-1,i.w=1;var n=sa.corners[4];n.x=1,n.y=-1,n.z=1,n.w=1;var s=sa.corners[5];s.x=1,s.y=-1,s.z=-1,s.w=1;var r=sa.corners[6];r.x=1,r.y=1,r.z=1,r.w=1;var o=sa.corners[7];o.x=1,o.y=1,o.z=-1,o.w=1},sa.__super__=mt,sa.prototype=s(mt.prototype,{camSlicedP:null,data:null,V:null,P:null,VP:null,frustumPlanes:null,remove:function(){null!=h_.active&&q.remove(h_.active.lights,this),mt.prototype.remove.call(this)},buildMatrices:function(t){if(this.transform.buildMatrix(),"sun"==this.data.raw.type)this.setCascade(t,0);else{var e=this.V,a=this.transform.world,i=a.self._00,n=a.self._01,s=a.self._02,r=a.self._03,o=a.self._10,l=a.self._11,_=a.self._12,h=a.self._13,f=a.self._20,u=a.self._21,c=a.self._22,d=a.self._23,g=a.self._30,p=a.self._31,m=a.self._32,v=a.self._33,b=i*l-n*o,I=i*_-s*o,M=i*h-r*o,y=n*_-s*l,w=n*h-r*l,x=s*h-r*_,C=f*p-u*g,A=f*m-c*g,Z=f*v-d*g,z=u*m-c*p,B=u*v-d*p,k=c*v-d*m,S=b*k-I*B+M*z+y*Z-w*A+x*C;0==S?(e.self._00=1,e.self._01=0,e.self._02=0,e.self._03=0,e.self._10=0,e.self._11=1,e.self._12=0,e.self._13=0,e.self._20=0,e.self._21=0,e.self._22=1,e.self._23=0,e.self._30=0,e.self._31=0,e.self._32=0,e.self._33=1):(S=1/S,e.self._00=(l*k-_*B+h*z)*S,e.self._01=(s*B-n*k-r*z)*S,e.self._02=(p*x-m*w+v*y)*S,e.self._03=(c*w-u*x-d*y)*S,e.self._10=(_*Z-o*k-h*A)*S,e.self._11=(i*k-s*Z+r*A)*S,e.self._12=(m*M-g*x-v*I)*S,e.self._13=(f*x-c*M+d*I)*S,e.self._20=(o*B-l*Z+h*C)*S,e.self._21=(n*Z-i*B-r*C)*S,e.self._22=(g*w-p*M+v*b)*S,e.self._23=(u*M-f*w-d*b)*S,e.self._30=(l*A-o*z-_*C)*S,e.self._31=(i*z-n*A+s*C)*S,e.self._32=(p*I-g*y-m*b)*S,e.self._33=(f*y-u*I+c*b)*S),this.updateViewFrustum(t)}},setCascade:function(t,e){var a=sa.m,i=t.V;if(a.self._00=i.self._00,a.self._01=i.self._01,a.self._02=i.self._02,a.self._03=i.self._03,a.self._10=i.self._10,a.self._11=i.self._11,a.self._12=i.self._12,a.self._13=i.self._13,a.self._20=i.self._20,a.self._21=i.self._21,a.self._22=i.self._22,a.self._23=i.self._23,a.self._30=i.self._30,a.self._31=i.self._31,a.self._32=i.self._32,a.self._33=i.self._33,null==this.camSlicedP){var n=t.data.raw.fov,s=this.data.raw.near_plane,r=this.data.raw.far_plane,o=null!=t.data.raw.aspect?t.data.raw.aspect:co.windowWidth()/co.windowHeight(),l=1/Math.tan(n/2),_=l/o;this.camSlicedP=new da(_,0,0,0,0,l,0,0,0,0,(r+s)/(s-r),2*r*s/(s-r),0,0,-1,0)}var h=sa.m,f=this.camSlicedP,u=h.self._00,c=h.self._01,d=h.self._02,g=h.self._03,p=h.self._10,m=h.self._11,v=h.self._12,b=h.self._13,I=h.self._20,M=h.self._21,y=h.self._22,w=h.self._23,x=h.self._30,C=h.self._31,A=h.self._32,Z=h.self._33,z=f.self._00,B=f.self._10,k=f.self._20,S=f.self._30;h.self._00=u*z+c*B+d*k+g*S,h.self._10=p*z+m*B+v*k+b*S,h.self._20=I*z+M*B+y*k+w*S,h.self._30=x*z+C*B+A*k+Z*S,z=f.self._01,B=f.self._11,k=f.self._21,S=f.self._31,h.self._01=u*z+c*B+d*k+g*S,h.self._11=p*z+m*B+v*k+b*S,h.self._21=I*z+M*B+y*k+w*S,h.self._31=x*z+C*B+A*k+Z*S,z=f.self._02,B=f.self._12,k=f.self._22,S=f.self._32,h.self._02=u*z+c*B+d*k+g*S,h.self._12=p*z+m*B+v*k+b*S,h.self._22=I*z+M*B+y*k+w*S,h.self._32=x*z+C*B+A*k+Z*S,z=f.self._03,B=f.self._13,k=f.self._23,S=f.self._33,h.self._03=u*z+c*B+d*k+g*S,h.self._13=p*z+m*B+v*k+b*S,h.self._23=I*z+M*B+y*k+w*S,h.self._33=x*z+C*B+A*k+Z*S;var X=sa.m,Y=sa.m,N=Y.self._00,L=Y.self._01,G=Y.self._02,W=Y.self._03,D=Y.self._10,T=Y.self._11,V=Y.self._12,K=Y.self._13,j=Y.self._20,R=Y.self._21,H=Y.self._22,P=Y.self._23,F=Y.self._30,O=Y.self._31,E=Y.self._32,U=Y.self._33,J=N*T-L*D,Q=N*V-G*D,q=N*K-W*D,$=L*V-G*T,tt=L*K-W*T,et=G*K-W*V,at=j*O-R*F,it=j*E-H*F,nt=j*U-P*F,st=R*E-H*O,rt=R*U-P*O,ot=H*U-P*E,lt=J*ot-Q*rt+q*st+$*nt-tt*it+et*at;0==lt?(X.self._00=1,X.self._01=0,X.self._02=0,X.self._03=0,X.self._10=0,X.self._11=1,X.self._12=0,X.self._13=0,X.self._20=0,X.self._21=0,X.self._22=1,X.self._23=0,X.self._30=0,X.self._31=0,X.self._32=0,X.self._33=1):(lt=1/lt,X.self._00=(T*ot-V*rt+K*st)*lt,X.self._01=(G*rt-L*ot-W*st)*lt,X.self._02=(O*et-E*tt+U*$)*lt,X.self._03=(H*tt-R*et-P*$)*lt,X.self._10=(V*nt-D*ot-K*it)*lt,X.self._11=(N*ot-G*nt+W*it)*lt,X.self._12=(E*q-F*et-U*Q)*lt,X.self._13=(j*et-H*q+P*Q)*lt,X.self._20=(D*rt-T*nt+K*at)*lt,X.self._21=(L*nt-N*rt-W*at)*lt,X.self._22=(F*tt-O*q+U*J)*lt,X.self._23=(R*q-j*tt-P*J)*lt,X.self._30=(T*it-D*st-V*at)*lt,X.self._31=(N*st-L*it+G*at)*lt,X.self._32=(O*Q-F*$-E*J)*lt,X.self._33=(j*$-R*Q+H*J)*lt);var _t=this.V,ht=this.transform.world,ft=ht.self._00,ut=ht.self._01,ct=ht.self._02,dt=ht.self._03,gt=ht.self._10,pt=ht.self._11,mt=ht.self._12,vt=ht.self._13,bt=ht.self._20,It=ht.self._21,Mt=ht.self._22,yt=ht.self._23,wt=ht.self._30,xt=ht.self._31,Ct=ht.self._32,At=ht.self._33,Zt=ft*pt-ut*gt,zt=ft*mt-ct*gt,Bt=ft*vt-dt*gt,kt=ut*mt-ct*pt,St=ut*vt-dt*pt,Xt=ct*vt-dt*mt,Yt=bt*xt-It*wt,Nt=bt*Ct-Mt*wt,Lt=bt*At-yt*wt,Gt=It*Ct-Mt*xt,Wt=It*At-yt*xt,Dt=Mt*At-yt*Ct,Tt=Zt*Dt-zt*Wt+Bt*Gt+kt*Lt-St*Nt+Xt*Yt;0==Tt?(_t.self._00=1,_t.self._01=0,_t.self._02=0,_t.self._03=0,_t.self._10=0,_t.self._11=1,_t.self._12=0,_t.self._13=0,_t.self._20=0,_t.self._21=0,_t.self._22=1,_t.self._23=0,_t.self._30=0,_t.self._31=0,_t.self._32=0,_t.self._33=1):(Tt=1/Tt,_t.self._00=(pt*Dt-mt*Wt+vt*Gt)*Tt,_t.self._01=(ct*Wt-ut*Dt-dt*Gt)*Tt,_t.self._02=(xt*Xt-Ct*St+At*kt)*Tt,_t.self._03=(Mt*St-It*Xt-yt*kt)*Tt,_t.self._10=(mt*Lt-gt*Dt-vt*Nt)*Tt,_t.self._11=(ft*Dt-ct*Lt+dt*Nt)*Tt,_t.self._12=(Ct*Bt-wt*Xt-At*zt)*Tt,_t.self._13=(bt*Xt-Mt*Bt+yt*zt)*Tt,_t.self._20=(gt*Wt-pt*Lt+vt*Yt)*Tt,_t.self._21=(ut*Lt-ft*Wt-dt*Yt)*Tt,_t.self._22=(wt*St-xt*Bt+At*Zt)*Tt,_t.self._23=(It*Bt-bt*St-yt*Zt)*Tt,_t.self._30=(pt*Nt-gt*Gt-mt*Yt)*Tt,_t.self._31=(ft*Gt-ut*Nt+ct*Yt)*Tt,_t.self._32=(xt*zt-wt*kt-Ct*Zt)*Tt,_t.self._33=(bt*kt-It*zt+Mt*Zt)*Tt);var Vt=this.V,Kt=da.helpVec;Kt.x=Vt.self._00,Kt.y=Vt.self._01,Kt.z=Vt.self._02,Kt.w=1;var jt=Kt,Rt=1/Math.sqrt(jt.x*jt.x+jt.y*jt.y+jt.z*jt.z);Vt.self._00*=Rt,Vt.self._01*=Rt,Vt.self._02*=Rt;var Ht=da.helpVec;Ht.x=Vt.self._10,Ht.y=Vt.self._11,Ht.z=Vt.self._12,Ht.w=1;var Pt=Ht;Rt=1/Math.sqrt(Pt.x*Pt.x+Pt.y*Pt.y+Pt.z*Pt.z),Vt.self._10*=Rt,Vt.self._11*=Rt,Vt.self._12*=Rt;var Ft=da.helpVec;Ft.x=Vt.self._20,Ft.y=Vt.self._21,Ft.z=Vt.self._22,Ft.w=1;var Ot=Ft;Rt=1/Math.sqrt(Ot.x*Ot.x+Ot.y*Ot.y+Ot.z*Ot.z),Vt.self._20*=Rt,Vt.self._21*=Rt,Vt.self._22*=Rt,Vt.self._03=0,Vt.self._13=0,Vt.self._23=0,Vt.self._30=0,Vt.self._31=0,Vt.self._32=0,Vt.self._33=1;var Et=sa.m,Ut=this.V,Jt=Et.self._00,Qt=Et.self._01,qt=Et.self._02,$t=Et.self._03,te=Et.self._10,ee=Et.self._11,ae=Et.self._12,ie=Et.self._13,ne=Et.self._20,se=Et.self._21,re=Et.self._22,oe=Et.self._23,le=Et.self._30,_e=Et.self._31,he=Et.self._32,fe=Et.self._33,ue=Ut.self._00,ce=Ut.self._10,de=Ut.self._20,ge=Ut.self._30;Et.self._00=Jt*ue+Qt*ce+qt*de+$t*ge,Et.self._10=te*ue+ee*ce+ae*de+ie*ge,Et.self._20=ne*ue+se*ce+re*de+oe*ge,Et.self._30=le*ue+_e*ce+he*de+fe*ge,ue=Ut.self._01,ce=Ut.self._11,de=Ut.self._21,ge=Ut.self._31,Et.self._01=Jt*ue+Qt*ce+qt*de+$t*ge,Et.self._11=te*ue+ee*ce+ae*de+ie*ge,Et.self._21=ne*ue+se*ce+re*de+oe*ge,Et.self._31=le*ue+_e*ce+he*de+fe*ge,ue=Ut.self._02,ce=Ut.self._12,de=Ut.self._22,ge=Ut.self._32,Et.self._02=Jt*ue+Qt*ce+qt*de+$t*ge,Et.self._12=te*ue+ee*ce+ae*de+ie*ge,Et.self._22=ne*ue+se*ce+re*de+oe*ge,Et.self._32=le*ue+_e*ce+he*de+fe*ge,ue=Ut.self._03,ce=Ut.self._13,de=Ut.self._23,ge=Ut.self._33,Et.self._03=Jt*ue+Qt*ce+qt*de+$t*ge,Et.self._13=te*ue+ee*ce+ae*de+ie*ge,Et.self._23=ne*ue+se*ce+re*de+oe*ge,Et.self._33=le*ue+_e*ce+he*de+fe*ge,sa.setCorners();for(var pe=0,me=sa.corners;pe<me.length;){var ve=me[pe];++pe;var be=sa.m,Ie=ve.x,Me=ve.y,ye=ve.z,we=ve.w;ve.x=be.self._00*Ie+be.self._10*Me+be.self._20*ye+be.self._30*we,ve.y=be.self._01*Ie+be.self._11*Me+be.self._21*ye+be.self._31*we,ve.z=be.self._02*Ie+be.self._12*Me+be.self._22*ye+be.self._32*we,ve.w=be.self._03*Ie+be.self._13*Me+be.self._23*ye+be.self._33*we,ve.x/=ve.w,ve.y/=ve.w,ve.z/=ve.w,ve.w=1}for(var xe=sa.corners[0].x,Ce=sa.corners[0].y,Ae=sa.corners[0].z,Ze=sa.corners[0].x,ze=sa.corners[0].y,Be=sa.corners[0].z,ke=0,Se=sa.corners;ke<Se.length;){var Xe=Se[ke];++ke,Xe.x<xe&&(xe=Xe.x),Xe.x>Ze&&(Ze=Xe.x),Xe.y<Ce&&(Ce=Xe.y),Xe.y>ze&&(ze=Xe.y),Xe.z<Ae&&(Ae=Xe.z),Xe.z>Be&&(Be=Xe.z)}var Ye=sa.corners[0],Ne=sa.corners[7],Le=Ye.x-Ne.x,Ge=Ye.y-Ne.y,We=Ye.z-Ne.z,De=Math.sqrt(Le*Le+Ge*Ge+We*We),Te=.5*(De-(Ze-xe)),Ve=.5*(De-(ze-Ce));xe-=Te,Ze+=Te,Ce-=Ve,ze+=Ve;var Ke=this.data.raw.shadowmap_size,je=(Ze-xe)/Ke,Re=(ze-Ce)/Ke,He=(Be-Ae)/Ke;xe=Math.floor(xe/je)*je,Ce=Math.floor(Ce/Re)*Re,Ae=Math.floor(Ae/He)*He,Ze=Math.floor(Ze/je)*je,ze=Math.floor(ze/Re)*Re,Be=Math.floor(Be/He)*He;var Pe=(Ze-xe)/2*sa.cascadeBounds,Fe=(ze-Ce)/2*sa.cascadeBounds,Oe=(Be-Ae)/2*sa.cascadeBounds;this.V.self._30=-(xe+Pe),this.V.self._31=-(Ce+Fe),this.V.self._32=-(Ae+Oe);var Ee=-Pe,Ue=-Fe,Je=4*-Oe,Qe=Pe-Ee,qe=Fe-Ue,$e=Oe-Je,ta=-(Pe+Ee)/Qe,ea=-(Fe+Ue)/qe,aa=-(Oe+Je)/$e;sa.m=new da(2/Qe,0,0,ta,0,2/qe,0,ea,0,0,-2/$e,aa,0,0,0,1);var ia=this.P,na=sa.m;ia.self._00=na.self._00,ia.self._01=na.self._01,ia.self._02=na.self._02,ia.self._03=na.self._03,ia.self._10=na.self._10,ia.self._11=na.self._11,ia.self._12=na.self._12,ia.self._13=na.self._13,ia.self._20=na.self._20,ia.self._21=na.self._21,ia.self._22=na.self._22,ia.self._23=na.self._23,ia.self._30=na.self._30,ia.self._31=na.self._31,ia.self._32=na.self._32,ia.self._33=na.self._33,this.updateViewFrustum(t)},updateViewFrustum:function(t){var e=this.VP,a=this.P,i=this.V,n=i.self._00,s=i.self._01,r=i.self._02,o=i.self._03,l=i.self._10,_=i.self._11,h=i.self._12,f=i.self._13,u=i.self._20,c=i.self._21,d=i.self._22,g=i.self._23,p=i.self._30,m=i.self._31,v=i.self._32,b=i.self._33,I=a.self._00,M=a.self._10,y=a.self._20,w=a.self._30;if(e.self._00=n*I+s*M+r*y+o*w,e.self._10=l*I+_*M+h*y+f*w,e.self._20=u*I+c*M+d*y+g*w,e.self._30=p*I+m*M+v*y+b*w,I=a.self._01,M=a.self._11,y=a.self._21,w=a.self._31,e.self._01=n*I+s*M+r*y+o*w,e.self._11=l*I+_*M+h*y+f*w,e.self._21=u*I+c*M+d*y+g*w,e.self._31=p*I+m*M+v*y+b*w,I=a.self._02,M=a.self._12,y=a.self._22,w=a.self._32,e.self._02=n*I+s*M+r*y+o*w,e.self._12=l*I+_*M+h*y+f*w,e.self._22=u*I+c*M+d*y+g*w,e.self._32=p*I+m*M+v*y+b*w,I=a.self._03,M=a.self._13,y=a.self._23,w=a.self._33,e.self._03=n*I+s*M+r*y+o*w,e.self._13=l*I+_*M+h*y+f*w,e.self._23=u*I+c*M+d*y+g*w,e.self._33=p*I+m*M+v*y+b*w,t.data.raw.frustum_culling){if(null==this.frustumPlanes){this.frustumPlanes=[];for(var x=0;x<6;){x++;this.frustumPlanes.push(new bt)}}vt.buildViewFrustum(this.VP,this.frustumPlanes)}},setCubeFace:function(t,e){var a=sa.p1;a.x=this.transform.world.self._30,a.y=this.transform.world.self._31,a.z=this.transform.world.self._32,a.w=1;var i=sa.p2,n=sa.p1;switch(i.x=n.x,i.y=n.y,i.z=n.z,t){case 0:var s=sa.p2;s.x+=1,s.y+=0,s.z+=0;var r=sa.p3;r.x=0,r.y=-1,r.z=0,r.w=1;break;case 1:var o=sa.p2;o.x+=-1,o.y+=0,o.z+=0;var l=sa.p3;l.x=0,l.y=-1,l.z=0,l.w=1;break;case 2:var _=sa.p2;_.x+=0,_.y+=1,_.z+=0;var h=sa.p3;h.x=0,h.y=0,h.z=1,h.w=1;break;case 3:var f=sa.p2;f.x+=0,f.y+=-1,f.z+=0;var u=sa.p3;u.x=0,u.y=0,u.z=-1,u.w=1;break;case 4:var c=sa.p2;c.x+=0,c.y+=0,c.z+=1;var d=sa.p3;d.x=0,d.y=-1,d.z=0,d.w=1;break;case 5:var g=sa.p2;g.x+=0,g.y+=0,g.z+=-1;var p=sa.p3;p.x=0,p.y=-1,p.z=0,p.w=1}var m=this.V,v=sa.p1,b=sa.p2,I=sa.p3,M=b.x-v.x,y=b.y-v.y,w=b.z-v.z,x=1/Math.sqrt(M*M+y*y+w*w);M*=x,w*=x;var C=(y*=x)*I.z-w*I.y,A=w*I.x-M*I.z,Z=M*I.y-y*I.x,z=(A*=x=1/Math.sqrt(C*C+A*A+Z*Z))*w-(Z*=x)*y,B=Z*M-(C*=x)*w,k=C*y-A*M,S=-v.x*C-v.y*A-v.z*Z,X=-v.x*z-v.y*B-v.z*k,Y=v.x*M+v.y*y+v.z*w;m.self._00=C,m.self._10=A,m.self._20=Z,m.self._30=S,m.self._01=z,m.self._11=B,m.self._21=k,m.self._31=X,m.self._02=-M,m.self._12=-y,m.self._22=-w,m.self._32=Y,m.self._03=0,m.self._13=0,m.self._23=0,m.self._33=1,this.updateViewFrustum(e)},__class__:sa});var u_=function(t,e){this.tilesheet=null,this.frustumCulling=!0,this.screenSize=0,this.data=null,mt.call(this),this.materials=e,this.setData(t),h_.active.meshes.push(this)};(i["iron.object.MeshObject"]=u_).__name__=!0,u_.__super__=mt,u_.prototype=s(mt.prototype,{data:null,materials:null,cameraDistance:null,screenSize:null,frustumCulling:null,tilesheet:null,setData:function(t){(this.data=t).refcount++,t.geom.build()},remove:function(){null!=this.tilesheet&&this.tilesheet.remove(),null!=h_.active&&q.remove(h_.active.meshes,this),this.data.refcount--,mt.prototype.remove.call(this)},setupAnimation:function(t){if(null!=this.parent&&null!=this.parent.raw&&null!=this.parent.raw.bone_actions){var e=this.parent.name;this.animation=this.getParentArmature(e),null==this.animation&&(this.animation=new f_(e)),this.data.isSkinned&&d_.__cast(this.animation,f_).setSkin(this)}mt.prototype.setupAnimation.call(this,t)},setupTilesheet:function(t,e,a){this.tilesheet=new xt(t,e,a)},setCulled:function(t,e){return t?this.culledShadow=e:this.culledMesh=e,this.culled=this.culledMesh&&this.culledShadow,e},cullMaterial:function(t){var e=this.materials;if((null==this.raw||null==this.raw.lod_material||1!=this.raw.lod_material)&&null==e[0].getContext(t))return!0;var a="shadowmap"==t;return this.visibleMesh||a?!this.visibleShadow&&a?this.setCulled(a,!0):this.skipContext(t)?this.setCulled(a,!0):this.setCulled(a,!1):this.setCulled(a,!0)},cullMesh:function(t,e,a){if(null==e)return!1;if(e.data.raw.frustum_culling&&this.frustumCulling){var i=this.data.isSkinned?2:1;"voxel"==t&&(i*=100);var n="shadowmap"==t,s=n?a.frustumPlanes:e.frustumPlanes;if(n&&"sun"!=a.data.raw.type&&(a.transform.radius=a.data.raw.far_plane,!vt.sphereInFrustum(e.frustumPlanes,a.transform)))return this.setCulled(n,!0);if(!this.data.geom.instanced&&!vt.sphereInFrustum(s,this.transform,i))return this.setCulled(n,!0)}return this.culled=!1,this.culled},skipContext:function(t){for(var e=0,a=this.materials;e<a.length;){var i=a[e];if(++e,null!=i.raw.skip_context&&i.raw.skip_context==t)return!0}return!1},getContexts:function(t,e,a,i){for(var n=0;n<e.length;){var s=e[n];++n;for(var r=0,o=s.raw.contexts.length;r<o;){var l=r++;if(q.substr(s.raw.contexts[l].name,0,t.length)==t){a.push(s.contexts[l]),i.push(s.shader.getContext(t));break}}}},render:function(t,e,a,i,n){if(null!=this.data&&this.data.geom.ready&&this.visible&&!this.cullMesh(e,a,i)){this.raw;if(null!=this.tilesheet&&this.tilesheet.update(),!this.cullMaterial(e)){var s=this.materials,r=this;if(null!=this.raw&&null!=this.raw.lods&&0<this.raw.lods.length){var o=this.transform,l=o.dim.x*o.dim.y*o.dim.z;if(this.screenSize=l*(1/this.cameraDistance),this.screenSize=1<this.screenSize?1:this.screenSize,null==this.lods){this.lods=[];for(var _=0,h=this.raw.lods;_<h.length;){var f=h[_];++_,""==f.object_ref?this.lods.push(null):this.lods.push(h_.active.getChild(f.object_ref))}}if("voxel"==e)r=this.lods[this.lods.length-1];else for(var u=0,c=this.raw.lods.length;u<c;){var d=u++;if(this.screenSize>this.raw.lods[d].screen_size)break;r=this.lods[d],null!=this.raw&&null!=this.raw.lod_material&&1==this.raw.lod_material&&(s=r.materials)}if(null==r)return}if(null==this.raw||null==this.raw.lod_material||1!=this.raw.lod_material||null!=s[0].getContext(e)){var g=[],p=[];this.getContexts(e,s,g,p),this.transform.update();for(var m=r.data,v=0,b=m.geom.indexBuffers.length;v<b;){var I=v++,M=m.geom.materialIndices[I];if(!(p.length<=M)){var y=p[M],w=y.raw.vertex_structure;y.pipeState!=u_.lastPipeline&&(t.setPipeline(y.pipeState),u_.lastPipeline=y.pipeState,c_.setContextConstants(t,y,a,i,n)),c_.setObjectConstants(t,y,this,a,i),M<g.length&&c_.setMaterialConstants(t,y,g[M]),m.geom.instanced?t.setVertexBuffers([m.geom.get(w),m.geom.instancedVB]):t.setVertexBuffer(m.geom.get(w)),t.setIndexBuffer(m.geom.indexBuffers[I]),m.geom.instanced?t.drawIndexedVerticesInstanced(m.geom.instanceCount,m.geom.start,m.geom.count):t.drawIndexedVertices(m.geom.start,m.geom.count)}}}}}},__class__:u_});var yt=function(t,e){this.bezierFrameIndex=-1,this.s0=0,this.object=t,this.oactions=e,this.isSkinned=!1,Pe.call(this)};(i["iron.object.ObjectAnimation"]=yt).__name__=!0,yt.__super__=Pe,yt.prototype=s(Pe.prototype,{object:null,oactions:null,oaction:null,getAction:function(t){for(var e=0,a=this.oactions;e<a.length;){var i=a[e];if(++e,null!=i&&i.objects[0].name==t)return i.objects[0]}return null},play:function(t,e,a,i,n){null==n&&(n=!0),null==i&&(i=1),null==a&&(a=0),null==t&&(t=""),Pe.prototype.play.call(this,t,e,a,i,n),""==this.action&&null!=this.oactions[0]&&(this.action=this.oactions[0].objects[0].name),this.oaction=this.getAction(this.action),null!=this.oaction&&(this.isSampled=null!=this.oaction.sampled&&this.oaction.sampled)},update:function(t){this.object.visible&&!this.object.culled&&null!=this.oaction&&(Pe.prototype.update.call(this,t),this.paused||this.isSkinned||this.updateObjectAnim())},updateObjectAnim:function(){if(this.isSampled){this.updateTrack(this.oaction.anim),this.updateAnimSampled(this.oaction.anim,this.object.transform.world);var t=this.object.transform.world,e=this.object.transform.loc,a=this.object.transform.rot,i=this.object.transform.scale;e.x=t.self._30,e.y=t.self._31,e.z=t.self._32;var n=da.helpVec;n.x=t.self._00,n.y=t.self._01,n.z=t.self._02,n.w=1;var s=n;i.x=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z);var r=da.helpVec;r.x=t.self._10,r.y=t.self._11,r.z=t.self._12,r.w=1;var o=r;i.y=Math.sqrt(o.x*o.x+o.y*o.y+o.z*o.z);var l=da.helpVec;l.x=t.self._20,l.y=t.self._21,l.z=t.self._22,l.w=1;var _=l;i.z=Math.sqrt(_.x*_.x+_.y*_.y+_.z*_.z);var h=t.self,f=h._12,u=h._22,c=h._32,d=h._13,g=h._23,p=h._33,m=h._11*(u*p-c*g)-h._21*(f*p-c*d)+h._31*(f*g-u*d),v=h._12,b=h._22,I=h._32,M=h._13,y=h._23,w=h._33,x=h._10*(b*w-I*y)-h._20*(v*w-I*M)+h._30*(v*y-b*M),C=h._11,A=h._21,Z=h._31,z=h._13,B=h._23,k=h._33,S=h._10*(A*k-Z*B)-h._20*(C*k-Z*z)+h._30*(C*B-A*z),X=h._11,Y=h._21,N=h._31,L=h._12,G=h._22,W=h._32,D=h._10*(Y*W-N*G)-h._20*(X*W-N*L)+h._30*(X*G-Y*L);h._00*m-h._01*x+h._02*S-h._03*D<0&&(i.x=-i.x);var T=1/i.x;da.helpMat.self._00=t.self._00*T,da.helpMat.self._01=t.self._01*T,da.helpMat.self._02=t.self._02*T,T=1/i.y,da.helpMat.self._10=t.self._10*T,da.helpMat.self._11=t.self._11*T,da.helpMat.self._12=t.self._12*T,T=1/i.z,da.helpMat.self._20=t.self._20*T,da.helpMat.self._21=t.self._21*T,da.helpMat.self._22=t.self._22*T;var V=da.helpMat,K=V.self._00,j=V.self._10,R=V.self._20,H=V.self._01,P=V.self._11,F=V.self._21,O=V.self._02,E=V.self._12,U=V.self._22,J=K+P+U,Q=0;0<J?(Q=.5/Math.sqrt(J+1),a.w=.25/Q,a.x=(E-F)*Q,a.y=(R-O)*Q,a.z=(H-j)*Q):P<K&&U<K?(Q=2*Math.sqrt(1+K-P-U),a.w=(E-F)/Q,a.x=.25*Q,a.y=(j+H)/Q,a.z=(R+O)/Q):U<P?(Q=2*Math.sqrt(1+P-K-U),a.w=(R-O)/Q,a.x=(j+H)/Q,a.y=.25*Q,a.z=(F+E)/Q):(Q=2*Math.sqrt(1+U-K-P),a.w=(H-j)/Q,a.x=(R+O)/Q,a.y=(F+E)/Q,a.z=.25*Q);for(var q=0,$=this.object.children;q<$.length;){var tt=$[q];++q,tt.transform.buildMatrix()}}else this.updateAnimNonSampled(this.oaction.anim,this.object.transform),this.object.transform.buildMatrix()},s0:null,bezierFrameIndex:null,isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-2:this.frameIndex<=0},updateAnimNonSampled:function(t,e){if(null!=t){var a=t.end*this.frameTime-t.begin*this.frameTime;if(t.has_delta){var i=e;null==i.dloc&&(i.dloc=new lo,i.drot=new A,i.dscale=new lo);var n=i.dloc;n.x=0,n.y=0,n.z=0,n.w=1;var s=i.dscale;s.x=0,s.y=0,s.z=0,s.w=1,i._deulerX=i._deulerY=i._deulerZ=0}for(var r=0,o=t.tracks;r<o.length;){var l=o[r];++r,-1==this.frameIndex&&this.rewind(l);for(var _=0<this.speed?1:-1,h=this.time+t.begin*this.frameTime;;){var f=l.frames;if(!(0<this.speed?this.frameIndex<f.length-2&&h>f[this.frameIndex+1]*this.frameTime:1<this.frameIndex&&h>f[this.frameIndex-1]*this.frameTime))break;this.frameIndex+=_}if(!(this.frameIndex>=l.frames.length)){if(this.time>a)return null!=this.onComplete&&this.onComplete(),void this.rewind(l);var u=this.frameIndex,c=l.frames[u]*this.frameTime,d=l.frames[u+_]*this.frameTime,g=l.values[u],p=l.values[u+_],m=0;switch(l.curve){case"bezier":var v=l.frames_control_plus[u]*this.frameTime,b=l.frames_control_minus[u+_]*this.frameTime,I=l.values_control_plus[u],M=l.values_control_minus[u+_];this.frameIndex!=this.bezierFrameIndex&&(this.bezierFrameIndex=this.frameIndex,this.s0=(h-c)/(d-c));var y=(d-3*b+3*v-c)*(this.s0*this.s0*this.s0)+3*(b-2*v+c)*(this.s0*this.s0)+3*(v-c)*this.s0+c-h,w=3*(d-3*b+3*v-c)*(this.s0*this.s0)+6*(b-2*v+c)*this.s0+3*(v-c),x=this.s0-y/w;m=(1-(this.s0=x))*(1-x)*(1-x)*g+3*x*(1-x)*(1-x)*I+x*x*3*(1-x)*M+x*x*x*p;break;case"linear":var C=(h-c)/(d-c);m=(1-C)*g+C*p}switch(l.target){case"dxloc":e.dloc.x=m;break;case"dxrot":e._deulerX=m;break;case"dxscl":e.dscale.x=m;break;case"dyloc":e.dloc.y=m;break;case"dyrot":e._deulerY=m;break;case"dyscl":e.dscale.y=m;break;case"dzloc":e.dloc.z=m;break;case"dzrot":e._deulerZ=m;break;case"dzscl":e.dscale.z=m;break;case"xloc":e.loc.x=m;break;case"xrot":e.setRotation(m,e._eulerY,e._eulerZ);break;case"xscl":e.scale.x=m;break;case"yloc":e.loc.y=m;break;case"yrot":e.setRotation(e._eulerX,m,e._eulerZ);break;case"yscl":e.scale.y=m;break;case"zloc":e.loc.z=m;break;case"zrot":e.setRotation(e._eulerX,e._eulerY,m);break;case"zscl":e.scale.z=m}}}}},__class__:yt});var wt=function(t){this.paused=!1,this.channels=[],this.sound=null;var e=this;mt.call(this),this.data=t,h_.active.speakers.push(this),""!=t.sound&&at.getSound(t.sound,function(t){e.sound=t,P.notifyOnInit(ns(e,e.init))})};(i["iron.object.SpeakerObject"]=wt).__name__=!0,wt.__super__=mt,wt.prototype=s(mt.prototype,{data:null,sound:null,channels:null,paused:null,init:function(){this.visible&&this.data.play_on_start&&this.play()},play:function(){if(null!=this.sound&&!this.data.muted)if(this.paused){for(var t=0,e=this.channels;t<e.length;){var a=e[t];++t,a.play()}this.paused=!1}else{var i=Zt.play(this.sound,this.data.loop,this.data.stream);this.channels.push(i),0<this.data.attenuation&&1==this.channels.length&&P.notifyOnUpdate(ns(this,this.update))}},update:function(){if(!this.paused){for(var t=0,e=this.channels;t<e.length;){var a=e[t];++t,a.get_finished()&&q.remove(this.channels,a)}if(0!=this.channels.length){var i=h_.active.camera.transform.world,n=i.self._30,s=i.self._31,r=i.self._32,o=(i.self._33,this.transform.world),l=o.self._30,_=o.self._31,h=o.self._32,f=(o.self._33,n-l),u=s-_,c=r-h,d=Math.sqrt(f*f+u*u+c*c);d*=this.data.attenuation;for(var g=1-Math.min(d/100,1),p=0,m=this.channels;p<m.length;){var v=m[p];++p,v.set_volume(g*this.data.volume)}}else P.removeUpdate(ns(this,this.update))}},remove:function(){null!=h_.active&&q.remove(h_.active.speakers,this),mt.prototype.remove.call(this)},__class__:wt});var xt=function(t,n,s){this.onActionComplete=null,this.time=0,this.frame=0,this.paused=!1,this.action=null,this.tileY=0,this.tileX=0;var r=this;this.ready=!1,at.getSceneRaw(t,function(t){for(var e=0,a=t.tilesheet_datas;e<a.length;){var i=a[e];if(++e,i.name==n){r.raw=i,r.play(s),r.ready=!0;break}}})};(i["iron.object.Tilesheet"]=xt).__name__=!0,xt.prototype={tileX:null,tileY:null,raw:null,action:null,ready:null,paused:null,frame:null,time:null,onActionComplete:null,play:function(t,e){this.onActionComplete=e;for(var a=0,i=this.raw.actions;a<i.length;){var n=i[a];if(++a,n.name==t){this.action=n;break}}this.setFrame(this.action.start),this.paused=!1},remove:function(){},update:function(){!this.ready||this.paused||this.action.start>=this.action.end||(this.time+=.016666666666666666*fo.scale,this.time>=1/this.raw.framerate&&this.setFrame(this.frame+1))},setFrame:function(t){this.frame=t,this.time=0;var e=this.frame%this.raw.tilesx,a=this.frame/this.raw.tilesx|0;this.tileX=e*(1/this.raw.tilesx),this.tileY=a*(1/this.raw.tilesy),this.frame>=this.action.end&&this.action.start<this.action.end&&(null!=this.onActionComplete&&this.onActionComplete(),this.action.loop?this.setFrame(this.action.start):this.paused=!0)},__class__:xt};var je=function(t){this.dscale=null,this.drot=null,this.dloc=null,this.boneParent=null,this.appendMats=null,this.prependMats=null,this.localOnly=!1,this.object=t,this.reset()};(i["iron.object.Transform"]=je).__name__=!0,je.prototype={world:null,localOnly:null,local:null,loc:null,rot:null,scale:null,dirty:null,object:null,dim:null,radius:null,prependMats:null,appendMats:null,boneParent:null,reset:function(){this.world=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.local=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.loc=new lo,this.rot=new A,this.scale=new lo(1,1,1),this.dim=new lo(2,2,2),this.radius=1,this.dirty=!0},update:function(){this.dirty&&this.buildMatrix()},composeDelta:function(){var t=this.dloc,e=this.loc,a=this.dloc;t.x=e.x+a.x,t.y=e.y+a.y,t.z=e.z+a.z;var i=this.dscale,n=this.dscale,s=this.scale;i.x=n.x+s.x,i.y=n.y+s.y,i.z=n.z+s.z;var r=this.drot,o=this._deulerX/2,l=Math.cos(o),_=Math.sin(o);o=this._deulerY/2;var h=Math.cos(o),f=Math.sin(o);o=this._deulerZ/2;var u=Math.cos(o),c=Math.sin(o);r.x=_*h*u+l*f*c,r.y=l*f*u+_*h*c,r.z=l*h*c-_*f*u,r.w=l*h*u-_*f*c;var d=this.drot,g=this.rot,p=this.drot,m=g.x,v=g.y,b=g.z,I=g.w,M=p.x,y=p.y,w=p.z,x=p.w;d.x=m*x+I*M+v*w-b*y,d.y=I*y-m*w+v*x+b*M,d.z=I*w+m*y-v*M+b*x,d.w=I*x-m*M-v*y-b*w;var C=this.local,A=this.dloc,Z=this.drot,z=this.dscale,B=Z.x,k=Z.y,S=Z.z,X=Z.w,Y=B+B,N=k+k,L=S+S,G=B*Y,W=B*N,D=B*L,T=k*N,V=k*L,K=S*L,j=X*Y,R=X*N,H=X*L;C.self._00=1-(T+K),C.self._10=W-H,C.self._20=D+R,C.self._01=W+H,C.self._11=1-(G+K),C.self._21=V-j,C.self._02=D-R,C.self._12=V+j,C.self._22=1-(G+T),C.self._03=0,C.self._13=0,C.self._23=0,C.self._30=0,C.self._31=0,C.self._32=0,C.self._33=1;var P=z.x,F=z.y,O=z.z;C.self._00*=P,C.self._01*=P,C.self._02*=P,C.self._03*=P,C.self._10*=F,C.self._11*=F,C.self._12*=F,C.self._13*=F,C.self._20*=O,C.self._21*=O,C.self._22*=O,C.self._23*=O,C.self._30=A.x,C.self._31=A.y,C.self._32=A.z},buildMatrix:function(){if(null==this.dloc){var t=this.local,e=this.loc,a=this.rot,i=this.scale,n=a.x,s=a.y,r=a.z,o=a.w,l=n+n,_=s+s,h=r+r,f=n*l,u=n*_,c=n*h,d=s*_,g=s*h,p=r*h,m=o*l,v=o*_,b=o*h;t.self._00=1-(d+p),t.self._10=u-b,t.self._20=c+v,t.self._01=u+b,t.self._11=1-(f+p),t.self._21=g-m,t.self._02=c-v,t.self._12=g+m,t.self._22=1-(f+d),t.self._03=0,t.self._13=0,t.self._23=0,t.self._30=0,t.self._31=0,t.self._32=0,t.self._33=1;var I=i.x,M=i.y,y=i.z;t.self._00*=I,t.self._01*=I,t.self._02*=I,t.self._03*=I,t.self._10*=M,t.self._11*=M,t.self._12*=M,t.self._13*=M,t.self._20*=y,t.self._21*=y,t.self._22*=y,t.self._23*=y,t.self._30=e.x,t.self._31=e.y,t.self._32=e.z}else this.composeDelta();if(null!=this.prependMats){var w=je.temp;w.self._00=1,w.self._01=0,w.self._02=0,w.self._03=0,w.self._10=0,w.self._11=1,w.self._12=0,w.self._13=0,w.self._20=0,w.self._21=0,w.self._22=1,w.self._23=0,w.self._30=0,w.self._31=0,w.self._32=0,w.self._33=1;for(var x=0,C=this.prependMats;x<C.length;){var A=C[x];++x;var Z=je.temp,z=Z.self._00,B=Z.self._01,k=Z.self._02,S=Z.self._03,X=Z.self._10,Y=Z.self._11,N=Z.self._12,L=Z.self._13,G=Z.self._20,W=Z.self._21,D=Z.self._22,T=Z.self._23,V=Z.self._30,K=Z.self._31,j=Z.self._32,R=Z.self._33,H=A.self._00,P=A.self._10,F=A.self._20,O=A.self._30;Z.self._00=z*H+B*P+k*F+S*O,Z.self._10=X*H+Y*P+N*F+L*O,Z.self._20=G*H+W*P+D*F+T*O,Z.self._30=V*H+K*P+j*F+R*O,H=A.self._01,P=A.self._11,F=A.self._21,O=A.self._31,Z.self._01=z*H+B*P+k*F+S*O,Z.self._11=X*H+Y*P+N*F+L*O,Z.self._21=G*H+W*P+D*F+T*O,Z.self._31=V*H+K*P+j*F+R*O,H=A.self._02,P=A.self._12,F=A.self._22,O=A.self._32,Z.self._02=z*H+B*P+k*F+S*O,Z.self._12=X*H+Y*P+N*F+L*O,Z.self._22=G*H+W*P+D*F+T*O,Z.self._32=V*H+K*P+j*F+R*O,H=A.self._03,P=A.self._13,F=A.self._23,O=A.self._33,Z.self._03=z*H+B*P+k*F+S*O,Z.self._13=X*H+Y*P+N*F+L*O,Z.self._23=G*H+W*P+D*F+T*O,Z.self._33=V*H+K*P+j*F+R*O}var E=je.temp,U=this.local,J=E.self._00,Q=E.self._01,q=E.self._02,$=E.self._03,tt=E.self._10,et=E.self._11,at=E.self._12,it=E.self._13,nt=E.self._20,st=E.self._21,rt=E.self._22,ot=E.self._23,lt=E.self._30,_t=E.self._31,ht=E.self._32,ft=E.self._33,ut=U.self._00,ct=U.self._10,dt=U.self._20,gt=U.self._30;E.self._00=J*ut+Q*ct+q*dt+$*gt,E.self._10=tt*ut+et*ct+at*dt+it*gt,E.self._20=nt*ut+st*ct+rt*dt+ot*gt,E.self._30=lt*ut+_t*ct+ht*dt+ft*gt,ut=U.self._01,ct=U.self._11,dt=U.self._21,gt=U.self._31,E.self._01=J*ut+Q*ct+q*dt+$*gt,E.self._11=tt*ut+et*ct+at*dt+it*gt,E.self._21=nt*ut+st*ct+rt*dt+ot*gt,E.self._31=lt*ut+_t*ct+ht*dt+ft*gt,ut=U.self._02,ct=U.self._12,dt=U.self._22,gt=U.self._32,E.self._02=J*ut+Q*ct+q*dt+$*gt,E.self._12=tt*ut+et*ct+at*dt+it*gt,E.self._22=nt*ut+st*ct+rt*dt+ot*gt,E.self._32=lt*ut+_t*ct+ht*dt+ft*gt,ut=U.self._03,ct=U.self._13,dt=U.self._23,gt=U.self._33,E.self._03=J*ut+Q*ct+q*dt+$*gt,E.self._13=tt*ut+et*ct+at*dt+it*gt,E.self._23=nt*ut+st*ct+rt*dt+ot*gt,E.self._33=lt*ut+_t*ct+ht*dt+ft*gt;var pt=this.local,mt=je.temp;pt.self._00=mt.self._00,pt.self._01=mt.self._01,pt.self._02=mt.self._02,pt.self._03=mt.self._03,pt.self._10=mt.self._10,pt.self._11=mt.self._11,pt.self._12=mt.self._12,pt.self._13=mt.self._13,pt.self._20=mt.self._20,pt.self._21=mt.self._21,pt.self._22=mt.self._22,pt.self._23=mt.self._23,pt.self._30=mt.self._30,pt.self._31=mt.self._31,pt.self._32=mt.self._32,pt.self._33=mt.self._33}if(null!=this.appendMats)for(var vt=0,bt=this.appendMats;vt<bt.length;){var It=bt[vt];++vt;var Mt=this.local,yt=Mt.self._00,wt=Mt.self._01,xt=Mt.self._02,Ct=Mt.self._03,At=Mt.self._10,Zt=Mt.self._11,zt=Mt.self._12,Bt=Mt.self._13,kt=Mt.self._20,St=Mt.self._21,Xt=Mt.self._22,Yt=Mt.self._23,Nt=Mt.self._30,Lt=Mt.self._31,Gt=Mt.self._32,Wt=Mt.self._33,Dt=It.self._00,Tt=It.self._10,Vt=It.self._20,Kt=It.self._30;Mt.self._00=yt*Dt+wt*Tt+xt*Vt+Ct*Kt,Mt.self._10=At*Dt+Zt*Tt+zt*Vt+Bt*Kt,Mt.self._20=kt*Dt+St*Tt+Xt*Vt+Yt*Kt,Mt.self._30=Nt*Dt+Lt*Tt+Gt*Vt+Wt*Kt,Dt=It.self._01,Tt=It.self._11,Vt=It.self._21,Kt=It.self._31,Mt.self._01=yt*Dt+wt*Tt+xt*Vt+Ct*Kt,Mt.self._11=At*Dt+Zt*Tt+zt*Vt+Bt*Kt,Mt.self._21=kt*Dt+St*Tt+Xt*Vt+Yt*Kt,Mt.self._31=Nt*Dt+Lt*Tt+Gt*Vt+Wt*Kt,Dt=It.self._02,Tt=It.self._12,Vt=It.self._22,Kt=It.self._32,Mt.self._02=yt*Dt+wt*Tt+xt*Vt+Ct*Kt,Mt.self._12=At*Dt+Zt*Tt+zt*Vt+Bt*Kt,Mt.self._22=kt*Dt+St*Tt+Xt*Vt+Yt*Kt,Mt.self._32=Nt*Dt+Lt*Tt+Gt*Vt+Wt*Kt,Dt=It.self._03,Tt=It.self._13,Vt=It.self._23,Kt=It.self._33,Mt.self._03=yt*Dt+wt*Tt+xt*Vt+Ct*Kt,Mt.self._13=At*Dt+Zt*Tt+zt*Vt+Bt*Kt,Mt.self._23=kt*Dt+St*Tt+Xt*Vt+Yt*Kt,Mt.self._33=Nt*Dt+Lt*Tt+Gt*Vt+Wt*Kt}if(null!=this.boneParent){var jt=this.local,Rt=this.boneParent,Ht=this.local,Pt=Ht.self._00,Ft=Ht.self._01,Ot=Ht.self._02,Et=Ht.self._03,Ut=Ht.self._10,Jt=Ht.self._11,Qt=Ht.self._12,qt=Ht.self._13,$t=Ht.self._20,te=Ht.self._21,ee=Ht.self._22,ae=Ht.self._23,ie=Ht.self._30,ne=Ht.self._31,se=Ht.self._32,re=Ht.self._33,oe=Rt.self._00,le=Rt.self._10,_e=Rt.self._20,he=Rt.self._30;jt.self._00=Pt*oe+Ft*le+Ot*_e+Et*he,jt.self._10=Ut*oe+Jt*le+Qt*_e+qt*he,jt.self._20=$t*oe+te*le+ee*_e+ae*he,jt.self._30=ie*oe+ne*le+se*_e+re*he,oe=Rt.self._01,le=Rt.self._11,_e=Rt.self._21,he=Rt.self._31,jt.self._01=Pt*oe+Ft*le+Ot*_e+Et*he,jt.self._11=Ut*oe+Jt*le+Qt*_e+qt*he,jt.self._21=$t*oe+te*le+ee*_e+ae*he,jt.self._31=ie*oe+ne*le+se*_e+re*he,oe=Rt.self._02,le=Rt.self._12,_e=Rt.self._22,he=Rt.self._32,jt.self._02=Pt*oe+Ft*le+Ot*_e+Et*he,jt.self._12=Ut*oe+Jt*le+Qt*_e+qt*he,jt.self._22=$t*oe+te*le+ee*_e+ae*he,jt.self._32=ie*oe+ne*le+se*_e+re*he,oe=Rt.self._03,le=Rt.self._13,_e=Rt.self._23,he=Rt.self._33,jt.self._03=Pt*oe+Ft*le+Ot*_e+Et*he,jt.self._13=Ut*oe+Jt*le+Qt*_e+qt*he,jt.self._23=$t*oe+te*le+ee*_e+ae*he,jt.self._33=ie*oe+ne*le+se*_e+re*he}if(null==this.object.parent||this.localOnly){var fe=this.world,ue=this.local;fe.self._00=ue.self._00,fe.self._01=ue.self._01,fe.self._02=ue.self._02,fe.self._03=ue.self._03,fe.self._10=ue.self._10,fe.self._11=ue.self._11,fe.self._12=ue.self._12,fe.self._13=ue.self._13,fe.self._20=ue.self._20,fe.self._21=ue.self._21,fe.self._22=ue.self._22,fe.self._23=ue.self._23,fe.self._30=ue.self._30,fe.self._31=ue.self._31,fe.self._32=ue.self._32,fe.self._33=ue.self._33}else{var ce=this.world,de=this.local,ge=this.object.parent.transform.world,pe=de.self._00,me=de.self._01,ve=de.self._02,be=de.self._03,Ie=de.self._10,Me=de.self._11,ye=de.self._12,we=de.self._13,xe=de.self._20,Ce=de.self._21,Ae=de.self._22,Ze=de.self._23,ze=de.self._30,Be=de.self._31,ke=de.self._32,Se=de.self._33,Xe=ge.self._00,Ye=ge.self._10,Ne=ge.self._20,Le=ge.self._30;ce.self._00=pe*Xe+me*Ye+ve*Ne+be*Le,ce.self._10=Ie*Xe+Me*Ye+ye*Ne+we*Le,ce.self._20=xe*Xe+Ce*Ye+Ae*Ne+Ze*Le,ce.self._30=ze*Xe+Be*Ye+ke*Ne+Se*Le,Xe=ge.self._01,Ye=ge.self._11,Ne=ge.self._21,Le=ge.self._31,ce.self._01=pe*Xe+me*Ye+ve*Ne+be*Le,ce.self._11=Ie*Xe+Me*Ye+ye*Ne+we*Le,ce.self._21=xe*Xe+Ce*Ye+Ae*Ne+Ze*Le,ce.self._31=ze*Xe+Be*Ye+ke*Ne+Se*Le,Xe=ge.self._02,Ye=ge.self._12,Ne=ge.self._22,Le=ge.self._32,ce.self._02=pe*Xe+me*Ye+ve*Ne+be*Le,ce.self._12=Ie*Xe+Me*Ye+ye*Ne+we*Le,ce.self._22=xe*Xe+Ce*Ye+Ae*Ne+Ze*Le,ce.self._32=ze*Xe+Be*Ye+ke*Ne+Se*Le,ce.self._03=0,ce.self._13=0,ce.self._23=0,ce.self._33=1}if(null!=this.object.constraints)for(var Ge=0,We=this.object.constraints;Ge<We.length;){var De=We[Ge];++Ge,De.apply(this)}this.computeDim();for(var Te=0,Ve=this.object.children;Te<Ve.length;){var Ke=Ve[Te];++Te,Ke.transform.buildMatrix()}this.dirty=!1},decompose:function(){var t=this.local,e=this.loc,a=this.rot,i=this.scale;e.x=t.self._30,e.y=t.self._31,e.z=t.self._32;var n=da.helpVec;n.x=t.self._00,n.y=t.self._01,n.z=t.self._02,n.w=1;var s=n;i.x=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z);var r=da.helpVec;r.x=t.self._10,r.y=t.self._11,r.z=t.self._12,r.w=1;var o=r;i.y=Math.sqrt(o.x*o.x+o.y*o.y+o.z*o.z);var l=da.helpVec;l.x=t.self._20,l.y=t.self._21,l.z=t.self._22,l.w=1;var _=l;i.z=Math.sqrt(_.x*_.x+_.y*_.y+_.z*_.z);var h=t.self,f=h._12,u=h._22,c=h._32,d=h._13,g=h._23,p=h._33,m=h._11*(u*p-c*g)-h._21*(f*p-c*d)+h._31*(f*g-u*d),v=h._12,b=h._22,I=h._32,M=h._13,y=h._23,w=h._33,x=h._10*(b*w-I*y)-h._20*(v*w-I*M)+h._30*(v*y-b*M),C=h._11,A=h._21,Z=h._31,z=h._13,B=h._23,k=h._33,S=h._10*(A*k-Z*B)-h._20*(C*k-Z*z)+h._30*(C*B-A*z),X=h._11,Y=h._21,N=h._31,L=h._12,G=h._22,W=h._32,D=h._10*(Y*W-N*G)-h._20*(X*W-N*L)+h._30*(X*G-Y*L);h._00*m-h._01*x+h._02*S-h._03*D<0&&(i.x=-i.x);var T=1/i.x;da.helpMat.self._00=t.self._00*T,da.helpMat.self._01=t.self._01*T,da.helpMat.self._02=t.self._02*T,T=1/i.y,da.helpMat.self._10=t.self._10*T,da.helpMat.self._11=t.self._11*T,da.helpMat.self._12=t.self._12*T,T=1/i.z,da.helpMat.self._20=t.self._20*T,da.helpMat.self._21=t.self._21*T,da.helpMat.self._22=t.self._22*T;var V=da.helpMat,K=V.self._00,j=V.self._10,R=V.self._20,H=V.self._01,P=V.self._11,F=V.self._21,O=V.self._02,E=V.self._12,U=V.self._22,J=K+P+U,Q=0;0<J?(Q=.5/Math.sqrt(J+1),a.w=.25/Q,a.x=(E-F)*Q,a.y=(R-O)*Q,a.z=(H-j)*Q):P<K&&U<K?(Q=2*Math.sqrt(1+K-P-U),a.w=(E-F)/Q,a.x=.25*Q,a.y=(j+H)/Q,a.z=(R+O)/Q):U<P?(Q=2*Math.sqrt(1+P-K-U),a.w=(R-O)/Q,a.x=(j+H)/Q,a.y=.25*Q,a.z=(F+E)/Q):(Q=2*Math.sqrt(1+U-K-P),a.w=(H-j)/Q,a.x=(R+O)/Q,a.y=(F+E)/Q,a.z=.25*Q)},rotate:function(t,e){var a=je.q,i=Math.sin(.5*e);a.x=t.x*i,a.y=t.y*i,a.z=t.z*i,a.w=Math.cos(.5*e);var n=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z+a.w*a.w);0==n?(a.x=0,a.y=0,a.z=0,a.w=0):(n=1/n,a.x*=n,a.y*=n,a.z*=n,a.w*=n);var s=this.rot,r=je.q,o=this.rot,l=r.x,_=r.y,h=r.z,f=r.w,u=o.x,c=o.y,d=o.z,g=o.w;s.x=l*g+f*u+_*d-h*c,s.y=f*c-l*d+_*g+h*u,s.z=f*d+l*c-_*u+h*g,s.w=f*g-l*u-_*c-h*d,this.dirty=!0},setRotation:function(t,e,a){var i=this.rot,n=t/2,s=Math.cos(n),r=Math.sin(n);n=e/2;var o=Math.cos(n),l=Math.sin(n);n=a/2;var _=Math.cos(n),h=Math.sin(n);i.x=r*o*_+s*l*h,i.y=s*l*_+r*o*h,i.z=s*o*h-r*l*_,i.w=s*o*_-r*l*h,this._eulerX=t,this._eulerY=e,this._eulerZ=a,this.dirty=!0},computeRadius:function(){this.radius=Math.sqrt(this.dim.x*this.dim.x+this.dim.y*this.dim.y+this.dim.z*this.dim.z)},computeDim:function(){if(null!=this.object.raw){var t=this.object.raw.dimensions;if(null==t){var e=this.dim;e.x=2*this.scale.x,e.y=2*this.scale.y,e.z=2*this.scale.z,e.w=1}else{var a=this.dim,i=t[1]*this.scale.y,n=t[2]*this.scale.z;a.x=t[0]*this.scale.x,a.y=i,a.z=n,a.w=1}this.computeRadius()}else this.computeRadius()},applyParentInverse:function(){var t=this.object.parent.transform;t.buildMatrix();var e=je.temp,a=t.world,i=a.self._00,n=a.self._01,s=a.self._02,r=a.self._03,o=a.self._10,l=a.self._11,_=a.self._12,h=a.self._13,f=a.self._20,u=a.self._21,c=a.self._22,d=a.self._23,g=a.self._30,p=a.self._31,m=a.self._32,v=a.self._33,b=i*l-n*o,I=i*_-s*o,M=i*h-r*o,y=n*_-s*l,w=n*h-r*l,x=s*h-r*_,C=f*p-u*g,A=f*m-c*g,Z=f*v-d*g,z=u*m-c*p,B=u*v-d*p,k=c*v-d*m,S=b*k-I*B+M*z+y*Z-w*A+x*C;0==S?(e.self._00=1,e.self._01=0,e.self._02=0,e.self._03=0,e.self._10=0,e.self._11=1,e.self._12=0,e.self._13=0,e.self._20=0,e.self._21=0,e.self._22=1,e.self._23=0,e.self._30=0,e.self._31=0,e.self._32=0,e.self._33=1):(S=1/S,e.self._00=(l*k-_*B+h*z)*S,e.self._01=(s*B-n*k-r*z)*S,e.self._02=(p*x-m*w+v*y)*S,e.self._03=(c*w-u*x-d*y)*S,e.self._10=(_*Z-o*k-h*A)*S,e.self._11=(i*k-s*Z+r*A)*S,e.self._12=(m*M-g*x-v*I)*S,e.self._13=(f*x-c*M+d*I)*S,e.self._20=(o*B-l*Z+h*C)*S,e.self._21=(n*Z-i*B-r*C)*S,e.self._22=(g*w-p*M+v*b)*S,e.self._23=(u*M-f*w-d*b)*S,e.self._30=(l*A-o*z-_*C)*S,e.self._31=(i*z-n*A+s*C)*S,e.self._32=(p*I-g*y-m*b)*S,e.self._33=(f*y-u*I+c*b)*S);var X=this.local,Y=je.temp,N=X.self._00,L=X.self._01,G=X.self._02,W=X.self._03,D=X.self._10,T=X.self._11,V=X.self._12,K=X.self._13,j=X.self._20,R=X.self._21,H=X.self._22,P=X.self._23,F=X.self._30,O=X.self._31,E=X.self._32,U=X.self._33,J=Y.self._00,Q=Y.self._10,q=Y.self._20,$=Y.self._30;X.self._00=N*J+L*Q+G*q+W*$,X.self._10=D*J+T*Q+V*q+K*$,X.self._20=j*J+R*Q+H*q+P*$,X.self._30=F*J+O*Q+E*q+U*$,J=Y.self._01,Q=Y.self._11,q=Y.self._21,$=Y.self._31,X.self._01=N*J+L*Q+G*q+W*$,X.self._11=D*J+T*Q+V*q+K*$,X.self._21=j*J+R*Q+H*q+P*$,X.self._31=F*J+O*Q+E*q+U*$,J=Y.self._02,Q=Y.self._12,q=Y.self._22,$=Y.self._32,X.self._02=N*J+L*Q+G*q+W*$,X.self._12=D*J+T*Q+V*q+K*$,X.self._22=j*J+R*Q+H*q+P*$,X.self._32=F*J+O*Q+E*q+U*$,J=Y.self._03,Q=Y.self._13,q=Y.self._23,$=Y.self._33,X.self._03=N*J+L*Q+G*q+W*$,X.self._13=D*J+T*Q+V*q+K*$,X.self._23=j*J+R*Q+H*q+P*$,X.self._33=F*J+O*Q+E*q+U*$,this.decompose(),this.buildMatrix()},_eulerX:null,_eulerY:null,_eulerZ:null,dloc:null,drot:null,dscale:null,_deulerX:null,_deulerY:null,_deulerZ:null,__class__:je};var Ct=function(t,e,a,i,n,s,r,o,l){this._00=t,this._10=e,this._20=a,this._01=i,this._11=n,this._21=s,this._02=r,this._12=o,this._22=l};(i["kha.math.FastMatrix3"]=Ct).__name__=!0,Ct.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:Ct};var c_=function(){};(i["iron.object.Uniforms"]=c_).__name__=!0,c_.setContextConstants=function(t,e,a,i,n){if(null!=e.raw.constants)for(var s=0,r=e.raw.constants.length;s<r;){var o=s++,l=e.raw.constants[o];c_.setContextConstant(t,a,i,e.constants[o],l)}if(null!=n)for(var _=0,h=n.length/2|0;_<h;){var f,u=2*_++,c=n[u],d=n[u+1],g=!1;if("_"==c.charAt(0)&&(g=!0,c=q.substr(c,1,null)),g){var p=_o.active.depthToRenderTarget;f=null!=fs[c]?p.getReserved(c):p.h[c]}else{var m=_o.active.renderTargets;f=null!=fs[c]?m.getReserved(c):m.h[c]}c_.bindRenderTarget(t,f,e,d,g)}if(null!=e.raw.texture_units)for(var v=0,b=e.raw.texture_units.length;v<b;){var I=v++,M=e.raw.texture_units[I].link;if(null!=M)if("_envmapRadiance"==M){var y=h_.active.world;null!=y&&(t.setTexture(e.textureUnits[I],y.getGlobalProbe().radiance),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.LinearMipFilter))}else if("_envmap"==M){var w=h_.active.world;null!=w&&t.setTexture(e.textureUnits[I],w.envmap)}else if("_envmapBrdf"==M){var x=h_.active.embedded;t.setTexture(e.textureUnits[I],null!=fs["brdf.png"]?x.getReserved("brdf.png"):x.h["brdf.png"])}else if("_noise8"==M){var C=h_.active.embedded;t.setTexture(e.textureUnits[I],null!=fs["noise8.png"]?C.getReserved("noise8.png"):C.h["noise8.png"]),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter)}else if("_noise64"==M){var A=h_.active.embedded;t.setTexture(e.textureUnits[I],null!=fs["noise64.png"]?A.getReserved("noise64.png"):A.h["noise64.png"]),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter)}else if("_blueNoise64"==M){var Z=h_.active.embedded;t.setTexture(e.textureUnits[I],null!=fs["blue_noise64.png"]?Z.getReserved("blue_noise64.png"):Z.h["blue_noise64.png"]),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter)}else if("_noise256"==M){var z=h_.active.embedded;t.setTexture(e.textureUnits[I],null!=fs["noise256.png"]?z.getReserved("noise256.png"):z.h["noise256.png"]),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter)}else if("_lightColorTexture"==M)null!=i&&(t.setTexture(e.textureUnits[I],i.data.colorTexture),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter));else if("_iesTexture"==M){var B=h_.active.embedded;t.setTexture(e.textureUnits[I],null!=fs["iestexture.png"]?B.getReserved("iestexture.png"):B.h["iestexture.png"]),t.setTextureParameters(e.textureUnits[I],Da.Repeat,Da.Repeat,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter)}else;}},c_.setObjectConstants=function(t,e,a,i,n){if(null!=e.raw.constants)for(var s=0,r=e.raw.constants.length;s<r;){var o=s++,l=e.raw.constants[o];c_.setObjectConstant(t,a,i,n,e.constants[o],l)}if(null!=c_.externalTextureLinks&&null!=e.raw.texture_units)for(var _=0,h=e.raw.texture_units.length;_<h;){var f=_++,u=e.raw.texture_units[f].link;if(null!=u)for(var c=0,d=c_.externalTextureLinks;c<d.length;){var g=d[c];++c;var p=g(a,c_.currentMat(a),u);if(null!=p){t.setTexture(e.textureUnits[f],p);break}}}},c_.bindRenderTarget=function(t,e,a,i,n){if(null!=e)for(var s=a.raw.texture_units,r=0,o=s.length;r<o;){var l=r++;if(i==s[l].name){var _=null!=s[l].is_image&&s[l].is_image;1<e.raw.depth&&(t.setTexture3DParameters(a.textureUnits[l],Da.Clamp,Da.Clamp,Da.Clamp,Ta.LinearFilter,Ta.PointFilter,Xa.LinearMipFilter),a.paramsSet[l]=!0),_?(t.setImageTexture(a.textureUnits[l],e.image),t.setTexture3DParameters(a.textureUnits[l],Da.Clamp,Da.Clamp,Da.Clamp,Ta.LinearFilter,Ta.PointFilter,Xa.LinearMipFilter),a.paramsSet[l]=!0):e.isCubeMap?n?t.setCubeMapDepth(a.textureUnits[l],e.cubeMap):t.setCubeMap(a.textureUnits[l],e.cubeMap):n?t.setTextureDepth(a.textureUnits[l],e.image):t.setTexture(a.textureUnits[l],e.image),a.paramsSet[l]||null==e.raw.mipmaps||1!=e.raw.mipmaps||_||(t.setTextureParameters(a.textureUnits[l],Da.Clamp,Da.Clamp,Ta.LinearFilter,Ta.LinearFilter,Xa.LinearMipFilter),a.paramsSet[l]=!0),a.paramsSet[l]||(("shadowMap"==i||n)&&(t.setTextureParameters(a.textureUnits[l],Da.Clamp,Da.Clamp,Ta.PointFilter,Ta.PointFilter,Xa.NoMipFilter),a.paramsSet[l]=!0),"shadowMapCube"==i&&(a.paramsSet[l]=!0)),a.paramsSet[l]||(t.setTextureParameters(a.textureUnits[l],Da.Clamp,Da.Clamp,Ta.LinearFilter,Ta.LinearFilter,Xa.NoMipFilter),a.paramsSet[l]=!0)}}},c_.setContextConstant=function(t,e,a,i,n){if(null==n.link)return!0;if("mat4"==n.type){var s=null;if("_viewMatrix"==n.link)s=e.V;else if("_transposeInverseViewMatrix"==n.link){var r=c_.helpMat,o=e.V;r.self._00=o.self._00,r.self._01=o.self._01,r.self._02=o.self._02,r.self._03=o.self._03,r.self._10=o.self._10,r.self._11=o.self._11,r.self._12=o.self._12,r.self._13=o.self._13,r.self._20=o.self._20,r.self._21=o.self._21,r.self._22=o.self._22,r.self._23=o.self._23,r.self._30=o.self._30,r.self._31=o.self._31,r.self._32=o.self._32,r.self._33=o.self._33;var l=c_.helpMat,_=c_.helpMat,h=_.self._00,f=_.self._01,u=_.self._02,c=_.self._03,d=_.self._10,g=_.self._11,p=_.self._12,m=_.self._13,v=_.self._20,b=_.self._21,I=_.self._22,M=_.self._23,y=_.self._30,w=_.self._31,x=_.self._32,C=_.self._33,A=h*g-f*d,Z=h*p-u*d,z=h*m-c*d,B=f*p-u*g,k=f*m-c*g,S=u*m-c*p,X=v*w-b*y,Y=v*x-I*y,N=v*C-M*y,L=b*x-I*w,G=b*C-M*w,W=I*C-M*x,D=A*W-Z*G+z*L+B*N-k*Y+S*X;0==D?(l.self._00=1,l.self._01=0,l.self._02=0,l.self._03=0,l.self._10=0,l.self._11=1,l.self._12=0,l.self._13=0,l.self._20=0,l.self._21=0,l.self._22=1,l.self._23=0,l.self._30=0,l.self._31=0,l.self._32=0,l.self._33=1):(D=1/D,l.self._00=(g*W-p*G+m*L)*D,l.self._01=(u*G-f*W-c*L)*D,l.self._02=(w*S-x*k+C*B)*D,l.self._03=(I*k-b*S-M*B)*D,l.self._10=(p*N-d*W-m*Y)*D,l.self._11=(h*W-u*N+c*Y)*D,l.self._12=(x*z-y*S-C*Z)*D,l.self._13=(v*S-I*z+M*Z)*D,l.self._20=(d*G-g*N+m*X)*D,l.self._21=(f*N-h*G-c*X)*D,l.self._22=(y*k-w*z+C*A)*D,l.self._23=(b*z-v*k-M*A)*D,l.self._30=(g*Y-d*L-p*X)*D,l.self._31=(h*L-f*Y+u*X)*D,l.self._32=(w*Z-y*B-x*A)*D,l.self._33=(v*B-b*Z+I*A)*D);var T=c_.helpMat,V=T.self._01;T.self._01=T.self._10,T.self._10=V,V=T.self._02,T.self._02=T.self._20,T.self._20=V,V=T.self._03,T.self._03=T.self._30,T.self._30=V,V=T.self._12,T.self._12=T.self._21,T.self._21=V,V=T.self._13,T.self._13=T.self._31,T.self._31=V,V=T.self._23,T.self._23=T.self._32,T.self._32=V,s=c_.helpMat}else if("_inverseViewMatrix"==n.link){var K=c_.helpMat,j=e.V,R=j.self._00,H=j.self._01,P=j.self._02,F=j.self._03,O=j.self._10,E=j.self._11,U=j.self._12,J=j.self._13,Q=j.self._20,q=j.self._21,$=j.self._22,tt=j.self._23,et=j.self._30,at=j.self._31,it=j.self._32,nt=j.self._33,st=R*E-H*O,rt=R*U-P*O,ot=R*J-F*O,lt=H*U-P*E,_t=H*J-F*E,ht=P*J-F*U,ft=Q*at-q*et,ut=Q*it-$*et,ct=Q*nt-tt*et,dt=q*it-$*at,gt=q*nt-tt*at,pt=$*nt-tt*it,mt=st*pt-rt*gt+ot*dt+lt*ct-_t*ut+ht*ft;0==mt?(K.self._00=1,K.self._01=0,K.self._02=0,K.self._03=0,K.self._10=0,K.self._11=1,K.self._12=0,K.self._13=0,K.self._20=0,K.self._21=0,K.self._22=1,K.self._23=0,K.self._30=0,K.self._31=0,K.self._32=0,K.self._33=1):(mt=1/mt,K.self._00=(E*pt-U*gt+J*dt)*mt,K.self._01=(P*gt-H*pt-F*dt)*mt,K.self._02=(at*ht-it*_t+nt*lt)*mt,K.self._03=($*_t-q*ht-tt*lt)*mt,K.self._10=(U*ct-O*pt-J*ut)*mt,K.self._11=(R*pt-P*ct+F*ut)*mt,K.self._12=(it*ot-et*ht-nt*rt)*mt,K.self._13=(Q*ht-$*ot+tt*rt)*mt,K.self._20=(O*gt-E*ct+J*ft)*mt,K.self._21=(H*ct-R*gt-F*ft)*mt,K.self._22=(et*_t-at*ot+nt*st)*mt,K.self._23=(q*ot-Q*_t-tt*st)*mt,K.self._30=(E*ut-O*dt-U*ft)*mt,K.self._31=(R*dt-H*ut+P*ft)*mt,K.self._32=(at*rt-et*lt-it*st)*mt,K.self._33=(Q*lt-q*rt+$*st)*mt),s=c_.helpMat}else if("_transposeViewMatrix"==n.link){var vt=c_.helpMat,bt=e.V;vt.self._00=bt.self._00,vt.self._01=bt.self._01,vt.self._02=bt.self._02,vt.self._03=bt.self._03,vt.self._10=bt.self._10,vt.self._11=bt.self._11,vt.self._12=bt.self._12,vt.self._13=bt.self._13,vt.self._20=bt.self._20,vt.self._21=bt.self._21,vt.self._22=bt.self._22,vt.self._23=bt.self._23,vt.self._30=bt.self._30,vt.self._31=bt.self._31,vt.self._32=bt.self._32,vt.self._33=bt.self._33;var It=c_.helpMat,Mt=It.self._01;It.self._01=It.self._10,It.self._10=Mt,Mt=It.self._02,It.self._02=It.self._20,It.self._20=Mt,Mt=It.self._12,It.self._12=It.self._21,It.self._21=Mt,s=c_.helpMat}else if("_projectionMatrix"==n.link)s=e.P;else if("_inverseProjectionMatrix"==n.link){var yt=c_.helpMat,wt=e.P,xt=wt.self._00,Ct=wt.self._01,At=wt.self._02,Zt=wt.self._03,zt=wt.self._10,Bt=wt.self._11,kt=wt.self._12,St=wt.self._13,Xt=wt.self._20,Yt=wt.self._21,Nt=wt.self._22,Lt=wt.self._23,Gt=wt.self._30,Wt=wt.self._31,Dt=wt.self._32,Tt=wt.self._33,Vt=xt*Bt-Ct*zt,Kt=xt*kt-At*zt,jt=xt*St-Zt*zt,Rt=Ct*kt-At*Bt,Ht=Ct*St-Zt*Bt,Pt=At*St-Zt*kt,Ft=Xt*Wt-Yt*Gt,Ot=Xt*Dt-Nt*Gt,Et=Xt*Tt-Lt*Gt,Ut=Yt*Dt-Nt*Wt,Jt=Yt*Tt-Lt*Wt,Qt=Nt*Tt-Lt*Dt,qt=Vt*Qt-Kt*Jt+jt*Ut+Rt*Et-Ht*Ot+Pt*Ft;0==qt?(yt.self._00=1,yt.self._01=0,yt.self._02=0,yt.self._03=0,yt.self._10=0,yt.self._11=1,yt.self._12=0,yt.self._13=0,yt.self._20=0,yt.self._21=0,yt.self._22=1,yt.self._23=0,yt.self._30=0,yt.self._31=0,yt.self._32=0,yt.self._33=1):(qt=1/qt,yt.self._00=(Bt*Qt-kt*Jt+St*Ut)*qt,yt.self._01=(At*Jt-Ct*Qt-Zt*Ut)*qt,yt.self._02=(Wt*Pt-Dt*Ht+Tt*Rt)*qt,yt.self._03=(Nt*Ht-Yt*Pt-Lt*Rt)*qt,yt.self._10=(kt*Et-zt*Qt-St*Ot)*qt,yt.self._11=(xt*Qt-At*Et+Zt*Ot)*qt,yt.self._12=(Dt*jt-Gt*Pt-Tt*Kt)*qt,yt.self._13=(Xt*Pt-Nt*jt+Lt*Kt)*qt,yt.self._20=(zt*Jt-Bt*Et+St*Ft)*qt,yt.self._21=(Ct*Et-xt*Jt-Zt*Ft)*qt,yt.self._22=(Gt*Ht-Wt*jt+Tt*Vt)*qt,yt.self._23=(Yt*jt-Xt*Ht-Lt*Vt)*qt,yt.self._30=(Bt*Ot-zt*Ut-kt*Ft)*qt,yt.self._31=(xt*Ut-Ct*Ot+At*Ft)*qt,yt.self._32=(Wt*Kt-Gt*Rt-Dt*Vt)*qt,yt.self._33=(Xt*Rt-Yt*Kt+Nt*Vt)*qt),s=c_.helpMat}else if("_inverseViewProjectionMatrix"==n.link){var $t=c_.helpMat,te=e.V;$t.self._00=te.self._00,$t.self._01=te.self._01,$t.self._02=te.self._02,$t.self._03=te.self._03,$t.self._10=te.self._10,$t.self._11=te.self._11,$t.self._12=te.self._12,$t.self._13=te.self._13,$t.self._20=te.self._20,$t.self._21=te.self._21,$t.self._22=te.self._22,$t.self._23=te.self._23,$t.self._30=te.self._30,$t.self._31=te.self._31,$t.self._32=te.self._32,$t.self._33=te.self._33;var ee=c_.helpMat,ae=e.P,ie=ee.self._00,ne=ee.self._01,se=ee.self._02,re=ee.self._03,oe=ee.self._10,le=ee.self._11,_e=ee.self._12,he=ee.self._13,fe=ee.self._20,ue=ee.self._21,ce=ee.self._22,de=ee.self._23,ge=ee.self._30,pe=ee.self._31,me=ee.self._32,ve=ee.self._33,be=ae.self._00,Ie=ae.self._10,Me=ae.self._20,ye=ae.self._30;ee.self._00=ie*be+ne*Ie+se*Me+re*ye,ee.self._10=oe*be+le*Ie+_e*Me+he*ye,ee.self._20=fe*be+ue*Ie+ce*Me+de*ye,ee.self._30=ge*be+pe*Ie+me*Me+ve*ye,be=ae.self._01,Ie=ae.self._11,Me=ae.self._21,ye=ae.self._31,ee.self._01=ie*be+ne*Ie+se*Me+re*ye,ee.self._11=oe*be+le*Ie+_e*Me+he*ye,ee.self._21=fe*be+ue*Ie+ce*Me+de*ye,ee.self._31=ge*be+pe*Ie+me*Me+ve*ye,be=ae.self._02,Ie=ae.self._12,Me=ae.self._22,ye=ae.self._32,ee.self._02=ie*be+ne*Ie+se*Me+re*ye,ee.self._12=oe*be+le*Ie+_e*Me+he*ye,ee.self._22=fe*be+ue*Ie+ce*Me+de*ye,ee.self._32=ge*be+pe*Ie+me*Me+ve*ye,be=ae.self._03,Ie=ae.self._13,Me=ae.self._23,ye=ae.self._33,ee.self._03=ie*be+ne*Ie+se*Me+re*ye,ee.self._13=oe*be+le*Ie+_e*Me+he*ye,ee.self._23=fe*be+ue*Ie+ce*Me+de*ye,ee.self._33=ge*be+pe*Ie+me*Me+ve*ye;var we=c_.helpMat,xe=c_.helpMat,Ce=xe.self._00,Ae=xe.self._01,Ze=xe.self._02,ze=xe.self._03,Be=xe.self._10,ke=xe.self._11,Se=xe.self._12,Xe=xe.self._13,Ye=xe.self._20,Ne=xe.self._21,Le=xe.self._22,Ge=xe.self._23,We=xe.self._30,De=xe.self._31,Te=xe.self._32,Ve=xe.self._33,Ke=Ce*ke-Ae*Be,je=Ce*Se-Ze*Be,Re=Ce*Xe-ze*Be,He=Ae*Se-Ze*ke,Pe=Ae*Xe-ze*ke,Fe=Ze*Xe-ze*Se,Oe=Ye*De-Ne*We,Ee=Ye*Te-Le*We,Ue=Ye*Ve-Ge*We,Je=Ne*Te-Le*De,Qe=Ne*Ve-Ge*De,qe=Le*Ve-Ge*Te,$e=Ke*qe-je*Qe+Re*Je+He*Ue-Pe*Ee+Fe*Oe;0==$e?(we.self._00=1,we.self._01=0,we.self._02=0,we.self._03=0,we.self._10=0,we.self._11=1,we.self._12=0,we.self._13=0,we.self._20=0,we.self._21=0,we.self._22=1,we.self._23=0,we.self._30=0,we.self._31=0,we.self._32=0,we.self._33=1):($e=1/$e,we.self._00=(ke*qe-Se*Qe+Xe*Je)*$e,we.self._01=(Ze*Qe-Ae*qe-ze*Je)*$e,we.self._02=(De*Fe-Te*Pe+Ve*He)*$e,we.self._03=(Le*Pe-Ne*Fe-Ge*He)*$e,we.self._10=(Se*Ue-Be*qe-Xe*Ee)*$e,we.self._11=(Ce*qe-Ze*Ue+ze*Ee)*$e,we.self._12=(Te*Re-We*Fe-Ve*je)*$e,we.self._13=(Ye*Fe-Le*Re+Ge*je)*$e,we.self._20=(Be*Qe-ke*Ue+Xe*Oe)*$e,we.self._21=(Ae*Ue-Ce*Qe-ze*Oe)*$e,we.self._22=(We*Pe-De*Re+Ve*Ke)*$e,we.self._23=(Ne*Re-Ye*Pe-Ge*Ke)*$e,we.self._30=(ke*Ee-Be*Je-Se*Oe)*$e,we.self._31=(Ce*Je-Ae*Ee+Ze*Oe)*$e,we.self._32=(De*je-We*He-Te*Ke)*$e,we.self._33=(Ye*He-Ne*je+Le*Ke)*$e),s=c_.helpMat}else if("_viewProjectionMatrix"==n.link)s=e.VP;else if("_prevViewProjectionMatrix"==n.link){var ta=c_.helpMat,ea=e.prevV;ta.self._00=ea.self._00,ta.self._01=ea.self._01,ta.self._02=ea.self._02,ta.self._03=ea.self._03,ta.self._10=ea.self._10,ta.self._11=ea.self._11,ta.self._12=ea.self._12,ta.self._13=ea.self._13,ta.self._20=ea.self._20,ta.self._21=ea.self._21,ta.self._22=ea.self._22,ta.self._23=ea.self._23,ta.self._30=ea.self._30,ta.self._31=ea.self._31,ta.self._32=ea.self._32,ta.self._33=ea.self._33;var aa=c_.helpMat,ia=e.P,na=aa.self._00,sa=aa.self._01,ra=aa.self._02,oa=aa.self._03,la=aa.self._10,_a=aa.self._11,ha=aa.self._12,fa=aa.self._13,ua=aa.self._20,ca=aa.self._21,da=aa.self._22,ga=aa.self._23,pa=aa.self._30,ma=aa.self._31,va=aa.self._32,ba=aa.self._33,Ia=ia.self._00,Ma=ia.self._10,ya=ia.self._20,wa=ia.self._30;aa.self._00=na*Ia+sa*Ma+ra*ya+oa*wa,aa.self._10=la*Ia+_a*Ma+ha*ya+fa*wa,aa.self._20=ua*Ia+ca*Ma+da*ya+ga*wa,aa.self._30=pa*Ia+ma*Ma+va*ya+ba*wa,Ia=ia.self._01,Ma=ia.self._11,ya=ia.self._21,wa=ia.self._31,aa.self._01=na*Ia+sa*Ma+ra*ya+oa*wa,aa.self._11=la*Ia+_a*Ma+ha*ya+fa*wa,aa.self._21=ua*Ia+ca*Ma+da*ya+ga*wa,aa.self._31=pa*Ia+ma*Ma+va*ya+ba*wa,Ia=ia.self._02,Ma=ia.self._12,ya=ia.self._22,wa=ia.self._32,aa.self._02=na*Ia+sa*Ma+ra*ya+oa*wa,aa.self._12=la*Ia+_a*Ma+ha*ya+fa*wa,aa.self._22=ua*Ia+ca*Ma+da*ya+ga*wa,aa.self._32=pa*Ia+ma*Ma+va*ya+ba*wa,Ia=ia.self._03,Ma=ia.self._13,ya=ia.self._23,wa=ia.self._33,aa.self._03=na*Ia+sa*Ma+ra*ya+oa*wa,aa.self._13=la*Ia+_a*Ma+ha*ya+fa*wa,aa.self._23=ua*Ia+ca*Ma+da*ya+ga*wa,aa.self._33=pa*Ia+ma*Ma+va*ya+ba*wa,s=c_.helpMat}else if("_lightViewProjectionMatrix"==n.link)null!=a&&(s=a.VP);else if("_biasLightViewProjectionMatrix"==n.link){if(null!=a){var xa=c_.helpMat,Ca=a.VP;xa.self._00=Ca.self._00,xa.self._01=Ca.self._01,xa.self._02=Ca.self._02,xa.self._03=Ca.self._03,xa.self._10=Ca.self._10,xa.self._11=Ca.self._11,xa.self._12=Ca.self._12,xa.self._13=Ca.self._13,xa.self._20=Ca.self._20,xa.self._21=Ca.self._21,xa.self._22=Ca.self._22,xa.self._23=Ca.self._23,xa.self._30=Ca.self._30,xa.self._31=Ca.self._31,xa.self._32=Ca.self._32,xa.self._33=Ca.self._33;var Aa=c_.helpMat,Za=c_.biasMat,za=Aa.self._00,Ba=Aa.self._01,ka=Aa.self._02,Sa=Aa.self._03,Xa=Aa.self._10,Ya=Aa.self._11,Na=Aa.self._12,La=Aa.self._13,Ga=Aa.self._20,Wa=Aa.self._21,Da=Aa.self._22,Ta=Aa.self._23,Va=Aa.self._30,Ka=Aa.self._31,ja=Aa.self._32,Ra=Aa.self._33,Ha=Za.self._00,Pa=Za.self._10,Fa=Za.self._20,Oa=Za.self._30;Aa.self._00=za*Ha+Ba*Pa+ka*Fa+Sa*Oa,Aa.self._10=Xa*Ha+Ya*Pa+Na*Fa+La*Oa,Aa.self._20=Ga*Ha+Wa*Pa+Da*Fa+Ta*Oa,Aa.self._30=Va*Ha+Ka*Pa+ja*Fa+Ra*Oa,Ha=Za.self._01,Pa=Za.self._11,Fa=Za.self._21,Oa=Za.self._31,Aa.self._01=za*Ha+Ba*Pa+ka*Fa+Sa*Oa,Aa.self._11=Xa*Ha+Ya*Pa+Na*Fa+La*Oa,Aa.self._21=Ga*Ha+Wa*Pa+Da*Fa+Ta*Oa,Aa.self._31=Va*Ha+Ka*Pa+ja*Fa+Ra*Oa,Ha=Za.self._02,Pa=Za.self._12,Fa=Za.self._22,Oa=Za.self._32,Aa.self._02=za*Ha+Ba*Pa+ka*Fa+Sa*Oa,Aa.self._12=Xa*Ha+Ya*Pa+Na*Fa+La*Oa,Aa.self._22=Ga*Ha+Wa*Pa+Da*Fa+Ta*Oa,Aa.self._32=Va*Ha+Ka*Pa+ja*Fa+Ra*Oa,Ha=Za.self._03,Pa=Za.self._13,Fa=Za.self._23,Oa=Za.self._33,Aa.self._03=za*Ha+Ba*Pa+ka*Fa+Sa*Oa,Aa.self._13=Xa*Ha+Ya*Pa+Na*Fa+La*Oa,Aa.self._23=Ga*Ha+Wa*Pa+Da*Fa+Ta*Oa,Aa.self._33=Va*Ha+Ka*Pa+ja*Fa+Ra*Oa,s=c_.helpMat}}else if("_lightVolumeWorldViewProjectionMatrix"==n.link){if(null!=a){var Ea=a.transform,Ua=a.data.raw.type;if("spot"==Ua){var Ja=c_.helpVec;Ja.x=Ea.world.self._30,Ja.y=Ea.world.self._31,Ja.z=Ea.world.self._32,Ja.w=1;var Qa=c_.helpVec2;Qa.x=a.data.raw.far_plane,Qa.y=2*a.data.raw.far_plane,Qa.z=2*a.data.raw.far_plane,Qa.w=1;var qa=c_.helpMat,$a=c_.helpVec,ti=c_.helpQuat,ei=c_.helpVec2,ai=ti.x,ii=ti.y,ni=ti.z,si=ti.w,ri=ai+ai,oi=ii+ii,li=ni+ni,_i=ai*ri,hi=ai*oi,fi=ai*li,ui=ii*oi,ci=ii*li,di=ni*li,gi=si*ri,pi=si*oi,mi=si*li;qa.self._00=1-(ui+di),qa.self._10=hi-mi,qa.self._20=fi+pi,qa.self._01=hi+mi,qa.self._11=1-(_i+di),qa.self._21=ci-gi,qa.self._02=fi-pi,qa.self._12=ci+gi,qa.self._22=1-(_i+ui),qa.self._03=0,qa.self._13=0,qa.self._23=0,qa.self._30=0,qa.self._31=0,qa.self._32=0,qa.self._33=1;var vi=ei.x,bi=ei.y,Ii=ei.z;qa.self._00*=vi,qa.self._01*=vi,qa.self._02*=vi,qa.self._03*=vi,qa.self._10*=bi,qa.self._11*=bi,qa.self._12*=bi,qa.self._13*=bi,qa.self._20*=Ii,qa.self._21*=Ii,qa.self._22*=Ii,qa.self._23*=Ii,qa.self._30=$a.x,qa.self._31=$a.y,qa.self._32=$a.z}else if("point"==Ua||"area"==Ua){var Mi=c_.helpVec;Mi.x=Ea.world.self._30,Mi.y=Ea.world.self._31,Mi.z=Ea.world.self._32,Mi.w=1;var yi=c_.helpVec2;yi.x=a.data.raw.far_plane,yi.y=2*a.data.raw.far_plane,yi.z=2*a.data.raw.far_plane,yi.w=1;var wi=c_.helpMat,xi=c_.helpVec,Ci=c_.helpQuat,Ai=c_.helpVec2,Zi=Ci.x,zi=Ci.y,Bi=Ci.z,ki=Ci.w,Si=Zi+Zi,Xi=zi+zi,Yi=Bi+Bi,Ni=Zi*Si,Li=Zi*Xi,Gi=Zi*Yi,Wi=zi*Xi,Di=zi*Yi,Ti=Bi*Yi,Vi=ki*Si,Ki=ki*Xi,ji=ki*Yi;wi.self._00=1-(Wi+Ti),wi.self._10=Li-ji,wi.self._20=Gi+Ki,wi.self._01=Li+ji,wi.self._11=1-(Ni+Ti),wi.self._21=Di-Vi,wi.self._02=Gi-Ki,wi.self._12=Di+Vi,wi.self._22=1-(Ni+Wi),wi.self._03=0,wi.self._13=0,wi.self._23=0,wi.self._30=0,wi.self._31=0,wi.self._32=0,wi.self._33=1;var Ri=Ai.x,Hi=Ai.y,Pi=Ai.z;wi.self._00*=Ri,wi.self._01*=Ri,wi.self._02*=Ri,wi.self._03*=Ri,wi.self._10*=Hi,wi.self._11*=Hi,wi.self._12*=Hi,wi.self._13*=Hi,wi.self._20*=Pi,wi.self._21*=Pi,wi.self._22*=Pi,wi.self._23*=Pi,wi.self._30=xi.x,wi.self._31=xi.y,wi.self._32=xi.z}var Fi=c_.helpMat,Oi=e.V,Ei=Fi.self._00,Ui=Fi.self._01,Ji=Fi.self._02,Qi=Fi.self._03,qi=Fi.self._10,$i=Fi.self._11,tn=Fi.self._12,en=Fi.self._13,an=Fi.self._20,nn=Fi.self._21,sn=Fi.self._22,rn=Fi.self._23,on=Fi.self._30,ln=Fi.self._31,_n=Fi.self._32,hn=Fi.self._33,fn=Oi.self._00,un=Oi.self._10,cn=Oi.self._20,dn=Oi.self._30;Fi.self._00=Ei*fn+Ui*un+Ji*cn+Qi*dn,Fi.self._10=qi*fn+$i*un+tn*cn+en*dn,Fi.self._20=an*fn+nn*un+sn*cn+rn*dn,Fi.self._30=on*fn+ln*un+_n*cn+hn*dn,fn=Oi.self._01,un=Oi.self._11,cn=Oi.self._21,dn=Oi.self._31,Fi.self._01=Ei*fn+Ui*un+Ji*cn+Qi*dn,Fi.self._11=qi*fn+$i*un+tn*cn+en*dn,Fi.self._21=an*fn+nn*un+sn*cn+rn*dn,Fi.self._31=on*fn+ln*un+_n*cn+hn*dn,fn=Oi.self._02,un=Oi.self._12,cn=Oi.self._22,dn=Oi.self._32,Fi.self._02=Ei*fn+Ui*un+Ji*cn+Qi*dn,Fi.self._12=qi*fn+$i*un+tn*cn+en*dn,Fi.self._22=an*fn+nn*un+sn*cn+rn*dn,Fi.self._32=on*fn+ln*un+_n*cn+hn*dn,fn=Oi.self._03,un=Oi.self._13,cn=Oi.self._23,dn=Oi.self._33,Fi.self._03=Ei*fn+Ui*un+Ji*cn+Qi*dn,Fi.self._13=qi*fn+$i*un+tn*cn+en*dn,Fi.self._23=an*fn+nn*un+sn*cn+rn*dn,Fi.self._33=on*fn+ln*un+_n*cn+hn*dn;var gn=c_.helpMat,pn=e.P,mn=gn.self._00,vn=gn.self._01,bn=gn.self._02,In=gn.self._03,Mn=gn.self._10,yn=gn.self._11,wn=gn.self._12,xn=gn.self._13,Cn=gn.self._20,An=gn.self._21,Zn=gn.self._22,zn=gn.self._23,Bn=gn.self._30,kn=gn.self._31,Sn=gn.self._32,Xn=gn.self._33,Yn=pn.self._00,Nn=pn.self._10,Ln=pn.self._20,Gn=pn.self._30;gn.self._00=mn*Yn+vn*Nn+bn*Ln+In*Gn,gn.self._10=Mn*Yn+yn*Nn+wn*Ln+xn*Gn,gn.self._20=Cn*Yn+An*Nn+Zn*Ln+zn*Gn,gn.self._30=Bn*Yn+kn*Nn+Sn*Ln+Xn*Gn,Yn=pn.self._01,Nn=pn.self._11,Ln=pn.self._21,Gn=pn.self._31,gn.self._01=mn*Yn+vn*Nn+bn*Ln+In*Gn,gn.self._11=Mn*Yn+yn*Nn+wn*Ln+xn*Gn,gn.self._21=Cn*Yn+An*Nn+Zn*Ln+zn*Gn,gn.self._31=Bn*Yn+kn*Nn+Sn*Ln+Xn*Gn,Yn=pn.self._02,Nn=pn.self._12,Ln=pn.self._22,Gn=pn.self._32,gn.self._02=mn*Yn+vn*Nn+bn*Ln+In*Gn,gn.self._12=Mn*Yn+yn*Nn+wn*Ln+xn*Gn,gn.self._22=Cn*Yn+An*Nn+Zn*Ln+zn*Gn,gn.self._32=Bn*Yn+kn*Nn+Sn*Ln+Xn*Gn,Yn=pn.self._03,Nn=pn.self._13,Ln=pn.self._23,Gn=pn.self._33,gn.self._03=mn*Yn+vn*Nn+bn*Ln+In*Gn,gn.self._13=Mn*Yn+yn*Nn+wn*Ln+xn*Gn,gn.self._23=Cn*Yn+An*Nn+Zn*Ln+zn*Gn,gn.self._33=Bn*Yn+kn*Nn+Sn*Ln+Xn*Gn,s=c_.helpMat}}else if("_skydomeMatrix"==n.link){var Wn=e.transform,Dn=c_.helpVec;Dn.x=Wn.world.self._30,Dn.y=Wn.world.self._31,Dn.z=Wn.world.self._32-3.5,Dn.w=1;var Tn=.95*e.data.raw.far_plane,Vn=c_.helpVec2;Vn.x=Tn,Vn.y=Tn,Vn.z=Tn,Vn.w=1;var Kn=c_.helpMat,jn=c_.helpVec,Rn=c_.helpQuat,Hn=c_.helpVec2,Pn=Rn.x,Fn=Rn.y,On=Rn.z,En=Rn.w,Un=Pn+Pn,Jn=Fn+Fn,Qn=On+On,qn=Pn*Un,$n=Pn*Jn,ts=Pn*Qn,es=Fn*Jn,as=Fn*Qn,is=On*Qn,ns=En*Un,ss=En*Jn,rs=En*Qn;Kn.self._00=1-(es+is),Kn.self._10=$n-rs,Kn.self._20=ts+ss,Kn.self._01=$n+rs,Kn.self._11=1-(qn+is),Kn.self._21=as-ns,Kn.self._02=ts-ss,Kn.self._12=as+ns,Kn.self._22=1-(qn+es),Kn.self._03=0,Kn.self._13=0,Kn.self._23=0,Kn.self._30=0,Kn.self._31=0,Kn.self._32=0,Kn.self._33=1;var os=Hn.x,ls=Hn.y,_s=Hn.z;Kn.self._00*=os,Kn.self._01*=os,Kn.self._02*=os,Kn.self._03*=os,Kn.self._10*=ls,Kn.self._11*=ls,Kn.self._12*=ls,Kn.self._13*=ls,Kn.self._20*=_s,Kn.self._21*=_s,Kn.self._22*=_s,Kn.self._23*=_s,Kn.self._30=jn.x,Kn.self._31=jn.y,Kn.self._32=jn.z;var hs=c_.helpMat,fs=e.V,us=hs.self._00,cs=hs.self._01,ds=hs.self._02,gs=hs.self._03,ps=hs.self._10,ms=hs.self._11,vs=hs.self._12,bs=hs.self._13,Is=hs.self._20,Ms=hs.self._21,ys=hs.self._22,ws=hs.self._23,xs=hs.self._30,Cs=hs.self._31,As=hs.self._32,Zs=hs.self._33,zs=fs.self._00,Bs=fs.self._10,ks=fs.self._20,Ss=fs.self._30;hs.self._00=us*zs+cs*Bs+ds*ks+gs*Ss,hs.self._10=ps*zs+ms*Bs+vs*ks+bs*Ss,hs.self._20=Is*zs+Ms*Bs+ys*ks+ws*Ss,hs.self._30=xs*zs+Cs*Bs+As*ks+Zs*Ss,zs=fs.self._01,Bs=fs.self._11,ks=fs.self._21,Ss=fs.self._31,hs.self._01=us*zs+cs*Bs+ds*ks+gs*Ss,hs.self._11=ps*zs+ms*Bs+vs*ks+bs*Ss,hs.self._21=Is*zs+Ms*Bs+ys*ks+ws*Ss,hs.self._31=xs*zs+Cs*Bs+As*ks+Zs*Ss,zs=fs.self._02,Bs=fs.self._12,ks=fs.self._22,Ss=fs.self._32,hs.self._02=us*zs+cs*Bs+ds*ks+gs*Ss,hs.self._12=ps*zs+ms*Bs+vs*ks+bs*Ss,hs.self._22=Is*zs+Ms*Bs+ys*ks+ws*Ss,hs.self._32=xs*zs+Cs*Bs+As*ks+Zs*Ss,zs=fs.self._03,Bs=fs.self._13,ks=fs.self._23,Ss=fs.self._33,hs.self._03=us*zs+cs*Bs+ds*ks+gs*Ss,hs.self._13=ps*zs+ms*Bs+vs*ks+bs*Ss,hs.self._23=Is*zs+Ms*Bs+ys*ks+ws*Ss,hs.self._33=xs*zs+Cs*Bs+As*ks+Zs*Ss;var Xs=c_.helpMat,Ys=e.P,Ns=Xs.self._00,Ls=Xs.self._01,Gs=Xs.self._02,Ws=Xs.self._03,Ds=Xs.self._10,Ts=Xs.self._11,Vs=Xs.self._12,Ks=Xs.self._13,js=Xs.self._20,Rs=Xs.self._21,Hs=Xs.self._22,Ps=Xs.self._23,Fs=Xs.self._30,Os=Xs.self._31,Es=Xs.self._32,Us=Xs.self._33,Js=Ys.self._00,Qs=Ys.self._10,qs=Ys.self._20,$s=Ys.self._30;Xs.self._00=Ns*Js+Ls*Qs+Gs*qs+Ws*$s,Xs.self._10=Ds*Js+Ts*Qs+Vs*qs+Ks*$s,Xs.self._20=js*Js+Rs*Qs+Hs*qs+Ps*$s,Xs.self._30=Fs*Js+Os*Qs+Es*qs+Us*$s,Js=Ys.self._01,Qs=Ys.self._11,qs=Ys.self._21,$s=Ys.self._31,Xs.self._01=Ns*Js+Ls*Qs+Gs*qs+Ws*$s,Xs.self._11=Ds*Js+Ts*Qs+Vs*qs+Ks*$s,Xs.self._21=js*Js+Rs*Qs+Hs*qs+Ps*$s,Xs.self._31=Fs*Js+Os*Qs+Es*qs+Us*$s,Js=Ys.self._02,Qs=Ys.self._12,qs=Ys.self._22,$s=Ys.self._32,Xs.self._02=Ns*Js+Ls*Qs+Gs*qs+Ws*$s,Xs.self._12=Ds*Js+Ts*Qs+Vs*qs+Ks*$s,Xs.self._22=js*Js+Rs*Qs+Hs*qs+Ps*$s,Xs.self._32=Fs*Js+Os*Qs+Es*qs+Us*$s,Js=Ys.self._03,Qs=Ys.self._13,qs=Ys.self._23,$s=Ys.self._33,Xs.self._03=Ns*Js+Ls*Qs+Gs*qs+Ws*$s,Xs.self._13=Ds*Js+Ts*Qs+Vs*qs+Ks*$s,Xs.self._23=js*Js+Rs*Qs+Hs*qs+Ps*$s,Xs.self._33=Fs*Js+Os*Qs+Es*qs+Us*$s,s=c_.helpMat}else"_lightViewMatrix"==n.link?null!=a&&(s=a.V):"_lightProjectionMatrix"==n.link&&null!=a&&(s=a.P);if(null!=s)return t.setMatrix(i,s.self),!0}else if("vec4"==n.type){var tr=c_.helpVec;tr.x=0,tr.y=0,tr.z=0,tr.w=1}else if("vec3"==n.type){var er=null,ar=c_.helpVec;if(ar.x=0,ar.y=0,ar.z=0,ar.w=1,"_lightPosition"==n.link){if(null!=a){var ir=c_.helpVec;ir.x=a.transform.world.self._30,ir.y=a.transform.world.self._31,ir.z=a.transform.world.self._32,ir.w=1,er=c_.helpVec}}else if("_lightDirection"==n.link)null!=a&&(c_.helpVec=new lo(a.V.self._02,a.V.self._12,a.V.self._22),er=c_.helpVec);else if("_lightColor"==n.link){if(null!=a){var nr=a.data.raw.strength,sr=c_.helpVec,rr=a.data.raw.color[1]*nr,or=a.data.raw.color[2]*nr;sr.x=a.data.raw.color[0]*nr,sr.y=rr,sr.z=or,sr.w=1,er=c_.helpVec}}else if("_lightArea0"==n.link){if(null!=a&&null!=a.data.raw.size){var lr=.5*a.data.raw.size,_r=.5*a.data.raw.size_y,hr=c_.helpVec;hr.x=-lr,hr.y=_r,hr.z=0,hr.w=1;var fr=c_.helpVec,ur=a.transform.world,cr=fr.x,dr=fr.y,gr=fr.z;fr.x=ur.self._00*cr+ur.self._10*dr+ur.self._20*gr+ur.self._30,fr.y=ur.self._01*cr+ur.self._11*dr+ur.self._21*gr+ur.self._31,fr.z=ur.self._02*cr+ur.self._12*dr+ur.self._22*gr+ur.self._32,er=c_.helpVec}}else if("_lightArea1"==n.link){if(null!=a&&null!=a.data.raw.size){var pr=.5*a.data.raw.size,mr=.5*a.data.raw.size_y,vr=c_.helpVec;vr.x=pr,vr.y=mr,vr.z=0,vr.w=1;var br=c_.helpVec,Ir=a.transform.world,Mr=br.x,yr=br.y,wr=br.z;br.x=Ir.self._00*Mr+Ir.self._10*yr+Ir.self._20*wr+Ir.self._30,br.y=Ir.self._01*Mr+Ir.self._11*yr+Ir.self._21*wr+Ir.self._31,br.z=Ir.self._02*Mr+Ir.self._12*yr+Ir.self._22*wr+Ir.self._32,er=c_.helpVec}}else if("_lightArea2"==n.link){if(null!=a&&null!=a.data.raw.size){var xr=.5*a.data.raw.size,Cr=.5*a.data.raw.size_y,Ar=c_.helpVec;Ar.x=xr,Ar.y=-Cr,Ar.z=0,Ar.w=1;var Zr=c_.helpVec,zr=a.transform.world,Br=Zr.x,kr=Zr.y,Sr=Zr.z;Zr.x=zr.self._00*Br+zr.self._10*kr+zr.self._20*Sr+zr.self._30,Zr.y=zr.self._01*Br+zr.self._11*kr+zr.self._21*Sr+zr.self._31,Zr.z=zr.self._02*Br+zr.self._12*kr+zr.self._22*Sr+zr.self._32,er=c_.helpVec}}else if("_lightArea3"==n.link){if(null!=a&&null!=a.data.raw.size){var Xr=.5*a.data.raw.size,Yr=.5*a.data.raw.size_y,Nr=c_.helpVec;Nr.x=-Xr,Nr.y=-Yr,Nr.z=0,Nr.w=1;var Lr=c_.helpVec,Gr=a.transform.world,Wr=Lr.x,Dr=Lr.y,Tr=Lr.z;Lr.x=Gr.self._00*Wr+Gr.self._10*Dr+Gr.self._20*Tr+Gr.self._30,Lr.y=Gr.self._01*Wr+Gr.self._11*Dr+Gr.self._21*Tr+Gr.self._31,Lr.z=Gr.self._02*Wr+Gr.self._12*Dr+Gr.self._22*Tr+Gr.self._32,er=c_.helpVec}}else if("_cameraPosition"==n.link){var Vr=c_.helpVec;Vr.x=e.transform.world.self._30,Vr.y=e.transform.world.self._31,Vr.z=e.transform.world.self._32,Vr.w=1,er=c_.helpVec}else if("_cameraLook"==n.link)c_.helpVec=new lo(-e.transform.world.self._20,-e.transform.world.self._21,-e.transform.world.self._22),er=c_.helpVec;else if("_cameraUp"==n.link)c_.helpVec=new lo(e.transform.world.self._10,e.transform.world.self._11,e.transform.world.self._12),er=c_.helpVec;else if("_cameraRight"==n.link)c_.helpVec=new lo(e.transform.world.self._00,e.transform.world.self._01,e.transform.world.self._02),er=c_.helpVec;else if("_backgroundCol"==n.link){if(null!=e.data.raw.clear_color){var Kr=c_.helpVec,jr=e.data.raw.clear_color[1],Rr=e.data.raw.clear_color[2];Kr.x=e.data.raw.clear_color[0],Kr.y=jr,Kr.z=Rr,Kr.w=1}er=c_.helpVec}else if("_sunDirection"==n.link){var Hr=h_.active.world;if(null!=Hr){var Pr=c_.helpVec,Fr=Hr.raw.sun_direction[1],Or=Hr.raw.sun_direction[2];Pr.x=Hr.raw.sun_direction[0],Pr.y=Fr,Pr.z=Or,Pr.w=1,er=c_.helpVec}}if(null!=er)return t.setFloat3(i,er.x,er.y,er.z),!0}else if("vec2"==n.type){var Er=null,Ur=c_.helpVec;if(Ur.x=0,Ur.y=0,Ur.z=0,Ur.w=1,"_vec2x"==n.link)(Er=c_.helpVec).x=1,Er.y=0;else if("_vec2xInv"==n.link)(Er=c_.helpVec).x=1/_o.active.currentW,Er.y=0;else if("_vec2x2"==n.link)(Er=c_.helpVec).x=2,Er.y=0;else if("_vec2x2Inv"==n.link)(Er=c_.helpVec).x=2/_o.active.currentW,Er.y=0;else if("_vec2y"==n.link)(Er=c_.helpVec).x=0,Er.y=1;else if("_vec2yInv"==n.link)(Er=c_.helpVec).x=0,Er.y=1/_o.active.currentH;else if("_vec2y2"==n.link)(Er=c_.helpVec).x=0,Er.y=2;else if("_vec2y2Inv"==n.link)(Er=c_.helpVec).x=0,Er.y=2/_o.active.currentH;else if("_vec2y3"==n.link)(Er=c_.helpVec).x=0,Er.y=3;else if("_vec2y3Inv"==n.link)(Er=c_.helpVec).x=0,Er.y=3/_o.active.currentH;else if("_windowSize"==n.link)(Er=c_.helpVec).x=co.windowWidth(),Er.y=co.windowHeight();else if("_windowSizeInv"==n.link)(Er=c_.helpVec).x=1/co.windowWidth(),Er.y=1/co.windowHeight();else if("_screenSize"==n.link)(Er=c_.helpVec).x=_o.active.currentW,Er.y=_o.active.currentH;else if("_screenSizeInv"==n.link)(Er=c_.helpVec).x=1/_o.active.currentW,Er.y=1/_o.active.currentH;else if("_aspectRatio"==n.link)(Er=c_.helpVec).x=_o.active.currentH/_o.active.currentW,Er.y=_o.active.currentW/_o.active.currentH,Er.x=1<Er.x?1:Er.x,Er.y=1<Er.y?1:Er.y;else if("_cameraPlane"==n.link)(Er=c_.helpVec).x=e.data.raw.near_plane,Er.y=e.data.raw.far_plane;else if("_cameraPlaneProj"==n.link){var Jr=e.data.raw.near_plane,Qr=e.data.raw.far_plane;(Er=c_.helpVec).x=Qr/(Qr-Jr),Er.y=-Qr*Jr/(Qr-Jr)}else if("_lightPlane"==n.link)null!=a&&((Er=c_.helpVec).x=a.data.raw.near_plane,Er.y=a.data.raw.far_plane);else if("_lightPlaneProj"==n.link){if(null!=a){var qr=a.data.raw.near_plane,$r=a.data.raw.far_plane,to=$r+qr,eo=$r-qr,ao=2*$r*qr;(Er=c_.helpVec).x=to/eo,Er.y=ao/eo}}else"_spotlightData"==n.link&&null!=a&&((Er=c_.helpVec).x=a.data.raw.spot_size,Er.y=Er.x-a.data.raw.spot_blend);if(null!=Er)return t.setFloat2(i,Er.x,Er.y),!0}else if("float"==n.type){var io=null;if("_time"==n.link?io=uo.time():"_deltaTime"==n.link?io=.016666666666666666*fo.scale:"_lightRadius"==n.link?io=null==a?0:a.data.raw.far_plane:"_lightShadowsBias"==n.link?io=null==a?0:a.data.raw.shadows_bias:"_lightSize"==n.link?null!=a&&null!=a.data.raw.light_size&&(io=a.data.raw.light_size):"_envmapStrength"==n.link?io=null==h_.active.world?0:h_.active.world.getGlobalProbe().raw.strength:"_aspectRatioF"==n.link?io=_o.active.currentW/_o.active.currentH:"_aspectRatioWindowF"==n.link?io=co.windowWidth()/co.windowHeight():"_frameScale"==n.link&&(io=_o.active.frameTime/(.016666666666666666*fo.scale)),null!=io)return t.setFloat(i,io),!0}else if("floats"==n.type){var no=null;if("_envmapIrradiance"==n.link&&(no=null==h_.active.world?ho.getEmptyIrradiance():h_.active.world.getSHIrradiance()),null!=no)return t.setFloats(i,no),!0}else if("int"==n.type){var so=null;if("_lightType"==n.link)if(null==a)so=0;else{var ro;switch(a.data.raw.type){case"area":ro=3;break;case"point":ro=1;break;case"spot":ro=2;break;case"sun":ro=0;break;default:ro=0}so=ro}else if("_lightIndex"==n.link)so=_o.active.currentLightIndex;else if("_lightCastShadow"==n.link)so=null!=a&&a.data.raw.cast_shadow?a.data.raw.shadowmap_cube?2:1:0;else if("_envmapNumMipmaps"==n.link){var oo=h_.active.world;so=null!=oo?oo.getGlobalProbe().raw.radiance_mipmaps+1-2:1}if(null!=so)return t.setInt(i,so),!0}return!1},c_.setObjectConstant=function(t,e,a,i,n,s){if(null!=s.link)if("mat4"==s.type){var r=null;if("_worldMatrix"==s.link)r=e.transform.world;else if("_inverseWorldMatrix"==s.link){var o=c_.helpMat,l=e.transform.world,_=l.self._00,h=l.self._01,f=l.self._02,u=l.self._03,c=l.self._10,d=l.self._11,g=l.self._12,p=l.self._13,m=l.self._20,v=l.self._21,b=l.self._22,I=l.self._23,M=l.self._30,y=l.self._31,w=l.self._32,x=l.self._33,C=_*d-h*c,A=_*g-f*c,Z=_*p-u*c,z=h*g-f*d,B=h*p-u*d,k=f*p-u*g,S=m*y-v*M,X=m*w-b*M,Y=m*x-I*M,N=v*w-b*y,L=v*x-I*y,G=b*x-I*w,W=C*G-A*L+Z*N+z*Y-B*X+k*S;0==W?(o.self._00=1,o.self._01=0,o.self._02=0,o.self._03=0,o.self._10=0,o.self._11=1,o.self._12=0,o.self._13=0,o.self._20=0,o.self._21=0,o.self._22=1,o.self._23=0,o.self._30=0,o.self._31=0,o.self._32=0,o.self._33=1):(W=1/W,o.self._00=(d*G-g*L+p*N)*W,o.self._01=(f*L-h*G-u*N)*W,o.self._02=(y*k-w*B+x*z)*W,o.self._03=(b*B-v*k-I*z)*W,o.self._10=(g*Y-c*G-p*X)*W,o.self._11=(_*G-f*Y+u*X)*W,o.self._12=(w*Z-M*k-x*A)*W,o.self._13=(m*k-b*Z+I*A)*W,o.self._20=(c*L-d*Y+p*S)*W,o.self._21=(h*Y-_*L-u*S)*W,o.self._22=(M*B-y*Z+x*C)*W,o.self._23=(v*Z-m*B-I*C)*W,o.self._30=(d*X-c*N-g*S)*W,o.self._31=(_*N-h*X+f*S)*W,o.self._32=(y*A-M*z-w*C)*W,o.self._33=(m*z-v*A+b*C)*W),r=c_.helpMat}else if("_worldViewProjectionMatrix"==s.link){var D=c_.helpMat,T=e.transform.world;D.self._00=T.self._00,D.self._01=T.self._01,D.self._02=T.self._02,D.self._03=T.self._03,D.self._10=T.self._10,D.self._11=T.self._11,D.self._12=T.self._12,D.self._13=T.self._13,D.self._20=T.self._20,D.self._21=T.self._21,D.self._22=T.self._22,D.self._23=T.self._23,D.self._30=T.self._30,D.self._31=T.self._31,D.self._32=T.self._32,D.self._33=T.self._33;var V=c_.helpMat,K=a.V,j=V.self._00,R=V.self._01,H=V.self._02,P=V.self._03,F=V.self._10,O=V.self._11,E=V.self._12,U=V.self._13,J=V.self._20,Q=V.self._21,q=V.self._22,$=V.self._23,tt=V.self._30,et=V.self._31,at=V.self._32,it=V.self._33,nt=K.self._00,st=K.self._10,rt=K.self._20,ot=K.self._30;V.self._00=j*nt+R*st+H*rt+P*ot,V.self._10=F*nt+O*st+E*rt+U*ot,V.self._20=J*nt+Q*st+q*rt+$*ot,V.self._30=tt*nt+et*st+at*rt+it*ot,nt=K.self._01,st=K.self._11,rt=K.self._21,ot=K.self._31,V.self._01=j*nt+R*st+H*rt+P*ot,V.self._11=F*nt+O*st+E*rt+U*ot,V.self._21=J*nt+Q*st+q*rt+$*ot,V.self._31=tt*nt+et*st+at*rt+it*ot,nt=K.self._02,st=K.self._12,rt=K.self._22,ot=K.self._32,V.self._02=j*nt+R*st+H*rt+P*ot,V.self._12=F*nt+O*st+E*rt+U*ot,V.self._22=J*nt+Q*st+q*rt+$*ot,V.self._32=tt*nt+et*st+at*rt+it*ot,nt=K.self._03,st=K.self._13,rt=K.self._23,ot=K.self._33,V.self._03=j*nt+R*st+H*rt+P*ot,V.self._13=F*nt+O*st+E*rt+U*ot,V.self._23=J*nt+Q*st+q*rt+$*ot,V.self._33=tt*nt+et*st+at*rt+it*ot;var lt=c_.helpMat,_t=a.P,ht=lt.self._00,ft=lt.self._01,ut=lt.self._02,ct=lt.self._03,dt=lt.self._10,gt=lt.self._11,pt=lt.self._12,mt=lt.self._13,vt=lt.self._20,bt=lt.self._21,It=lt.self._22,Mt=lt.self._23,yt=lt.self._30,wt=lt.self._31,xt=lt.self._32,Ct=lt.self._33,At=_t.self._00,Zt=_t.self._10,zt=_t.self._20,Bt=_t.self._30;lt.self._00=ht*At+ft*Zt+ut*zt+ct*Bt,lt.self._10=dt*At+gt*Zt+pt*zt+mt*Bt,lt.self._20=vt*At+bt*Zt+It*zt+Mt*Bt,lt.self._30=yt*At+wt*Zt+xt*zt+Ct*Bt,At=_t.self._01,Zt=_t.self._11,zt=_t.self._21,Bt=_t.self._31,lt.self._01=ht*At+ft*Zt+ut*zt+ct*Bt,lt.self._11=dt*At+gt*Zt+pt*zt+mt*Bt,lt.self._21=vt*At+bt*Zt+It*zt+Mt*Bt,lt.self._31=yt*At+wt*Zt+xt*zt+Ct*Bt,At=_t.self._02,Zt=_t.self._12,zt=_t.self._22,Bt=_t.self._32,lt.self._02=ht*At+ft*Zt+ut*zt+ct*Bt,lt.self._12=dt*At+gt*Zt+pt*zt+mt*Bt,lt.self._22=vt*At+bt*Zt+It*zt+Mt*Bt,lt.self._32=yt*At+wt*Zt+xt*zt+Ct*Bt,At=_t.self._03,Zt=_t.self._13,zt=_t.self._23,Bt=_t.self._33,lt.self._03=ht*At+ft*Zt+ut*zt+ct*Bt,lt.self._13=dt*At+gt*Zt+pt*zt+mt*Bt,lt.self._23=vt*At+bt*Zt+It*zt+Mt*Bt,lt.self._33=yt*At+wt*Zt+xt*zt+Ct*Bt,r=c_.helpMat}else if("_worldViewProjectionMatrixSphere"==s.link){var kt=c_.helpMat,St=e.transform.world;kt.self._00=St.self._00,kt.self._01=St.self._01,kt.self._02=St.self._02,kt.self._03=St.self._03,kt.self._10=St.self._10,kt.self._11=St.self._11,kt.self._12=St.self._12,kt.self._13=St.self._13,kt.self._20=St.self._20,kt.self._21=St.self._21,kt.self._22=St.self._22,kt.self._23=St.self._23,kt.self._30=St.self._30,kt.self._31=St.self._31,kt.self._32=St.self._32,kt.self._33=St.self._33;var Xt=c_.helpMat,Yt=a.V,Nt=Xt.self._00,Lt=Xt.self._01,Gt=Xt.self._02,Wt=Xt.self._03,Dt=Xt.self._10,Tt=Xt.self._11,Vt=Xt.self._12,Kt=Xt.self._13,jt=Xt.self._20,Rt=Xt.self._21,Ht=Xt.self._22,Pt=Xt.self._23,Ft=Xt.self._30,Ot=Xt.self._31,Et=Xt.self._32,Ut=Xt.self._33,Jt=Yt.self._00,Qt=Yt.self._10,qt=Yt.self._20,$t=Yt.self._30;Xt.self._00=Nt*Jt+Lt*Qt+Gt*qt+Wt*$t,Xt.self._10=Dt*Jt+Tt*Qt+Vt*qt+Kt*$t,Xt.self._20=jt*Jt+Rt*Qt+Ht*qt+Pt*$t,Xt.self._30=Ft*Jt+Ot*Qt+Et*qt+Ut*$t,Jt=Yt.self._01,Qt=Yt.self._11,qt=Yt.self._21,$t=Yt.self._31,Xt.self._01=Nt*Jt+Lt*Qt+Gt*qt+Wt*$t,Xt.self._11=Dt*Jt+Tt*Qt+Vt*qt+Kt*$t,Xt.self._21=jt*Jt+Rt*Qt+Ht*qt+Pt*$t,Xt.self._31=Ft*Jt+Ot*Qt+Et*qt+Ut*$t,Jt=Yt.self._02,Qt=Yt.self._12,qt=Yt.self._22,$t=Yt.self._32,Xt.self._02=Nt*Jt+Lt*Qt+Gt*qt+Wt*$t,Xt.self._12=Dt*Jt+Tt*Qt+Vt*qt+Kt*$t,Xt.self._22=jt*Jt+Rt*Qt+Ht*qt+Pt*$t,Xt.self._32=Ft*Jt+Ot*Qt+Et*qt+Ut*$t,Jt=Yt.self._03,Qt=Yt.self._13,qt=Yt.self._23,$t=Yt.self._33,Xt.self._03=Nt*Jt+Lt*Qt+Gt*qt+Wt*$t,Xt.self._13=Dt*Jt+Tt*Qt+Vt*qt+Kt*$t,Xt.self._23=jt*Jt+Rt*Qt+Ht*qt+Pt*$t,Xt.self._33=Ft*Jt+Ot*Qt+Et*qt+Ut*$t,c_.helpMat.self._00=1,c_.helpMat.self._10=0,c_.helpMat.self._20=0,c_.helpMat.self._01=0,c_.helpMat.self._11=1,c_.helpMat.self._21=0,c_.helpMat.self._02=0,c_.helpMat.self._12=0,c_.helpMat.self._22=1;var te=c_.helpMat,ee=a.P,ae=te.self._00,ie=te.self._01,ne=te.self._02,se=te.self._03,re=te.self._10,oe=te.self._11,le=te.self._12,_e=te.self._13,he=te.self._20,fe=te.self._21,ue=te.self._22,ce=te.self._23,de=te.self._30,ge=te.self._31,pe=te.self._32,me=te.self._33,ve=ee.self._00,be=ee.self._10,Ie=ee.self._20,Me=ee.self._30;te.self._00=ae*ve+ie*be+ne*Ie+se*Me,te.self._10=re*ve+oe*be+le*Ie+_e*Me,te.self._20=he*ve+fe*be+ue*Ie+ce*Me,te.self._30=de*ve+ge*be+pe*Ie+me*Me,ve=ee.self._01,be=ee.self._11,Ie=ee.self._21,Me=ee.self._31,te.self._01=ae*ve+ie*be+ne*Ie+se*Me,te.self._11=re*ve+oe*be+le*Ie+_e*Me,te.self._21=he*ve+fe*be+ue*Ie+ce*Me,te.self._31=de*ve+ge*be+pe*Ie+me*Me,ve=ee.self._02,be=ee.self._12,Ie=ee.self._22,Me=ee.self._32,te.self._02=ae*ve+ie*be+ne*Ie+se*Me,te.self._12=re*ve+oe*be+le*Ie+_e*Me,te.self._22=he*ve+fe*be+ue*Ie+ce*Me,te.self._32=de*ve+ge*be+pe*Ie+me*Me,ve=ee.self._03,be=ee.self._13,Ie=ee.self._23,Me=ee.self._33,te.self._03=ae*ve+ie*be+ne*Ie+se*Me,te.self._13=re*ve+oe*be+le*Ie+_e*Me,te.self._23=he*ve+fe*be+ue*Ie+ce*Me,te.self._33=de*ve+ge*be+pe*Ie+me*Me,r=c_.helpMat}else if("_worldViewProjectionMatrixCylinder"==s.link){var ye=c_.helpMat,we=e.transform.world;ye.self._00=we.self._00,ye.self._01=we.self._01,ye.self._02=we.self._02,ye.self._03=we.self._03,ye.self._10=we.self._10,ye.self._11=we.self._11,ye.self._12=we.self._12,ye.self._13=we.self._13,ye.self._20=we.self._20,ye.self._21=we.self._21,ye.self._22=we.self._22,ye.self._23=we.self._23,ye.self._30=we.self._30,ye.self._31=we.self._31,ye.self._32=we.self._32,ye.self._33=we.self._33;var xe=c_.helpMat,Ce=a.V,Ae=xe.self._00,Ze=xe.self._01,ze=xe.self._02,Be=xe.self._03,ke=xe.self._10,Se=xe.self._11,Xe=xe.self._12,Ye=xe.self._13,Ne=xe.self._20,Le=xe.self._21,Ge=xe.self._22,We=xe.self._23,De=xe.self._30,Te=xe.self._31,Ve=xe.self._32,Ke=xe.self._33,je=Ce.self._00,Re=Ce.self._10,He=Ce.self._20,Pe=Ce.self._30;xe.self._00=Ae*je+Ze*Re+ze*He+Be*Pe,xe.self._10=ke*je+Se*Re+Xe*He+Ye*Pe,xe.self._20=Ne*je+Le*Re+Ge*He+We*Pe,xe.self._30=De*je+Te*Re+Ve*He+Ke*Pe,je=Ce.self._01,Re=Ce.self._11,He=Ce.self._21,Pe=Ce.self._31,xe.self._01=Ae*je+Ze*Re+ze*He+Be*Pe,xe.self._11=ke*je+Se*Re+Xe*He+Ye*Pe,xe.self._21=Ne*je+Le*Re+Ge*He+We*Pe,xe.self._31=De*je+Te*Re+Ve*He+Ke*Pe,je=Ce.self._02,Re=Ce.self._12,He=Ce.self._22,Pe=Ce.self._32,xe.self._02=Ae*je+Ze*Re+ze*He+Be*Pe,xe.self._12=ke*je+Se*Re+Xe*He+Ye*Pe,xe.self._22=Ne*je+Le*Re+Ge*He+We*Pe,xe.self._32=De*je+Te*Re+Ve*He+Ke*Pe,je=Ce.self._03,Re=Ce.self._13,He=Ce.self._23,Pe=Ce.self._33,xe.self._03=Ae*je+Ze*Re+ze*He+Be*Pe,xe.self._13=ke*je+Se*Re+Xe*He+Ye*Pe,xe.self._23=Ne*je+Le*Re+Ge*He+We*Pe,xe.self._33=De*je+Te*Re+Ve*He+Ke*Pe,c_.helpMat.self._00=1,c_.helpMat.self._20=0,c_.helpMat.self._01=0,c_.helpMat.self._21=0,c_.helpMat.self._02=0,c_.helpMat.self._22=1;var Fe=c_.helpMat,Oe=a.P,Ee=Fe.self._00,Ue=Fe.self._01,Je=Fe.self._02,Qe=Fe.self._03,qe=Fe.self._10,$e=Fe.self._11,ta=Fe.self._12,ea=Fe.self._13,aa=Fe.self._20,ia=Fe.self._21,na=Fe.self._22,sa=Fe.self._23,ra=Fe.self._30,oa=Fe.self._31,la=Fe.self._32,_a=Fe.self._33,ha=Oe.self._00,fa=Oe.self._10,ua=Oe.self._20,ca=Oe.self._30;Fe.self._00=Ee*ha+Ue*fa+Je*ua+Qe*ca,Fe.self._10=qe*ha+$e*fa+ta*ua+ea*ca,Fe.self._20=aa*ha+ia*fa+na*ua+sa*ca,Fe.self._30=ra*ha+oa*fa+la*ua+_a*ca,ha=Oe.self._01,fa=Oe.self._11,ua=Oe.self._21,ca=Oe.self._31,Fe.self._01=Ee*ha+Ue*fa+Je*ua+Qe*ca,Fe.self._11=qe*ha+$e*fa+ta*ua+ea*ca,Fe.self._21=aa*ha+ia*fa+na*ua+sa*ca,Fe.self._31=ra*ha+oa*fa+la*ua+_a*ca,ha=Oe.self._02,fa=Oe.self._12,ua=Oe.self._22,ca=Oe.self._32,Fe.self._02=Ee*ha+Ue*fa+Je*ua+Qe*ca,Fe.self._12=qe*ha+$e*fa+ta*ua+ea*ca,Fe.self._22=aa*ha+ia*fa+na*ua+sa*ca,Fe.self._32=ra*ha+oa*fa+la*ua+_a*ca,ha=Oe.self._03,fa=Oe.self._13,ua=Oe.self._23,ca=Oe.self._33,Fe.self._03=Ee*ha+Ue*fa+Je*ua+Qe*ca,Fe.self._13=qe*ha+$e*fa+ta*ua+ea*ca,Fe.self._23=aa*ha+ia*fa+na*ua+sa*ca,Fe.self._33=ra*ha+oa*fa+la*ua+_a*ca,r=c_.helpMat}else if("_worldViewMatrix"==s.link){var da=c_.helpMat,ga=e.transform.world;da.self._00=ga.self._00,da.self._01=ga.self._01,da.self._02=ga.self._02,da.self._03=ga.self._03,da.self._10=ga.self._10,da.self._11=ga.self._11,da.self._12=ga.self._12,da.self._13=ga.self._13,da.self._20=ga.self._20,da.self._21=ga.self._21,da.self._22=ga.self._22,da.self._23=ga.self._23,da.self._30=ga.self._30,da.self._31=ga.self._31,da.self._32=ga.self._32,da.self._33=ga.self._33;var pa=c_.helpMat,ma=a.V,va=pa.self._00,ba=pa.self._01,Ia=pa.self._02,Ma=pa.self._03,ya=pa.self._10,wa=pa.self._11,xa=pa.self._12,Ca=pa.self._13,Aa=pa.self._20,Za=pa.self._21,za=pa.self._22,Ba=pa.self._23,ka=pa.self._30,Sa=pa.self._31,Xa=pa.self._32,Ya=pa.self._33,Na=ma.self._00,La=ma.self._10,Ga=ma.self._20,Wa=ma.self._30;pa.self._00=va*Na+ba*La+Ia*Ga+Ma*Wa,pa.self._10=ya*Na+wa*La+xa*Ga+Ca*Wa,pa.self._20=Aa*Na+Za*La+za*Ga+Ba*Wa,pa.self._30=ka*Na+Sa*La+Xa*Ga+Ya*Wa,Na=ma.self._01,La=ma.self._11,Ga=ma.self._21,Wa=ma.self._31,pa.self._01=va*Na+ba*La+Ia*Ga+Ma*Wa,pa.self._11=ya*Na+wa*La+xa*Ga+Ca*Wa,pa.self._21=Aa*Na+Za*La+za*Ga+Ba*Wa,pa.self._31=ka*Na+Sa*La+Xa*Ga+Ya*Wa,Na=ma.self._02,La=ma.self._12,Ga=ma.self._22,Wa=ma.self._32,pa.self._02=va*Na+ba*La+Ia*Ga+Ma*Wa,pa.self._12=ya*Na+wa*La+xa*Ga+Ca*Wa,pa.self._22=Aa*Na+Za*La+za*Ga+Ba*Wa,pa.self._32=ka*Na+Sa*La+Xa*Ga+Ya*Wa,Na=ma.self._03,La=ma.self._13,Ga=ma.self._23,Wa=ma.self._33,pa.self._03=va*Na+ba*La+Ia*Ga+Ma*Wa,pa.self._13=ya*Na+wa*La+xa*Ga+Ca*Wa,pa.self._23=Aa*Na+Za*La+za*Ga+Ba*Wa,pa.self._33=ka*Na+Sa*La+Xa*Ga+Ya*Wa,r=c_.helpMat}else if("_lightWorldViewProjectionMatrix"==s.link){if(null!=i){if(null==e){var Da=c_.helpMat;Da.self._00=1,Da.self._01=0,Da.self._02=0,Da.self._03=0,Da.self._10=0,Da.self._11=1,Da.self._12=0,Da.self._13=0,Da.self._20=0,Da.self._21=0,Da.self._22=1,Da.self._23=0,Da.self._30=0,Da.self._31=0,Da.self._32=0,Da.self._33=1}else{var Ta=c_.helpMat,Va=e.transform.world;Ta.self._00=Va.self._00,Ta.self._01=Va.self._01,Ta.self._02=Va.self._02,Ta.self._03=Va.self._03,Ta.self._10=Va.self._10,Ta.self._11=Va.self._11,Ta.self._12=Va.self._12,Ta.self._13=Va.self._13,Ta.self._20=Va.self._20,Ta.self._21=Va.self._21,Ta.self._22=Va.self._22,Ta.self._23=Va.self._23,Ta.self._30=Va.self._30,Ta.self._31=Va.self._31,Ta.self._32=Va.self._32,Ta.self._33=Va.self._33}var Ka=c_.helpMat,ja=i.VP,Ra=Ka.self._00,Ha=Ka.self._01,Pa=Ka.self._02,Fa=Ka.self._03,Oa=Ka.self._10,Ea=Ka.self._11,Ua=Ka.self._12,Ja=Ka.self._13,Qa=Ka.self._20,qa=Ka.self._21,$a=Ka.self._22,ti=Ka.self._23,ei=Ka.self._30,ai=Ka.self._31,ii=Ka.self._32,ni=Ka.self._33,si=ja.self._00,ri=ja.self._10,oi=ja.self._20,li=ja.self._30;Ka.self._00=Ra*si+Ha*ri+Pa*oi+Fa*li,Ka.self._10=Oa*si+Ea*ri+Ua*oi+Ja*li,Ka.self._20=Qa*si+qa*ri+$a*oi+ti*li,Ka.self._30=ei*si+ai*ri+ii*oi+ni*li,si=ja.self._01,ri=ja.self._11,oi=ja.self._21,li=ja.self._31,Ka.self._01=Ra*si+Ha*ri+Pa*oi+Fa*li,Ka.self._11=Oa*si+Ea*ri+Ua*oi+Ja*li,Ka.self._21=Qa*si+qa*ri+$a*oi+ti*li,Ka.self._31=ei*si+ai*ri+ii*oi+ni*li,si=ja.self._02,ri=ja.self._12,oi=ja.self._22,li=ja.self._32,Ka.self._02=Ra*si+Ha*ri+Pa*oi+Fa*li,Ka.self._12=Oa*si+Ea*ri+Ua*oi+Ja*li,Ka.self._22=Qa*si+qa*ri+$a*oi+ti*li,Ka.self._32=ei*si+ai*ri+ii*oi+ni*li,si=ja.self._03,ri=ja.self._13,oi=ja.self._23,li=ja.self._33,Ka.self._03=Ra*si+Ha*ri+Pa*oi+Fa*li,Ka.self._13=Oa*si+Ea*ri+Ua*oi+Ja*li,Ka.self._23=Qa*si+qa*ri+$a*oi+ti*li,Ka.self._33=ei*si+ai*ri+ii*oi+ni*li,r=c_.helpMat}}else if("_lightWorldViewProjectionMatrixSphere"==s.link){if(null!=i){var _i=c_.helpMat,hi=e.transform.world;_i.self._00=hi.self._00,_i.self._01=hi.self._01,_i.self._02=hi.self._02,_i.self._03=hi.self._03,_i.self._10=hi.self._10,_i.self._11=hi.self._11,_i.self._12=hi.self._12,_i.self._13=hi.self._13,_i.self._20=hi.self._20,_i.self._21=hi.self._21,_i.self._22=hi.self._22,_i.self._23=hi.self._23,_i.self._30=hi.self._30,_i.self._31=hi.self._31,_i.self._32=hi.self._32,_i.self._33=hi.self._33;var fi=c_.helpMat,ui=a.V,ci=fi.self._00,di=fi.self._01,gi=fi.self._02,pi=fi.self._03,mi=fi.self._10,vi=fi.self._11,bi=fi.self._12,Ii=fi.self._13,Mi=fi.self._20,yi=fi.self._21,wi=fi.self._22,xi=fi.self._23,Ci=fi.self._30,Ai=fi.self._31,Zi=fi.self._32,zi=fi.self._33,Bi=ui.self._00,ki=ui.self._10,Si=ui.self._20,Xi=ui.self._30;fi.self._00=ci*Bi+di*ki+gi*Si+pi*Xi,fi.self._10=mi*Bi+vi*ki+bi*Si+Ii*Xi,fi.self._20=Mi*Bi+yi*ki+wi*Si+xi*Xi,fi.self._30=Ci*Bi+Ai*ki+Zi*Si+zi*Xi,Bi=ui.self._01,ki=ui.self._11,Si=ui.self._21,Xi=ui.self._31,fi.self._01=ci*Bi+di*ki+gi*Si+pi*Xi,fi.self._11=mi*Bi+vi*ki+bi*Si+Ii*Xi,fi.self._21=Mi*Bi+yi*ki+wi*Si+xi*Xi,fi.self._31=Ci*Bi+Ai*ki+Zi*Si+zi*Xi,Bi=ui.self._02,ki=ui.self._12,Si=ui.self._22,Xi=ui.self._32,fi.self._02=ci*Bi+di*ki+gi*Si+pi*Xi,fi.self._12=mi*Bi+vi*ki+bi*Si+Ii*Xi,fi.self._22=Mi*Bi+yi*ki+wi*Si+xi*Xi,fi.self._32=Ci*Bi+Ai*ki+Zi*Si+zi*Xi,Bi=ui.self._03,ki=ui.self._13,Si=ui.self._23,Xi=ui.self._33,fi.self._03=ci*Bi+di*ki+gi*Si+pi*Xi,fi.self._13=mi*Bi+vi*ki+bi*Si+Ii*Xi,fi.self._23=Mi*Bi+yi*ki+wi*Si+xi*Xi,fi.self._33=Ci*Bi+Ai*ki+Zi*Si+zi*Xi,c_.helpMat.self._00=1,c_.helpMat.self._10=0,c_.helpMat.self._20=0,c_.helpMat.self._01=0,c_.helpMat.self._11=1,c_.helpMat.self._21=0,c_.helpMat.self._02=0,c_.helpMat.self._12=0,c_.helpMat.self._22=1;var Yi=c_.helpMat2,Ni=a.V,Li=Ni.self._00,Gi=Ni.self._01,Wi=Ni.self._02,Di=Ni.self._03,Ti=Ni.self._10,Vi=Ni.self._11,Ki=Ni.self._12,ji=Ni.self._13,Ri=Ni.self._20,Hi=Ni.self._21,Pi=Ni.self._22,Fi=Ni.self._23,Oi=Ni.self._30,Ei=Ni.self._31,Ui=Ni.self._32,Ji=Ni.self._33,Qi=Li*Vi-Gi*Ti,qi=Li*Ki-Wi*Ti,$i=Li*ji-Di*Ti,tn=Gi*Ki-Wi*Vi,en=Gi*ji-Di*Vi,an=Wi*ji-Di*Ki,nn=Ri*Ei-Hi*Oi,sn=Ri*Ui-Pi*Oi,rn=Ri*Ji-Fi*Oi,on=Hi*Ui-Pi*Ei,ln=Hi*Ji-Fi*Ei,_n=Pi*Ji-Fi*Ui,hn=Qi*_n-qi*ln+$i*on+tn*rn-en*sn+an*nn;0==hn?(Yi.self._00=1,Yi.self._01=0,Yi.self._02=0,Yi.self._03=0,Yi.self._10=0,Yi.self._11=1,Yi.self._12=0,Yi.self._13=0,Yi.self._20=0,Yi.self._21=0,Yi.self._22=1,Yi.self._23=0,Yi.self._30=0,Yi.self._31=0,Yi.self._32=0,Yi.self._33=1):(hn=1/hn,Yi.self._00=(Vi*_n-Ki*ln+ji*on)*hn,Yi.self._01=(Wi*ln-Gi*_n-Di*on)*hn,Yi.self._02=(Ei*an-Ui*en+Ji*tn)*hn,Yi.self._03=(Pi*en-Hi*an-Fi*tn)*hn,Yi.self._10=(Ki*rn-Ti*_n-ji*sn)*hn,Yi.self._11=(Li*_n-Wi*rn+Di*sn)*hn,Yi.self._12=(Ui*$i-Oi*an-Ji*qi)*hn,Yi.self._13=(Ri*an-Pi*$i+Fi*qi)*hn,Yi.self._20=(Ti*ln-Vi*rn+ji*nn)*hn,Yi.self._21=(Gi*rn-Li*ln-Di*nn)*hn,Yi.self._22=(Oi*en-Ei*$i+Ji*Qi)*hn,Yi.self._23=(Hi*$i-Ri*en-Fi*Qi)*hn,Yi.self._30=(Vi*sn-Ti*on-Ki*nn)*hn,Yi.self._31=(Li*on-Gi*sn+Wi*nn)*hn,Yi.self._32=(Ei*qi-Oi*tn-Ui*Qi)*hn,Yi.self._33=(Ri*tn-Hi*qi+Pi*Qi)*hn);var fn=c_.helpMat,un=c_.helpMat2,cn=fn.self._00,dn=fn.self._01,gn=fn.self._02,pn=fn.self._03,mn=fn.self._10,vn=fn.self._11,bn=fn.self._12,In=fn.self._13,Mn=fn.self._20,yn=fn.self._21,wn=fn.self._22,xn=fn.self._23,Cn=fn.self._30,An=fn.self._31,Zn=fn.self._32,zn=fn.self._33,Bn=un.self._00,kn=un.self._10,Sn=un.self._20,Xn=un.self._30;fn.self._00=cn*Bn+dn*kn+gn*Sn+pn*Xn,fn.self._10=mn*Bn+vn*kn+bn*Sn+In*Xn,fn.self._20=Mn*Bn+yn*kn+wn*Sn+xn*Xn,fn.self._30=Cn*Bn+An*kn+Zn*Sn+zn*Xn,Bn=un.self._01,kn=un.self._11,Sn=un.self._21,Xn=un.self._31,fn.self._01=cn*Bn+dn*kn+gn*Sn+pn*Xn,fn.self._11=mn*Bn+vn*kn+bn*Sn+In*Xn,fn.self._21=Mn*Bn+yn*kn+wn*Sn+xn*Xn,fn.self._31=Cn*Bn+An*kn+Zn*Sn+zn*Xn,Bn=un.self._02,kn=un.self._12,Sn=un.self._22,Xn=un.self._32,fn.self._02=cn*Bn+dn*kn+gn*Sn+pn*Xn,fn.self._12=mn*Bn+vn*kn+bn*Sn+In*Xn,fn.self._22=Mn*Bn+yn*kn+wn*Sn+xn*Xn,fn.self._32=Cn*Bn+An*kn+Zn*Sn+zn*Xn,Bn=un.self._03,kn=un.self._13,Sn=un.self._23,Xn=un.self._33,fn.self._03=cn*Bn+dn*kn+gn*Sn+pn*Xn,fn.self._13=mn*Bn+vn*kn+bn*Sn+In*Xn,fn.self._23=Mn*Bn+yn*kn+wn*Sn+xn*Xn,fn.self._33=Cn*Bn+An*kn+Zn*Sn+zn*Xn;var Yn=c_.helpMat,Nn=i.VP,Ln=Yn.self._00,Gn=Yn.self._01,Wn=Yn.self._02,Dn=Yn.self._03,Tn=Yn.self._10,Vn=Yn.self._11,Kn=Yn.self._12,jn=Yn.self._13,Rn=Yn.self._20,Hn=Yn.self._21,Pn=Yn.self._22,Fn=Yn.self._23,On=Yn.self._30,En=Yn.self._31,Un=Yn.self._32,Jn=Yn.self._33,Qn=Nn.self._00,qn=Nn.self._10,$n=Nn.self._20,ts=Nn.self._30;Yn.self._00=Ln*Qn+Gn*qn+Wn*$n+Dn*ts,Yn.self._10=Tn*Qn+Vn*qn+Kn*$n+jn*ts,Yn.self._20=Rn*Qn+Hn*qn+Pn*$n+Fn*ts,Yn.self._30=On*Qn+En*qn+Un*$n+Jn*ts,Qn=Nn.self._01,qn=Nn.self._11,$n=Nn.self._21,ts=Nn.self._31,Yn.self._01=Ln*Qn+Gn*qn+Wn*$n+Dn*ts,Yn.self._11=Tn*Qn+Vn*qn+Kn*$n+jn*ts,Yn.self._21=Rn*Qn+Hn*qn+Pn*$n+Fn*ts,Yn.self._31=On*Qn+En*qn+Un*$n+Jn*ts,Qn=Nn.self._02,qn=Nn.self._12,$n=Nn.self._22,ts=Nn.self._32,Yn.self._02=Ln*Qn+Gn*qn+Wn*$n+Dn*ts,Yn.self._12=Tn*Qn+Vn*qn+Kn*$n+jn*ts,Yn.self._22=Rn*Qn+Hn*qn+Pn*$n+Fn*ts,Yn.self._32=On*Qn+En*qn+Un*$n+Jn*ts,Qn=Nn.self._03,qn=Nn.self._13,$n=Nn.self._23,ts=Nn.self._33,Yn.self._03=Ln*Qn+Gn*qn+Wn*$n+Dn*ts,Yn.self._13=Tn*Qn+Vn*qn+Kn*$n+jn*ts,Yn.self._23=Rn*Qn+Hn*qn+Pn*$n+Fn*ts,Yn.self._33=On*Qn+En*qn+Un*$n+Jn*ts,r=c_.helpMat}}else if("_lightWorldViewProjectionMatrixCylinder"==s.link){if(null!=i){var es=c_.helpMat,as=e.transform.world;es.self._00=as.self._00,es.self._01=as.self._01,es.self._02=as.self._02,es.self._03=as.self._03,es.self._10=as.self._10,es.self._11=as.self._11,es.self._12=as.self._12,es.self._13=as.self._13,es.self._20=as.self._20,es.self._21=as.self._21,es.self._22=as.self._22,es.self._23=as.self._23,es.self._30=as.self._30,es.self._31=as.self._31,es.self._32=as.self._32,es.self._33=as.self._33;var is=c_.helpMat,ns=a.V,ss=is.self._00,rs=is.self._01,os=is.self._02,ls=is.self._03,_s=is.self._10,hs=is.self._11,fs=is.self._12,us=is.self._13,cs=is.self._20,ds=is.self._21,gs=is.self._22,ps=is.self._23,ms=is.self._30,vs=is.self._31,bs=is.self._32,Is=is.self._33,Ms=ns.self._00,ys=ns.self._10,ws=ns.self._20,xs=ns.self._30;is.self._00=ss*Ms+rs*ys+os*ws+ls*xs,is.self._10=_s*Ms+hs*ys+fs*ws+us*xs,is.self._20=cs*Ms+ds*ys+gs*ws+ps*xs,is.self._30=ms*Ms+vs*ys+bs*ws+Is*xs,Ms=ns.self._01,ys=ns.self._11,ws=ns.self._21,xs=ns.self._31,is.self._01=ss*Ms+rs*ys+os*ws+ls*xs,is.self._11=_s*Ms+hs*ys+fs*ws+us*xs,is.self._21=cs*Ms+ds*ys+gs*ws+ps*xs,is.self._31=ms*Ms+vs*ys+bs*ws+Is*xs,Ms=ns.self._02,ys=ns.self._12,ws=ns.self._22,xs=ns.self._32,is.self._02=ss*Ms+rs*ys+os*ws+ls*xs,is.self._12=_s*Ms+hs*ys+fs*ws+us*xs,is.self._22=cs*Ms+ds*ys+gs*ws+ps*xs,is.self._32=ms*Ms+vs*ys+bs*ws+Is*xs,Ms=ns.self._03,ys=ns.self._13,ws=ns.self._23,xs=ns.self._33,is.self._03=ss*Ms+rs*ys+os*ws+ls*xs,is.self._13=_s*Ms+hs*ys+fs*ws+us*xs,is.self._23=cs*Ms+ds*ys+gs*ws+ps*xs,is.self._33=ms*Ms+vs*ys+bs*ws+Is*xs,c_.helpMat.self._00=1,c_.helpMat.self._20=0,c_.helpMat.self._01=0,c_.helpMat.self._21=0,c_.helpMat.self._02=0,c_.helpMat.self._22=1;var Cs=c_.helpMat2,As=a.V,Zs=As.self._00,zs=As.self._01,Bs=As.self._02,ks=As.self._03,Ss=As.self._10,Xs=As.self._11,Ys=As.self._12,Ns=As.self._13,Ls=As.self._20,Gs=As.self._21,Ws=As.self._22,Ds=As.self._23,Ts=As.self._30,Vs=As.self._31,Ks=As.self._32,js=As.self._33,Rs=Zs*Xs-zs*Ss,Hs=Zs*Ys-Bs*Ss,Ps=Zs*Ns-ks*Ss,Fs=zs*Ys-Bs*Xs,Os=zs*Ns-ks*Xs,Es=Bs*Ns-ks*Ys,Us=Ls*Vs-Gs*Ts,Js=Ls*Ks-Ws*Ts,Qs=Ls*js-Ds*Ts,qs=Gs*Ks-Ws*Vs,$s=Gs*js-Ds*Vs,tr=Ws*js-Ds*Ks,er=Rs*tr-Hs*$s+Ps*qs+Fs*Qs-Os*Js+Es*Us;0==er?(Cs.self._00=1,Cs.self._01=0,Cs.self._02=0,Cs.self._03=0,Cs.self._10=0,Cs.self._11=1,Cs.self._12=0,Cs.self._13=0,Cs.self._20=0,Cs.self._21=0,Cs.self._22=1,Cs.self._23=0,Cs.self._30=0,Cs.self._31=0,Cs.self._32=0,Cs.self._33=1):(er=1/er,Cs.self._00=(Xs*tr-Ys*$s+Ns*qs)*er,Cs.self._01=(Bs*$s-zs*tr-ks*qs)*er,Cs.self._02=(Vs*Es-Ks*Os+js*Fs)*er,Cs.self._03=(Ws*Os-Gs*Es-Ds*Fs)*er,Cs.self._10=(Ys*Qs-Ss*tr-Ns*Js)*er,Cs.self._11=(Zs*tr-Bs*Qs+ks*Js)*er,Cs.self._12=(Ks*Ps-Ts*Es-js*Hs)*er,Cs.self._13=(Ls*Es-Ws*Ps+Ds*Hs)*er,Cs.self._20=(Ss*$s-Xs*Qs+Ns*Us)*er,Cs.self._21=(zs*Qs-Zs*$s-ks*Us)*er,Cs.self._22=(Ts*Os-Vs*Ps+js*Rs)*er,Cs.self._23=(Gs*Ps-Ls*Os-Ds*Rs)*er,Cs.self._30=(Xs*Js-Ss*qs-Ys*Us)*er,Cs.self._31=(Zs*qs-zs*Js+Bs*Us)*er,Cs.self._32=(Vs*Hs-Ts*Fs-Ks*Rs)*er,Cs.self._33=(Ls*Fs-Gs*Hs+Ws*Rs)*er);var ar=c_.helpMat,ir=c_.helpMat2,nr=ar.self._00,sr=ar.self._01,rr=ar.self._02,or=ar.self._03,lr=ar.self._10,_r=ar.self._11,hr=ar.self._12,fr=ar.self._13,ur=ar.self._20,cr=ar.self._21,dr=ar.self._22,gr=ar.self._23,pr=ar.self._30,mr=ar.self._31,vr=ar.self._32,br=ar.self._33,Ir=ir.self._00,Mr=ir.self._10,yr=ir.self._20,wr=ir.self._30;ar.self._00=nr*Ir+sr*Mr+rr*yr+or*wr,ar.self._10=lr*Ir+_r*Mr+hr*yr+fr*wr,ar.self._20=ur*Ir+cr*Mr+dr*yr+gr*wr,ar.self._30=pr*Ir+mr*Mr+vr*yr+br*wr,Ir=ir.self._01,Mr=ir.self._11,yr=ir.self._21,wr=ir.self._31,ar.self._01=nr*Ir+sr*Mr+rr*yr+or*wr,ar.self._11=lr*Ir+_r*Mr+hr*yr+fr*wr,ar.self._21=ur*Ir+cr*Mr+dr*yr+gr*wr,ar.self._31=pr*Ir+mr*Mr+vr*yr+br*wr,Ir=ir.self._02,Mr=ir.self._12,yr=ir.self._22,wr=ir.self._32,ar.self._02=nr*Ir+sr*Mr+rr*yr+or*wr,ar.self._12=lr*Ir+_r*Mr+hr*yr+fr*wr,ar.self._22=ur*Ir+cr*Mr+dr*yr+gr*wr,ar.self._32=pr*Ir+mr*Mr+vr*yr+br*wr,Ir=ir.self._03,Mr=ir.self._13,yr=ir.self._23,wr=ir.self._33,ar.self._03=nr*Ir+sr*Mr+rr*yr+or*wr,ar.self._13=lr*Ir+_r*Mr+hr*yr+fr*wr,ar.self._23=ur*Ir+cr*Mr+dr*yr+gr*wr,ar.self._33=pr*Ir+mr*Mr+vr*yr+br*wr;var xr=c_.helpMat,Cr=i.VP,Ar=xr.self._00,Zr=xr.self._01,zr=xr.self._02,Br=xr.self._03,kr=xr.self._10,Sr=xr.self._11,Xr=xr.self._12,Yr=xr.self._13,Nr=xr.self._20,Lr=xr.self._21,Gr=xr.self._22,Wr=xr.self._23,Dr=xr.self._30,Tr=xr.self._31,Vr=xr.self._32,Kr=xr.self._33,jr=Cr.self._00,Rr=Cr.self._10,Hr=Cr.self._20,Pr=Cr.self._30;xr.self._00=Ar*jr+Zr*Rr+zr*Hr+Br*Pr,xr.self._10=kr*jr+Sr*Rr+Xr*Hr+Yr*Pr,xr.self._20=Nr*jr+Lr*Rr+Gr*Hr+Wr*Pr,xr.self._30=Dr*jr+Tr*Rr+Vr*Hr+Kr*Pr,jr=Cr.self._01,Rr=Cr.self._11,Hr=Cr.self._21,Pr=Cr.self._31,xr.self._01=Ar*jr+Zr*Rr+zr*Hr+Br*Pr,xr.self._11=kr*jr+Sr*Rr+Xr*Hr+Yr*Pr,xr.self._21=Nr*jr+Lr*Rr+Gr*Hr+Wr*Pr,xr.self._31=Dr*jr+Tr*Rr+Vr*Hr+Kr*Pr,jr=Cr.self._02,Rr=Cr.self._12,Hr=Cr.self._22,Pr=Cr.self._32,xr.self._02=Ar*jr+Zr*Rr+zr*Hr+Br*Pr,xr.self._12=kr*jr+Sr*Rr+Xr*Hr+Yr*Pr,xr.self._22=Nr*jr+Lr*Rr+Gr*Hr+Wr*Pr,xr.self._32=Dr*jr+Tr*Rr+Vr*Hr+Kr*Pr,jr=Cr.self._03,Rr=Cr.self._13,Hr=Cr.self._23,Pr=Cr.self._33,xr.self._03=Ar*jr+Zr*Rr+zr*Hr+Br*Pr,xr.self._13=kr*jr+Sr*Rr+Xr*Hr+Yr*Pr,xr.self._23=Nr*jr+Lr*Rr+Gr*Hr+Wr*Pr,xr.self._33=Dr*jr+Tr*Rr+Vr*Hr+Kr*Pr,r=c_.helpMat}}else if("_biasLightWorldViewProjectionMatrix"==s.link){if(null!=i){if(null==e){var Fr=c_.helpMat;Fr.self._00=1,Fr.self._01=0,Fr.self._02=0,Fr.self._03=0,Fr.self._10=0,Fr.self._11=1,Fr.self._12=0,Fr.self._13=0,Fr.self._20=0,Fr.self._21=0,Fr.self._22=1,Fr.self._23=0,Fr.self._30=0,Fr.self._31=0,Fr.self._32=0,Fr.self._33=1}else{var Or=c_.helpMat,Er=e.transform.world;Or.self._00=Er.self._00,Or.self._01=Er.self._01,Or.self._02=Er.self._02,Or.self._03=Er.self._03,Or.self._10=Er.self._10,Or.self._11=Er.self._11,Or.self._12=Er.self._12,Or.self._13=Er.self._13,Or.self._20=Er.self._20,Or.self._21=Er.self._21,Or.self._22=Er.self._22,Or.self._23=Er.self._23,Or.self._30=Er.self._30,Or.self._31=Er.self._31,Or.self._32=Er.self._32,Or.self._33=Er.self._33}var Ur=c_.helpMat,Jr=i.VP,Qr=Ur.self._00,qr=Ur.self._01,$r=Ur.self._02,to=Ur.self._03,eo=Ur.self._10,ao=Ur.self._11,io=Ur.self._12,no=Ur.self._13,so=Ur.self._20,ro=Ur.self._21,oo=Ur.self._22,lo=Ur.self._23,_o=Ur.self._30,ho=Ur.self._31,fo=Ur.self._32,uo=Ur.self._33,co=Jr.self._00,go=Jr.self._10,po=Jr.self._20,mo=Jr.self._30;Ur.self._00=Qr*co+qr*go+$r*po+to*mo,Ur.self._10=eo*co+ao*go+io*po+no*mo,Ur.self._20=so*co+ro*go+oo*po+lo*mo,Ur.self._30=_o*co+ho*go+fo*po+uo*mo,co=Jr.self._01,go=Jr.self._11,po=Jr.self._21,mo=Jr.self._31,Ur.self._01=Qr*co+qr*go+$r*po+to*mo,Ur.self._11=eo*co+ao*go+io*po+no*mo,Ur.self._21=so*co+ro*go+oo*po+lo*mo,Ur.self._31=_o*co+ho*go+fo*po+uo*mo,co=Jr.self._02,go=Jr.self._12,po=Jr.self._22,mo=Jr.self._32,Ur.self._02=Qr*co+qr*go+$r*po+to*mo,Ur.self._12=eo*co+ao*go+io*po+no*mo,Ur.self._22=so*co+ro*go+oo*po+lo*mo,Ur.self._32=_o*co+ho*go+fo*po+uo*mo,co=Jr.self._03,go=Jr.self._13,po=Jr.self._23,mo=Jr.self._33,Ur.self._03=Qr*co+qr*go+$r*po+to*mo,Ur.self._13=eo*co+ao*go+io*po+no*mo,Ur.self._23=so*co+ro*go+oo*po+lo*mo,Ur.self._33=_o*co+ho*go+fo*po+uo*mo;var vo=c_.helpMat,bo=c_.biasMat,Io=vo.self._00,Mo=vo.self._01,yo=vo.self._02,wo=vo.self._03,xo=vo.self._10,Co=vo.self._11,Ao=vo.self._12,Zo=vo.self._13,zo=vo.self._20,Bo=vo.self._21,ko=vo.self._22,So=vo.self._23,Xo=vo.self._30,Yo=vo.self._31,No=vo.self._32,Lo=vo.self._33,Go=bo.self._00,Wo=bo.self._10,Do=bo.self._20,To=bo.self._30;vo.self._00=Io*Go+Mo*Wo+yo*Do+wo*To,vo.self._10=xo*Go+Co*Wo+Ao*Do+Zo*To,vo.self._20=zo*Go+Bo*Wo+ko*Do+So*To,vo.self._30=Xo*Go+Yo*Wo+No*Do+Lo*To,Go=bo.self._01,Wo=bo.self._11,Do=bo.self._21,To=bo.self._31,vo.self._01=Io*Go+Mo*Wo+yo*Do+wo*To,vo.self._11=xo*Go+Co*Wo+Ao*Do+Zo*To,vo.self._21=zo*Go+Bo*Wo+ko*Do+So*To,vo.self._31=Xo*Go+Yo*Wo+No*Do+Lo*To,Go=bo.self._02,Wo=bo.self._12,Do=bo.self._22,To=bo.self._32,vo.self._02=Io*Go+Mo*Wo+yo*Do+wo*To,vo.self._12=xo*Go+Co*Wo+Ao*Do+Zo*To,vo.self._22=zo*Go+Bo*Wo+ko*Do+So*To,vo.self._32=Xo*Go+Yo*Wo+No*Do+Lo*To,Go=bo.self._03,Wo=bo.self._13,Do=bo.self._23,To=bo.self._33,vo.self._03=Io*Go+Mo*Wo+yo*Do+wo*To,vo.self._13=xo*Go+Co*Wo+Ao*Do+Zo*To,vo.self._23=zo*Go+Bo*Wo+ko*Do+So*To,vo.self._33=Xo*Go+Yo*Wo+No*Do+Lo*To,r=c_.helpMat}}else if(null!=c_.externalMat4Links)for(var Vo=0,Ko=c_.externalMat4Links;Vo<Ko.length;){var jo=Ko[Vo];if(++Vo,null!=(r=jo(e,c_.currentMat(e),s.link)))break}if(null==r)return;t.setMatrix(n,r.self)}else if("mat3"==s.type){var Ro=null;if("_normalMatrix"==s.link){var Ho=c_.helpMat,Po=e.transform.world;Ho.self._00=Po.self._00,Ho.self._01=Po.self._01,Ho.self._02=Po.self._02,Ho.self._03=Po.self._03,Ho.self._10=Po.self._10,Ho.self._11=Po.self._11,Ho.self._12=Po.self._12,Ho.self._13=Po.self._13,Ho.self._20=Po.self._20,Ho.self._21=Po.self._21,Ho.self._22=Po.self._22,Ho.self._23=Po.self._23,Ho.self._30=Po.self._30,Ho.self._31=Po.self._31,Ho.self._32=Po.self._32,Ho.self._33=Po.self._33;var Fo=c_.helpMat,Oo=c_.helpMat,Eo=Oo.self._00,Uo=Oo.self._01,Jo=Oo.self._02,Qo=Oo.self._03,qo=Oo.self._10,$o=Oo.self._11,tl=Oo.self._12,el=Oo.self._13,al=Oo.self._20,il=Oo.self._21,nl=Oo.self._22,sl=Oo.self._23,rl=Oo.self._30,ol=Oo.self._31,ll=Oo.self._32,_l=Oo.self._33,hl=Eo*$o-Uo*qo,fl=Eo*tl-Jo*qo,ul=Eo*el-Qo*qo,cl=Uo*tl-Jo*$o,dl=Uo*el-Qo*$o,gl=Jo*el-Qo*tl,pl=al*ol-il*rl,ml=al*ll-nl*rl,vl=al*_l-sl*rl,bl=il*ll-nl*ol,Il=il*_l-sl*ol,Ml=nl*_l-sl*ll,yl=hl*Ml-fl*Il+ul*bl+cl*vl-dl*ml+gl*pl;0==yl?(Fo.self._00=1,Fo.self._01=0,Fo.self._02=0,Fo.self._03=0,Fo.self._10=0,Fo.self._11=1,Fo.self._12=0,Fo.self._13=0,Fo.self._20=0,Fo.self._21=0,Fo.self._22=1,Fo.self._23=0,Fo.self._30=0,Fo.self._31=0,Fo.self._32=0,Fo.self._33=1):(yl=1/yl,Fo.self._00=($o*Ml-tl*Il+el*bl)*yl,Fo.self._01=(Jo*Il-Uo*Ml-Qo*bl)*yl,Fo.self._02=(ol*gl-ll*dl+_l*cl)*yl,Fo.self._03=(nl*dl-il*gl-sl*cl)*yl,Fo.self._10=(tl*vl-qo*Ml-el*ml)*yl,Fo.self._11=(Eo*Ml-Jo*vl+Qo*ml)*yl,Fo.self._12=(ll*ul-rl*gl-_l*fl)*yl,Fo.self._13=(al*gl-nl*ul+sl*fl)*yl,Fo.self._20=(qo*Il-$o*vl+el*pl)*yl,Fo.self._21=(Uo*vl-Eo*Il-Qo*pl)*yl,Fo.self._22=(rl*dl-ol*ul+_l*hl)*yl,Fo.self._23=(il*ul-al*dl-sl*hl)*yl,Fo.self._30=($o*ml-qo*bl-tl*pl)*yl,Fo.self._31=(Eo*bl-Uo*ml+Jo*pl)*yl,Fo.self._32=(ol*fl-rl*cl-ll*hl)*yl,Fo.self._33=(al*cl-il*fl+nl*hl)*yl);var wl=c_.helpMat,xl=wl.self._01;wl.self._01=wl.self._10,wl.self._10=xl,xl=wl.self._02,wl.self._02=wl.self._20,wl.self._20=xl,xl=wl.self._12,wl.self._12=wl.self._21,wl.self._21=xl;var Cl=c_.helpMat3,Al=c_.helpMat;Cl.self._00=Al.self._00,Cl.self._01=Al.self._01,Cl.self._02=Al.self._02,Cl.self._10=Al.self._10,Cl.self._11=Al.self._11,Cl.self._12=Al.self._12,Cl.self._20=Al.self._20,Cl.self._21=Al.self._21,Cl.self._22=Al.self._22,Ro=c_.helpMat3}if(null==Ro)return;t.setMatrix3(n,Ro.self)}else if("vec4"==s.type){var Zl=null,zl=c_.helpVec;if(zl.x=0,zl.y=0,zl.z=0,zl.w=1,null!=c_.externalVec4Links)for(var Bl=0,kl=c_.externalVec4Links;Bl<kl.length;){var Sl=kl[Bl];if(++Bl,null!=(Zl=Sl(e,c_.currentMat(e),s.link)))break}if(null==Zl)return;t.setFloat4(n,Zl.x,Zl.y,Zl.z,Zl.w)}else if("vec3"==s.type){var Xl=null,Yl=c_.helpVec;if(Yl.x=0,Yl.y=0,Yl.z=0,Yl.w=1,"_dim"==s.link){var Nl=e.transform.dim,Ll=e.transform.scale,Gl=c_.helpVec;Gl.x=Nl.x/Ll.x,Gl.y=Nl.y/Ll.y,Gl.z=Nl.z/Ll.z,Gl.w=1,Xl=c_.helpVec}else if("_halfDim"==s.link){var Wl=e.transform.dim,Dl=e.transform.scale,Tl=c_.helpVec;Tl.x=Wl.x/Dl.x/2,Tl.y=Wl.y/Dl.y/2,Tl.z=Wl.z/Dl.z/2,Tl.w=1,Xl=c_.helpVec}else if("_probeVolumeCenter"==s.link)Xl=h_.active.world.getProbeVolumeCenter(e.transform);else if("_probeVolumeSize"==s.link)Xl=h_.active.world.getProbeVolumeSize(e.transform);else if(null!=c_.externalVec3Links)for(var Vl=0,Kl=c_.externalVec3Links;Vl<Kl.length;){var jl=Kl[Vl];if(++Vl,null!=(Xl=jl(e,c_.currentMat(e),s.link)))break}if(null==Xl)return;t.setFloat3(n,Xl.x,Xl.y,Xl.z)}else if("vec2"==s.type){var Rl=null,Hl=0;if("_tilesheetOffset"==s.link){var Pl=d_.__cast(e,u_).tilesheet;Rl=Pl.tileX,Hl=Pl.tileY}else if(null!=c_.externalVec2Links)for(var Fl=0,Ol=c_.externalVec2Links;Fl<Ol.length;){var El=Ol[Fl];++Fl;var Ul=El(e,c_.currentMat(e),s.link);if(null!=Ul){Rl=Ul.x,Hl=Ul.y;break}}if(null==Rl)return;t.setFloat2(n,Rl,Hl)}else if("float"==s.type){var Jl=null;if("_probeStrength"==s.link)Jl=h_.active.world.getProbeStrength(e.transform);else if("_probeBlending"==s.link)Jl=h_.active.world.getProbeBlending(e.transform);else if("_objectInfoIndex"==s.link)Jl=e.uid;else if("_objectInfoMaterialIndex"==s.link)Jl=c_.currentMat(e).uid;else if("_objectInfoRandom"==s.link)Jl=e.urandom;else if(null!=c_.externalFloatLinks)for(var Ql=0,ql=c_.externalFloatLinks;Ql<ql.length;){var $l=ql[Ql];++Ql;var t_=$l(e,c_.currentMat(e),s.link);if(null!=t_){Jl=t_;break}}if(null==Jl)return;t.setFloat(n,Jl)}else if("floats"==s.type){var e_=null;if("_skinBones"==s.link&&null!=e.animation&&(e_=d_.__cast(e.animation,f_).skinBuffer),null==e_&&null!=c_.externalFloatsLinks)for(var a_=0,i_=c_.externalFloatsLinks;a_<i_.length;){var n_=i_[a_];if(++a_,null!=(e_=n_(e,c_.currentMat(e),s.link)))break}if(null==e_)return;t.setFloats(n,e_)}else if("int"==s.type){var s_=null;if("_uid"==s.link)s_=e.uid;else if(null!=c_.externalIntLinks)for(var r_=0,o_=c_.externalIntLinks;r_<o_.length;){var l_=o_[r_];++r_;var __=l_(e,c_.currentMat(e),s.link);if(null!=__){s_=__;break}}if(null==s_)return;t.setInt(n,s_)}},c_.setMaterialConstants=function(t,e,a){if(null!=a.raw.bind_constants)for(var i=0,n=a.raw.bind_constants.length;i<n;){for(var s=i++,r=a.raw.bind_constants[s],o=-1,l=0,_=e.raw.constants.length;l<_;){var h=l++;if(e.raw.constants[h].name==r.name){o=h;break}}if(-1!=o){var f=e.raw.constants[o];c_.setMaterialConstant(t,e.constants[o],f,r)}}if(null!=a.textures)for(var u=0,c=a.textures.length;u<c;)for(var d=u++,g=a.raw.bind_textures[d].name,p=0,m=e.textureUnits.length;p<m;){var v=p++;if(g==e.raw.texture_units[v].name){t.setTexture(e.textureUnits[v],a.textures[d]),a.setTextureParameters(t,d,e,v);break}}},c_.currentMat=function(t){return null!=t&&t instanceof u_?d_.__cast(t,u_).materials[0]:null},c_.setMaterialConstant=function(t,e,a,i){switch(a.type){case"bool":t.setBool(e,i.bool);break;case"float":t.setFloat(e,i.float);break;case"int":t.setInt(e,i.int);break;case"vec2":t.setFloat2(e,i.vec2[0],i.vec2[1]);break;case"vec3":t.setFloat3(e,i.vec3[0],i.vec3[1],i.vec3[2]);break;case"vec4":t.setFloat4(e,i.vec4[0],i.vec4[1],i.vec4[2],i.vec4[3])}};var At=function(){};(i["iron.system.ArmPack"]=At).__name__=!0,At.read=function(t){try{var e=t.readByte();switch(e){case 192:return null;case 194:return!1;case 195:return!0;case 196:return t.read(t.readByte());case 197:return t.read(t.readUInt16());case 198:return t.read(t.readInt32());case 202:return t.readFloat();case 204:return t.readByte();case 205:return t.readUInt16();case 206:return t.readInt32();case 208:return t.readInt8();case 209:return t.readInt16();case 210:return t.readInt32();case 217:return t.readString(t.readByte());case 218:return t.readString(t.readUInt16());case 219:return t.readString(t.readInt32());case 220:return At.readArray(t,t.readUInt16());case 221:return At.readArray(t,t.readInt32());case 222:return At.readMap(t,t.readUInt16());case 223:return At.readMap(t,t.readInt32());default:if(e<128)return e;if(e<144)return At.readMap(t,15&e);if(e<160)return At.readArray(t,15&e);if(e<192)return t.readString(31&e);if(223<e)return-256|e}}catch(t){var a=t instanceof Jt?t.val:t;if(!(a instanceof K))throw t}return null},At.readArray=function(t,e){var a=t.readByte(),i=t,n=i.pos;if(i.set_position(n-1),202==a){var s=t,r=s.pos;s.set_position(r+1);for(var o=new ds(e),l=0,_=e;l<_;){o[l++]=t.readFloat()}return o}if(210==a){var h=t,f=h.pos;h.set_position(f+1);for(var u=new Uint32Array(e),c=0,d=e;c<d;){u[c++]=t.readInt32()}return u}for(var g=[],p=0,m=e;p<m;){p++;g.push(At.read(t))}return g},At.readMap=function(t,e){for(var a={},i=0,n=e;i<n;){i++;var s=At.read(t),r=At.read(t);a[X.string(s)]=r}return a};var Zt=function(){};(i["iron.system.Audio"]=Zt).__name__=!0,Zt.play=function(t,e,a){return null==a&&(a=!1),null==e&&(e=!1),a&&null!=t.compressedData?Ae.stream(t,e):null!=t.uncompressedData?Ae.play(t,e):null};var zt=function(){};(i["iron.system.Input"]=zt).__name__=!0,zt.reset=function(){zt.occupied=!1,null!=zt.mouse&&zt.mouse.reset(),null!=zt.pen&&zt.pen.reset(),null!=zt.keyboard&&zt.keyboard.reset();for(var t=0,e=zt.gamepads;t<e.length;){var a=e[t];++t,a.reset()}},zt.endFrame=function(){null!=zt.mouse&&zt.mouse.endFrame(),null!=zt.pen&&zt.pen.endFrame(),null!=zt.keyboard&&zt.keyboard.endFrame();for(var t=0,e=zt.gamepads;t<e.length;){var a=e[t];++t,a.endFrame()}if(null!=zt.virtualButtons)for(var i=zt.virtualButtons,n=new W(i,i.arrayKeys());n.hasNext();){var s=n.next();s.started=s.released=!1}},zt.getMouse=function(){return zt.registered||(zt.registered=!0,P.notifyOnEndFrame(zt.endFrame),P.notifyOnReset(zt.reset)),null==zt.mouse&&(zt.mouse=new St),zt.mouse},zt.getKeyboard=function(){return zt.registered||(zt.registered=!0,P.notifyOnEndFrame(zt.endFrame),P.notifyOnReset(zt.reset)),null==zt.keyboard&&(zt.keyboard=new Yt),zt.keyboard},zt.getGamepad=function(t){if(null==t&&(t=0),4<=t)return null;for(zt.registered||(zt.registered=!0,P.notifyOnEndFrame(zt.endFrame),P.notifyOnReset(zt.reset));zt.gamepads.length<=t;)zt.gamepads.push(new Gt(zt.gamepads.length));return zt.gamepads[t].connected?zt.gamepads[t]:null};var Bt=function(){this.down=!1,this.released=!1,this.started=!1};(i["iron.system.VirtualButton"]=Bt).__name__=!0,Bt.prototype={started:null,released:null,down:null,__class__:Bt};var kt=function(){this.virtualButtons=null};(i["iron.system.VirtualInput"]=kt).__name__=!0,kt.prototype={virtualButtons:null,downVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons,a=null!=fs[t]?e.getReserved(t):e.h[t];null!=a&&(a.down=!0,a.started=!0)}},upVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons,a=null!=fs[t]?e.getReserved(t):e.h[t];null!=a&&(a.down=!1,a.released=!0)}},__class__:kt};var St=function(){this.lastY=-1,this.lastX=-1,this.locked=!1,this.wheelDelta=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1,!1,!1],this.buttonsStarted=[!1,!1,!1],this.buttonsDown=[!1,!1,!1],kt.call(this),Ja.get().notify(ns(this,this.downListener),ns(this,this.upListener),ns(this,this.moveListener),ns(this,this.wheelListener))};(i["iron.system.Mouse"]=St).__name__=!0,St.__super__=kt,St.prototype=s(kt.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,x:null,y:null,moved:null,movementX:null,movementY:null,wheelDelta:null,locked:null,lastX:null,lastY:null,endFrame:function(){var t=this.buttonsStarted[1]=this.buttonsStarted[2]=!1;this.buttonsStarted[0]=t;var e=this.buttonsReleased[1]=this.buttonsReleased[2]=!1;this.buttonsReleased[0]=e,this.moved=!1,this.movementX=0,this.movementY=0,this.wheelDelta=0},reset:function(){var t=this.buttonsDown[1]=this.buttonsDown[2]=!1;this.buttonsDown[0]=t,this.endFrame()},buttonIndex:function(t){return"left"==t?0:"right"==t?1:2},down:function(t){return null==t&&(t="left"),this.buttonsDown[this.buttonIndex(t)]},downListener:function(t,e,a){this.buttonsDown[t]=!0,this.buttonsStarted[t]=!0,this.x=e,this.y=a,0==t&&(this.lastX=e,this.lastY=a),this.downVirtual(St.buttons[t])},upListener:function(t,e,a){this.buttonsDown[t]=!1,this.buttonsReleased[t]=!0,this.x=e,this.y=a,this.upVirtual(St.buttons[t])},moveListener:function(t,e,a,i){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.locked?(this.movementX=a,this.movementY=i):(this.movementX=t-this.lastX,this.movementY=e-this.lastY),this.lastX=t,this.lastY=e,this.x=t,this.y=e,this.moved=!0},wheelListener:function(t){this.wheelDelta=t},__class__:St});var Xt=function(){this.lastPressure=0,this.lastY=-1,this.lastX=-1,this.pressure=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1],this.buttonsStarted=[!1],this.buttonsDown=[!1],kt.call(this),qa.get().notify(ns(this,this.downListener),ns(this,this.upListener),ns(this,this.moveListener))};(i["iron.system.Pen"]=Xt).__name__=!0,Xt.__super__=kt,Xt.prototype=s(kt.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,x:null,y:null,moved:null,movementX:null,movementY:null,pressure:null,lastX:null,lastY:null,lastPressure:null,endFrame:function(){this.buttonsStarted[0]=!1,this.buttonsReleased[0]=!1,this.moved=!1,this.movementX=0,this.movementY=0},reset:function(){this.buttonsDown[0]=!1,this.endFrame()},downListener:function(t,e,a){},upListener:function(t,e,a){},moveListener:function(t,e,a){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e,this.lastPressure=a),this.movementX=t-this.lastX,this.movementY=e-this.lastY,this.lastX=t,this.lastY=e,this.x=t,this.y=e,this.moved=!0,0<(this.pressure=a)&&0==this.lastPressure&&(this.buttonsDown[0]=!0,this.buttonsStarted[0]=!0),0==a&&0<this.lastPressure&&(this.buttonsDown[0]=!1,this.buttonsReleased[0]=!0),this.lastPressure=a},__class__:Xt});var Yt=function(){this.keysFrame=[],this.keysReleased=new et,this.keysStarted=new et,this.keysDown=new et,kt.call(this),this.reset(),Ua.get().notify(ns(this,this.downListener),ns(this,this.upListener),ns(this,this.pressListener))};(i["iron.system.Keyboard"]=Yt).__name__=!0,Yt.keyCode=function(t){return 32==t?"space":8==t?"backspace":9==t?"tab":13==t?"enter":16==t?"shift":17==t?"control":18==t?"alt":27==t?"escape":46==t?"delete":38==t?"up":40==t?"down":37==t?"left":39==t?"right":1==t?"back":48==t?"0":49==t?"1":50==t?"2":51==t?"3":52==t?"4":53==t?"5":54==t?"6":55==t?"7":56==t?"8":57==t?"9":String.fromCharCode(t).toLowerCase()},Yt.__super__=kt,Yt.prototype=s(kt.prototype,{keysDown:null,keysStarted:null,keysReleased:null,keysFrame:null,endFrame:function(){if(0<this.keysFrame.length){for(var t=0,e=this.keysFrame;t<e.length;){var a=e[t];++t;var i=this.keysStarted;null!=fs[a]?i.setReserved(a,!1):i.h[a]=!1;var n=this.keysReleased;null!=fs[a]?n.setReserved(a,!1):n.h[a]=!1}this.keysFrame.splice(0,this.keysFrame.length)}},reset:function(){for(var t=0,e=Yt.keys;t<e.length;){var a=e[t];++t;var i=this.keysDown;null!=fs[a]?i.setReserved(a,!1):i.h[a]=!1;var n=this.keysStarted;null!=fs[a]?n.setReserved(a,!1):n.h[a]=!1;var s=this.keysReleased;null!=fs[a]?s.setReserved(a,!1):s.h[a]=!1}this.endFrame()},down:function(t){var e=this.keysDown;return null!=fs[t]?e.getReserved(t):e.h[t]},started:function(t){var e=this.keysStarted;return null!=fs[t]?e.getReserved(t):e.h[t]},downListener:function(t){var e=Yt.keyCode(t);this.keysFrame.push(e);var a=this.keysStarted;null!=fs[e]?a.setReserved(e,!0):a.h[e]=!0;var i=this.keysDown;null!=fs[e]?i.setReserved(e,!0):i.h[e]=!0,this.downVirtual(e)},upListener:function(t){var e=Yt.keyCode(t);this.keysFrame.push(e);var a=this.keysReleased;null!=fs[e]?a.setReserved(e,!0):a.h[e]=!0;var i=this.keysDown;null!=fs[e]?i.setReserved(e,!1):i.h[e]=!1,this.upVirtual(e)},pressListener:function(t){},__class__:Yt});var Nt=function(){this.movementY=0,this.movementX=0,this.moved=!1,this.lastY=0,this.lastX=0,this.y=0,this.x=0};(i["iron.system.GamepadStick"]=Nt).__name__=!0,Nt.prototype={x:null,y:null,lastX:null,lastY:null,moved:null,movementX:null,movementY:null,__class__:Nt};var Gt=function(t,e){null==e&&(e=!1),this.num=0,this.connected=!1,this.rightStick=new Nt,this.leftStick=new Nt,this.buttonsFrame=[],this.buttonsReleased=[],this.buttonsStarted=[],this.buttonsDown=[],kt.call(this);for(var a=0,i=Gt.buttons;a<i.length;){i[a];++a,this.buttonsDown.push(0),this.buttonsStarted.push(!1),this.buttonsReleased.push(!1)}this.num=t,this.reset(),e?this.connected=!0:this.connect()};(i["iron.system.Gamepad"]=Gt).__name__=!0,Gt.__super__=kt,Gt.prototype=s(kt.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,buttonsFrame:null,leftStick:null,rightStick:null,connected:null,num:null,connect:function(){var t=Oa.get(this.num);null!=t&&(this.connected=!0,t.notify(ns(this,this.axisListener),ns(this,this.buttonListener)))},endFrame:function(){if(0<this.buttonsFrame.length){for(var t=0,e=this.buttonsFrame;t<e.length;){var a=e[t];++t,this.buttonsStarted[a]=!1,this.buttonsReleased[a]=!1}this.buttonsFrame.splice(0,this.buttonsFrame.length)}this.leftStick.moved=!1,this.leftStick.movementX=0,this.leftStick.movementY=0,this.rightStick.moved=!1,this.rightStick.movementX=0,this.rightStick.movementY=0},reset:function(){for(var t=0,e=this.buttonsDown.length;t<e;){var a=t++;this.buttonsDown[a]=0,this.buttonsStarted[a]=!1,this.buttonsReleased[a]=!1}this.endFrame()},buttonIndex:function(t){for(var e=0,a=Gt.buttons.length;e<a;){var i=e++;if(Gt.buttons[i]==t)return i}return 0},down:function(t){return this.buttonsDown[this.buttonIndex(t)]},started:function(t){return this.buttonsStarted[this.buttonIndex(t)]},axisListener:function(t,e){var a=t<=1?this.leftStick:this.rightStick;0==t||2==t?(a.lastX=a.x,a.x=e,a.movementX=a.x-a.lastX):1!=t&&3!=t||(a.lastY=a.y,a.y=e,a.movementY=a.y-a.lastY),a.moved=!0},buttonListener:function(t,e){this.buttonsFrame.push(t),0<(this.buttonsDown[t]=e)?this.buttonsStarted[t]=!0:this.buttonsReleased[t]=!0,0==e?this.upVirtual(Gt.buttons[t]):1==e&&this.downVirtual(Gt.buttons[t])},__class__:Gt});var fo=function(){};(i["iron.system.Time"]=fo).__name__=!0,fo.update=function(){fo.realDelta=uo.realTime()-fo.last,fo.last=uo.realTime()};var Wt=function(){};(i["iron.system.Tween"]=Wt).__name__=!0,Wt.to=function(t){if(Wt.registered||(Wt.registered=!0,P.notifyOnUpdate(Wt.update),P.notifyOnReset(function(){P.notifyOnUpdate(Wt.update),Wt.reset()})),t._time=0,t.isPlaying=!(null!=t.delay&&0<t.delay),null==t.ease&&(t.ease=0),null!=t.target&&null!=t.props){t._comps=[],t._x=[],t._y=[],t._z=[],t._w=[],t._normalize=[];for(var e=0,a=Ft.fields(t.props);e<a.length;){var i=a[e];++e;var n=Ft.getProperty(t.target,i);n instanceof lo||n instanceof A?(t._comps.push(4),t._x.push(n.x),t._y.push(n.y),t._z.push(n.z),t._w.push(n.w),t._normalize.push(n instanceof A)):(t._comps.push(1),t._x.push(n),t._y.push(0),t._z.push(0),t._w.push(0))}}return Wt.anims.push(t),t},Wt.timer=function(t,e){return Wt.to({target:null,props:null,duration:0,delay:t,done:e})},Wt.reset=function(){Wt.anims=[]},Wt.update=function(){for(var t=.016666666666666666*fo.scale,e=Wt.anims.length;0<e--&&0<Wt.anims.length;){var a=Wt.anims[e];if(!(0<a.delay&&(a.delay-=t,0<a.delay))){if(a._time+=t,a.isPlaying=a._time<a.duration,null!=a.target){a.target instanceof je&&(a.target.dirty=!0);for(var i=Ft.fields(a.props),n=0,s=i.length;n<s;){var r=n++,o=i[r],l=a._time/a.duration;if(1<l&&(l=1),1==a._comps[r]){var _=a._x[r],h=_+(Ft.getProperty(a.props,o)-_)*Wt.eases[a.ease](l);Ft.setProperty(a.target,o,h)}else{var f=Ft.getProperty(a.props,o),u=Ft.getProperty(f,"x"),c=Ft.getProperty(f,"y"),d=Ft.getProperty(f,"z"),g=Ft.getProperty(f,"w");if(a._normalize[r])a._x[r]*u+a._y[r]*c+a._z[r]*d+a._w[r]*g<0&&(u=-u,c=-c,d=-d,g=-g);var p=a._x[r]+(u-a._x[r])*Wt.eases[a.ease](l),m=a._y[r]+(c-a._y[r])*Wt.eases[a.ease](l),v=a._z[r]+(d-a._z[r])*Wt.eases[a.ease](l),b=a._w[r]+(g-a._w[r])*Wt.eases[a.ease](l);if(a._normalize[r]){var I=Math.sqrt(p*p+m*m+v*v+b*b);0<I&&(p*=I=1/I,m*=I,v*=I,b*=I)}var M=Ft.getProperty(a.target,o);Ft.setProperty(M,"x",p),Ft.setProperty(M,"y",m),Ft.setProperty(M,"z",v),Ft.setProperty(M,"w",b)}}}a.isPlaying?null!=a.tick&&a.tick():(Wt.anims.splice(e,1),--e,a.isPlaying=!1,null!=a.done&&a.done())}}},Wt.easeLinear=function(t){return t},Wt.easeSineIn=function(t){return 0==t?0:1==t?1:1-Math.cos(t*Math.PI/2)},Wt.easeSineOut=function(t){return 0==t?0:1==t?1:Math.sin(t*(.5*Math.PI))},Wt.easeSineInOut=function(t){return 0==t?0:1==t?1:-.5*(Math.cos(Math.PI*t)-1)},Wt.easeQuadIn=function(t){return t*t},Wt.easeQuadOut=function(t){return-t*(t-2)},Wt.easeQuadInOut=function(t){return t<.5?2*t*t:--t*t*-2+1},Wt.easeCubicIn=function(t){return t*t*t},Wt.easeCubicOut=function(t){return--t*t*t+1},Wt.easeCubicInOut=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},Wt.easeQuartIn=function(t){return(t*=t)*t},Wt.easeQuartOut=function(t){return 1-(t=--t*t)*t},Wt.easeQuartInOut=function(t){return(t*=2)<1?.5*(t*=t)*t:-.5*((t=(t-=2)*t)*t-2)},Wt.easeQuintIn=function(t){return t*(t*=t)*t},Wt.easeQuintOut=function(t){return--t*(t*=t)*t+1},Wt.easeQuintInOut=function(t){return(t*=2)<1?.5*t*(t*=t)*t:.5*(t-=2)*(t*=t)*t+1},Wt.easeExpoIn=function(t){return 0==t?0:Math.pow(2,10*(t-1))},Wt.easeExpoOut=function(t){return 1==t?1:1-Math.pow(2,-10*t)},Wt.easeExpoInOut=function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},Wt.easeCircIn=function(t){return-(Math.sqrt(1-t*t)-1)},Wt.easeCircOut=function(t){return Math.sqrt(1-(t-1)*(t-1))},Wt.easeCircInOut=function(t){return t<=.5?(Math.sqrt(1-t*t*4)-1)/-2:(Math.sqrt(1-(2*t-2)*(2*t-2))+1)/2},Wt.easeBackIn=function(t){return 0==t?0:1==t?1:t*t*(2.70158*t-1.70158)},Wt.easeBackOut=function(t){return 0==t?0:1==t?1:--t*t*(2.70158*t+1.70158)+1},Wt.easeBackInOut=function(t){return 0==t?0:1==t?1:(t*=2)<1?t*t*(3.5949095*t-2.5949095)*.5:.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)};var Jt=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,Jt)};(i["js._Boot.HaxeError"]=Jt).__name__=!0,Jt.wrap=function(t){return t instanceof Error?t:new Jt(t)},Jt.__super__=Error,Jt.prototype=s(Error.prototype,{val:null,__class__:Jt});var d_=function(){};(i["js.Boot"]=d_).__name__=!0,d_.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var a=d_.__nativeClassName(t);return null!=a?d_.__resolveNativeClass(a):null},d_.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var a=typeof t;switch("function"==a&&(t.__name__||t.__ename__)&&(a="object"),a){case"function":return"<function>";case"object":if(t.__enum__){var i=I[t.__enum__],n=i.__constructs__[t._hx_index],s=i[n];if(s.__params__){e+="\t";for(var r=n+"(",o=[],l=0,_=s.__params__;l<_.length;){var h=_[l];++l,o.push(d_.__string_rec(t[h],e))}return r+o.join(",")+")"}return n}if(t instanceof Array){var f="[";e+="\t";for(var u=0,c=t.length;u<c;){var d=u++;f+=(0<d?",":"")+d_.__string_rec(t[d],e)}return f+="]"}var g;try{g=t.toString}catch(t){t instanceof Jt&&t.val;return"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g){var p=t.toString();if("[object Object]"!=p)return p}var m=null,v="{\n";e+="\t";var b=null!=t.hasOwnProperty;for(var m in t)b&&!t.hasOwnProperty(m)||"prototype"!=m&&"__class__"!=m&&"__super__"!=m&&"__interfaces__"!=m&&"__properties__"!=m&&(2!=v.length&&(v+=", \n"),v+=e+m+" : "+d_.__string_rec(t[m],e));return v+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},d_.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var a=t.__interfaces__;if(null!=a)for(var i=0,n=a.length;i<n;){var s=a[i++];if(s==e||d_.__interfLoop(s,e))return!0}return d_.__interfLoop(t.__super__,e)},d_.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case ls:return"boolean"==typeof t;case rs:return!0;case os:return"number"==typeof t;case ss:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(d_.__interfLoop(d_.getClass(t),e))return!0}else if("object"==typeof e&&d_.__isNativeObj(e)&&t instanceof e)return!0;return e==_s&&null!=t.__name__||(e==hs&&null!=t.__ename__||I[t.__enum__]==e)}},d_.__cast=function(t,e){if(d_.__instanceof(t,e))return t;throw new Jt("Cannot cast "+X.string(t)+" to "+X.string(e))},d_.__nativeClassName=function(t){var e=d_.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},d_.__isNativeObj=function(t){return null!=d_.__nativeClassName(t)},d_.__resolveNativeClass=function(t){return e[t]};var Dt=function(t){if(t instanceof Array&&null==t.__enum__)this.a=t,this.byteLength=t.length;else{var e=t;this.a=[];for(var a=0,i=e;a<i;){var n=a++;this.a[n]=0}this.byteLength=e}};(i["js.html.compat.ArrayBuffer"]=Dt).__name__=!0,Dt.sliceImpl=function(t,e){var a=new gs(this,t,null==e?null:e-t),i=new us(a.byteLength);return new gs(i).set(a),i},Dt.prototype={byteLength:null,a:null,slice:function(t,e){return new Dt(this.a.slice(t,e))},__class__:Dt};var Tt=function(t,e,a){if(this.buf=t,this.offset=null==e?0:e,this.length=null==a?t.byteLength-this.offset:a,this.offset<0||this.length<0||this.offset+this.length>t.byteLength)throw new Jt(j.OutsideBounds);this.byteLength=this.length,this.byteOffset=this.offset,this.buffer=this.buf};(i["js.html.compat.DataView"]=Tt).__name__=!0,Tt.prototype={buf:null,offset:null,length:null,byteLength:null,byteOffset:null,buffer:null,getInt8:function(t){var e=this.buf.a[this.offset+t];return 128<=e?e-256:e},getUint8:function(t){return this.buf.a[this.offset+t]},getInt16:function(t,e){var a=this.getUint16(t,e);return 32768<=a?a-65536:a},getUint16:function(t,e){return e?this.buf.a[this.offset+t]|this.buf.a[this.offset+t+1]<<8:this.buf.a[this.offset+t]<<8|this.buf.a[this.offset+t+1]},getInt32:function(t,e){var a=this.offset+t,i=this.buf.a[a++],n=this.buf.a[a++],s=this.buf.a[a++],r=this.buf.a[a++];return e?i|n<<8|s<<16|r<<24:r|s<<8|n<<16|i<<24},getUint32:function(t,e){var a=this.getInt32(t,e);return a<0?a+4294967296:a},getFloat32:function(t,e){var a=this.getInt32(t,e),i=1-(a>>>31<<1),n=a>>23&255;return 255==n?0==(8388607&a)?0<i?1/0:-1/0:NaN:i*(0==n?(8388607&a)<<1:8388607&a|8388608)*Math.pow(2,n-150)},getFloat64:function(t,e){var a=this.getInt32(t,e),i=this.getInt32(t+4,e),n=e?a:i,s=e?i:a,r=1-(s>>>31<<1),o=s>>20&2047;if(2047==o)return 0==n&&0==(1048575&s)?0<r?1/0:-1/0:NaN;var l=2220446049250313e-31*(4294967296*(1048575&s)+2147483648*(n>>>31)+(2147483647&n));return 0==o?l*=2:l+=1,r*l*Math.pow(2,o-1023)},setInt8:function(t,e){this.buf.a[t+this.offset]=e<0?e+128&255:255&e},setUint8:function(t,e){this.buf.a[t+this.offset]=255&e},setInt16:function(t,e,a){this.setUint16(t,e<0?e+65536:e,a)},setUint16:function(t,e,a){var i=t+this.offset;a?(this.buf.a[i++]=255&e,this.buf.a[i]=e>>8&255):(this.buf.a[i++]=e>>8&255,this.buf.a[i]=255&e)},setInt32:function(t,e,a){this.setUint32(t,e,a)},setUint32:function(t,e,a){var i=t+this.offset;a?(this.buf.a[i++]=255&e,this.buf.a[i++]=e>>8&255,this.buf.a[i++]=e>>16&255,this.buf.a[i++]=e>>>24):(this.buf.a[i++]=e>>>24,this.buf.a[i++]=e>>16&255,this.buf.a[i++]=e>>8&255,this.buf.a[i++]=255&e)},setFloat32:function(t,e,a){var i;if(0==e)i=0;else{var n=e<0?-e:e,s=Math.floor(Math.log(n)/.6931471805599453);127<s?i=2139095040:(s<=-127?(s=-127,n*=71362384635298e31):n=8388608*(n/Math.pow(2,s)-1),i=(e<0?-2147483648:0)|s+127<<23|Math.round(n))}this.setUint32(t,i,a)},setFloat64:function(t,e,a){var i=R.i64tmp;if(0==e)i.low=0,i.high=0;else if(isFinite(e)){var n=e<0?-e:e,s=Math.floor(Math.log(n)/.6931471805599453);if(1023<s)i.low=-1,i.high=2146435071;else{s<=-1023?(s=-1023,n/=22250738585072014e-324):n=n/Math.pow(2,s)-1;var r=Math.round(4503599627370496*n),o=0|r,l=r/4294967296|0;i.low=o,i.high=(e<0?-2147483648:0)|s+1023<<20|l}}else i.low=0,i.high=0<e?2146435072:-1048576;var _=i;a?(this.setUint32(t,_.low,!0),this.setUint32(t+4,_.high,!0)):(this.setUint32(t,_.high,!1),this.setUint32(t+4,_.low,!1))},__class__:Tt};var Vt=function(){};(i["js.html.compat.Float32Array"]=Vt).__name__=!0,Vt._new=function(t,e,a){var i;if("number"==typeof t){i=[];for(var n=0,s=t;n<s;){i[n++]=0}i.byteLength=i.length<<2;for(var r=[],o=i.byteOffset=0,l=i.length<<2;o<l;){o++;r.push(0)}i.buffer=new Dt(r)}else if(t instanceof Dt){var _=t;null==e&&(e=0),null==a&&(a=_.byteLength-e>>2),i=[];for(var h=0,f=a;h<f;){h++;var u=_.a[e++]|_.a[e++]<<8|_.a[e++]<<16|_.a[e++]<<24;i.push(R.i32ToFloat(u))}i.byteLength=i.length<<2,i.byteOffset=e,i.buffer=_}else{if(!(t instanceof Array&&null==t.__enum__))throw new Jt("TODO "+X.string(t));i=t.slice();for(var c=[],d=0;d<i.length;){var g=i[d];++d;var p=R.floatToI32(g);c.push(255&p),c.push(p>>8&255),c.push(p>>16&255),c.push(p>>>24)}i.byteLength=i.length<<2,i.byteOffset=0,i.buffer=new Dt(c)}return i.subarray=Vt._subarray,i.set=Vt._set,i},Vt._set=function(t,e){if(null==e&&(e=0),t.buffer instanceof Dt){var a=t;if(t.byteLength+e>this.byteLength)throw new Jt("set() outside of range");for(var i=0,n=t.byteLength;i<n;){var s=i++;this[s+e]=a[s]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new Jt("TODO");var r=t;if(r.length+e>this.byteLength)throw new Jt("set() outside of range");for(var o=0,l=r.length;o<l;){var _=o++;this[_+e]=r[_]}}},Vt._subarray=function(t,e){var a=Vt._new(this.slice(t,e));return a.byteOffset=4*t,a};var Kt=function(){};(i["js.html.compat.Uint8Array"]=Kt).__name__=!0,Kt._new=function(t,e,a){var i;if("number"==typeof t){i=[];for(var n=0,s=t;n<s;){i[n++]=0}i.byteLength=i.length,i.byteOffset=0,i.buffer=new Dt(i)}else if(t instanceof Dt){var r=t;null==e&&(e=0),null==a&&(a=r.byteLength-e),(i=0==e?r.a:r.a.slice(e,e+a)).byteLength=i.length,i.byteOffset=e,i.buffer=r}else{if(!(t instanceof Array&&null==t.__enum__))throw new Jt("TODO "+X.string(t));(i=t.slice()).byteLength=i.length,i.byteOffset=0,i.buffer=new Dt(i)}return i.subarray=Kt._subarray,i.set=Kt._set,i},Kt._set=function(t,e){if(null==e&&(e=0),t.buffer instanceof Dt){var a=t;if(t.byteLength+e>this.byteLength)throw new Jt("set() outside of range");for(var i=0,n=t.byteLength;i<n;){var s=i++;this[s+e]=a[s]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new Jt("TODO");var r=t;if(r.length+e>this.byteLength)throw new Jt("set() outside of range");for(var o=0,l=r.length;o<l;){var _=o++;this[_+e]=r[_]}}},Kt._subarray=function(t,e){var a=Kt._new(this.slice(t,e));return a.byteOffset=t,a};var jt=function(){this.names=[]};(i["kha._Assets.ImageList"]=jt).__name__=!0,jt.prototype={get:function(t){return Ft.field(this,t)},names:null,__class__:jt};var Rt=function(){this.names=[]};(i["kha._Assets.SoundList"]=Rt).__name__=!0,Rt.prototype={get:function(t){return Ft.field(this,t)},names:null,__class__:Rt};var Ht=function(){this.names=[]};(i["kha._Assets.BlobList"]=Ht).__name__=!0,Ht.prototype={get:function(t){return Ft.field(this,t)},names:null,__class__:Ht};var Pt=function(){this.names=[]};(i["kha._Assets.FontList"]=Pt).__name__=!0,Pt.prototype={get:function(t){return Ft.field(this,t)},names:null,__class__:Pt};var Qt=function(){this.names=[]};(i["kha._Assets.VideoList"]=Qt).__name__=!0,Qt.prototype={get:function(t){return Ft.field(this,t)},names:null,__class__:Qt};var qt=function(){};(i["kha.Assets"]=qt).__name__=!0,qt.__properties__={get_videoFormats:"get_videoFormats",get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_imageFormats:"get_imageFormats"},qt.loadEverything=function(t,e,a,i){for(var n=0,s=0,r=E.getInstanceFields(Ht);s<r.length;){var o=r[s];++s,O.endsWith(o,"Load")&&(n+=1)}for(var l=0,_=E.getInstanceFields(jt);l<_.length;){var h=_[l];++l,O.endsWith(h,"Load")&&(n+=1)}for(var f=0,u=E.getInstanceFields(Rt);f<u.length;){var c=u[f];++f,O.endsWith(c,"Load")&&(n+=1)}for(var d=0,g=E.getInstanceFields(Pt);d<g.length;){var p=g[d];++d,O.endsWith(p,"Load")&&(n+=1)}for(var m=0,v=E.getInstanceFields(Qt);m<v.length;){var b=v[m];++m,O.endsWith(b,"Load")&&(n+=1)}if(0!=n){for(var I=n,M=function(){I-=1,qt.progress=1-I/n,0==I&&t()},y=0,w=E.getInstanceFields(Ht);y<w.length;){var x=w[y];if(++y,O.endsWith(x,"Load")){var C=q.substr(x,0,x.length-4),A=Ft.field(qt.blobs,C+"Description");null==e||e(A)?Ft.field(qt.blobs,x)(M,function(t){if(null==i);M()}):M()}}for(var Z=0,z=E.getInstanceFields(jt);Z<z.length;){var B=z[Z];if(++Z,O.endsWith(B,"Load")){var k=q.substr(B,0,B.length-4),S=Ft.field(qt.images,k+"Description");null==e||e(S)?Ft.field(qt.images,B)(M,function(t){if(null==i);M()}):M()}}for(var X=0,Y=E.getInstanceFields(Rt);X<Y.length;){var N=[Y[X]];if(++X,O.endsWith(N[0],"Load")){var L=q.substr(N[0],0,N[0].length-4),G=[Ft.field(qt.sounds,L+"Description")];null==e||e(G[0])?Ft.field(qt.sounds,N[0])(function(t,e){return function(){null==a||a(t[0])?Ft.field(qt.sounds,e[0].substring(0,e[0].length-4)).uncompress(M):M()}}(G,N),null!=i?i:function(e,a){return function(t){a[0](t,e[0])}}([{fileName:"kha/Assets.hx",lineNumber:172,className:"kha.Assets",methodName:"loadEverything"}],[Fe.trace])):M()}}for(var W=0,D=E.getInstanceFields(Pt);W<D.length;){var T=D[W];if(++W,O.endsWith(T,"Load")){var V=q.substr(T,0,T.length-4),K=Ft.field(qt.fonts,V+"Description");null==e||e(K)?Ft.field(qt.fonts,T)(M,function(t){if(null==i);M()}):M()}}for(var j=0,R=E.getInstanceFields(Qt);j<R.length;){var H=R[j];if(++j,O.endsWith(H,"Load")){var P=q.substr(H,0,H.length-4),F=Ft.field(qt.videos,P+"Description");null==e||e(F)?Ft.field(qt.videos,H)(M,function(t){if(null==i);M()}):M()}}}else t()},qt.loadImage=function(e,a,t,i){var n,s=Ft.field(qt.images,e+"Description");if(null!=t)n=t;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadImageFromDescription(s,function(t){qt.images[e]=t,a(t)},n)},qt.loadImageFromPath=function(t,e,a,i,n){var s,r={files:[t],readable:e};if(null!=i)s=i;else{var o=Fe.trace,l=n;s=function(t){o(t,l)}}fe.loadImageFromDescription(r,a,s)},qt.get_imageFormats=function(){return fe.getImageFormats()},qt.loadBlob=function(e,a,t,i){var n,s=Ft.field(qt.blobs,e+"Description");if(null!=t)n=t;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadBlobFromDescription(s,function(t){qt.blobs[e]=t,a(t)},n)},qt.loadBlobFromPath=function(t,e,a,i){var n,s={files:[t]};if(null!=a)n=a;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadBlobFromDescription(s,e,n)},qt.loadSound=function(e,a,t,i){var n,s=Ft.field(qt.sounds,e+"Description");if(null!=t)n=t;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadSoundFromDescription(s,function(t){qt.sounds[e]=t,a(t)},n)},qt.loadSoundFromPath=function(t,e,a,i){var n,s={files:[t]};if(null!=a)n=a;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadSoundFromDescription(s,e,n)},qt.get_soundFormats=function(){return fe.getSoundFormats()},qt.loadFont=function(e,a,t,i){var n,s=Ft.field(qt.fonts,e+"Description");if(null!=t)n=t;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadFontFromDescription(s,function(t){qt.fonts[e]=t,a(t)},n)},qt.loadFontFromPath=function(t,e,a,i){var n,s={files:[t]};if(null!=a)n=a;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadFontFromDescription(s,e,n)},qt.get_fontFormats=function(){return["ttf"]},qt.loadVideo=function(e,a,t,i){var n,s=Ft.field(qt.videos,e+"Description");if(null!=t)n=t;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadVideoFromDescription(s,function(t){qt.videos[e]=t,a(t)},n)},qt.loadVideoFromPath=function(t,e,a,i){var n,s={files:[t]};if(null!=a)n=a;else{var r=Fe.trace,o=i;n=function(t){r(t,o)}}fe.loadVideoFromDescription(s,e,n)},qt.get_videoFormats=function(){return fe.getVideoFormats()},qt.reporter=function(t,e){if(null!=t)return t;var a=Fe.trace,i=e;return function(t){a(t,i)}};var $t=function(){};(i["kha.Canvas"]=$t).__name__=!0,$t.prototype={get_g4:null,get_height:null,get_width:null,__class__:$t,__properties__:{get_width:"get_width",get_height:"get_height",get_g4:"get_g4"}};var te=function(){};(i["kha.Resource"]=te).__name__=!0;var ee=function(){};(i["kha.Image"]=ee).__name__=!0,ee.__interfaces__=[te,$t],ee.__properties__={get_nonPow2Supported:"get_nonPow2Supported"},ee.create=function(t,e,a,i){return null==a&&(a=Va.RGBA32),null==i&&(i=ja.StaticUsage),null==ve.gl?new ae(t,e,a,!1):new Me(t,e,a,!1,0,1)},ee.create3D=function(t,e,a,i,n){return null},ee.createRenderTarget=function(t,e,a,i,n,s){return null==s&&(s=0),null==n&&(n=1),null==i&&(i=0),null==a&&(a=Va.RGBA32),null==ve.gl?new ae(t,e,a,!0):new Me(t,e,a,!0,i,n)},ee.fromImage=function(t,e){if(null==ve.gl){var a=new ae(t.width,t.height,Va.RGBA32,!1);return a.image=t,a.createTexture(),a}var i=new Me(t.width,t.height,Va.RGBA32,!1,0,1);return i.image=t,i.createTexture(),i},ee.fromBytes=function(t,e,a,i,n){if(null==i&&(i=Va.RGBA32),null==n&&(n=ja.StaticUsage),null!=ve.gl){var s=new Me(e,a,i,!1,0,1);return s.image=s.bytesToArray(t),s.createTexture(),s}return null},ee.fromVideo=function(t){if(null==ve.gl){var e=new ae(t.element.videoWidth,t.element.videoHeight,Va.RGBA32,!1);return e.video=t.element,e.createTexture(),e}var a=new Me(t.element.videoWidth,t.element.videoHeight,Va.RGBA32,!1,0,1);return a.video=t.element,a.createTexture(),a},ee.get_nonPow2Supported=function(){return null!=ve.gl},ee.prototype={unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},generateMipmaps:function(t){},setMipmaps:function(t){},setDepthStencilFrom:function(t){},get_width:function(){return 0},get_height:function(){return 0},get_depth:function(){return 1},get_g4:function(){return null},__class__:ee,__properties__:{get_g4:"get_g4",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var ae=function(t,e,a,i){this.myWidth=t,this.myHeight=e,this.format=a,this.renderTarget=i,this.image=null,this.video=null,i&&this.createTexture()};(i["kha.CanvasImage"]=ae).__name__=!0,ae.init=function(){var t=window.document.createElement("canvas");null!=t&&(ae.context=t.getContext("2d"),t.width=2048,t.height=2048,ae.context.globalCompositeOperation="copy")},ae.__super__=ee,ae.prototype=s(ee.prototype,{image:null,video:null,data:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},texture:null,createTexture:function(){null!=ve.gl&&(this.texture=ve.gl.createTexture(),ve.gl.bindTexture(3553,this.texture),ve.gl.texParameteri(3553,10240,9729),ve.gl.texParameteri(3553,10241,9729),ve.gl.texParameteri(3553,10242,33071),ve.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=ve.gl.createFramebuffer(),ve.gl.bindFramebuffer(36160,this.frameBuffer),ve.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),ve.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),ve.gl.bindFramebuffer(36160,null)):null!=this.video?ve.gl.texImage2D(3553,0,6408,6408,5121,this.video):ve.gl.texImage2D(3553,0,6408,6408,5121,this.image),ve.gl.bindTexture(3553,null))},bytes:null,lock:function(t){return null==t&&(t=0),this.bytes=new nt(new us(this.format==Va.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=ve.gl){if(this.texture=ve.gl.createTexture(),ve.gl.bindTexture(3553,this.texture),ve.gl.texParameteri(3553,10240,9729),ve.gl.texParameteri(3553,10241,9729),ve.gl.texParameteri(3553,10242,33071),ve.gl.texParameteri(3553,10243,33071),ve.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new gs(this.bytes.b.bufferValue)),1282==ve.gl.getError()){for(var t=new nt(new us(this.get_width()*this.get_height()*4)),e=0,a=this.get_height();e<a;)for(var i=e++,n=0,s=this.get_width();n<s;){var r=n++,o=this.bytes,l=i*this.get_width()+r,_=o.b[l],h=i*this.get_width()*4+4*r;t.b[h]=255&_;var f=i*this.get_width()*4+4*r+1;t.b[f]=255&_;var u=i*this.get_width()*4+4*r+2;t.b[u]=255&_;var c=i*this.get_width()*4+4*r+3;t.b[c]=255}ve.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new gs(t.b.bufferValue))}ve.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:ae});var ie=t.kha._Color.Color_Impl_={};(i["kha._Color.Color_Impl_"]=ie).__name__=!0,ie.fromBytes=function(t,e,a,i){return null==i&&(i=255),ie._new(i<<24|t<<16|e<<8|a)},ie.fromFloats=function(t,e,a,i){return null==i&&(i=1),ie._new((255*i|0)<<24|(255*t|0)<<16|(255*e|0)<<8|255*a|0)},ie._new=function(t){return t};var ne=function(){};(i["kha.CompilerDefines"]=ne).__name__=!0;var se=function(){};(i["kha.Display"]=se).__name__=!0,se.__properties__={get_primary:"get_primary"},se.get_primary=function(){return se.instance},se.prototype={get_frequency:function(){return 60},__class__:se,__properties__:{get_frequency:"get_frequency"}};var re=function(){};(i["kha.DisplayMode"]=re).__name__=!0;var oe=function(t,e,a,i){this.window=t,this.graphics1=e,this.graphics2=a,this.graphics4=i};(i["kha.Framebuffer"]=oe).__name__=!0,oe.__interfaces__=[$t],oe.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(t,e,a){this.graphics1=t,this.graphics2=e,this.graphics4=a},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return co.windowWidth(this.window)},get_height:function(){return co.windowHeight(this.window)},__class__:oe,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2"}};var le=function(t,e,a,i,n,s){null==s&&(s=1),null==n&&(n=8),null==i&&(i=16),null==a&&(a=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=a,this.depthBufferBits=i,this.stencilBufferBits=n,this.samplesPerPixel=s};(i["kha.FramebufferOptions"]=le).__name__=!0,le.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:le};var _e=function(t,e,a,i,n,s,r,o){this.mySize=t,this.width=n,this.height=s,this.chars=r,this.baseline=e;for(var l=0;l<r.length;){var _=r[l];++l,_.yoff+=this.baseline}this.texture=ee.create(n,s,Va.L8);for(var h=this.texture.lock(),f=0,u=0,c=s;u<c;){u++;for(var d=0,g=n;d<g;){d++;var p=o.readU8(f);h.b[f]=255&p,++f}}this.texture.unlock()};(i["kha.KravurImage"]=_e).__name__=!0,_e.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=_e.gaps[0];if(t<e)return this.chars[0].xadvance;for(var a=1,i=_e.gaps.length/2|0;a<i;){var n=a++,s=_e.gaps[2*n-1],r=_e.gaps[2*n];r-1<t&&(e+=r-1-s)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=new String(t),a=0,i=0,n=e.length;i<n;){var s=i++;a+=this.getCharWidth(q.cca(e,s))}return a},charactersWidth:function(t,e,a){for(var i=0,n=e,s=e+a;n<s;){var r=n++;i+=this.getCharWidth(t[r])}return i},getBaselinePosition:function(){return this.baseline},__class__:_e};var he=function(t){this.images=new $,this.blob=t};(i["kha.Kravur"]=he).__name__=!0,he.__interfaces__=[te],he.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t,e){if(null==e&&(e=aa.fontGlyphs),e!=this.oldGlyphs){this.oldGlyphs=e;for(var a=(_e.gaps=[e[0]])[0]+1,i=1,n=e.length;i<n;){var s=i++;e[s]!=a?(_e.gaps.push(e[s-1]),_e.gaps.push(e[s]),a=e[s]+1):++a}_e.gaps.push(e[e.length-1])}var r=null==e?t:1e4*t+e.length;if(!this.images.h.hasOwnProperty(r)){for(var o=64,l=32,_=new Array(e.length),h=0,f=_.length;h<f;){_[h++]=new _a}for(var u=null,c=-1;c<=0;)l<o?l*=2:o*=2,u=ti.alloc(o*l),c=ma.stbtt_BakeFontBitmap(this.blob,0,t,u,o,l,e,_);var d=new ha;ma.stbtt_InitFont(d,this.blob,0);var g=ma.stbtt_GetFontVMetrics(d),p=ma.stbtt_ScaleForPixelHeight(d,t),m=Math.round(g.ascent*p),v=Math.round(g.descent*p),b=Math.round(g.lineGap*p),I=new _e(0|t,m,v,b,o,l,_,u);return this.images.h[r]=I}return this.images.h[r]},__class__:he};var fe=function(){};(i["kha.LoaderImpl"]=fe).__name__=!0,fe.getImageFormats=function(){return["png","jpg","hdr"]},fe.loadImageFromDescription=function(e,i,a){var n=Object.prototype.hasOwnProperty.call(e,"readable")&&e.readable;if(O.endsWith(e.files[0],".hdr"))fe.loadBlobFromDescription(e,function(t){var e=ei.parse(t.toBytes()),a=ee.fromBytes(nt.ofData(e.data.buffer),e.width,e.height,Va.RGBA128,n?ja.DynamicUsage:ja.StaticUsage);i(a)},a);else{var s=window.document.createElement("img");s.onerror=function(t){a({url:e.files[0],error:t})},s.onload=function(t){var e=ee.fromImage(s,n);i(e)},s.src=e.files[0],s.crossOrigin=""}},fe.getSoundFormats=function(){var t=window.document.createElement("audio"),e=[];return""!=t.canPlayType("audio/mp4")&&e.push("mp4"),""!=t.canPlayType("audio/mp3")&&e.push("mp3"),(ve._hasWebAudio||""!=t.canPlayType("audio/ogg"))&&e.push("ogg"),e},fe.loadSoundFromDescription=function(t,e,a){if(ve._hasWebAudio){var i=window.document.createElement("audio");if(""!=i.canPlayType("audio/mp4"))for(var n=0,s=t.files.length;n<s;){var r=n++,o=t.files[r];if(O.endsWith(o,".mp4"))return void new fi(o,e,a)}if(""!=i.canPlayType("audio/mp3"))for(var l=0,_=t.files.length;l<_;){var h=l++,f=t.files[h];if(O.endsWith(f,".mp3"))return void new fi(f,e,a)}for(var u=0,c=t.files.length;u<c;){var d=u++,g=t.files[d];if(O.endsWith(g,".ogg"))return void new fi(g,e,a)}}else if(ve.mobile){var p=window.document.createElement("audio");if(""!=p.canPlayType("audio/mp4"))for(var m=0,v=t.files.length;m<v;){var b=m++,I=t.files[b];if(O.endsWith(I,".mp4"))return void new li(I,e,a)}if(""!=p.canPlayType("audio/mp3"))for(var M=0,y=t.files.length;M<y;){var w=M++,x=t.files[w];if(O.endsWith(x,".mp3"))return void new li(x,e,a)}for(var C=0,A=t.files.length;C<A;){var Z=C++,z=t.files[Z];if(O.endsWith(z,".ogg"))return void new li(z,e,a)}}else new _i(t.files,e,a)},fe.getVideoFormats=function(){return["mp4","webm"]},fe.loadVideoFromDescription=function(t,e,a){hi.fromFile(t.files,e)},fe.loadRemote=function(o,l,_){var h=new XMLHttpRequest;h.open("GET",o.files[0],!0),h.responseType="arraybuffer",h.onreadystatechange=function(){if(4==h.readyState)if(200<=h.status&&h.status<400||0==h.status&&""==h.statusText){var t=null,e=h.response;if(null!=e){var a=new gs(e);t=nt.ofData(a)}else{if(null==h.responseBody)return void _({url:o.files[0]});var i=VBArray(h.responseBody).toArray();t=new nt(new us(i.length));for(var n=0,s=i.length;n<s;){var r=n++;t.b[r]=255&i[r]}}l(new ti(t))}else _({url:o.files[0]})},h.send(null)},fe.loadBlobFromDescription=function(t,e,a){fe.loadRemote(t,e,a)},fe.loadFontFromDescription=function(t,e,a){fe.loadBlobFromDescription(t,function(t){e(new he(t))},a)};var ue=function(){};(i["kha.TimeTask"]=ue).__name__=!0,ue.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:ue};var ce=function(t,e,a){this.task=t,this.priority=e,this.id=a,this.active=!0,this.paused=!1};(i["kha.FrameTask"]=ce).__name__=!0,ce.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:ce};var uo=function(){};(i["kha.Scheduler"]=uo).__name__=!0,uo.init=function(){uo.deltas=[];for(var t=0,e=uo.DIF_COUNT;t<e;){var a=t++;uo.deltas[a]=0}uo.stopped=!0,uo.frame_tasks_sorted=!0,uo.current=uo.lastTime=uo.realTime(),uo.currentFrameTaskId=0,uo.currentTimeTaskId=0,uo.currentGroupId=0,uo.timeTasks=[],uo.pausedTimeTasks=[],uo.outdatedTimeTasks=[],uo.timeTasksScratchpad=[],uo.frameTasks=[],uo.toDeleteFrame=[]},uo.start=function(t){null==t&&(t=!1),uo.vsync=ye.get(0).get_vSynced();var e=se.get_primary().get_frequency();57<=e&&e<=63&&(e=60),uo.onedifhz=1/e,uo.stopped=!1,uo.resetTime(),uo.lastTime=uo.realTime()-uo.startTime;for(var a=0,i=uo.DIF_COUNT;a<i;){var n=a++;uo.deltas[n]=0}if(t){for(var s=0,r=uo.timeTasks;s<r.length;){var o=r[s];++s,o.paused=!1}for(var l=0,_=uo.frameTasks;l<_.length;){var h=_[l];++l,h.paused=!1}}},uo.executeFrame=function(){var t=uo.realTime()-uo.startTime-uo.lastTime,e=uo.current;if(0<=t){if(null==Ii.the())if(t>uo.maxframetime)uo.startTime+=t-uo.maxframetime,e+=t=uo.maxframetime;else if(uo.vsync){for(var a=uo.onedifhz;a<t-uo.onedifhz;)a+=uo.onedifhz;t=a;for(var i=0,n=uo.DIF_COUNT-2;i<n;){var s=i++;t+=uo.deltas[s],uo.deltas[s]=uo.deltas[s+1]}t+=uo.deltas[uo.DIF_COUNT-2],t/=uo.DIF_COUNT,uo.deltas[uo.DIF_COUNT-2]=a,e+=t}else{for(var r=0,o=uo.DIF_COUNT-1;r<o;){var l=r++;uo.deltas[l]=uo.deltas[l+1]}uo.deltas[uo.DIF_COUNT-1]=t;for(var _=0,h=0,f=uo.DIF_COUNT;h<f;){var u=h++;_+=uo.deltas[u]}e+=_/=uo.DIF_COUNT}else e+=t;uo.lastTime=e,uo.stopped||(uo.current=e);for(var c=0,d=uo.pausedTimeTasks;c<d.length;){var g=d[c];++c,g.next+=t}if(uo.stopped)for(var p=0,m=uo.timeTasks;p<m.length;){var v=m[p];++p,v.next+=t}uo.executeTimeTasks(e);for(var b=0,I=uo.outdatedTimeTasks;b<I.length;){var M=I[b];++b,M.next<e-10&&uo.timeTasksScratchpad.push(M)}for(var y=0,w=uo.timeTasksScratchpad;y<w.length;){var x=w[y];++y,q.remove(uo.outdatedTimeTasks,x)}for(;0<uo.timeTasksScratchpad.length;)q.remove(uo.timeTasksScratchpad,uo.timeTasksScratchpad[0])}uo.sortFrameTasks();for(var C=0,A=uo.frameTasks;C<A.length;){var Z=A[C];++C,uo.stopped||Z.paused||!Z.active||Z.task()||(Z.active=!1)}for(var z=0,B=uo.frameTasks;z<B.length;){var k=B[z];++z,k.active||uo.toDeleteFrame.push(k)}for(;0<uo.toDeleteFrame.length;)q.remove(uo.frameTasks,uo.toDeleteFrame.pop())},uo.executeTimeTasks=function(t){for(;0<uo.timeTasks.length&&(uo.activeTimeTask=uo.timeTasks[0],uo.activeTimeTask.next<=t);)uo.activeTimeTask.next+=uo.activeTimeTask.period,q.remove(uo.timeTasks,uo.activeTimeTask),uo.activeTimeTask.active&&uo.activeTimeTask.task()?0<uo.activeTimeTask.period&&(0==uo.activeTimeTask.duration||uo.activeTimeTask.duration>=uo.activeTimeTask.start+uo.activeTimeTask.next)?uo.insertSorted(uo.timeTasks,uo.activeTimeTask):uo.archiveTimeTask(uo.activeTimeTask,t):(uo.activeTimeTask.active=!1,uo.archiveTimeTask(uo.activeTimeTask,t));uo.activeTimeTask=null},uo.archiveTimeTask=function(t,e){},uo.time=function(){return uo.current},uo.realTime=function(){return co.get_time()},uo.resetTime=function(){var t=co.get_time(),e=t-uo.startTime;uo.startTime=t;for(var a=0,i=uo.timeTasks;a<i.length;){var n=i[a];++a,n.start-=e,n.next-=e}for(var s=0,r=uo.DIF_COUNT;s<r;){var o=s++;uo.deltas[o]=0}uo.current=0,uo.lastTime=0},uo.addBreakableTimeTaskToGroup=function(t,e,a,i,n){null==n&&(n=0),null==i&&(i=0);var s=new ue;return s.active=!0,s.task=e,s.id=++uo.currentTimeTaskId,s.groupId=t,s.start=uo.current+a,(s.period=0)!=i&&(s.period=i),(s.duration=0)!=n&&(s.duration=s.start+n),s.next=s.start,uo.insertSorted(uo.timeTasks,s),s.id},uo.addTimeTaskToGroup=function(t,e,a,i,n){return null==n&&(n=0),null==i&&(i=0),uo.addBreakableTimeTaskToGroup(t,function(){return e(),!0},a,i,n)},uo.addTimeTask=function(t,e,a,i){return null==i&&(i=0),null==a&&(a=0),uo.addTimeTaskToGroup(0,t,e,a,i)},uo.insertSorted=function(t,e){for(var a=0,i=t.length;a<i;){var n=a++;if(t[n].next>e.next)return void t.splice(n,0,e)}t.push(e)},uo.sortFrameTasks=function(){uo.frame_tasks_sorted||(uo.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),uo.frame_tasks_sorted=!0)};I["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:n},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:n},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:n},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:n}};var de=function(){};(i["kha.Shaders"]=de).__name__=!0,de.init=function(){for(var t=[],e=0;e<3;){var a=e++,i=Ft.field(de,"Blue_shadowmap_fragData"+a),n=Ut.run(i);t.push(ti.fromBytes(n))}de.Blue_shadowmap_frag=new xa(t,["Blue_shadowmap.frag.essl","Blue_shadowmap-relaxed.frag.essl","Blue_shadowmap-webgl2.frag.essl"]);for(var s=[],r=0;r<3;){var o=r++,l=Ft.field(de,"Blue_mesh_vertData"+o),_=Ut.run(l);s.push(ti.fromBytes(_))}de.Blue_mesh_vert=new Pa(s,["Blue_mesh.vert.essl","Blue_mesh-relaxed.vert.essl","Blue_mesh-webgl2.vert.essl"]);for(var h=[],f=0;f<3;){var u=f++,c=Ft.field(de,"Blue_mesh_fragData"+u),d=Ut.run(c);h.push(ti.fromBytes(d))}de.Blue_mesh_frag=new xa(h,["Blue_mesh.frag.essl","Blue_mesh-relaxed.frag.essl","Blue_mesh-webgl2.frag.essl"]);for(var g=[],p=0;p<3;){var m=p++,v=Ft.field(de,"Blue_shadowmap_vertData"+m),b=Ut.run(v);g.push(ti.fromBytes(b))}de.Blue_shadowmap_vert=new Pa(g,["Blue_shadowmap.vert.essl","Blue_shadowmap-relaxed.vert.essl","Blue_shadowmap-webgl2.vert.essl"]);for(var I=[],M=0;M<3;){var y=M++,w=Ft.field(de,"Material_001_mesh_vertData"+y),x=Ut.run(w);I.push(ti.fromBytes(x))}de.Material_001_mesh_vert=new Pa(I,["Material_001_mesh.vert.essl","Material_001_mesh-relaxed.vert.essl","Material_001_mesh-webgl2.vert.essl"]);for(var C=[],A=0;A<3;){var Z=A++,z=Ft.field(de,"Material_001_mesh_fragData"+Z),B=Ut.run(z);C.push(ti.fromBytes(B))}de.Material_001_mesh_frag=new xa(C,["Material_001_mesh.frag.essl","Material_001_mesh-relaxed.frag.essl","Material_001_mesh-webgl2.frag.essl"]);for(var k=[],S=0;S<3;){var X=S++,Y=Ft.field(de,"Material_003_mesh_fragData"+X),N=Ut.run(Y);k.push(ti.fromBytes(N))}de.Material_003_mesh_frag=new xa(k,["Material_003_mesh.frag.essl","Material_003_mesh-relaxed.frag.essl","Material_003_mesh-webgl2.frag.essl"]);for(var L=[],G=0;G<3;){var W=G++,D=Ft.field(de,"Plane_001_mesh_fragData"+W),T=Ut.run(D);L.push(ti.fromBytes(T))}de.Plane_001_mesh_frag=new xa(L,["Plane_001_mesh.frag.essl","Plane_001_mesh-relaxed.frag.essl","Plane_001_mesh-webgl2.frag.essl"]);for(var V=[],K=0;K<3;){var j=K++,R=Ft.field(de,"compositor_pass_vertData"+j),H=Ut.run(R);V.push(ti.fromBytes(H))}de.compositor_pass_vert=new Pa(V,["compositor_pass.vert.essl","compositor_pass-relaxed.vert.essl","compositor_pass-webgl2.vert.essl"]);for(var P=[],F=0;F<3;){var O=F++,E=Ft.field(de,"Wall_mesh_fragData"+O),U=Ut.run(E);P.push(ti.fromBytes(U))}de.Wall_mesh_frag=new xa(P,["Wall_mesh.frag.essl","Wall_mesh-relaxed.frag.essl","Wall_mesh-webgl2.frag.essl"]);for(var J=[],Q=0;Q<3;){var q=Q++,$=Ft.field(de,"compositor_pass_fragData"+q),tt=Ut.run($);J.push(ti.fromBytes(tt))}de.compositor_pass_frag=new xa(J,["compositor_pass.frag.essl","compositor_pass-relaxed.frag.essl","compositor_pass-webgl2.frag.essl"]);for(var et=[],at=0;at<3;){var it=at++,nt=Ft.field(de,"Red_mesh_fragData"+it),st=Ut.run(nt);et.push(ti.fromBytes(st))}de.Red_mesh_frag=new xa(et,["Red_mesh.frag.essl","Red_mesh-relaxed.frag.essl","Red_mesh-webgl2.frag.essl"]);for(var rt=[],ot=0;ot<3;){var lt=ot++,_t=Ft.field(de,"painter_colored_fragData"+lt),ht=Ut.run(_t);rt.push(ti.fromBytes(ht))}de.painter_colored_frag=new xa(rt,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);for(var ft=[],ut=0;ut<3;){var ct=ut++,dt=Ft.field(de,"painter_image_fragData"+ct),gt=Ut.run(dt);ft.push(ti.fromBytes(gt))}de.painter_image_frag=new xa(ft,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);for(var pt=[],mt=0;mt<3;){var vt=mt++,bt=Ft.field(de,"painter_text_fragData"+vt),It=Ut.run(bt);pt.push(ti.fromBytes(It))}de.painter_text_frag=new xa(pt,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);for(var Mt=[],yt=0;yt<3;){var wt=yt++,xt=Ft.field(de,"painter_image_vertData"+wt),Ct=Ut.run(xt);Mt.push(ti.fromBytes(Ct))}de.painter_image_vert=new Pa(Mt,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);for(var At=[],Zt=0;Zt<3;){var zt=Zt++,Bt=Ft.field(de,"painter_text_vertData"+zt),kt=Ut.run(Bt);At.push(ti.fromBytes(kt))}de.painter_text_vert=new Pa(At,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);for(var St=[],Xt=0;Xt<3;){var Yt=Xt++,Nt=Ft.field(de,"painter_video_fragData"+Yt),Lt=Ut.run(Nt);St.push(ti.fromBytes(Lt))}de.painter_video_frag=new xa(St,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);for(var Gt=[],Wt=0;Wt<3;){var Dt=Wt++,Tt=Ft.field(de,"painter_video_vertData"+Dt),Vt=Ut.run(Tt);Gt.push(ti.fromBytes(Vt))}de.painter_video_vert=new Pa(Gt,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"]);for(var Kt=[],jt=0;jt<3;){var Rt=jt++,Ht=Ft.field(de,"painter_colored_vertData"+Rt),Pt=Ut.run(Ht);Kt.push(ti.fromBytes(Pt))}de.painter_colored_vert=new Pa(Kt,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"])};var ge=function(){};(i["kha.Sound"]=ge).__name__=!0,ge.__interfaces__=[te],ge.prototype={compressedData:null,uncompressedData:null,uncompress:function(t){if(null==this.uncompressedData){var e=new rt,a=Xe.readAll(this.compressedData,e,!0),i=e.getBytes(),n=i.length/4|0;if(1==a.channel){var s=new ds(2*n);this.uncompressedData=s;for(var r=0,o=n;r<o;){var l=r++;this.uncompressedData[2*l]=i.getFloat(4*l),this.uncompressedData[2*l+1]=i.getFloat(4*l)}}else{var _=new ds(n);this.uncompressedData=_;for(var h=0,f=n;h<f;){var u=h++;this.uncompressedData[u]=i.getFloat(4*u)}}this.compressedData=null,t()}else t()},__class__:ge};var pe=function(t,e,a,i,n){null==a&&(a=600),null==e&&(e=800),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=600,this.width=800,this.title="Kha",this.title=t,this.width=e,this.height=a,this.window=null==i?new we(null,null,null,null,null,null,null,null,null):i,this.framebuffer=null==n?new le(null,null,null,null,null,null):n};(i["kha.SystemOptions"]=pe).__name__=!0,pe.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:pe};var co=function(){};(i["kha.System"]=co).__name__=!0,co.__properties__={get_time:"get_time"},co.start=function(t,e){co.theTitle=t.title,ve.init(t,e)},co.notifyOnFrames=function(t){co.renderListeners.push(t)},co.render=function(t){for(var e=0,a=co.renderListeners;e<a.length;){var i=a[e];++e,i(t)}},co.foreground=function(){for(var t=0,e=co.foregroundListeners;t<e.length;){var a=e[t];++t,a()}},co.background=function(){for(var t=0,e=co.backgroundListeners;t<e.length;){var a=e[t];++t,a()}},co.get_time=function(){return ve.getTime()},co.windowWidth=function(t){return null==t&&(t=0),ye.get(t).get_width()},co.windowHeight=function(t){return null==t&&(t=0),ye.get_all()[t].get_height()};var me=function(){this.axes=[],this.buttons=[]};(i["kha.GamepadStates"]=me).__name__=!0,me.prototype={axes:null,buttons:null,__class__:me};var ve=function(){};(i["kha.SystemImpl"]=ve).__name__=!0,ve.init=function(t,e){ve.options=t,ve.mobile=ve.isMobile(),ve.ios=ve.isIOS(),ve.chrome=ve.isChrome(),ve.firefox=ve.isFirefox(),ve.ie=ve.isIE(),ve.init2(t.window.width,t.window.height),e(ve.window)},ve.isMobile=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("Android")||0<=t.indexOf("webOS")||0<=t.indexOf("BlackBerry")||0<=t.indexOf("Windows Phone")||!!ve.isIOS()},ve.isIOS=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("iPhone")||0<=t.indexOf("iPad")||0<=t.indexOf("iPod")},ve.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},ve.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},ve.isIE=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("MSIE ")||0<=t.indexOf("Trident/")},ve.setCanvas=function(t){ve.khanvas=t},ve.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},ve.init2=function(t,e,a){ve.keyboard=new Ua,ve.mouse=new Qa,ve.surface=new $a,ve.gamepads=[],ve.gamepadStates=[];for(var i=0;i<4;){var n=i++;ve.gamepads[n]=new Oa(n),ve.gamepadStates[n]=new me}if(window.addEventListener("gamepadconnected",function(t){Oa.sendConnectEvent(t.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(t){Oa.sendDisconnectEvent(t.gamepad.index)}),ve.ie){ve.pressedKeys=[];for(var s=0;s<256;){s++;ve.pressedKeys.push(!1)}for(var r=0;r<256;){r++;ve.pressedKeys.push(null)}}window.document.addEventListener("copy",function(t){var e=t;if(null!=co.copyListener){var a=co.copyListener();null!=a&&e.clipboardData.setData("text/plain",a),e.preventDefault()}}),window.document.addEventListener("cut",function(t){var e=t;if(null!=co.cutListener){var a=co.cutListener();null!=a&&e.clipboardData.setData("text/plain",a),e.preventDefault()}}),window.document.addEventListener("paste",function(t){var e=t;if(null!=co.pasteListener){var a=e.clipboardData.getData("text/plain");co.pasteListener(a),e.preventDefault()}}),ae.init(),uo.init(),ve.loadFinished(t,e)},ve.getMouse=function(t){return 0!=t?null:ve.mouse},ve.getKeyboard=function(t){return 0!=t?null:ve.keyboard},ve.checkGamepad=function(t){for(var e=0,a=t.axes.length;e<a;){var i=e++;if(null!=t.axes[i]){var n=t.axes[i];i%2==1&&(n=-n),ve.gamepadStates[t.index].axes[i]!=n&&(ve.gamepadStates[t.index].axes[i]=n,ve.gamepads[t.index].sendAxisEvent(i,n))}}for(var s=0,r=t.buttons.length;s<r;){var o=s++;null!=t.buttons[o]&&ve.gamepadStates[t.index].buttons[o]!=t.buttons[o].value&&(ve.gamepadStates[t.index].buttons[o]=t.buttons[o].value,ve.gamepads[t.index].sendButtonEvent(o,t.buttons[o].value))}t.axes.length<=4&&7<t.buttons.length&&(ve.gamepadStates[t.index].axes[4]=t.buttons[6].value,ve.gamepads[t.index].sendAxisEvent(4,t.buttons[6].value),ve.gamepadStates[t.index].axes[5]=t.buttons[7].value,ve.gamepads[t.index].sendAxisEvent(5,t.buttons[7].value))},ve.loadFinished=function(t,e){var l=ve.khanvas;null==l&&(l=window.document.getElementById(ne.canvas_id));var a=!(l.style.cursor="default");try{ve.gl=l.getContext("webgl2",{alpha:!1,antialias:1<ve.options.framebuffer.samplesPerPixel,stencil:!0}),ve.gl.pixelStorei(37441,1),ve.halfFloat={HALF_FLOAT_OES:5131},ve.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},ve.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},ve.elementIndexUint=!0,ve.gl.getExtension("EXT_color_buffer_float"),ve.gl.getExtension("OES_texture_float_linear"),ve.gl.getExtension("OES_texture_half_float_linear"),ve.anisotropicFilter=ve.gl.getExtension("EXT_texture_filter_anisotropic"),null==ve.anisotropicFilter&&(ve.anisotropicFilter=ve.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),a=!0,ve.gl2=!0,de.init()}catch(t){t instanceof Jt&&t.val;Fe.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"kha/SystemImpl.hx",lineNumber:314,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!ve.gl2)try{ve.gl=l.getContext("experimental-webgl",{alpha:!1,antialias:1<ve.options.framebuffer.samplesPerPixel,stencil:!0}),null!=ve.gl&&(ve.gl.pixelStorei(37441,1),ve.gl.getExtension("OES_texture_float"),ve.gl.getExtension("OES_texture_float_linear"),ve.halfFloat=ve.gl.getExtension("OES_texture_half_float"),ve.gl.getExtension("OES_texture_half_float_linear"),ve.depthTexture=ve.gl.getExtension("WEBGL_depth_texture"),ve.gl.getExtension("EXT_shader_texture_lod"),ve.gl.getExtension("OES_standard_derivatives"),ve.anisotropicFilter=ve.gl.getExtension("EXT_texture_filter_anisotropic"),null==ve.anisotropicFilter&&(ve.anisotropicFilter=ve.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),ve.drawBuffers=ve.gl.getExtension("WEBGL_draw_buffers"),ve.elementIndexUint=ve.gl.getExtension("OES_element_index_uint"),a=!0,de.init())}catch(t){t instanceof Jt&&t.val;Fe.trace("Could not initialize WebGL, falling back to Canvas.",{fileName:"kha/SystemImpl.hx",lineNumber:338,className:"kha.SystemImpl",methodName:"loadFinished"})}if(ve.setCanvas(l),ve.window=new ye(t,e,l),a){var i=new ci;ve.frame=new oe(0,null,null,i),ve.frame.init(new ia(ve.frame),new di(ve.frame),i)}else{si.Kravur=he,he=si;var n=new ni(l.getContext("2d"));ve.frame=new oe(0,null,n,null),ve.frame.init(new ia(ve.frame),n,null)}!ve.mobile&&Ce._init()?(ve._hasWebAudio=!0,Ae._init()):ve.mobile?(ve._hasWebAudio=!1,ri._init(),Ae=ri):(ve._hasWebAudio=!1,ii._compile(),Ae=ii),pi.instance=new mi,uo.start();var s=window,_=s.requestAnimationFrame;null==_&&(_=s.mozRequestAnimationFrame),null==_&&(_=s.webkitRequestAnimationFrame),null==_&&(_=s.msRequestAnimationFrame);var h=null;h=function(t){var e=window;null==_?e.setTimeout(h,16.666666666666668):_(h);var a=ve.getGamepads();if(null!=a)for(var i=0,n=a.length;i<n;){var s=a[i++];null!=s&&ve.checkGamepad(s)}if(uo.executeFrame(),l.getContext){var r=l.clientWidth,o=l.clientHeight;l.width==r&&l.height==o||(l.width=r,l.height=o),co.render([ve.frame]),null!=ve.gl&&(ve.gl.clearColor(1,1,1,1),ve.gl.colorMask(!1,!1,!1,!0),ve.gl.clear(16384),ve.gl.colorMask(!0,!0,!0,!0))}},null==_?s.setTimeout(h,16.666666666666668):_(h),null==l.getAttribute("tabindex")&&l.setAttribute("tabindex","0"),l.focus(),l.oncontextmenu=function(t){t.stopPropagation(),t.preventDefault()},l.onmousedown=ve.mouseDown,l.onmousemove=ve.mouseMove,null!=ve.keyboard&&(l.onkeydown=ve.keyDown,l.onkeyup=ve.keyUp,l.onkeypress=ve.keyPress),l.onblur=ve.onBlur,l.onfocus=ve.onFocus,l.onmousewheel=l.onwheel=ve.mouseWheel,l.onmouseleave=ve.mouseLeave,l.addEventListener("wheel mousewheel",ve.mouseWheel,!1),l.addEventListener("touchstart",ve.touchDown,!1),l.addEventListener("touchend",ve.touchUp,!1),l.addEventListener("touchmove",ve.touchMove,!1),l.addEventListener("touchcancel",ve.touchCancel,!1),window.addEventListener("unload",ve.unload)},ve.unload=function(t){},ve.setMouseXY=function(t){var e=ve.khanvas.getBoundingClientRect(),a=ve.khanvas.clientLeft,i=ve.khanvas.clientTop;ve.mouseX=(t.clientX-e.left-a)*ve.khanvas.width/(e.width-2*a)|0,ve.mouseY=(t.clientY-e.top-i)*ve.khanvas.height/(e.height-2*i)|0},ve.unlockiOSSound=function(){if(ve.ios&&!ve.iosSoundEnabled){var t=ri._context.createBuffer(1,1,22050),e=ri._context.createBufferSource();e.buffer=t,e.connect(ri._context.destination),e.start(),e.stop(),ve.iosSoundEnabled=!0}},ve.unlockSound=function(){if(!ve.soundEnabled){var t=Ce._context;null==t&&(t=Ae._context),null!=t&&t.resume().then(function(t){ve.soundEnabled=!0}).catch(function(t){Fe.trace(t,{fileName:"kha/SystemImpl.hx",lineNumber:585,className:"kha.SystemImpl",methodName:"unlockSound"})})}ve.unlockiOSSound()},ve.mouseLeave=function(){ve.mouse.sendLeaveEvent(0)},ve.mouseWheel=function(t){return ve.insideInputEvent=!0,ve.unlockSound(),t.preventDefault(),0==t.deltaMode?t.deltaY<0?ve.mouse.sendWheelEvent(0,-1):0<t.deltaY&&ve.mouse.sendWheelEvent(0,1):1==t.deltaMode&&(ve.minimumScroll=0|Math.min(ve.minimumScroll,Math.abs(t.deltaY)),ve.mouse.sendWheelEvent(0,t.deltaY/ve.minimumScroll|0)),ve.insideInputEvent=!1},ve.mouseDown=function(t){ve.insideInputEvent=!0,ve.unlockSound(),ve.setMouseXY(t),1==t.which?(t.ctrlKey?(ve.leftMouseCtrlDown=!0,ve.mouse.sendDownEvent(0,1,ve.mouseX,ve.mouseY)):(ve.leftMouseCtrlDown=!1,ve.mouse.sendDownEvent(0,0,ve.mouseX,ve.mouseY)),null!=ve.khanvas.setCapture?ve.khanvas.setCapture():ve.khanvas.ownerDocument.addEventListener("mousemove",ve.documentMouseMove,!0),ve.khanvas.ownerDocument.addEventListener("mouseup",ve.mouseLeftUp)):2==t.which?(ve.mouse.sendDownEvent(0,2,ve.mouseX,ve.mouseY),ve.khanvas.ownerDocument.addEventListener("mouseup",ve.mouseMiddleUp)):3==t.which&&(ve.mouse.sendDownEvent(0,1,ve.mouseX,ve.mouseY),ve.khanvas.ownerDocument.addEventListener("mouseup",ve.mouseRightUp)),ve.insideInputEvent=!1},ve.mouseLeftUp=function(t){ve.unlockSound(),1==t.which&&(ve.insideInputEvent=!0,ve.khanvas.ownerDocument.removeEventListener("mouseup",ve.mouseLeftUp),null!=ve.khanvas.releaseCapture?ve.khanvas.ownerDocument.releaseCapture():ve.khanvas.ownerDocument.removeEventListener("mousemove",ve.documentMouseMove,!0),ve.leftMouseCtrlDown?ve.mouse.sendUpEvent(0,1,ve.mouseX,ve.mouseY):ve.mouse.sendUpEvent(0,0,ve.mouseX,ve.mouseY),ve.leftMouseCtrlDown=!1,ve.insideInputEvent=!1)},ve.mouseMiddleUp=function(t){ve.unlockSound(),2==t.which&&(ve.insideInputEvent=!0,ve.khanvas.ownerDocument.removeEventListener("mouseup",ve.mouseMiddleUp),ve.mouse.sendUpEvent(0,2,ve.mouseX,ve.mouseY),ve.insideInputEvent=!1)},ve.mouseRightUp=function(t){ve.unlockSound(),3==t.which&&(ve.insideInputEvent=!0,ve.khanvas.ownerDocument.removeEventListener("mouseup",ve.mouseRightUp),ve.mouse.sendUpEvent(0,1,ve.mouseX,ve.mouseY),ve.insideInputEvent=!1)},ve.documentMouseMove=function(t){t.stopPropagation(),ve.mouseMove(t)},ve.mouseMove=function(t){ve.insideInputEvent=!0,ve.unlockSound();var e=ve.mouseX,a=ve.mouseY;ve.setMouseXY(t);var i=t.movementX,n=t.movementY;null==t.movementX&&(i=null!=t.mozMovementX?t.mozMovementX:null!=t.webkitMovementX?t.webkitMovementX:ve.mouseX-e,n=null!=t.mozMovementY?t.mozMovementY:null!=t.webkitMovementY?t.webkitMovementY:ve.mouseY-a),ve.firefox&&(i=i*window.devicePixelRatio|0,n=n*window.devicePixelRatio|0),ve.mouse.sendMoveEvent(0,ve.mouseX,ve.mouseY,i,n),ve.insideInputEvent=!1},ve.setTouchXY=function(t){var e=ve.khanvas.getBoundingClientRect(),a=ve.khanvas.clientLeft,i=ve.khanvas.clientTop;ve.touchX=(t.clientX-e.left-a)*ve.khanvas.width/(e.width-2*a)|0,ve.touchY=(t.clientY-e.top-i)*ve.khanvas.height/(e.height-2*i)|0},ve.touchDown=function(t){ve.insideInputEvent=!0,ve.unlockSound(),t.stopPropagation(),t.preventDefault();for(var e=0,a=t.changedTouches;e<a.length;){var i=a[e];++e;var n=i.identifier;ve.ios&&(-1==(n=ve.iosTouchs.indexOf(-1))&&(n=ve.iosTouchs.length),ve.iosTouchs[n]=i.identifier),ve.setTouchXY(i),ve.mouse.sendDownEvent(0,0,ve.touchX,ve.touchY),ve.surface.sendTouchStartEvent(n,ve.touchX,ve.touchY)}ve.insideInputEvent=!1},ve.touchUp=function(t){ve.insideInputEvent=!0,ve.unlockSound();for(var e=0,a=t.changedTouches;e<a.length;){var i=a[e];++e;var n=i.identifier;ve.ios&&(n=ve.iosTouchs.indexOf(n),ve.iosTouchs[n]=-1),ve.setTouchXY(i),ve.mouse.sendUpEvent(0,0,ve.touchX,ve.touchY),ve.surface.sendTouchEndEvent(n,ve.touchX,ve.touchY)}ve.insideInputEvent=!1},ve.touchMove=function(t){ve.insideInputEvent=!0,ve.unlockSound();for(var e=0,a=0,i=t.changedTouches;a<i.length;){var n=i[a];if(++a,ve.setTouchXY(n),0==e){var s=ve.touchX-ve.lastFirstTouchX,r=ve.touchY-ve.lastFirstTouchY;ve.lastFirstTouchX=ve.touchX,ve.lastFirstTouchY=ve.touchY,ve.mouse.sendMoveEvent(0,ve.touchX,ve.touchY,s,r)}var o=n.identifier;ve.ios&&(o=ve.iosTouchs.indexOf(o)),ve.surface.sendMoveEvent(o,ve.touchX,ve.touchY),++e}ve.insideInputEvent=!1},ve.touchCancel=function(t){ve.insideInputEvent=!0,ve.unlockSound();for(var e=0,a=t.changedTouches;e<a.length;){var i=a[e];++e;var n=i.identifier;ve.ios&&(n=ve.iosTouchs.indexOf(n)),ve.setTouchXY(i),ve.mouse.sendUpEvent(0,0,ve.touchX,ve.touchY),ve.surface.sendTouchEndEvent(n,ve.touchX,ve.touchY)}ve.iosTouchs=[],ve.insideInputEvent=!1},ve.onBlur=function(){co.background()},ve.onFocus=function(){co.foreground()},ve.keyDown=function(t){if((t.keyCode<112||123<t.keyCode)&&null!=t.key&&1!=t.key.length&&t.preventDefault(),t.stopPropagation(),ve.ie){if(ve.pressedKeys[t.keyCode])return void t.preventDefault();ve.pressedKeys[t.keyCode]=!0}else if(t.repeat)return void t.preventDefault();ve.keyboard.sendDownEvent(t.keyCode)},ve.keyUp=function(t){t.preventDefault(),t.stopPropagation(),ve.ie&&(ve.pressedKeys[t.keyCode]=!1),ve.keyboard.sendUpEvent(t.keyCode)},ve.keyPress=function(t){0!=t.which&&(t.preventDefault(),t.stopPropagation(),ve.keyboard.sendPressEvent(String.fromCharCode(t.which)))},ve.getGamepads=function(){return ve.chrome&&pi.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null},ve.getPen=function(t){return null};var Ie=function(){};(i["kha.Video"]=Ie).__name__=!0,Ie.__interfaces__=[te],Ie.prototype={__class__:Ie};var Me=function(t,e,a,i,n,s){this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=e,this.format=a,this.renderTarget=i,this.samples=s,this.image=null,this.video=null,this.depthStencilFormat=n,Me.init(),i&&this.createTexture()};(i["kha.WebGLImage"]=Me).__name__=!0,Me.init=function(){null==Me.context&&(Me.canvas=window.document.createElement("canvas"),null!=Me.canvas&&(Me.context=Me.canvas.getContext("2d"),Me.canvas.width=4096,Me.canvas.height=4096,Me.context.globalCompositeOperation="copy"))},Me.formatByteSize=function(t){switch(t._hx_index){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}},Me.__super__=ee,Me.prototype=s(ee.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,samples:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,graphics4:null,depthStencilFormat:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new ci(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=ve.gl){if(this.texture=ve.gl.createTexture(),ve.gl.bindTexture(3553,this.texture),ve.gl.texParameteri(3553,10240,9729),ve.gl.texParameteri(3553,10241,9729),ve.gl.texParameteri(3553,10242,33071),ve.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=ve.gl.createFramebuffer(),ve.gl.bindFramebuffer(36160,this.frameBuffer),this.format._hx_index){case 0:ve.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:ve.gl.texImage2D(3553,0,ve.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:ve.gl.texImage2D(3553,0,ve.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:ve.gl.texImage2D(3553,0,ve.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,ve.halfFloat.HALF_FLOAT_OES,null);break;case 5:ve.gl.texImage2D(3553,0,ve.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,ve.gl2?6403:6406,5126,null);break;case 6:ve.gl.texImage2D(3553,0,ve.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,ve.gl2?6403:6406,ve.halfFloat.HALF_FLOAT_OES,null);break;default:ve.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==Va.DEPTH16){if(ve.gl.texParameteri(3553,10240,9728),ve.gl.texParameteri(3553,10241,9728),ve.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!ve.gl2){var t=ve.gl.createTexture();ve.gl.bindTexture(3553,t),ve.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),ve.gl.framebufferTexture2D(36160,36064,3553,t,0),ve.gl.bindTexture(3553,this.texture)}}else ve.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=ve.gl.checkFramebufferStatus(36160)&&Fe.trace("WebGL error: Framebuffer incomplete",{fileName:"kha/WebGLImage.hx",lineNumber:225,className:"kha.WebGLImage",methodName:"createTexture"}),ve.gl.bindRenderbuffer(36161,null),ve.gl.bindFramebuffer(36160,null)}else if(null!=this.video)ve.gl.texImage2D(3553,0,6408,6408,5121,this.video);else{switch(this.format._hx_index){case 0:this.image instanceof gs?ve.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):ve.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 2:ve.gl.texImage2D(3553,0,ve.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:ve.gl.texImage2D(3553,0,ve.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ve.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:ve.gl.texImage2D(3553,0,ve.gl2?33326:6406,this.myWidth,this.myHeight,0,ve.gl2?6403:6406,5126,this.image);break;case 6:ve.gl.texImage2D(3553,0,ve.gl2?33325:6406,this.myWidth,this.myHeight,0,ve.gl2?6403:6406,ve.halfFloat.HALF_FLOAT_OES,this.image);break;default:ve.gl.texImage2D(3553,0,6408,6408,5121,this.image)}}ve.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:null==ve.depthTexture?(this.renderBuffer=ve.gl.createRenderbuffer(),ve.gl.bindRenderbuffer(36161,this.renderBuffer),ve.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),ve.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=ve.gl.createTexture(),ve.gl.bindTexture(3553,this.depthTexture),1==t?ve.gl.texImage2D(3553,0,ve.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):ve.gl.texImage2D(3553,0,ve.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),ve.gl.texParameteri(3553,10240,9728),ve.gl.texParameteri(3553,10241,9728),ve.gl.texParameteri(3553,10242,33071),ve.gl.texParameteri(3553,10243,33071),ve.gl.bindFramebuffer(36160,this.frameBuffer),ve.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==ve.depthTexture?(this.renderBuffer=ve.gl.createRenderbuffer(),ve.gl.bindRenderbuffer(36161,this.renderBuffer),ve.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),ve.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=ve.gl.createTexture(),ve.gl.bindTexture(3553,this.depthTexture),ve.gl.texImage2D(3553,0,ve.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,ve.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),ve.gl.texParameteri(3553,10240,9728),ve.gl.texParameteri(3553,10241,9728),ve.gl.texParameteri(3553,10242,33071),ve.gl.texParameteri(3553,10243,33071),ve.gl.bindFramebuffer(36160,this.frameBuffer),ve.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(t){ve.gl.activeTexture(33984+t),ve.gl.bindTexture(3553,this.texture),null!=this.video&&ve.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(t){ve.gl.activeTexture(33984+t),ve.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(t){ve.gl.bindFramebuffer(36160,this.frameBuffer),ve.gl.framebufferTexture2D(36160,36096,3553,d_.__cast(t,Me).depthTexture,0)},bytesToArray:function(t){switch(this.format._hx_index){case 0:case 1:return new gs(t.b.bufferValue);case 2:case 4:case 5:case 6:return new ds(t.b.bufferValue);default:return new gs(t.b.bufferValue)}},bytes:null,lock:function(t){return null==t&&(t=0),this.bytes=new nt(new us(Me.formatByteSize(this.format)*this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=ve.gl){switch(this.texture=ve.gl.createTexture(),ve.gl.bindTexture(3553,this.texture),ve.gl.texParameteri(3553,10240,9729),ve.gl.texParameteri(3553,10241,9729),ve.gl.texParameteri(3553,10242,33071),ve.gl.texParameteri(3553,10243,33071),this.format._hx_index){case 0:ve.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(ve.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==ve.gl.getError()){for(var t=new nt(new us(this.get_width()*this.get_height()*4)),e=0,a=this.get_height();e<a;)for(var i=e++,n=0,s=this.get_width();n<s;){var r=n++,o=this.bytes,l=i*this.get_width()+r,_=o.b[l],h=i*this.get_width()*4+4*r;t.b[h]=255&_;var f=i*this.get_width()*4+4*r+1;t.b[f]=255&_;var u=i*this.get_width()*4+4*r+2;t.b[u]=255&_;var c=i*this.get_width()*4+4*r+3;t.b[c]=255}ve.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(t))}break;case 2:ve.gl.texImage2D(3553,0,ve.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:ve.gl.texImage2D(3553,0,ve.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,ve.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:ve.gl.texImage2D(3553,0,ve.gl2?33326:6406,this.get_width(),this.get_height(),0,ve.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:ve.gl.texImage2D(3553,0,ve.gl2?33325:6406,this.get_width(),this.get_height(),0,ve.gl2?6403:6406,ve.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:ve.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}ve.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){null!=this.texture&&ve.gl.deleteTexture(this.texture),null!=this.depthTexture&&ve.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&ve.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&ve.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(t){ve.gl.bindTexture(3553,this.texture),ve.gl.generateMipmap(3553)},setMipmaps:function(t){if(ve.gl.bindTexture(3553,this.texture),this.format==Va.RGBA128)for(var e=0,a=t.length;e<a;){var i=e++;ve.gl.texImage2D(3553,i+1,ve.gl2?34836:6408,t[i].get_width(),t[i].get_height(),0,6408,5126,d_.__cast(t[i],Me).image)}else if(this.format==Va.RGBA64)for(var n=0,s=t.length;n<s;){var r=n++;ve.gl.texImage2D(3553,r+1,ve.gl2?34842:6408,t[r].get_width(),t[r].get_height(),0,6408,ve.halfFloat.HALF_FLOAT_OES,d_.__cast(t[r],Me).image)}else for(var o=0,l=t.length;o<l;){var _=o++;ve.gl.texImage2D(3553,_+1,6408,6408,5121,d_.__cast(t[_],Me).image)}},__class__:Me});var ye=function(t,e,a){this.canvas=a,ye.windows.push(this)};(i["kha.Window"]=ye).__name__=!0,ye.__properties__={get_all:"get_all"},ye.get=function(t){return ye.windows[t]},ye.get_all=function(){return ye.windows},ye.prototype={canvas:null,defaultWidth:null,defaultHeight:null,get_width:function(){return 0==this.canvas.width?this.defaultWidth:this.canvas.width},get_height:function(){return 0==this.canvas.height?this.defaultHeight:this.canvas.height},get_vSynced:function(){return!0},__class__:ye,__properties__:{get_vSynced:"get_vSynced",get_height:"get_height",get_width:"get_width"}};var we=function(t,e,a,i,n,s,r,o,l){null==l&&(l=0),null==o&&(o=7),null==r&&(r=!0),null==n&&(n=600),null==i&&(i=800),null==a&&(a=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=null,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title="Kha",this.title=t,this.x=e,this.y=a,this.width=i,this.height=n,this.display=null==s?se.get_primary():s,this.visible=r,this.windowFeatures=o,this.mode=l};(i["kha.WindowOptions"]=we).__name__=!0,we.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:we};var xe=function(){};(i["kha.audio1.AudioChannel"]=xe).__name__=!0,xe.prototype={play:null,set_volume:null,get_finished:null,__class__:xe,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var Ce=function(){};(i["kha.audio2.Audio"]=Ce).__name__=!0,Ce.initContext=function(){try{return void(Ce._context=new AudioContext)}catch(t){t instanceof Jt&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof Jt&&t.val}},Ce._init=function(){if(Ce.initContext(),null==Ce._context)return!1;return Ce.buffer=new ze(8192,2,0|Ce._context.sampleRate),Ce.processingNode=Ce._context.createScriptProcessor(2048,0,2),Ce.processingNode.onaudioprocess=function(t){var e=t.outputBuffer.getChannelData(0),a=t.outputBuffer.getChannelData(1);if(null!=Ce.audioCallback){Ce.audioCallback(2*t.outputBuffer.length,Ce.buffer);for(var i=0,n=t.outputBuffer.length;i<n;){var s=i++;e[s]=Ce.buffer.data[Ce.buffer.readLocation],Ce.buffer.readLocation+=1,a[s]=Ce.buffer.data[Ce.buffer.readLocation],Ce.buffer.readLocation+=1,Ce.buffer.readLocation>=Ce.buffer.size&&(Ce.buffer.readLocation=0)}}else for(var r=0,o=t.outputBuffer.length;r<o;){var l=r++;e[l]=0,a[l]=0}},Ce.processingNode.connect(Ce._context.destination),!0},Ce.stream=function(t,e){null==e&&(e=!1);var a=window.document.createElement("audio"),i=new Blob([t.compressedData.b.bufferValue],{type:"audio/mp4"});a.src=URL.createObjectURL(i),a.loop=e;var n=new ai(a);return n.play(),n};var Ae=function(){};(i["kha.audio2.Audio1"]=Ae).__name__=!0,Ae._init=function(){var t=new Array(16);Ae.soundChannels=t;var e=new Array(16);Ae.streamChannels=e;var a=new Array(16);Ae.internalSoundChannels=a;var i=new Array(16);Ae.internalStreamChannels=i;var n=new ds(512);Ae.sampleCache1=n;var s=new ds(512);Ae.sampleCache2=s,Ce.audioCallback=Ae.mix},Ae.mix=function(t,e){if(Ae.sampleCache1.length<t){var a=new ds(t);Ae.sampleCache1=a;var i=new ds(t);Ae.sampleCache2=i}for(var n=0,s=t;n<s;){var r=n++;Ae.sampleCache2[r]=0}for(var o=0;o<16;){var l=o++;Ae.internalSoundChannels[l]=Ae.soundChannels[l]}for(var _=0;_<16;){var h=_++;Ae.internalStreamChannels[h]=Ae.streamChannels[h]}for(var f=0,u=Ae.internalSoundChannels;f<u.length;){var c=u[f];if(++f,null!=c&&!c.get_finished()){c.nextSamples(Ae.sampleCache1,t,e.samplesPerSecond);for(var d=0,g=t;d<g;){var p=d++,m=p;Ae.sampleCache2[m]+=Ae.sampleCache1[p]*c.get_volume()}}}for(var v=0,b=Ae.internalStreamChannels;v<b.length;){var I=b[v];if(++v,null!=I&&!I.get_finished()){I.nextSamples(Ae.sampleCache1,t,e.samplesPerSecond);for(var M=0,y=t;M<y;){var w=M++,x=w;Ae.sampleCache2[x]+=Ae.sampleCache1[w]*I.get_volume()}}}for(var C=0,A=t;C<A;){var Z=C++,z=Ae.sampleCache2[Z],B=z<1?z:1;e.data[e.writeLocation]=-1<B?B:-1,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},Ae.play=function(t,e){null==e&&(e=!1);for(var a=null,i=0;i<16;){var n=i++;if(null==Ae.soundChannels[n]||Ae.soundChannels[n].get_finished()){(a=new Ze(e)).data=t.uncompressedData,Ae.soundChannels[n]=a;break}}return a},Ae._playAgain=function(t){for(var e=0;e<16;){var a=e++;if(null==Ae.soundChannels[a]||Ae.soundChannels[a].get_finished()||Ae.soundChannels[a]==t){Ae.soundChannels[a]=t;break}}},Ae.stream=function(t,e){null==e&&(e=!1);var a=Ce.stream(t,e);if(null!=a)return a;for(var i=null,n=0;n<16;){var s=n++;if(null==Ae.streamChannels[s]||Ae.streamChannels[s].get_finished()){i=new ke(t.compressedData,e),Ae.streamChannels[s]=i;break}}return i};var Ze=function(t){this.paused=!1,this.looping=t,this.myVolume=1,this.myPosition=0};(i["kha.audio2.AudioChannel"]=Ze).__name__=!0,Ze.__interfaces__=[xe],Ze.prototype={data:null,myVolume:null,myPosition:null,paused:null,looping:null,nextSamples:function(t,e,a){if(this.paused)for(var i=0,n=e;i<n;){t[i++]=0}else{for(var s=0,r=0;s<e;){for(var o=this.data.length-this.myPosition,l=o<e-s?o:e-s;r<l;)t[s]=this.data[this.myPosition],++this.myPosition,++r,++s;if(!this.looping)break;r=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;s<e;)t[s]=0,++s}},play:function(){this.paused=!1,this.get_finished()&&(this.myPosition=0,Ae._playAgain(this))},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.myPosition>=this.data.length},__class__:Ze,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var ze=function(t,e,a){this.size=t;var i=new ds(t);this.data=i,this.channels=e,this.samplesPerSecond=a,this.readLocation=0,this.writeLocation=0};(i["kha.audio2.Buffer"]=ze).__name__=!0,ze.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:ze};var ke=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e,this.reader=Xe.openFromBytes(t)};(i["kha.audio2.StreamChannel"]=ke).__name__=!0,ke.__interfaces__=[xe],ke.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,a){if(this.paused)for(var i=0,n=e;i<n;){t[i++]=0}else{var s=2*this.reader.read(t,e/2|0,2,a,!0);if(s<e){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var r=s,o=e;r<o;){t[r++]=0}}}},play:function(){this.paused=!1},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.atend},__class__:ke,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var Se=function(){};(i["kha.audio2.ogg.tools.Crc32"]=Se).__name__=!0,Se.init=function(){if(null==Se.table){var t=new Array(256);Se.table=t;for(var e=0;e<256;){for(var a=e++,i=a<<24,n=0;n<8;){n++;i=i<<1^(Lt.gte(i,1<<31)?79764919:0)}Se.table[a]=i}}};var Xe=function(t,e,a){this.seekFunc=e,this.inputLength=a,this.decoder=Le.start(t),this.decoder.setupSampleNumber(e,a),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(i["kha.audio2.ogg.vorbis.Reader"]=Xe).__name__=!0,Xe.openFromBytes=function(t){var e=new st(t),a=e;return new Xe(e,function(t){Xe.seekBytes(a,t)},t.length)},Xe.seekBytes=function(t,e){t.set_position(e)},Xe.readAll=function(t,e,a){null==a&&(a=!1);var i=new st(t),n=Le.start(i),s=i;n.setupSampleNumber(function(t){Xe.seekBytes(s,t)},t.length);for(var r=n.header,o=new ds(4096*r.channel);;){for(var l=n.read(o,4096,r.channel,r.sampleRate,a),_=0,h=l*r.channel;_<h;){var f=_++;e.writeFloat(o[f])}if(0==l)break;l}return n.header},Xe.prototype={decoder:null,get_header:function(){return this.decoder.header},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(t){return this.decoder.seek(this.seekFunc,this.inputLength,t),this.decoder.currentSample},get_currentMillisecond:function(){var t=this.get_currentSample(),e=this.get_header().sampleRate;return Lt.toFloat(t)/Lt.toFloat(e)*1e3},set_currentMillisecond:function(t){var e=t/1e3,a=this.get_header().sampleRate;return this.set_currentSample(Math.floor(Lt.toFloat(a)*e)),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(t,e,a,i,n){return null==n&&(n=!1),this.decoder.ensurePosition(this.seekFunc),null==e&&(e=this.decoder.totalSample),null==a&&(a=this.get_header().channel),null==i&&(i=this.get_header().sampleRate),this.decoder.read(t,e,a,i,n)},__class__:Xe,__properties__:{set_currentMillisecond:"set_currentMillisecond",get_currentMillisecond:"get_currentMillisecond",set_currentSample:"set_currentSample",get_currentSample:"get_currentSample",get_header:"get_header"}};var Ye=function(t){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=t,this.inputPosition=0,this.page=new Je,Se.init()};(i["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Ye).__name__=!0,Ye.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(t,e){this.inputPosition+=1;var a=this.input.readByte();this.inputPosition+=a;for(var i=new Array(a),n=0,s=a;n<s;){i[n++]=this.input.readByte()}if(this.segments=i,this.endSegWithKnownLoc=-2,-1!=t||-1!=e)for(var r=a-1;0<=r&&!(this.segments[r]<255);)0<=r&&(this.endSegWithKnownLoc=r,this.knownLocForPacket=t),--r;if(this.firstDecode){for(var o=0,l=new Qe,_=0,h=a;_<h;){var f=_++;o+=this.segments[f]}o+=27+a,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=t,this.pFirst=l}this.nextSeg=0},clone:function(t){var e=Object.create(Ye.prototype);return t(this.inputPosition),e.input=this.input,e.eof=this.eof,e.validBits=this.validBits,e.discardSamplesDeferred=this.discardSamplesDeferred,e.firstDecode=this.firstDecode,e.nextSeg=this.nextSeg,e.bytesInSeg=this.bytesInSeg,e.acc=e.acc,e.lastSeg=this.lastSeg,e.lastSegWhich=this.lastSegWhich,e.currentLoc=this.currentLoc,e.currentLocValid=this.currentLocValid,e.inputPosition=this.inputPosition,e.firstAudioPageOffset=this.firstAudioPageOffset,e.error=this.error,e.segments=this.segments,e.pFirst=this.pFirst,e.pLast=this.pLast,e.page=this.page.clone(),e},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(t){var e=t instanceof Jt?t.val:t;if(e instanceof qe)return this.lastSeg=!0,this.error=e,0;throw t}if(0==(1&this.page.flag))throw new Jt(new qe($e.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var t=this.segments[this.nextSeg++];return t<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=t},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new Jt(new qe($e.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,t,a,i,n=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){var s=t instanceof Jt?t.val:t;if(!(s instanceof K))throw t;n=!0,e=0}if(n)return!1;if(79==e?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?a=!0:(this.inputPosition+=1,a=103!=this.input.readByte()),a?t=!0:(this.inputPosition+=1,t=83!=this.input.readByte()),t)throw new Jt(new qe($e.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(t){if(this.validBits<0)return 0;if(this.validBits<t){if(24<t)return this.readBits(24)+(this.readBits(t-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<t))break}if(this.validBits<0)return 0;var e=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,e}var a=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,a},firstPageValidate:function(){if(1!=this.segments.length)throw new Jt(new qe($e.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new Jt(new qe($e.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},finishDecodePacket:function(t,e,a){var i=a.left.start,n=!1,s=e>>1;if(this.firstDecode)this.currentLoc=-s,this.discardSamplesDeferred=e-a.right.end,n=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)a.left.start+=this.discardSamplesDeferred,i=a.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(n&&0!=(4&this.page.flag)){var r=this.knownLocForPacket-(e-a.right.end);if(r<this.currentLoc+a.right.end){var o=r<this.currentLoc?0:r-this.currentLoc;return o+=a.left.start,this.currentLoc+=o,{len:o,left:i,right:a.right.start}}}this.currentLoc=this.knownLocForPacket-(s-a.left.start),n=!0}return n&&(this.currentLoc+=a.right.start-a.left.start),{len:a.right.end,left:i,right:a.right.start}},getSampleNumber:function(t,e){var a=this.inputPosition,i=Lt.gte(e,65536)&&Lt.gte(e-65536,this.firstAudioPageOffset)?e-65536:this.firstAudioPageOffset;t(this.inputPosition=i);var n=0,s=!1,r=this.findPage(t,e);switch(r._hx_index){case 0:var o=r.last;n=r.end,s=o;break;case 1:throw new Jt(new qe($e.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;t:for(;!s;){t(this.inputPosition=n);var _=this.findPage(t,e);switch(_._hx_index){case 0:var h=_.last;n=_.end,s=h;break;case 1:break t}i=l+1,l=this.inputPosition}t(this.inputPosition=l),this.inputPosition+=6;for(var f=new Array(6),u=0;u<6;){f[u++]=this.input.readByte()}this.inputPosition+=4;var c=this.input.readInt32();this.inputPosition+=4;var d=this.input.readInt32();if(-1==c&&-1==d||0<d)throw new Jt(new qe($e.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Qe,this.pLast.pageStart=l,this.pLast.pageEnd=n,this.pLast.lastDecodedSample=c,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=i,t(this.inputPosition=a),c},findPage:function(t,e){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var a,i,n=this.inputPosition;if(e<n-25)return Ne.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?a=!0:(this.inputPosition+=1,a=83!=this.input.readByte()),a)continue;var s=new Array(27);s[0]=79,s[1]=103,s[2]=103,s[3]=83;for(var r=4;r<27;){var o=r++;this.inputPosition+=1,s[o]=this.input.readByte()}if(0!=s[4]){t(this.inputPosition=n);continue}for(var l=s[22]+(s[23]<<8)+(s[24]<<16)+(s[25]<<24),_=22;_<26;){s[_++]=0}for(var h=0,f=0;f<27;){var u=f++;h=h<<8^Se.table[s[u]^h>>>24]}var c=0;try{for(var d=0,g=s[26];d<g;){d++;this.inputPosition+=1;var p=this.input.readByte();h=h<<8^Se.table[p^h>>>24],c+=p}for(var m=0,v=c;m<v;){m++;this.inputPosition+=1;var b=this.input.readByte();h=h<<8^Se.table[b^h>>>24]}}catch(t){var I=t instanceof Jt?t.val:t;if(I instanceof K){return Ne.NotFound}throw t}if(h==l){var M=this.inputPosition;return t(this.inputPosition=n-1),Ne.Found(M,0!=(4&s[5]))}}}}catch(t){var y=t instanceof Jt?t.val:t;if(y instanceof K){return Ne.NotFound}throw t}},analyzePage:function(t,e){var a=new Qe,i=new Array(255);a.pageStart=this.inputPosition,this.inputPosition+=27;for(var n=new Array(27),s=0;s<27;){n[s++]=this.input.readByte()}var r=n,o=r[26];this.inputPosition+=o;for(var l=new Array(o),_=0,h=o;_<h;){l[_++]=this.input.readByte()}for(var f=l,u=0,c=0,d=r[26];c<d;){u+=f[c++]}if(a.pageEnd=a.pageStart+27+r[26]+u,a.lastDecodedSample=r[6]+(r[7]<<8)+(r[8]<<16)+(r[9]<<16),0!=(4&r[5]))return a.firstDecodedSample=null,t(this.inputPosition=a.pageStart),a;for(var g=0,p=0==(1&r[5]),m=e.modes.length,v=0,b=r[26];v<b;){var I=v++;if(p){if(0==f[I])return t(this.inputPosition=a.pageStart),null;this.inputPosition+=1;var M=this.input.readByte();if(0!=(1&M))return t(this.inputPosition=a.pageStart),null;M>>=1;var y=m-1,w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(m<=(M&=(1<<(y<16384?y<16?w[y]:y<512?5+w[y>>5]:10+w[y>>10]:y<16777216?y<524288?15+w[y>>15]:20+w[y>>20]:y<536870912?25+w[y>>25]:y<-2147483648?30+w[y>>30]:0))-1))return t(this.inputPosition=a.pageStart),null;i[g++]=e.modes[M].blockflag;var x=f[I]-1;this.inputPosition+=x;for(var C=new Array(x),A=0,Z=x;A<Z;){C[A++]=this.input.readByte()}}else{var z=f[I];this.inputPosition+=z;for(var B=new Array(z),k=0,S=z;k<S;){B[k++]=this.input.readByte()}}p=f[I]<255}var X=0;1<g&&(X+=i[g-1]?e.blocksize1:e.blocksize0);for(var Y=g-2;1<=Y;)i[--Y]?i[Y+1]?X+=e.blocksize1>>1:X+=(e.blocksize1-e.blocksize0>>2)+(e.blocksize0>>1):X+=e.blocksize0>>1,--Y;return a.firstDecodedSample=a.lastDecodedSample-X,t(this.inputPosition=a.pageStart),a},decodeScalarRaw:function(t){this.prepHuffman();var e=t.codewordLengths,a=t.codewords,i=t.sortedCodewords;if(8<t.entries?null!=i:null!=a){for(var n=this.acc,s=(n=(-16711936&(n=(-252645136&(n=(-858993460&(n=(-1431655766&n)>>>1|(1431655765&n)<<1))>>>2|(858993459&n)<<2))>>>4|(252645135&n)<<4))>>>8|(16711935&n)<<8)>>>16|n<<16,r=0,o=t.sortedEntries;1<o;){var l=r+(o>>1);Lt.gte(s,i[l])?(r=l,o-=o>>1):o>>=1}t.sparse||(r=t.sortedValues[r]);var _=e[r];return this.validBits>=_?(this.acc=this.acc>>>_,this.validBits-=_,r):(this.validBits=0,-1)}for(var h=0,f=t.entries;h<f;){var u=h++,c=e[u];if(255!=c&&a[u]==(this.acc&(1<<c)-1))return this.validBits>=c?(this.acc=this.acc>>>c,this.validBits-=c,u):(this.validBits=0,-1)}return this.error=new qe($e.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:Ye};var Ne=I["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:(a=function(t,e){return{_hx_index:0,end:t,last:e,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:n}},a.__params__=["end","last"],a),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:n}},Le=function(t,e){this.header=t,this.decodeState=e,this.totalSample=null,this.currentSample=0,this.previousLength=0;var a=new Array(t.channel);this.channelBuffers=a;var i=new Array(t.channel);this.previousWindow=i;var n=new Array(t.channel);this.finalY=n;for(var s=0,r=t.channel;s<r;){var o=s++,l=this.channelBuffers,_=new Array(t.blocksize1);l[o]=_;var h=this.previousWindow,f=new Array(t.blocksize1/2|0);h[o]=f,this.finalY[o]=[]}var u=new Array(2);this.a=u;var c=new Array(2);this.b=c;var d=new Array(2);this.c=d;var g=new Array(2);this.window=g;var p=new Array(2);this.bitReverseData=p,this.initBlocksize(0,t.blocksize0),this.initBlocksize(1,t.blocksize1)};(i["kha.audio2.ogg.vorbis.VorbisDecoder"]=Le).__name__=!0,Le.start=function(t){var e=new Ye(t),a=Re.read(e),i=new Le(a,e);return e.startFirstDecode(),i.pumpFirstFrame(),i},Le.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(t,e,a,i,n){var s=this.header.sampleRate;if(0!=(Lt.toFloat(i)%Lt.toFloat(s)|0))throw new Jt("Unsupported sampleRate : can't convert "+X.string(Lt.toFloat(this.header.sampleRate))+" to "+i);if(a%this.header.channel!=0)throw new Jt("Unsupported channels : can't convert "+this.header.channel+" to "+a);var r=this.header.sampleRate,o=Lt.toFloat(i)/Lt.toFloat(r)|0,l=a/this.header.channel|0,_=0,h=Math.floor(e/o);null!=this.totalSample&&h>this.totalSample-this.currentSample&&(h=this.totalSample-this.currentSample);for(var f=0;_<h;){var u=this.channelBufferEnd-this.channelBufferStart;h-_<=u&&(u=h-_);for(var c=this.channelBufferStart,d=this.channelBufferStart+u;c<d;)for(var g=c++,p=0,m=o;p<m;){p++;for(var v=0,b=this.header.channel;v<b;)for(var I=v++,M=0,y=l;M<y;){M++;var w=this.channelBuffers[I][g];1<w?w=1:w<-1&&(w=-1),n&&(t[f]=w,++f)}}if(_+=u,this.channelBufferStart+=u,_==h||0==this.getFrameFloat())break}for(var x=_,C=h;x<C;){x++;for(var A=0,Z=o;A<Z;){A++;for(var z=0,B=this.header.channel;z<B;){z++;for(var k=0,S=l;k<S;){k++;n&&(t[f]=0,++f)}}}}return this.currentSample+=h,h*o},skipSamples:function(t){var e=0;for(null!=this.totalSample&&t>this.totalSample-this.currentSample&&(t=this.totalSample-this.currentSample);e<t;){var a=this.channelBufferEnd-this.channelBufferStart;if(t-e<=a&&(a=t-e),e+=a,this.channelBufferStart+=a,e==t||0==this.getFrameFloat())break}return this.currentSample+=t,t},setupSampleNumber:function(t,e){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(t,e))},seek:function(t,e,a){if(this.currentSample!=a){if(null==this.totalSample&&(this.setupSampleNumber(t,e),0==this.totalSample))throw new Jt(new qe($e.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));a<0&&(a=0);var i=this.decodeState.pFirst,n=this.decodeState.pLast;if(a>=n.lastDecodedSample&&(a=n.lastDecodedSample-1),a<i.lastDecodedSample)this.seekFrameFromPage(t,i.pageStart,0,a);else{for(var s=0;i.pageEnd<n.pageStart;){var r=i.pageEnd,o=n.afterPreviousPageStart,l=i.lastDecodedSample,_=n.lastDecodedSample;if(null==l||null==_)throw new Jt(new qe($e.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));Lt.gt(o,r+4e3)&&(o-=4e3);var h=r+Math.floor(Lt.toFloat(o-r)/Lt.toFloat(_-l)*(a-l));if(4<=s){var f=r+(o-r>>>1);h=8<=s?f:Lt.gt(f,h)?h+(f-h>>>1):f+(h-f>>>1)}switch(++s,t(this.decodeState.inputPosition=h),this.decodeState.findPage(t,e)._hx_index){case 0:break;case 1:throw new Jt(new qe($e.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var u=this.decodeState.analyzePage(t,this.header);if(null==u)throw new Jt(new qe($e.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));u.afterPreviousPageStart=h,u.pageStart!=n.pageStart?a<u.lastDecodedSample?n=u:i=u:n=u}if(!(i.lastDecodedSample<=a&&a<n.lastDecodedSample))throw new Jt(new qe($e.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(t,n.pageStart,i.lastDecodedSample,a)}}},seekFrameFromPage:function(t,e,a,i){var n=0,s=a;t(this.decodeState.inputPosition=e),this.decodeState.nextSeg=-1;for(var r=0,o=0,l=null,_=null;;){l=_,_=this.decodeState.clone(t);var h=this.decodeInitial();if(null==h){_=l;break}o=h.left.start,r=h.left.end;var f=0==n?r:o;if(i<s+h.right.start-f)break;for(var u=this.decodeState;0!=u.bytesInSeg||!u.lastSeg&&0!=u.next();)u.bytesInSeg--,u.inputPosition+=1,u.input.readByte();s+=h.right.start-f,++n}this.decodeState=_,t(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=s,this.skipSamples(i-s)},ensurePosition:function(t){t(this.decodeState.inputPosition)},getFrameFloat:function(){var t=this.decodePacket();if(null==t)return this.channelBufferStart=this.channelBufferEnd=0,0;var e=this.finishFrame(t);return this.channelBufferStart=t.left,this.channelBufferEnd=t.left+e,e},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(t){var e=t.len,a=t.right,i=t.left;if(0!=this.previousLength)for(var n=this.previousLength,s=this.getWindow(n),r=0,o=this.header.channel;r<o;)for(var l=r++,_=this.channelBuffers[l],h=this.previousWindow[l],f=0,u=n;f<u;){var c=f++;_[i+c]=_[i+c]*s[c]+h[c]*s[n-1-c]}var d=this.previousLength;this.previousLength=e-a;for(var g=0,p=this.header.channel;g<p;)for(var m=g++,v=this.previousWindow[m],b=this.channelBuffers[m],I=0,M=e-a;I<M;){var y=I++;v[y]=b[a+y]}return 0==d?0:(e<a&&(a=e),a-i)},getWindow:function(t){return(t<<=1)==this.header.blocksize0?this.window[0]:t==this.header.blocksize1?this.window[1]:null},initBlocksize:function(t,e){var a=e>>1,i=e>>2,n=e>>3,s=this.a,r=new Array(a);s[t]=r;var o=this.b,l=new Array(a);o[t]=l;var _=this.c,h=new Array(i);_[t]=h;var f=this.window,u=new Array(a);f[t]=u;var c=this.bitReverseData,d=new Array(n);c[t]=d,Ge.computeTwiddleFactors(e,this.a[t],this.b[t],this.c[t]),Ge.computeWindow(e,this.window[t]),Ge.computeBitReverse(e,this.bitReverseData[t])},inverseMdct:function(t,e,a){for(var i=a?1:0,n=this.a[i],s=this.b[i],r=this.c[i],o=this.bitReverseData[i],l=e>>1,_=e>>2,h=e>>3,f=new Array(l),u=l-2,c=0,d=0,g=l;d!=g;)f[u+1]=t[d]*n[c]-t[d+2]*n[c+1],f[u]=t[d]*n[c+1]+t[d+2]*n[c],u-=2,c+=2,d+=4;for(d=l-3;0<=u;)f[u+1]=-t[d+2]*n[c]- -t[d]*n[c+1],f[u]=-t[d+2]*n[c+1]+-t[d]*n[c],u-=2,c+=2,d-=4;for(var p=t,m=f,v=l-8,b=_,I=0,M=_,y=0;0<=v;){var w=m[b+1]-m[I+1],x=m[b]-m[I];p[M+1]=m[b+1]+m[I+1],p[M]=m[b]+m[I],p[y+1]=w*n[v+4]-x*n[v+5],p[y]=x*n[v+4]+w*n[v+5],w=m[b+3]-m[I+3],x=m[b+2]-m[I+2],p[M+3]=m[b+3]+m[I+3],p[M+2]=m[b+2]+m[I+2],p[y+3]=w*n[v]-x*n[v+1],p[y+2]=x*n[v]+w*n[v+1],v-=8,M+=4,y+=4,b+=4,I+=4}for(var C=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],A=(e<16384?e<16?C[e]:e<512?5+C[e>>5]:10+C[e>>10]:e<16777216?e<524288?15+C[e>>15]:20+C[e>>20]:e<536870912?25+C[e>>25]:e<-2147483648?30+C[e>>30]:0)-1,Z=l-1-0*_,z=Z,B=Z+-(e>>3),k=0,S=1+(e>>4>>2);0<--S;){var X=p[z]-p[B],Y=p[z+-1]-p[B+-1],N=z,L=p;L[N]=L[N]+p[B];var G=z+-1,W=p;W[G]=W[G]+p[B+-1],p[B]=X*n[k]-Y*n[k+1],p[B+-1]=Y*n[k]+X*n[k+1],k+=8,X=p[z+-2]-p[B+-2],Y=p[z+-3]-p[B+-3];var D=z+-2,T=p;T[D]=T[D]+p[B+-2];var V=z+-3,K=p;K[V]=K[V]+p[B+-3],p[B+-2]=X*n[k]-Y*n[k+1],p[B+-3]=Y*n[k]+X*n[k+1],k+=8,X=p[z+-4]-p[B+-4],Y=p[z+-5]-p[B+-5];var j=z+-4,R=p;R[j]=R[j]+p[B+-4];var H=z+-5,P=p;P[H]=P[H]+p[B+-5],p[B+-4]=X*n[k]-Y*n[k+1],p[B+-5]=Y*n[k]+X*n[k+1],k+=8,X=p[z+-6]-p[B+-6],Y=p[z+-7]-p[B+-7];var F=z+-6,O=p;O[F]=O[F]+p[B+-6];var E=z+-7,U=p;U[E]=U[E]+p[B+-7],p[B+-6]=X*n[k]-Y*n[k+1],p[B+-7]=Y*n[k]+X*n[k+1],k+=8,z-=8,B-=8}for(var J=l-1-_,Q=J,q=J+-(e>>3),$=0,tt=1+(e>>4>>2);0<--tt;){var et=p[Q]-p[q],at=p[Q+-1]-p[q+-1],it=Q,nt=p;nt[it]=nt[it]+p[q];var st=Q+-1,rt=p;rt[st]=rt[st]+p[q+-1],p[q]=et*n[$]-at*n[$+1],p[q+-1]=at*n[$]+et*n[$+1],$+=8,et=p[Q+-2]-p[q+-2],at=p[Q+-3]-p[q+-3];var ot=Q+-2,lt=p;lt[ot]=lt[ot]+p[q+-2];var _t=Q+-3,ht=p;ht[_t]=ht[_t]+p[q+-3],p[q+-2]=et*n[$]-at*n[$+1],p[q+-3]=at*n[$]+et*n[$+1],$+=8,et=p[Q+-4]-p[q+-4],at=p[Q+-5]-p[q+-5];var ft=Q+-4,ut=p;ut[ft]=ut[ft]+p[q+-4];var ct=Q+-5,dt=p;dt[ct]=dt[ct]+p[q+-5],p[q+-4]=et*n[$]-at*n[$+1],p[q+-5]=at*n[$]+et*n[$+1],$+=8,et=p[Q+-6]-p[q+-6],at=p[Q+-7]-p[q+-7];var gt=Q+-6,pt=p;pt[gt]=pt[gt]+p[q+-6];var mt=Q+-7,vt=p;vt[mt]=vt[mt]+p[q+-7],p[q+-6]=et*n[$]-at*n[$+1],p[q+-7]=at*n[$]+et*n[$+1],$+=8,Q-=8,q-=8}for(var bt=l-1-0*h,It=0,Mt=bt,yt=bt+-(e>>4),wt=1+(e>>5>>2);0<--wt;){var xt=p[Mt]-p[yt],Ct=p[Mt+-1]-p[yt+-1],At=Mt,Zt=p;Zt[At]=Zt[At]+p[yt];var zt=Mt+-1,Bt=p;Bt[zt]=Bt[zt]+p[yt+-1],p[yt]=xt*n[It]-Ct*n[It+1],p[yt+-1]=Ct*n[It]+xt*n[It+1],It+=16,xt=p[Mt+-2]-p[yt+-2],Ct=p[Mt+-3]-p[yt+-3];var kt=Mt+-2,St=p;St[kt]=St[kt]+p[yt+-2];var Xt=Mt+-3,Yt=p;Yt[Xt]=Yt[Xt]+p[yt+-3],p[yt+-2]=xt*n[It]-Ct*n[It+1],p[yt+-3]=Ct*n[It]+xt*n[It+1],It+=16,xt=p[Mt+-4]-p[yt+-4],Ct=p[Mt+-5]-p[yt+-5];var Nt=Mt+-4,Lt=p;Lt[Nt]=Lt[Nt]+p[yt+-4];var Gt=Mt+-5,Wt=p;Wt[Gt]=Wt[Gt]+p[yt+-5],p[yt+-4]=xt*n[It]-Ct*n[It+1],p[yt+-5]=Ct*n[It]+xt*n[It+1],It+=16,xt=p[Mt+-6]-p[yt+-6],Ct=p[Mt+-7]-p[yt+-7];var Dt=Mt+-6,Tt=p;Tt[Dt]=Tt[Dt]+p[yt+-6];var Vt=Mt+-7,Kt=p;Kt[Vt]=Kt[Vt]+p[yt+-7],p[yt+-6]=xt*n[It]-Ct*n[It+1],p[yt+-7]=Ct*n[It]+xt*n[It+1],Mt-=8,yt-=8,It+=16}for(var jt=l-1-h,Rt=0,Ht=jt,Pt=jt+-(e>>4),Ft=1+(e>>5>>2);0<--Ft;){var Ot=p[Ht]-p[Pt],Et=p[Ht+-1]-p[Pt+-1],Ut=Ht,Jt=p;Jt[Ut]=Jt[Ut]+p[Pt];var Qt=Ht+-1,qt=p;qt[Qt]=qt[Qt]+p[Pt+-1],p[Pt]=Ot*n[Rt]-Et*n[Rt+1],p[Pt+-1]=Et*n[Rt]+Ot*n[Rt+1],Rt+=16,Ot=p[Ht+-2]-p[Pt+-2],Et=p[Ht+-3]-p[Pt+-3];var $t=Ht+-2,te=p;te[$t]=te[$t]+p[Pt+-2];var ee=Ht+-3,ae=p;ae[ee]=ae[ee]+p[Pt+-3],p[Pt+-2]=Ot*n[Rt]-Et*n[Rt+1],p[Pt+-3]=Et*n[Rt]+Ot*n[Rt+1],Rt+=16,Ot=p[Ht+-4]-p[Pt+-4],Et=p[Ht+-5]-p[Pt+-5];var ie=Ht+-4,ne=p;ne[ie]=ne[ie]+p[Pt+-4];var se=Ht+-5,re=p;re[se]=re[se]+p[Pt+-5],p[Pt+-4]=Ot*n[Rt]-Et*n[Rt+1],p[Pt+-5]=Et*n[Rt]+Ot*n[Rt+1],Rt+=16,Ot=p[Ht+-6]-p[Pt+-6],Et=p[Ht+-7]-p[Pt+-7];var oe=Ht+-6,le=p;le[oe]=le[oe]+p[Pt+-6];var _e=Ht+-7,he=p;he[_e]=he[_e]+p[Pt+-7],p[Pt+-6]=Ot*n[Rt]-Et*n[Rt+1],p[Pt+-7]=Et*n[Rt]+Ot*n[Rt+1],Ht-=8,Pt-=8,Rt+=16}for(var fe=l-1-2*h,ue=0,ce=fe,de=fe+-(e>>4),ge=1+(e>>5>>2);0<--ge;){var pe=p[ce]-p[de],me=p[ce+-1]-p[de+-1],ve=ce,be=p;be[ve]=be[ve]+p[de];var Ie=ce+-1,Me=p;Me[Ie]=Me[Ie]+p[de+-1],p[de]=pe*n[ue]-me*n[ue+1],p[de+-1]=me*n[ue]+pe*n[ue+1],ue+=16,pe=p[ce+-2]-p[de+-2],me=p[ce+-3]-p[de+-3];var ye=ce+-2,we=p;we[ye]=we[ye]+p[de+-2];var xe=ce+-3,Ce=p;Ce[xe]=Ce[xe]+p[de+-3],p[de+-2]=pe*n[ue]-me*n[ue+1],p[de+-3]=me*n[ue]+pe*n[ue+1],ue+=16,pe=p[ce+-4]-p[de+-4],me=p[ce+-5]-p[de+-5];var Ae=ce+-4,Ze=p;Ze[Ae]=Ze[Ae]+p[de+-4];var ze=ce+-5,Be=p;Be[ze]=Be[ze]+p[de+-5],p[de+-4]=pe*n[ue]-me*n[ue+1],p[de+-5]=me*n[ue]+pe*n[ue+1],ue+=16,pe=p[ce+-6]-p[de+-6],me=p[ce+-7]-p[de+-7];var ke=ce+-6,Se=p;Se[ke]=Se[ke]+p[de+-6];var Xe=ce+-7,Ye=p;Ye[Xe]=Ye[Xe]+p[de+-7],p[de+-6]=pe*n[ue]-me*n[ue+1],p[de+-7]=me*n[ue]+pe*n[ue+1],ce-=8,de-=8,ue+=16}for(var Ne=l-1-3*h,Le=0,Ge=Ne,We=Ne+-(e>>4),De=1+(e>>5>>2);0<--De;){var Te=p[Ge]-p[We],Ve=p[Ge+-1]-p[We+-1],Ke=Ge,je=p;je[Ke]=je[Ke]+p[We];var Re=Ge+-1,He=p;He[Re]=He[Re]+p[We+-1],p[We]=Te*n[Le]-Ve*n[Le+1],p[We+-1]=Ve*n[Le]+Te*n[Le+1],Le+=16,Te=p[Ge+-2]-p[We+-2],Ve=p[Ge+-3]-p[We+-3];var Pe=Ge+-2,Fe=p;Fe[Pe]=Fe[Pe]+p[We+-2];var Oe=Ge+-3,Ee=p;Ee[Oe]=Ee[Oe]+p[We+-3],p[We+-2]=Te*n[Le]-Ve*n[Le+1],p[We+-3]=Ve*n[Le]+Te*n[Le+1],Le+=16,Te=p[Ge+-4]-p[We+-4],Ve=p[Ge+-5]-p[We+-5];var Ue=Ge+-4,Je=p;Je[Ue]=Je[Ue]+p[We+-4];var Qe=Ge+-5,qe=p;qe[Qe]=qe[Qe]+p[We+-5],p[We+-4]=Te*n[Le]-Ve*n[Le+1],p[We+-5]=Ve*n[Le]+Te*n[Le+1],Le+=16,Te=p[Ge+-6]-p[We+-6],Ve=p[Ge+-7]-p[We+-7];var $e=Ge+-6,ta=p;ta[$e]=ta[$e]+p[We+-6];var ea=Ge+-7,aa=p;aa[ea]=aa[ea]+p[We+-7],p[We+-6]=Te*n[Le]-Ve*n[Le+1],p[We+-7]=Ve*n[Le]+Te*n[Le+1],Ge-=8,We-=8,Le+=16}for(var ia=2,na=A-3>>1;ia<na;)for(var sa=ia++,ra=e>>sa+2,oa=ra>>1,la=0,_a=1<<sa+1;la<_a;)for(var ha=l-1-ra*la++,fa=1<<sa+3,ua=0,ca=ha,da=ha+-oa,ga=1+(e>>sa+4>>2);0<--ga;){var pa=p[ca]-p[da],ma=p[ca+-1]-p[da+-1],va=ca,ba=p;ba[va]=ba[va]+p[da];var Ia=ca+-1,Ma=p;Ma[Ia]=Ma[Ia]+p[da+-1],p[da]=pa*n[ua]-ma*n[ua+1],p[da+-1]=ma*n[ua]+pa*n[ua+1],ua+=fa,pa=p[ca+-2]-p[da+-2],ma=p[ca+-3]-p[da+-3];var ya=ca+-2,wa=p;wa[ya]=wa[ya]+p[da+-2];var xa=ca+-3,Ca=p;Ca[xa]=Ca[xa]+p[da+-3],p[da+-2]=pa*n[ua]-ma*n[ua+1],p[da+-3]=ma*n[ua]+pa*n[ua+1],ua+=fa,pa=p[ca+-4]-p[da+-4],ma=p[ca+-5]-p[da+-5];var Aa=ca+-4,Za=p;Za[Aa]=Za[Aa]+p[da+-4];var za=ca+-5,Ba=p;Ba[za]=Ba[za]+p[da+-5],p[da+-4]=pa*n[ua]-ma*n[ua+1],p[da+-5]=ma*n[ua]+pa*n[ua+1],ua+=fa,pa=p[ca+-6]-p[da+-6],ma=p[ca+-7]-p[da+-7];var ka=ca+-6,Sa=p;Sa[ka]=Sa[ka]+p[da+-6];var Xa=ca+-7,Ya=p;Ya[Xa]=Ya[Xa]+p[da+-7],p[da+-6]=pa*n[ua]-ma*n[ua+1],p[da+-7]=ma*n[ua]+pa*n[ua+1],ca-=8,da-=8,ua+=fa}for(var Na=A-3>>1,La=A-6;Na<La;)for(var Ga=Na++,Wa=e>>Ga+2,Da=1<<Ga+3,Ta=Wa>>1,Va=1<<Ga+1,Ka=0,ja=l-1,Ra=(e>>Ga+6)+1;0<--Ra;){for(var Ha=n[Ka],Pa=n[Ka+1],Fa=n[Ka+Da],Oa=n[Ka+Da+1],Ea=n[Ka+2*Da],Ua=n[Ka+2*Da+1],Ja=n[Ka+3*Da],Qa=n[Ka+3*Da+1],qa=ja,$a=ja+-Ta,ti=Va+1;0<--ti;){var ei=p[qa]-p[$a],ai=p[qa+-1]-p[$a+-1];p[qa]=p[qa]+p[$a],p[qa+-1]=p[qa+-1]+p[$a+-1],p[$a]=ei*Ha-ai*Pa,p[$a+-1]=ai*Ha+ei*Pa,ei=p[qa+-2]-p[$a+-2],ai=p[qa+-3]-p[$a+-3],p[qa+-2]=p[qa+-2]+p[$a+-2],p[qa+-3]=p[qa+-3]+p[$a+-3],p[$a+-2]=ei*Fa-ai*Oa,p[$a+-3]=ai*Fa+ei*Oa,ei=p[qa+-4]-p[$a+-4],ai=p[qa+-5]-p[$a+-5],p[qa+-4]=p[qa+-4]+p[$a+-4],p[qa+-5]=p[qa+-5]+p[$a+-5],p[$a+-4]=ei*Ea-ai*Ua,p[$a+-5]=ai*Ea+ei*Ua,ei=p[qa+-6]-p[$a+-6],ai=p[qa+-7]-p[$a+-7],p[qa+-6]=p[qa+-6]+p[$a+-6],p[qa+-7]=p[qa+-7]+p[$a+-7],p[$a+-6]=ei*Ja-ai*Qa,p[$a+-7]=ai*Ja+ei*Qa,qa-=Wa,$a-=Wa}Ka+=4*Da,ja-=8}for(var ii=l-1,ni=n[e>>3],si=ii,ri=ii-16*(e>>5);ri<si;){var oi=p[si],li=p[si+-8];p[si+-8]=oi-li,p[si]=oi+li,oi=p[si+-1],li=p[si+-9],p[si+-9]=oi-li,p[si+-1]=oi+li;var _i=(oi=p[si+-2])-(li=p[si+-10]);p[si+-2]=oi+li;var hi=(oi=p[si+-3])-(li=p[si+-11]);p[si+-3]=oi+li,p[si+-10]=(_i+hi)*ni,p[si+-11]=(hi-_i)*ni,oi=p[si+-4],_i=(li=p[si+-12])-oi,p[si+-4]=oi+li,hi=(oi=p[si+-5])-(li=p[si+-13]),p[si+-5]=oi+li,p[si+-12]=hi,p[si+-13]=_i,oi=p[si+-6],_i=(li=p[si+-14])-oi,p[si+-6]=oi+li,hi=(oi=p[si+-7])-(li=p[si+-15]),p[si+-7]=oi+li,p[si+-14]=(_i+hi)*ni,p[si+-15]=(_i-hi)*ni;var fi=p[si],ui=p[si+-4],ci=fi-ui,di=fi+ui,gi=(fi=p[si+-2])+(ui=p[si+-6]),pi=fi-ui;p[si]=di+gi,p[si+-2]=di-gi;var mi=p[si+-3]-p[si+-7];p[si+-4]=ci+mi,p[si+-6]=ci-mi;var vi=(fi=p[si+-1])-(ui=p[si+-5]),bi=fi+ui,Ii=p[si+-3]+p[si+-7];p[si+-1]=bi+Ii,p[si+-3]=bi-Ii,p[si+-5]=vi-pi,p[si+-7]=vi+pi;var Mi=si-8,yi=p[Mi],wi=p[Mi+-4],xi=yi-wi,Ci=yi+wi,Ai=(yi=p[Mi+-2])+(wi=p[Mi+-6]),Zi=yi-wi;p[Mi]=Ci+Ai,p[Mi+-2]=Ci-Ai;var zi=p[Mi+-3]-p[Mi+-7];p[Mi+-4]=xi+zi,p[Mi+-6]=xi-zi;var Bi=(yi=p[Mi+-1])-(wi=p[Mi+-5]),ki=yi+wi,Si=p[Mi+-3]+p[Mi+-7];p[Mi+-1]=ki+Si,p[Mi+-3]=ki-Si,p[Mi+-5]=Bi-Zi,p[Mi+-7]=Bi+Zi,si-=16}for(var Xi=0,Yi=_-4,Ni=l-4;0<=Yi;){var Li=o[Xi];m[Ni+3]=p[Li],m[Ni+2]=p[Li+1],m[Yi+3]=p[Li+2],m[Yi+2]=p[Li+3],Li=o[Xi+1],m[Ni+1]=p[Li],m[Ni]=p[Li+1],m[Yi+1]=p[Li+2],m[Yi]=p[Li+3],Yi-=4,Ni-=4,Xi+=2}for(var Gi=0,Wi=0,Di=l-4;Wi<Di;){var Ti=m[Wi]-m[Di+2],Vi=m[Wi+1]+m[Di+3],Ki=r[Gi+1]*Ti+r[Gi]*Vi,ji=r[Gi+1]*Vi-r[Gi]*Ti,Ri=m[Wi]+m[Di+2],Hi=m[Wi+1]-m[Di+3];m[Wi]=Ri+Ki,m[Wi+1]=Hi+ji,m[Di+2]=Ri-Ki,m[Di+3]=ji-Hi,Ti=m[Wi+2]-m[Di],Vi=m[Wi+3]+m[Di+1],Ki=r[Gi+3]*Ti+r[Gi+2]*Vi,ji=r[Gi+3]*Vi-r[Gi+2]*Ti,Ri=m[Wi+2]+m[Di],Hi=m[Wi+3]-m[Di+1],m[Wi+2]=Ri+Ki,m[Wi+3]=Hi+ji,m[Di]=Ri-Ki,m[Di+1]=ji-Hi,Gi+=4,Wi+=4,Di-=4}for(var Pi=l-8,Fi=l-8,Oi=0,Ei=l-4,Ui=l,Ji=e-4;0<=Fi;){var Qi=f[Fi+6]*s[Pi+7]-f[Fi+7]*s[Pi+6],qi=-f[Fi+6]*s[Pi+6]-f[Fi+7]*s[Pi+7];t[Oi]=Qi,t[Ei+3]=-Qi,t[Ui]=qi,t[Ji+3]=qi;var $i=f[Fi+4]*s[Pi+5]-f[Fi+5]*s[Pi+4],tn=-f[Fi+4]*s[Pi+4]-f[Fi+5]*s[Pi+5];t[Oi+1]=$i,t[Ei+2]=-$i,t[Ui+1]=tn,t[Ji+2]=tn,Qi=f[Fi+2]*s[Pi+3]-f[Fi+3]*s[Pi+2],qi=-f[Fi+2]*s[Pi+2]-f[Fi+3]*s[Pi+3],t[Oi+2]=Qi,t[Ei+1]=-Qi,t[Ui+2]=qi,t[Ji+1]=qi,$i=f[Fi]*s[Pi+1]-f[Fi+1]*s[Pi],tn=-f[Fi]*s[Pi]-f[Fi+1]*s[Pi+1],t[Oi+3]=$i,t[Ei]=-$i,t[Ui+3]=tn,t[Ji]=tn,Pi-=8,Fi-=8,Oi+=4,Ui+=4,Ei-=4,Ji-=4}},decodePacket:function(){var t=this.decodeInitial();return null==t?null:this.decodePacketRest(t)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var t,e=this.decodeState;if(0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,t=e.input.readByte()):t=-1,e.validBits=0,-1==t)break}}var a=this.header.modes.length-1,i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=this.decodeState.readBits(a<16384?a<16?i[a]:a<512?5+i[a>>5]:10+i[a>>10]:a<16777216?a<524288?15+i[a>>15]:20+i[a>>20]:a<536870912?25+i[a>>25]:a<-2147483648?30+i[a>>30]:0);if(-1==n||n>=this.header.modes.length)throw new Jt(new qe($e.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var s,r,o,l=this.header.modes[n];l.blockflag?(s=this.header.blocksize1,r=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(r=o=0,s=this.header.blocksize0);var _=s>>1;return{mode:n,left:l.blockflag&&0==r?{start:s-this.header.blocksize0>>2,end:s+this.header.blocksize0>>2}:{start:0,end:_},right:l.blockflag&&0==o?{start:3*s-this.header.blocksize0>>2,end:3*s+this.header.blocksize0>>2}:{start:_,end:s}}},decodePacketRest:function(t){for(var e=this.header.modes[t.mode],a=new Array(256),i=new Array(256),n=e.blockflag?this.header.blocksize1:this.header.blocksize0,s=this.header.mapping[e.mapping],r=n>>1,o=[256,128,86,64],l=this.header.codebooks,_=0,h=this.header.channel;_<h;){var f=_++,u=s.chan[f].mux;a[f]=!1;var c=this.header.floorConfig[s.submapFloor[u]];if(0==c.type)throw new Jt(new qe($e.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var d=c.floor1;if(0!=this.decodeState.readBits(1)){var g=[],p=new Array(256),m=o[d.floor1Multiplier-1],v=2,b=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(g=this.finalY[f])[0]=this.decodeState.readBits((m<16384?m<16?b[m]:m<512?5+b[m>>5]:10+b[m>>10]:m<16777216?m<524288?15+b[m>>15]:20+b[m>>20]:m<536870912?25+b[m>>25]:m<-2147483648?30+b[m>>30]:0)-1);var I=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];g[1]=this.decodeState.readBits((m<16384?m<16?I[m]:m<512?5+I[m>>5]:10+I[m>>10]:m<16777216?m<524288?15+I[m>>15]:20+I[m>>20]:m<536870912?25+I[m>>25]:m<-2147483648?30+I[m>>30]:0)-1);for(var M=0,y=d.partitions;M<y;){var w=M++,x=d.partitionClassList[w],C=d.classDimensions[x],A=d.classSubclasses[x],Z=(1<<A)-1,z=0;if(0!=A){var B=l[d.classMasterbooks[x]],k=this.decodeState;k.validBits<10&&k.prepHuffman();var S,X=B.fastHuffman[1023&k.acc];if(0<=X){var Y=B.codewordLengths[X];k.acc=k.acc>>>Y,k.validBits-=Y,k.validBits<0?(k.validBits=0,S=-1):S=X}else S=k.decodeScalarRaw(B);B.sparse&&(S=B.sortedValues[S]),z=S}for(var N=d.subclassBooks[x],L=0,G=C;L<G;){L++;var W=N[z&Z];z>>=A;var D,T=v++;if(0<=W){var V=this.decodeState,K=l[W];V.validBits<10&&V.prepHuffman();var j,R=K.fastHuffman[1023&V.acc];if(0<=R){var H=K.codewordLengths[R];V.acc=V.acc>>>H,V.validBits-=H,V.validBits<0?(V.validBits=0,j=-1):j=R}else j=V.decodeScalarRaw(K);K.sparse&&(j=K.sortedValues[j]),D=j}else D=0;g[T]=D}}if(-1==this.decodeState.validBits){a[f]=!0;continue}p[0]=p[1]=!0;for(var P=d.neighbors,F=d.xlist,O=2,E=d.values;O<E;){var U=O++,J=P[U][0],Q=P[U][1],q=F[J],$=g[J],tt=g[Q]-$,et=F[Q]-q,at=Math.abs(tt)*(F[U]-q)/et|0,it=tt<0?$-at:$+at,nt=g[U],st=m-it,rt=st<it?2*st:2*it;0!=nt?(p[J]=p[Q]=!0,p[U]=!0,g[U]=rt<=nt?it<st?nt-it+it:it-nt+st-1:0!=(1&nt)?it-(nt+1>>1):it+(nt>>1)):(p[U]=!1,g[U]=it)}for(var ot=0,lt=d.values;ot<lt;){var _t=ot++;p[_t]||(g[_t]=-1)}}else a[f]=!0}for(var ht=0,ft=this.header.channel;ht<ft;){var ut=ht++;i[ut]=a[ut]}for(var ct=0,dt=s.couplingSteps;ct<dt;){var gt=ct++;a[s.chan[gt].magnitude]&&a[s.chan[gt].angle]||(a[s.chan[gt].magnitude]=a[s.chan[gt].angle]=!1)}for(var pt=0,mt=s.submaps;pt<mt;){for(var vt=pt++,bt=new Array(this.header.channel),It=new Array(256),Mt=0,yt=0,wt=this.header.channel;yt<wt;){var xt=yt++;s.chan[xt].mux==vt&&(a[xt]?(It[Mt]=!0,bt[Mt]=null):(It[Mt]=!1,bt[Mt]=this.channelBuffers[xt]),++Mt)}var Ct=s.submapResidue[vt];this.header.residueConfig[Ct].decode(this.decodeState,this.header,bt,Mt,r,It,this.channelBuffers)}for(var At=s.couplingSteps,Zt=n>>1;0<=--At;)for(var zt=this.channelBuffers[s.chan[At].magnitude],Bt=this.channelBuffers[s.chan[At].angle],kt=0,St=Zt;kt<St;){var Xt,Yt,Nt=kt++;0<zt[Nt]?0<Bt[Nt]?(Yt=zt[Nt],Xt=zt[Nt]-Bt[Nt]):(Xt=zt[Nt],Yt=zt[Nt]+Bt[Nt]):0<Bt[Nt]?(Yt=zt[Nt],Xt=zt[Nt]+Bt[Nt]):(Xt=zt[Nt],Yt=zt[Nt]-Bt[Nt]),zt[Nt]=Yt,Bt[Nt]=Xt}for(var Lt=0,Gt=this.header.channel;Lt<Gt;){var Wt=Lt++;if(i[Wt])for(var Dt=0,Tt=Zt;Dt<Tt;){var Vt=Dt++;this.channelBuffers[Wt][Vt]=0}else s.doFloor(this.header.floorConfig,Wt,n,this.channelBuffers[Wt],this.finalY[Wt],null)}for(var Kt=0,jt=this.header.channel;Kt<jt;){var Rt=Kt++;this.inverseMdct(this.channelBuffers[Rt],n,e.blockflag)}for(var Ht=this.decodeState;0!=Ht.bytesInSeg||!Ht.lastSeg&&0!=Ht.next();)Ht.bytesInSeg--,Ht.inputPosition+=1,Ht.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,n,t)},__class__:Le};var Ge=function(){};(i["kha.audio2.ogg.vorbis.VorbisTools"]=Ge).__name__=!0,Ge.pointCompare=function(t,e){return t.x<e.x?-1:t.x>e.x?1:0},Ge.uintAsc=function(t,e){return Lt.gt(e,t)?-1:t==e?0:1},Ge.lookup1Values=function(t,e){var a=0|Math.exp(Math.log(t)/e);return(0|Math.pow(a+1,e))<=t&&++a,a},Ge.computeWindow=function(t,e){for(var a=t>>1,i=0,n=a;i<n;){var s=i++;e[s]=Math.sin(1.5707963267948966*Ge.square(Math.sin((s+.5)/a*.5*3.141592653589793)))}},Ge.square=function(t){return t*t},Ge.computeBitReverse=function(t,e){for(var a=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],i=(t<16384?t<16?a[t]:t<512?5+a[t>>5]:10+a[t>>10]:t<16777216?t<524288?15+a[t>>15]:20+a[t>>20]:t<536870912?25+a[t>>25]:t<-2147483648?30+a[t>>30]:0)-1,n=0,s=t>>3;n<s;){var r=n++,o=r;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e[r]=(o>>>16|o<<16)>>>32-i+3<<2}},Ge.computeTwiddleFactors=function(t,e,a,i){for(var n=t>>3,s=0,r=0,o=t>>2;r<o;){var l=r++;e[s]=Math.cos(4*l*3.141592653589793/t),e[s+1]=-Math.sin(4*l*3.141592653589793/t),a[s]=.5*Math.cos(3.141592653589793*(s+1)/t/2),a[s+1]=.5*Math.sin(3.141592653589793*(s+1)/t/2),s+=2}for(var _=0,h=0,f=n;h<f;){h++;i[_]=Math.cos(2*(_+1)*3.141592653589793/t),i[_+1]=-Math.sin(2*(_+1)*3.141592653589793/t),_+=2}},Ge.drawLine=function(t,e,a,i,n,s){if(null==Ge.integerDivideTable){var r=new Array(32);Ge.integerDivideTable=r;for(var o=0;o<32;){var l=o++,_=Ge.integerDivideTable,h=new Array(64);_[l]=h;for(var f=1;f<64;){var u=f++;Ge.integerDivideTable[l][u]=l/u|0}}}var c,d,g=n-a,p=i-e,m=g<0?-g:g,v=e,b=a,I=0;p<64&&m<32?d=g<0?(c=-Ge.integerDivideTable[m][p])-1:(c=Ge.integerDivideTable[m][p])+1:(c=g/p|0,d=g<0?c-1:c+1),m-=(c<0?-c:c)*p,s<i&&(i=s);var M=v,y=t;y[M]=y[M]*Ge.INVERSE_DB_TABLE[b];for(var w=v+1,x=i;w<x;){p<=(I+=m)?(I-=p,b+=d):b+=c;var C=w++,A=t;A[C]=A[C]*Ge.INVERSE_DB_TABLE[b]}};var We=function(){};(i["kha.audio2.ogg.vorbis.data.Codebook"]=We).__name__=!0,We.read=function(t){var e=new We;if(66!=t.readBits(8)||67!=t.readBits(8)||86!=t.readBits(8))throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var a=t.readBits(8);e.dimensions=(t.readBits(8)<<8)+a;var i=t.readBits(8),n=t.readBits(8);e.entries=(t.readBits(8)<<16)+(n<<8)+i;var s=t.readBits(1);e.sparse=0==s&&0!=t.readBits(1);var r=new Array(e.entries);e.sparse||(e.codewordLengths=r);var o,l=0;if(0!=s)for(var _=0,h=t.readBits(5)+1;_<e.entries;){var f=e.entries-_,u=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],c=t.readBits(f<16384?f<16?u[f]:f<512?5+u[f>>5]:10+u[f>>10]:f<16777216?f<524288?15+u[f>>15]:20+u[f>>20]:f<536870912?25+u[f>>25]:f<-2147483648?30+u[f>>30]:0);if(_+c>e.entries)throw new Jt(new qe($e.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var d=0,g=c;d<g;){r[_+d++]=h}_+=c,++h}else for(var p=0,m=e.entries;p<m;){var v=p++;0!=(e.sparse?t.readBits(1):1)?(r[v]=t.readBits(5)+1,++l):r[v]=255}if(e.sparse&&l>=e.entries>>2&&(e.codewordLengths=r,e.sparse=!1),e.sparse)o=l;else{for(var b=0,I=0,M=e.entries;I<M;){var y=r[I++];10<y&&255!=y&&++b}o=b}e.sortedEntries=o;var w=null;if(e.sparse){if(0!=e.sortedEntries){var x=new Array(e.sortedEntries);e.codewordLengths=x;var C=new Array(e.entries);e.codewords=C,w=new Array(e.entries)}e.entries,e.sortedEntries}else{var A=new Array(e.entries);e.codewords=A}if(!e.computeCodewords(r,e.entries,w))throw new Jt(new qe($e.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=e.sortedEntries){e.sortedCodewords=[];var Z=new Array(e.sortedEntries);e.sortedValues=Z,e.computeSortedHuffman(r,w)}if(e.sparse&&(w=null,r=e.codewords=null),e.computeAcceleratedHuffman(),e.lookupType=t.readBits(4),2<e.lookupType)throw new Jt(new qe($e.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<e.lookupType){var z=t.readBits(32),B=Lt.toFloat(2097151&z),k=(2145386496&z)>>>21,S=0!=(-2147483648&z)?-B:B;e.minimumValue=S*Math.pow(2,k-788);var X=t.readBits(32),Y=Lt.toFloat(2097151&X),N=(2145386496&X)>>>21,L=0!=(-2147483648&X)?-Y:Y;e.deltaValue=L*Math.pow(2,N-788),e.valueBits=t.readBits(4)+1,e.sequenceP=0!=t.readBits(1),1==e.lookupType?e.lookupValues=Ge.lookup1Values(e.entries,e.dimensions):e.lookupValues=e.entries*e.dimensions;for(var G=new Array(e.lookupValues),W=0,D=e.lookupValues;W<D;){var T=W++,V=t.readBits(e.valueBits);if(-1==V)throw new Jt(new qe($e.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));G[T]=V}var K=new Array(e.lookupValues);e.multiplicands=K;for(var j=0,R=e.lookupValues;j<R;){var H=j++;e.multiplicands[H]=G[H]*e.deltaValue+e.minimumValue}if(2==e.lookupType&&e.sequenceP){for(var P=1,F=e.lookupValues;P<F;){var O=P++;e.multiplicands[O]=e.multiplicands[O-1]}e.sequenceP=!1}}return e},We.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,computeCodewords:function(t,e,a){for(var i=new Array(32),n=0;n<32;){i[n++]=0}for(var s=0;s<e&&!(t[s]<255);)++s;if(s==e)return!0;var r=0,o=r++;this.sparse?(this.codewords[o]=0,this.codewordLengths[o]=t[s],a[o]=s):this.codewords[s]=0;for(var l=0;++l<=t[s];)i[l]=1<<32-l;for(l=s;++l<e;){var _=t[l];if(255!=_){for(;0<_&&0==i[_];)--_;if(0==_)return!1;var h=i[_];i[_]=0;var f=h,u=(f=(-16711936&(f=(-252645136&(f=(-858993460&(f=(-1431655766&f)>>>1|(1431655765&f)<<1))>>>2|(858993459&f)<<2))>>>4|(252645135&f)<<4))>>>8|(16711935&f)<<8)>>>16|f<<16,c=r++;if(this.sparse?(this.codewords[c]=u,this.codewordLengths[c]=t[l],a[c]=l):this.codewords[l]=u,_!=t[l])for(var d=t[l];_<d;)i[d]=h+(1<<32-d),--d}}return!0},computeSortedHuffman:function(t,e){if(this.sparse)for(var a=0,i=this.sortedEntries;a<i;){var n=a++,s=this.codewords[n];s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8,this.sortedCodewords[n]=s>>>16|s<<16}else for(var r=0,o=0,l=this.entries;o<l;){var _=o++,h=t[_];if(this.sparse||255!=h&&10<h){var f=this.codewords[_];f=(-16711936&(f=(-252645136&(f=(-858993460&(f=(-1431655766&f)>>>1|(1431655765&f)<<1))>>>2|(858993459&f)<<2))>>>4|(252645135&f)<<4))>>>8|(16711935&f)<<8,this.sortedCodewords[r++]=f>>>16|f<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(Ge.uintAsc);for(var u=0,c=this.sparse?this.sortedEntries:this.entries;u<c;){var d=u++,g=this.sparse?t[e[d]]:t[d];if(this.sparse||255!=g&&10<g){for(var p=this.codewords[d],m=(p=(-16711936&(p=(-252645136&(p=(-858993460&(p=(-1431655766&p)>>>1|(1431655765&p)<<1))>>>2|(858993459&p)<<2))>>>4|(252645135&p)<<4))>>>8|(16711935&p)<<8)>>>16|p<<16,v=0,b=this.sortedEntries;1<b;){var I=v+(b>>1);Lt.gte(m,this.sortedCodewords[I])?(v=I,b-=b>>1):b>>=1}this.sparse?(this.sortedValues[v]=e[d],this.codewordLengths[v]=g):this.sortedValues[v]=d}}},computeAcceleratedHuffman:function(){var t=new Array(1024);this.fastHuffman=t,this.fastHuffman[0]=-1;for(var e=0;e<1024;){var a=e++;this.fastHuffman[a]=-1}for(var i=0,n=this.sparse?this.sortedEntries:this.entries;i<n;){var s=i++;if(this.codewordLengths[s]<=10){var r;if(this.sparse){var o=this.sortedCodewords[s];r=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else r=this.codewords[s];for(;r<1024;)this.fastHuffman[r]=s,r+=1<<this.codewordLengths[s]}}},codebookDecode:function(t,e,a,i){t.validBits<10&&t.prepHuffman();var n,s=this.fastHuffman[1023&t.acc];if(0<=s){var r=this.codewordLengths[s];t.acc=t.acc>>>r,t.validBits-=r,t.validBits<0?(t.validBits=0,n=-1):n=s}else n=t.decodeScalarRaw(this);this.sparse&&(n=this.sortedValues[n]);var o=n,l=this.lookupValues,_=this.sequenceP,h=this.multiplicands,f=this.minimumValue;if(o<0)return!1;if(i>this.dimensions&&(i=this.dimensions),1==this.lookupType){for(var u=1,c=0,d=0,g=i;d<g;){var p=d++,m=h[Lt.toFloat(o/u|0)%Lt.toFloat(l)|0]+c,v=a+p,b=e;b[v]=b[v]+m,_&&(c=m+f),u*=l}return!0}if(o*=this.dimensions,_)for(var I=0,M=0,y=i;M<y;){var w=M++,x=h[o+w]+I,C=a+w,A=e;A[C]=A[C]+x,I=x+f}else for(var Z=0,z=i;Z<z;){var B=Z++,k=a+B,S=e;S[k]=S[k]+(h[o+B]+0)}return!0},codebookDecodeStep:function(t,e,a,i,n){t.validBits<10&&t.prepHuffman();var s,r=this.fastHuffman[1023&t.acc];if(0<=r){var o=this.codewordLengths[r];t.acc=t.acc>>>o,t.validBits-=o,t.validBits<0?(t.validBits=0,s=-1):s=r}else s=t.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var l=s,_=0;if(l<0)return!1;i>this.dimensions&&(i=this.dimensions);var h=this.lookupValues,f=this.sequenceP,u=this.multiplicands;if(1==this.lookupType){for(var c=1,d=0,g=i;d<g;){var p=d++,m=u[Lt.toFloat(l/c|0)%Lt.toFloat(h)|0]+_,v=a+p*n,b=e;b[v]=b[v]+m,f&&(_=m),c*=h}return!0}l*=this.dimensions;for(var I=0,M=i;I<M;){var y=I++,w=u[l+y]+_,x=a+y*n,C=e;C[x]=C[x]+w,f&&(_=w)}return!0},decodeDeinterleaveRepeat:function(t,e,a,i,n,s,r){var o=this.dimensions;if(0==this.lookupType)throw new Jt(new qe($e.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,_=this.sequenceP,h=this.lookupValues;0<r;){var f=0;t.validBits<10&&t.prepHuffman();var u,c=this.fastHuffman[1023&t.acc];if(0<=c){var d=this.codewordLengths[c];t.acc=t.acc>>>d,t.validBits-=d,t.validBits<0?(t.validBits=0,u=-1):u=c}else u=t.decodeScalarRaw(this);this.sparse&&(u=this.sortedValues[u]);var g=u;if(g<0){if(0==t.bytesInSeg&&t.lastSeg)return null;throw new Jt(new qe($e.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(s*a<i+n*a+o&&(o=s*a-(n*a-i)),1==this.lookupType){var p=1;if(_)for(var m=0,v=o;m<v;){m++;var b=l[Lt.toFloat(g/p|0)%Lt.toFloat(h)|0]+f,I=n,M=e[i];M[I]=M[I]+b,++i==a&&(i=0,++n),f=b,p*=h}else for(var y=0,w=o;y<w;){y++;var x=l[Lt.toFloat(g/p|0)%Lt.toFloat(h)|0]+f,C=n,A=e[i];A[C]=A[C]+x,++i==a&&(i=0,++n),p*=h}}else if(g*=this.dimensions,_)for(var Z=0,z=o;Z<z;){var B=l[g+Z++]+f,k=n,S=e[i];S[k]=S[k]+B,++i==a&&(i=0,++n),f=B}else for(var X=0,Y=o;X<Y;){var N=l[g+X++]+f,L=n,G=e[i];G[L]=G[L]+N,++i==a&&(i=0,++n)}r-=o}return{cInter:i,pInter:n}},residueDecode:function(t,e,a,i,n){if(0==n)for(var s=i/this.dimensions|0,r=0,o=s;r<o;){var l=r++;if(!this.codebookDecodeStep(t,e,a+l,i-a-l,s))return!1}else for(var _=0;_<i;){if(!this.codebookDecode(t,e,a,i-_))return!1;_+=this.dimensions,a+=this.dimensions}return!0},__class__:We};var De=function(){this.data=new et};(i["kha.audio2.ogg.vorbis.data.Comment"]=De).__name__=!0,De.prototype={data:null,get_loopStart:function(){return X.parseInt(this.getString("loopstart"))},get_loopLength:function(){return X.parseInt(this.getString("looplength"))},add:function(t,e){t=t.toLowerCase();var a=this.data;if(null!=fs[t]?a.existsReserved(t):a.h.hasOwnProperty(t)){var i=this.data;(null!=fs[t]?i.getReserved(t):i.h[t]).push(e)}else{var n=[e],s=this.data;null!=fs[t]?s.setReserved(t,n):s.h[t]=n}},getString:function(t){t=t.toLowerCase();var e=this.data;if(null!=fs[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var a=this.data;return(null!=fs[t]?a.getReserved(t):a.h[t])[0]}return null},__class__:De,__properties__:{get_loopLength:"get_loopLength",get_loopStart:"get_loopStart"}};var Te=function(){};(i["kha.audio2.ogg.vorbis.data.Floor"]=Te).__name__=!0,Te.read=function(t,e){var a=new Te;if(a.type=t.readBits(16),1<a.type)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==a.type){var i=a.floor0=new Ve;i.order=t.readBits(8),i.rate=t.readBits(16),i.barkMapSize=t.readBits(16),i.amplitudeBits=t.readBits(6),i.amplitudeOffset=t.readBits(8),i.numberOfBooks=t.readBits(4)+1;for(var n=0,s=i.numberOfBooks;n<s;){var r=n++;i.bookList[r]=t.readBits(8)}throw new Jt(new qe($e.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=a.floor1=new Ke,_=-1;l.partitions=t.readBits(5);var h=new Array(l.partitions);l.partitionClassList=h;for(var f=0,u=l.partitions;f<u;){var c=f++;l.partitionClassList[c]=t.readBits(4),l.partitionClassList[c]>_&&(_=l.partitionClassList[c])}var d=new Array(_+1);l.classDimensions=d;var g=new Array(_+1);l.classMasterbooks=g;var p=new Array(_+1);l.classSubclasses=p;var m=new Array(_+1);l.subclassBooks=m;for(var v=0,b=_+1;v<b;){var I=v++;if(l.classDimensions[I]=t.readBits(3)+1,l.classSubclasses[I]=t.readBits(2),0!=l.classSubclasses[I]&&(l.classMasterbooks[I]=t.readBits(8),l.classMasterbooks[I]>=e.length))throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var M=1<<l.classSubclasses[I],y=l.subclassBooks,w=new Array(M);y[I]=w;for(var x=0,C=M;x<C;){var A=x++;if(l.subclassBooks[I][A]=t.readBits(8)-1,l.subclassBooks[I][A]>=e.length)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=t.readBits(2)+1,l.rangebits=t.readBits(4);var Z=new Array(250);l.xlist=Z,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var z=0,B=l.partitions;z<B;)for(var k=z++,S=l.partitionClassList[k],X=0,Y=l.classDimensions[S];X<Y;){X++;l.xlist[l.values]=t.readBits(l.rangebits),l.values++}for(var N=0,L=l.values;N<L;){var G=N++;o.push(new He),o[G].x=l.xlist[G],o[G].y=G}o.sort(Ge.pointCompare);var W=new Array(l.values);l.sortedOrder=W;for(var D=0,T=l.values;D<T;){var V=D++;l.sortedOrder[V]=o[V].y}var K=new Array(l.values);l.neighbors=K;for(var j=2,R=l.values;j<R;){for(var H=j++,P=l.xlist,F=-1,O=65536,E=0,U=0,J=0,Q=H;J<Q;){var q=J++;P[q]>F&&P[q]<P[H]&&(F=P[E=q]),P[q]<O&&P[q]>P[H]&&(O=P[U=q])}var $=E,tt=U,et=l.neighbors,at=new Array(l.values);et[H]=at,l.neighbors[H][0]=$,l.neighbors[H][1]=tt}return a},Te.prototype={floor0:null,floor1:null,type:null,__class__:Te};var Ve=function(){};(i["kha.audio2.ogg.vorbis.data.Floor0"]=Ve).__name__=!0,Ve.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:Ve};var Ke=function(){};(i["kha.audio2.ogg.vorbis.data.Floor1"]=Ke).__name__=!0,Ke.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Ke};var Re=function(){};(i["kha.audio2.ogg.vorbis.data.Header"]=Re).__name__=!0,Re.read=function(t){var e=t.page;if(e.start(t),0==(2&e.flag))throw new Jt(new qe($e.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&e.flag))throw new Jt(new qe($e.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&e.flag))throw new Jt(new qe($e.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.firstPageValidate(),t.inputPosition+=1,1!=t.input.readByte())throw new Jt(new qe($e.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var a=new nt(new us(6)),i=0;i<6;){var n,s=i++;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,n=t.input.readByte()):n=-1,t.validBits=0,a.b[s]=255&n}if("vorbis"!=a.toString())throw new Jt(new qe($e.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));t.inputPosition+=4;var r=t.input.readInt32();if(0!=r)throw new Jt(new qe($e.INVALID_FIRST_PAGE,"vorbis version : "+r,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var o=new Re;if(t.inputPosition+=1,o.channel=t.input.readByte(),0==o.channel)throw new Jt(new qe($e.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<o.channel)throw new Jt(new qe($e.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.inputPosition+=4,o.sampleRate=t.input.readInt32(),0==o.sampleRate)throw new Jt(new qe($e.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=4,o.maximumBitRate=t.input.readInt32(),t.inputPosition+=4,o.nominalBitRate=t.input.readInt32(),t.inputPosition+=4,o.minimumBitRate=t.input.readInt32(),t.inputPosition+=1;var l=t.input.readByte(),_=15&l,h=l>>4;if(o.blocksize0=1<<_,o.blocksize1=1<<h,_<6||13<_)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(h<6||13<h)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(h<_)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=1;var f=t.input.readByte();if(0==(1&f))throw new Jt(new qe($e.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.page.start(t),t.startPacket();for(var u=0,c=new rt;0!=(u=t.next());)t.inputPosition+=u,c.write(t.input.read(u)),t.bytesInSeg=0;var d=new st(c.getBytes());d.readByte(),d.read(6);var g,p=d.readInt32();o.vendor=d.readString(p),o.comment=new De;for(var m=0,v=d.readInt32();m<v;){m++;var b=d.readInt32(),I=d.readString(b),M=I.indexOf("=");-1!=M&&o.comment.add(I.substring(0,M),I.substring(M+1))}if(0==(1&d.readByte()))throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.startPacket(),0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,g=t.input.readByte()):g=-1,t.validBits=0,5!=g)throw new Jt(new qe($e.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var y=new nt(new us(6)),w=0;w<6;){var x,C=w++;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,x=t.input.readByte()):x=-1,t.validBits=0,y.b[C]=255&x}if("vorbis"!=y.toString())throw new Jt(new qe($e.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var A=t.readBits(8)+1,Z=new Array(A);o.codebooks=Z;for(var z=0,B=A;z<B;){var k=z++;o.codebooks[k]=We.read(t)}for(var S=0,X=f=t.readBits(6)+1;S<X;){S++;if(0!=t.readBits(16))throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var Y=t.readBits(6)+1,N=new Array(Y);o.floorConfig=N;for(var L=0,G=Y;L<G;){var W=L++;o.floorConfig[W]=Te.read(t,o.codebooks)}var D=t.readBits(6)+1,T=new Array(D);o.residueConfig=T;for(var V=0,K=D;V<K;){var j=V++;o.residueConfig[j]=ta.read(t,o.codebooks)}var R=t.readBits(6)+1,H=new Array(R);o.mapping=H;for(var P=0,F=R;P<F;)for(var O=P++,E=Oe.read(t,o.channel),U=0,J=(o.mapping[O]=E).submaps;U<J;){var Q=U++;if(E.submapFloor[Q]>=o.floorConfig.length)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(E.submapResidue[Q]>=o.residueConfig.length)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var q=t.readBits(6)+1,$=new Array(q);o.modes=$;for(var tt=0,et=q;tt<et;){var at=tt++,it=Ue.read(t);if((o.modes[at]=it).mapping>=o.mapping.length)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next();)t.bytesInSeg--,t.inputPosition+=1,t.input.readByte();return o},Re.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Re};var He=function(){};(i["kha.audio2.ogg.vorbis.data.IntPoint"]=He).__name__=!0,He.prototype={x:null,y:null,__class__:He};var Oe=function(){};(i["kha.audio2.ogg.vorbis.data.Mapping"]=Oe).__name__=!0,Oe.read=function(t,e){var a=new Oe,i=t.readBits(16);if(0!=i)throw new Jt(new qe($e.INVALID_SETUP,"mapping type "+i,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var n=new Array(e);a.chan=n;for(var s=0,r=e;s<r;){var o=s++;a.chan[o]=new Ee}if(0!=t.readBits(1)?a.submaps=t.readBits(4)+1:a.submaps=1,0!=t.readBits(1)){a.couplingSteps=t.readBits(8)+1;for(var l=0,_=a.couplingSteps;l<_;){var h=l++,f=e-1,u=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];a.chan[h].magnitude=t.readBits(f<16384?f<16?u[f]:f<512?5+u[f>>5]:10+u[f>>10]:f<16777216?f<524288?15+u[f>>15]:20+u[f>>20]:f<536870912?25+u[f>>25]:f<-2147483648?30+u[f>>30]:0);var c=e-1,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(a.chan[h].angle=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0),a.chan[h].magnitude>=e)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(a.chan[h].angle>=e)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(a.chan[h].magnitude==a.chan[h].angle)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else a.couplingSteps=0;if(0!=t.readBits(2))throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<a.submaps)for(var g=0,p=e;g<p;){var m=g++;if(a.chan[m].mux=t.readBits(4),a.chan[m].mux>=a.submaps)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var v=0,b=e;v<b;){var I=v++;a.chan[I].mux=0}var M=new Array(a.submaps);a.submapFloor=M;var y=new Array(a.submaps);a.submapResidue=y;for(var w=0,x=a.submaps;w<x;){var C=w++;t.readBits(8),a.submapFloor[C]=t.readBits(8),a.submapResidue[C]=t.readBits(8)}return a},Oe.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(t,e,a,i,n,s){var r=a>>1,o=this.chan[e].mux,l=t[this.submapFloor[o]];if(0==l.type)throw new Jt(new qe($e.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var _=l.floor1,h=0,f=n[0]*_.floor1Multiplier,u=1,c=_.values;u<c;){var d=u++,g=_.sortedOrder[d];if(0<=n[g]){var p=n[g]*_.floor1Multiplier,m=_.xlist[g];Ge.drawLine(i,h,f,m,p,r),h=m,f=p}}if(h<r)for(var v=h,b=r;v<b;){var I=v++,M=i;M[I]=M[I]*Ge.INVERSE_DB_TABLE[f]}},__class__:Oe};var Ee=function(){};(i["kha.audio2.ogg.vorbis.data.MappingChannel"]=Ee).__name__=!0,Ee.prototype={magnitude:null,angle:null,mux:null,__class__:Ee};var Ue=function(){};(i["kha.audio2.ogg.vorbis.data.Mode"]=Ue).__name__=!0,Ue.read=function(t){var e=new Ue;if(e.blockflag=0!=t.readBits(1),e.windowtype=t.readBits(16),e.transformtype=t.readBits(16),e.mapping=t.readBits(8),0!=e.windowtype)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=e.transformtype)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return e},Ue.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:Ue};var Je=function(){};(i["kha.audio2.ogg.vorbis.data.Page"]=Je).__name__=!0,Je.prototype={flag:null,clone:function(){var t=new Je;return t.flag=this.flag,t},start:function(t){var e,a,i;if(t.inputPosition+=1,79==t.input.readByte()?(t.inputPosition+=1,i=103!=t.input.readByte()):i=!0,i?a=!0:(t.inputPosition+=1,a=103!=t.input.readByte()),a?e=!0:(t.inputPosition+=1,e=83!=t.input.readByte()),e)throw new Jt(new qe($e.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(t)},startWithoutCapturePattern:function(t){t.inputPosition+=1;var e=t.input.readByte();if(0!=e)throw new Jt(new qe($e.INVALID_STREAM_STRUCTURE_VERSION,""+e,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));t.inputPosition+=1,this.flag=t.input.readByte(),t.inputPosition+=4;var a=t.input.readInt32();t.inputPosition+=4;var i=t.input.readInt32();t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.setup(a,i)},__class__:Je};var Qe=function(){};(i["kha.audio2.ogg.vorbis.data.ProbedPage"]=Qe).__name__=!0,Qe.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:Qe};var qe=function(t,e,a){null==e&&(e=""),this.type=t,this.message=e,this.posInfos=a};(i["kha.audio2.ogg.vorbis.data.ReaderError"]=qe).__name__=!0,qe.prototype={type:null,message:null,posInfos:null,__class__:qe};var $e=I["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n}},ta=function(){};(i["kha.audio2.ogg.vorbis.data.Residue"]=ta).__name__=!0,ta.read=function(t,e){var a=new ta;if(a.type=t.readBits(16),2<a.type)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var i=new Array(64);a.begin=t.readBits(24),a.end=t.readBits(24),a.partSize=t.readBits(24)+1;var n=a.classifications=t.readBits(6)+1;a.classbook=t.readBits(8);for(var s=0,r=a.classifications;s<r;){var o=s++,l=0,_=t.readBits(3);0!=t.readBits(1)&&(l=t.readBits(5)),i[o]=8*l+_}var h=new Array(a.classifications);a.residueBooks=h;for(var f=0,u=a.classifications;f<u;){var c=f++,d=a.residueBooks,g=new Array(8);d[c]=g;for(var p=0;p<8;){var m=p++;if(0!=(i[c]&1<<m)){if(a.residueBooks[c][m]=t.readBits(8),a.residueBooks[c][m]>=e.length)throw new Jt(new qe($e.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else a.residueBooks[c][m]=-1}}var v=e[a.classbook].entries,b=e[a.classbook].dimensions,I=new Array(v);a.classdata=I;for(var M=0,y=v;M<y;)for(var w=M++,x=w,C=b,A=a.classdata,Z=new Array(b),z=A[w]=Z;0<=--C;)z[C]=x%n,x=x/n|0;return a},ta.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(t,e,a,i,n,s,r){for(var o=e.codebooks,l=o[this.classbook].dimensions,_=this.end-this.begin,h=this.partSize,f=Lt.toFloat(_)/Lt.toFloat(h)|0,u=new Array(e.channel*f+1),c=0,d=i;c<d;){var g=c++;if(!s[g])for(var p=a[g],m=0,v=p.length;m<v;){p[m++]=0}}if(2!=this.type||1==i)for(var b=0;b<8;)for(var I=b++,M=0;M<f;){if(0==I)for(var y=0,w=i;y<w;){var x=y++;if(!s[x]){var C=o[this.classbook];t.validBits<10&&t.prepHuffman();var A,Z=C.fastHuffman[1023&t.acc];if(0<=Z){var z=C.codewordLengths[Z];t.acc=t.acc>>>z,t.validBits-=z,t.validBits<0?(t.validBits=0,A=-1):A=Z}else A=t.decodeScalarRaw(C);C.sparse&&(A=C.sortedValues[A]);var B=A;if(-1==B)return;for(var k=l;0<=--k;)u[x*f+k+M]=B%this.classifications,B=B/this.classifications|0}}for(var S=0,X=l;S<X;){S++;if(f<=M)break;for(var Y=0,N=i;Y<N;){var L=Y++;if(!s[L]){var G=u[L*f+M],W=this.residueBooks[G][I];if(0<=W){var D=a[L],T=this.begin+M*h,V=h;if(!o[W].residueDecode(t,D,T,V,this.type))return}}}++M}}else{for(var K=0,j=i;K<j;){var R=K++;if(!s[R])break;if(R==i-1)return}for(var H=0;H<8;){var P=H++,F=0;if(2==i)for(;F<f;){var O=this.begin+F*h,E=1&O,U=O>>>1;if(0==P){var J=o[this.classbook];t.validBits<10&&t.prepHuffman();var Q,q=J.fastHuffman[1023&t.acc];if(0<=q){var $=J.codewordLengths[q];t.acc=t.acc>>>$,t.validBits-=$,t.validBits<0?(t.validBits=0,Q=-1):Q=q}else Q=t.decodeScalarRaw(J);J.sparse&&(Q=J.sortedValues[Q]);var tt=Q;if(-1==tt)return;for(var et=l;0<=--et;)u[et+F]=tt%this.classifications,tt=tt/this.classifications|0}for(var at=0,it=l;at<it;){at++;if(f<=F)break;var nt=this.begin+F*h,st=u[F],rt=this.residueBooks[st][P];if(0<=rt){var ot=o[rt].decodeDeinterleaveRepeat(t,a,i,E,U,n,h);if(null==ot)return;E=ot.cInter,U=ot.pInter}else E=1&(nt+=h),U=nt>>>1;++F}}else if(1==i)for(;F<f;){var lt=0,_t=this.begin+F*h;if(0==P){var ht=o[this.classbook];t.validBits<10&&t.prepHuffman();var ft,ut=ht.fastHuffman[1023&t.acc];if(0<=ut){var ct=ht.codewordLengths[ut];t.acc=t.acc>>>ct,t.validBits-=ct,t.validBits<0?(t.validBits=0,ft=-1):ft=ut}else ft=t.decodeScalarRaw(ht);ht.sparse&&(ft=ht.sortedValues[ft]);var dt=ft;if(-1==dt)return;for(var gt=l;0<=--gt;)u[gt+F]=dt%this.classifications,dt=dt/this.classifications|0}for(var pt=0,mt=l;pt<mt;){pt++;if(f<=F)break;var vt=this.begin+F*h,bt=this.residueBooks[u[F]][P];if(0<=bt){var It=o[bt].decodeDeinterleaveRepeat(t,a,i,lt,_t,n,h);if(null==It)return;lt=It.cInter,_t=It.pInter}else lt=0,_t=vt+=h;++F}}else for(;F<f;){var Mt=this.begin+F*h,yt=Lt.toFloat(Mt)%Lt.toFloat(i)|0,wt=Lt.toFloat(Mt)/Lt.toFloat(i)|0;if(0==P){var xt=o[this.classbook];t.validBits<10&&t.prepHuffman();var Ct,At=xt.fastHuffman[1023&t.acc];if(0<=At){var Zt=xt.codewordLengths[At];t.acc=t.acc>>>Zt,t.validBits-=Zt,t.validBits<0?(t.validBits=0,Ct=-1):Ct=At}else Ct=t.decodeScalarRaw(xt);xt.sparse&&(Ct=xt.sortedValues[Ct]);var zt=Ct;if(-1==zt)return;for(var Bt=l;0<=--Bt;)u[Bt+F]=zt%this.classifications,zt=zt/this.classifications|0}for(var kt=0,St=l;kt<St;){kt++;if(f<=F)break;var Xt=this.begin+F*h,Yt=this.residueBooks[u[F]][P];if(0<=Yt){var Nt=o[Yt].decodeDeinterleaveRepeat(t,a,i,yt,wt,n,h);if(null==Nt)return;yt=Nt.cInter,wt=Nt.pInter}else Xt+=h,yt=Lt.toFloat(Xt)%Lt.toFloat(i)|0,wt=Lt.toFloat(Xt)/Lt.toFloat(i)|0;++F}}}}},__class__:ta};var ea=function(){};(i["kha.graphics1.Graphics"]=ea).__name__=!0;var aa=function(){this.transformations=[],this.transformations.push(new Ct(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(i["kha.graphics2.Graphics"]=aa).__name__=!0,aa.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},fillRect:function(t,e,a,i){},set_color:function(t){return-16777216},get_fontSize:function(){return this.myFontSize},get_opacity:function(){return this.opacities[this.opacities.length-1]},pipe:null,transformations:null,opacities:null,myFontSize:null,__class__:aa,__properties__:{get_opacity:"get_opacity",get_fontSize:"get_fontSize",set_color:"set_color"}};var ia=function(t){this.canvas=t};(i["kha.graphics2.Graphics1"]=ia).__name__=!0,ia.__interfaces__=[ea],ia.prototype={canvas:null,__class__:ia};I["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:n},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:n}};var na=function(){};(i["kha.graphics2.truetype.VectorOfIntPointer"]=na).__name__=!0,na.prototype={value:null,__class__:na};var ra=function(){};(i["kha.graphics2.truetype.Stbtt_temp_rect"]=ra).__name__=!0,ra.prototype={x0:null,y0:null,x1:null,y1:null,__class__:ra};var oa=function(){};(i["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=oa).__name__=!0,oa.prototype={advanceWidth:null,leftSideBearing:null,__class__:oa};var la=function(){};(i["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=la).__name__=!0,la.prototype={ascent:null,descent:null,lineGap:null,__class__:la};var _a=function(){};(i["kha.graphics2.truetype.Stbtt_bakedchar"]=_a).__name__=!0,_a.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:_a};var ha=function(){};(i["kha.graphics2.truetype.Stbtt_fontinfo"]=ha).__name__=!0,ha.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:ha};var fa=function(){};(i["kha.graphics2.truetype.Stbtt_vertex"]=fa).__name__=!0,fa.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:fa};var ua=function(){};(i["kha.graphics2.truetype.Stbtt__bitmap"]=ua).__name__=!0,ua.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:ua};var ca=function(){};(i["kha.graphics2.truetype.Stbtt__edge"]=ca).__name__=!0,ca.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:ca};var ga=function(){};(i["kha.graphics2.truetype.Stbtt__active_edge"]=ga).__name__=!0,ga.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:ga};var pa=function(){};(i["kha.graphics2.truetype.Stbtt__point"]=pa).__name__=!0,pa.prototype={x:null,y:null,__class__:pa};var ma=function(){};(i["kha.graphics2.truetype.StbTruetype"]=ma).__name__=!0,ma.stbtt__find_table=function(t,e,a){for(var i=e+4,n=t.readU8(i),s=e+12,r=0,o=t.readU8(i+1)|n<<8;r<o;){var l=s+16*r++,_=q.cca(a,0),h=q.cca(a,1),f=q.cca(a,2),u=q.cca(a,3);if(t.readU8(l)==_&&t.readU8(l+1)==h&&t.readU8(l+2)==f&&t.readU8(l+3)==u){var c=l+8,d=t.readU8(c),g=t.readU8(c+1),p=t.readU8(c+2);return t.readU8(c+3)|p<<8|g<<16|d<<24}}return 0},ma.stbtt_InitFont=function(t,e,a){t.data=e,t.fontstart=a;var i=ma.stbtt__find_table(e,a,"cmap");if(t.loca=ma.stbtt__find_table(e,a,"loca"),t.head=ma.stbtt__find_table(e,a,"head"),t.glyf=ma.stbtt__find_table(e,a,"glyf"),t.hhea=ma.stbtt__find_table(e,a,"hhea"),t.hmtx=ma.stbtt__find_table(e,a,"hmtx"),t.kern=ma.stbtt__find_table(e,a,"kern"),0==i||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var n=ma.stbtt__find_table(e,a,"maxp");if(0!=n){var s=n+4,r=e.readU8(s),o=e.readU8(s+1);t.numGlyphs=o|r<<8}else t.numGlyphs=65535;for(var l=i+2,_=e.readU8(l),h=e.readU8(l+1)|_<<8,f=t.index_map=0,u=h;f<u;){var c=i+4+8*f++,d=e.readU8(c);switch(e.readU8(c+1)|d<<8){case 0:var g=c+4,p=e.readU8(g),m=e.readU8(g+1),v=e.readU8(g+2),b=e.readU8(g+3);t.index_map=i+(b|v<<8|m<<16|p<<24);break;case 3:var I=c+2,M=e.readU8(I);switch(e.readU8(I+1)|M<<8){case 1:case 10:var y=c+4,w=e.readU8(y),x=e.readU8(y+1),C=e.readU8(y+2),A=e.readU8(y+3);t.index_map=i+(A|C<<8|x<<16|w<<24)}}}if(0==t.index_map)return!1;var Z=t.head+50,z=e.readU8(Z),B=e.readU8(Z+1);return t.indexToLocFormat=B|z<<8,!0},ma.stbtt_FindGlyphIndex=function(t,e){var a=t.data,i=t.index_map,n=a.readU8(i),s=a.readU8(i+1)|n<<8;if(0==s){var r=i+2,o=a.readU8(r);return e<(a.readU8(r+1)|o<<8)-6?a.readU8(i+6+e):0}if(6==s){var l=i+6,_=a.readU8(l),h=a.readU8(l+1)|_<<8,f=i+8,u=a.readU8(f),c=a.readU8(f+1);if(h<=e&&e<h+(c|u<<8)){var d=i+10+2*(e-h),g=a.readU8(d);return a.readU8(d+1)|g<<8}return 0}if(2==s)throw new Jt("Error");if(4==s){var p=i+6,m=a.readU8(p),v=(a.readU8(p+1)|m<<8)>>1,b=i+8,I=a.readU8(b),M=(a.readU8(b+1)|I<<8)>>1,y=i+10,w=a.readU8(y),x=a.readU8(y+1)|w<<8,C=i+12,A=a.readU8(C),Z=(a.readU8(C+1)|A<<8)>>1,z=i+14,B=z;if(65535<e)return 0;var k=B+2*Z,S=a.readU8(k);for((a.readU8(k+1)|S<<8)<=e&&(B+=2*Z),B-=2;0!=x;){var X=B+2*(M>>=1),Y=a.readU8(X);(a.readU8(X+1)|Y<<8)<e&&(B+=2*M),--x}var N=(B+=2)-z>>1,L=z+2*N,G=a.readU8(L);if((a.readU8(L+1)|G<<8)<e)throw new Jt("Error");var W=i+14+2*v+2+2*N,D=a.readU8(W),T=a.readU8(W+1)|D<<8;if(e<T)return 0;var V=i+14+6*v+2+2*N,K=a.readU8(V),j=a.readU8(V+1)|K<<8;if(0==j){var R=i+14+4*v+2+2*N,H=a.readU8(R),P=a.readU8(R+1)|H<<8;return e+(0!=(32768&P)?P-65536:P)}var F=j+2*(e-T)+i+14+6*v+2+2*N,O=a.readU8(F);return a.readU8(F+1)|O<<8}if(12==s||13==s){for(var E=i+12,U=a.readU8(E),J=a.readU8(E+1),Q=a.readU8(E+2),q=0,$=a.readU8(E+3)|Q<<8|J<<16|U<<24;q<$;){var tt=q+($-q>>1),et=i+16+12*tt,at=a.readU8(et),it=a.readU8(et+1),nt=a.readU8(et+2),st=a.readU8(et+3)|nt<<8|it<<16|at<<24,rt=i+16+12*tt+4,ot=a.readU8(rt),lt=a.readU8(rt+1),_t=a.readU8(rt+2),ht=a.readU8(rt+3);if(e<st)$=tt;else{if(!((ht|_t<<8|lt<<16|ot<<24)<e)){var ft=i+16+12*tt+8,ut=a.readU8(ft),ct=a.readU8(ft+1),dt=a.readU8(ft+2),gt=a.readU8(ft+3)|dt<<8|ct<<16|ut<<24;return 12==s?gt+e-st:gt}q=tt+1}}return 0}throw new Jt("Error")},ma.stbtt_setvertex=function(t,e,a,i,n,s){t.type=e,t.x=a,t.y=i,t.cx=n,t.cy=s},ma.stbtt__GetGlyfOffset=function(t,e){var a,i;if(e>=t.numGlyphs)return-1;if(2<=t.indexToLocFormat)return-1;if(0==t.indexToLocFormat){var n=t.glyf,s=t.data,r=t.loca+2*e,o=s.readU8(r);a=n+2*(s.readU8(r+1)|o<<8);var l=t.glyf,_=t.data,h=t.loca+2*e+2,f=_.readU8(h);i=l+2*(_.readU8(h+1)|f<<8)}else{var u=t.glyf,c=t.data,d=t.loca+4*e,g=c.readU8(d),p=c.readU8(d+1),m=c.readU8(d+2);a=u+(c.readU8(d+3)|m<<8|p<<16|g<<24);var v=t.glyf,b=t.data,I=t.loca+4*e+4,M=b.readU8(I),y=b.readU8(I+1),w=b.readU8(I+2);i=v+(b.readU8(I+3)|w<<8|y<<16|M<<24)}return a==i?-1:a},ma.stbtt_GetGlyphBox=function(t,e,a){var i=ma.stbtt__GetGlyfOffset(t,e);if(i<0)return!1;var n=t.data,s=i+2,r=n.readU8(s),o=n.readU8(s+1)|r<<8;a.x0=0!=(32768&o)?o-65536:o;var l=t.data,_=i+4,h=l.readU8(_),f=l.readU8(_+1)|h<<8;a.y0=0!=(32768&f)?f-65536:f;var u=t.data,c=i+6,d=u.readU8(c),g=u.readU8(c+1)|d<<8;a.x1=0!=(32768&g)?g-65536:g;var p=t.data,m=i+8,v=p.readU8(m),b=p.readU8(m+1)|v<<8;return a.y1=0!=(32768&b)?b-65536:b,!0},ma.stbtt__close_shape=function(t,e,a,i,n,s,r,o,l,_){return i?(a&&ma.stbtt_setvertex(t[e++],3,l+r>>1,_+o>>1,l,_),ma.stbtt_setvertex(t[e++],3,n,s,r,o)):a?ma.stbtt_setvertex(t[e++],3,n,s,l,_):ma.stbtt_setvertex(t[e++],2,n,s,0,0),e},ma.copyVertices=function(t,e,a,i){for(var n=0,s=i;n<s;){var r=n++;e[a+r]=t[r]}},ma.stbtt_GetGlyphShape=function(t,e){var a,i=t.data,n=null,s=0,r=ma.stbtt__GetGlyfOffset(t,e);if(r<0)return null;var o=i.readU8(r),l=i.readU8(r+1)|o<<8,_=0!=(32768&l)?l-65536:l;if(0<_){var h,f=0,u=0,c=0,d=!1,g=!1,p=0;a=i.sub(r+10,i.get_length()-(r+10));var m=r+10+2*_,v=i.readU8(m),b=i.readU8(m+1)|v<<8,I=i.sub(r+10+2*_+2+b,i.get_length()-(r+10+2*_+2+b)),M=2*_-2,y=a.readU8(M),w=1+(a.readU8(M+1)|y<<8),x=w+2*_;if(null==(n=new Array(x)))return null;for(var C=0,A=n.length;C<A;){n[C++]=new fa}var Z=c=0;h=x-w;for(var z=0,B=w;z<B;){var k=z++;0==Z?0!=(8&(f=I.readU8(p++)))&&(Z=I.readU8(p++)):--Z,n[h+k].type=f}for(var S=0,X=0,Y=w;X<Y;){var N=X++;if(0!=(2&(f=n[h+N].type))){var L=I.readU8(p++);S+=0!=(16&f)?L:-L}else if(0==(16&f)){var G=I.readU8(p),W=I.readU8(p+1)|G<<8;S+=0!=(32768&W)?W-65536:W,p+=2}n[h+N].x=S}for(var D=0,T=0,V=w;T<V;){var K=T++;if(0!=(4&(f=n[h+K].type))){var j=I.readU8(p++);D+=0!=(32&f)?j:-j}else if(0==(32&f)){var R=I.readU8(p),H=I.readU8(p+1)|R<<8;D+=0!=(32768&H)?H-65536:H,p+=2}n[h+K].y=D}for(var P=s=0,F=P,O=F,E=O,U=E,J=U,Q=0;Q<w;){if(f=n[h+Q].type,S=n[h+Q].x,D=n[h+Q].y,c==Q){0!=Q&&(s=ma.stbtt__close_shape(n,s,d,g,J,U,F,P,E,O)),(g=0==(1&f))?(F=S,P=D,0==(1&n[h+Q+1].type)?(J=S+n[h+Q+1].x>>1,U=D+n[h+Q+1].y>>1):(J=n[h+Q+1].x,U=n[h+Q+1].y,++Q)):(J=S,U=D),ma.stbtt_setvertex(n[s++],1,J,U,0,0),d=!1;var q=2*u,$=a.readU8(q);c=1+(a.readU8(q+1)|$<<8),++u}else 0==(1&f)?(d&&ma.stbtt_setvertex(n[s++],3,E+S>>1,O+D>>1,E,O),E=S,O=D,d=!0):(d?ma.stbtt_setvertex(n[s++],3,S,D,E,O):ma.stbtt_setvertex(n[s++],2,S,D,0,0),d=!1);++Q}s=ma.stbtt__close_shape(n,s,d,g,J,U,F,P,E,O)}else if(-1==_){var tt=1,et=i.sub(r+10,i.get_length()-(r+10)),at=0;for(s=0,n=null;0!=tt;){var it,nt,st=null,rt=1,ot=0,lt=0,_t=1,ht=0,ft=0,ut=et.readU8(at),ct=et.readU8(at+1)|ut<<8,dt=0!=(32768&ct)?ct-65536:ct;at+=2;var gt=et.readU8(at),pt=et.readU8(at+1)|gt<<8,mt=0!=(32768&pt)?pt-65536:pt;if(at+=2,0==(2&dt))throw new Jt("Error");if(0!=(1&dt)){var vt=et.readU8(at),bt=et.readU8(at+1)|vt<<8;ht=0!=(32768&bt)?bt-65536:bt,at+=2;var It=et.readU8(at),Mt=et.readU8(at+1)|It<<8;ft=0!=(32768&Mt)?Mt-65536:Mt,at+=2}else{var yt=et.readU8(at);ht=128<=yt?yt-256:yt,++at;var wt=et.readU8(at);ft=128<=wt?wt-256:wt,++at}if(0!=(8&dt)){var xt=et.readU8(at),Ct=et.readU8(at+1)|xt<<8;rt=_t=(0!=(32768&Ct)?Ct-65536:Ct)/16384,at+=2,ot=lt=0}else if(0!=(64&dt)){var At=et.readU8(at),Zt=et.readU8(at+1)|At<<8;rt=(0!=(32768&Zt)?Zt-65536:Zt)/16384,at+=2,ot=lt=0;var zt=et.readU8(at),Bt=et.readU8(at+1)|zt<<8;_t=(0!=(32768&Bt)?Bt-65536:Bt)/16384,at+=2}else if(0!=(128&dt)){var kt=et.readU8(at),St=et.readU8(at+1)|kt<<8;rt=(0!=(32768&St)?St-65536:St)/16384,at+=2;var Xt=et.readU8(at),Yt=et.readU8(at+1)|Xt<<8;ot=(0!=(32768&Yt)?Yt-65536:Yt)/16384,at+=2;var Nt=et.readU8(at),Lt=et.readU8(at+1)|Nt<<8;lt=(0!=(32768&Lt)?Lt-65536:Lt)/16384,at+=2;var Gt=et.readU8(at),Wt=et.readU8(at+1)|Gt<<8;_t=(0!=(32768&Wt)?Wt-65536:Wt)/16384,at+=2}var Dt=Math.sqrt(rt*rt+ot*ot),Tt=Math.sqrt(lt*lt+_t*_t);if(0<(it=null==(nt=ma.stbtt_GetGlyphShape(t,mt))?0:nt.length)){for(var Vt=0,Kt=it;Vt<Kt;){var jt=nt[Vt++],Rt=jt.x,Ht=jt.y;jt.x=Dt*(rt*Rt+lt*Ht+ht)|0,jt.y=Tt*(ot*Rt+_t*Ht+ft)|0,Rt=jt.cx,Ht=jt.cy,jt.cx=Dt*(rt*Rt+lt*Ht+ht)|0,jt.cy=Tt*(ot*Rt+_t*Ht+ft)|0}if(null==(st=new Array(s+it)))return null;0<s&&ma.copyVertices(n,st,0,s),ma.copyVertices(nt,st,s,it),n=st,s+=it}tt=32&dt}}else if(_<0)throw new Jt("Error");if(null==n)return null;if(n.length<s)throw new Jt("Error");if(s<n.length){var Pt=new Array(s);return ma.copyVertices(n,Pt,0,s),Pt}return n},ma.stbtt_GetGlyphHMetrics=function(t,e){var a=t.data,i=t.hhea+34,n=a.readU8(i),s=a.readU8(i+1)|n<<8,r=new oa;if(e<s){var o=t.data,l=t.hmtx+4*e,_=o.readU8(l),h=o.readU8(l+1)|_<<8;r.advanceWidth=0!=(32768&h)?h-65536:h;var f=t.data,u=t.hmtx+4*e+2,c=f.readU8(u),d=f.readU8(u+1)|c<<8;r.leftSideBearing=0!=(32768&d)?d-65536:d}else{var g=t.data,p=t.hmtx+4*(s-1),m=g.readU8(p),v=g.readU8(p+1)|m<<8;r.advanceWidth=0!=(32768&v)?v-65536:v;var b=t.data,I=t.hmtx+4*s+2*(e-s),M=b.readU8(I),y=b.readU8(I+1)|M<<8;r.leftSideBearing=0!=(32768&y)?y-65536:y}return r},ma.stbtt_GetFontVMetrics=function(t){var e=new la,a=t.data,i=t.hhea+4,n=a.readU8(i),s=a.readU8(i+1)|n<<8;e.ascent=0!=(32768&s)?s-65536:s;var r=t.data,o=t.hhea+6,l=r.readU8(o),_=r.readU8(o+1)|l<<8;e.descent=0!=(32768&_)?_-65536:_;var h=t.data,f=t.hhea+8,u=h.readU8(f),c=h.readU8(f+1)|u<<8;return e.lineGap=0!=(32768&c)?c-65536:c,e},ma.stbtt_ScaleForPixelHeight=function(t,e){var a=t.data,i=t.hhea+4,n=a.readU8(i),s=a.readU8(i+1)|n<<8,r=t.data,o=t.hhea+6,l=r.readU8(o),_=r.readU8(o+1)|l<<8;return e/((0!=(32768&s)?s-65536:s)-(0!=(32768&_)?_-65536:_))},ma.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,a,i,n,s){var r=new ra;if(ma.stbtt_GetGlyphBox(t,e,r)){var o=r.x0,l=r.x1,_=r.y0,h=r.y1;r.x0=Math.floor(o*a+n),r.y0=Math.floor(-h*i+s),r.x1=Math.ceil(l*a+n),r.y1=Math.ceil(-_*i+s)}else r.x0=0,r.y0=0,r.x1=0,r.y1=0;return r},ma.stbtt_GetGlyphBitmapBox=function(t,e,a,i){return ma.stbtt_GetGlyphBitmapBoxSubpixel(t,e,a,i,0,0)},ma.stbtt__new_active=function(t,e,a,i){var n=new ga,s=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==n||(n.fdx=s,n.fdy=0!=s?1/s:0,n.fx=t[e].x0+s*(i-t[e].y0),n.fx-=a,n.direction=t[e].invert?1:-1,n.sy=t[e].y0,n.ey=t[e].y1,n.next=null),n},ma.stbtt__handle_clipped_edge=function(t,e,a,i,n,s,r,o){if(s!=o){if(!(s<o))throw new Jt("Error");if(!(i.sy<=i.ey))throw new Jt("Error");if(!(s>i.ey||o<i.sy)){if(s<i.sy&&(n+=(r-n)*(i.sy-s)/(o-s),s=i.sy),o>i.ey&&(r+=(r-n)*(i.ey-o)/(o-s),o=i.ey),n==a){if(!(r<=a+1))throw new Jt("Error")}else if(n==a+1){if(!(a<=r))throw new Jt("Error")}else if(n<=a){if(!(r<=a))throw new Jt("Error")}else if(a+1<=n){if(!(a+1<=r))throw new Jt("Error")}else if(!(a<=r&&r<=a+1))throw new Jt("Error");if(n<=a&&r<=a){var l=e+a,_=t;_[l]=_[l]+i.direction*(o-s)}else if(!(a+1<=n&&a+1<=r)){if(!(a<=n&&n<=a+1&&a<=r&&r<=a+1))throw new Jt("Error");var h=e+a,f=t;f[h]=f[h]+i.direction*(o-s)*(1-(n-a+(r-a))/2)}}}},ma.stbtt__fill_active_edges_new=function(t,e,a,i,n,s){for(var r=s+1;null!=n;){if(!(n.ey>=s))throw new Jt("Error");if(0==n.fdx){var o=n.fx;o<i&&(0<=o?(ma.stbtt__handle_clipped_edge(t,0,0|o,n,o,s,o,r),ma.stbtt__handle_clipped_edge(e,a-1,o+1|0,n,o,s,o,r)):ma.stbtt__handle_clipped_edge(e,a-1,0,n,o,s,o,r))}else{var l,_,h,f,u=n.fx,c=n.fdx,d=u+c,g=n.fdy;if(!(n.sy<=r&&n.ey>=s))throw new Jt("Error");if(n.sy>s?(l=u+c*(n.sy-s),h=n.sy):(l=u,h=s),n.ey<r?(_=u+c*(n.ey-s),f=n.ey):(_=d,f=r),0<=l&&0<=_&&l<i&&_<i)if((0|l)==(0|_)){var p=0|l,m=f-h;if(!(0<=p&&p<i))throw new Jt("Error");var v=p,b=t;b[v]=b[v]+n.direction*(1-(l-p+(_-p))/2)*m;var I=a+p,M=e;M[I]=M[I]+n.direction*m}else{if(_<l){var y=h=r-(h-s);h=f=r-(f-s),f=y,y=_,_=l,l=y,c=-c,g=-g,y=u,u=d,d=y}var w=0|l,x=0|_,C=(w+1-u)*g+s,A=n.direction,Z=A*(C-h),z=w,B=t;B[z]=B[z]+Z*(1-(l-w+(w+1-w))/2);for(var k=A*g,S=w+1,X=x;S<X;){var Y=S++,N=t;N[Y]=N[Y]+(Z+k/2),Z+=k}if(C+=g*(x-(w+1)),!(Math.abs(Z)<=1.01))throw new Jt("Error");var L=x,G=t;G[L]=G[L]+(Z+A*(1-(x-x+(_-x))/2)*(f-C));var W=a+x,D=e;D[W]=D[W]+A*(f-h)}else for(var T=0,V=i;T<V;){var K=T++,j=s,R=K,H=K+1,P=d,F=r,O=(K-u)/c+s,E=(K+1-u)/c+s;u<R&&H<P?(ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,R,O),ma.stbtt__handle_clipped_edge(t,0,K,n,R,O,H,E),ma.stbtt__handle_clipped_edge(t,0,K,n,H,E,P,F)):P<R&&H<u?(ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,H,E),ma.stbtt__handle_clipped_edge(t,0,K,n,H,E,R,O),ma.stbtt__handle_clipped_edge(t,0,K,n,R,O,P,F)):u<R&&R<P?(ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,R,O),ma.stbtt__handle_clipped_edge(t,0,K,n,R,O,P,F)):P<R&&R<u?(ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,R,O),ma.stbtt__handle_clipped_edge(t,0,K,n,R,O,P,F)):u<H&&H<P?(ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,H,E),ma.stbtt__handle_clipped_edge(t,0,K,n,H,E,P,F)):P<H&&H<u?(ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,H,E),ma.stbtt__handle_clipped_edge(t,0,K,n,H,E,P,F)):ma.stbtt__handle_clipped_edge(t,0,K,n,u,j,P,F)}}n=n.next}},ma.stbtt__rasterize_sorted_edges=function(t,e,a,i,n,s){var r,o,l=null,_=0,h=0;64<t.w?r=new Array(2*t.w+1):r=new Array(129);var f=r;o=t.w;var u=s;for(e[h+a].y0=s+t.h+1;_<t.h;){for(var c=u+0,d=u+1,g=l,p=null,m=0,v=t.w;m<v;){r[m++]=0}for(var b=0,I=t.w+1;b<I;){f[o+b++]=0}for(;null!=g;){var M=g;if(M.ey<=c){if(null==p?l=M.next:p.next=M.next,g=M.next,0==M.direction)throw new Jt("Error");M.direction=0}else g=(p=g).next}for(;e[h].y0<=d;){if(e[h].y0!=e[h].y1){var y=ma.stbtt__new_active(e,h,n,c);if(!(y.ey>=c))throw new Jt("Error");y.next=l,l=y}++h}null!=l&&ma.stbtt__fill_active_edges_new(r,f,o+1,t.w,l,c);for(var w=0,x=0,C=t.w;x<C;){var A=x++;w+=f[o+A];var Z=r[A]+w,z=0|(Z=255*Math.abs(Z)+.5);255<z&&(z=255),t.pixels.writeU8(t.pixels_offset+_*t.stride+A,z)}for(p=null,g=l;null!=g;){var B=g;B.fx+=B.fdx,g=(p=g).next}++u,++_}},ma.STBTT__COMPARE=function(t,e){return t.y0<e.y0},ma.stbtt__sort_edges_ins_sort=function(t,e){for(var a,i=1,n=e;i<n;){var s=i++,r=t[s],o=r;for(a=s;0<a;){var l=t[a-1];if(!ma.STBTT__COMPARE(o,l))break;t[a]=t[a-1],--a}s!=a&&(t[a]=r)}},ma.stbtt__sort_edges_quicksort=function(t,e,a){for(;12<a;){var i,n=a>>1,s=ma.STBTT__COMPARE(t[e],t[e+n]),r=ma.STBTT__COMPARE(t[e+n],t[e+a-1]);if(s!=r){var o=ma.STBTT__COMPARE(t[e],t[e+a-1])==r?0:a-1;i=t[e+o],t[e+o]=t[e+n],t[e+n]=i}i=t[e],t[e]=t[e+n],t[e+n]=i;for(var l=1,_=a-1;;){for(;ma.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;ma.STBTT__COMPARE(t[e],t[e+_]);)--_;if(_<=l)break;i=t[e+l],t[e+l]=t[e+_],t[e+_]=i,++l,--_}_<a-l?(ma.stbtt__sort_edges_quicksort(t,e,_),e+=l,a-=l):(ma.stbtt__sort_edges_quicksort(t,e+l,a-l),a=_)}},ma.stbtt__sort_edges=function(t,e){ma.stbtt__sort_edges_quicksort(t,0,e),ma.stbtt__sort_edges_ins_sort(t,e)},ma.stbtt__rasterize=function(t,e,a,i,n,s,r,o,l,_,h){for(var f,u=h?-s:s,c=0,d=0,g=i;d<g;){c+=a[d++]}var p=new Array(c+1);if(null!=p){for(var m=0,v=p.length;m<v;){p[m++]=new ca}for(var b=c=0,I=0,M=i;I<M;){var y=I++,w=e,x=0+b;b+=a[y],f=a[y]-1;for(var C=0,A=a[y];C<A;){var Z=C++,z=Z,B=f;w[x+f].y!=w[x+Z].y?(p[c].invert=!1,(h?w[x+f].y>w[x+Z].y:w[x+f].y<w[x+Z].y)&&(p[c].invert=!0,z=f,B=Z),p[c].x0=w[x+z].x*n+r,p[c].y0=1*(w[x+z].y*u+o),p[c].x1=w[x+B].x*n+r,p[c].y1=1*(w[x+B].y*u+o),++c,f=Z):f=Z}}ma.stbtt__sort_edges(p,c),ma.stbtt__rasterize_sorted_edges(t,p,c,1,l,_)}},ma.stbtt__add_point=function(t,e,a,i){null!=t&&(t[e].x=a,t[e].y=i)},ma.stbtt__tesselate_curve=function(t,e,a,i,n,s,r,o,l,_){var h=(a+2*n+r)/4,f=(i+2*s+o)/4,u=(a+r)/2-h,c=(i+o)/2-f;return 16<_||(l<u*u+c*c?(ma.stbtt__tesselate_curve(t,e,a,i,(a+n)/2,(i+s)/2,h,f,l,_+1),ma.stbtt__tesselate_curve(t,e,h,f,(n+r)/2,(s+o)/2,r,o,l,_+1)):(ma.stbtt__add_point(t,e.value,r,o),e.value+=1)),1},ma.stbtt_FlattenCurves=function(t,e,a,i,n){for(var s=null,r=0,o=a*a,l=0,_=0,h=0,f=e;h<f;){1==t[h++].type&&++l}if(0==(n.value=l))return null;var u=new Array(l);if(i.value=u,null==i.value)return n.value=0,null;for(var c=0;c<2;){var d=0,g=0;if(1==c++){if(null==(s=new Array(r)))return i.value=null,n.value=0,null;for(var p=0,m=s.length;p<m;){s[p++]=new pa}}l=-1;for(var v=r=0,b=e;v<b;){var I=v++;switch(t[I].type){case 1:0<=l&&(i.value[l]=r-_),++l,_=r,d=t[I].x,g=t[I].y,ma.stbtt__add_point(s,r++,d,g);break;case 2:d=t[I].x,g=t[I].y,ma.stbtt__add_point(s,r++,d,g);break;case 3:var M={value:r};ma.stbtt__tesselate_curve(s,M,d,g,t[I].cx,t[I].cy,t[I].x,t[I].y,o,0),r=M.value,d=t[I].x,g=t[I].y}}i.value[l]=r-_}return s},ma.stbtt_Rasterize=function(t,e,a,i,n,s,r,o,l,_,h){var f,u=s<n?s:n,c=0,d={value:c},g=new na,p=ma.stbtt_FlattenCurves(a,i,e/u,g,d);c=d.value,f=g.value,null!=p&&ma.stbtt__rasterize(t,p,f,c,n,s,r,o,l,_,h)},ma.stbtt_MakeGlyphBitmapSubpixel=function(t,e,a,i,n,s,r,o,l,_,h){var f,u,c=ma.stbtt_GetGlyphShape(t,h),d=null==c?0:c.length,g=new ua,p=ma.stbtt_GetGlyphBitmapBoxSubpixel(t,h,r,o,l,_);f=p.x0,u=p.y0,g.pixels=e,g.pixels_offset=a,g.w=i,g.h=n,g.stride=s,0!=g.w&&0!=g.h&&ma.stbtt_Rasterize(g,.35,c,d,r,o,l,_,f,u,!0)},ma.stbtt_MakeGlyphBitmap=function(t,e,a,i,n,s,r,o,l){ma.stbtt_MakeGlyphBitmapSubpixel(t,e,a,i,n,s,r,o,0,0,l)},ma.stbtt_BakeFontBitmap=function(t,e,a,i,n,s,r,o){var l=new ha;if(!ma.stbtt_InitFont(l,t,e))return-1;for(var _=0,h=n*s;_<h;){var f=_++;i.writeU8(f,0)}for(var u=1,c=u,d=1,g=ma.stbtt_ScaleForPixelHeight(l,a),p=0,m=0;m<r.length;){var v=r[m];++m;var b=ma.stbtt_FindGlyphIndex(l,v),I=ma.stbtt_GetGlyphHMetrics(l,b),M=I.advanceWidth,y=(I.leftSideBearing,ma.stbtt_GetGlyphBitmapBox(l,b,g,g)),w=y.x0,x=y.y0,C=y.x1-w,A=y.y1-x;if(n<=c+C+1&&(u=d,c=1),s<=u+A+1)return-p;if(n<=c+C)throw new Jt("Error");if(s<=u+A)throw new Jt("Error");ma.stbtt_MakeGlyphBitmap(l,i,c+u*n,C,A,n,g,g,b),o[p].x0=c,o[p].y0=u,o[p].x1=c+C,o[p].y1=u+A,o[p].xadvance=g*M,o[p].xoff=w,o[p].yoff=x,c=c+C+1,d<u+A+1&&(d=u+A+1),++p}return d};var va=I["kha.graphics4.BlendingFactor"]={__ename__:!0,__constructs__:["Undefined","BlendOne","BlendZero","SourceAlpha","DestinationAlpha","InverseSourceAlpha","InverseDestinationAlpha","SourceColor","DestinationColor","InverseSourceColor","InverseDestinationColor"],Undefined:{_hx_index:0,__enum__:"kha.graphics4.BlendingFactor",toString:n},BlendOne:{_hx_index:1,__enum__:"kha.graphics4.BlendingFactor",toString:n},BlendZero:{_hx_index:2,__enum__:"kha.graphics4.BlendingFactor",toString:n},SourceAlpha:{_hx_index:3,__enum__:"kha.graphics4.BlendingFactor",toString:n},DestinationAlpha:{_hx_index:4,__enum__:"kha.graphics4.BlendingFactor",toString:n},InverseSourceAlpha:{_hx_index:5,__enum__:"kha.graphics4.BlendingFactor",toString:n},InverseDestinationAlpha:{_hx_index:6,__enum__:"kha.graphics4.BlendingFactor",toString:n},SourceColor:{_hx_index:7,__enum__:"kha.graphics4.BlendingFactor",toString:n},DestinationColor:{_hx_index:8,__enum__:"kha.graphics4.BlendingFactor",toString:n},InverseSourceColor:{_hx_index:9,__enum__:"kha.graphics4.BlendingFactor",toString:n},InverseDestinationColor:{_hx_index:10,__enum__:"kha.graphics4.BlendingFactor",toString:n}},ba=I["kha.graphics4.BlendingOperation"]={__ename__:!0,__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"],Add:{_hx_index:0,__enum__:"kha.graphics4.BlendingOperation",toString:n},Subtract:{_hx_index:1,__enum__:"kha.graphics4.BlendingOperation",toString:n},ReverseSubtract:{_hx_index:2,__enum__:"kha.graphics4.BlendingOperation",toString:n},Min:{_hx_index:3,__enum__:"kha.graphics4.BlendingOperation",toString:n},Max:{_hx_index:4,__enum__:"kha.graphics4.BlendingOperation",toString:n}},Ia=I["kha.graphics4.CompareMode"]={__ename__:!0,__constructs__:["Always","Never","Equal","NotEqual","Less","LessEqual","Greater","GreaterEqual"],Always:{_hx_index:0,__enum__:"kha.graphics4.CompareMode",toString:n},Never:{_hx_index:1,__enum__:"kha.graphics4.CompareMode",toString:n},Equal:{_hx_index:2,__enum__:"kha.graphics4.CompareMode",toString:n},NotEqual:{_hx_index:3,__enum__:"kha.graphics4.CompareMode",toString:n},Less:{_hx_index:4,__enum__:"kha.graphics4.CompareMode",toString:n},LessEqual:{_hx_index:5,__enum__:"kha.graphics4.CompareMode",toString:n},Greater:{_hx_index:6,__enum__:"kha.graphics4.CompareMode",toString:n},GreaterEqual:{_hx_index:7,__enum__:"kha.graphics4.CompareMode",toString:n}},Ma=function(){};(i["kha.graphics4.ConstantLocation"]=Ma).__name__=!0;var ya=function(t,e,a,i){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=t,this.format=e,this.renderTarget=a,this.depthStencilFormat=i,a&&this.createTexture()};(i["kha.graphics4.CubeMap"]=ya).__name__=!0,ya.__interfaces__=[te,$t],ya.createRenderTarget=function(t,e,a,i){return null==i&&(i=0),null==e&&(e=Va.RGBA32),null==a&&(a=0),new ya(t,e,!0,a)},ya.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,isDepthAttachment:null,createTexture:function(){if(null!=ve.gl){if(this.texture=ve.gl.createTexture(),ve.gl.bindTexture(34067,this.texture),ve.gl.texParameteri(34067,10240,9729),ve.gl.texParameteri(34067,10241,9729),ve.gl.texParameteri(34067,10242,33071),ve.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=ve.gl.createFramebuffer(),ve.gl.bindFramebuffer(36160,this.frameBuffer),this.format._hx_index){case 0:for(var t=0;t<6;){var e=t++;ve.gl.texImage2D(34069+e,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}break;case 2:for(var a=0;a<6;){var i=a++;ve.gl.texImage2D(34069+i,0,ve.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null)}break;case 3:for(var n=0;n<6;){var s=n++;ve.gl.texImage2D(34069+s,0,ve.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null)}break;case 4:for(var r=0;r<6;){var o=r++;ve.gl.texImage2D(34069+o,0,ve.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ve.halfFloat.HALF_FLOAT_OES,null)}break;case 5:for(var l=0;l<6;){var _=l++;ve.gl.texImage2D(34069+_,0,ve.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null)}break;case 6:for(var h=0;h<6;){var f=h++;ve.gl.texImage2D(34069+f,0,ve.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ve.halfFloat.HALF_FLOAT_OES,null)}break;default:for(var u=0;u<6;){var c=u++;ve.gl.texImage2D(34069+c,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}}if(this.format==Va.DEPTH16&&(ve.gl.texParameteri(34067,10240,9728),ve.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!ve.gl2)){var d=ve.gl.createTexture();ve.gl.bindTexture(34067,d);for(var g=0;g<6;){var p=g++;ve.gl.texImage2D(34069+p,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ve.gl.framebufferTexture2D(36160,36064,34069+p,d,0)}ve.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),ve.gl.bindFramebuffer(36160,null)}ve.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:this.depthTexture=ve.gl.createTexture(),ve.gl.bindTexture(34067,this.depthTexture),1==t?ve.gl.texImage2D(34067,0,ve.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):ve.gl.texImage2D(34067,0,ve.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ve.gl.texParameteri(34067,10240,9728),ve.gl.texParameteri(34067,10241,9728),ve.gl.texParameteri(34067,10242,33071),ve.gl.texParameteri(34067,10243,33071),ve.gl.bindFramebuffer(36160,this.frameBuffer),ve.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=ve.gl.createTexture(),ve.gl.bindTexture(34067,this.depthTexture),ve.gl.texImage2D(34067,0,ve.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,ve.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),ve.gl.texParameteri(34067,10240,9728),ve.gl.texParameteri(34067,10241,9728),ve.gl.texParameteri(34067,10242,33071),ve.gl.texParameteri(34067,10243,33071),ve.gl.bindFramebuffer(36160,this.frameBuffer),ve.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(t){ve.gl.activeTexture(33984+t),ve.gl.bindTexture(34067,this.texture)},setDepth:function(t){ve.gl.activeTexture(33984+t),ve.gl.bindTexture(34067,this.depthTexture)},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){return null==this.graphics4&&(this.graphics4=new ci(this)),this.graphics4},__class__:ya,__properties__:{get_g4:"get_g4",get_height:"get_height",get_width:"get_width"}};var wa=I["kha.graphics4.CullMode"]={__ename__:!0,__constructs__:["Clockwise","CounterClockwise","None"],Clockwise:{_hx_index:0,__enum__:"kha.graphics4.CullMode",toString:n},CounterClockwise:{_hx_index:1,__enum__:"kha.graphics4.CullMode",toString:n},None:{_hx_index:2,__enum__:"kha.graphics4.CullMode",toString:n}},xa=function(t,e){this.sources=[];for(var a=0;a<t.length;){var i=t[a];++a,this.sources.push(i.toString())}this.type=35632,this.shader=null,this.files=e};(i["kha.graphics4.FragmentShader"]=xa).__name__=!0,xa.fromSource=function(t){var e=new xa([],["runtime-string"]);return e.sources.push(t),e},xa.prototype={sources:null,type:null,shader:null,files:null,__class__:xa};var Ca=function(){};(i["kha.graphics4.GeometryShader"]=Ca).__name__=!0;var Aa=function(){};(i["kha.graphics4.Graphics"]=Aa).__name__=!0,Aa.prototype={begin:null,beginFace:null,end:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setCubeMap:null,setCubeMapDepth:null,renderTargetsInvertedY:null,setPipeline:null,setBool:null,setInt:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,__class__:Aa};var Za=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,Za.bufferIndex=0,Za.initShaders(),this.initBuffers(),this.projectionLocation=Za.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Za.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.ImageShaderPainter"]=Za).__name__=!0,Za.initShaders=function(){null==Za.structure&&(Za.structure=ka.createImageVertexStructure()),null==Za.shaderPipeline&&(Za.shaderPipeline=ka.createImagePipeline(Za.structure),Za.shaderPipeline.compile())},Za.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Za.rectVertexBuffer){Za.rectVertexBuffer=new Ra(6e3,Za.structure,ja.DynamicUsage),Za.rectVertices=Za.rectVertexBuffer.lock(),Za.indexBuffer=new Sa(9e3,ja.StaticUsage);for(var t=Za.indexBuffer.lock(),e=0;e<1500;){var a=e++;t[3*a*2]=4*a,t[3*a*2+1]=4*a+1,t[3*a*2+2]=4*a+2,t[3*a*2+3]=4*a,t[3*a*2+4]=4*a+2,t[3*a*2+5]=4*a+3}Za.indexBuffer.unlock()}},drawBuffer:function(){Za.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Za.rectVertexBuffer),this.g.setIndexBuffer(Za.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Za.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Za.lastTexture),this.g.setTextureParameters(this.textureLocation,Da.Clamp,Da.Clamp,this.bilinear?Ta.LinearFilter:Ta.PointFilter,this.bilinear?Ta.LinearFilter:Ta.PointFilter,this.bilinearMipmaps?Xa.LinearMipFilter:Xa.NoMipFilter),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Za.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Za.bufferIndex=0,Za.rectVertices=Za.rectVertexBuffer.lock()},end:function(){0<Za.bufferIndex&&this.drawBuffer(),Za.lastTexture=null},__class__:Za,__properties__:{get_pipeline:"get_pipeline"}};var za=function(t){this.myPipeline=null,this.g=t,za.bufferIndex=0,za.triangleBufferIndex=0,za.initShaders(),this.initBuffers(),this.projectionLocation=za.shaderPipeline.getConstantLocation("projectionMatrix")};(i["kha.graphics4.ColoredShaderPainter"]=za).__name__=!0,za.initShaders=function(){null==za.structure&&(za.structure=ka.createColoredVertexStructure()),null==za.shaderPipeline&&(za.shaderPipeline=ka.createColoredPipeline(za.structure),za.shaderPipeline.compile())},za.prototype={projectionMatrix:null,g:null,myPipeline:null,projectionLocation:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==za.rectVertexBuffer){za.rectVertexBuffer=new Ra(400,za.structure,ja.DynamicUsage),za.rectVertices=za.rectVertexBuffer.lock(),za.indexBuffer=new Sa(600,ja.StaticUsage);for(var t=za.indexBuffer.lock(),e=0;e<100;){var a=e++;t[3*a*2]=4*a,t[3*a*2+1]=4*a+1,t[3*a*2+2]=4*a+2,t[3*a*2+3]=4*a,t[3*a*2+4]=4*a+2,t[3*a*2+5]=4*a+3}za.indexBuffer.unlock(),za.triangleVertexBuffer=new Ra(300,za.structure,ja.DynamicUsage),za.triangleVertices=za.triangleVertexBuffer.lock(),za.triangleIndexBuffer=new Sa(300,ja.StaticUsage);for(var i=za.triangleIndexBuffer.lock(),n=0;n<100;){var s=n++;i[3*s]=3*s,i[3*s+1]=3*s+1,i[3*s+2]=3*s+2}za.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,a,i,n,s,r,o){var l=7*za.bufferIndex*4;za.rectVertices[l]=t,za.rectVertices[l+1]=e,za.rectVertices[l+2]=-5,za.rectVertices[l+7]=a,za.rectVertices[l+8]=i,za.rectVertices[l+9]=-5,za.rectVertices[l+14]=n,za.rectVertices[l+15]=s,za.rectVertices[l+16]=-5,za.rectVertices[l+21]=r,za.rectVertices[l+22]=o,za.rectVertices[l+23]=-5},setRectColors:function(t,e){var a=7*za.bufferIndex*4,i=t*(.00392156862745098*(e>>>24));za.rectVertices[a+3]=.00392156862745098*((16711680&e)>>>16),za.rectVertices[a+4]=.00392156862745098*((65280&e)>>>8),za.rectVertices[a+5]=.00392156862745098*(255&e),za.rectVertices[a+6]=i,za.rectVertices[a+10]=.00392156862745098*((16711680&e)>>>16),za.rectVertices[a+11]=.00392156862745098*((65280&e)>>>8),za.rectVertices[a+12]=.00392156862745098*(255&e),za.rectVertices[a+13]=i,za.rectVertices[a+17]=.00392156862745098*((16711680&e)>>>16),za.rectVertices[a+18]=.00392156862745098*((65280&e)>>>8),za.rectVertices[a+19]=.00392156862745098*(255&e),za.rectVertices[a+20]=i,za.rectVertices[a+24]=.00392156862745098*((16711680&e)>>>16),za.rectVertices[a+25]=.00392156862745098*((65280&e)>>>8),za.rectVertices[a+26]=.00392156862745098*(255&e),za.rectVertices[a+27]=i},drawBuffer:function(t){t||0<za.triangleBufferIndex&&this.drawTriBuffer(!0),za.rectVertexBuffer.unlock(),this.g.setVertexBuffer(za.rectVertexBuffer),this.g.setIndexBuffer(za.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?za.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*za.bufferIndex*3),za.bufferIndex=0,za.rectVertices=za.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||0<za.bufferIndex&&this.drawBuffer(!0),za.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(za.triangleVertexBuffer),this.g.setIndexBuffer(za.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?za.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*za.triangleBufferIndex),za.triangleBufferIndex=0,za.triangleVertices=za.triangleVertexBuffer.lock()},fillRect:function(t,e,a,i,n,s,r,o,l,_){0<za.triangleBufferIndex&&this.drawTriBuffer(!0),100<=za.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(a,i,n,s,r,o,l,_),++za.bufferIndex},__class__:za,__properties__:{get_pipeline:"get_pipeline"}};var Ba=function(t){this.bilinear=!1,this.myPipeline=null,this.g=t,Ba.bufferIndex=0,Ba.initShaders(),this.initBuffers(),this.projectionLocation=Ba.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ba.shaderPipeline.getTextureUnit("tex")};(i["kha.graphics4.TextShaderPainter"]=Ba).__name__=!0,Ba.initShaders=function(){null==Ba.structure&&(Ba.structure=ka.createTextVertexStructure()),null==Ba.shaderPipeline&&(Ba.shaderPipeline=ka.createTextPipeline(Ba.structure),Ba.shaderPipeline.compile())},Ba.prototype={projectionMatrix:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ba.rectVertexBuffer){Ba.rectVertexBuffer=new Ra(400,Ba.structure,ja.DynamicUsage),Ba.rectVertices=Ba.rectVertexBuffer.lock(),Ba.indexBuffer=new Sa(600,ja.StaticUsage);for(var t=Ba.indexBuffer.lock(),e=0;e<100;){var a=e++;t[3*a*2]=4*a,t[3*a*2+1]=4*a+1,t[3*a*2+2]=4*a+2,t[3*a*2+3]=4*a,t[3*a*2+4]=4*a+2,t[3*a*2+5]=4*a+3}Ba.indexBuffer.unlock()}},drawBuffer:function(){Ba.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ba.rectVertexBuffer),this.g.setIndexBuffer(Ba.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ba.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Ba.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,Da.Clamp,Da.Clamp,this.bilinear?Ta.LinearFilter:Ta.PointFilter,this.bilinear?Ta.LinearFilter:Ta.PointFilter,Xa.NoMipFilter),this.g.drawIndexedVertices(0,2*Ba.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Ba.bufferIndex=0,Ba.rectVertices=Ba.rectVertexBuffer.lock()},end:function(){0<Ba.bufferIndex&&this.drawBuffer(),Ba.lastTexture=null},__class__:Ba,__properties__:{get_pipeline:"get_pipeline"}};var ka=function(t){aa.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new Za(this.g),this.coloredPainter=new za(this.g),this.textPainter=new Ba(this.g),this.textPainter.fontSize=this.get_fontSize(),this.setProjection(),null==ka.videoPipeline&&(ka.videoPipeline=ka.createImagePipeline(ka.createImageVertexStructure()),ka.videoPipeline.fragmentShader=de.painter_video_frag,ka.videoPipeline.vertexShader=de.painter_video_vert,ka.videoPipeline.compile())};(i["kha.graphics4.Graphics2"]=ka).__name__=!0,ka.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},ka.createImageVertexStructure=function(){var t=new Fa;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},ka.createImagePipeline=function(t){var e=new Na;return e.fragmentShader=de.painter_image_frag,e.vertexShader=de.painter_image_vert,e.inputLayout=[t],e.blendSource=va.BlendOne,e.blendDestination=va.InverseSourceAlpha,e.alphaBlendSource=va.BlendOne,e.alphaBlendDestination=va.InverseSourceAlpha,e},ka.createColoredVertexStructure=function(){var t=new Fa;return t.add("vertexPosition",2),t.add("vertexColor",3),t},ka.createColoredPipeline=function(t){var e=new Na;return e.fragmentShader=de.painter_colored_frag,e.vertexShader=de.painter_colored_vert,e.inputLayout=[t],e.blendSource=va.SourceAlpha,e.blendDestination=va.InverseSourceAlpha,e.alphaBlendSource=va.SourceAlpha,e.alphaBlendDestination=va.InverseSourceAlpha,e},ka.createTextVertexStructure=function(){var t=new Fa;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},ka.createTextPipeline=function(t){var e=new Na;return e.fragmentShader=de.painter_text_frag,e.vertexShader=de.painter_text_vert,e.inputLayout=[t],e.blendSource=va.SourceAlpha,e.blendDestination=va.InverseSourceAlpha,e.alphaBlendSource=va.SourceAlpha,e.alphaBlendDestination=va.InverseSourceAlpha,e},ka.__super__=aa,ka.prototype=s(aa.prototype,{myColor:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();this.canvas instanceof oe?this.projectionMatrix=p.orthogonalProjection(0,t,e,0,.1,1e3):(ee.get_nonPow2Supported()||(t=ka.upperPowerOfTwo(t),e=ka.upperPowerOfTwo(e)),this.g.renderTargetsInvertedY()?this.projectionMatrix=p.orthogonalProjection(0,t,0,e,.1,1e3):this.projectionMatrix=p.orthogonalProjection(0,t,e,0,.1,1e3)),this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},fillRect:function(t,e,a,i){this.imagePainter.end(),this.textPainter.end();var n=this.transformations[this.transformations.length-1],s=t,r=e+i,o=n._02*s+n._12*r+n._22,l=(n._00*s+n._10*r+n._20)/o,_=(n._01*s+n._11*r+n._21)/o,h=this.transformations[this.transformations.length-1],f=t,u=e,c=h._02*f+h._12*u+h._22,d=(h._00*f+h._10*u+h._20)/c,g=(h._01*f+h._11*u+h._21)/c,p=this.transformations[this.transformations.length-1],m=t+a,v=e,b=p._02*m+p._12*v+p._22,I=(p._00*m+p._10*v+p._20)/b,M=(p._01*m+p._11*v+p._21)/b,y=this.transformations[this.transformations.length-1],w=t+a,x=e+i,C=y._02*w+y._12*x+y._22,A=(y._00*w+y._10*x+y._20)/C,Z=(y._01*w+y._11*x+y._21)/C;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),l,_,d,g,I,M,A,Z)},begin:function(t,e){null==t&&(t=!0),this.g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end();var t=this.coloredPainter;0<za.triangleBufferIndex&&t.drawTriBuffer(!1),0<za.bufferIndex&&t.drawBuffer(!1)},end:function(){this.flush(),this.g.end()},__class__:ka});var Sa=function(t,e,a){null==a&&(a=!1),this.usage=e,this.mySize=t,this.buffer=ve.gl.createBuffer();var i=new Uint32Array(t);this._data=i};(i["kha.graphics4.IndexBuffer"]=Sa).__name__=!0,Sa.prototype={buffer:null,_data:null,mySize:null,usage:null,lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t,t+e)},unlock:function(){ve.gl.bindBuffer(34963,this.buffer);var t=null==ve.elementIndexUint?new Uint16Array(this._data):this._data;ve.gl.bufferData(34963,t,this.usage==ja.DynamicUsage?35048:35044)},set:function(){ve.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:Sa};var Xa=I["kha.graphics4.MipMapFilter"]={__ename__:!0,__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"],NoMipFilter:{_hx_index:0,__enum__:"kha.graphics4.MipMapFilter",toString:n},PointMipFilter:{_hx_index:1,__enum__:"kha.graphics4.MipMapFilter",toString:n},LinearMipFilter:{_hx_index:2,__enum__:"kha.graphics4.MipMapFilter",toString:n}},Ya=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=wa.None,this.depthWrite=!1,this.depthMode=Ia.Always,this.stencilMode=Ia.Always,this.stencilBothPass=La.Keep,this.stencilDepthFail=La.Keep,this.stencilFail=La.Keep,this.stencilReferenceValue=0,this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=va.BlendOne,this.blendDestination=va.BlendZero,this.blendOperation=ba.Add,this.alphaBlendSource=va.BlendOne,this.alphaBlendDestination=va.BlendZero,this.alphaBlendOperation=ba.Add,this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=!0,this.conservativeRasterization=!1};(i["kha.graphics4.PipelineStateBase"]=Ya).__name__=!0,Ya.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMaskRed:null,colorWriteMaskGreen:null,colorWriteMaskBlue:null,colorWriteMaskAlpha:null,conservativeRasterization:null,__class__:Ya};var Na=function(){this.program=null,Ya.call(this),this.textures=[],this.textureValues=[]};(i["kha.graphics4.PipelineState"]=Na).__name__=!0,Na.__super__=Ya,Na.prototype=s(Ya.prototype,{program:null,textures:null,textureValues:null,delete:function(){null!=this.program&&ve.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&ve.gl.deleteProgram(this.program),this.program=ve.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),ve.gl.attachShader(this.program,this.vertexShader.shader),ve.gl.attachShader(this.program,this.fragmentShader.shader);for(var t=0,e=0,a=this.inputLayout;e<a.length;){var i=a[e];++e;for(var n=0,s=i.elements;n<s.length;){var r=s[n];++n,ve.gl.bindAttribLocation(this.program,t,r.name),4==r.data?t+=4:++t}}if(ve.gl.linkProgram(this.program),!ve.gl.getProgramParameter(this.program,35714))throw new Jt("Could not link the shader program:\n"+ve.gl.getProgramInfoLog(this.program))},set:function(){ve.gl.useProgram(this.program);for(var t=0,e=this.textureValues.length;t<e;){var a=t++;ve.gl.uniform1i(this.textureValues[a],a)}ve.gl.colorMask(this.colorWriteMaskRed,this.colorWriteMaskGreen,this.colorWriteMaskBlue,this.colorWriteMaskAlpha)},compileShader:function(t){if(null==t.shader){for(var e=ve.gl.createShader(t.type),a=0!=ve.gl.getShaderPrecisionFormat(35632,36338).precision,i=t.files,n=0,s=i.length;n<s;){var r=n++;if(ve.gl2){if(0<=i[r].indexOf("-webgl2")||0<=i[r].indexOf("runtime-string")){ve.gl.shaderSource(e,t.sources[r]);break}}else{if(!a&&(0<=i[r].indexOf("-relaxed")||0<=i[r].indexOf("runtime-string"))){ve.gl.shaderSource(e,t.sources[r]);break}if(a&&(i[r].indexOf("-relaxed")<0||0<=i[r].indexOf("runtime-string"))){ve.gl.shaderSource(e,t.sources[r]);break}}}if(ve.gl.compileShader(e),!ve.gl.getShaderParameter(e,35713))throw new Jt("Could not compile shader:\n"+ve.gl.getShaderInfoLog(e));t.shader=e}},getConstantLocation:function(t){var e=ve.gl.getUniformLocation(this.program,t);null==e&&Fe.trace("Warning: Uniform "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:92,className:"kha.graphics4.PipelineState",methodName:"getConstantLocation"});for(var a=5126,i=0,n=ve.gl.getProgramParameter(this.program,35718);i<n;){var s=i++,r=ve.gl.getActiveUniform(this.program,s);if(r.name==t||r.name==t+"[0]"){a=r.type;break}}return new ui(e,a)},getTextureUnit:function(t){var e=this.findTexture(t);if(e<0){var a=ve.gl.getUniformLocation(this.program,t);null==a&&Fe.trace("Warning: Sampler "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:111,className:"kha.graphics4.PipelineState",methodName:"getTextureUnit"}),e=this.textures.length,this.textureValues.push(a),this.textures.push(t)}return new gi(e)},findTexture:function(t){for(var e=0,a=this.textures.length;e<a;){var i=e++;if(this.textures[i]==t)return i}return-1},__class__:Na});var La=I["kha.graphics4.StencilAction"]={__ename__:!0,__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"],Keep:{_hx_index:0,__enum__:"kha.graphics4.StencilAction",toString:n},Zero:{_hx_index:1,__enum__:"kha.graphics4.StencilAction",toString:n},Replace:{_hx_index:2,__enum__:"kha.graphics4.StencilAction",toString:n},Increment:{_hx_index:3,__enum__:"kha.graphics4.StencilAction",toString:n},IncrementWrap:{_hx_index:4,__enum__:"kha.graphics4.StencilAction",toString:n},Decrement:{_hx_index:5,__enum__:"kha.graphics4.StencilAction",toString:n},DecrementWrap:{_hx_index:6,__enum__:"kha.graphics4.StencilAction",toString:n},Invert:{_hx_index:7,__enum__:"kha.graphics4.StencilAction",toString:n}},Ga=function(){};(i["kha.graphics4.TessellationControlShader"]=Ga).__name__=!0;var Wa=function(){};(i["kha.graphics4.TessellationEvaluationShader"]=Wa).__name__=!0;var Da=I["kha.graphics4.TextureAddressing"]={__ename__:!0,__constructs__:["Repeat","Mirror","Clamp"],Repeat:{_hx_index:0,__enum__:"kha.graphics4.TextureAddressing",toString:n},Mirror:{_hx_index:1,__enum__:"kha.graphics4.TextureAddressing",toString:n},Clamp:{_hx_index:2,__enum__:"kha.graphics4.TextureAddressing",toString:n}},Ta=I["kha.graphics4.TextureFilter"]={__ename__:!0,__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"],PointFilter:{_hx_index:0,__enum__:"kha.graphics4.TextureFilter",toString:n},LinearFilter:{_hx_index:1,__enum__:"kha.graphics4.TextureFilter",toString:n},AnisotropicFilter:{_hx_index:2,__enum__:"kha.graphics4.TextureFilter",toString:n}},Va=I["kha.graphics4.TextureFormat"]={__ename__:!0,__constructs__:["RGBA32","L8","RGBA128","DEPTH16","RGBA64","A32","A16"],RGBA32:{_hx_index:0,__enum__:"kha.graphics4.TextureFormat",toString:n},L8:{_hx_index:1,__enum__:"kha.graphics4.TextureFormat",toString:n},RGBA128:{_hx_index:2,__enum__:"kha.graphics4.TextureFormat",toString:n},DEPTH16:{_hx_index:3,__enum__:"kha.graphics4.TextureFormat",toString:n},RGBA64:{_hx_index:4,__enum__:"kha.graphics4.TextureFormat",toString:n},A32:{_hx_index:5,__enum__:"kha.graphics4.TextureFormat",toString:n},A16:{_hx_index:6,__enum__:"kha.graphics4.TextureFormat",toString:n}},Ka=function(){};(i["kha.graphics4.TextureUnit"]=Ka).__name__=!0;var ja=I["kha.graphics4.Usage"]={__ename__:!0,__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"],StaticUsage:{_hx_index:0,__enum__:"kha.graphics4.Usage",toString:n},DynamicUsage:{_hx_index:1,__enum__:"kha.graphics4.Usage",toString:n},ReadableUsage:{_hx_index:2,__enum__:"kha.graphics4.Usage",toString:n}},Ra=function(t,e,a,i,n){null==n&&(n=!1),null==i&&(i=0),this.usage=a,this.instanceDataStepRate=i,this.mySize=t;for(var s=this.myStride=0,r=e.elements;s<r.length;){var o=r[s];switch(++s,o.data){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}}this.buffer=ve.gl.createBuffer();var l=new ds(t*this.myStride/4|0);this._data=l,this.sizes=[],this.offsets=[],this.sizes[e.elements.length-1]=0;for(var _=this.offsets[e.elements.length-1]=0,h=0,f=0,u=e.elements;f<u.length;){var c,d=u[f];switch(++f,d.data){case 0:c=1;break;case 1:c=2;break;case 2:c=3;break;case 3:c=4;break;case 4:c=16}switch(this.sizes[h]=c,this.offsets[h]=_,d.data){case 0:_+=4;break;case 1:_+=8;break;case 2:_+=12;break;case 3:_+=16;break;case 4:_+=64}++h}};(i["kha.graphics4.VertexBuffer"]=Ra).__name__=!0,Ra.prototype={buffer:null,_data:null,mySize:null,myStride:null,sizes:null,offsets:null,usage:null,instanceDataStepRate:null,lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t*this.stride(),(t+e)*this.stride())},unlock:function(){ve.gl.bindBuffer(34962,this.buffer),ve.gl.bufferData(34962,this._data,this.usage==ja.DynamicUsage?35048:35044)},stride:function(){return this.myStride},set:function(t){var e=!!ve.gl2||ve.gl.getExtension("ANGLE_instanced_arrays");ve.gl.bindBuffer(34962,this.buffer);for(var a=0,i=0,n=this.sizes.length;i<n;){var s=i++;if(4<this.sizes[s])for(var r=this.sizes[s],o=0;0<r;)ve.gl.enableVertexAttribArray(t+a),ve.gl.vertexAttribPointer(t+a,4,5126,!1,this.myStride,this.offsets[s]+o),e&&(ve.gl2?ve.gl.vertexAttribDivisor(t+a,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+a,this.instanceDataStepRate)),r-=4,o+=16,++a;else ve.gl.enableVertexAttribArray(t+a),ve.gl.vertexAttribPointer(t+a,this.sizes[s],5126,!1,this.myStride,this.offsets[s]),e&&(ve.gl2?ve.gl.vertexAttribDivisor(t+a,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+a,this.instanceDataStepRate)),++a}return a},__class__:Ra};var Ha=function(t,e){this.name=t,this.data=e};(i["kha.graphics4.VertexElement"]=Ha).__name__=!0,Ha.prototype={name:null,data:null,__class__:Ha};var Pa=function(t,e){this.sources=[];for(var a=0;a<t.length;){var i=t[a];++a,this.sources.push(i.toString())}this.type=35633,this.shader=null,this.files=e};(i["kha.graphics4.VertexShader"]=Pa).__name__=!0,Pa.fromSource=function(t){var e=new Pa([],["runtime-string"]);return e.sources.push(t),e},Pa.prototype={sources:null,type:null,shader:null,files:null,__class__:Pa};var Fa=function(){this.elements=[],this.instanced=!1};(i["kha.graphics4.VertexStructure"]=Fa).__name__=!0,Fa.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new Ha(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,a=this.elements.length;e<a;){var i=e++;t+=this.dataByteSize(this.elements[i].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64}},get:function(t){return this.elements[t]},__class__:Fa};var Oa=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],Oa.instances[t]=this};(i["kha.input.Gamepad"]=Oa).__name__=!0,Oa.get=function(t){return null==t&&(t=0),t>=Oa.instances.length?null:Oa.instances[t]},Oa.sendConnectEvent=function(t){Oa.instances[t].connected=!0;for(var e=0,a=Oa.connectListeners;e<a.length;){var i=a[e];++e,i(t)}},Oa.sendDisconnectEvent=function(t){Oa.instances[t].connected=!1;for(var e=0,a=Oa.disconnectListeners;e<a.length;){var i=a[e];++e,i(t)}},Oa.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},axisListeners:null,buttonListeners:null,connected:null,sendAxisEvent:function(t,e){for(var a=0,i=this.axisListeners;a<i.length;){var n=i[a];++a,n(t,e)}},sendButtonEvent:function(t,e){for(var a=0,i=this.buttonListeners;a<i.length;){var n=i[a];++a,n(t,e)}},__class__:Oa};var Ea=function(){this.__id=bi.nextId++,this._inputBuffer=new nt(new us(1))};(i["kha.network.Controller"]=Ea).__name__=!0,Ea.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},__class__:Ea};var Ua=t.kha.input.Keyboard=function(){Ea.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Ua.instance=this};(i["kha.input.Keyboard"]=Ua).__name__=!0,Ua.get=function(t){return null==t&&(t=0),ve.getKeyboard(t)},Ua.__super__=Ea,Ua.prototype=s(Ea.prototype,{notify:function(t,e,a){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=a&&this.pressListeners.push(a)},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){if(null!=Ii.the()){var e=new nt(new us(5));e.setInt32(0,0),e.b[4]=255&t,Ii.the().sendControllerUpdate(this._id(),e)}for(var a=0,i=this.downListeners;a<i.length;){var n=i[a];++a,n(t)}},sendUpEvent:function(t){if(null!=Ii.the()){var e=new nt(new us(5));e.setInt32(0,1),e.b[4]=255&t,Ii.the().sendControllerUpdate(this._id(),e)}for(var a=0,i=this.upListeners;a<i.length;){var n=i[a];++a,n(t)}},sendPressEvent:function(t){if(null!=Ii.the()){var e=new nt(new us(5));e.setInt32(0,2),e.b[4]=255&q.cca(t,0),Ii.the().sendControllerUpdate(this._id(),e)}for(var a=0,i=this.pressListeners;a<i.length;){var n=i[a];++a,n(t)}},__class__:Ua});var Ja=t.kha.input.Mouse=function(){Ea.call(this),Ja.instance=this};(i["kha.input.Mouse"]=Ja).__name__=!0,Ja.get=function(t){return null==t&&(t=0),ve.getMouse(t)},Ja.__super__=Ea,Ja.prototype=s(Ea.prototype,{notify:function(t,e,a,i,n){this.notifyWindowed(0,t,e,a,i,n)},notifyWindowed:function(t,e,a,i,n,s){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=a){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(a)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(i)}if(null!=n){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(n)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(s)}},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=Ii.the()){var e=new nt(new us(8));e.setInt32(0,0),e.setInt32(4,t),Ii.the().sendControllerUpdate(this._id(),e)}if(null!=this.windowLeaveListeners)for(var a=0,i=this.windowLeaveListeners[t];a<i.length;){var n=i[a];++a,n()}},sendDownEvent:function(t,e,a,i){if(null!=Ii.the()){var n=new nt(new us(20));n.setInt32(0,1),n.setInt32(4,t),n.setInt32(8,e),n.setInt32(12,a),n.setInt32(16,i),Ii.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowDownListeners)for(var s=0,r=this.windowDownListeners[t];s<r.length;){var o=r[s];++s,o(e,a,i)}},sendUpEvent:function(t,e,a,i){if(null!=Ii.the()){var n=new nt(new us(20));n.setInt32(0,2),n.setInt32(4,t),n.setInt32(8,e),n.setInt32(12,a),n.setInt32(16,i),Ii.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowUpListeners)for(var s=0,r=this.windowUpListeners[t];s<r.length;){var o=r[s];++s,o(e,a,i)}},sendMoveEvent:function(t,e,a,i,n){if(null!=Ii.the()){var s=new nt(new us(24));s.setInt32(0,3),s.setInt32(4,t),s.setInt32(8,e),s.setInt32(12,a),s.setInt32(16,i),s.setInt32(20,n),Ii.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowMoveListeners)for(var r=0,o=this.windowMoveListeners[t];r<o.length;){var l=o[r];++r,l(e,a,i,n)}},sendWheelEvent:function(t,e){if(null!=Ii.the()){var a=new nt(new us(12));a.setInt32(0,4),a.setInt32(4,t),a.setInt32(8,e),Ii.the().sendControllerUpdate(this._id(),a)}if(null!=this.windowWheelListeners)for(var i=0,n=this.windowWheelListeners[t];i<n.length;){var s=n[i];++i,s(e)}},__class__:Ja});var Qa=function(){Ja.call(this)};(i["kha.input.MouseImpl"]=Qa).__name__=!0,Qa.__super__=Ja,Qa.prototype=s(Ja.prototype,{__class__:Qa});var qa=function(){qa.instance=this};(i["kha.input.Pen"]=qa).__name__=!0,qa.get=function(t){return null==t&&(t=0),ve.getPen(t)},qa.prototype={notify:function(t,e,a){this.notifyWindowed(0,t,e,a)},notifyWindowed:function(t,e,a,i){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=a){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(a)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(i)}},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,__class__:qa};var $a=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],$a.instance=this};(i["kha.input.Surface"]=$a).__name__=!0,$a.prototype={touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,a){for(var i=0,n=this.touchStartListeners;i<n.length;){var s=n[i];++i,s(t,e,a)}},sendTouchEndEvent:function(t,e,a){for(var i=0,n=this.touchEndListeners;i<n.length;){var s=n[i];++i,s(t,e,a)}},sendMoveEvent:function(t,e,a){for(var i=0,n=this.moveListeners;i<n.length;){var s=n[i];++i,s(t,e,a)}},__class__:$a};var ti=function(t){this.bytes=t};(i["kha.internal.BytesBlob"]=ti).__name__=!0,ti.__interfaces__=[te],ti.fromBytes=function(t){return new ti(t)},ti.alloc=function(t){return new ti(new nt(new us(t)))},ti.readF32=function(t){var e=0==(-2147483648&t)?1:-1,a=t>>23&255,i=8388607&t;switch(a){case 0:return 0;case 255:return 0!=i?NaN:0<e?1/0:-1/0;default:return e*((i+8388608)/8388608)*Math.pow(2,a-127)}},ti.bit=function(t,e){if(1==(t>>>e&1)){return 0,!0}return 0,!1},ti.toText=function(t,e){for(var a="",i=0,n=e;i<n;){var s=i++;a+=String.fromCharCode(t[s])}return a},ti.prototype={bytes:null,sub:function(t,e){return new ti(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.b[t]=255&e},readU8:function(t){var e=this.bytes.b[t];return++t,e},readS8:function(t){var e=this.bytes.b[t];return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1];return t+=2,256*e+a},readU16LE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1];return t+=2,256*a+e},readU32LE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1],i=this.bytes.b[t+2],n=this.bytes.b[t+3];return t+=4,e+256*a+256*i*256+256*n*256*256},readU32BE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1],i=this.bytes.b[t+2],n=this.bytes.b[t+3];return t+=4,n+256*i+256*a*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1];t+=2;var i=0==(128&e)?1:-1;return e&=127,-1==i?256*e-32767+a:256*e+a},readS16LE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1],i=0==(128&a)?1:-1;return a&=127,t+=2,-1==i?256*a-32767+e:256*a+e},readS32LE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1],i=this.bytes.b[t+2],n=this.bytes.b[t+3],s=0==(128&n)?1:-1;return n&=127,t+=4,-1==s?-2147483647+e+256*a+256*i*256+256*n*256*256:e+256*a+256*i*256+256*n*256*256},readS32BE:function(t){var e=this.bytes.b[t],a=this.bytes.b[t+1],i=this.bytes.b[t+2],n=this.bytes.b[t+3],s=0==(128&e)?1:-1;return e&=127,t+=4,-1==s?-2147483647+n+256*i+256*a*256+256*e*256*256:n+256*i+256*a*256+256*e*256*256},readF32LE:function(t){return ti.readF32(this.readS32LE(t))},readF32BE:function(t){return ti.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8Char:function(t){if(t.value>=this.get_length())return-1;var e=this.readU8(t.value);++t.value;var a=0;if(ti.bit(e,7))if(ti.bit(e,7)&&ti.bit(e,6)&&!ti.bit(e,5)){var i=31&e,n=this.readU8(t.value);++t.value,a=i<<6|63&n}else ti.bit(e,7)&&ti.bit(e,6)&&ti.bit(e,5)&&!ti.bit(e,4)?t.value+=2:ti.bit(e,7)&&ti.bit(e,6)&&ti.bit(e,5)&&ti.bit(e,4)&&!ti.bit(e,3)&&(t.value+=3);else a=e;return a},readUtf8Block:function(t,e){var a=0;if(e.value>=this.get_length())return"";for(;a<2e3;){var i=this.readUtf8Char(e);if(i<0)break;t[a]=i,++a}return ti.toText(t,a)},readUtf8String:function(){var t=new Array(2e3),e="",a=0;3<=this.get_length()&&239==this.bytes.b[0]&&187==this.bytes.b[1]&&191==this.bytes.b[2]&&(a=3);for(var i={value:a};i.value<this.get_length();)e+=this.readUtf8Block(t,i);return e},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:ti,__properties__:{get_length:"get_length"}};var ei=function(){};(i["kha.internal.HdrFormat"]=ei).__name__=!0,ei.readBuf=function(t){for(var e=0;t[e++]=255&ei.buffer[ei.fileOffset],++ei.fileOffset<ei.bufferLength&&e<t.length;);return e},ei.readBufOffset=function(t,e,a){for(var i=0;t[e+i++]=255&ei.buffer[ei.fileOffset],++ei.fileOffset<ei.bufferLength&&i<a;);return i},ei.readPixelsRaw=function(t,e,a,i){var n=4*i,s=ei.readBufOffset(e,a,n);s<n&&Fe.trace("Error reading raw pixels: got "+s+" bytes, expected "+n,{fileName:"kha/internal/HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},ei.readPixelsRawRLE=function(t,e,a,i,n){var s,r,o,l=new gs(4),_=null,h=new gs(2);for(t.length;0<n;){if(ei.readBuf(l)<l.length)return void Fe.trace("Error reading bytes: expected "+l.length,{fileName:"kha/internal/HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=l[0]||2!=l[1]||0!=(128&l[2]))return e[a++]=255&l[0],e[a++]=255&l[1],e[a++]=255&l[2],e[a++]=255&l[3],void ei.readPixelsRaw(t,e,a,i*n-1);if(((255&l[2])<<8|255&l[3])!=i)return void Fe.trace("Wrong scanline width "+((255&l[2])<<8|255&l[3])+", expected "+i,{fileName:"kha/internal/HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==_)_=new gs(4*i);for(var f=s=0;f<4;){for(r=(f+++1)*i;s<r;){if(ei.readBuf(h)<h.length)return void Fe.trace("Error reading 2-byte buffer",{fileName:"kha/internal/HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(128<(255&h[0])){if(0==(o=(255&h[0])-128)||r-s<o)return void Fe.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;0<o--;)_[s++]=255&h[1]}else{if(0==(o=255&h[0])||r-s<o)return void Fe.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(_[s++]=255&h[1],0<--o){if(ei.readBufOffset(_,s,o)<o)return void Fe.trace("Error reading non-run data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});s+=o}}}}for(var u=0,c=i;u<c;){var d=u++;e[a]=255&_[d],e[a+1]=255&_[d+i],e[a+2]=255&_[d+2*i],e[a+3]=255&_[d+3*i],a+=4}--n}},ei.readLine=function(){for(var t="";;){var e=ei.buffer[ei.fileOffset];if(10==e){++ei.fileOffset;break}if(t+=String.fromCharCode(e),!(++ei.fileOffset<ei.bufferLength))break}return t},ei.parse=function(t){ei.buffer=H.fromBytes(t),ei.bufferLength=ei.buffer.length;for(var e=ei.fileOffset=0,a=0,i=!1,n=0;n<20;){n++;var s=ei.readLine();if(ei.formatPattern.match(s))i=!0;else if(ei.exposurePattern.match(s))parseFloat(ei.exposurePattern.matched(1));else if(ei.widthHeightPattern.match(s)){a=X.parseInt(ei.widthHeightPattern.matched(1)),e=X.parseInt(ei.widthHeightPattern.matched(2));break}}if(!i)return Fe.trace("File is not run length encoded!",{fileName:"kha/internal/HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var r=new gs(e*a*4),o=e,l=a;ei.readPixelsRawRLE(ei.buffer,r,0,o,l);for(var _=new ds(e*a*4),h=0;h<r.length;){var f=r[h]/255,u=r[h+1]/255,c=r[h+2]/255,d=r[h+3],g=Math.pow(2,d-128);f*=g,u*=g,c*=g,_[h]=f,_[h+1]=u,_[h+2]=c,_[h+3]=1,h+=4}return{width:e,height:a,data:_}};var ai=function(t){this.stopped=!1,this.element=t};(i["kha.js.AEAudioChannel"]=ai).__name__=!0,ai.__interfaces__=[xe],ai.prototype={element:null,stopped:null,play:function(){this.stopped=!1,ve.mobile?ve.insideInputEvent?(this.element.play(),ve.mobileAudioPlaying=!0):ve.mobileAudioPlaying?this.element.play():ai.todo.push(this):this.element.play()},get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},get_position:function(){return this.element.currentTime},set_volume:function(t){return this.element.volume=t},get_finished:function(){return!!this.stopped||this.get_position()>=this.get_length()},__class__:ai,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_position:"get_position",get_length:"get_length"}};var ii=function(){};(i["kha.js.AudioElementAudio"]=ii).__name__=!0,ii._compile=function(){},ii.play=function(t,e){return null==e&&(e=!1),ii.stream(t,e)},ii.stream=function(t,e){null==e&&(e=!1),t.element.loop=e;var a=new ai(t.element);return a.play(),a};var ni=function(t){aa.call(this),this.canvas=t,(ni.instance=this).myColor=ie.fromBytes(0,0,0),t.save()};(i["kha.js.CanvasGraphics"]=ni).__name__=!0,ni.__super__=aa,ni.prototype=s(aa.prototype,{canvas:null,myColor:null,begin:function(t,e){null==t&&(t=!0),t&&this.clear(e)},clear:function(t){null==t&&(t=0),this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",.00392156862745098*(t>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},set_color:function(t){return this.myColor=t,this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",t},fillRect:function(t,e,a,i){var n=this.get_opacity();this.canvas.globalAlpha=n*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(t,e,a,i),this.canvas.globalAlpha=this.get_opacity()},__class__:ni});var si=function(t){this.images=new $,this.kravur=new si.Kravur(t)};(i["kha.js.Font"]=si).__name__=!0,si.__interfaces__=[te],si.fromBytes=function(t){return new si(ti.fromBytes(t))},si.prototype={kravur:null,images:null,height:function(t){return this.kravur._get(t).getHeight()},width:function(t,e){return this.kravur._get(t).stringWidth(e)},widthOfCharacters:function(t,e,a,i){return this.kravur._get(t).charactersWidth(e,a,i)},baseline:function(t){return this.kravur._get(t).getBaselinePosition()},getImage:function(t,e,a){var i=null==a?t:1e4*t+a.length;if(!this.images.h.hasOwnProperty(i)){var n=this.images,s=new $;n.h[i]=s}if(!this.images.h[i].h.hasOwnProperty(e)){var r=this.kravur._get(t,a),o=window.document.createElement("canvas");o.width=r.width,o.height=r.height;var l=o.getContext("2d");l.fillStyle="black",l.fillRect(0,0,r.width,r.height);for(var _=l.getImageData(0,0,r.width,r.height),h=d_.__cast(r.getTexture(),ae).bytes,f=0,u=h.length;f<u;){var c=f++;_.data[4*c]=(16711680&e)>>>16,_.data[4*c+1]=(65280&e)>>>8,_.data[4*c+2]=255&e,_.data[4*c+3]=h.b[c]}l.putImageData(_,0,0);var d=window.document.createElement("img");return d.src=o.toDataURL("image/png"),this.images.h[i].h[e]=d}return this.images.h[i].h[e]},unload:function(){this.kravur=null,this.images=null},__class__:si};var ri=function(){};(i["kha.js.MobileWebAudio"]=ri).__name__=!0,ri._init=function(){try{return void(ri._context=new AudioContext)}catch(t){t instanceof Jt&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof Jt&&t.val}},ri.play=function(t,e){null==e&&(e=!1);var a=new oi(t,e);return a.play(),a},ri.stream=function(t,e){return null==e&&(e=!1),ri.play(t,e)};var oi=function(t,e){this.stopped=!1,this.paused=!1,this.buffer=t._buffer,this.loop=e,this.createSource()};(i["kha.js.MobileWebAudioChannel"]=oi).__name__=!0,oi.__interfaces__=[xe],oi.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var t=this;this.source=ri._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){t.stopped=!0},this.gain=ri._context.createGain(),this.source.connect(this.gain),this.gain.connect(ri._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=ri._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=ri._context.currentTime,this.source.start())},set_volume:function(t){return this.gain.gain.value=t},get_finished:function(){return this.stopped},__class__:oi,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var li=function(t,e,a){var i=this;ge.call(this);var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onerror=function(){a({url:t})},n.onload=function(){i.compressedData=nt.ofData(n.response),i.uncompressedData=null,ri._context.decodeAudioData(i.compressedData.b.bufferValue,function(t){i._buffer=t,e(i)},function(){a({url:t,error:"Audio format not supported"})})},n.send(null)};(i["kha.js.MobileWebAudioSound"]=li).__name__=!0,li.__super__=ge,li.prototype=s(ge.prototype,{_buffer:null,uncompress:function(t){t()},__class__:li});var _i=function(t,e,a){ge.call(this),this.done=e,this.failed=a,_i.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var i=0;i<t.length;){var n=t[i];++i,""!=this.element.canPlayType("audio/ogg")&&O.endsWith(n,".ogg")&&this.filenames.push(n),""!=this.element.canPlayType("audio/mp4")&&O.endsWith(n,".mp4")&&this.filenames.push(n)}this.element.addEventListener("error",ns(this,this.errorListener),!1),this.element.addEventListener("canplay",ns(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(i["kha.js.Sound"]=_i).__name__=!0,_i.__super__=ge,_i.prototype=s(ge.prototype,{filenames:null,done:null,failed:null,element:null,errorListener:function(t){if(4==this.element.error.code)for(var e=0,a=this.filenames.length-1;e<a;){var i=e++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ns(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ns(this,this.canPlayThroughListener),!1),this.done(this),q.remove(_i.loading,this)},uncompress:function(t){t()},__class__:_i});var hi=function(){Ie.call(this)};(i["kha.js.Video"]=hi).__name__=!0,hi.fromFile=function(t,e){var a=new hi;a.done=e,a.element=window.document.createElement("video"),a.filenames=[];for(var i=0;i<t.length;){var n=t[i];++i,""!=a.element.canPlayType("video/webm")&&O.endsWith(n,".webm")&&a.filenames.push(n),""!=a.element.canPlayType("video/mp4")&&O.endsWith(n,".mp4")&&a.filenames.push(n)}a.element.addEventListener("error",ns(a,a.errorListener),!1),a.element.addEventListener("canplaythrough",ns(a,a.canPlayThroughListener),!1),a.element.preload="auto",a.element.src=a.filenames[0]},hi.__super__=Ie,hi.prototype=s(Ie.prototype,{filenames:null,element:null,done:null,texture:null,errorListener:function(t){if(4==this.element.error.code)for(var e=0,a=this.filenames.length-1;e<a;){var i=e++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}Fe.trace("Error loading "+this.element.src,{fileName:"kha/js/Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ns(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ns(this,this.canPlayThroughListener),!1),null!=ve.gl&&(this.texture=ee.fromVideo(this)),this.done(this)},__class__:hi});var fi=function(t,e,a){var i=this;ge.call(this);var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onerror=function(){a({url:t})},n.onload=function(){i.compressedData=nt.ofData(n.response),i.uncompressedData=null,e(i)},n.send(null)};(i["kha.js.WebAudioSound"]=fi).__name__=!0,fi.__super__=ge,fi.prototype=s(ge.prototype,{superUncompress:function(t){ge.prototype.uncompress.call(this,t)},uncompress:function(c){var d=this;Ce._context.decodeAudioData(this.compressedData.b.bufferValue,function(t){var a=t.getChannelData(0),e=a.length,i=new ds(2*e);if(d.uncompressedData=i,1==t.numberOfChannels){var n=0,s=0,r=2*e,o=function(){};(o=function(){for(var t=n+11025,e=r<t?r:t;n<e;)d.uncompressedData[n]=a[s],d.uncompressedData[n+1]=a[s],n+=2,s+=1;n<r?window.setTimeout(o,0):d.compressedData=null})(),window.setTimeout(c,250)}else{var l=t.getChannelData(1),_=0,h=0,f=2*e,u=function(){};(u=function(){for(var t=_+11025,e=f<t?f:t;_<e;)d.uncompressedData[_]=a[h],d.uncompressedData[_+1]=l[h],_+=2,h+=1;_<f?window.setTimeout(u,0):d.compressedData=null})(),window.setTimeout(c,250)}},function(){d.superUncompress(c)})},__class__:fi});var ui=function(t,e){this.value=t,this.type=e};(i["kha.js.graphics4.ConstantLocation"]=ui).__name__=!0,ui.__interfaces__=[Ma],ui.prototype={value:null,type:null,__class__:ui};var ci=function(t){this.matrix3Cache=new ds(9),this.matrixCache=new ds(16),this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.renderTarget=t,this.init(),ve.gl2?this.instancedExtension=!0:(this.instancedExtension=ve.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=ve.gl.getExtension("EXT_blend_minmax"))};(i["kha.js.graphics4.Graphics"]=ci).__name__=!0,ci.__interfaces__=[Aa],ci.getBlendFunc=function(t){switch(t._hx_index){case 0:case 2:return 0;case 1:return 1;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},ci.getBlendOp=function(t){switch(t._hx_index){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},ci.prototype={depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=this.renderTarget instanceof ya,this.isCubeMap){var t=d_.__cast(this.renderTarget,ya);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture,this.isDepthAttachment=t.isDepthAttachment}else{var e=d_.__cast(this.renderTarget,Me);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture}},begin:function(t){if(ve.gl.enable(3042),ve.gl.blendFunc(770,771),null==this.renderTarget)ve.gl.bindFramebuffer(36160,null),ve.gl.viewport(0,0,co.windowWidth(),co.windowHeight());else if(ve.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),ve.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=t){ve.gl.framebufferTexture2D(36160,ve.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var e=0,a=t.length;e<a;){var i=e++;ve.gl.framebufferTexture2D(36160,ve.drawBuffers.COLOR_ATTACHMENT0_WEBGL+i+1,3553,d_.__cast(t[i],Me).texture,0)}for(var n=[ve.drawBuffers.COLOR_ATTACHMENT0_WEBGL],s=0,r=t.length;s<r;){var o=s++;n.push(ve.drawBuffers.COLOR_ATTACHMENT0_WEBGL+o+1)}ve.gl2?ve.gl.drawBuffers(n):ve.drawBuffers.drawBuffersWEBGL(n)}},beginFace:function(t){ve.gl.enable(3042),ve.gl.blendFunc(770,771),ve.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),ve.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+t,this.renderTargetTexture,0),ve.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},end:function(){},clear:function(t,e,a){var i=0;null!=t&&(i|=16384,ve.gl.colorMask(!0,!0,!0,!0),ve.gl.clearColor(.00392156862745098*((16711680&t)>>>16),.00392156862745098*((65280&t)>>>8),.00392156862745098*(255&t),.00392156862745098*(t>>>24))),null!=e&&(i|=256,ve.gl.enable(2929),ve.gl.depthMask(!0),ve.gl.clearDepth(e)),null!=a&&(i|=1024,ve.gl.enable(2960),ve.gl.stencilMask(255),ve.gl.clearStencil(a)),ve.gl.clear(i),ve.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?ve.gl.enable(2929):ve.gl.disable(2929),ve.gl.depthMask(this.depthMask)},viewport:function(t,e,a,i){null==this.renderTarget?ve.gl.viewport(t,co.windowHeight(0)-e-i,a,i):ve.gl.viewport(t,e,a,i)},scissor:function(t,e,a,i){ve.gl.enable(3089),null==this.renderTarget?ve.gl.scissor(t,co.windowHeight(0)-e-i,a,i):ve.gl.scissor(t,e,a,i)},disableScissor:function(){ve.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},setDepthMode:function(t,e){switch(e._hx_index){case 0:t?ve.gl.enable(2929):ve.gl.disable(2929),this.depthTest=t,ve.gl.depthFunc(519);break;case 1:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(512);break;case 2:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(514);break;case 3:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(517);break;case 4:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(513);break;case 5:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(515);break;case 6:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(516);break;case 7:ve.gl.enable(2929),this.depthTest=!0,ve.gl.depthFunc(518)}ve.gl.depthMask(t),this.depthMask=t},setBlendingMode:function(t,e,a,i,n,s){t==va.BlendOne&&e==va.BlendZero?ve.gl.disable(3042):(ve.gl.enable(3042),ve.gl.blendFuncSeparate(ci.getBlendFunc(t),ci.getBlendFunc(e),ci.getBlendFunc(i),ci.getBlendFunc(n)),ve.gl.blendEquationSeparate(ci.getBlendOp(a),ci.getBlendOp(s)))},setVertexBuffer:function(t){d_.__cast(t,Ra).set(0)},setVertexBuffers:function(t){for(var e=0,a=0;a<t.length;){var i=t[a];++a,e+=d_.__cast(i,Ra).set(e)}},setIndexBuffer:function(t){this.indicesCount=t.count(),d_.__cast(t,Sa).set()},setTexture:function(t,e){null==e?(ve.gl.activeTexture(33984+d_.__cast(t,gi).value),ve.gl.bindTexture(3553,null)):d_.__cast(e,Me).set(d_.__cast(t,gi).value)},setTextureDepth:function(t,e){d_.__cast(e,Me).setDepth(d_.__cast(t,gi).value)},setImageTexture:function(t,e){},setTextureParameters:function(t,e,a,i,n,s){switch(ve.gl.activeTexture(33984+d_.__cast(t,gi).value),e._hx_index){case 0:ve.gl.texParameteri(3553,10242,10497);break;case 1:ve.gl.texParameteri(3553,10242,33648);break;case 2:ve.gl.texParameteri(3553,10242,33071)}switch(a._hx_index){case 0:ve.gl.texParameteri(3553,10243,10497);break;case 1:ve.gl.texParameteri(3553,10243,33648);break;case 2:ve.gl.texParameteri(3553,10243,33071)}switch(i._hx_index){case 0:switch(s._hx_index){case 0:ve.gl.texParameteri(3553,10241,9728);break;case 1:ve.gl.texParameteri(3553,10241,9984);break;case 2:ve.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(s._hx_index){case 0:ve.gl.texParameteri(3553,10241,9729);break;case 1:ve.gl.texParameteri(3553,10241,9985);break;case 2:ve.gl.texParameteri(3553,10241,9987)}i==Ta.AnisotropicFilter&&ve.gl.texParameteri(3553,ve.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(n._hx_index){case 0:ve.gl.texParameteri(3553,10240,9728);break;case 1:case 2:ve.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(t,e,a,i,n,s,r){},setCubeMap:function(t,e){null==e?(ve.gl.activeTexture(33984+d_.__cast(t,gi).value),ve.gl.bindTexture(34067,null)):e.set(d_.__cast(t,gi).value)},setCubeMapDepth:function(t,e){e.setDepth(d_.__cast(t,gi).value)},setCullMode:function(t){switch(t._hx_index){case 0:ve.gl.enable(2884),ve.gl.cullFace(1029);break;case 1:ve.gl.enable(2884),ve.gl.cullFace(1028);break;case 2:ve.gl.disable(2884)}},setPipeline:function(t){this.setCullMode(t.cullMode),this.setDepthMode(t.depthWrite,t.depthMode),this.setStencilParameters(t.stencilMode,t.stencilBothPass,t.stencilDepthFail,t.stencilFail,t.stencilReferenceValue,t.stencilReadMask,t.stencilWriteMask),this.setBlendingMode(t.blendSource,t.blendDestination,t.blendOperation,t.alphaBlendSource,t.alphaBlendDestination,t.alphaBlendOperation),t.set(),this.colorMaskRed=t.colorWriteMaskRed,this.colorMaskGreen=t.colorWriteMaskGreen,this.colorMaskBlue=t.colorWriteMaskBlue,this.colorMaskAlpha=t.colorWriteMaskAlpha},setBool:function(t,e){ve.gl.uniform1i(d_.__cast(t,ui).value,e?1:0)},setInt:function(t,e){ve.gl.uniform1i(d_.__cast(t,ui).value,e)},setFloat:function(t,e){ve.gl.uniform1f(d_.__cast(t,ui).value,e)},setFloat2:function(t,e,a){ve.gl.uniform2f(d_.__cast(t,ui).value,e,a)},setFloat3:function(t,e,a,i){ve.gl.uniform3f(d_.__cast(t,ui).value,e,a,i)},setFloat4:function(t,e,a,i,n){ve.gl.uniform4f(d_.__cast(t,ui).value,e,a,i,n)},setFloats:function(t,e){var a=d_.__cast(t,ui);switch(a.type){case 35664:ve.gl.uniform2fv(a.value,e);break;case 35665:ve.gl.uniform3fv(a.value,e);break;case 35666:ve.gl.uniform4fv(a.value,e);break;case 35676:ve.gl.uniformMatrix4fv(a.value,!1,e);break;default:ve.gl.uniform1fv(a.value,e)}},matrixCache:null,setMatrix:function(t,e){this.matrixCache[0]=e._00,this.matrixCache[1]=e._01,this.matrixCache[2]=e._02,this.matrixCache[3]=e._03,this.matrixCache[4]=e._10,this.matrixCache[5]=e._11,this.matrixCache[6]=e._12,this.matrixCache[7]=e._13,this.matrixCache[8]=e._20,this.matrixCache[9]=e._21,this.matrixCache[10]=e._22,this.matrixCache[11]=e._23,this.matrixCache[12]=e._30,this.matrixCache[13]=e._31,this.matrixCache[14]=e._32,this.matrixCache[15]=e._33,ve.gl.uniformMatrix4fv(d_.__cast(t,ui).value,!1,this.matrixCache)},matrix3Cache:null,setMatrix3:function(t,e){this.matrix3Cache[0]=e._00,this.matrix3Cache[1]=e._01,this.matrix3Cache[2]=e._02,this.matrix3Cache[3]=e._10,this.matrix3Cache[4]=e._11,this.matrix3Cache[5]=e._12,this.matrix3Cache[6]=e._20,this.matrix3Cache[7]=e._21,this.matrix3Cache[8]=e._22,ve.gl.uniformMatrix3fv(d_.__cast(t,ui).value,!1,this.matrix3Cache)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0);var a=null==ve.elementIndexUint?5123:5125,i=5123==a?2:4;ve.gl.drawElements(4,-1==e?this.indicesCount:e,a,t*i)},convertStencilAction:function(t){switch(t._hx_index){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},setStencilParameters:function(t,e,a,i,n,s,r){if(null==r&&(r=255),null==s&&(s=255),t==Ia.Always&&e==La.Keep&&a==La.Keep&&i==La.Keep)ve.gl.disable(2960);else{ve.gl.enable(2960);var o=0;switch(t._hx_index){case 0:o=519;break;case 1:o=512;break;case 2:o=514;break;case 3:o=517;break;case 4:o=513;break;case 5:o=515;break;case 6:o=516;break;case 7:o=518}ve.gl.stencilMask(r),ve.gl.stencilOp(this.convertStencilAction(i),this.convertStencilAction(a),this.convertStencilAction(e)),ve.gl.stencilFunc(o,n,s)}},drawIndexedVerticesInstanced:function(t,e,a){if(null==a&&(a=-1),null==e&&(e=0),this.instancedRenderingAvailable()){var i=null==ve.elementIndexUint?5123:5125,n=null==ve.elementIndexUint?2:4;ve.gl2?ve.gl.drawElementsInstanced(4,-1==a?this.indicesCount:a,i,e*n,t):this.instancedExtension.drawElementsInstancedANGLE(4,-1==a?this.indicesCount:a,i,e*n,t)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:ci};var di=function(t){ka.call(this,t)};(i["kha.js.graphics4.Graphics2"]=di).__name__=!0,di.__super__=ka,di.prototype=s(ka.prototype,{begin:function(t,e){null==t&&(t=!0),ve.gl.colorMask(!0,!0,!0,!0),ve.gl.disable(2929),ve.gl.depthFunc(519),ka.prototype.begin.call(this,t,e)},__class__:di});var gi=function(t){this.value=t};(i["kha.js.graphics4.TextureUnit"]=gi).__name__=!0,gi.__interfaces__=[Ka],gi.prototype={value:null,__class__:gi};var pi=function(){};(i["kha.vr.VrInterface"]=pi).__name__=!0,pi.prototype={IsVrEnabled:function(){return!1},__class__:pi};var mi=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,pi.call(this)};(i["kha.js.vr.VrInterface"]=mi).__name__=!0,mi.__super__=pi,mi.prototype=s(pi.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,width:null,height:null,vrWidth:null,vrHeight:null,getVRDisplays:function(){var i=this;navigator.getVRDisplays().then(function(t){if(0<t.length){i.frameData=new VRFrameData,i.vrDisplay=t[0],i.vrDisplay.depthNear=.1,i.vrDisplay.depthFar=1024;var e=i.vrDisplay.getEyeParameters("left"),a=i.vrDisplay.getEyeParameters("right");i.width=ve.khanvas.width,i.height=ve.khanvas.height,i.vrWidth=2*Math.max(e.renderWidth,a.renderWidth)|0,i.vrHeight=0|Math.max(e.renderHeight,a.renderHeight)}else Fe.trace("There are no VR displays connected.",{fileName:"kha/js/vr/VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:mi});var vi=function(t,e,a){null==a&&(a=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=a};(i["kha.math.FastVector3"]=vi).__name__=!0,vi.prototype={x:null,y:null,z:null,__class__:vi};var bi=function(){};(i["kha.network.ControllerBuilder"]=bi).__name__=!0;var Ii=function(t,e,a){this.controllers=new $,(Ii.instance=this).maxPlayers=t,this.address=e,this.port=a};(i["kha.network.Session"]=Ii).__name__=!0,Ii.the=function(){return Ii.instance},Ii.prototype={controllers:null,maxPlayers:null,address:null,port:null,sendControllerUpdate:function(t,e){if(this.controllers.h.hasOwnProperty(t)){if(this.controllers.h[t]._inputBuffer.length<this.controllers.h[t]._inputBufferIndex+4+e.length){var a=new nt(new us(this.controllers.h[t]._inputBufferIndex+4+e.length));a.blit(0,this.controllers.h[t]._inputBuffer,0,this.controllers.h[t]._inputBufferIndex),this.controllers.h[t]._inputBuffer=a}this.controllers.h[t]._inputBuffer.setInt32(this.controllers.h[t]._inputBufferIndex,e.length),this.controllers.h[t]._inputBuffer.blit(this.controllers.h[t]._inputBufferIndex+4,e,0,e.length),this.controllers.h[t]._inputBufferIndex+=4+e.length}},__class__:Ii};var Mi=function(t){this._type=t,this._numProxies=0,this._proxyList=null,this._proxyListLast=null,this._proxyPairList=null,this._incremental=!1,this._testCount=0,this._proxyPairPool=null,this._idCount=0,this._convexSweep=new xi,this._aabb=new Ci,this.identity=new rn,this.zero=new Et,this.rayCastHit=new Ki};(i["oimo.collision.broadphase.BroadPhase"]=Mi).__name__=!0,Mi.prototype={_type:null,_numProxies:null,_proxyList:null,_proxyListLast:null,_proxyPairList:null,_incremental:null,_testCount:null,_proxyPairPool:null,_idCount:null,_convexSweep:null,_aabb:null,identity:null,zero:null,rayCastHit:null,createProxy:function(t,e){return null},destroyProxy:function(t){},moveProxy:function(t,e,a){},collectPairs:function(){},__class__:Mi};var yi=function(t){this._type=t,this._volume=0};(i["oimo.collision.geometry.Geometry"]=yi).__name__=!0,yi.prototype={_type:null,_volume:null,_inertiaCoeff00:null,_inertiaCoeff01:null,_inertiaCoeff02:null,_inertiaCoeff10:null,_inertiaCoeff11:null,_inertiaCoeff12:null,_inertiaCoeff20:null,_inertiaCoeff21:null,_inertiaCoeff22:null,_updateMass:function(){},_computeAabb:function(t,e){},__class__:yi};var wi=function(t){yi.call(this,t),this._gjkMargin=xn.defaultGJKMargin,this._useGjkRayCast=!1};(i["oimo.collision.geometry.ConvexGeometry"]=wi).__name__=!0,wi.__super__=yi,wi.prototype=s(yi.prototype,{_gjkMargin:null,_useGjkRayCast:null,computeLocalSupportingVertex:function(t,e){},__class__:wi});var xi=function(){wi.call(this,-1)};(i["oimo.collision.broadphase._BroadPhase.ConvexSweepGeometry"]=xi).__name__=!0,xi.__super__=wi,xi.prototype=s(wi.prototype,{c:null,localTranslation:null,computeLocalSupportingVertex:function(t,e){this.c.computeLocalSupportingVertex(t,e);var a=this.localTranslation;if(0<t.x*a.x+t.y*a.y+t.z*a.z){var i=this.localTranslation,n=e.x+i.x,s=e.y+i.y,r=e.z+i.z;e.x=n,e.y=s,e.z=r}},__class__:xi});var Ci=function(){wi.call(this,-1),this.min=new Et,this.max=new Et};(i["oimo.collision.broadphase._BroadPhase.AabbGeometry"]=Ci).__name__=!0,Ci.__super__=wi,Ci.prototype=s(wi.prototype,{min:null,max:null,computeLocalSupportingVertex:function(t,e){e.x=0<t.x?this.max.x:this.min.x,e.y=0<t.y?this.max.y:this.min.y,e.z=0<t.z?this.max.z:this.min.z},__class__:Ci});var Ai=function(){};(i["oimo.collision.broadphase.BroadPhaseProxyCallback"]=Ai).__name__=!0,Ai.prototype={__class__:Ai};var Zi=function(t,e){this.userData=t,this._id=e,this._prev=null,this._next=null,this._aabbMinX=0,this._aabbMinY=0,this._aabbMinZ=0,this._aabbMaxX=0,this._aabbMaxY=0,this._aabbMaxZ=0};(i["oimo.collision.broadphase.Proxy"]=Zi).__name__=!0,Zi.prototype={_prev:null,_next:null,_aabbMinX:null,_aabbMinY:null,_aabbMinZ:null,_aabbMaxX:null,_aabbMaxY:null,_aabbMaxZ:null,_id:null,userData:null,__class__:Zi};var zi=function(){this._p1=null,this._p2=null};(i["oimo.collision.broadphase.ProxyPair"]=zi).__name__=!0,zi.prototype={_next:null,_p1:null,_p2:null,__class__:zi};var Bi=function(){Mi.call(this,1),this._incremental=!1};(i["oimo.collision.broadphase.bruteforce.BruteForceBroadPhase"]=Bi).__name__=!0,Bi.__super__=Mi,Bi.prototype=s(Mi.prototype,{createProxy:function(t,e){var a=new Zi(t,this._idCount++);return this._numProxies++,null==this._proxyList?this._proxyList=a:(this._proxyListLast._next=a)._prev=this._proxyListLast,(this._proxyListLast=a)._aabbMinX=e._minX,a._aabbMinY=e._minY,a._aabbMinZ=e._minZ,a._aabbMaxX=e._maxX,a._aabbMaxY=e._maxY,a._aabbMaxZ=e._maxZ,a},destroyProxy:function(t){this._numProxies--;var e=t._prev,a=t._next;null!=e&&(e._next=a),null!=a&&(a._prev=e),t==this._proxyList&&(this._proxyList=this._proxyList._next),t==this._proxyListLast&&(this._proxyListLast=this._proxyListLast._prev),t._next=null,t._prev=null,t.userData=null},moveProxy:function(t,e,a){t._aabbMinX=e._minX,t._aabbMinY=e._minY,t._aabbMinZ=e._minZ,t._aabbMaxX=e._maxX,t._aabbMaxY=e._maxY,t._aabbMaxZ=e._maxZ},collectPairs:function(){var t=this._proxyPairList;if(null!=t){for(;t._p1=null,(t._p2=null)!=(t=t._next););this._proxyPairList._next=this._proxyPairPool,this._proxyPairPool=this._proxyPairList,this._proxyPairList=null}this._testCount=0;for(var e=this._proxyList;null!=e;){for(var a=e._next,i=e._next;null!=i;){var n=i._next;if(this._testCount++,e._aabbMinX<i._aabbMaxX&&e._aabbMaxX>i._aabbMinX&&e._aabbMinY<i._aabbMaxY&&e._aabbMaxY>i._aabbMinY&&e._aabbMinZ<i._aabbMaxZ&&e._aabbMaxZ>i._aabbMinZ){var s=this._proxyPairPool;null!=s?(this._proxyPairPool=s._next,s._next=null):s=new zi;var r=s;null==this._proxyPairList||(r._next=this._proxyPairList),(this._proxyPairList=r)._p1=e,r._p2=i}i=n}e=a}},__class__:Bi});var ki=function(){Mi.call(this,2),this._incremental=!0,this._tree=new Ni;var t=new Array(1024);this.movedProxies=t,this.numMovedProxies=0};(i["oimo.collision.broadphase.bvh.BvhBroadPhase"]=ki).__name__=!0,ki.__super__=Mi,ki.prototype=s(Mi.prototype,{_tree:null,movedProxies:null,numMovedProxies:null,collide:function(t,e){this._testCount++;var a=0==t._height,i=0==e._height;if(t==e){if(a)return;return this.collide(t._children[0],e),void this.collide(t._children[1],e)}if(t._aabbMinX<e._aabbMaxX&&t._aabbMaxX>e._aabbMinX&&t._aabbMinY<e._aabbMaxY&&t._aabbMaxY>e._aabbMinY&&t._aabbMinZ<e._aabbMaxZ&&t._aabbMaxZ>e._aabbMinZ){if(a&&i){var n=t._proxy,s=e._proxy,r=this._proxyPairPool;null!=r?(this._proxyPairPool=r._next,r._next=null):r=new zi;var o=r;return null==this._proxyPairList||(o._next=this._proxyPairList),(this._proxyPairList=o)._p1=n,void(o._p2=s)}i||t._height>e._height?(this.collide(t._children[0],e),this.collide(t._children[1],e)):(this.collide(e._children[0],t),this.collide(e._children[1],t))}},createProxy:function(t,e){var a=new Xi(t,this._idCount++);this._numProxies++,null==this._proxyList?this._proxyList=a:(this._proxyListLast._next=a)._prev=this._proxyListLast,(this._proxyListLast=a)._aabbMinX=e._minX,a._aabbMinY=e._minY,a._aabbMinZ=e._minZ,a._aabbMaxX=e._maxX,a._aabbMaxY=e._maxY,a._aabbMaxZ=e._maxZ;var i,n,s,r=xn.bvhProxyPadding;s=n=i=r,a._aabbMinX-=i,a._aabbMinY-=n,a._aabbMinZ-=s,a._aabbMaxX+=i,a._aabbMaxY+=n,a._aabbMaxZ+=s;var o=this._tree,l=o._nodePool;null!=l?(o._nodePool=l._next,l._next=null):l=new Si;var _=l;if(((_._proxy=a)._leaf=_)._aabbMinX=a._aabbMinX,_._aabbMinY=a._aabbMinY,_._aabbMinZ=a._aabbMinZ,_._aabbMaxX=a._aabbMaxX,_._aabbMaxY=a._aabbMaxY,_._aabbMaxZ=a._aabbMaxZ,o._numLeaves++,null==o.leafList?o.leafList=_:(o.leafListLast._nextLeaf=_)._prevLeaf=o.leafListLast,o.leafListLast=_,null==o._root)o._root=_;else{for(var h=o._root;0<h._height;){var f=o._strategy._decideInsertion(h,_);if(-1==f)break;h=h._children[f]}var u=h._parent,c=o._nodePool;null!=c?(o._nodePool=c._next,c._next=null):c=new Si;var d=c;if(null==u)o._root=d;else{var g=h._childIndex;(u._children[g]=d)._parent=u,d._childIndex=g}var p=h._childIndex;(d._children[p]=h)._parent=d,h._childIndex=p;var m=1^h._childIndex;for((d._children[m]=_)._parent=d,_._childIndex=m;null!=d;){if(o._strategy._balancingEnabled)if(d._height<2)d=d;else{var v=d._parent,b=d._children[0],I=d._children[1],M=b._height-I._height,y=d._childIndex;if(1<M){var w=b._children[0],x=b._children[1],C=w._height;if(x._height<C){(b._children[1]=d)._parent=b,d._childIndex=1,(d._children[0]=x)._parent=d,x._childIndex=0;var A=b._children[0],Z=b._children[1];b._aabbMinX=A._aabbMinX<Z._aabbMinX?A._aabbMinX:Z._aabbMinX,b._aabbMinY=A._aabbMinY<Z._aabbMinY?A._aabbMinY:Z._aabbMinY,b._aabbMinZ=A._aabbMinZ<Z._aabbMinZ?A._aabbMinZ:Z._aabbMinZ,b._aabbMaxX=A._aabbMaxX>Z._aabbMaxX?A._aabbMaxX:Z._aabbMaxX,b._aabbMaxY=A._aabbMaxY>Z._aabbMaxY?A._aabbMaxY:Z._aabbMaxY,b._aabbMaxZ=A._aabbMaxZ>Z._aabbMaxZ?A._aabbMaxZ:Z._aabbMaxZ;var z=b._children[0]._height,B=b._children[1]._height;b._height=(B<z?z:B)+1;var k=d._children[0],S=d._children[1];d._aabbMinX=k._aabbMinX<S._aabbMinX?k._aabbMinX:S._aabbMinX,d._aabbMinY=k._aabbMinY<S._aabbMinY?k._aabbMinY:S._aabbMinY,d._aabbMinZ=k._aabbMinZ<S._aabbMinZ?k._aabbMinZ:S._aabbMinZ,d._aabbMaxX=k._aabbMaxX>S._aabbMaxX?k._aabbMaxX:S._aabbMaxX,d._aabbMaxY=k._aabbMaxY>S._aabbMaxY?k._aabbMaxY:S._aabbMaxY,d._aabbMaxZ=k._aabbMaxZ>S._aabbMaxZ?k._aabbMaxZ:S._aabbMaxZ;var X=d._children[0]._height,Y=d._children[1]._height;d._height=(Y<X?X:Y)+1}else{(b._children[0]=d)._parent=b,d._childIndex=0,(d._children[0]=w)._parent=d,w._childIndex=0;var N=b._children[0],L=b._children[1];b._aabbMinX=N._aabbMinX<L._aabbMinX?N._aabbMinX:L._aabbMinX,b._aabbMinY=N._aabbMinY<L._aabbMinY?N._aabbMinY:L._aabbMinY,b._aabbMinZ=N._aabbMinZ<L._aabbMinZ?N._aabbMinZ:L._aabbMinZ,b._aabbMaxX=N._aabbMaxX>L._aabbMaxX?N._aabbMaxX:L._aabbMaxX,b._aabbMaxY=N._aabbMaxY>L._aabbMaxY?N._aabbMaxY:L._aabbMaxY,b._aabbMaxZ=N._aabbMaxZ>L._aabbMaxZ?N._aabbMaxZ:L._aabbMaxZ;var G=b._children[0]._height,W=b._children[1]._height;b._height=(W<G?G:W)+1;var D=d._children[0],T=d._children[1];d._aabbMinX=D._aabbMinX<T._aabbMinX?D._aabbMinX:T._aabbMinX,d._aabbMinY=D._aabbMinY<T._aabbMinY?D._aabbMinY:T._aabbMinY,d._aabbMinZ=D._aabbMinZ<T._aabbMinZ?D._aabbMinZ:T._aabbMinZ,d._aabbMaxX=D._aabbMaxX>T._aabbMaxX?D._aabbMaxX:T._aabbMaxX,d._aabbMaxY=D._aabbMaxY>T._aabbMaxY?D._aabbMaxY:T._aabbMaxY,d._aabbMaxZ=D._aabbMaxZ>T._aabbMaxZ?D._aabbMaxZ:T._aabbMaxZ;var V=d._children[0]._height,K=d._children[1]._height;d._height=(K<V?V:K)+1}null!=v?((v._children[y]=b)._parent=v,b._childIndex=y):(o._root=b)._parent=null,d=b}else if(M<-1){var j=I._children[0],R=I._children[1],H=j._height;if(R._height<H){(I._children[1]=d)._parent=I,d._childIndex=1,(d._children[1]=R)._parent=d,R._childIndex=1;var P=I._children[0],F=I._children[1];I._aabbMinX=P._aabbMinX<F._aabbMinX?P._aabbMinX:F._aabbMinX,I._aabbMinY=P._aabbMinY<F._aabbMinY?P._aabbMinY:F._aabbMinY,I._aabbMinZ=P._aabbMinZ<F._aabbMinZ?P._aabbMinZ:F._aabbMinZ,I._aabbMaxX=P._aabbMaxX>F._aabbMaxX?P._aabbMaxX:F._aabbMaxX,I._aabbMaxY=P._aabbMaxY>F._aabbMaxY?P._aabbMaxY:F._aabbMaxY,I._aabbMaxZ=P._aabbMaxZ>F._aabbMaxZ?P._aabbMaxZ:F._aabbMaxZ;var O=I._children[0]._height,E=I._children[1]._height;I._height=(E<O?O:E)+1;var U=d._children[0],J=d._children[1];d._aabbMinX=U._aabbMinX<J._aabbMinX?U._aabbMinX:J._aabbMinX,d._aabbMinY=U._aabbMinY<J._aabbMinY?U._aabbMinY:J._aabbMinY,d._aabbMinZ=U._aabbMinZ<J._aabbMinZ?U._aabbMinZ:J._aabbMinZ,d._aabbMaxX=U._aabbMaxX>J._aabbMaxX?U._aabbMaxX:J._aabbMaxX,d._aabbMaxY=U._aabbMaxY>J._aabbMaxY?U._aabbMaxY:J._aabbMaxY,d._aabbMaxZ=U._aabbMaxZ>J._aabbMaxZ?U._aabbMaxZ:J._aabbMaxZ;var Q=d._children[0]._height,q=d._children[1]._height;d._height=(q<Q?Q:q)+1}else{(I._children[0]=d)._parent=I,d._childIndex=0,(d._children[1]=j)._parent=d,j._childIndex=1;var $=I._children[0],tt=I._children[1];I._aabbMinX=$._aabbMinX<tt._aabbMinX?$._aabbMinX:tt._aabbMinX,I._aabbMinY=$._aabbMinY<tt._aabbMinY?$._aabbMinY:tt._aabbMinY,I._aabbMinZ=$._aabbMinZ<tt._aabbMinZ?$._aabbMinZ:tt._aabbMinZ,I._aabbMaxX=$._aabbMaxX>tt._aabbMaxX?$._aabbMaxX:tt._aabbMaxX,I._aabbMaxY=$._aabbMaxY>tt._aabbMaxY?$._aabbMaxY:tt._aabbMaxY,I._aabbMaxZ=$._aabbMaxZ>tt._aabbMaxZ?$._aabbMaxZ:tt._aabbMaxZ;var et=I._children[0]._height,at=I._children[1]._height;I._height=(at<et?et:at)+1;var it=d._children[0],nt=d._children[1];d._aabbMinX=it._aabbMinX<nt._aabbMinX?it._aabbMinX:nt._aabbMinX,d._aabbMinY=it._aabbMinY<nt._aabbMinY?it._aabbMinY:nt._aabbMinY,d._aabbMinZ=it._aabbMinZ<nt._aabbMinZ?it._aabbMinZ:nt._aabbMinZ,d._aabbMaxX=it._aabbMaxX>nt._aabbMaxX?it._aabbMaxX:nt._aabbMaxX,d._aabbMaxY=it._aabbMaxY>nt._aabbMaxY?it._aabbMaxY:nt._aabbMaxY,d._aabbMaxZ=it._aabbMaxZ>nt._aabbMaxZ?it._aabbMaxZ:nt._aabbMaxZ;var st=d._children[0]._height,rt=d._children[1]._height;d._height=(rt<st?st:rt)+1}null!=v?((v._children[y]=I)._parent=v,I._childIndex=y):(o._root=I)._parent=null,d=I}else d=d}var ot=d._children[0]._height,lt=d._children[1]._height;d._height=(lt<ot?ot:lt)+1;var _t=d._children[0],ht=d._children[1];d._aabbMinX=_t._aabbMinX<ht._aabbMinX?_t._aabbMinX:ht._aabbMinX,d._aabbMinY=_t._aabbMinY<ht._aabbMinY?_t._aabbMinY:ht._aabbMinY,d._aabbMinZ=_t._aabbMinZ<ht._aabbMinZ?_t._aabbMinZ:ht._aabbMinZ,d._aabbMaxX=_t._aabbMaxX>ht._aabbMaxX?_t._aabbMaxX:ht._aabbMaxX,d._aabbMaxY=_t._aabbMaxY>ht._aabbMaxY?_t._aabbMaxY:ht._aabbMaxY,d._aabbMaxZ=_t._aabbMaxZ>ht._aabbMaxZ?_t._aabbMaxZ:ht._aabbMaxZ,d=d._parent}}if(!a._moved){if(a._moved=!0,this.movedProxies.length==this.numMovedProxies){for(var ft=this.numMovedProxies<<1,ut=new Array(ft),ct=0,dt=this.numMovedProxies;ct<dt;){var gt=ct++;ut[gt]=this.movedProxies[gt],this.movedProxies[gt]=null}this.movedProxies=ut}this.movedProxies[this.numMovedProxies++]=a}return a},destroyProxy:function(t){this._numProxies--;var e=t._prev,a=t._next;null!=e&&(e._next=a),null!=a&&(a._prev=e),t==this._proxyList&&(this._proxyList=this._proxyList._next),t==this._proxyListLast&&(this._proxyListLast=this._proxyListLast._prev),t._next=null,t._prev=null;var i=t,n=this._tree,s=i._leaf;n._numLeaves--;var r=s._prevLeaf,o=s._nextLeaf;if(null!=r&&(r._nextLeaf=o),null!=o&&(o._prevLeaf=r),s==n.leafList&&(n.leafList=n.leafList._nextLeaf),s==n.leafListLast&&(n.leafListLast=n.leafListLast._prevLeaf),s._nextLeaf=null,s._prevLeaf=null,n._root==s)n._root=null;else{var l=s._parent,_=l._children[1^s._childIndex],h=l._parent;if(null==h)_._parent=null,_._childIndex=0,n._root=_,l._next=null,l._childIndex=0,l._children[0]=null,l._children[1]=null,l._childIndex=0,l._parent=null,l._height=0,l._proxy=null,l._next=n._nodePool,n._nodePool=l;else{_._parent=h;var f=l._childIndex;(h._children[f]=_)._parent=h,_._childIndex=f,l._next=null,l._childIndex=0,l._children[0]=null,l._children[1]=null,l._childIndex=0,l._parent=null,l._height=0,l._proxy=null,l._next=n._nodePool,n._nodePool=l;for(var u=h;null!=u;){if(n._strategy._balancingEnabled)if(u._height<2)u=u;else{var c=u._parent,d=u._children[0],g=u._children[1],p=d._height-g._height,m=u._childIndex;if(1<p){var v=d._children[0],b=d._children[1],I=v._height;if(b._height<I){(d._children[1]=u)._parent=d,u._childIndex=1,(u._children[0]=b)._parent=u,b._childIndex=0;var M=d._children[0],y=d._children[1];d._aabbMinX=M._aabbMinX<y._aabbMinX?M._aabbMinX:y._aabbMinX,d._aabbMinY=M._aabbMinY<y._aabbMinY?M._aabbMinY:y._aabbMinY,d._aabbMinZ=M._aabbMinZ<y._aabbMinZ?M._aabbMinZ:y._aabbMinZ,d._aabbMaxX=M._aabbMaxX>y._aabbMaxX?M._aabbMaxX:y._aabbMaxX,d._aabbMaxY=M._aabbMaxY>y._aabbMaxY?M._aabbMaxY:y._aabbMaxY,d._aabbMaxZ=M._aabbMaxZ>y._aabbMaxZ?M._aabbMaxZ:y._aabbMaxZ;var w=d._children[0]._height,x=d._children[1]._height;d._height=(x<w?w:x)+1;var C=u._children[0],A=u._children[1];u._aabbMinX=C._aabbMinX<A._aabbMinX?C._aabbMinX:A._aabbMinX,u._aabbMinY=C._aabbMinY<A._aabbMinY?C._aabbMinY:A._aabbMinY,u._aabbMinZ=C._aabbMinZ<A._aabbMinZ?C._aabbMinZ:A._aabbMinZ,u._aabbMaxX=C._aabbMaxX>A._aabbMaxX?C._aabbMaxX:A._aabbMaxX,u._aabbMaxY=C._aabbMaxY>A._aabbMaxY?C._aabbMaxY:A._aabbMaxY,u._aabbMaxZ=C._aabbMaxZ>A._aabbMaxZ?C._aabbMaxZ:A._aabbMaxZ;var Z=u._children[0]._height,z=u._children[1]._height;u._height=(z<Z?Z:z)+1}else{(d._children[0]=u)._parent=d,u._childIndex=0,(u._children[0]=v)._parent=u,v._childIndex=0;var B=d._children[0],k=d._children[1];d._aabbMinX=B._aabbMinX<k._aabbMinX?B._aabbMinX:k._aabbMinX,d._aabbMinY=B._aabbMinY<k._aabbMinY?B._aabbMinY:k._aabbMinY,d._aabbMinZ=B._aabbMinZ<k._aabbMinZ?B._aabbMinZ:k._aabbMinZ,d._aabbMaxX=B._aabbMaxX>k._aabbMaxX?B._aabbMaxX:k._aabbMaxX,d._aabbMaxY=B._aabbMaxY>k._aabbMaxY?B._aabbMaxY:k._aabbMaxY,d._aabbMaxZ=B._aabbMaxZ>k._aabbMaxZ?B._aabbMaxZ:k._aabbMaxZ;var S=d._children[0]._height,X=d._children[1]._height;d._height=(X<S?S:X)+1;var Y=u._children[0],N=u._children[1];u._aabbMinX=Y._aabbMinX<N._aabbMinX?Y._aabbMinX:N._aabbMinX,u._aabbMinY=Y._aabbMinY<N._aabbMinY?Y._aabbMinY:N._aabbMinY,u._aabbMinZ=Y._aabbMinZ<N._aabbMinZ?Y._aabbMinZ:N._aabbMinZ,u._aabbMaxX=Y._aabbMaxX>N._aabbMaxX?Y._aabbMaxX:N._aabbMaxX,u._aabbMaxY=Y._aabbMaxY>N._aabbMaxY?Y._aabbMaxY:N._aabbMaxY,u._aabbMaxZ=Y._aabbMaxZ>N._aabbMaxZ?Y._aabbMaxZ:N._aabbMaxZ;var L=u._children[0]._height,G=u._children[1]._height;u._height=(G<L?L:G)+1}null!=c?((c._children[m]=d)._parent=c,d._childIndex=m):(n._root=d)._parent=null,u=d}else if(p<-1){var W=g._children[0],D=g._children[1],T=W._height;if(D._height<T){(g._children[1]=u)._parent=g,u._childIndex=1,(u._children[1]=D)._parent=u,D._childIndex=1;var V=g._children[0],K=g._children[1];g._aabbMinX=V._aabbMinX<K._aabbMinX?V._aabbMinX:K._aabbMinX,g._aabbMinY=V._aabbMinY<K._aabbMinY?V._aabbMinY:K._aabbMinY,g._aabbMinZ=V._aabbMinZ<K._aabbMinZ?V._aabbMinZ:K._aabbMinZ,g._aabbMaxX=V._aabbMaxX>K._aabbMaxX?V._aabbMaxX:K._aabbMaxX,g._aabbMaxY=V._aabbMaxY>K._aabbMaxY?V._aabbMaxY:K._aabbMaxY,g._aabbMaxZ=V._aabbMaxZ>K._aabbMaxZ?V._aabbMaxZ:K._aabbMaxZ;var j=g._children[0]._height,R=g._children[1]._height;g._height=(R<j?j:R)+1;var H=u._children[0],P=u._children[1];u._aabbMinX=H._aabbMinX<P._aabbMinX?H._aabbMinX:P._aabbMinX,u._aabbMinY=H._aabbMinY<P._aabbMinY?H._aabbMinY:P._aabbMinY,u._aabbMinZ=H._aabbMinZ<P._aabbMinZ?H._aabbMinZ:P._aabbMinZ,u._aabbMaxX=H._aabbMaxX>P._aabbMaxX?H._aabbMaxX:P._aabbMaxX,u._aabbMaxY=H._aabbMaxY>P._aabbMaxY?H._aabbMaxY:P._aabbMaxY,u._aabbMaxZ=H._aabbMaxZ>P._aabbMaxZ?H._aabbMaxZ:P._aabbMaxZ;var F=u._children[0]._height,O=u._children[1]._height;u._height=(O<F?F:O)+1}else{(g._children[0]=u)._parent=g,u._childIndex=0,(u._children[1]=W)._parent=u,W._childIndex=1;var E=g._children[0],U=g._children[1];g._aabbMinX=E._aabbMinX<U._aabbMinX?E._aabbMinX:U._aabbMinX,g._aabbMinY=E._aabbMinY<U._aabbMinY?E._aabbMinY:U._aabbMinY,g._aabbMinZ=E._aabbMinZ<U._aabbMinZ?E._aabbMinZ:U._aabbMinZ,g._aabbMaxX=E._aabbMaxX>U._aabbMaxX?E._aabbMaxX:U._aabbMaxX,g._aabbMaxY=E._aabbMaxY>U._aabbMaxY?E._aabbMaxY:U._aabbMaxY,g._aabbMaxZ=E._aabbMaxZ>U._aabbMaxZ?E._aabbMaxZ:U._aabbMaxZ;var J=g._children[0]._height,Q=g._children[1]._height;g._height=(Q<J?J:Q)+1;var q=u._children[0],$=u._children[1];u._aabbMinX=q._aabbMinX<$._aabbMinX?q._aabbMinX:$._aabbMinX,u._aabbMinY=q._aabbMinY<$._aabbMinY?q._aabbMinY:$._aabbMinY,u._aabbMinZ=q._aabbMinZ<$._aabbMinZ?q._aabbMinZ:$._aabbMinZ,u._aabbMaxX=q._aabbMaxX>$._aabbMaxX?q._aabbMaxX:$._aabbMaxX,u._aabbMaxY=q._aabbMaxY>$._aabbMaxY?q._aabbMaxY:$._aabbMaxY,u._aabbMaxZ=q._aabbMaxZ>$._aabbMaxZ?q._aabbMaxZ:$._aabbMaxZ;var tt=u._children[0]._height,et=u._children[1]._height;u._height=(et<tt?tt:et)+1}null!=c?((c._children[m]=g)._parent=c,g._childIndex=m):(n._root=g)._parent=null,u=g}else u=u}var at=u._children[0]._height,it=u._children[1]._height;u._height=(it<at?at:it)+1;var nt=u._children[0],st=u._children[1];u._aabbMinX=nt._aabbMinX<st._aabbMinX?nt._aabbMinX:st._aabbMinX,u._aabbMinY=nt._aabbMinY<st._aabbMinY?nt._aabbMinY:st._aabbMinY,u._aabbMinZ=nt._aabbMinZ<st._aabbMinZ?nt._aabbMinZ:st._aabbMinZ,u._aabbMaxX=nt._aabbMaxX>st._aabbMaxX?nt._aabbMaxX:st._aabbMaxX,u._aabbMaxY=nt._aabbMaxY>st._aabbMaxY?nt._aabbMaxY:st._aabbMaxY,u._aabbMaxZ=nt._aabbMaxZ>st._aabbMaxZ?nt._aabbMaxZ:st._aabbMaxZ,u=u._parent}}}i._leaf=null,s._next=null,s._childIndex=0,s._children[0]=null,s._children[1]=null,s._childIndex=0,s._parent=null,s._height=0,s._proxy=null,s._next=n._nodePool,n._nodePool=s,i.userData=null,i._next=null,i._prev=null,i._moved&&(i._moved=!1)},moveProxy:function(t,e,a){var i=t;if(!(i._aabbMinX<=e._minX&&i._aabbMaxX>=e._maxX&&i._aabbMinY<=e._minY&&i._aabbMaxY>=e._maxY&&i._aabbMinZ<=e._minZ&&i._aabbMaxZ>=e._maxZ)){i._aabbMinX=e._minX,i._aabbMinY=e._minY,i._aabbMinZ=e._minZ,i._aabbMaxX=e._maxX,i._aabbMaxY=e._maxY,i._aabbMaxZ=e._maxZ;var n,s,r,o=xn.bvhProxyPadding;if(r=s=n=o,i._aabbMinX-=n,i._aabbMinY-=s,i._aabbMinZ-=r,i._aabbMaxX+=n,i._aabbMaxY+=s,i._aabbMaxZ+=r,null!=a){var l,_,h,f,u,c,d,g,p,m=a;f=0<(l=m.x)?0:l,u=0<(_=m.y)?0:_,c=0<(h=m.z)?0:h,d=l<0?0:l,g=_<0?0:_,p=h<0?0:h,i._aabbMinX+=f,i._aabbMinY+=u,i._aabbMinZ+=c,i._aabbMaxX+=d,i._aabbMaxY+=g,i._aabbMaxZ+=p}if(!i._moved){if(i._moved=!0,this.movedProxies.length==this.numMovedProxies){for(var v=this.numMovedProxies<<1,b=new Array(v),I=0,M=this.numMovedProxies;I<M;){var y=I++;b[y]=this.movedProxies[y],this.movedProxies[y]=null}this.movedProxies=b}this.movedProxies[this.numMovedProxies++]=i}}},collectPairs:function(){var t=this._proxyPairList;if(null!=t){for(;t._p1=null,(t._p2=null)!=(t=t._next););this._proxyPairList._next=this._proxyPairPool,this._proxyPairPool=this._proxyPairList,this._proxyPairList=null}if(this._testCount=0,!(this._numProxies<2)){for(var e=this.numMovedProxies/this._numProxies<xn.bvhIncrementalCollisionThreshold,a=0,i=this.numMovedProxies;a<i;){var n=a++,s=this.movedProxies[n];if(s._moved){var r=this._tree,o=s._leaf;r._numLeaves--;var l=o._prevLeaf,_=o._nextLeaf;if(null!=l&&(l._nextLeaf=_),null!=_&&(_._prevLeaf=l),o==r.leafList&&(r.leafList=r.leafList._nextLeaf),o==r.leafListLast&&(r.leafListLast=r.leafListLast._prevLeaf),o._nextLeaf=null,o._prevLeaf=null,r._root==o)r._root=null;else{var h=o._parent,f=h._children[1^o._childIndex],u=h._parent;if(null==u)f._parent=null,f._childIndex=0,r._root=f,h._next=null,h._childIndex=0,h._children[0]=null,h._children[1]=null,h._childIndex=0,h._parent=null,h._height=0,h._proxy=null,h._next=r._nodePool,r._nodePool=h;else{f._parent=u;var c=h._childIndex;(u._children[c]=f)._parent=u,f._childIndex=c,h._next=null,h._childIndex=0,h._children[0]=null,h._children[1]=null,h._childIndex=0,h._parent=null,h._height=0,h._proxy=null,h._next=r._nodePool,r._nodePool=h;for(var d=u;null!=d;){if(r._strategy._balancingEnabled)if(d._height<2)d=d;else{var g=d._parent,p=d._children[0],m=d._children[1],v=p._height-m._height,b=d._childIndex;if(1<v){var I=p._children[0],M=p._children[1],y=I._height;if(M._height<y){(p._children[1]=d)._parent=p,d._childIndex=1,(d._children[0]=M)._parent=d,M._childIndex=0;var w=p._children[0],x=p._children[1];p._aabbMinX=w._aabbMinX<x._aabbMinX?w._aabbMinX:x._aabbMinX,p._aabbMinY=w._aabbMinY<x._aabbMinY?w._aabbMinY:x._aabbMinY,p._aabbMinZ=w._aabbMinZ<x._aabbMinZ?w._aabbMinZ:x._aabbMinZ,p._aabbMaxX=w._aabbMaxX>x._aabbMaxX?w._aabbMaxX:x._aabbMaxX,p._aabbMaxY=w._aabbMaxY>x._aabbMaxY?w._aabbMaxY:x._aabbMaxY,p._aabbMaxZ=w._aabbMaxZ>x._aabbMaxZ?w._aabbMaxZ:x._aabbMaxZ;var C=p._children[0]._height,A=p._children[1]._height;p._height=(A<C?C:A)+1;var Z=d._children[0],z=d._children[1];d._aabbMinX=Z._aabbMinX<z._aabbMinX?Z._aabbMinX:z._aabbMinX,d._aabbMinY=Z._aabbMinY<z._aabbMinY?Z._aabbMinY:z._aabbMinY,d._aabbMinZ=Z._aabbMinZ<z._aabbMinZ?Z._aabbMinZ:z._aabbMinZ,d._aabbMaxX=Z._aabbMaxX>z._aabbMaxX?Z._aabbMaxX:z._aabbMaxX,d._aabbMaxY=Z._aabbMaxY>z._aabbMaxY?Z._aabbMaxY:z._aabbMaxY,d._aabbMaxZ=Z._aabbMaxZ>z._aabbMaxZ?Z._aabbMaxZ:z._aabbMaxZ;var B=d._children[0]._height,k=d._children[1]._height;d._height=(k<B?B:k)+1}else{(p._children[0]=d)._parent=p,d._childIndex=0,(d._children[0]=I)._parent=d,I._childIndex=0;var S=p._children[0],X=p._children[1];p._aabbMinX=S._aabbMinX<X._aabbMinX?S._aabbMinX:X._aabbMinX,p._aabbMinY=S._aabbMinY<X._aabbMinY?S._aabbMinY:X._aabbMinY,p._aabbMinZ=S._aabbMinZ<X._aabbMinZ?S._aabbMinZ:X._aabbMinZ,p._aabbMaxX=S._aabbMaxX>X._aabbMaxX?S._aabbMaxX:X._aabbMaxX,p._aabbMaxY=S._aabbMaxY>X._aabbMaxY?S._aabbMaxY:X._aabbMaxY,p._aabbMaxZ=S._aabbMaxZ>X._aabbMaxZ?S._aabbMaxZ:X._aabbMaxZ;var Y=p._children[0]._height,N=p._children[1]._height;p._height=(N<Y?Y:N)+1;var L=d._children[0],G=d._children[1];d._aabbMinX=L._aabbMinX<G._aabbMinX?L._aabbMinX:G._aabbMinX,d._aabbMinY=L._aabbMinY<G._aabbMinY?L._aabbMinY:G._aabbMinY,d._aabbMinZ=L._aabbMinZ<G._aabbMinZ?L._aabbMinZ:G._aabbMinZ,d._aabbMaxX=L._aabbMaxX>G._aabbMaxX?L._aabbMaxX:G._aabbMaxX,d._aabbMaxY=L._aabbMaxY>G._aabbMaxY?L._aabbMaxY:G._aabbMaxY,d._aabbMaxZ=L._aabbMaxZ>G._aabbMaxZ?L._aabbMaxZ:G._aabbMaxZ;var W=d._children[0]._height,D=d._children[1]._height;d._height=(D<W?W:D)+1}null!=g?((g._children[b]=p)._parent=g,p._childIndex=b):(r._root=p)._parent=null,d=p}else if(v<-1){var T=m._children[0],V=m._children[1],K=T._height;if(V._height<K){(m._children[1]=d)._parent=m,d._childIndex=1,(d._children[1]=V)._parent=d,V._childIndex=1;var j=m._children[0],R=m._children[1];m._aabbMinX=j._aabbMinX<R._aabbMinX?j._aabbMinX:R._aabbMinX,m._aabbMinY=j._aabbMinY<R._aabbMinY?j._aabbMinY:R._aabbMinY,m._aabbMinZ=j._aabbMinZ<R._aabbMinZ?j._aabbMinZ:R._aabbMinZ,m._aabbMaxX=j._aabbMaxX>R._aabbMaxX?j._aabbMaxX:R._aabbMaxX,m._aabbMaxY=j._aabbMaxY>R._aabbMaxY?j._aabbMaxY:R._aabbMaxY,m._aabbMaxZ=j._aabbMaxZ>R._aabbMaxZ?j._aabbMaxZ:R._aabbMaxZ;var H=m._children[0]._height,P=m._children[1]._height;m._height=(P<H?H:P)+1;var F=d._children[0],O=d._children[1];d._aabbMinX=F._aabbMinX<O._aabbMinX?F._aabbMinX:O._aabbMinX,d._aabbMinY=F._aabbMinY<O._aabbMinY?F._aabbMinY:O._aabbMinY,d._aabbMinZ=F._aabbMinZ<O._aabbMinZ?F._aabbMinZ:O._aabbMinZ,d._aabbMaxX=F._aabbMaxX>O._aabbMaxX?F._aabbMaxX:O._aabbMaxX,d._aabbMaxY=F._aabbMaxY>O._aabbMaxY?F._aabbMaxY:O._aabbMaxY,d._aabbMaxZ=F._aabbMaxZ>O._aabbMaxZ?F._aabbMaxZ:O._aabbMaxZ;var E=d._children[0]._height,U=d._children[1]._height;d._height=(U<E?E:U)+1}else{(m._children[0]=d)._parent=m,d._childIndex=0,(d._children[1]=T)._parent=d,T._childIndex=1;var J=m._children[0],Q=m._children[1];m._aabbMinX=J._aabbMinX<Q._aabbMinX?J._aabbMinX:Q._aabbMinX,m._aabbMinY=J._aabbMinY<Q._aabbMinY?J._aabbMinY:Q._aabbMinY,m._aabbMinZ=J._aabbMinZ<Q._aabbMinZ?J._aabbMinZ:Q._aabbMinZ,m._aabbMaxX=J._aabbMaxX>Q._aabbMaxX?J._aabbMaxX:Q._aabbMaxX,m._aabbMaxY=J._aabbMaxY>Q._aabbMaxY?J._aabbMaxY:Q._aabbMaxY,m._aabbMaxZ=J._aabbMaxZ>Q._aabbMaxZ?J._aabbMaxZ:Q._aabbMaxZ;var q=m._children[0]._height,$=m._children[1]._height;m._height=($<q?q:$)+1;var tt=d._children[0],et=d._children[1];d._aabbMinX=tt._aabbMinX<et._aabbMinX?tt._aabbMinX:et._aabbMinX,d._aabbMinY=tt._aabbMinY<et._aabbMinY?tt._aabbMinY:et._aabbMinY,d._aabbMinZ=tt._aabbMinZ<et._aabbMinZ?tt._aabbMinZ:et._aabbMinZ,d._aabbMaxX=tt._aabbMaxX>et._aabbMaxX?tt._aabbMaxX:et._aabbMaxX,d._aabbMaxY=tt._aabbMaxY>et._aabbMaxY?tt._aabbMaxY:et._aabbMaxY,d._aabbMaxZ=tt._aabbMaxZ>et._aabbMaxZ?tt._aabbMaxZ:et._aabbMaxZ;var at=d._children[0]._height,it=d._children[1]._height;d._height=(it<at?at:it)+1}null!=g?((g._children[b]=m)._parent=g,m._childIndex=b):(r._root=m)._parent=null,d=m}else d=d}var nt=d._children[0]._height,st=d._children[1]._height;d._height=(st<nt?nt:st)+1;var rt=d._children[0],ot=d._children[1];d._aabbMinX=rt._aabbMinX<ot._aabbMinX?rt._aabbMinX:ot._aabbMinX,d._aabbMinY=rt._aabbMinY<ot._aabbMinY?rt._aabbMinY:ot._aabbMinY,d._aabbMinZ=rt._aabbMinZ<ot._aabbMinZ?rt._aabbMinZ:ot._aabbMinZ,d._aabbMaxX=rt._aabbMaxX>ot._aabbMaxX?rt._aabbMaxX:ot._aabbMaxX,d._aabbMaxY=rt._aabbMaxY>ot._aabbMaxY?rt._aabbMaxY:ot._aabbMaxY,d._aabbMaxZ=rt._aabbMaxZ>ot._aabbMaxZ?rt._aabbMaxZ:ot._aabbMaxZ,d=d._parent}}}s._leaf=null,o._next=null,o._childIndex=0,o._children[0]=null,o._children[1]=null,o._childIndex=0,o._parent=null,o._height=0,o._proxy=null,o._next=r._nodePool,r._nodePool=o;var lt=this._tree,_t=lt._nodePool;null!=_t?(lt._nodePool=_t._next,_t._next=null):_t=new Si;var ht=_t;if(((ht._proxy=s)._leaf=ht)._aabbMinX=s._aabbMinX,ht._aabbMinY=s._aabbMinY,ht._aabbMinZ=s._aabbMinZ,ht._aabbMaxX=s._aabbMaxX,ht._aabbMaxY=s._aabbMaxY,ht._aabbMaxZ=s._aabbMaxZ,lt._numLeaves++,null==lt.leafList?lt.leafList=ht:(lt.leafListLast._nextLeaf=ht)._prevLeaf=lt.leafListLast,lt.leafListLast=ht,null==lt._root)lt._root=ht;else{for(var ft=lt._root;0<ft._height;){var ut=lt._strategy._decideInsertion(ft,ht);if(-1==ut)break;ft=ft._children[ut]}var ct=ft._parent,dt=lt._nodePool;null!=dt?(lt._nodePool=dt._next,dt._next=null):dt=new Si;var gt=dt;if(null==ct)lt._root=gt;else{var pt=ft._childIndex;(ct._children[pt]=gt)._parent=ct,gt._childIndex=pt}var mt=ft._childIndex;(gt._children[mt]=ft)._parent=gt,ft._childIndex=mt;var vt=1^ft._childIndex;for((gt._children[vt]=ht)._parent=gt,ht._childIndex=vt;null!=gt;){if(lt._strategy._balancingEnabled)if(gt._height<2)gt=gt;else{var bt=gt._parent,It=gt._children[0],Mt=gt._children[1],yt=It._height-Mt._height,wt=gt._childIndex;if(1<yt){var xt=It._children[0],Ct=It._children[1],At=xt._height;if(Ct._height<At){(It._children[1]=gt)._parent=It,gt._childIndex=1,(gt._children[0]=Ct)._parent=gt,Ct._childIndex=0;var Zt=It._children[0],zt=It._children[1];It._aabbMinX=Zt._aabbMinX<zt._aabbMinX?Zt._aabbMinX:zt._aabbMinX,It._aabbMinY=Zt._aabbMinY<zt._aabbMinY?Zt._aabbMinY:zt._aabbMinY,It._aabbMinZ=Zt._aabbMinZ<zt._aabbMinZ?Zt._aabbMinZ:zt._aabbMinZ,It._aabbMaxX=Zt._aabbMaxX>zt._aabbMaxX?Zt._aabbMaxX:zt._aabbMaxX,It._aabbMaxY=Zt._aabbMaxY>zt._aabbMaxY?Zt._aabbMaxY:zt._aabbMaxY,It._aabbMaxZ=Zt._aabbMaxZ>zt._aabbMaxZ?Zt._aabbMaxZ:zt._aabbMaxZ;var Bt=It._children[0]._height,kt=It._children[1]._height;It._height=(kt<Bt?Bt:kt)+1;var St=gt._children[0],Xt=gt._children[1];gt._aabbMinX=St._aabbMinX<Xt._aabbMinX?St._aabbMinX:Xt._aabbMinX,gt._aabbMinY=St._aabbMinY<Xt._aabbMinY?St._aabbMinY:Xt._aabbMinY,gt._aabbMinZ=St._aabbMinZ<Xt._aabbMinZ?St._aabbMinZ:Xt._aabbMinZ,gt._aabbMaxX=St._aabbMaxX>Xt._aabbMaxX?St._aabbMaxX:Xt._aabbMaxX,gt._aabbMaxY=St._aabbMaxY>Xt._aabbMaxY?St._aabbMaxY:Xt._aabbMaxY,gt._aabbMaxZ=St._aabbMaxZ>Xt._aabbMaxZ?St._aabbMaxZ:Xt._aabbMaxZ;var Yt=gt._children[0]._height,Nt=gt._children[1]._height;gt._height=(Nt<Yt?Yt:Nt)+1}else{(It._children[0]=gt)._parent=It,gt._childIndex=0,(gt._children[0]=xt)._parent=gt,xt._childIndex=0;var Lt=It._children[0],Gt=It._children[1];It._aabbMinX=Lt._aabbMinX<Gt._aabbMinX?Lt._aabbMinX:Gt._aabbMinX,It._aabbMinY=Lt._aabbMinY<Gt._aabbMinY?Lt._aabbMinY:Gt._aabbMinY,It._aabbMinZ=Lt._aabbMinZ<Gt._aabbMinZ?Lt._aabbMinZ:Gt._aabbMinZ,It._aabbMaxX=Lt._aabbMaxX>Gt._aabbMaxX?Lt._aabbMaxX:Gt._aabbMaxX,It._aabbMaxY=Lt._aabbMaxY>Gt._aabbMaxY?Lt._aabbMaxY:Gt._aabbMaxY,It._aabbMaxZ=Lt._aabbMaxZ>Gt._aabbMaxZ?Lt._aabbMaxZ:Gt._aabbMaxZ;var Wt=It._children[0]._height,Dt=It._children[1]._height;It._height=(Dt<Wt?Wt:Dt)+1;var Tt=gt._children[0],Vt=gt._children[1];gt._aabbMinX=Tt._aabbMinX<Vt._aabbMinX?Tt._aabbMinX:Vt._aabbMinX,gt._aabbMinY=Tt._aabbMinY<Vt._aabbMinY?Tt._aabbMinY:Vt._aabbMinY,gt._aabbMinZ=Tt._aabbMinZ<Vt._aabbMinZ?Tt._aabbMinZ:Vt._aabbMinZ,gt._aabbMaxX=Tt._aabbMaxX>Vt._aabbMaxX?Tt._aabbMaxX:Vt._aabbMaxX,gt._aabbMaxY=Tt._aabbMaxY>Vt._aabbMaxY?Tt._aabbMaxY:Vt._aabbMaxY,gt._aabbMaxZ=Tt._aabbMaxZ>Vt._aabbMaxZ?Tt._aabbMaxZ:Vt._aabbMaxZ;var Kt=gt._children[0]._height,jt=gt._children[1]._height;gt._height=(jt<Kt?Kt:jt)+1}null!=bt?((bt._children[wt]=It)._parent=bt,It._childIndex=wt):(lt._root=It)._parent=null,gt=It}else if(yt<-1){var Rt=Mt._children[0],Ht=Mt._children[1],Pt=Rt._height;if(Ht._height<Pt){(Mt._children[1]=gt)._parent=Mt,gt._childIndex=1,(gt._children[1]=Ht)._parent=gt,Ht._childIndex=1;var Ft=Mt._children[0],Ot=Mt._children[1];Mt._aabbMinX=Ft._aabbMinX<Ot._aabbMinX?Ft._aabbMinX:Ot._aabbMinX,Mt._aabbMinY=Ft._aabbMinY<Ot._aabbMinY?Ft._aabbMinY:Ot._aabbMinY,Mt._aabbMinZ=Ft._aabbMinZ<Ot._aabbMinZ?Ft._aabbMinZ:Ot._aabbMinZ,Mt._aabbMaxX=Ft._aabbMaxX>Ot._aabbMaxX?Ft._aabbMaxX:Ot._aabbMaxX,Mt._aabbMaxY=Ft._aabbMaxY>Ot._aabbMaxY?Ft._aabbMaxY:Ot._aabbMaxY,Mt._aabbMaxZ=Ft._aabbMaxZ>Ot._aabbMaxZ?Ft._aabbMaxZ:Ot._aabbMaxZ;var Et=Mt._children[0]._height,Ut=Mt._children[1]._height;Mt._height=(Ut<Et?Et:Ut)+1;var Jt=gt._children[0],Qt=gt._children[1];gt._aabbMinX=Jt._aabbMinX<Qt._aabbMinX?Jt._aabbMinX:Qt._aabbMinX,gt._aabbMinY=Jt._aabbMinY<Qt._aabbMinY?Jt._aabbMinY:Qt._aabbMinY,gt._aabbMinZ=Jt._aabbMinZ<Qt._aabbMinZ?Jt._aabbMinZ:Qt._aabbMinZ,gt._aabbMaxX=Jt._aabbMaxX>Qt._aabbMaxX?Jt._aabbMaxX:Qt._aabbMaxX,gt._aabbMaxY=Jt._aabbMaxY>Qt._aabbMaxY?Jt._aabbMaxY:Qt._aabbMaxY,gt._aabbMaxZ=Jt._aabbMaxZ>Qt._aabbMaxZ?Jt._aabbMaxZ:Qt._aabbMaxZ;var qt=gt._children[0]._height,$t=gt._children[1]._height;gt._height=($t<qt?qt:$t)+1}else{(Mt._children[0]=gt)._parent=Mt,gt._childIndex=0,(gt._children[1]=Rt)._parent=gt,Rt._childIndex=1;var te=Mt._children[0],ee=Mt._children[1];Mt._aabbMinX=te._aabbMinX<ee._aabbMinX?te._aabbMinX:ee._aabbMinX,Mt._aabbMinY=te._aabbMinY<ee._aabbMinY?te._aabbMinY:ee._aabbMinY,Mt._aabbMinZ=te._aabbMinZ<ee._aabbMinZ?te._aabbMinZ:ee._aabbMinZ,Mt._aabbMaxX=te._aabbMaxX>ee._aabbMaxX?te._aabbMaxX:ee._aabbMaxX,Mt._aabbMaxY=te._aabbMaxY>ee._aabbMaxY?te._aabbMaxY:ee._aabbMaxY,Mt._aabbMaxZ=te._aabbMaxZ>ee._aabbMaxZ?te._aabbMaxZ:ee._aabbMaxZ;var ae=Mt._children[0]._height,ie=Mt._children[1]._height;Mt._height=(ie<ae?ae:ie)+1;var ne=gt._children[0],se=gt._children[1];gt._aabbMinX=ne._aabbMinX<se._aabbMinX?ne._aabbMinX:se._aabbMinX,gt._aabbMinY=ne._aabbMinY<se._aabbMinY?ne._aabbMinY:se._aabbMinY,gt._aabbMinZ=ne._aabbMinZ<se._aabbMinZ?ne._aabbMinZ:se._aabbMinZ,gt._aabbMaxX=ne._aabbMaxX>se._aabbMaxX?ne._aabbMaxX:se._aabbMaxX,gt._aabbMaxY=ne._aabbMaxY>se._aabbMaxY?ne._aabbMaxY:se._aabbMaxY,gt._aabbMaxZ=ne._aabbMaxZ>se._aabbMaxZ?ne._aabbMaxZ:se._aabbMaxZ;var re=gt._children[0]._height,oe=gt._children[1]._height;gt._height=(oe<re?re:oe)+1}null!=bt?((bt._children[wt]=Mt)._parent=bt,Mt._childIndex=wt):(lt._root=Mt)._parent=null,gt=Mt}else gt=gt}var le=gt._children[0]._height,_e=gt._children[1]._height;gt._height=(_e<le?le:_e)+1;var he=gt._children[0],fe=gt._children[1];gt._aabbMinX=he._aabbMinX<fe._aabbMinX?he._aabbMinX:fe._aabbMinX,gt._aabbMinY=he._aabbMinY<fe._aabbMinY?he._aabbMinY:fe._aabbMinY,gt._aabbMinZ=he._aabbMinZ<fe._aabbMinZ?he._aabbMinZ:fe._aabbMinZ,gt._aabbMaxX=he._aabbMaxX>fe._aabbMaxX?he._aabbMaxX:fe._aabbMaxX,gt._aabbMaxY=he._aabbMaxY>fe._aabbMaxY?he._aabbMaxY:fe._aabbMaxY,gt._aabbMaxZ=he._aabbMaxZ>fe._aabbMaxZ?he._aabbMaxZ:fe._aabbMaxZ,gt=gt._parent}}e&&this.collide(this._tree._root,s._leaf),s._moved=!1}this.movedProxies[n]=null}e||this.collide(this._tree._root,this._tree._root),this.numMovedProxies=0}},__class__:ki});var Si=function(){this._next=null,this._prevLeaf=null,this._nextLeaf=null;var t=new Array(2);this._children=t,this._childIndex=0,this._parent=null,this._height=0,this._proxy=null,this._aabbMinX=0,this._aabbMinY=0,this._aabbMinZ=0,this._aabbMaxX=0,this._aabbMaxY=0,this._aabbMaxZ=0};(i["oimo.collision.broadphase.bvh.BvhNode"]=Si).__name__=!0,Si.prototype={_next:null,_prevLeaf:null,_nextLeaf:null,_children:null,_childIndex:null,_parent:null,_height:null,_proxy:null,_aabbMinX:null,_aabbMinY:null,_aabbMinZ:null,_aabbMaxX:null,_aabbMaxY:null,_aabbMaxZ:null,_tmpX:null,_tmpY:null,_tmpZ:null,__class__:Si};var Xi=function(t,e){Zi.call(this,t,e),this._leaf=null,this._moved=!1};(i["oimo.collision.broadphase.bvh.BvhProxy"]=Xi).__name__=!0,Xi.__super__=Zi,Xi.prototype=s(Zi.prototype,{_leaf:null,_moved:null,__class__:Xi});var Yi=function(){this._insertionStrategy=0,this._balancingEnabled=!1};(i["oimo.collision.broadphase.bvh.BvhStrategy"]=Yi).__name__=!0,Yi.prototype={_insertionStrategy:null,_balancingEnabled:null,_decideInsertion:function(t,e){switch(this._insertionStrategy){case 0:var a,i,n;a=e._aabbMinX+e._aabbMaxX,i=e._aabbMinY+e._aabbMaxY,n=e._aabbMinZ+e._aabbMaxZ;var s,r,o,l,_,h,f=t._children[0],u=t._children[1];return s=f._aabbMinX+f._aabbMaxX,r=f._aabbMinY+f._aabbMaxY,o=f._aabbMinZ+f._aabbMaxZ,l=u._aabbMinX+u._aabbMaxX,_=u._aabbMinY+u._aabbMaxY,h=u._aabbMinZ+u._aabbMaxZ,(s-=a)*s+(r-=i)*r+(o-=n)*o<(l-=a)*l+(_-=i)*_+(h-=n)*h?0:1;case 1:var c,d,g,p,m,v,b=t._children[0],I=t._children[1],M=t._aabbMaxX-t._aabbMinX,y=t._aabbMaxY-t._aabbMinY,w=t._aabbMaxZ-t._aabbMinZ,x=2*(M*(y+w)+y*w);c=t._aabbMinX<e._aabbMinX?t._aabbMinX:e._aabbMinX,d=t._aabbMinY<e._aabbMinY?t._aabbMinY:e._aabbMinY,g=t._aabbMinZ<e._aabbMinZ?t._aabbMinZ:e._aabbMinZ,p=t._aabbMaxX>e._aabbMaxX?t._aabbMaxX:e._aabbMaxX;var C=(m=t._aabbMaxY>e._aabbMaxY?t._aabbMaxY:e._aabbMaxY)-d,A=(v=t._aabbMaxZ>e._aabbMaxZ?t._aabbMaxZ:e._aabbMaxZ)-g,Z=2*((p-c)*(C+A)+C*A),z=2*Z,B=2*(Z-x),k=B;if(c=b._aabbMinX<e._aabbMinX?b._aabbMinX:e._aabbMinX,d=b._aabbMinY<e._aabbMinY?b._aabbMinY:e._aabbMinY,g=b._aabbMinZ<e._aabbMinZ?b._aabbMinZ:e._aabbMinZ,p=b._aabbMaxX>e._aabbMaxX?b._aabbMaxX:e._aabbMaxX,m=b._aabbMaxY>e._aabbMaxY?b._aabbMaxY:e._aabbMaxY,v=b._aabbMaxZ>e._aabbMaxZ?b._aabbMaxZ:e._aabbMaxZ,0==b._height){var S=m-d,X=v-g;k+=2*((p-c)*(S+X)+S*X)}else{var Y=p-c,N=m-d,L=v-g,G=b._aabbMaxX-b._aabbMinX,W=b._aabbMaxY-b._aabbMinY,D=b._aabbMaxZ-b._aabbMinZ;k+=2*(Y*(N+L)+N*L)-2*(G*(W+D)+W*D)}var T=B;if(c=I._aabbMinX<e._aabbMinX?I._aabbMinX:e._aabbMinX,d=I._aabbMinY<e._aabbMinY?I._aabbMinY:e._aabbMinY,g=I._aabbMinZ<e._aabbMinZ?I._aabbMinZ:e._aabbMinZ,p=I._aabbMaxX>e._aabbMaxX?I._aabbMaxX:e._aabbMaxX,m=I._aabbMaxY>e._aabbMaxY?I._aabbMaxY:e._aabbMaxY,v=I._aabbMaxZ>e._aabbMaxZ?I._aabbMaxZ:e._aabbMaxZ,0==I._height){var V=m-d,K=v-g;T+=2*((p-c)*(V+K)+V*K)}else{var j=p-c,R=m-d,H=v-g,P=I._aabbMaxX-I._aabbMinX,F=I._aabbMaxY-I._aabbMinY,O=I._aabbMaxZ-I._aabbMinZ;T+=2*(j*(R+H)+R*H)-2*(P*(F+O)+F*O)}return z<k?z<T?-1:1:k<T?0:1;default:return Fe.trace("invalid BVH insertion strategy: "+this._insertionStrategy,{fileName:"Sources/oimo/collision/broadphase/bvh/BvhStrategy.hx",lineNumber:37,className:"oimo.collision.broadphase.bvh.BvhStrategy",methodName:"_decideInsertion"}),-1}},_splitLeaves:function(t,e,a){var i,n,s,r=1/(a-e);s=n=i=0;for(var o,l,_,h=e,f=a;h<f;){var u=t[h++];u._tmpX=u._aabbMaxX+u._aabbMinX,u._tmpY=u._aabbMaxY+u._aabbMinY,u._tmpZ=u._aabbMaxZ+u._aabbMinZ,i+=u._tmpX,n+=u._tmpY,s+=u._tmpZ}i*=r,n*=r,s*=r,_=l=o=0;for(var c=e,d=a;c<d;){var g,p,m,v=t[c++];g=v._tmpX-i,p=v._tmpY-n,m=v._tmpZ-s,o+=g*=g,l+=p*=p,_+=m*=m}var b=l,I=_,M=e,y=a-1;if(b<o)if(I<o)for(var w=i;;){for(;;){if(t[M]._tmpX<=w)break;++M}for(;;){if(t[y]._tmpX>=w)break;--y}if(y<=M)break;var x=t[M];t[M]=t[y],t[y]=x,++M,--y}else for(var C=s;;){for(;;){if(t[M]._tmpZ<=C)break;++M}for(;;){if(t[y]._tmpZ>=C)break;--y}if(y<=M)break;var A=t[M];t[M]=t[y],t[y]=A,++M,--y}else if(I<b)for(var Z=n;;){for(;;){if(t[M]._tmpY<=Z)break;++M}for(;;){if(t[y]._tmpY>=Z)break;--y}if(y<=M)break;var z=t[M];t[M]=t[y],t[y]=z,++M,--y}else for(var B=s;;){for(;;){if(t[M]._tmpZ<=B)break;++M}for(;;){if(t[y]._tmpZ>=B)break;--y}if(y<=M)break;var k=t[M];t[M]=t[y],t[y]=k,++M,--y}return M},__class__:Yi};var Ni=function(){this._root=null,this._numLeaves=0,this._strategy=new Yi,this._nodePool=null,this.leafList=null,this.leafListLast=null;var t=new Array(1024);this.tmp=t};(i["oimo.collision.broadphase.bvh.BvhTree"]=Ni).__name__=!0,Ni.prototype={_root:null,_numLeaves:null,_strategy:null,_nodePool:null,leafList:null,leafListLast:null,tmp:null,decomposeRecursive:function(t){if(0==t._height)return t._childIndex=0,void(t._parent=null);this.decomposeRecursive(t._children[0]),this.decomposeRecursive(t._children[1]),t._next=null,t._childIndex=0,t._children[0]=null,t._children[1]=null,t._childIndex=0,t._parent=null,t._height=0,t._proxy=null,t._next=this._nodePool,this._nodePool=t},buildTopDownRecursive:function(t,e,a){if(1==a-e){var i=t[e],n=i._proxy;return i._aabbMinX=n._aabbMinX,i._aabbMinY=n._aabbMinY,i._aabbMinZ=n._aabbMinZ,i._aabbMaxX=n._aabbMaxX,i._aabbMaxY=n._aabbMaxY,i._aabbMaxZ=n._aabbMaxZ,i}var s=this._strategy._splitLeaves(t,e,a),r=this.buildTopDownRecursive(t,e,s),o=this.buildTopDownRecursive(t,s,a),l=this._nodePool;null!=l?(this._nodePool=l._next,l._next=null):l=new Si;var _=l;(_._children[0]=r)._parent=_,r._childIndex=0,(_._children[1]=o)._parent=_,o._childIndex=1;var h=_._children[0],f=_._children[1];_._aabbMinX=h._aabbMinX<f._aabbMinX?h._aabbMinX:f._aabbMinX,_._aabbMinY=h._aabbMinY<f._aabbMinY?h._aabbMinY:f._aabbMinY,_._aabbMinZ=h._aabbMinZ<f._aabbMinZ?h._aabbMinZ:f._aabbMinZ,_._aabbMaxX=h._aabbMaxX>f._aabbMaxX?h._aabbMaxX:f._aabbMaxX,_._aabbMaxY=h._aabbMaxY>f._aabbMaxY?h._aabbMaxY:f._aabbMaxY,_._aabbMaxZ=h._aabbMaxZ>f._aabbMaxZ?h._aabbMaxZ:f._aabbMaxZ;var u=_._children[0]._height,c=_._children[1]._height;return _._height=(c<u?u:c)+1,_},__class__:Ni};var Li=function(){this._minX=0,this._minY=0,this._minZ=0,this._maxX=0,this._maxY=0,this._maxZ=0};(i["oimo.collision.geometry.Aabb"]=Li).__name__=!0,Li.prototype={_minX:null,_minY:null,_minZ:null,_maxX:null,_maxY:null,_maxZ:null,__class__:Li};var Gi=function(t){wi.call(this,1);var e=t;this._halfExtentsX=e.x,this._halfExtentsY=e.y,this._halfExtentsZ=e.z,this._halfAxisXX=t.x,this._halfAxisXY=0,this._halfAxisXZ=0,this._halfAxisYX=0,this._halfAxisYY=t.y,this._halfAxisYZ=0,this._halfAxisZX=0,this._halfAxisZY=0,this._halfAxisZZ=t.z,this._updateMass();var a=t.x<t.y?t.z<t.x?t.z:t.x:t.z<t.y?t.z:t.y;this._gjkMargin>.2*a&&(this._gjkMargin=.2*a)};(i["oimo.collision.geometry.BoxGeometry"]=Gi).__name__=!0,Gi.__super__=wi,Gi.prototype=s(wi.prototype,{_halfExtentsX:null,_halfExtentsY:null,_halfExtentsZ:null,_halfAxisXX:null,_halfAxisXY:null,_halfAxisXZ:null,_halfAxisYX:null,_halfAxisYY:null,_halfAxisYZ:null,_halfAxisZX:null,_halfAxisZY:null,_halfAxisZZ:null,_updateMass:function(){var t,e,a;this._volume=this._halfExtentsX*this._halfExtentsY*this._halfExtentsZ*8,t=this._halfExtentsX*this._halfExtentsX,e=this._halfExtentsY*this._halfExtentsY,a=this._halfExtentsZ*this._halfExtentsZ,this._inertiaCoeff00=.3333333333333333*(e+a),this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=.3333333333333333*(a+t),this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=.3333333333333333*(t+e)},_computeAabb:function(t,e){var a,i,n,s,r,o,l,_,h,f,u,c,d;f=e._rotation00*this._halfAxisXX+e._rotation01*this._halfAxisXY+e._rotation02*this._halfAxisXZ,i=e._rotation10*this._halfAxisXX+e._rotation11*this._halfAxisXY+e._rotation12*this._halfAxisXZ,n=e._rotation20*this._halfAxisXX+e._rotation21*this._halfAxisXY+e._rotation22*this._halfAxisXZ,u=(a=(a=f)<0?-a:a)+(s=(s=e._rotation00*this._halfAxisYX+e._rotation01*this._halfAxisYY+e._rotation02*this._halfAxisYZ)<0?-s:s),c=(i=i<0?-i:i)+(r=(r=e._rotation10*this._halfAxisYX+e._rotation11*this._halfAxisYY+e._rotation12*this._halfAxisYZ)<0?-r:r),d=(n=n<0?-n:n)+(o=(o=e._rotation20*this._halfAxisYX+e._rotation21*this._halfAxisYY+e._rotation22*this._halfAxisYZ)<0?-o:o),u+=l=(l=e._rotation00*this._halfAxisZX+e._rotation01*this._halfAxisZY+e._rotation02*this._halfAxisZZ)<0?-l:l,c+=_=(_=e._rotation10*this._halfAxisZX+e._rotation11*this._halfAxisZY+e._rotation12*this._halfAxisZZ)<0?-_:_,d+=h=(h=e._rotation20*this._halfAxisZX+e._rotation21*this._halfAxisZY+e._rotation22*this._halfAxisZZ)<0?-h:h,t._minX=e._positionX-u,t._minY=e._positionY-c,t._minZ=e._positionZ-d,t._maxX=e._positionX+u,t._maxY=e._positionY+c,t._maxZ=e._positionZ+d},computeLocalSupportingVertex:function(t,e){var a,i,n,s,r,o;a=this._gjkMargin,i=this._gjkMargin,n=this._gjkMargin,a=a<this._halfExtentsX?a:this._halfExtentsX,i=i<this._halfExtentsY?i:this._halfExtentsY,n=n<this._halfExtentsZ?n:this._halfExtentsZ,s=this._halfExtentsX-a,r=this._halfExtentsY-i,o=this._halfExtentsZ-n,e.x=0<t.x?s:-s,e.y=0<t.y?r:-r,e.z=0<t.z?o:-o},__class__:Gi});var Wi=function(t,e){wi.call(this,4),this._radius=t,this._halfHeight=e,this._gjkMargin=this._radius,this._updateMass()};(i["oimo.collision.geometry.CapsuleGeometry"]=Wi).__name__=!0,Wi.__super__=wi,Wi.prototype=s(wi.prototype,{_radius:null,_halfHeight:null,_updateMass:function(){var t=this._radius*this._radius,e=this._halfHeight*this._halfHeight,a=6.28318530717958*t*this._halfHeight,i=3.14159265358979*t*this._radius*4/3;this._volume=a+i;var n=0==this._volume?0:1/this._volume,s=n*(a*t*.5+i*t*.4),r=n*(a*(.25*t+e/3)+i*(.4*t+this._halfHeight*this._radius*.75+e));this._inertiaCoeff00=r,this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=s,this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=r},_computeAabb:function(t,e){var a,i,n,s,r,o;a=this._radius,i=this._radius,n=this._radius,s=(s=e._rotation01)<0?-s:s,r=(r=e._rotation11)<0?-r:r,o=(o=e._rotation21)<0?-o:o,a+=s*=this._halfHeight,i+=r*=this._halfHeight,n+=o*=this._halfHeight,t._minX=e._positionX-a,t._minY=e._positionY-i,t._minZ=e._positionZ-n,t._maxX=e._positionX+a,t._maxY=e._positionY+i,t._maxZ=e._positionZ+n},computeLocalSupportingVertex:function(t,e){0<t.y?e.init(0,this._halfHeight,0):e.init(0,-this._halfHeight,0)},__class__:Wi});var Di=function(t,e){wi.call(this,3),this._radius=t,this._halfHeight=e,this.sinTheta=t/Math.sqrt(t*t+4*e*e),this.cosTheta=2*e/Math.sqrt(t*t+4*e*e),this._updateMass()};(i["oimo.collision.geometry.ConeGeometry"]=Di).__name__=!0,Di.__super__=wi,Di.prototype=s(wi.prototype,{_radius:null,_halfHeight:null,sinTheta:null,cosTheta:null,_updateMass:function(){var t=this._radius*this._radius,e=this._halfHeight*this._halfHeight*4;this._volume=3.14159265358979*t*this._halfHeight*2/3,this._inertiaCoeff00=.05*(3*t+2*e),this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=.3*t,this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=.08333333333333333*(3*t+2*e)},_computeAabb:function(t,e){var a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b,I,M,y,w=(a=e._rotation01)*a,x=(i=e._rotation11)*i,C=(n=e._rotation21)*n;l=Math.sqrt(1-w),_=Math.sqrt(1-x),h=Math.sqrt(1-C),l*=this._radius,_*=this._radius,h*=this._radius,d=f=-(s=a*this._halfHeight),g=u=-(r=i*this._halfHeight),p=c=-(o=n*this._halfHeight),m=s<(m=(d+=l)<(f-=l)?f:d)?m:s,v=r<(v=(g+=_)<(u-=_)?u:g)?v:r,b=o<(b=(p+=h)<(c-=h)?c:p)?b:o,I=(I=f<d?f:d)<s?I:s,M=(M=u<g?u:g)<r?M:r,y=(y=c<p?c:p)<o?y:o,t._minX=e._positionX+I,t._minY=e._positionY+M,t._minZ=e._positionZ+y,t._maxX=e._positionX+m,t._maxY=e._positionY+v,t._maxZ=e._positionZ+b},computeLocalSupportingVertex:function(t,e){var a=t.x,i=t.y,n=t.z;if(0<i&&i*i>this.sinTheta*this.sinTheta*(a*a+i*i+n*n))return e.init(0,this._halfHeight-this._gjkMargin/this.sinTheta,0),void(e.y<0&&(e.y=0));var s=t.x,r=t.z,o=s*s+r*r,l=2*this._halfHeight,_=(l-this._gjkMargin)/l*this._radius-this._gjkMargin/this.cosTheta;_<0&&(_=0);var h=0<o?_/Math.sqrt(o):0,f=this._halfHeight-this._gjkMargin;f<0&&(f=0),e.x=s*h,e.y=-f,e.z=r*h},__class__:Di});var Ti=function(t){wi.call(this,5),this._numVertices=t.length;var e=new Array(this._numVertices);this._vertices=e;var a=new Array(this._numVertices);this._tmpVertices=a;for(var i=0,n=this._numVertices;i<n;){var s=i++;this._vertices[s]=t[s],this._tmpVertices[s]=new Et}this._useGjkRayCast=!0,this._updateMass()};(i["oimo.collision.geometry.ConvexHullGeometry"]=Ti).__name__=!0,Ti.__super__=wi,Ti.prototype=s(wi.prototype,{_vertices:null,_tmpVertices:null,_numVertices:null,_updateMass:function(){this._volume=1,this._inertiaCoeff00=1,this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=1,this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=1;for(var t=this._vertices[0].x,e=this._vertices[0].y,a=this._vertices[0].z,i=this._vertices[0].x,n=this._vertices[0].y,s=this._vertices[0].z,r=1,o=this._numVertices;r<o;){var l=r++,_=this._vertices[l].x,h=this._vertices[l].y,f=this._vertices[l].z;_<t?t=_:i<_&&(i=_),h<e?e=h:n<h&&(n=h),f<a?a=f:s<f&&(s=f)}var u=i-t,c=n-e,d=s-a;this._volume=u*c*d;var g=.25*((t+i)*(t+i)+(e+n)*(e+n)+(a+s)*(a+s));u=u*u*.25,c=c*c*.25,d=d*d*.25,this._inertiaCoeff00=.3333333333333333*(c+d)+g,this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=.3333333333333333*(d+u)+g,this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=.3333333333333333*(u+c)+g},_computeAabb:function(t,e){var a,i,n,s,r,o,l,_,h,f,u,c;l=this._gjkMargin,_=this._gjkMargin,h=this._gjkMargin;var d,g,p,m=this._vertices[0];f=m.x,u=m.y,c=m.z,d=e._rotation00*f+e._rotation01*u+e._rotation02*c,g=e._rotation10*f+e._rotation11*u+e._rotation12*c,p=e._rotation20*f+e._rotation21*u+e._rotation22*c,s=a=d+=e._positionX,r=i=g+=e._positionY,o=n=p+=e._positionZ;for(var v=1,b=this._numVertices;v<b;){var I=v++,M=this._vertices[I];f=M.x,u=M.y,c=M.z,d=e._rotation00*f+e._rotation01*u+e._rotation02*c,g=e._rotation10*f+e._rotation11*u+e._rotation12*c,p=e._rotation20*f+e._rotation21*u+e._rotation22*c,a=a<(d+=e._positionX)?a:d,i=i<(g+=e._positionY)?i:g,n=n<(p+=e._positionZ)?n:p,s=d<s?s:d,r=g<r?r:g,o=p<o?o:p}t._minX=a-l,t._minY=i-_,t._minZ=n-h,t._maxX=s+l,t._maxY=r+_,t._maxZ=o+h},computeLocalSupportingVertex:function(t,e){for(var a=this._vertices[0],i=a.x*t.x+a.y*t.y+a.z*t.z,n=0,s=1,r=this._numVertices;s<r;){var o=s++,l=this._vertices[o],_=l.x*t.x+l.y*t.y+l.z*t.z;i<_&&(i=_,n=o)}var h=this._vertices[n];e.x=h.x,e.y=h.y,e.z=h.z},__class__:Ti});var Vi=function(t,e){wi.call(this,2),this._radius=t,this._halfHeight=e,this._updateMass()};(i["oimo.collision.geometry.CylinderGeometry"]=Vi).__name__=!0,Vi.__super__=wi,Vi.prototype=s(wi.prototype,{_radius:null,_halfHeight:null,_updateMass:function(){var t=this._radius*this._radius,e=this._halfHeight*this._halfHeight*4;this._volume=3.14159265358979*t*this._halfHeight*2,this._inertiaCoeff00=.08333333333333333*(3*t+e),this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=.5*t,this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=.08333333333333333*(3*t+e)},_computeAabb:function(t,e){var a,i,n,s,r,o,l,_,h,f=(a=(a=e._rotation01)<0?-a:a)*a,u=(i=(i=e._rotation11)<0?-i:i)*i,c=(n=(n=e._rotation21)<0?-n:n)*n;s=Math.sqrt(1-f),r=Math.sqrt(1-u),o=Math.sqrt(1-c),s*=this._radius,r*=this._radius,o*=this._radius,l=s+a*this._halfHeight,_=r+i*this._halfHeight,h=o+n*this._halfHeight,t._minX=e._positionX-l,t._minY=e._positionY-_,t._minZ=e._positionZ-h,t._maxX=e._positionX+l,t._maxY=e._positionY+_,t._maxZ=e._positionZ+h},computeLocalSupportingVertex:function(t,e){var a=t.x,i=t.z,n=a*a+i*i,s=this._radius-this._gjkMargin;s<0&&(s=0);var r=0<n?s/Math.sqrt(n):0,o=this._halfHeight-this._gjkMargin;o<0&&(o=0),e.x=a*r,e.y=0<t.y?o:-o,e.z=i*r},__class__:Vi});var Ki=function(){this.position=new Et,this.normal=new Et,this.fraction=0};(i["oimo.collision.geometry.RayCastHit"]=Ki).__name__=!0,Ki.prototype={position:null,normal:null,fraction:null,__class__:Ki};var ji=function(t){wi.call(this,0),this._radius=t,this._gjkMargin=this._radius,this._updateMass()};(i["oimo.collision.geometry.SphereGeometry"]=ji).__name__=!0,ji.__super__=wi,ji.prototype=s(wi.prototype,{_radius:null,_updateMass:function(){this._volume=4.188790204786386*this._radius*this._radius*this._radius,this._inertiaCoeff00=.4*this._radius*this._radius,this._inertiaCoeff01=0,this._inertiaCoeff02=0,this._inertiaCoeff10=0,this._inertiaCoeff11=.4*this._radius*this._radius,this._inertiaCoeff12=0,this._inertiaCoeff20=0,this._inertiaCoeff21=0,this._inertiaCoeff22=.4*this._radius*this._radius},_computeAabb:function(t,e){var a,i,n;a=this._radius,i=this._radius,n=this._radius,t._minX=e._positionX-a,t._minY=e._positionY-i,t._minZ=e._positionZ-n,t._maxX=e._positionX+a,t._maxY=e._positionY+i,t._maxZ=e._positionZ+n},computeLocalSupportingVertex:function(t,e){e.zero()},__class__:ji});var Ri=function(){var t=new Array(8);this.detectors=t;for(var e=0;e<6;){var a=e++,i=this.detectors,n=new Array(8);i[a]=n}var s=new qi;this.detectors[0][0]=new en,this.detectors[0][1]=new $i(!1),this.detectors[0][2]=s,this.detectors[0][3]=s,this.detectors[0][4]=new tn(!1),this.detectors[0][5]=s,this.detectors[1][0]=new $i(!0),this.detectors[1][1]=new Oi,this.detectors[1][2]=s,this.detectors[1][3]=s,this.detectors[1][4]=s,this.detectors[1][5]=s,this.detectors[2][0]=s,this.detectors[2][1]=s,this.detectors[2][2]=s,this.detectors[2][3]=s,this.detectors[2][4]=s,this.detectors[2][5]=s,this.detectors[3][0]=s,this.detectors[3][1]=s,this.detectors[3][2]=s,this.detectors[3][3]=s,this.detectors[3][4]=s,this.detectors[3][5]=s,this.detectors[4][0]=new tn(!0),this.detectors[4][1]=s,this.detectors[4][2]=s,this.detectors[4][3]=s,this.detectors[4][4]=new Qi,this.detectors[4][5]=s,this.detectors[5][0]=s,this.detectors[5][1]=s,this.detectors[5][2]=s,this.detectors[5][3]=s,this.detectors[5][4]=s,this.detectors[5][5]=s};(i["oimo.collision.narrowphase.CollisionMatrix"]=Ri).__name__=!0,Ri.prototype={detectors:null,__class__:Ri};var Hi=function(){this.numPoints=0,this.normal=new Et;var t=new Array(xn.maxManifoldPoints);this.points=t,this.incremental=!1;for(var e=0,a=xn.maxManifoldPoints;e<a;){var i=e++;this.points[i]=new Pi}};(i["oimo.collision.narrowphase.DetectorResult"]=Hi).__name__=!0,Hi.prototype={numPoints:null,points:null,normal:null,incremental:null,getMaxDepth:function(){for(var t=0,e=0,a=this.numPoints;e<a;){var i=e++;this.points[i].depth>t&&(t=this.points[i].depth)}return t},__class__:Hi};var Pi=function(){this.position1=new Et,this.position2=new Et,this.depth=0,this.id=0};(i["oimo.collision.narrowphase.DetectorResultPoint"]=Pi).__name__=!0,Pi.prototype={position1:null,position2:null,depth:null,id:null,__class__:Pi};var Fi=function(t){this.swapped=t};(i["oimo.collision.narrowphase.detector.Detector"]=Fi).__name__=!0,Fi.prototype={swapped:null,setNormal:function(t,e,a,i){var n=t.normal;if(n.x=e,n.y=a,n.z=i,this.swapped){var s=t.normal,r=-s.x,o=-s.y,l=-s.z;s.x=r,s.y=o,s.z=l}},addPoint:function(t,e,a,i,n,s,r,o,l){var _=t.points[t.numPoints++];if(_.depth=o,_.id=l,this.swapped){var h=_.position1;h.x=n,h.y=s,h.z=r;var f=_.position2;f.x=e,f.y=a,f.z=i}else{var u=_.position1;u.x=e,u.y=a,u.z=i;var c=_.position2;c.x=n,c.y=s,c.z=r}},detectImpl:function(t,e,a,i,n,s){},detect:function(t,e,a,i,n,s){for(var r=t.numPoints=0,o=t.points;r<o.length;){var l=o[r];++r,l.position1.zero(),l.position2.zero(),l.depth=0,l.id=0}t.normal.zero(),this.swapped?this.detectImpl(t,a,e,n,i,s):this.detectImpl(t,e,a,i,n,s)},__class__:Fi};var Oi=function(){Fi.call(this,!1),this.clipper=new Ui};(i["oimo.collision.narrowphase.detector.BoxBoxDetector"]=Oi).__name__=!0,Oi.__super__=Fi,Oi.prototype=s(Fi.prototype,{clipper:null,detectImpl:function(t,e,a,i,n,s){var r,o,l,_,h,f,u,c,d,g,p,m,v,b,I,M,y,w,x,C,A,Z,z,B,k,S,X,Y=e,N=a;t.incremental=!1,r=i._positionX,o=i._positionY,l=i._positionZ,u=(_=n._positionX)-r,c=(h=n._positionY)-o,d=(f=n._positionZ)-l,g=i._rotation00,p=i._rotation10,m=i._rotation20,v=i._rotation01,b=i._rotation11,I=i._rotation21,M=i._rotation02,y=i._rotation12,w=i._rotation22,x=n._rotation00,C=n._rotation10,A=n._rotation20,Z=n._rotation01,z=n._rotation11,B=n._rotation21,k=n._rotation02,S=n._rotation12,X=n._rotation22;var L,G,W,D,T,V,K,j,R,H,P,F,O,E,U,J,Q,q,$=Y._halfExtentsX,tt=Y._halfExtentsY,et=Y._halfExtentsZ,at=N._halfExtentsX,it=N._halfExtentsY,nt=N._halfExtentsZ;L=g*$,G=p*$,W=m*$,D=v*tt,T=b*tt,V=I*tt,K=M*et,j=y*et,R=w*et;var st,rt,ot,lt=1/0,_t=-1,ht=0,ft=$,ut=g*(H=x*at)+p*(P=C*at)+m*(F=A*at),ct=g*(O=Z*it)+p*(E=z*it)+m*(U=B*it),dt=g*(J=k*nt)+p*(Q=S*nt)+m*(q=X*nt);ut<(ot=rt=st=0)&&(ut=-ut),ct<0&&(ct=-ct),dt<0&&(dt=-dt);var gt=ut+ct+dt,pt=g*u+p*c+m*d,mt=ft+gt,vt=pt<0,bt=vt?-pt:pt;if(bt<mt){var It=mt-bt;It<lt&&(lt=It,_t=0,st=g,rt=p,ot=m,ht=vt?-1:1);var Mt=v*H+b*P+I*F,yt=v*O+b*E+I*U,wt=v*J+b*Q+I*q;Mt<0&&(Mt=-Mt),yt<0&&(yt=-yt),wt<0&&(wt=-wt);var xt=(ft=tt)+(gt=Mt+yt+wt),Ct=(pt=v*u+b*c+I*d)<0,At=Ct?-pt:pt;if(At<xt){var Zt=xt-At;Zt<lt&&(lt=Zt,_t=1,st=v,rt=b,ot=I,ht=Ct?-1:1);var zt=M*H+y*P+w*F,Bt=M*O+y*E+w*U,kt=M*J+y*Q+w*q;zt<0&&(zt=-zt),Bt<0&&(Bt=-Bt),kt<0&&(kt=-kt);var St=(ft=et)+(gt=zt+Bt+kt),Xt=(pt=M*u+y*c+w*d)<0,Yt=Xt?-pt:pt;if(Yt<St){var Nt=St-Yt;Nt<lt&&(lt=Nt,_t=2,st=M,rt=y,ot=w,ht=Xt?-1:1),lt>xn.linearSlop?lt-=xn.linearSlop:lt=0;var Lt=x*L+C*G+A*W,Gt=x*D+C*T+A*V,Wt=x*K+C*j+A*R;Lt<0&&(Lt=-Lt),Gt<0&&(Gt=-Gt),Wt<0&&(Wt=-Wt);var Dt=(ft=Lt+Gt+Wt)+(gt=at),Tt=(pt=x*u+C*c+A*d)<0,Vt=Tt?-pt:pt;if(Vt<Dt){var Kt=Dt-Vt;Kt<lt&&(lt=Kt,_t=3,st=x,rt=C,ot=A,ht=Tt?-1:1);var jt=Z*L+z*G+B*W,Rt=Z*D+z*T+B*V,Ht=Z*K+z*j+B*R;jt<0&&(jt=-jt),Rt<0&&(Rt=-Rt),Ht<0&&(Ht=-Ht);var Pt=(ft=jt+Rt+Ht)+(gt=it),Ft=(pt=Z*u+z*c+B*d)<0,Ot=Ft?-pt:pt;if(Ot<Pt){var Et=Pt-Ot;Et<lt&&(lt=Et,_t=4,st=Z,rt=z,ot=B,ht=Ft?-1:1);var Ut=k*L+S*G+X*W,Jt=k*D+S*T+X*V,Qt=k*K+S*j+X*R;Ut<0&&(Ut=-Ut),Jt<0&&(Jt=-Jt),Qt<0&&(Qt=-Qt);var qt=(ft=Ut+Jt+Qt)+(gt=nt),$t=(pt=k*u+S*c+X*d)<0,te=$t?-pt:pt;if(te<qt){var ee,ae,ie,ne,se,re,oe,le,_e,he,fe,ue,ce,de,ge,pe,me,ve,be,Ie,Me,ye=qt-te;if(ye<lt&&(lt=ye,_t=5,st=k,rt=S,ot=X,ht=$t?-1:1),lt>xn.linearSlop?lt-=xn.linearSlop:lt=0,ae=m*x-g*A,ie=g*C-p*x,0!=(ee=p*A-m*C)||0!=ae||0!=ie){var we=ee*ee+ae*ae+ie*ie;0<we&&(we=1/Math.sqrt(we));var xe=(ee*=we)*D+(ae*=we)*T+(ie*=we)*V,Ce=ee*K+ae*j+ie*R;xe<0&&(xe=-xe),Ce<0&&(Ce=-Ce);var Ae=ee*O+ae*E+ie*U,Ze=ee*J+ae*Q+ie*q;Ae<0&&(Ae=-Ae),Ze<0&&(Ze=-Ze);var ze=(ft=xe+Ce)+(gt=Ae+Ze),Be=(pt=ee*u+ae*c+ie*d)<0,ke=Be?-pt:pt;if(!(ke<ze))return;var Se=ze-ke;Se<lt&&(lt=Se,_t=6,st=ee,rt=ae,ot=ie,ht=Be?-1:1)}if(ae=m*Z-g*B,ie=g*z-p*Z,0!=(ee=p*B-m*z)||0!=ae||0!=ie){var Xe=ee*ee+ae*ae+ie*ie;0<Xe&&(Xe=1/Math.sqrt(Xe));var Ye=(ee*=Xe)*D+(ae*=Xe)*T+(ie*=Xe)*V,Ne=ee*K+ae*j+ie*R;Ye<0&&(Ye=-Ye),Ne<0&&(Ne=-Ne);var Le=ee*H+ae*P+ie*F,Ge=ee*J+ae*Q+ie*q;Le<0&&(Le=-Le),Ge<0&&(Ge=-Ge);var We=(ft=Ye+Ne)+(gt=Le+Ge),De=(pt=ee*u+ae*c+ie*d)<0,Te=De?-pt:pt;if(!(Te<We))return;var Ve=We-Te;Ve<lt&&(lt=Ve,_t=7,st=ee,rt=ae,ot=ie,ht=De?-1:1)}if(ae=m*k-g*X,ie=g*S-p*k,0!=(ee=p*X-m*S)||0!=ae||0!=ie){var Ke=ee*ee+ae*ae+ie*ie;0<Ke&&(Ke=1/Math.sqrt(Ke));var je=(ee*=Ke)*D+(ae*=Ke)*T+(ie*=Ke)*V,Re=ee*K+ae*j+ie*R;je<0&&(je=-je),Re<0&&(Re=-Re);var He=ee*H+ae*P+ie*F,Pe=ee*O+ae*E+ie*U;He<0&&(He=-He),Pe<0&&(Pe=-Pe);var Fe=(ft=je+Re)+(gt=He+Pe),Oe=(pt=ee*u+ae*c+ie*d)<0,Ee=Oe?-pt:pt;if(!(Ee<Fe))return;var Ue=Fe-Ee;Ue<lt&&(lt=Ue,_t=8,st=ee,rt=ae,ot=ie,ht=Oe?-1:1)}if(ae=I*x-v*A,ie=v*C-b*x,0!=(ee=b*A-I*C)||0!=ae||0!=ie){var Je=ee*ee+ae*ae+ie*ie;0<Je&&(Je=1/Math.sqrt(Je));var Qe=(ee*=Je)*L+(ae*=Je)*G+(ie*=Je)*W,qe=ee*K+ae*j+ie*R;Qe<0&&(Qe=-Qe),qe<0&&(qe=-qe);var $e=ee*O+ae*E+ie*U,ta=ee*J+ae*Q+ie*q;$e<0&&($e=-$e),ta<0&&(ta=-ta);var ea=(ft=Qe+qe)+(gt=$e+ta),aa=(pt=ee*u+ae*c+ie*d)<0,ia=aa?-pt:pt;if(!(ia<ea))return;var na=ea-ia;na<lt&&(lt=na,_t=9,st=ee,rt=ae,ot=ie,ht=aa?-1:1)}if(ae=I*Z-v*B,ie=v*z-b*Z,0!=(ee=b*B-I*z)||0!=ae||0!=ie){var sa=ee*ee+ae*ae+ie*ie;0<sa&&(sa=1/Math.sqrt(sa));var ra=(ee*=sa)*L+(ae*=sa)*G+(ie*=sa)*W,oa=ee*K+ae*j+ie*R;ra<0&&(ra=-ra),oa<0&&(oa=-oa);var la=ee*H+ae*P+ie*F,_a=ee*J+ae*Q+ie*q;la<0&&(la=-la),_a<0&&(_a=-_a);var ha=(ft=ra+oa)+(gt=la+_a),fa=(pt=ee*u+ae*c+ie*d)<0,ua=fa?-pt:pt;if(!(ua<ha))return;var ca=ha-ua;ca<lt&&(lt=ca,_t=10,st=ee,rt=ae,ot=ie,ht=fa?-1:1)}if(ae=I*k-v*X,ie=v*S-b*k,0!=(ee=b*X-I*S)||0!=ae||0!=ie){var da=ee*ee+ae*ae+ie*ie;0<da&&(da=1/Math.sqrt(da));var ga=(ee*=da)*L+(ae*=da)*G+(ie*=da)*W,pa=ee*K+ae*j+ie*R;ga<0&&(ga=-ga),pa<0&&(pa=-pa);var ma=ee*H+ae*P+ie*F,va=ee*O+ae*E+ie*U;ma<0&&(ma=-ma),va<0&&(va=-va);var ba=(ft=ga+pa)+(gt=ma+va),Ia=(pt=ee*u+ae*c+ie*d)<0,Ma=Ia?-pt:pt;if(!(Ma<ba))return;var ya=ba-Ma;ya<lt&&(lt=ya,_t=11,st=ee,rt=ae,ot=ie,ht=Ia?-1:1)}if(ae=w*x-M*A,ie=M*C-y*x,0!=(ee=y*A-w*C)||0!=ae||0!=ie){var wa=ee*ee+ae*ae+ie*ie;0<wa&&(wa=1/Math.sqrt(wa));var xa=(ee*=wa)*L+(ae*=wa)*G+(ie*=wa)*W,Ca=ee*D+ae*T+ie*V;xa<0&&(xa=-xa),Ca<0&&(Ca=-Ca);var Aa=ee*O+ae*E+ie*U,Za=ee*J+ae*Q+ie*q;Aa<0&&(Aa=-Aa),Za<0&&(Za=-Za);var za=(ft=xa+Ca)+(gt=Aa+Za),Ba=(pt=ee*u+ae*c+ie*d)<0,ka=Ba?-pt:pt;if(!(ka<za))return;var Sa=za-ka;Sa<lt&&(lt=Sa,_t=12,st=ee,rt=ae,ot=ie,ht=Ba?-1:1)}if(ae=w*Z-M*B,ie=M*z-y*Z,0!=(ee=y*B-w*z)||0!=ae||0!=ie){var Xa=ee*ee+ae*ae+ie*ie;0<Xa&&(Xa=1/Math.sqrt(Xa));var Ya=(ee*=Xa)*L+(ae*=Xa)*G+(ie*=Xa)*W,Na=ee*D+ae*T+ie*V;Ya<0&&(Ya=-Ya),Na<0&&(Na=-Na);var La=ee*H+ae*P+ie*F,Ga=ee*J+ae*Q+ie*q;La<0&&(La=-La),Ga<0&&(Ga=-Ga);var Wa=(ft=Ya+Na)+(gt=La+Ga),Da=(pt=ee*u+ae*c+ie*d)<0,Ta=Da?-pt:pt;if(!(Ta<Wa))return;var Va=Wa-Ta;Va<lt&&(lt=Va,_t=13,st=ee,rt=ae,ot=ie,ht=Da?-1:1)}if(ae=w*k-M*X,ie=M*S-y*k,0!=(ee=y*X-w*S)||0!=ae||0!=ie){var Ka=ee*ee+ae*ae+ie*ie;0<Ka&&(Ka=1/Math.sqrt(Ka));var ja=(ee*=Ka)*L+(ae*=Ka)*G+(ie*=Ka)*W,Ra=ee*D+ae*T+ie*V;ja<0&&(ja=-ja),Ra<0&&(Ra=-Ra);var Ha=ee*H+ae*P+ie*F,Pa=ee*O+ae*E+ie*U;Ha<0&&(Ha=-Ha),Pa<0&&(Pa=-Pa);var Fa=(ft=ja+Ra)+(gt=Ha+Pa),Oa=(pt=ee*u+ae*c+ie*d)<0,Ea=Oa?-pt:pt;if(!(Ea<Fa))return;var Ua=Fa-Ea;Ua<lt&&(lt=Ua,_t=14,st=ee,rt=ae,ot=ie,ht=Oa?-1:1)}if(6<=_t){st*=ht,rt*=ht,ot*=ht;var Ja,Qa,qa,$a,ti,ei,ai,ii,ni,si,ri,oi,li,_i,hi,fi=(_t-6)/3|0,ui=_t-6-3*fi;switch(fi){case 0:ai=g,ii=p,ni=m;var ci=0<K*st+j*rt+R*ot;0<D*st+T*rt+V*ot?ci?(Ja=D+K,Qa=T+j,qa=V+R):(Ja=D-K,Qa=T-j,qa=V-R):ci?(Ja=K-D,Qa=j-T,qa=R-V):(Ja=-(Ja=D+K),Qa=-(Qa=T+j),qa=-(qa=V+R));break;case 1:ai=v,ii=b,ni=I;var di=0<K*st+j*rt+R*ot;0<L*st+G*rt+W*ot?di?(Ja=L+K,Qa=G+j,qa=W+R):(Ja=L-K,Qa=G-j,qa=W-R):di?(Ja=K-L,Qa=j-G,qa=R-W):(Ja=-(Ja=L+K),Qa=-(Qa=G+j),qa=-(qa=W+R));break;default:ai=M,ii=y,ni=w;var gi=0<D*st+T*rt+V*ot;0<L*st+G*rt+W*ot?gi?(Ja=L+D,Qa=G+T,qa=W+V):(Ja=L-D,Qa=G-T,qa=W-V):gi?(Ja=D-L,Qa=T-G,qa=V-W):(Ja=-(Ja=L+D),Qa=-(Qa=G+T),qa=-(qa=W+V))}switch(Ja=r+Ja,Qa=o+Qa,qa=l+qa,ui){case 0:si=x,ri=C,oi=A;var pi=0<J*st+Q*rt+q*ot;0<O*st+E*rt+U*ot?pi?($a=O+J,ti=E+Q,ei=U+q):($a=O-J,ti=E-Q,ei=U-q):pi?($a=J-O,ti=Q-E,ei=q-U):($a=-($a=O+J),ti=-(ti=E+Q),ei=-(ei=U+q));break;case 1:si=Z,ri=z,oi=B;var mi=0<J*st+Q*rt+q*ot;0<H*st+P*rt+F*ot?mi?($a=H+J,ti=P+Q,ei=F+q):($a=H-J,ti=P-Q,ei=F-q):mi?($a=J-H,ti=Q-P,ei=q-F):($a=-($a=H+J),ti=-(ti=P+Q),ei=-(ei=F+q));break;default:si=k,ri=S,oi=X;var vi=0<O*st+E*rt+U*ot;0<H*st+P*rt+F*ot?vi?($a=H+O,ti=P+E,ei=F+U):($a=H-O,ti=P-E,ei=F-U):vi?($a=O-H,ti=E-P,ei=U-F):($a=-($a=H+O),ti=-(ti=P+E),ei=-(ei=F+U))}var bi,Ii,Mi,yi,wi,xi,Ci,Ai,Zi,zi=ai*si+ii*ri+ni*oi,Bi=ai*(li=Ja-($a=_-$a))+ii*(_i=Qa-(ti=h-ti))+ni*(hi=qa-(ei=f-ei)),ki=si*li+ri*_i+oi*hi,Si=1/(1-zi*zi),Xi=(zi*ki-Bi)*Si,Yi=(ki-zi*Bi)*Si;return bi=Ja+ai*Xi,Ii=Qa+ii*Xi,Mi=qa+ni*Xi,yi=$a+si*Yi,wi=ti+ri*Yi,xi=ei+oi*Yi,Ci=-st,Ai=-rt,Zi=-ot,this.setNormal(t,Ci,Ai,Zi),void this.addPoint(t,bi,Ii,Mi,yi,wi,xi,lt,4)}if(3<=_t){ht=-ht,u=-u,c=-c,d=-d;var Ni=Y;Y=N,N=Ni;var Li=$;$=at,at=Li;var Gi=tt;tt=it,it=Gi;var Wi=et;et=nt,nt=Wi,ne=r,se=o,re=l,r=_,o=h,l=f,_=ne,h=se,f=re,ne=g,se=p,re=m,g=x,p=C,m=A,x=ne,C=se,A=re,ne=v,se=b,re=I,v=Z,b=z,I=B,Z=ne,z=se,B=re,ne=M,se=y,re=w,M=k,y=S,w=X,k=ne,S=se,X=re,ne=L,se=G,re=W,L=H,G=P,W=F,H=ne,P=se,F=re,ne=D,se=T,re=V,D=O,T=E,V=U,O=ne,E=se,U=re,ne=K,se=j,re=R,K=J,j=Q,R=q,J=ne,Q=se,q=re,_t-=3,oe=!0}else oe=!1;switch(_t){case 0:le=L,_e=G,he=W,fe=g,ue=p,ce=m,de=v,ge=b,pe=I,me=M,ve=y,be=w,Ie=tt,Me=et;break;case 1:le=D,_e=T,he=V,fe=v,ue=b,ce=I,de=M,ge=y,pe=w,me=g,ve=p,be=m,Ie=et,Me=$;break;default:le=K,_e=j,he=R,fe=M,ue=y,ce=w,de=g,ge=p,pe=m,me=v,ve=b,be=I,Ie=$,Me=tt}if(ht<0){le=-le,_e=-_e,he=-he,fe=-fe,ue=-ue,ce=-ce,ne=de,se=ge,re=pe,de=me,ge=ve,pe=be,me=ne,ve=se,be=re;var Di=Ie;Ie=Me,Me=Di}le+=r,_e+=o,he+=l;var Ti,Vi,Ki,ji,Ri,Hi,Pi,Fi,Oi,Ei,Ui,Ji,Qi=1,qi=0,$i=fe*x+ue*C+ce*A;switch($i<Qi&&(Qi=$i,qi=0),-$i<Qi&&(Qi=-$i,qi=1),($i=fe*Z+ue*z+ce*B)<Qi&&(Qi=$i,qi=2),-$i<Qi&&(Qi=-$i,qi=3),($i=fe*k+ue*S+ce*X)<Qi&&(Qi=$i,qi=4),-$i<Qi&&(Qi=-$i,qi=5),qi){case 0:Ti=H+O,Vi=P+E,Ki=F+U,Ti+=J,Vi+=Q,Ki+=q,ji=H-O,Ri=P-E,Hi=F-U,ji+=J,Ri+=Q,Hi+=q,Pi=H-O,Fi=P-E,Oi=F-U,Pi-=J,Fi-=Q,Oi-=q,Ei=H+O,Ui=P+E,Ji=F+U,Ei-=J,Ui-=Q,Ji-=q;break;case 1:Ti=O-H,Vi=E-P,Ki=U-F,Ti+=J,Vi+=Q,Ki+=q,ji=O-H,Ri=E-P,Hi=U-F,ji-=J,Ri-=Q,Hi-=q,Pi=-(Pi=H+O),Fi=-(Fi=P+E),Oi=-(Oi=F+U),Pi-=J,Fi-=Q,Oi-=q,Ei=-(Ei=H+O),Ui=-(Ui=P+E),Ji=-(Ji=F+U),Ei+=J,Ui+=Q,Ji+=q;break;case 2:Ti=H+O,Vi=P+E,Ki=F+U,Ti+=J,Vi+=Q,Ki+=q,ji=H+O,Ri=P+E,Hi=F+U,ji-=J,Ri-=Q,Hi-=q,Pi=O-H,Fi=E-P,Oi=U-F,Pi-=J,Fi-=Q,Oi-=q,Ei=O-H,Ui=E-P,Ji=U-F,Ei+=J,Ui+=Q,Ji+=q;break;case 3:Ti=H-O,Vi=P-E,Ki=F-U,Ti+=J,Vi+=Q,Ki+=q,ji=-(ji=H+O),Ri=-(Ri=P+E),Hi=-(Hi=F+U),ji+=J,Ri+=Q,Hi+=q,Pi=-(Pi=H+O),Fi=-(Fi=P+E),Oi=-(Oi=F+U),Pi-=J,Fi-=Q,Oi-=q,Ei=H-O,Ui=P-E,Ji=F-U,Ei-=J,Ui-=Q,Ji-=q;break;case 4:Ti=H+O,Vi=P+E,Ki=F+U,Ti+=J,Vi+=Q,Ki+=q,ji=O-H,Ri=E-P,Hi=U-F,ji+=J,Ri+=Q,Hi+=q,Pi=-(Pi=H+O),Fi=-(Fi=P+E),Oi=-(Oi=F+U),Pi+=J,Fi+=Q,Oi+=q,Ei=H-O,Ui=P-E,Ji=F-U,Ei+=J,Ui+=Q,Ji+=q;break;default:Ti=H+O,Vi=P+E,Ki=F+U,Ti-=J,Vi-=Q,Ki-=q,ji=H-O,Ri=P-E,Hi=F-U,ji-=J,Ri-=Q,Hi-=q,Pi=-(Pi=H+O),Fi=-(Fi=P+E),Oi=-(Oi=F+U),Pi-=J,Fi-=Q,Oi-=q,Ei=O-H,Ui=E-P,Ji=U-F,Ei-=J,Ui-=Q,Ji-=q}Ti+=u,Vi+=c,Ki+=d,ji+=u,Ri+=c,Hi+=d,Pi+=u,Fi+=c,Oi+=d,Ei+=u,Ui+=c,Ji+=d;var tn=this.clipper;tn.w=Ie,tn.h=Me,tn.numVertices=0,tn.numTmpVertices=0;var en=this.clipper,an=en.vertices[en.numVertices++];an.x=Ti*de+Vi*ge+Ki*pe,an.y=Ti*me+Vi*ve+Ki*be,an.wx=Ti,an.wy=Vi,an.wz=Ki;var nn=this.clipper,sn=nn.vertices[nn.numVertices++];sn.x=ji*de+Ri*ge+Hi*pe,sn.y=ji*me+Ri*ve+Hi*be,sn.wx=ji,sn.wy=Ri,sn.wz=Hi;var rn=this.clipper,on=rn.vertices[rn.numVertices++];on.x=Pi*de+Fi*ge+Oi*pe,on.y=Pi*me+Fi*ve+Oi*be,on.wx=Pi,on.wy=Fi,on.wz=Oi;var ln,_n,hn,fn=this.clipper,un=fn.vertices[fn.numVertices++];un.x=Ei*de+Ui*ge+Ji*pe,un.y=Ei*me+Ui*ve+Ji*be,un.wx=Ei,un.wy=Ui,un.wz=Ji,this.clipper.clip(),this.clipper.reduce(),oe?(ln=fe,_n=ue,hn=ce):(ln=-fe,_n=-ue,hn=-ce),this.setNormal(t,ln,_n,hn);for(var cn=0,dn=this.clipper.numVertices;cn<dn;){var gn,pn,mn,vn=cn++,bn=this.clipper.vertices[vn];gn=bn.wx,pn=bn.wy,mn=bn.wz;var In,Mn,yn,wn=(le-(gn+=r))*fe+(_e-(pn+=o))*ue+(he-(mn+=l))*ce;In=gn+fe*wn,Mn=pn+ue*wn,yn=mn+ce*wn,wn>-xn.contactPersistenceThreshold&&(oe?this.addPoint(t,gn,pn,mn,In,Mn,yn,wn,vn):this.addPoint(t,In,Mn,yn,gn,pn,mn,wn,vn))}}}}}}}},__class__:Oi});var Ei=function(){this.x=0,this.y=0,this.wx=0,this.wy=0,this.wz=0};(i["oimo.collision.narrowphase.detector._BoxBoxDetector.IncidentVertex"]=Ei).__name__=!0,Ei.prototype={x:null,y:null,wx:null,wy:null,wz:null,__class__:Ei};var Ui=function(){this.w=0,this.h=0,this.numVertices=0,this.numTmpVertices=0;var t=new Array(8);this.vertices=t;var e=new Array(8);this.tmpVertices=e;for(var a=0;a<8;){var i=a++;this.vertices[i]=new Ei,this.tmpVertices[i]=new Ei}};(i["oimo.collision.narrowphase.detector._BoxBoxDetector.FaceClipper"]=Ui).__name__=!0,Ui.prototype={w:null,h:null,numVertices:null,vertices:null,numTmpVertices:null,tmpVertices:null,clip:function(){for(var t=0,e=this.numVertices;t<e;){var a=t++,i=this.vertices[a],n=this.vertices[(a+1)%this.numVertices],s=this.w+i.x,r=this.w+n.x;if(0<s&&0<r){var o=this.tmpVertices[this.numTmpVertices++];o.x=i.x,o.y=i.y,o.wx=i.wx,o.wy=i.wy,o.wz=i.wz}else if(0<s&&r<=0){var l=this.tmpVertices[this.numTmpVertices++];l.x=i.x,l.y=i.y,l.wx=i.wx,l.wy=i.wy,l.wz=i.wz;var _=s/(s-r),h=this.tmpVertices[this.numTmpVertices++];h.x=i.x+(n.x-i.x)*_,h.y=i.y+(n.y-i.y)*_,h.wx=i.wx+(n.wx-i.wx)*_,h.wy=i.wy+(n.wy-i.wy)*_,h.wz=i.wz+(n.wz-i.wz)*_}else if(s<=0&&0<r){var f=s/(s-r),u=this.tmpVertices[this.numTmpVertices++];u.x=i.x+(n.x-i.x)*f,u.y=i.y+(n.y-i.y)*f,u.wx=i.wx+(n.wx-i.wx)*f,u.wy=i.wy+(n.wy-i.wy)*f,u.wz=i.wz+(n.wz-i.wz)*f}}var c=this.vertices;this.vertices=this.tmpVertices,this.tmpVertices=c,this.numVertices=this.numTmpVertices;for(var d=this.numTmpVertices=0,g=this.numVertices;d<g;){var p=d++,m=this.vertices[p],v=this.vertices[(p+1)%this.numVertices],b=this.w-m.x,I=this.w-v.x;if(0<b&&0<I){var M=this.tmpVertices[this.numTmpVertices++];M.x=m.x,M.y=m.y,M.wx=m.wx,M.wy=m.wy,M.wz=m.wz}else if(0<b&&I<=0){var y=this.tmpVertices[this.numTmpVertices++];y.x=m.x,y.y=m.y,y.wx=m.wx,y.wy=m.wy,y.wz=m.wz;var w=b/(b-I),x=this.tmpVertices[this.numTmpVertices++];x.x=m.x+(v.x-m.x)*w,x.y=m.y+(v.y-m.y)*w,x.wx=m.wx+(v.wx-m.wx)*w,x.wy=m.wy+(v.wy-m.wy)*w,x.wz=m.wz+(v.wz-m.wz)*w}else if(b<=0&&0<I){var C=b/(b-I),A=this.tmpVertices[this.numTmpVertices++];A.x=m.x+(v.x-m.x)*C,A.y=m.y+(v.y-m.y)*C,A.wx=m.wx+(v.wx-m.wx)*C,A.wy=m.wy+(v.wy-m.wy)*C,A.wz=m.wz+(v.wz-m.wz)*C}}var Z=this.vertices;this.vertices=this.tmpVertices,this.tmpVertices=Z,this.numVertices=this.numTmpVertices;for(var z=this.numTmpVertices=0,B=this.numVertices;z<B;){var k=z++,S=this.vertices[k],X=this.vertices[(k+1)%this.numVertices],Y=this.h+S.y,N=this.h+X.y;if(0<Y&&0<N){var L=this.tmpVertices[this.numTmpVertices++];L.x=S.x,L.y=S.y,L.wx=S.wx,L.wy=S.wy,L.wz=S.wz}else if(0<Y&&N<=0){var G=this.tmpVertices[this.numTmpVertices++];G.x=S.x,G.y=S.y,G.wx=S.wx,G.wy=S.wy,G.wz=S.wz;var W=Y/(Y-N),D=this.tmpVertices[this.numTmpVertices++];D.x=S.x+(X.x-S.x)*W,D.y=S.y+(X.y-S.y)*W,D.wx=S.wx+(X.wx-S.wx)*W,D.wy=S.wy+(X.wy-S.wy)*W,D.wz=S.wz+(X.wz-S.wz)*W}else if(Y<=0&&0<N){var T=Y/(Y-N),V=this.tmpVertices[this.numTmpVertices++];V.x=S.x+(X.x-S.x)*T,V.y=S.y+(X.y-S.y)*T,V.wx=S.wx+(X.wx-S.wx)*T,V.wy=S.wy+(X.wy-S.wy)*T,V.wz=S.wz+(X.wz-S.wz)*T}}var K=this.vertices;this.vertices=this.tmpVertices,this.tmpVertices=K,this.numVertices=this.numTmpVertices;for(var j=this.numTmpVertices=0,R=this.numVertices;j<R;){var H=j++,P=this.vertices[H],F=this.vertices[(H+1)%this.numVertices],O=this.h-P.y,E=this.h-F.y;if(0<O&&0<E){var U=this.tmpVertices[this.numTmpVertices++];U.x=P.x,U.y=P.y,U.wx=P.wx,U.wy=P.wy,U.wz=P.wz}else if(0<O&&E<=0){var J=this.tmpVertices[this.numTmpVertices++];J.x=P.x,J.y=P.y,J.wx=P.wx,J.wy=P.wy,J.wz=P.wz;var Q=O/(O-E),q=this.tmpVertices[this.numTmpVertices++];q.x=P.x+(F.x-P.x)*Q,q.y=P.y+(F.y-P.y)*Q,q.wx=P.wx+(F.wx-P.wx)*Q,q.wy=P.wy+(F.wy-P.wy)*Q,q.wz=P.wz+(F.wz-P.wz)*Q}else if(O<=0&&0<E){var $=O/(O-E),tt=this.tmpVertices[this.numTmpVertices++];tt.x=P.x+(F.x-P.x)*$,tt.y=P.y+(F.y-P.y)*$,tt.wx=P.wx+(F.wx-P.wx)*$,tt.wy=P.wy+(F.wy-P.wy)*$,tt.wz=P.wz+(F.wz-P.wz)*$}}var et=this.vertices;this.vertices=this.tmpVertices,this.tmpVertices=et,this.numVertices=this.numTmpVertices,this.numTmpVertices=0},reduce:function(){if(!(this.numVertices<4)){for(var t=-1/0,e=1/0,a=-1/0,i=1/0,n=null,s=null,r=null,o=null,l=0,_=this.numVertices;l<_;){var h=l++,f=this.vertices[h],u=1*f.x+1*f.y,c=-1*f.x+1*f.y;t<u&&(t=u,n=f),u<e&&(e=u,s=f),a<c&&(a=c,r=f),c<i&&(i=c,o=f)}var d=this.tmpVertices[this.numTmpVertices++];d.x=n.x,d.y=n.y,d.wx=n.wx,d.wy=n.wy,d.wz=n.wz;var g=this.tmpVertices[this.numTmpVertices++];g.x=r.x,g.y=r.y,g.wx=r.wx,g.wy=r.wy,g.wz=r.wz;var p=this.tmpVertices[this.numTmpVertices++];p.x=s.x,p.y=s.y,p.wx=s.wx,p.wy=s.wy,p.wz=s.wz;var m=this.tmpVertices[this.numTmpVertices++];m.x=o.x,m.y=o.y,m.wx=o.wx,m.wy=o.wy,m.wz=o.wz;var v=this.vertices;this.vertices=this.tmpVertices,this.tmpVertices=v,this.numVertices=this.numTmpVertices,this.numTmpVertices=0}},__class__:Ui};var Ji=function(){};(i["oimo.collision.narrowphase.detector.CachedDetectorData"]=Ji).__name__=!0,Ji.prototype={_gjkCache:null,_clear:function(){null!=this._gjkCache&&this._gjkCache.clear()},__class__:Ji};var Qi=function(){Fi.call(this,!1)};(i["oimo.collision.narrowphase.detector.CapsuleCapsuleDetector"]=Qi).__name__=!0,Qi.__super__=Fi,Qi.prototype=s(Fi.prototype,{detectImpl:function(t,e,a,i,n,s){var r,o,l,_,h,f,u=e,c=a;t.incremental=!1,r=i._rotation01,o=i._rotation11,l=i._rotation21,_=n._rotation01,h=n._rotation11,f=n._rotation21;var d,g,p,m,v,b,I,M,y,w,x,C,A,Z,z,B,k,S,X=u._halfHeight,Y=c._halfHeight,N=u._radius,L=c._radius;d=i._positionX+r*-X,g=i._positionY+o*-X,p=i._positionZ+l*-X,m=i._positionX+r*X,v=i._positionY+o*X,b=i._positionZ+l*X;var G,W,D,T,V,K,j,R,H,P,F,O=-((w=d-(I=n._positionX+_*-Y))*(A=m-d)+(x=g-(M=n._positionY+h*-Y))*(Z=v-g)+(C=p-(y=n._positionZ+f*-Y))*(z=b-p)),E=w*(B=n._positionX+_*Y-I)+x*(k=n._positionY+h*Y-M)+C*(S=n._positionZ+f*Y-y),U=X*X*4,J=A*B+Z*k+z*S,Q=Y*Y*4;if(0==U&&0==Q)W=G=0;else if(0==U)(W=E)<(G=0)?W=0:Q<W?W=1:W/=Q;else if(0==Q)(G=O)<(W=0)?G=0:U<G?G=1:G/=U;else{var q=U*Q-J*J;0==q?G=0:(G=J*E+Q*O)<0?G=0:q<G?G=1:G/=q,(W=G*J+E)<0?(G=O)<(W=0)?G=0:U<G?G=1:G/=U:Q<W?(W=1,(G=J+O)<0?G=0:U<G?G=1:G/=U):W/=Q}var $=(H=(D=d+A*G)-(K=I+B*W))*H+(P=(T=g+Z*G)-(j=M+k*W))*P+(F=(V=p+z*G)-(R=y+S*W))*F;if(!((N+L)*(N+L)<=$)){var tt,et,at,it,nt,st,rt,ot,lt,_t=Math.sqrt($);0<_t?(tt=H*(1/_t),et=P*(1/_t),at=F*(1/_t)):(tt=1,at=et=0),this.setNormal(t,tt,et,at),it=D+tt*-N,nt=T+et*-N,st=V+at*-N,rt=K+tt*L,ot=j+et*L,lt=R+at*L,this.addPoint(t,it,nt,st,rt,ot,lt,N+L-_t,0)}},__class__:Qi});var qi=function(){Fi.call(this,!1)};(i["oimo.collision.narrowphase.detector.GjkEpaDetector"]=qi).__name__=!0,qi.__super__=Fi,qi.prototype=s(Fi.prototype,{detectImpl:function(t,e,a,i,n,s){var r=on.instance,o=e,l=a,_=r.computeClosestPointsImpl(o,l,i,n,xn.enableGJKCaching?s:null,!0);if(t.incremental=!0,_==ln.SUCCEEDED){var h=o._gjkMargin,f=l._gjkMargin;if(!(r.distance>h+f)){var u,c,d,g,p,m,v=r.closestPoint1;u=v.x,c=v.y,d=v.z;var b,I,M,y=r.closestPoint2;if((b=u-(g=y.x))*b+(I=c-(p=y.y))*I+(M=d-(m=y.z))*M!=0){r.distance<0&&(b=-b,I=-I,M=-M);var w=b*b+I*I+M*M;0<w&&(w=1/Math.sqrt(w)),b*=w,I*=w,M*=w,this.setNormal(t,b,I,M),u+=b*-o._gjkMargin,c+=I*-o._gjkMargin,d+=M*-o._gjkMargin,g+=b*l._gjkMargin,p+=I*l._gjkMargin,m+=M*l._gjkMargin,this.addPoint(t,u,c,d,g,p,m,o._gjkMargin+l._gjkMargin-r.distance,0)}}}else Fe.trace("GJK/EPA failed: status="+_,{fileName:"Sources/oimo/collision/narrowphase/detector/GjkEpaDetector.hx",lineNumber:28,className:"oimo.collision.narrowphase.detector.GjkEpaDetector",methodName:"detectImpl"})},__class__:qi});var $i=function(t){Fi.call(this,t)};(i["oimo.collision.narrowphase.detector.SphereBoxDetector"]=$i).__name__=!0,$i.__super__=Fi,$i.prototype=s(Fi.prototype,{detectImpl:function(t,e,a,i,n,s){var r,o,l,_,h,f,u=e,c=a;t.incremental=!1,_=-(r=c._halfExtentsX),h=-(o=c._halfExtentsY),f=-(l=c._halfExtentsZ);var d,g,p,m,v,b,I,M,y,w,x=u._radius;if(d=i._positionX-n._positionX,g=i._positionY-n._positionY,p=i._positionZ-n._positionZ,I=n._rotation00*d+n._rotation10*g+n._rotation20*p,v=n._rotation01*d+n._rotation11*g+n._rotation21*p,b=n._rotation02*d+n._rotation12*g+n._rotation22*p,_<(m=I)&&m<r&&h<v&&v<o&&f<b&&b<l){var C,A,Z,z,B,k,S,X,Y,N,L,G,W,D,T,V,K,j,R,H,P,F,O,E,U;C=r-(C=m<0?-m:m),A=o-(A=v<0?-v:v),Z=l-(Z=b<0?-b:b);return C<A?C<Z?(z=0<m?1:-1,k=B=0,X=0,N=Y=1,S=C):(0<b?(B=z=0,k=1):(B=z=0,k=-1),Y=X=1,N=0,S=Z):A<Z?(B=0<v?1:-1,k=z=0,Y=0,N=X=1,S=A):(0<b?(B=z=0,k=1):(B=z=0,k=-1),Y=X=1,N=0,S=Z),L=z*r,G=B*o,W=k*l,L+=X*m,G+=Y*v,W+=N*b,D=n._rotation00*L+n._rotation01*G+n._rotation02*W,T=n._rotation10*L+n._rotation11*G+n._rotation12*W,V=n._rotation20*L+n._rotation21*G+n._rotation22*W,K=n._rotation00*z+n._rotation01*B+n._rotation02*k,j=n._rotation10*z+n._rotation11*B+n._rotation12*k,R=n._rotation20*z+n._rotation21*B+n._rotation22*k,this.setNormal(t,K,j,R),H=i._positionX+K*-x,P=i._positionY+j*-x,F=i._positionZ+R*-x,O=n._positionX+D,E=n._positionY+T,U=n._positionZ+V,void this.addPoint(t,H,P,F,O,E,U,S,0)}var J,Q,q,$=(J=m-(M=(_+=1e-9)<(M=m<(r-=1e-9)?m:r)?M:_))*J+(Q=v-(y=(h+=1e-9)<(y=v<(o-=1e-9)?v:o)?y:h))*Q+(q=b-(w=(f+=1e-9)<(w=b<(l-=1e-9)?b:l)?w:f))*q;if(!(x*x<=$)){var tt,et,at,it,nt,st,rt,ot,lt;$=Math.sqrt($),tt=n._rotation00*M+n._rotation01*y+n._rotation02*w,et=n._rotation10*M+n._rotation11*y+n._rotation12*w,at=n._rotation20*M+n._rotation21*y+n._rotation22*w;var _t,ht,ft,ut,ct,dt,gt=(it=n._rotation00*J+n._rotation01*Q+n._rotation02*q)*it+(nt=n._rotation10*J+n._rotation11*Q+n._rotation12*q)*nt+(st=n._rotation20*J+n._rotation21*Q+n._rotation22*q)*st;0<gt&&(gt=1/Math.sqrt(gt)),rt=it*gt,ot=nt*gt,lt=st*gt,this.setNormal(t,rt,ot,lt),_t=i._positionX+rt*-x,ht=i._positionY+ot*-x,ft=i._positionZ+lt*-x,ut=n._positionX+tt,ct=n._positionY+et,dt=n._positionZ+at,this.addPoint(t,_t,ht,ft,ut,ct,dt,x-$,0)}},__class__:$i});var tn=function(t){Fi.call(this,t)};(i["oimo.collision.narrowphase.detector.SphereCapsuleDetector"]=tn).__name__=!0,tn.__super__=Fi,tn.prototype=s(Fi.prototype,{detectImpl:function(t,e,a,i,n,s){var r=e,o=a;t.incremental=!1;var l,_,h,f,u,c,d,g,p,m,v,b,I=o._halfHeight,M=r._radius,y=o._radius;l=n._rotation01,_=n._rotation11,h=n._rotation21,f=i._positionX,u=i._positionY,c=i._positionZ,d=n._positionX+l*-I,g=n._positionY+_*-I,p=n._positionZ+h*-I;var w,x,C,A,Z,z,B=I*I*4,k=(f-d)*(m=n._positionX+l*I-d)+(u-g)*(v=n._positionY+_*I-g)+(c-p)*(b=n._positionZ+h*I-p);k<0?k=0:B<k?k=1:k/=B;var S=(A=f-(w=d+m*k))*A+(Z=u-(x=g+v*k))*Z+(z=c-(C=p+b*k))*z;if(!((M+y)*(M+y)<=S)){var X,Y,N,L,G,W,D,T,V,K=Math.sqrt(S);0<K?(X=A*(1/K),Y=Z*(1/K),N=z*(1/K)):(X=1,N=Y=0),this.setNormal(t,X,Y,N),L=f+X*-M,G=u+Y*-M,W=c+N*-M,D=w+X*y,T=x+Y*y,V=C+N*y,this.addPoint(t,L,G,W,D,T,V,M+y-K,0)}},__class__:tn});var en=function(){Fi.call(this,!1)};(i["oimo.collision.narrowphase.detector.SphereSphereDetector"]=en).__name__=!0,en.__super__=Fi,en.prototype=s(Fi.prototype,{detectImpl:function(t,e,a,i,n,s){var r,o,l,_=e,h=a;t.incremental=!1,r=i._positionX-n._positionX,o=i._positionY-n._positionY,l=i._positionZ-n._positionZ;var f=_._radius,u=h._radius,c=r*r+o*o+l*l;if(!((f+u)*(f+u)<=c)){var d,g,p,m,v,b,I,M,y,w=Math.sqrt(c);0<w?(d=r*(1/w),g=o*(1/w),p=l*(1/w)):(d=1,p=g=0),this.setNormal(t,d,g,p),m=i._positionX+d*-f,v=i._positionY+g*-f,b=i._positionZ+p*-f,I=n._positionX+d*u,M=n._positionY+g*u,y=n._positionZ+p*u,this.addPoint(t,m,v,b,I,M,y,f+u-w,0)}},__class__:en});var an=function(){var t=new Array(xn.maxEPAVertices);this._vertices=t,this._center=new Et,this._numVertices=0,this._triangleList=null,this._triangleListLast=null,this._numTriangles=0,this._trianglePool=null,this._vertexPool=null};(i["oimo.collision.narrowphase.detector.gjkepa.EpaPolyhedron"]=an).__name__=!0,an.prototype={_vertices:null,_numVertices:null,_triangleList:null,_triangleListLast:null,_numTriangles:null,_trianglePool:null,_vertexPool:null,_center:null,_status:null,validate:function(){for(var t=this._triangleList;null!=t;){for(var e=t._next,a=0;a<3;){var i=a++;if(t._vertices[i]._tmpEdgeLoopOuterTriangle=null,t._vertices[i]._tmpEdgeLoopNext=null,-1==t._adjacentPairIndex[i])return!(this._status=2);if(null==t._adjacentTriangles[i])return!(this._status=3)}t=e}return!0},findEdgeLoop:function(t,e,a){if(e._tmpDfsId!=t){e._tmpDfsId=t;var i=e.tmp;i.x=a.x,i.y=a.y,i.z=a.z;var n=i,s=e._vertices[0].v,r=n.x-s.x,o=n.y-s.y,l=n.z-s.z;n.x=r,n.y=o,n.z=l;var _=e.tmp,h=e._normal;if(e._tmpDfsVisible=0<_.x*h.x+_.y*h.y+_.z*h.z,e._tmpDfsVisible){for(var f=0;f<3;){var u=f++,c=e._adjacentTriangles[u];if(null!=c){var d=c.tmp;d.x=a.x,d.y=a.y,d.z=a.z;var g=d,p=c._vertices[0].v,m=g.x-p.x,v=g.y-p.y,b=g.z-p.z;g.x=m,g.y=v,g.z=b;var I=c.tmp,M=c._normal;if(c._tmpDfsVisible=0<I.x*M.x+I.y*M.y+I.z*M.z,c._tmpDfsVisible)this.findEdgeLoop(t,c,a);else{var y=e._nextIndex[u],w=e._vertices[u],x=e._vertices[y];w._tmpEdgeLoopNext=x,w._tmpEdgeLoopOuterTriangle=c}}}for(var C=0;C<3;){var A=C++,Z=e._adjacentTriangles[A];if(null!=Z){var z=e._adjacentPairIndex[A];Z._adjacentTriangles[z]=null,Z._adjacentPairIndex[z]=-1,e._adjacentTriangles[A]=null,e._adjacentPairIndex[A]=-1}}this._numTriangles--;var B=e._prev,k=e._next;null!=B&&(B._next=k),null!=k&&(k._prev=B),e==this._triangleList&&(this._triangleList=this._triangleList._next),e==this._triangleListLast&&(this._triangleListLast=this._triangleListLast._prev),e._next=null,e._prev=null,e.removeReferences(),e._next=this._trianglePool,this._trianglePool=e}else this._status=6}},_init:function(t,e,a,i){this._status=0,this._numVertices=4,this._vertices[0]=t,this._vertices[1]=e,this._vertices[2]=a,this._vertices[3]=i;var n=this._center,s=t.v;n.x=s.x,n.y=s.y,n.z=s.z;var r=n,o=e.v,l=r.x+o.x,_=r.y+o.y,h=r.z+o.z;r.x=l,r.y=_,r.z=h;var f=r,u=a.v,c=f.x+u.x,d=f.y+u.y,g=f.z+u.z;f.x=c,f.y=d,f.z=g;var p=f,m=i.v,v=p.x+m.x,b=p.y+m.y,I=p.z+m.z;p.x=v,p.y=b,p.z=I;var M=p,y=.25*M.x,w=.25*M.y,x=.25*M.z;M.x=y,M.y=w,M.z=x;var C=this._trianglePool;null!=C?(this._trianglePool=C._next,C._next=null):C=new nn;var A=C,Z=this._trianglePool;null!=Z?(this._trianglePool=Z._next,Z._next=null):Z=new nn;var z=Z,B=this._trianglePool;null!=B?(this._trianglePool=B._next,B._next=null):B=new nn;var k=B,S=this._trianglePool;null!=S?(this._trianglePool=S._next,S._next=null):S=new nn;var X=S;return A.init(t,e,a,this._center,!0)||(this._status=1),z.init(t,e,i,this._center,!0)||(this._status=1),k.init(t,a,i,this._center,!0)||(this._status=1),X.init(e,a,i,this._center,!0)||(this._status=1),A.setAdjacentTriangle(z)||(this._status=1),A.setAdjacentTriangle(k)||(this._status=1),A.setAdjacentTriangle(X)||(this._status=1),z.setAdjacentTriangle(k)||(this._status=1),z.setAdjacentTriangle(X)||(this._status=1),k.setAdjacentTriangle(X)||(this._status=1),this._numTriangles++,null==this._triangleList?this._triangleList=A:(this._triangleListLast._next=A)._prev=this._triangleListLast,this._triangleListLast=A,this._numTriangles++,null==this._triangleList?this._triangleList=z:(this._triangleListLast._next=z)._prev=this._triangleListLast,this._triangleListLast=z,this._numTriangles++,null==this._triangleList?this._triangleList=k:(this._triangleListLast._next=k)._prev=this._triangleListLast,this._triangleListLast=k,this._numTriangles++,null==this._triangleList?this._triangleList=X:(this._triangleListLast._next=X)._prev=this._triangleListLast,this._triangleListLast=X,0==this._status},_addVertex:function(t,e){this._vertices[this._numVertices++]=t;var a=e._vertices[0];if(this.findEdgeLoop(this._numVertices,e,t.v),0!=this._status)return!1;for(var i=a,n=a,s=null,r=null;;){if(null==i._tmpEdgeLoopNext)return this._dumpAsObjModel(),!(this._status=4);if(null==i._tmpEdgeLoopOuterTriangle)return!(this._status=5);var o=this._trianglePool;null!=o?(this._trianglePool=o._next,o._next=null):o=new nn;var l=o;if(null==r&&(r=l),l.init(i,i._tmpEdgeLoopNext,t,this._center,!1)||(this._status=1),0!=this._status)return!1;if(this._numTriangles++,null==this._triangleList?this._triangleList=l:(this._triangleListLast._next=l)._prev=this._triangleListLast,(this._triangleListLast=l).setAdjacentTriangle(i._tmpEdgeLoopOuterTriangle)||(this._status=1),null!=s&&(l.setAdjacentTriangle(s)||(this._status=1)),s=l,(i=i._tmpEdgeLoopNext)==n)break}return s.setAdjacentTriangle(r)||(this._status=1),0==this._status&&this.validate()},_dumpAsObjModel:function(){},__class__:an};var nn=function(){this._next=null,this._prev=null,this._normal=new Et,this._distanceSq=0,this._tmpDfsId=0,this._tmpDfsVisible=!1;var t=new Array(3);this._vertices=t;var e=new Array(3);this._adjacentTriangles=e;var a=new Array(3);this._adjacentPairIndex=a,this.tmp=new Et;var i=new Array(3);this._nextIndex=i,this._nextIndex[0]=1,this._nextIndex[1]=2,this._nextIndex[2]=0};(i["oimo.collision.narrowphase.detector.gjkepa.EpaTriangle"]=nn).__name__=!0,nn.prototype={_next:null,_prev:null,_vertices:null,_adjacentTriangles:null,_adjacentPairIndex:null,_normal:null,_distanceSq:null,_nextIndex:null,_tmpDfsId:null,_tmpDfsVisible:null,tmp:null,init:function(t,e,a,i,n){var s,r,o,l,_,h,f,u,c;null==n&&(n=!1);var d=t.v;s=d.x,r=d.y,o=d.z;var g=e.v;l=g.x,_=g.y,h=g.z;var p=a.v;f=p.x,u=p.y,c=p.z;var m,v,b,I,M,y,w,x,C,A=i,Z=!1;if((s-A.x)*(w=(v=_-r)*(y=c-o)-(b=h-o)*(M=u-r))+(r-A.y)*(x=b*(I=f-s)-(m=l-s)*y)+(o-A.z)*(C=m*M-v*I)<0)if(n){var z=e;e=a,a=z,w*=-1,x*=-1,C*=-1}else Z=!0;this._vertices[0]=t,this._vertices[1]=e,this._vertices[2]=a;var B=this._normal;B.x=w,B.y=x,B.z=C;var k,S,X,Y,N,L,G,W,D,T,V,K,j,R,H,P,F,O,E=t.v,U=e.v,J=a.v,Q=this.tmp,q=E;k=q.x,S=q.y,X=q.z;var $=U;Y=$.x,N=$.y,L=$.z;var tt,et,at,it=J;G=it.x;var nt,st,rt,ot=Y*((R=(W=it.y)-N)*(at=(T=Y-k)*R-(V=N-S)*(j=G-Y))-(H=(D=it.z)-L)*(et=(K=L-X)*j-T*H))+N*(H*(tt=V*H-K*R)-j*at)+L*(j*et-R*tt),lt=G*((F=S-W)*at-(O=X-D)*et)+W*(O*tt-(P=k-G)*at)+D*(P*et-F*tt),_t=-1;if(k*(V*at-K*et)+S*(K*tt-T*at)+X*(T*et-V*tt)<(rt=st=nt=0)){var ht,ft,ut,ct,dt,gt,pt=E;ht=pt.x,ft=pt.y,ut=pt.z;var mt,vt,bt,It,Mt=U,yt=(mt=(ct=Mt.x)-ht)*ht+(vt=(dt=Mt.y)-ft)*ft+(bt=(gt=Mt.z)-ut)*ut;if((yt=-yt/(mt*mt+vt*vt+bt*bt))<0){var wt=Q;wt.x=ht,wt.y=ft,wt.z=ut,It=1}else if(1<yt){var xt=Q;xt.x=ct,xt.y=dt,xt.z=gt,It=2}else{var Ct,At,Zt;Ct=ht+mt*yt,At=ft+vt*yt,Zt=ut+bt*yt;var zt=Q;zt.x=Ct,zt.y=At,zt.z=Zt,It=3}It,_t=Q.x*Q.x+Q.y*Q.y+Q.z*Q.z;var Bt=Q;nt=Bt.x,st=Bt.y,rt=Bt.z}if(ot<0){var kt,St,Xt,Yt,Nt,Lt,Gt=U;kt=Gt.x,St=Gt.y,Xt=Gt.z;var Wt,Dt,Tt,Vt,Kt=J,jt=(Wt=(Yt=Kt.x)-kt)*kt+(Dt=(Nt=Kt.y)-St)*St+(Tt=(Lt=Kt.z)-Xt)*Xt;if((jt=-jt/(Wt*Wt+Dt*Dt+Tt*Tt))<0){var Rt=Q;Rt.x=kt,Rt.y=St,Rt.z=Xt,Vt=1}else if(1<jt){var Ht=Q;Ht.x=Yt,Ht.y=Nt,Ht.z=Lt,Vt=2}else{var Pt,Ft,Ot;Pt=kt+Wt*jt,Ft=St+Dt*jt,Ot=Xt+Tt*jt;var Et=Q;Et.x=Pt,Et.y=Ft,Et.z=Ot,Vt=3}var Ut=Q.x*Q.x+Q.y*Q.y+Q.z*Q.z;if(_t<0||Ut<_t){Vt<<1,_t=Ut;var Jt=Q;nt=Jt.x,st=Jt.y,rt=Jt.z}}if(lt<0){var Qt,qt,$t,te,ee,ae,ie=E;Qt=ie.x,qt=ie.y,$t=ie.z;var ne,se,re,oe,le=J,_e=(ne=(te=le.x)-Qt)*Qt+(se=(ee=le.y)-qt)*qt+(re=(ae=le.z)-$t)*$t;if((_e=-_e/(ne*ne+se*se+re*re))<0){var he=Q;he.x=Qt,he.y=qt,he.z=$t,oe=1}else if(1<_e){var fe=Q;fe.x=te,fe.y=ee,fe.z=ae,oe=2}else{var ue,ce,de;ue=Qt+ne*_e,ce=qt+se*_e,de=$t+re*_e;var ge=Q;ge.x=ue,ge.y=ce,ge.z=de,oe=3}var pe=Q.x*Q.x+Q.y*Q.y+Q.z*Q.z;if(_t<0||pe<_t){1&oe|(2&oe)<<1,_t=pe;var me=Q;nt=me.x,st=me.y,rt=me.z}}if(0<_t){var ve=Q;ve.x=nt,ve.y=st,ve.z=rt}else{var be=tt*tt+et*et+at*at;0<be&&(be=1/Math.sqrt(be));var Ie=(tt*=be)*tt+(et*=be)*et+(at*=be)*at;nt=tt*(Ie=(k*tt+S*et+X*at)/Ie),st=et*Ie,rt=at*Ie;var Me=Q;Me.x=nt,Me.y=st,Me.z=rt}var ye=this.tmp;return this._distanceSq=ye.x*ye.x+ye.y*ye.y+ye.z*ye.z,this._adjacentTriangles[0]=null,this._adjacentTriangles[1]=null,this._adjacentTriangles[2]=null,this._adjacentPairIndex[0]=-1,this._adjacentPairIndex[1]=-1,this._adjacentPairIndex[2]=-1,!Z},setAdjacentTriangle:function(t){for(var e=0,a=0;a<3;)for(var i=a++,n=0;n<3;){var s=n++,r=this._nextIndex[i],o=this._nextIndex[s];this._vertices[i]==t._vertices[o]&&this._vertices[r]==t._vertices[s]&&(this._adjacentTriangles[i]=t,this._adjacentPairIndex[i]=s,t._adjacentTriangles[s]=this,t._adjacentPairIndex[s]=i,++e)}return 1==e},removeReferences:function(){this._next=null,this._prev=null,this._tmpDfsId=0,this._tmpDfsVisible=!1,this._distanceSq=0,this._vertices[0]=null,this._vertices[1]=null,this._vertices[2]=null,this._adjacentTriangles[0]=null,this._adjacentTriangles[1]=null,this._adjacentTriangles[2]=null,this._adjacentPairIndex[0]=0,this._adjacentPairIndex[1]=0,this._adjacentPairIndex[2]=0},__class__:nn};var sn=function(){this.v=new Et,this.w1=new Et,this.w2=new Et};(i["oimo.collision.narrowphase.detector.gjkepa.EpaVertex"]=sn).__name__=!0,sn.prototype={_next:null,v:null,w1:null,w2:null,_tmpEdgeLoopNext:null,_tmpEdgeLoopOuterTriangle:null,init:function(t,e,a){var i=this.v;i.x=t.x,i.y=t.y,i.z=t.z;var n=this.w1;n.x=e.x,n.y=e.y,n.z=e.z;var s=this.w2;return s.x=a.x,s.y=a.y,s.z=a.z,this._next=null,this._tmpEdgeLoopNext=null,this._tmpEdgeLoopOuterTriangle=null,this},removeReferences:function(){this._next=null,this._tmpEdgeLoopNext=null,this._tmpEdgeLoopOuterTriangle=null},__class__:sn};var uh=function(){this.prevClosestDir=new Et};(i["oimo.collision.narrowphase.detector.gjkepa.GjkCache"]=uh).__name__=!0,uh.prototype={prevClosestDir:null,clear:function(){this.prevClosestDir.zero()},__class__:uh};var rn=function(){this._positionX=0,this._positionY=0,this._positionZ=0,this._rotation00=1,this._rotation01=0,this._rotation02=0,this._rotation10=0,this._rotation11=1,this._rotation12=0,this._rotation20=0,this._rotation21=0,this._rotation22=1};(i["oimo.common.Transform"]=rn).__name__=!0,rn.prototype={_positionX:null,_positionY:null,_positionZ:null,_rotation00:null,_rotation01:null,_rotation02:null,_rotation10:null,_rotation11:null,_rotation12:null,_rotation20:null,_rotation21:null,_rotation22:null,__class__:rn};var xn=function(){};(i["oimo.common.Setting"]=xn).__name__=!0;var on=function(){var t=new Array(4);this.s=t;var e=new Array(4);this.w1=e;var a=new Array(4);this.w2=a;var i=new Array(3);this.baseDirs=i,this.baseDirs[0]=new Et(1,0,0),this.baseDirs[1]=new Et(0,1,0),this.baseDirs[2]=new Et(0,0,1),this.tl1=new Et,this.tl2=new Et,this.rayX=new Et,this.rayR=new Et,this.tempTransform=new rn;for(var n=0;n<4;){var s=n++;this.s[s]=new Et,this.w1[s]=new Et,this.w2[s]=new Et}this.dir=new Et,this.closest=new Et,this.closestPoint1=new Et,this.closestPoint2=new Et,this.polyhedron=new an};(i["oimo.collision.narrowphase.detector.gjkepa.GjkEpa"]=on).__name__=!0,on.prototype={c1:null,c2:null,tf1:null,tf2:null,s:null,simplexSize:null,w1:null,w2:null,tempTransform:null,dir:null,closest:null,baseDirs:null,tl1:null,tl2:null,rayX:null,rayR:null,depth:null,polyhedron:null,closestPoint1:null,closestPoint2:null,distance:null,computeClosestPointsImpl:function(t,e,a,i,n,s){this.c1=t,this.c2=e,this.tf1=a,this.tf2=i;var r=this.s,o=this.w1,l=this.w2,_=this.closest,h=this.dir;if(null!=n?(null==n._gjkCache&&(n._gjkCache=new uh),this.loadCache(n._gjkCache)):h.zero(),h.x*h.x+h.y*h.y+h.z*h.z==0){var f,u,c;f=i._positionX-a._positionX,u=i._positionY-a._positionY,c=i._positionZ-a._positionZ;var d=h;d.x=f,d.y=u,d.z=c,h.x*h.x+h.y*h.y+h.z*h.z<1e-6&&h.init(1,0,0)}this.simplexSize=0,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var g=this.s[this.simplexSize],p=this.w1[this.simplexSize];g.x=p.x,g.y=p.y,g.z=p.z;var m=g,v=this.w2[this.simplexSize],b=m.x-v.x,I=m.y-v.y,M=m.z-v.z;m.x=b,m.y=I,m.z=M,this.simplexSize=1;for(var y=0;y<40;){var w=0;switch(this.simplexSize){case 1:var x=r[0];_.x=x.x,_.y=x.y,_.z=x.z,w=1;break;case 2:var C,A,Z,z,B,k,S=r[0];C=S.x,A=S.y,Z=S.z;var X,Y,N,L=r[1],G=(X=(z=L.x)-C)*C+(Y=(B=L.y)-A)*A+(N=(k=L.z)-Z)*Z;if((G=-G/(X*X+Y*Y+N*N))<0){var W=_;W.x=C,W.y=A,W.z=Z,w=1}else if(1<G){var D=_;D.x=z,D.y=B,D.z=k,w=2}else{var T,V,K;T=C+X*G,V=A+Y*G,K=Z+N*G;var j=_;j.x=T,j.y=V,j.z=K,w=3}break;case 3:var R,H,P,F,O,E,U,J,Q,q,$,tt,et,at,it,nt,st,rt,ot=r[0],lt=r[1],_t=r[2],ht=ot;R=ht.x,H=ht.y,P=ht.z;var ft=lt;F=ft.x,O=ft.y,E=ft.z;var ut,ct,dt,gt=_t;U=gt.x;var pt,mt,vt,bt=F*((at=(J=gt.y)-O)*(dt=(q=F-R)*at-($=O-H)*(et=U-F))-(it=(Q=gt.z)-E)*(ct=(tt=E-P)*et-q*it))+O*(it*(ut=$*it-tt*at)-et*dt)+E*(et*ct-at*ut),It=U*((st=H-J)*dt-(rt=P-Q)*ct)+J*(rt*ut-(nt=R-U)*dt)+Q*(nt*ct-st*ut),Mt=-1,yt=0;if(R*($*dt-tt*ct)+H*(tt*ut-q*dt)+P*(q*ct-$*ut)<(vt=mt=pt=0)){var wt,xt,Ct,At,Zt,zt,Bt=ot;wt=Bt.x,xt=Bt.y,Ct=Bt.z;var kt,St,Xt,Yt,Nt=lt,Lt=(kt=(At=Nt.x)-wt)*wt+(St=(Zt=Nt.y)-xt)*xt+(Xt=(zt=Nt.z)-Ct)*Ct;if((Lt=-Lt/(kt*kt+St*St+Xt*Xt))<0){var Gt=_;Gt.x=wt,Gt.y=xt,Gt.z=Ct,Yt=1}else if(1<Lt){var Wt=_;Wt.x=At,Wt.y=Zt,Wt.z=zt,Yt=2}else{var Dt,Tt,Vt;Dt=wt+kt*Lt,Tt=xt+St*Lt,Vt=Ct+Xt*Lt;var Kt=_;Kt.x=Dt,Kt.y=Tt,Kt.z=Vt,Yt=3}yt=Yt,Mt=_.x*_.x+_.y*_.y+_.z*_.z;var jt=_;pt=jt.x,mt=jt.y,vt=jt.z}if(bt<0){var Rt,Ht,Pt,Ft,Ot,Et,Ut=lt;Rt=Ut.x,Ht=Ut.y,Pt=Ut.z;var Jt,Qt,qt,$t,te=_t,ee=(Jt=(Ft=te.x)-Rt)*Rt+(Qt=(Ot=te.y)-Ht)*Ht+(qt=(Et=te.z)-Pt)*Pt;if((ee=-ee/(Jt*Jt+Qt*Qt+qt*qt))<0){var ae=_;ae.x=Rt,ae.y=Ht,ae.z=Pt,$t=1}else if(1<ee){var ie=_;ie.x=Ft,ie.y=Ot,ie.z=Et,$t=2}else{var ne,se,re;ne=Rt+Jt*ee,se=Ht+Qt*ee,re=Pt+qt*ee;var oe=_;oe.x=ne,oe.y=se,oe.z=re,$t=3}var le=_.x*_.x+_.y*_.y+_.z*_.z;if(Mt<0||le<Mt){yt=$t<<1,Mt=le;var _e=_;pt=_e.x,mt=_e.y,vt=_e.z}}if(It<0){var he,fe,ue,ce,de,ge,pe=ot;he=pe.x,fe=pe.y,ue=pe.z;var me,ve,be,Ie,Me=_t,ye=(me=(ce=Me.x)-he)*he+(ve=(de=Me.y)-fe)*fe+(be=(ge=Me.z)-ue)*ue;if((ye=-ye/(me*me+ve*ve+be*be))<0){var we=_;we.x=he,we.y=fe,we.z=ue,Ie=1}else if(1<ye){var xe=_;xe.x=ce,xe.y=de,xe.z=ge,Ie=2}else{var Ce,Ae,Ze;Ce=he+me*ye,Ae=fe+ve*ye,Ze=ue+be*ye;var ze=_;ze.x=Ce,ze.y=Ae,ze.z=Ze,Ie=3}var Be=_.x*_.x+_.y*_.y+_.z*_.z;if(Mt<0||Be<Mt){yt=1&Ie|(2&Ie)<<1,Mt=Be;var ke=_;pt=ke.x,mt=ke.y,vt=ke.z}}if(0<Mt){var Se=_;Se.x=pt,Se.y=mt,Se.z=vt,w=yt}else{var Xe=ut*ut+ct*ct+dt*dt;0<Xe&&(Xe=1/Math.sqrt(Xe));var Ye=(ut*=Xe)*ut+(ct*=Xe)*ct+(dt*=Xe)*dt;pt=ut*(Ye=(R*ut+H*ct+P*dt)/Ye),mt=ct*Ye,vt=dt*Ye;var Ne=_;Ne.x=pt,Ne.y=mt,Ne.z=vt,w=7}break;case 4:var Le,Ge,We,De,Te,Ve,Ke,je,Re,He,Pe,Fe,Oe,Ee,Ue,Je,Qe,qe,$e,ta,ea,aa,ia,na,sa,ra,oa,la=r[0],_a=r[1],ha=r[2],fa=r[3],ua=la;Le=ua.x,Ge=ua.y,We=ua.z;var ca=_a;De=ca.x,Te=ca.y,Ve=ca.z;var da=ha;Ke=da.x,je=da.y,Re=da.z;var ga,pa,ma,va=fa;(He=va.x)-Ke,(Pe=va.y)-je,(Fe=va.z)-Re;var ba,Ia,Ma,ya=0<(Oe=De-Le)*(ga=(ra=Pe-Te)*(na=Re-Ve)-(oa=Fe-Ve)*(ia=je-Te))+(Ee=Te-Ge)*(pa=oa*(aa=Ke-De)-(sa=He-De)*na)+(Ue=Ve-We)*(ma=sa*ia-ra*aa)?1:-1,wa=Le*((Qe=je-Ge)*(ea=Fe-We)-(qe=Re-We)*(ta=Pe-Ge))+Ge*(qe*($e=He-Le)-(Je=Ke-Le)*ea)+We*(Je*ta-Qe*$e),xa=Le*(ta*Ue-ea*Ee)+Ge*(ea*Oe-$e*Ue)+We*($e*Ee-ta*Oe),Ca=De*ga+Te*pa+Ve*ma,Aa=-1,Za=0;if((Le*(Ee*qe-Ue*Qe)+Ge*(Ue*Je-Oe*qe)+We*(Oe*Qe-Ee*Je))*ya<(Ma=Ia=ba=0)){var za,Ba,ka,Sa,Xa,Ya,Na,La,Ga,Wa,Da,Ta,Va,Ka,ja,Ra,Ha,Pa,Fa=la;za=Fa.x,Ba=Fa.y,ka=Fa.z;var Oa=_a;Sa=Oa.x,Xa=Oa.y,Ya=Oa.z;var Ea,Ua,Ja,Qa=ha;Na=Qa.x;var qa,$a,ti,ei,ai=Sa*((Ka=(La=Qa.y)-Xa)*(Ja=(Wa=Sa-za)*Ka-(Da=Xa-Ba)*(Va=Na-Sa))-(ja=(Ga=Qa.z)-Ya)*(Ua=(Ta=Ya-ka)*Va-Wa*ja))+Xa*(ja*(Ea=Da*ja-Ta*Ka)-Va*Ja)+Ya*(Va*Ua-Ka*Ea),ii=Na*((Ha=Ba-La)*Ja-(Pa=ka-Ga)*Ua)+La*(Pa*Ea-(Ra=za-Na)*Ja)+Ga*(Ra*Ua-Ha*Ea),ni=-1,si=0;if(za*(Da*Ja-Ta*Ua)+Ba*(Ta*Ea-Wa*Ja)+ka*(Wa*Ua-Da*Ea)<(ti=$a=qa=0)){var ri,oi,li,_i,hi,fi,ui=la;ri=ui.x,oi=ui.y,li=ui.z;var ci,di,gi,pi,mi=_a,vi=(ci=(_i=mi.x)-ri)*ri+(di=(hi=mi.y)-oi)*oi+(gi=(fi=mi.z)-li)*li;if((vi=-vi/(ci*ci+di*di+gi*gi))<0){var bi=_;bi.x=ri,bi.y=oi,bi.z=li,pi=1}else if(1<vi){var Ii=_;Ii.x=_i,Ii.y=hi,Ii.z=fi,pi=2}else{var Mi,yi,wi;Mi=ri+ci*vi,yi=oi+di*vi,wi=li+gi*vi;var xi=_;xi.x=Mi,xi.y=yi,xi.z=wi,pi=3}si=pi,ni=_.x*_.x+_.y*_.y+_.z*_.z;var Ci=_;qa=Ci.x,$a=Ci.y,ti=Ci.z}if(ai<0){var Ai,Zi,zi,Bi,ki,Si,Xi=_a;Ai=Xi.x,Zi=Xi.y,zi=Xi.z;var Yi,Ni,Li,Gi,Wi=ha,Di=(Yi=(Bi=Wi.x)-Ai)*Ai+(Ni=(ki=Wi.y)-Zi)*Zi+(Li=(Si=Wi.z)-zi)*zi;if((Di=-Di/(Yi*Yi+Ni*Ni+Li*Li))<0){var Ti=_;Ti.x=Ai,Ti.y=Zi,Ti.z=zi,Gi=1}else if(1<Di){var Vi=_;Vi.x=Bi,Vi.y=ki,Vi.z=Si,Gi=2}else{var Ki,ji,Ri;Ki=Ai+Yi*Di,ji=Zi+Ni*Di,Ri=zi+Li*Di;var Hi=_;Hi.x=Ki,Hi.y=ji,Hi.z=Ri,Gi=3}var Pi=_.x*_.x+_.y*_.y+_.z*_.z;if(ni<0||Pi<ni){si=Gi<<1,ni=Pi;var Fi=_;qa=Fi.x,$a=Fi.y,ti=Fi.z}}if(ii<0){var Oi,Ei,Ui,Ji,Qi,qi,$i=la;Oi=$i.x,Ei=$i.y,Ui=$i.z;var tn,en,an,nn,sn=ha,rn=(tn=(Ji=sn.x)-Oi)*Oi+(en=(Qi=sn.y)-Ei)*Ei+(an=(qi=sn.z)-Ui)*Ui;if((rn=-rn/(tn*tn+en*en+an*an))<0){var on=_;on.x=Oi,on.y=Ei,on.z=Ui,nn=1}else if(1<rn){var ln=_;ln.x=Ji,ln.y=Qi,ln.z=qi,nn=2}else{var _n,hn,fn;_n=Oi+tn*rn,hn=Ei+en*rn,fn=Ui+an*rn;var un=_;un.x=_n,un.y=hn,un.z=fn,nn=3}var cn=_.x*_.x+_.y*_.y+_.z*_.z;if(ni<0||cn<ni){si=1&nn|(2&nn)<<1,ni=cn;var dn=_;qa=dn.x,$a=dn.y,ti=dn.z}}if(0<ni){var gn=_;gn.x=qa,gn.y=$a,gn.z=ti,ei=si}else{var pn=Ea*Ea+Ua*Ua+Ja*Ja;0<pn&&(pn=1/Math.sqrt(pn));var mn=(Ea*=pn)*Ea+(Ua*=pn)*Ua+(Ja*=pn)*Ja;qa=Ea*(mn=(za*Ea+Ba*Ua+ka*Ja)/mn),$a=Ua*mn,ti=Ja*mn;var vn=_;vn.x=qa,vn.y=$a,vn.z=ti,ei=7}Za=ei,Aa=_.x*_.x+_.y*_.y+_.z*_.z;var bn=_;ba=bn.x,Ia=bn.y,Ma=bn.z}if(wa*ya<0){var In,Mn,yn,wn,xn,Cn,An,Zn,zn,Bn,kn,Sn,Xn,Yn,Nn,Ln,Gn,Wn,Dn=la;In=Dn.x,Mn=Dn.y,yn=Dn.z;var Tn=ha;wn=Tn.x,xn=Tn.y,Cn=Tn.z;var Vn,Kn,jn,Rn=fa;An=Rn.x;var Hn,Pn,Fn,On,En=wn*((Yn=(Zn=Rn.y)-xn)*(jn=(Bn=wn-In)*Yn-(kn=xn-Mn)*(Xn=An-wn))-(Nn=(zn=Rn.z)-Cn)*(Kn=(Sn=Cn-yn)*Xn-Bn*Nn))+xn*(Nn*(Vn=kn*Nn-Sn*Yn)-Xn*jn)+Cn*(Xn*Kn-Yn*Vn),Un=An*((Gn=Mn-Zn)*jn-(Wn=yn-zn)*Kn)+Zn*(Wn*Vn-(Ln=In-An)*jn)+zn*(Ln*Kn-Gn*Vn),Jn=-1,Qn=0;if(In*(kn*jn-Sn*Kn)+Mn*(Sn*Vn-Bn*jn)+yn*(Bn*Kn-kn*Vn)<(Fn=Pn=Hn=0)){var qn,$n,ts,es,as,is,ns=la;qn=ns.x,$n=ns.y,ts=ns.z;var ss,rs,os,ls,_s=ha,hs=(ss=(es=_s.x)-qn)*qn+(rs=(as=_s.y)-$n)*$n+(os=(is=_s.z)-ts)*ts;if((hs=-hs/(ss*ss+rs*rs+os*os))<0){var fs=_;fs.x=qn,fs.y=$n,fs.z=ts,ls=1}else if(1<hs){var us=_;us.x=es,us.y=as,us.z=is,ls=2}else{var cs,ds,gs;cs=qn+ss*hs,ds=$n+rs*hs,gs=ts+os*hs;var ps=_;ps.x=cs,ps.y=ds,ps.z=gs,ls=3}Qn=ls,Jn=_.x*_.x+_.y*_.y+_.z*_.z;var ms=_;Hn=ms.x,Pn=ms.y,Fn=ms.z}if(En<0){var vs,bs,Is,Ms,ys,ws,xs=ha;vs=xs.x,bs=xs.y,Is=xs.z;var Cs,As,Zs,zs,Bs=fa,ks=(Cs=(Ms=Bs.x)-vs)*vs+(As=(ys=Bs.y)-bs)*bs+(Zs=(ws=Bs.z)-Is)*Is;if((ks=-ks/(Cs*Cs+As*As+Zs*Zs))<0){var Ss=_;Ss.x=vs,Ss.y=bs,Ss.z=Is,zs=1}else if(1<ks){var Xs=_;Xs.x=Ms,Xs.y=ys,Xs.z=ws,zs=2}else{var Ys,Ns,Ls;Ys=vs+Cs*ks,Ns=bs+As*ks,Ls=Is+Zs*ks;var Gs=_;Gs.x=Ys,Gs.y=Ns,Gs.z=Ls,zs=3}var Ws=_.x*_.x+_.y*_.y+_.z*_.z;if(Jn<0||Ws<Jn){Qn=zs<<1,Jn=Ws;var Ds=_;Hn=Ds.x,Pn=Ds.y,Fn=Ds.z}}if(Un<0){var Ts,Vs,Ks,js,Rs,Hs,Ps=la;Ts=Ps.x,Vs=Ps.y,Ks=Ps.z;var Fs,Os,Es,Us,Js=fa,Qs=(Fs=(js=Js.x)-Ts)*Ts+(Os=(Rs=Js.y)-Vs)*Vs+(Es=(Hs=Js.z)-Ks)*Ks;if((Qs=-Qs/(Fs*Fs+Os*Os+Es*Es))<0){var qs=_;qs.x=Ts,qs.y=Vs,qs.z=Ks,Us=1}else if(1<Qs){var $s=_;$s.x=js,$s.y=Rs,$s.z=Hs,Us=2}else{var tr,er,ar;tr=Ts+Fs*Qs,er=Vs+Os*Qs,ar=Ks+Es*Qs;var ir=_;ir.x=tr,ir.y=er,ir.z=ar,Us=3}var nr=_.x*_.x+_.y*_.y+_.z*_.z;if(Jn<0||nr<Jn){Qn=1&Us|(2&Us)<<1,Jn=nr;var sr=_;Hn=sr.x,Pn=sr.y,Fn=sr.z}}if(0<Jn){var rr=_;rr.x=Hn,rr.y=Pn,rr.z=Fn,On=Qn}else{var or=Vn*Vn+Kn*Kn+jn*jn;0<or&&(or=1/Math.sqrt(or));var lr=(Vn*=or)*Vn+(Kn*=or)*Kn+(jn*=or)*jn;Hn=Vn*(lr=(In*Vn+Mn*Kn+yn*jn)/lr),Pn=Kn*lr,Fn=jn*lr;var _r=_;_r.x=Hn,_r.y=Pn,_r.z=Fn,On=7}var hr=_.x*_.x+_.y*_.y+_.z*_.z;if(Aa<0||hr<Aa){Za=1&On|(6&On)<<1,Aa=hr;var fr=_;ba=fr.x,Ia=fr.y,Ma=fr.z}}if(xa*ya<0){var ur,cr,dr,gr,pr,mr,vr,br,Ir,Mr,yr,wr,xr,Cr,Ar,Zr,zr,Br,kr=la;ur=kr.x,cr=kr.y,dr=kr.z;var Sr=_a;gr=Sr.x,pr=Sr.y,mr=Sr.z;var Xr,Yr,Nr,Lr=fa;vr=Lr.x;var Gr,Wr,Dr,Tr,Vr=gr*((Cr=(br=Lr.y)-pr)*(Nr=(Mr=gr-ur)*Cr-(yr=pr-cr)*(xr=vr-gr))-(Ar=(Ir=Lr.z)-mr)*(Yr=(wr=mr-dr)*xr-Mr*Ar))+pr*(Ar*(Xr=yr*Ar-wr*Cr)-xr*Nr)+mr*(xr*Yr-Cr*Xr),Kr=vr*((zr=cr-br)*Nr-(Br=dr-Ir)*Yr)+br*(Br*Xr-(Zr=ur-vr)*Nr)+Ir*(Zr*Yr-zr*Xr),jr=-1,Rr=0;if(ur*(yr*Nr-wr*Yr)+cr*(wr*Xr-Mr*Nr)+dr*(Mr*Yr-yr*Xr)<(Dr=Wr=Gr=0)){var Hr,Pr,Fr,Or,Er,Ur,Jr=la;Hr=Jr.x,Pr=Jr.y,Fr=Jr.z;var Qr,qr,$r,to,eo=_a,ao=(Qr=(Or=eo.x)-Hr)*Hr+(qr=(Er=eo.y)-Pr)*Pr+($r=(Ur=eo.z)-Fr)*Fr;if((ao=-ao/(Qr*Qr+qr*qr+$r*$r))<0){var io=_;io.x=Hr,io.y=Pr,io.z=Fr,to=1}else if(1<ao){var no=_;no.x=Or,no.y=Er,no.z=Ur,to=2}else{var so,ro,oo;so=Hr+Qr*ao,ro=Pr+qr*ao,oo=Fr+$r*ao;var lo=_;lo.x=so,lo.y=ro,lo.z=oo,to=3}Rr=to,jr=_.x*_.x+_.y*_.y+_.z*_.z;var _o=_;Gr=_o.x,Wr=_o.y,Dr=_o.z}if(Vr<0){var ho,fo,uo,co,go,po,mo=_a;ho=mo.x,fo=mo.y,uo=mo.z;var vo,bo,Io,Mo,yo=fa,wo=(vo=(co=yo.x)-ho)*ho+(bo=(go=yo.y)-fo)*fo+(Io=(po=yo.z)-uo)*uo;if((wo=-wo/(vo*vo+bo*bo+Io*Io))<0){var xo=_;xo.x=ho,xo.y=fo,xo.z=uo,Mo=1}else if(1<wo){var Co=_;Co.x=co,Co.y=go,Co.z=po,Mo=2}else{var Ao,Zo,zo;Ao=ho+vo*wo,Zo=fo+bo*wo,zo=uo+Io*wo;var Bo=_;Bo.x=Ao,Bo.y=Zo,Bo.z=zo,Mo=3}var ko=_.x*_.x+_.y*_.y+_.z*_.z;if(jr<0||ko<jr){Rr=Mo<<1,jr=ko;var So=_;Gr=So.x,Wr=So.y,Dr=So.z}}if(Kr<0){var Xo,Yo,No,Lo,Go,Wo,Do=la;Xo=Do.x,Yo=Do.y,No=Do.z;var To,Vo,Ko,jo,Ro=fa,Ho=(To=(Lo=Ro.x)-Xo)*Xo+(Vo=(Go=Ro.y)-Yo)*Yo+(Ko=(Wo=Ro.z)-No)*No;if((Ho=-Ho/(To*To+Vo*Vo+Ko*Ko))<0){var Po=_;Po.x=Xo,Po.y=Yo,Po.z=No,jo=1}else if(1<Ho){var Fo=_;Fo.x=Lo,Fo.y=Go,Fo.z=Wo,jo=2}else{var Oo,Eo,Uo;Oo=Xo+To*Ho,Eo=Yo+Vo*Ho,Uo=No+Ko*Ho;var Jo=_;Jo.x=Oo,Jo.y=Eo,Jo.z=Uo,jo=3}var Qo=_.x*_.x+_.y*_.y+_.z*_.z;if(jr<0||Qo<jr){Rr=1&jo|(2&jo)<<1,jr=Qo;var qo=_;Gr=qo.x,Wr=qo.y,Dr=qo.z}}if(0<jr){var $o=_;$o.x=Gr,$o.y=Wr,$o.z=Dr,Tr=Rr}else{var tl=Xr*Xr+Yr*Yr+Nr*Nr;0<tl&&(tl=1/Math.sqrt(tl));var el=(Xr*=tl)*Xr+(Yr*=tl)*Yr+(Nr*=tl)*Nr;Gr=Xr*(el=(ur*Xr+cr*Yr+dr*Nr)/el),Wr=Yr*el,Dr=Nr*el;var al=_;al.x=Gr,al.y=Wr,al.z=Dr,Tr=7}var il=_.x*_.x+_.y*_.y+_.z*_.z;if(Aa<0||il<Aa){Za=3&Tr|(4&Tr)<<1,Aa=il;var nl=_;ba=nl.x,Ia=nl.y,Ma=nl.z}}if(Ca*ya<0){var sl,rl,ol,ll,_l,hl,fl,ul,cl,dl,gl,pl,ml,vl,bl,Il,Ml,yl,wl=_a;sl=wl.x,rl=wl.y,ol=wl.z;var xl=ha;ll=xl.x,_l=xl.y,hl=xl.z;var Cl,Al,Zl,zl=fa;fl=zl.x;var Bl,kl,Sl,Xl,Yl=ll*((vl=(ul=zl.y)-_l)*(Zl=(dl=ll-sl)*vl-(gl=_l-rl)*(ml=fl-ll))-(bl=(cl=zl.z)-hl)*(Al=(pl=hl-ol)*ml-dl*bl))+_l*(bl*(Cl=gl*bl-pl*vl)-ml*Zl)+hl*(ml*Al-vl*Cl),Nl=fl*((Ml=rl-ul)*Zl-(yl=ol-cl)*Al)+ul*(yl*Cl-(Il=sl-fl)*Zl)+cl*(Il*Al-Ml*Cl),Ll=-1,Gl=0;if(sl*(gl*Zl-pl*Al)+rl*(pl*Cl-dl*Zl)+ol*(dl*Al-gl*Cl)<(Sl=kl=Bl=0)){var Wl,Dl,Tl,Vl,Kl,jl,Rl=_a;Wl=Rl.x,Dl=Rl.y,Tl=Rl.z;var Hl,Pl,Fl,Ol,El=ha,Ul=(Hl=(Vl=El.x)-Wl)*Wl+(Pl=(Kl=El.y)-Dl)*Dl+(Fl=(jl=El.z)-Tl)*Tl;if((Ul=-Ul/(Hl*Hl+Pl*Pl+Fl*Fl))<0){var Jl=_;Jl.x=Wl,Jl.y=Dl,Jl.z=Tl,Ol=1}else if(1<Ul){var Ql=_;Ql.x=Vl,Ql.y=Kl,Ql.z=jl,Ol=2}else{var ql,$l,t_;ql=Wl+Hl*Ul,$l=Dl+Pl*Ul,t_=Tl+Fl*Ul;var e_=_;e_.x=ql,e_.y=$l,e_.z=t_,Ol=3}Gl=Ol,Ll=_.x*_.x+_.y*_.y+_.z*_.z;var a_=_;Bl=a_.x,kl=a_.y,Sl=a_.z}if(Yl<0){var i_,n_,s_,r_,o_,l_,__=ha;i_=__.x,n_=__.y,s_=__.z;var h_,f_,u_,c_,d_=fa,g_=(h_=(r_=d_.x)-i_)*i_+(f_=(o_=d_.y)-n_)*n_+(u_=(l_=d_.z)-s_)*s_;if((g_=-g_/(h_*h_+f_*f_+u_*u_))<0){var p_=_;p_.x=i_,p_.y=n_,p_.z=s_,c_=1}else if(1<g_){var m_=_;m_.x=r_,m_.y=o_,m_.z=l_,c_=2}else{var v_,b_,I_;v_=i_+h_*g_,b_=n_+f_*g_,I_=s_+u_*g_;var M_=_;M_.x=v_,M_.y=b_,M_.z=I_,c_=3}var y_=_.x*_.x+_.y*_.y+_.z*_.z;if(Ll<0||y_<Ll){Gl=c_<<1,Ll=y_;var w_=_;Bl=w_.x,kl=w_.y,Sl=w_.z}}if(Nl<0){var x_,C_,A_,Z_,z_,B_,k_=_a;x_=k_.x,C_=k_.y,A_=k_.z;var S_,X_,Y_,N_,L_=fa,G_=(S_=(Z_=L_.x)-x_)*x_+(X_=(z_=L_.y)-C_)*C_+(Y_=(B_=L_.z)-A_)*A_;if((G_=-G_/(S_*S_+X_*X_+Y_*Y_))<0){var W_=_;W_.x=x_,W_.y=C_,W_.z=A_,N_=1}else if(1<G_){var D_=_;D_.x=Z_,D_.y=z_,D_.z=B_,N_=2}else{var T_,V_,K_;T_=x_+S_*G_,V_=C_+X_*G_,K_=A_+Y_*G_;var j_=_;j_.x=T_,j_.y=V_,j_.z=K_,N_=3}var R_=_.x*_.x+_.y*_.y+_.z*_.z;if(Ll<0||R_<Ll){Gl=1&N_|(2&N_)<<1,Ll=R_;var H_=_;Bl=H_.x,kl=H_.y,Sl=H_.z}}if(0<Ll){var P_=_;P_.x=Bl,P_.y=kl,P_.z=Sl,Xl=Gl}else{var F_=Cl*Cl+Al*Al+Zl*Zl;0<F_&&(F_=1/Math.sqrt(F_));var O_=(Cl*=F_)*Cl+(Al*=F_)*Al+(Zl*=F_)*Zl;Bl=Cl*(O_=(sl*Cl+rl*Al+ol*Zl)/O_),kl=Al*O_,Sl=Zl*O_;var E_=_;E_.x=Bl,E_.y=kl,E_.z=Sl,Xl=7}var U_=_.x*_.x+_.y*_.y+_.z*_.z;if(Aa<0||U_<Aa){Za=Xl<<1,Aa=U_;var J_=_;ba=J_.x,Ia=J_.y,Ma=J_.z}}if(0<Aa){var Q_=_;Q_.x=ba,Q_.y=Ia,Q_.z=Ma,w=Za}else _.zero(),w=15}if(_.x*_.x+_.y*_.y+_.z*_.z<1e-8){if(!s)return this.distance=0;switch(this.simplexSize){case 1:this.pointToTetrahedron();break;case 2:this.lineToTetrahedron();break;case 3:this.triangleToTetrahedron()}if(4==this.simplexSize){var q_=this.computeDepth(t,e,a,i,r,o,l);return 0!=q_?(this.distance=0,q_):(this.distance=-this.depth,0)}return this.distance=0,1}this.shrinkSimplex(w),h.x=_.x,h.y=_.y,h.z=_.z;var $_=h,th=-$_.x,eh=-$_.y,ah=-$_.z;$_.x=th,$_.y=eh,$_.z=ah,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var ih=this.s[this.simplexSize],nh=this.w1[this.simplexSize];ih.x=nh.x,ih.y=nh.y,ih.z=nh.z;var sh=ih,rh=this.w2[this.simplexSize],oh=sh.x-rh.x,lh=sh.y-rh.y,_h=sh.z-rh.z;if(sh.x=oh,sh.y=lh,sh.z=_h,h.x*h.x+h.y*h.y+h.z*h.z<1e-8)throw new Error("!?");var hh=_.x*h.x+_.y*h.y+_.z*h.z,fh=r[this.simplexSize];if(fh.x*h.x+fh.y*h.y+fh.z*h.z-hh<1e-8)return this.interpolateClosestPoints(),this.distance=Math.sqrt(_.x*_.x+_.y*_.y+_.z*_.z),null!=n&&null!=n._gjkCache&&this.saveCache(n._gjkCache),0;this.simplexSize++,++y}return 2},interpolateClosestPoints:function(){switch(this.simplexSize){case 1:var t=this.closestPoint1,e=this.w1[0];t.x=e.x,t.y=e.y,t.z=e.z;var a=this.closestPoint2,i=this.w2[0];a.x=i.x,a.y=i.y,a.z=i.z;break;case 2:var n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b,I,M,y,w,x,C=this.closest;n=C.x,s=C.y,r=C.z;var A=this.s[0];o=A.x,l=A.y,_=A.z;var Z=this.w1[0];h=Z.x,f=Z.y,u=Z.z;var z=this.w2[0];c=z.x,d=z.y,g=z.z;var B=this.s[1];p=B.x,m=B.y,v=B.z;var k=this.w1[1];b=k.x,I=k.y,M=k.z;var S=this.w2[1];y=S.x,w=S.y,x=S.z;var X=this.s[2];X.x,X.y,X.z;var Y=this.w1[2];Y.x,Y.y,Y.z;var N,L,G,W=this.w2[2];W.x,W.y,W.z;var D=(N=p-o)*N+(L=m-l)*L+(G=v-_)*G;0!=D&&(D=1/D);var T,V,K,j,R,H,P=((n-o)*N+(s-l)*L+(r-_)*G)*D;T=h+(b-h)*P,V=f+(I-f)*P,K=u+(M-u)*P,j=c+(y-c)*P,R=d+(w-d)*P,H=g+(x-g)*P;var F=this.closestPoint1;F.x=T,F.y=V,F.z=K;var O=this.closestPoint2;O.x=j,O.y=R,O.z=H;break;case 3:var E,U,J,Q,q,$,tt,et,at,it,nt,st,rt,ot,lt,_t,ht,ft,ut,ct,dt,gt,pt,mt,vt,bt,It,Mt=this.closest;E=Mt.x,U=Mt.y,J=Mt.z;var yt=this.s[0];Q=yt.x,q=yt.y,$=yt.z;var wt=this.w1[0];tt=wt.x,et=wt.y,at=wt.z;var xt=this.w2[0];it=xt.x,nt=xt.y,st=xt.z;var Ct=this.s[1];rt=Ct.x,ot=Ct.y,lt=Ct.z;var At=this.w1[1];_t=At.x,ht=At.y,ft=At.z;var Zt=this.w2[1];ut=Zt.x,ct=Zt.y,dt=Zt.z;var zt=this.s[2];gt=zt.x,pt=zt.y,mt=zt.z;var Bt=this.w1[2];vt=Bt.x,bt=Bt.y,It=Bt.z;var kt,St,Xt,Yt,Nt,Lt,Gt,Wt,Dt,Tt=this.w2[2],Vt=(kt=rt-Q)*kt+(St=ot-q)*St+(Xt=lt-$)*Xt,Kt=kt*(Yt=gt-Q)+St*(Nt=pt-q)+Xt*(Lt=mt-$),jt=Yt*Yt+Nt*Nt+Lt*Lt,Rt=kt*(Gt=E-Q)+St*(Wt=U-q)+Xt*(Dt=J-$),Ht=Yt*Gt+Nt*Wt+Lt*Dt,Pt=Vt*jt-Kt*Kt;0!=Pt&&(Pt=1/Pt);var Ft,Ot,Et,Ut,Jt,Qt,qt=(Rt*jt-Ht*Kt)*Pt,$t=(-Rt*Kt+Ht*Vt)*Pt;Ft=tt+(_t-tt)*qt,Ot=et+(ht-et)*qt,Et=at+(ft-at)*qt,Ft+=(vt-tt)*$t,Ot+=(bt-et)*$t,Et+=(It-at)*$t,Ut=it+(ut-it)*qt,Jt=nt+(ct-nt)*qt,Qt=st+(dt-st)*qt,Ut+=(Tt.x-it)*$t,Jt+=(Tt.y-nt)*$t,Qt+=(Tt.z-st)*$t;var te=this.closestPoint1;te.x=Ft,te.y=Ot,te.z=Et;var ee=this.closestPoint2;ee.x=Ut,ee.y=Jt,ee.z=Qt;break;default:throw new Error("!?")}},loadCache:function(t){var e=this.dir,a=t.prevClosestDir;e.x=a.x,e.y=a.y,e.z=a.z},saveCache:function(t){var e=t.prevClosestDir,a=this.closest;e.x=a.x,e.y=a.y,e.z=a.z;var i=e,n=-i.x,s=-i.y,r=-i.z;i.x=n,i.y=s,i.z=r},shrinkSimplex:function(t){switch(this.simplexSize=t,this.simplexSize=(5&this.simplexSize)+(this.simplexSize>>1&5),this.simplexSize=(3&this.simplexSize)+(this.simplexSize>>2&3),t){case 2:var e=this.s[0],a=this.s[1];e.x=a.x,e.y=a.y,e.z=a.z;var i=this.w1[0],n=this.w1[1];i.x=n.x,i.y=n.y,i.z=n.z;var s=this.w2[0],r=this.w2[1];s.x=r.x,s.y=r.y,s.z=r.z;break;case 4:var o=this.s[0],l=this.s[2];o.x=l.x,o.y=l.y,o.z=l.z;var _=this.w1[0],h=this.w1[2];_.x=h.x,_.y=h.y,_.z=h.z;var f=this.w2[0],u=this.w2[2];f.x=u.x,f.y=u.y,f.z=u.z;break;case 5:var c=this.s[1],d=this.s[2];c.x=d.x,c.y=d.y,c.z=d.z;var g=this.w1[1],p=this.w1[2];g.x=p.x,g.y=p.y,g.z=p.z;var m=this.w2[1],v=this.w2[2];m.x=v.x,m.y=v.y,m.z=v.z;break;case 6:var b=this.s[0],I=this.s[2];b.x=I.x,b.y=I.y,b.z=I.z;var M=this.w1[0],y=this.w1[2];M.x=y.x,M.y=y.y,M.z=y.z;var w=this.w2[0],x=this.w2[2];w.x=x.x,w.y=x.y,w.z=x.z;break;case 8:var C=this.s[0],A=this.s[3];C.x=A.x,C.y=A.y,C.z=A.z;var Z=this.w1[0],z=this.w1[3];Z.x=z.x,Z.y=z.y,Z.z=z.z;var B=this.w2[0],k=this.w2[3];B.x=k.x,B.y=k.y,B.z=k.z;break;case 9:var S=this.s[1],X=this.s[3];S.x=X.x,S.y=X.y,S.z=X.z;var Y=this.w1[1],N=this.w1[3];Y.x=N.x,Y.y=N.y,Y.z=N.z;var L=this.w2[1],G=this.w2[3];L.x=G.x,L.y=G.y,L.z=G.z;break;case 10:var W=this.s[0],D=this.s[3];W.x=D.x,W.y=D.y,W.z=D.z;var T=this.w1[0],V=this.w1[3];T.x=V.x,T.y=V.y,T.z=V.z;var K=this.w2[0],j=this.w2[3];K.x=j.x,K.y=j.y,K.z=j.z;break;case 11:var R=this.s[2],H=this.s[3];R.x=H.x,R.y=H.y,R.z=H.z;var P=this.w1[2],F=this.w1[3];P.x=F.x,P.y=F.y,P.z=F.z;var O=this.w2[2],E=this.w2[3];O.x=E.x,O.y=E.y,O.z=E.z;break;case 12:var U=this.s[0],J=this.s[2];U.x=J.x,U.y=J.y,U.z=J.z;var Q=this.w1[0],q=this.w1[2];Q.x=q.x,Q.y=q.y,Q.z=q.z;var $=this.w2[0],tt=this.w2[2];$.x=tt.x,$.y=tt.y,$.z=tt.z;var et=this.s[1],at=this.s[3];et.x=at.x,et.y=at.y,et.z=at.z;var it=this.w1[1],nt=this.w1[3];it.x=nt.x,it.y=nt.y,it.z=nt.z;var st=this.w2[1],rt=this.w2[3];st.x=rt.x,st.y=rt.y,st.z=rt.z;break;case 13:var ot=this.s[1],lt=this.s[3];ot.x=lt.x,ot.y=lt.y,ot.z=lt.z;var _t=this.w1[1],ht=this.w1[3];_t.x=ht.x,_t.y=ht.y,_t.z=ht.z;var ft=this.w2[1],ut=this.w2[3];ft.x=ut.x,ft.y=ut.y,ft.z=ut.z;break;case 14:var ct=this.s[0],dt=this.s[3];ct.x=dt.x,ct.y=dt.y,ct.z=dt.z;var gt=this.w1[0],pt=this.w1[3];gt.x=pt.x,gt.y=pt.y,gt.z=pt.z;var mt=this.w2[0],vt=this.w2[3];mt.x=vt.x,mt.y=vt.y,mt.z=vt.z}},computeWitnessPoint1:function(t){var e,a,i,n,s,r,o,l,_,h,f,u,c=this.dir;n=c.x,s=c.y,r=c.z,o=this.tf1._rotation00*n+this.tf1._rotation10*s+this.tf1._rotation20*r,l=this.tf1._rotation01*n+this.tf1._rotation11*s+this.tf1._rotation21*r,_=this.tf1._rotation02*n+this.tf1._rotation12*s+this.tf1._rotation22*r;var d=this.dir;if(d.x=o,d.y=l,d.z=_,this.c1.computeLocalSupportingVertex(this.dir,this.w1[this.simplexSize]),t){var g=this.dir,p=Math.sqrt(g.x*g.x+g.y*g.y+g.z*g.z);0<p&&(p=1/p);var m=g.x*p,v=g.y*p,b=g.z*p;g.x=m,g.y=v,g.z=b;var I=this.w1[this.simplexSize],M=this.dir,y=this.c1._gjkMargin,w=I.x+M.x*y,x=I.y+M.y*y,C=I.z+M.z*y;I.x=w,I.y=x,I.z=C}var A=this.w1[this.simplexSize];e=A.x,a=A.y,i=A.z,h=this.tf1._rotation00*e+this.tf1._rotation01*a+this.tf1._rotation02*i,f=this.tf1._rotation10*e+this.tf1._rotation11*a+this.tf1._rotation12*i,u=this.tf1._rotation20*e+this.tf1._rotation21*a+this.tf1._rotation22*i,h+=this.tf1._positionX,f+=this.tf1._positionY,u+=this.tf1._positionZ;var Z=this.w1[this.simplexSize];Z.x=h,Z.y=f,Z.z=u;var z=this.dir;z.x=n,z.y=s,z.z=r},computeWitnessPoint2:function(t){var e,a,i,n,s,r,o,l,_,h,f,u,c=this.dir;n=c.x,s=c.y,r=c.z,o=-(o=this.tf2._rotation00*n+this.tf2._rotation10*s+this.tf2._rotation20*r),l=-(l=this.tf2._rotation01*n+this.tf2._rotation11*s+this.tf2._rotation21*r),_=-(_=this.tf2._rotation02*n+this.tf2._rotation12*s+this.tf2._rotation22*r);var d=this.dir;if(d.x=o,d.y=l,d.z=_,this.c2.computeLocalSupportingVertex(this.dir,this.w2[this.simplexSize]),t){var g=this.dir,p=Math.sqrt(g.x*g.x+g.y*g.y+g.z*g.z);0<p&&(p=1/p);var m=g.x*p,v=g.y*p,b=g.z*p;g.x=m,g.y=v,g.z=b;var I=this.w2[this.simplexSize],M=this.dir,y=this.c2._gjkMargin,w=I.x+M.x*y,x=I.y+M.y*y,C=I.z+M.z*y;I.x=w,I.y=x,I.z=C}var A=this.w2[this.simplexSize];e=A.x,a=A.y,i=A.z,h=this.tf2._rotation00*e+this.tf2._rotation01*a+this.tf2._rotation02*i,f=this.tf2._rotation10*e+this.tf2._rotation11*a+this.tf2._rotation12*i,u=this.tf2._rotation20*e+this.tf2._rotation21*a+this.tf2._rotation22*i,h+=this.tf2._positionX,f+=this.tf2._positionY,u+=this.tf2._positionZ;var Z=this.w2[this.simplexSize];Z.x=h,Z.y=f,Z.z=u;var z=this.dir;z.x=n,z.y=s,z.z=r},pointToTetrahedron:function(){for(var t=0;t<3;){var e=t++,a=this.dir,i=this.baseDirs[e];a.x=i.x,a.y=i.y,a.z=i.z,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var n=this.s[this.simplexSize],s=this.w1[this.simplexSize];n.x=s.x,n.y=s.y,n.z=s.z;var r=n,o=this.w2[this.simplexSize],l=r.x-o.x,_=r.y-o.y,h=r.z-o.z;if(r.x=l,r.y=_,r.z=h,this.simplexSize++,this.lineToTetrahedron(),4==this.simplexSize)break;this.simplexSize--;var f=this.dir,u=-f.x,c=-f.y,d=-f.z;f.x=u,f.y=c,f.z=d,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var g=this.s[this.simplexSize],p=this.w1[this.simplexSize];g.x=p.x,g.y=p.y,g.z=p.z;var m=g,v=this.w2[this.simplexSize],b=m.x-v.x,I=m.y-v.y,M=m.z-v.z;if(m.x=b,m.y=I,m.z=M,this.simplexSize++,this.lineToTetrahedron(),4==this.simplexSize)break;this.simplexSize--}},lineToTetrahedron:function(){var t,e,a,i,n,s,r,o,l,_=this.dir;t=_.x,e=_.y,a=_.z;var h=this.s[0];i=h.x,n=h.y,s=h.z;var f=this.s[1];r=i-f.x,o=n-f.y,l=s-f.z;for(var u=0;u<3;){var c,d,g,p,m,v,b=u++,I=this.baseDirs[b];c=I.x,d=I.y,p=o*(g=I.z)-l*d,m=l*c-r*g,v=r*d-o*c;var M=this.dir;M.x=p,M.y=m,M.z=v,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var y=this.s[this.simplexSize],w=this.w1[this.simplexSize];y.x=w.x,y.y=w.y,y.z=w.z;var x=y,C=this.w2[this.simplexSize],A=x.x-C.x,Z=x.y-C.y,z=x.z-C.z;if(x.x=A,x.y=Z,x.z=z,this.simplexSize++,this.triangleToTetrahedron(),4==this.simplexSize)break;this.simplexSize--;var B=this.dir,k=-B.x,S=-B.y,X=-B.z;B.x=k,B.y=S,B.z=X,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var Y=this.s[this.simplexSize],N=this.w1[this.simplexSize];Y.x=N.x,Y.y=N.y,Y.z=N.z;var L=Y,G=this.w2[this.simplexSize],W=L.x-G.x,D=L.y-G.y,T=L.z-G.z;if(L.x=W,L.y=D,L.z=T,this.simplexSize++,this.triangleToTetrahedron(),4==this.simplexSize)break;this.simplexSize--}var V=this.dir;V.x=t,V.y=e,V.z=a},triangleToTetrahedron:function(){var t,e,a,i=this.dir;for(t=i.x,e=i.y,a=i.z;;){var n,s,r,o,l,_,h,f,u,c,d,g,p,m,v=this.s[0];n=v.x,s=v.y,r=v.z;var b=this.s[1];o=b.x,l=b.y,_=b.z;var I,M,y,w=this.s[2];h=w.x,f=w.y,I=(c=l-s)*(m=w.z-r)-(d=_-r)*(p=f-s),M=d*(g=h-n)-(u=o-n)*m,y=u*p-c*g;var x=this.dir;x.x=I,x.y=M,x.z=y,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var C=this.s[this.simplexSize],A=this.w1[this.simplexSize];C.x=A.x,C.y=A.y,C.z=A.z;var Z=C,z=this.w2[this.simplexSize],B=Z.x-z.x,k=Z.y-z.y,S=Z.z-z.z;if(Z.x=B,Z.y=k,Z.z=S,this.simplexSize++,this.isValidTetrahedron())break;this.simplexSize--;var X=this.dir,Y=-X.x,N=-X.y,L=-X.z;X.x=Y,X.y=N,X.z=L,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var G=this.s[this.simplexSize],W=this.w1[this.simplexSize];G.x=W.x,G.y=W.y,G.z=W.z;var D=G,T=this.w2[this.simplexSize],V=D.x-T.x,K=D.y-T.y,j=D.z-T.z;if(D.x=V,D.y=K,D.z=j,this.simplexSize++,this.isValidTetrahedron())break;this.simplexSize--;break}var R=this.dir;R.x=t,R.y=e,R.z=a},isValidTetrahedron:function(){var t=this.s[1].x-this.s[0].x,e=this.s[1].y-this.s[0].y,a=this.s[1].z-this.s[0].z,i=this.s[2].x-this.s[0].x,n=this.s[2].y-this.s[0].y,s=this.s[2].z-this.s[0].z,r=this.s[3].x-this.s[0].x,o=this.s[3].y-this.s[0].y,l=this.s[3].z-this.s[0].z,_=t*(n*l-s*o)-e*(i*l-s*r)+a*(i*o-n*r);return 1e-12<_||_<-1e-12},computeDepth:function(t,e,a,i,n,s,r){for(var o=this.polyhedron;0<o._numTriangles;){var l=o._triangleList;o._numTriangles--;var _=l._prev,h=l._next;null!=_&&(_._next=h),null!=h&&(h._prev=_),l==o._triangleList&&(o._triangleList=o._triangleList._next),l==o._triangleListLast&&(o._triangleListLast=o._triangleListLast._prev),l._next=null,l._prev=null,l.removeReferences(),l._next=o._trianglePool,o._trianglePool=l}for(;0<o._numVertices;){var f=o._vertices[--o._numVertices];f.removeReferences(),f._next=o._vertexPool,o._vertexPool=f}var u=this.polyhedron,c=this.polyhedron,d=c._vertexPool;null!=d?(c._vertexPool=d._next,d._next=null):d=new sn;var g=d.init(n[0],s[0],r[0]),p=this.polyhedron,m=p._vertexPool;null!=m?(p._vertexPool=m._next,m._next=null):m=new sn;var v=m.init(n[1],s[1],r[1]),b=this.polyhedron,I=b._vertexPool;null!=I?(b._vertexPool=I._next,I._next=null):I=new sn;var M=I.init(n[2],s[2],r[2]),y=this.polyhedron,w=y._vertexPool;if(null!=w?(y._vertexPool=w._next,w._next=null):w=new sn,!u._init(g,v,M,w.init(n[3],s[3],r[3])))return ln.EPA_FAILED_TO_INIT;this.simplexSize=0;for(var x=this.s[0],C=this.w1[0],A=this.w2[0],Z=0;Z<40;){for(var z=this.polyhedron._triangleList,B=1/0,k=null;null!=z;){var S=z._next;z._distanceSq<B&&(B=z._distanceSq,k=z),z=S}var X=k,Y=this.dir,N=X._normal;Y.x=N.x,Y.y=N.y,Y.z=N.z;var L=Y,G=Math.sqrt(L.x*L.x+L.y*L.y+L.z*L.z);0<G&&(G=1/G);var W=L.x*G,D=L.y*G,T=L.z*G;L.x=W,L.y=D,L.z=T,this.computeWitnessPoint1(!1),this.computeWitnessPoint2(!1);var V=this.s[this.simplexSize],K=this.w1[this.simplexSize];V.x=K.x,V.y=K.y,V.z=K.z;var j=V,R=this.w2[this.simplexSize],H=j.x-R.x,P=j.y-R.y,F=j.z-R.z;j.x=H,j.y=P,j.z=F;var O=X._vertices[0],E=X._vertices[1],U=X._vertices[2],J=O.v,Q=this.dir,q=J.x*Q.x+J.y*Q.y+J.z*Q.z,$=this.dir;if(x.x*$.x+x.y*$.y+x.z*$.z-q<1e-6||39==Z){var tt=this.closest,et=this.dir;tt.x=et.x,tt.y=et.y,tt.z=et.z;var at,it,nt,st=tt,rt=this.dir,ot=O.v,lt=this.dir,_t=(rt.x*ot.x+rt.y*ot.y+rt.z*ot.z)/(lt.x*lt.x+lt.y*lt.y+lt.z*lt.z),ht=st.x*_t,ft=st.y*_t,ut=st.z*_t;st.x=ht,st.y=ft,st.z=ut;var ct,dt,gt,pt,mt,vt,bt,It,Mt,yt,wt,xt,Ct,At,Zt,zt,Bt,kt,St,Xt,Yt,Nt,Lt,Gt,Wt=this.closest;at=Wt.x,it=Wt.y,nt=Wt.z;var Dt=O.v;ct=Dt.x,dt=Dt.y,gt=Dt.z;var Tt=O.w1;pt=Tt.x,mt=Tt.y,vt=Tt.z;var Vt=O.w2;bt=Vt.x,It=Vt.y,Mt=Vt.z;var Kt=E.v;yt=Kt.x,wt=Kt.y,xt=Kt.z;var jt=E.w1;Ct=jt.x,At=jt.y,Zt=jt.z;var Rt=E.w2;zt=Rt.x,Bt=Rt.y,kt=Rt.z;var Ht=U.v;St=Ht.x,Xt=Ht.y,Yt=Ht.z;var Pt=U.w1;Nt=Pt.x,Lt=Pt.y,Gt=Pt.z;var Ft,Ot,Et,Ut,Jt,Qt,qt,$t,te,ee=U.w2,ae=(Ft=yt-ct)*Ft+(Ot=wt-dt)*Ot+(Et=xt-gt)*Et,ie=Ft*(Ut=St-ct)+Ot*(Jt=Xt-dt)+Et*(Qt=Yt-gt),ne=Ut*Ut+Jt*Jt+Qt*Qt,se=Ft*(qt=at-ct)+Ot*($t=it-dt)+Et*(te=nt-gt),re=Ut*qt+Jt*$t+Qt*te,oe=ae*ne-ie*ie;0!=oe&&(oe=1/oe);var le,_e,he,fe,ue,ce,de=(se*ne-re*ie)*oe,ge=(-se*ie+re*ae)*oe;le=pt+(Ct-pt)*de,_e=mt+(At-mt)*de,he=vt+(Zt-vt)*de,le+=(Nt-pt)*ge,_e+=(Lt-mt)*ge,he+=(Gt-vt)*ge,fe=bt+(zt-bt)*de,ue=It+(Bt-It)*de,ce=Mt+(kt-Mt)*de,fe+=(ee.x-bt)*ge,ue+=(ee.y-It)*ge,ce+=(ee.z-Mt)*ge;var pe=this.closestPoint1;pe.x=le,pe.y=_e,pe.z=he;var me=this.closestPoint2;me.x=fe,me.y=ue,me.z=ce;var ve=this.closest;return this.depth=Math.sqrt(ve.x*ve.x+ve.y*ve.y+ve.z*ve.z),ln.SUCCEEDED}var be=this.polyhedron,Ie=be._vertexPool;null!=Ie?(be._vertexPool=Ie._next,Ie._next=null):Ie=new sn;var Me=Ie.init(x,C,A);if(!this.polyhedron._addVertex(Me,X))return ln.EPA_FAILED_TO_ADD_VERTEX;++Z}return ln.EPA_DID_NOT_CONVERGE},__class__:on};var ln=function(){};(i["oimo.collision.narrowphase.detector.gjkepa.GjkEpaResultState"]=ln).__name__=!0;var _n=function(t,e,a,i,n,s,r,o,l){null==l&&(l=1),null==o&&(o=0),null==r&&(r=0),null==s&&(s=0),null==n&&(n=1),null==i&&(i=0),null==a&&(a=0),null==e&&(e=0),null==t&&(t=1),this.e00=t,this.e01=e,this.e02=a,this.e10=i,this.e11=n,this.e12=s,this.e20=r,this.e21=o,this.e22=l,_n.numCreations++};(i["oimo.common.Mat3"]=_n).__name__=!0,_n.prototype={e00:null,e01:null,e02:null,e10:null,e11:null,e12:null,e20:null,e21:null,e22:null,__class__:_n};var hn=function(){};(i["oimo.common.Mat4"]=hn).__name__=!0;var fn=function(){var t=new Array(256);this.stackVec3=t,this.sizeVec3=0;var e=new Array(256);this.stackMat3=e,this.sizeMat3=0;var a=new Array(256);this.stackMat4=a,this.sizeMat4=0;var i=new Array(256);this.stackQuat=i,this.sizeQuat=0};(i["oimo.common.Pool"]=fn).__name__=!0,fn.prototype={stackVec3:null,sizeVec3:null,stackMat3:null,sizeMat3:null,stackMat4:null,sizeMat4:null,stackQuat:null,sizeQuat:null,__class__:fn};var un=function(){this._next=null,this._prev=null,this._link1=new cn,this._link2=new cn,this._s1=null,this._s2=null,this._b1=null,this._b2=null,this._detector=null,this._cachedDetectorData=new Ji,this._detectorResult=new Hi,this._latest=!1,this._shouldBeSkipped=!1,this._manifold=new kn,this._updater=new Xn(this._manifold),this._contactConstraint=new zn(this._manifold),this._touching=!1};(i["oimo.dynamics.Contact"]=un).__name__=!0,un.prototype={_next:null,_prev:null,_link1:null,_link2:null,_s1:null,_s2:null,_b1:null,_b2:null,_detector:null,_cachedDetectorData:null,_detectorResult:null,_latest:null,_shouldBeSkipped:null,_manifold:null,_updater:null,_contactConstraint:null,_touching:null,_updateManifold:function(){if(null!=this._detector){var t=this._touching,e=this._detectorResult;this._detector.detect(e,this._s1._geom,this._s2._geom,this._s1._transform,this._s2._transform,this._cachedDetectorData);var a=e.numPoints;if(this._touching=0<a,this._touching?(this._manifold._buildBasis(e.normal),e.getMaxDepth()>xn.contactUseAlternativePositionCorrectionAlgorithmDepthThreshold?this._contactConstraint._positionCorrectionAlgorithm=xn.alternativeContactPositionCorrectionAlgorithm:this._contactConstraint._positionCorrectionAlgorithm=xn.defaultContactPositionCorrectionAlgorithm,e.incremental?this._updater.incrementalUpdate(e,this._b1._transform,this._b2._transform):this._updater.totalUpdate(e,this._b1._transform,this._b2._transform)):this._manifold._clear(),this._touching&&!t){var i=this._s1._contactCallback,n=this._s2._contactCallback;i==n&&(n=null),null!=i&&i.beginContact(this),null!=n&&n.beginContact(this)}if(!this._touching&&t){var s=this._s1._contactCallback,r=this._s2._contactCallback;s==r&&(r=null),null!=s&&s.endContact(this),null!=r&&r.endContact(this)}if(this._touching){var o=this._s1._contactCallback,l=this._s2._contactCallback;o==l&&(l=null),null!=o&&o.preSolve(this),null!=l&&l.preSolve(this)}}},_postSolve:function(){var t=this._s1._contactCallback,e=this._s2._contactCallback;t==e&&(e=null),null!=t&&t.postSolve(this),null!=e&&e.postSolve(this)},__class__:un};var cn=function(){this._prev=null,this._next=null,this._contact=null,this._other=null};(i["oimo.dynamics.ContactLink"]=cn).__name__=!0,cn.prototype={_prev:null,_next:null,_contact:null,_other:null,__class__:cn};var dn=function(t){this._broadPhase=t,this._collisionMatrix=new Ri,this._numContacts=0};(i["oimo.dynamics.ContactManager"]=dn).__name__=!0,dn.prototype={_numContacts:null,_contactList:null,_contactListLast:null,_contactPool:null,_broadPhase:null,_collisionMatrix:null,createContacts:function(){for(var t=this._broadPhase._proxyPairList;null!=t;){for(var e=t._next;;){var a,i;if(t._p1._id<t._p2._id?(a=t._p1.userData,i=t._p2.userData):(a=t._p2.userData,i=t._p1.userData),!this.shouldCollide(a,i))break;var n,s=a._rigidBody,r=i._rigidBody;n=s._numContactLinks<r._numContactLinks?s._contactLinkList:r._contactLinkList;for(var o=a._id,l=i._id,_=!1;null!=n;){var h=n._next,f=n._contact;if(f._s1._id==o&&f._s2._id==l){_=f._latest=!0;break}n=h}if(!_){var u=this._contactPool;null!=u?(this._contactPool=u._next,u._next=null):u=new un;var c=u;null==this._contactList?this._contactList=c:(this._contactListLast._next=c)._prev=this._contactListLast,(this._contactListLast=c)._latest=!0;var d=this._collisionMatrix.detectors[a._geom._type][i._geom._type];c._s1=a,c._s2=i,c._b1=a._rigidBody,c._b2=i._rigidBody,c._touching=!1,null==c._b1._contactLinkList?c._b1._contactLinkList=c._link1:(c._b1._contactLinkListLast._next=c._link1,c._link1._prev=c._b1._contactLinkListLast),c._b1._contactLinkListLast=c._link1,null==c._b2._contactLinkList?c._b2._contactLinkList=c._link2:(c._b2._contactLinkListLast._next=c._link2,c._link2._prev=c._b2._contactLinkListLast),c._b2._contactLinkListLast=c._link2,c._b1._numContactLinks++,c._b2._numContactLinks++,c._link1._other=c._b2,c._link2._other=c._b1,((c._link1._contact=c)._link2._contact=c)._detector=d;var g=c._contactConstraint;g._s1=a,g._s2=i,g._b1=g._s1._rigidBody,g._b2=g._s2._rigidBody,g._tf1=g._b1._transform,g._tf2=g._b2._transform,this._numContacts++}break}t=e}},destroyOutdatedContacts:function(){for(var t=this._broadPhase._incremental,e=this._contactList;null!=e;){for(var a=e._next;;){if(e._latest){e._latest=!1,e._shouldBeSkipped=!1;break}if(!t){var i=e._prev,n=e._next;if(null!=i&&(i._next=n),null!=n&&(n._prev=i),e==this._contactList&&(this._contactList=this._contactList._next),e==this._contactListLast&&(this._contactListLast=this._contactListLast._prev),e._next=null,e._prev=null,e._touching){var s=e._s1._contactCallback,r=e._s2._contactCallback;s==r&&(r=null),null!=s&&s.endContact(e),null!=r&&r.endContact(e)}var o=e._link1._prev,l=e._link1._next;null!=o&&(o._next=l),null!=l&&(l._prev=o),e._link1==e._b1._contactLinkList&&(e._b1._contactLinkList=e._b1._contactLinkList._next),e._link1==e._b1._contactLinkListLast&&(e._b1._contactLinkListLast=e._b1._contactLinkListLast._prev),e._link1._next=null,e._link1._prev=null;var _=e._link2._prev,h=e._link2._next;null!=_&&(_._next=h),null!=h&&(h._prev=_),e._link2==e._b2._contactLinkList&&(e._b2._contactLinkList=e._b2._contactLinkList._next),e._link2==e._b2._contactLinkListLast&&(e._b2._contactLinkListLast=e._b2._contactLinkListLast._prev),e._link2._next=null,e._link2._prev=null,e._b1._numContactLinks--,e._b2._numContactLinks--,e._link1._other=null,e._link2._other=null,e._link1._contact=null,e._link2._contact=null,e._s1=null,e._s2=null,e._b1=null,e._b2=null,e._touching=!1,e._cachedDetectorData._clear(),e._manifold._clear(),e._detector=null;var f=e._contactConstraint;f._s1=null,f._s2=null,f._b1=null,f._b2=null,f._tf1=null,f._tf2=null,e._next=this._contactPool,this._contactPool=e,this._numContacts--;break}var u=e._s1,c=e._s2,d=u._rigidBody,g=c._rigidBody,p=!d._sleeping&&1!=d._type,m=!g._sleeping&&1!=g._type;if(!p&&!m){e._shouldBeSkipped=!0;break}var v=u._aabb,b=c._aabb,I=u._proxy,M=c._proxy;if(!(I._aabbMinX<M._aabbMaxX&&I._aabbMaxX>M._aabbMinX&&I._aabbMinY<M._aabbMaxY&&I._aabbMaxY>M._aabbMinY&&I._aabbMinZ<M._aabbMaxZ&&I._aabbMaxZ>M._aabbMinZ&&this.shouldCollide(u,c))){var y=e._prev,w=e._next;if(null!=y&&(y._next=w),null!=w&&(w._prev=y),e==this._contactList&&(this._contactList=this._contactList._next),e==this._contactListLast&&(this._contactListLast=this._contactListLast._prev),e._next=null,e._prev=null,e._touching){var x=e._s1._contactCallback,C=e._s2._contactCallback;x==C&&(C=null),null!=x&&x.endContact(e),null!=C&&C.endContact(e)}var A=e._link1._prev,Z=e._link1._next;null!=A&&(A._next=Z),null!=Z&&(Z._prev=A),e._link1==e._b1._contactLinkList&&(e._b1._contactLinkList=e._b1._contactLinkList._next),e._link1==e._b1._contactLinkListLast&&(e._b1._contactLinkListLast=e._b1._contactLinkListLast._prev),e._link1._next=null,e._link1._prev=null;var z=e._link2._prev,B=e._link2._next;null!=z&&(z._next=B),null!=B&&(B._prev=z),e._link2==e._b2._contactLinkList&&(e._b2._contactLinkList=e._b2._contactLinkList._next),e._link2==e._b2._contactLinkListLast&&(e._b2._contactLinkListLast=e._b2._contactLinkListLast._prev),e._link2._next=null,e._link2._prev=null,e._b1._numContactLinks--,e._b2._numContactLinks--,e._link1._other=null,e._link2._other=null,e._link1._contact=null,e._link2._contact=null,e._s1=null,e._s2=null,e._b1=null,e._b2=null,e._touching=!1,e._cachedDetectorData._clear(),e._manifold._clear(),e._detector=null;var k=e._contactConstraint;k._s1=null,k._s2=null,k._b1=null,k._b2=null,k._tf1=null,k._tf2=null,e._next=this._contactPool,this._contactPool=e,this._numContacts--;break}var S=v._minX<b._maxX&&v._maxX>b._minX&&v._minY<b._maxY&&v._maxY>b._minY&&v._minZ<b._maxZ&&v._maxZ>b._minZ;e._shouldBeSkipped=!S;break}e=a}},shouldCollide:function(t,e){var a,i,n=t._rigidBody,s=e._rigidBody;if(n==s)return!1;if(0!=n._type&&0!=s._type)return!1;if(0==(t._collisionGroup&e._collisionMask)||0==(e._collisionGroup&t._collisionMask))return!1;for(n._numJointLinks<s._numJointLinks?(a=n._jointLinkList,i=s):(a=s._jointLinkList,i=n);null!=a;){var r=a._next;if(a._other==i&&!a._joint._allowCollision)return!1;a=r}return!0},_updateContacts:function(){this._broadPhase.collectPairs(),this.createContacts(),this.destroyOutdatedContacts()},_postSolve:function(){for(var t=this._contactList;null!=t;){var e=t._next;t._touching&&t._postSolve(),t=e}},__class__:dn};var gn=function(){var t=new Array(xn.islandInitialRigidBodyArraySize);this.rigidBodies=t;var e=new Array(xn.islandInitialConstraintArraySize);this.solvers=e;var a=new Array(xn.islandInitialConstraintArraySize);this.solversSi=a;var i=new Array(xn.islandInitialConstraintArraySize);this.solversNgs=i,this.numRigidBodies=0,this.numSolvers=0,this.numSolversSi=0,this.numSolversNgs=0};(i["oimo.dynamics.Island"]=gn).__name__=!0,gn.prototype={gravityX:null,gravityY:null,gravityZ:null,numRigidBodies:null,rigidBodies:null,numSolvers:null,solvers:null,numSolversSi:null,solversSi:null,numSolversNgs:null,solversNgs:null,_clear:function(){for(;0<this.numRigidBodies;)this.rigidBodies[--this.numRigidBodies]=null;for(;0<this.numSolvers;)this.solvers[--this.numSolvers]=null;for(;0<this.numSolversSi;)this.solversSi[--this.numSolversSi]=null;for(;0<this.numSolversNgs;)this.solversNgs[--this.numSolversNgs]=null},_addRigidBody:function(t){if(this.numRigidBodies==this.rigidBodies.length){for(var e=this.numRigidBodies<<1,a=new Array(e),i=0,n=this.numRigidBodies;i<n;){var s=i++;a[s]=this.rigidBodies[s],this.rigidBodies[s]=null}this.rigidBodies=a}t._addedToIsland=!0,this.rigidBodies[this.numRigidBodies++]=t},_addConstraintSolver:function(t,e){if(this.numSolvers==this.solvers.length){for(var a=this.numSolvers<<1,i=new Array(a),n=0,s=this.numSolvers;n<s;){var r=n++;i[r]=this.solvers[r],this.solvers[r]=null}this.solvers=i}if(t._addedToIsland=!0,this.solvers[this.numSolvers++]=t,e==Zn.SPLIT_IMPULSE){if(this.numSolversSi==this.solversSi.length){for(var o=this.numSolversSi<<1,l=new Array(o),_=0,h=this.numSolversSi;_<h;){var f=_++;l[f]=this.solversSi[f],this.solversSi[f]=null}this.solversSi=l}this.solversSi[this.numSolversSi++]=t}if(e==Zn.NGS){if(this.numSolversNgs==this.solversNgs.length){for(var u=this.numSolversNgs<<1,c=new Array(u),d=0,g=this.numSolversNgs;d<g;){var p=d++;c[p]=this.solversNgs[p],this.solversNgs[p]=null}this.solversNgs=c}this.solversNgs[this.numSolversNgs++]=t}},_stepSingleRigidBody:function(t,e){var a=t.dt,i=e._ptransform,n=e._transform;if(i._positionX=n._positionX,i._positionY=n._positionY,i._positionZ=n._positionZ,i._rotation00=n._rotation00,i._rotation01=n._rotation01,i._rotation02=n._rotation02,i._rotation10=n._rotation10,i._rotation11=n._rotation11,i._rotation12=n._rotation12,i._rotation20=n._rotation20,i._rotation21=n._rotation21,i._rotation22=n._rotation22,e._autoSleep&&e._velX*e._velX+e._velY*e._velY+e._velZ*e._velZ<xn.sleepingVelocityThreshold*xn.sleepingVelocityThreshold&&e._angVelX*e._angVelX+e._angVelY*e._angVelY+e._angVelZ*e._angVelZ<xn.sleepingAngularVelocityThreshold*xn.sleepingAngularVelocityThreshold?(e._sleepTime+=a,e._sleepTime>xn.sleepingTimeThreshold&&(e._sleeping=!0,e._sleepTime=0)):e._sleepTime=0,!e._sleeping){if(0==e._type){var s,r,o,l,_,h,f=a*e._linearDamping,u=f*f,c=1/(1+f+u*(.5+.16666666666666666*f+.041666666666666664*u)),d=a*e._angularDamping,g=d*d,p=1/(1+d+g*(.5+.16666666666666666*d+.041666666666666664*g));s=this.gravityX*e._gravityScale,r=this.gravityY*e._gravityScale,o=this.gravityZ*e._gravityScale,s+=e._forceX*e._invMass,r+=e._forceY*e._invMass,o+=e._forceZ*e._invMass,l=e._invInertia00*e._torqueX+e._invInertia01*e._torqueY+e._invInertia02*e._torqueZ,_=e._invInertia10*e._torqueX+e._invInertia11*e._torqueY+e._invInertia12*e._torqueZ,h=e._invInertia20*e._torqueX+e._invInertia21*e._torqueY+e._invInertia22*e._torqueZ,e._velX+=s*a,e._velY+=r*a,e._velZ+=o*a,e._velX*=c,e._velY*=c,e._velZ*=c,e._angVelX+=l*a,e._angVelY+=_*a,e._angVelZ+=h*a,e._angVelX*=p,e._angVelY*=p,e._angVelZ*=p}e._integrate(a);for(var m=e._shapeList;null!=m;){var v,b,I,M,y,w,x,C,A,Z,z,B,k=m._next,S=m._ptransform,X=m._localTransform,Y=e._ptransform;v=Y._rotation00*X._rotation00+Y._rotation01*X._rotation10+Y._rotation02*X._rotation20,b=Y._rotation00*X._rotation01+Y._rotation01*X._rotation11+Y._rotation02*X._rotation21,I=Y._rotation00*X._rotation02+Y._rotation01*X._rotation12+Y._rotation02*X._rotation22,M=Y._rotation10*X._rotation00+Y._rotation11*X._rotation10+Y._rotation12*X._rotation20,y=Y._rotation10*X._rotation01+Y._rotation11*X._rotation11+Y._rotation12*X._rotation21,w=Y._rotation10*X._rotation02+Y._rotation11*X._rotation12+Y._rotation12*X._rotation22,x=Y._rotation20*X._rotation00+Y._rotation21*X._rotation10+Y._rotation22*X._rotation20,C=Y._rotation20*X._rotation01+Y._rotation21*X._rotation11+Y._rotation22*X._rotation21,A=Y._rotation20*X._rotation02+Y._rotation21*X._rotation12+Y._rotation22*X._rotation22,S._rotation00=v,S._rotation01=b,S._rotation02=I,S._rotation10=M,S._rotation11=y,S._rotation12=w,S._rotation20=x,S._rotation21=C,S._rotation22=A,Z=Y._rotation00*X._positionX+Y._rotation01*X._positionY+Y._rotation02*X._positionZ,z=Y._rotation10*X._positionX+Y._rotation11*X._positionY+Y._rotation12*X._positionZ,B=Y._rotation20*X._positionX+Y._rotation21*X._positionY+Y._rotation22*X._positionZ,S._positionX=Z,S._positionY=z,S._positionZ=B,S._positionX+=Y._positionX,S._positionY+=Y._positionY,S._positionZ+=Y._positionZ;var N,L,G,W,D,T,V,K,j,R,H,P,F,O,E,U,J,Q,q=m._transform,$=m._localTransform,tt=e._transform;if(N=tt._rotation00*$._rotation00+tt._rotation01*$._rotation10+tt._rotation02*$._rotation20,L=tt._rotation00*$._rotation01+tt._rotation01*$._rotation11+tt._rotation02*$._rotation21,G=tt._rotation00*$._rotation02+tt._rotation01*$._rotation12+tt._rotation02*$._rotation22,W=tt._rotation10*$._rotation00+tt._rotation11*$._rotation10+tt._rotation12*$._rotation20,D=tt._rotation10*$._rotation01+tt._rotation11*$._rotation11+tt._rotation12*$._rotation21,T=tt._rotation10*$._rotation02+tt._rotation11*$._rotation12+tt._rotation12*$._rotation22,V=tt._rotation20*$._rotation00+tt._rotation21*$._rotation10+tt._rotation22*$._rotation20,K=tt._rotation20*$._rotation01+tt._rotation21*$._rotation11+tt._rotation22*$._rotation21,j=tt._rotation20*$._rotation02+tt._rotation21*$._rotation12+tt._rotation22*$._rotation22,q._rotation00=N,q._rotation01=L,q._rotation02=G,q._rotation10=W,q._rotation11=D,q._rotation12=T,q._rotation20=V,q._rotation21=K,q._rotation22=j,R=tt._rotation00*$._positionX+tt._rotation01*$._positionY+tt._rotation02*$._positionZ,H=tt._rotation10*$._positionX+tt._rotation11*$._positionY+tt._rotation12*$._positionZ,P=tt._rotation20*$._positionX+tt._rotation21*$._positionY+tt._rotation22*$._positionZ,q._positionX=R,q._positionY=H,q._positionZ=P,q._positionX+=tt._positionX,q._positionY+=tt._positionY,q._positionZ+=tt._positionZ,m._geom._computeAabb(m._aabb,m._ptransform),F=m._aabb._minX,O=m._aabb._minY,E=m._aabb._minZ,U=m._aabb._maxX,J=m._aabb._maxY,Q=m._aabb._maxZ,m._geom._computeAabb(m._aabb,m._transform),m._aabb._minX=F<m._aabb._minX?F:m._aabb._minX,m._aabb._minY=O<m._aabb._minY?O:m._aabb._minY,m._aabb._minZ=E<m._aabb._minZ?E:m._aabb._minZ,m._aabb._maxX=U>m._aabb._maxX?U:m._aabb._maxX,m._aabb._maxY=J>m._aabb._maxY?J:m._aabb._maxY,m._aabb._maxZ=Q>m._aabb._maxZ?Q:m._aabb._maxZ,null!=m._proxy){var et,at,it;et=m._transform._positionX-m._ptransform._positionX,at=m._transform._positionY-m._ptransform._positionY,it=m._transform._positionZ-m._ptransform._positionZ;var nt=m.displacement;nt.x=et,nt.y=at,nt.z=it,m._rigidBody._world._broadPhase.moveProxy(m._proxy,m._aabb,m.displacement)}m=k}}},_step:function(t,e,a){for(var i=t.dt,n=!0,s=0,r=this.numRigidBodies;s<r;){var o=s++,l=this.rigidBodies[o],_=l._ptransform,h=l._transform;if(_._positionX=h._positionX,_._positionY=h._positionY,_._positionZ=h._positionZ,_._rotation00=h._rotation00,_._rotation01=h._rotation01,_._rotation02=h._rotation02,_._rotation10=h._rotation10,_._rotation11=h._rotation11,_._rotation12=h._rotation12,_._rotation20=h._rotation20,_._rotation21=h._rotation21,_._rotation22=h._rotation22,l._sleeping=!1,l._autoSleep&&l._velX*l._velX+l._velY*l._velY+l._velZ*l._velZ<xn.sleepingVelocityThreshold*xn.sleepingVelocityThreshold&&l._angVelX*l._angVelX+l._angVelY*l._angVelY+l._angVelZ*l._angVelZ<xn.sleepingAngularVelocityThreshold*xn.sleepingAngularVelocityThreshold?l._sleepTime+=i:l._sleepTime=0,l._sleepTime<xn.sleepingTimeThreshold&&(n=!1),0==l._type){var f,u,c,d,g,p,m=i*l._linearDamping,v=m*m,b=1/(1+m+v*(.5+.16666666666666666*m+.041666666666666664*v)),I=i*l._angularDamping,M=I*I,y=1/(1+I+M*(.5+.16666666666666666*I+.041666666666666664*M));f=this.gravityX*l._gravityScale,u=this.gravityY*l._gravityScale,c=this.gravityZ*l._gravityScale,f+=l._forceX*l._invMass,u+=l._forceY*l._invMass,c+=l._forceZ*l._invMass,d=l._invInertia00*l._torqueX+l._invInertia01*l._torqueY+l._invInertia02*l._torqueZ,g=l._invInertia10*l._torqueX+l._invInertia11*l._torqueY+l._invInertia12*l._torqueZ,p=l._invInertia20*l._torqueX+l._invInertia21*l._torqueY+l._invInertia22*l._torqueZ,l._velX+=f*i,l._velY+=u*i,l._velZ+=c*i,l._velX*=b,l._velY*=b,l._velZ*=b,l._angVelX+=d*i,l._angVelY+=g*i,l._angVelZ+=p*i,l._angVelX*=y,l._angVelY*=y,l._angVelZ*=y}}if(n)for(var w=0,x=this.numRigidBodies;w<x;){var C=w++,A=this.rigidBodies[C];A._sleeping=!0,A._sleepTime=0}else{for(var Z=0,z=this.numSolvers;Z<z;){var B=Z++;this.solvers[B].preSolveVelocity(t)}for(var k=0,S=this.numSolvers;k<S;){var X=k++;this.solvers[X].warmStart(t)}for(var Y=0,N=e;Y<N;){Y++;for(var L=0,G=this.numSolvers;L<G;){var W=L++;this.solvers[W].solveVelocity()}}for(var D=0,T=this.numSolvers;D<T;){var V=D++;this.solvers[V].postSolveVelocity(t)}for(var K=0,j=this.numRigidBodies;K<j;){var R=K++;this.rigidBodies[R]._integrate(i)}for(var H=0,P=this.numSolversSi;H<P;){var F=H++;this.solversSi[F].preSolvePosition(t)}for(var O=0,E=a;O<E;){O++;for(var U=0,J=this.numSolversSi;U<J;){var Q=U++;this.solversSi[Q].solvePositionSplitImpulse()}}for(var q=0,$=this.numRigidBodies;q<$;){var tt=q++;this.rigidBodies[tt]._integratePseudoVelocity()}for(var et=0,at=this.numSolversNgs;et<at;){var it=et++;this.solversNgs[it].preSolvePosition(t)}for(var nt=0,st=a;nt<st;){nt++;for(var rt=0,ot=this.numSolversNgs;rt<ot;){var lt=rt++;this.solversNgs[lt].solvePositionNgs(t)}}for(var _t=0,ht=this.numSolvers;_t<ht;){var ft=_t++;this.solvers[ft].postSolve()}for(var ut=0,ct=this.numRigidBodies;ut<ct;)for(var dt=ut++,gt=this.rigidBodies[dt],pt=gt._shapeList;null!=pt;){var mt,vt,bt,It,Mt,yt,wt,xt,Ct,At,Zt,zt,Bt=pt._next,kt=pt._ptransform,St=pt._localTransform,Xt=gt._ptransform;mt=Xt._rotation00*St._rotation00+Xt._rotation01*St._rotation10+Xt._rotation02*St._rotation20,vt=Xt._rotation00*St._rotation01+Xt._rotation01*St._rotation11+Xt._rotation02*St._rotation21,bt=Xt._rotation00*St._rotation02+Xt._rotation01*St._rotation12+Xt._rotation02*St._rotation22,It=Xt._rotation10*St._rotation00+Xt._rotation11*St._rotation10+Xt._rotation12*St._rotation20,Mt=Xt._rotation10*St._rotation01+Xt._rotation11*St._rotation11+Xt._rotation12*St._rotation21,yt=Xt._rotation10*St._rotation02+Xt._rotation11*St._rotation12+Xt._rotation12*St._rotation22,wt=Xt._rotation20*St._rotation00+Xt._rotation21*St._rotation10+Xt._rotation22*St._rotation20,xt=Xt._rotation20*St._rotation01+Xt._rotation21*St._rotation11+Xt._rotation22*St._rotation21,Ct=Xt._rotation20*St._rotation02+Xt._rotation21*St._rotation12+Xt._rotation22*St._rotation22,kt._rotation00=mt,kt._rotation01=vt,kt._rotation02=bt,kt._rotation10=It,kt._rotation11=Mt,kt._rotation12=yt,kt._rotation20=wt,kt._rotation21=xt,kt._rotation22=Ct,At=Xt._rotation00*St._positionX+Xt._rotation01*St._positionY+Xt._rotation02*St._positionZ,Zt=Xt._rotation10*St._positionX+Xt._rotation11*St._positionY+Xt._rotation12*St._positionZ,zt=Xt._rotation20*St._positionX+Xt._rotation21*St._positionY+Xt._rotation22*St._positionZ,kt._positionX=At,kt._positionY=Zt,kt._positionZ=zt,kt._positionX+=Xt._positionX,kt._positionY+=Xt._positionY,kt._positionZ+=Xt._positionZ;var Yt,Nt,Lt,Gt,Wt,Dt,Tt,Vt,Kt,jt,Rt,Ht,Pt,Ft,Ot,Et,Ut,Jt,Qt=pt._transform,qt=pt._localTransform,$t=gt._transform;if(Yt=$t._rotation00*qt._rotation00+$t._rotation01*qt._rotation10+$t._rotation02*qt._rotation20,Nt=$t._rotation00*qt._rotation01+$t._rotation01*qt._rotation11+$t._rotation02*qt._rotation21,Lt=$t._rotation00*qt._rotation02+$t._rotation01*qt._rotation12+$t._rotation02*qt._rotation22,Gt=$t._rotation10*qt._rotation00+$t._rotation11*qt._rotation10+$t._rotation12*qt._rotation20,Wt=$t._rotation10*qt._rotation01+$t._rotation11*qt._rotation11+$t._rotation12*qt._rotation21,Dt=$t._rotation10*qt._rotation02+$t._rotation11*qt._rotation12+$t._rotation12*qt._rotation22,Tt=$t._rotation20*qt._rotation00+$t._rotation21*qt._rotation10+$t._rotation22*qt._rotation20,Vt=$t._rotation20*qt._rotation01+$t._rotation21*qt._rotation11+$t._rotation22*qt._rotation21,Kt=$t._rotation20*qt._rotation02+$t._rotation21*qt._rotation12+$t._rotation22*qt._rotation22,Qt._rotation00=Yt,Qt._rotation01=Nt,Qt._rotation02=Lt,Qt._rotation10=Gt,Qt._rotation11=Wt,Qt._rotation12=Dt,Qt._rotation20=Tt,Qt._rotation21=Vt,Qt._rotation22=Kt,jt=$t._rotation00*qt._positionX+$t._rotation01*qt._positionY+$t._rotation02*qt._positionZ,Rt=$t._rotation10*qt._positionX+$t._rotation11*qt._positionY+$t._rotation12*qt._positionZ,Ht=$t._rotation20*qt._positionX+$t._rotation21*qt._positionY+$t._rotation22*qt._positionZ,Qt._positionX=jt,Qt._positionY=Rt,Qt._positionZ=Ht,Qt._positionX+=$t._positionX,Qt._positionY+=$t._positionY,Qt._positionZ+=$t._positionZ,pt._geom._computeAabb(pt._aabb,pt._ptransform),Pt=pt._aabb._minX,Ft=pt._aabb._minY,Ot=pt._aabb._minZ,Et=pt._aabb._maxX,Ut=pt._aabb._maxY,Jt=pt._aabb._maxZ,pt._geom._computeAabb(pt._aabb,pt._transform),pt._aabb._minX=Pt<pt._aabb._minX?Pt:pt._aabb._minX,pt._aabb._minY=Ft<pt._aabb._minY?Ft:pt._aabb._minY,pt._aabb._minZ=Ot<pt._aabb._minZ?Ot:pt._aabb._minZ,pt._aabb._maxX=Et>pt._aabb._maxX?Et:pt._aabb._maxX,pt._aabb._maxY=Ut>pt._aabb._maxY?Ut:pt._aabb._maxY,pt._aabb._maxZ=Jt>pt._aabb._maxZ?Jt:pt._aabb._maxZ,null!=pt._proxy){var te,ee,ae;te=pt._transform._positionX-pt._ptransform._positionX,ee=pt._transform._positionY-pt._ptransform._positionY,ae=pt._transform._positionZ-pt._ptransform._positionZ;var ie=pt.displacement;ie.x=te,ie.y=ee,ie.z=ae,pt._rigidBody._world._broadPhase.moveProxy(pt._proxy,pt._aabb,pt.displacement)}pt=Bt}}},__class__:gn};var pn=function(){this.dt=0,this.invDt=0,this.dtRatio=1};(i["oimo.dynamics.TimeStep"]=pn).__name__=!0,pn.prototype={dt:null,invDt:null,dtRatio:null,__class__:pn};var mn=function(t,e){switch(null==t&&(t=2),t){case 1:this._broadPhase=new Bi;break;case 2:this._broadPhase=new ki}this._contactManager=new dn(this._broadPhase),null==e&&(e=new Et(0,-9.80665,0)),this._gravity=new Et(e.x,e.y,e.z),this._rigidBodyList=null,this._rigidBodyListLast=null,this._jointList=null,this._jointListLast=null,this._numRigidBodies=0,this._numShapes=0,this._numJoints=0,this._numIslands=0,this._numVelocityIterations=10,this._numPositionIterations=5,this._rayCastWrapper=new vn,this._convexCastWrapper=new bn,this._aabbTestWrapper=new In,this._island=new gn;var a=new Array(xn.islandInitialConstraintArraySize);this._solversInIslands=a;var i=new Array(xn.islandInitialRigidBodyArraySize);this._rigidBodyStack=i,this._timeStep=new pn,this._pool=new fn,this._shapeIdCount=0};(i["oimo.dynamics.World"]=mn).__name__=!0,mn.prototype={_rigidBodyList:null,_rigidBodyListLast:null,_jointList:null,_jointListLast:null,_broadPhase:null,_contactManager:null,_numRigidBodies:null,_numJoints:null,_numShapes:null,_numIslands:null,_numVelocityIterations:null,_numPositionIterations:null,_gravity:null,_timeStep:null,_island:null,_rigidBodyStack:null,_solversInIslands:null,_numSolversInIslands:null,_rayCastWrapper:null,_convexCastWrapper:null,_aabbTestWrapper:null,_pool:null,_shapeIdCount:null,_updateContacts:function(){var t=uo.realTime();this._contactManager._updateContacts();var e=uo.realTime();Cn.broadPhaseCollisionTime=1e3*(e-t);for(var a=uo.realTime(),i=this._contactManager._contactList;null!=i;){var n=i._next;i._shouldBeSkipped||i._updateManifold(),i=n}var s=uo.realTime();Cn.narrowPhaseCollisionTime=1e3*(s-a)},_solveIslands:function(){var t=uo.realTime();if(xn.disableSleeping)for(var e=this._rigidBodyList;null!=e;){var a=e._next;e._sleeping=!1,e._sleepTime=0,e=a}if(this._rigidBodyStack.length<this._numRigidBodies){for(var i=this._rigidBodyStack.length<<1;i<this._numRigidBodies;)i<<=1;var n=new Array(i);this._rigidBodyStack=n}this._numIslands=0;var s=this._island,r=this._gravity;s.gravityX=r.x,s.gravityY=r.y,s.gravityZ=r.z;var o=this._rigidBodyList;for(this._numSolversInIslands=0;null!=o;){for(var l=o._next;!o._addedToIsland&&!o._sleeping&&1!=o._type;){if(0==o._numContactLinks&&0==o._numJointLinks){this._island._stepSingleRigidBody(this._timeStep,o),this._numIslands++;break}this.buildIsland(o),this._island._step(this._timeStep,this._numVelocityIterations,this._numPositionIterations),this._island._clear(),this._numIslands++;break}o=l}for(this._contactManager._postSolve(),o=this._rigidBodyList;null!=o;){var _=o._next;o._addedToIsland=!1,o=_}for(o=this._rigidBodyList;null!=o;){var h=o._next;o._forceX=0,o._forceY=0,o._forceZ=0,o._torqueX=0,o._torqueY=0,o._torqueZ=0,o=h}for(;0<this._numSolversInIslands;)this._solversInIslands[--this._numSolversInIslands]._addedToIsland=!1,this._solversInIslands[this._numSolversInIslands]=null;var f=uo.realTime();Cn.dynamicsTime=1e3*(f-t)},buildIsland:function(t){var e=1;for(this._island._addRigidBody(t),this._rigidBodyStack[0]=t;0<e;){var a=this._rigidBodyStack[--e];if(this._rigidBodyStack[e]=null,1!=a._type){for(var i=a._contactLinkList;null!=i;){var n=i._next,s=i._contact._contactConstraint,r=i._contact._contactConstraint._solver;if(s.isTouching()&&!r._addedToIsland){if(this._solversInIslands.length==this._numSolversInIslands){for(var o=this._numSolversInIslands<<1,l=new Array(o),_=0,h=this._numSolversInIslands;_<h;){var f=_++;l[f]=this._solversInIslands[f],this._solversInIslands[f]=null}this._solversInIslands=l}this._solversInIslands[this._numSolversInIslands++]=r,this._island._addConstraintSolver(r,s._positionCorrectionAlgorithm);var u=i._other;u._addedToIsland||(this._island._addRigidBody(u),this._rigidBodyStack[e++]=u)}i=n}for(var c=a._jointLinkList;null!=c;){var d=c._next,g=c._joint,p=g._solver;if(!p._addedToIsland){if(this._solversInIslands.length==this._numSolversInIslands){for(var m=this._numSolversInIslands<<1,v=new Array(m),b=0,I=this._numSolversInIslands;b<I;){var M=b++;v[M]=this._solversInIslands[M],this._solversInIslands[M]=null}this._solversInIslands=v}this._solversInIslands[this._numSolversInIslands++]=p,this._island._addConstraintSolver(p,g._positionCorrectionAlgorithm);var y=c._other;y._addedToIsland||(this._island._addRigidBody(y),this._rigidBodyStack[e++]=y)}c=d}}}},step:function(t){0<this._timeStep.dt&&(this._timeStep.dtRatio=t/this._timeStep.dt),this._timeStep.dt=t,this._timeStep.invDt=1/t;var e=uo.realTime();this._updateContacts(),this._solveIslands();var a=uo.realTime();Cn.totalTime=1e3*(a-e)},addRigidBody:function(t){if(null!=t._world)throw new Error("A rigid body cannot belong to multiple worlds.");null==this._rigidBodyList?this._rigidBodyList=t:(this._rigidBodyListLast._next=t)._prev=this._rigidBodyListLast,(this._rigidBodyListLast=t)._world=this;for(var e=t._shapeList;null!=e;){var a=e._next;e._proxy=this._broadPhase.createProxy(e,e._aabb),e._id=this._shapeIdCount++,this._numShapes++,e=a}this._numRigidBodies++},removeRigidBody:function(t){if(t._world!=this)throw new Error("The rigid body doesn't belong to the world.");var e=t._prev,a=t._next;null!=e&&(e._next=a),null!=a&&(a._prev=e),t==this._rigidBodyList&&(this._rigidBodyList=this._rigidBodyList._next),t==this._rigidBodyListLast&&(this._rigidBodyListLast=this._rigidBodyListLast._prev),t._next=null,t._prev=null,t._world=null;for(var i=t._shapeList;null!=i;){var n=i._next;this._broadPhase.destroyProxy(i._proxy),i._proxy=null,i._id=-1;for(var s=i._rigidBody._contactLinkList;null!=s;){var r=s._next,o=s._contact;if(o._s1==i||o._s2==i){var l=s._other;l._sleeping=!1,l._sleepTime=0;var _=this._contactManager,h=o._prev,f=o._next;if(null!=h&&(h._next=f),null!=f&&(f._prev=h),o==_._contactList&&(_._contactList=_._contactList._next),o==_._contactListLast&&(_._contactListLast=_._contactListLast._prev),o._next=null,o._prev=null,o._touching){var u=o._s1._contactCallback,c=o._s2._contactCallback;u==c&&(c=null),null!=u&&u.endContact(o),null!=c&&c.endContact(o)}var d=o._link1._prev,g=o._link1._next;null!=d&&(d._next=g),null!=g&&(g._prev=d),o._link1==o._b1._contactLinkList&&(o._b1._contactLinkList=o._b1._contactLinkList._next),o._link1==o._b1._contactLinkListLast&&(o._b1._contactLinkListLast=o._b1._contactLinkListLast._prev),o._link1._next=null,o._link1._prev=null;var p=o._link2._prev,m=o._link2._next;null!=p&&(p._next=m),null!=m&&(m._prev=p),o._link2==o._b2._contactLinkList&&(o._b2._contactLinkList=o._b2._contactLinkList._next),o._link2==o._b2._contactLinkListLast&&(o._b2._contactLinkListLast=o._b2._contactLinkListLast._prev),o._link2._next=null,o._link2._prev=null,o._b1._numContactLinks--,o._b2._numContactLinks--,o._link1._other=null,o._link2._other=null,o._link1._contact=null,o._link2._contact=null,o._s1=null,o._s2=null,o._b1=null,o._b2=null,o._touching=!1,o._cachedDetectorData._clear(),o._manifold._clear(),o._detector=null;var v=o._contactConstraint;v._s1=null,v._s2=null,v._b1=null,v._b2=null,v._tf1=null,v._tf2=null,o._next=_._contactPool,_._contactPool=o,_._numContacts--}s=r}this._numShapes--,i=n}this._numRigidBodies--},removeJoint:function(t){if(t._world!=this)throw new Error("The joint doesn't belong to the world.");var e=t._prev,a=t._next;null!=e&&(e._next=a),null!=a&&(a._prev=e),t==this._jointList&&(this._jointList=this._jointList._next),t==this._jointListLast&&(this._jointListLast=this._jointListLast._prev),t._next=null,t._prev=null,t._world=null;var i=t._link1._prev,n=t._link1._next;null!=i&&(i._next=n),null!=n&&(n._prev=i),t._link1==t._b1._jointLinkList&&(t._b1._jointLinkList=t._b1._jointLinkList._next),t._link1==t._b1._jointLinkListLast&&(t._b1._jointLinkListLast=t._b1._jointLinkListLast._prev),t._link1._next=null,t._link1._prev=null;var s=t._link2._prev,r=t._link2._next;null!=s&&(s._next=r),null!=r&&(r._prev=s),t._link2==t._b2._jointLinkList&&(t._b2._jointLinkList=t._b2._jointLinkList._next),t._link2==t._b2._jointLinkListLast&&(t._b2._jointLinkListLast=t._b2._jointLinkListLast._prev),t._link2._next=null,t._link2._prev=null,t._link1._other=null,t._link2._other=null,t._b1._numJointLinks--,t._b2._numJointLinks--;var o=t._b1;o._sleeping=!1,o._sleepTime=0;var l=t._b2;l._sleeping=!1,l._sleepTime=0,this._numJoints--},__class__:mn};var vn=function(){Ai.call(this),this.rayCastHit=new Ki,this.begin=new Et,this.end=new Et,this.callback=null};(i["oimo.dynamics._World.RayCastWrapper"]=vn).__name__=!0,vn.__super__=Ai,vn.prototype=s(Ai.prototype,{callback:null,begin:null,end:null,rayCastHit:null,__class__:vn});var bn=function(){Ai.call(this),this.rayCastHit=new Ki,this.begin=new rn,this.translation=new Et,this.zero=new Et,this.callback=null,this.convex=null};(i["oimo.dynamics._World.ConvexCastWrapper"]=bn).__name__=!0,bn.__super__=Ai,bn.prototype=s(Ai.prototype,{callback:null,begin:null,translation:null,convex:null,rayCastHit:null,zero:null,__class__:bn});var In=function(){Ai.call(this),this._aabb=new Li,this._callback=null};(i["oimo.dynamics._World.AabbTestWrapper"]=In).__name__=!0,In.__super__=Ai,In.prototype=s(Ai.prototype,{_callback:null,_aabb:null,__class__:In});var Mn=function(){};(i["oimo.dynamics.callback.AabbTestCallback"]=Mn).__name__=!0;var yn=function(){};(i["oimo.dynamics.callback.ContactCallback"]=yn).__name__=!0,yn.prototype={beginContact:function(t){},preSolve:function(t){},postSolve:function(t){},endContact:function(t){},__class__:yn};var wn=function(){};(i["oimo.dynamics.callback.RayCastCallback"]=wn).__name__=!0;var Cn=function(){};(i["oimo.dynamics.common.Performance"]=Cn).__name__=!0;var An=function(){this._b1=null,this._b2=null,this._addedToIsland=!1};(i["oimo.dynamics.constraint.ConstraintSolver"]=An).__name__=!0,An.prototype={_b1:null,_b2:null,_addedToIsland:null,preSolveVelocity:function(t){},warmStart:function(t){},solveVelocity:function(){},postSolveVelocity:function(t){},preSolvePosition:function(t){},solvePositionSplitImpulse:function(){},solvePositionNgs:function(t){},postSolve:function(){},__class__:An};var Zn=function(){};(i["oimo.dynamics.constraint.PositionCorrectionAlgorithm"]=Zn).__name__=!0;var zn=function(t){this._solver=new Jn(this),this._manifold=t};(i["oimo.dynamics.constraint.contact.ContactConstraint"]=zn).__name__=!0,zn.prototype={_positionCorrectionAlgorithm:null,_manifold:null,_s1:null,_s2:null,_tf1:null,_tf2:null,_b1:null,_b2:null,_solver:null,_getVelocitySolverInfo:function(t,e){var a,i,n,s,r,o,l,_,h;e.b1=this._b1,e.b2=this._b2,a=this._manifold._normalX,i=this._manifold._normalY,n=this._manifold._normalZ,s=this._manifold._tangentX,r=this._manifold._tangentY,o=this._manifold._tangentZ,l=this._manifold._binormalX,_=this._manifold._binormalY,h=this._manifold._binormalZ;var f=Math.sqrt(this._s1._friction*this._s2._friction),u=Math.sqrt(this._s1._restitution*this._s2._restitution),c=this._manifold._numPoints;e.numRows=0,this._tf1._positionX,this._tf2._positionX,this._tf1._positionY,this._tf2._positionY,this._tf1._positionZ,this._tf2._positionZ;for(var d=0,g=c;d<g;){var p=d++,m=this._manifold._points[p];if(m._depth<0){m._disabled=!0;var v=m._impulse;v.impulseN=0,v.impulseT=0,v.impulseB=0,v.impulseP=0,v.impulseLX=0,v.impulseLY=0,v.impulseLZ=0}else{m._disabled=!1;var b=e.rows[e.numRows++];b.friction=f,b.cfm=0;var I=b.jacobianN;I.lin1X=a,I.lin1Y=i,I.lin1Z=n,I.lin2X=a,I.lin2Y=i,I.lin2Z=n,I.ang1X=m._relPos1Y*n-m._relPos1Z*i,I.ang1Y=m._relPos1Z*a-m._relPos1X*n,I.ang1Z=m._relPos1X*i-m._relPos1Y*a,I.ang2X=m._relPos2Y*n-m._relPos2Z*i,I.ang2Y=m._relPos2Z*a-m._relPos2X*n,I.ang2Z=m._relPos2X*i-m._relPos2Y*a,(I=b.jacobianT).lin1X=s,I.lin1Y=r,I.lin1Z=o,I.lin2X=s,I.lin2Y=r,I.lin2Z=o,I.ang1X=m._relPos1Y*o-m._relPos1Z*r,I.ang1Y=m._relPos1Z*s-m._relPos1X*o,I.ang1Z=m._relPos1X*r-m._relPos1Y*s,I.ang2X=m._relPos2Y*o-m._relPos2Z*r,I.ang2Y=m._relPos2Z*s-m._relPos2X*o,I.ang2Z=m._relPos2X*r-m._relPos2Y*s,(I=b.jacobianB).lin1X=l,I.lin1Y=_,I.lin1Z=h,I.lin2X=l,I.lin2Y=_,I.lin2Z=h,I.ang1X=m._relPos1Y*h-m._relPos1Z*_,I.ang1Y=m._relPos1Z*l-m._relPos1X*h,I.ang1Z=m._relPos1X*_-m._relPos1Y*l,I.ang2X=m._relPos2Y*h-m._relPos2Z*_,I.ang2Y=m._relPos2Z*l-m._relPos2X*h,I.ang2Z=m._relPos2X*_-m._relPos2Y*l;var M=(I=b.jacobianN).lin1X*this._b1._velX+I.lin1Y*this._b1._velY+I.lin1Z*this._b1._velZ+(I.ang1X*this._b1._angVelX+I.ang1Y*this._b1._angVelY+I.ang1Z*this._b1._angVelZ)-(I.lin2X*this._b2._velX+I.lin2Y*this._b2._velY+I.lin2Z*this._b2._velZ+(I.ang2X*this._b2._angVelX+I.ang2Y*this._b2._angVelY+I.ang2Z*this._b2._angVelZ));if(M<-xn.contactEnableBounceThreshold&&!m._warmStarted?b.rhs=-M*u:b.rhs=0,this._positionCorrectionAlgorithm==Zn.BAUMGARTE&&m._depth>xn.linearSlop){var y=(m._depth-xn.linearSlop)*xn.velocityBaumgarte*t.invDt;b.rhs<y&&(b.rhs=y)}if(!m._warmStarted){var w=m._impulse;w.impulseN=0,w.impulseT=0,w.impulseB=0,w.impulseP=0,w.impulseLX=0,w.impulseLY=0,w.impulseLZ=0}b.impulse=m._impulse}}},_getPositionSolverInfo:function(t){var e,a,i;t.b1=this._b1,t.b2=this._b2,e=this._manifold._normalX,a=this._manifold._normalY,i=this._manifold._normalZ;for(var n=this._manifold._numPoints,s=t.numRows=0,r=n;s<r;){var o=s++,l=this._manifold._points[o];if(!l._disabled){var _=t.rows[t.numRows++],h=_.jacobianN;h.lin1X=e,h.lin1Y=a,h.lin1Z=i,h.lin2X=e,h.lin2Y=a,h.lin2Z=i,h.ang1X=l._relPos1Y*i-l._relPos1Z*a,h.ang1Y=l._relPos1Z*e-l._relPos1X*i,h.ang1Z=l._relPos1X*a-l._relPos1Y*e,h.ang2X=l._relPos2Y*i-l._relPos2Z*a,h.ang2Y=l._relPos2Z*e-l._relPos2X*i,h.ang2Z=l._relPos2X*a-l._relPos2Y*e,_.rhs=l._depth-xn.linearSlop,_.rhs<0&&(_.rhs=0),_.impulse=l._impulse}}},_syncManifold:function(){this._manifold._updateDepthsAndPositions(this._tf1,this._tf2)},isTouching:function(){for(var t=0,e=this._manifold._numPoints;t<e;){var a=t++;if(0<=this._manifold._points[a]._depth)return!0}return!1},__class__:zn};var Bn=function(){this.impulseN=0,this.impulseT=0,this.impulseB=0,this.impulseP=0,this.impulseLX=0,this.impulseLY=0,this.impulseLZ=0};(i["oimo.dynamics.constraint.contact.ContactImpulse"]=Bn).__name__=!0,Bn.prototype={impulseN:null,impulseT:null,impulseB:null,impulseP:null,impulseLX:null,impulseLY:null,impulseLZ:null,copyFrom:function(t){this.impulseN=t.impulseN,this.impulseT=t.impulseT,this.impulseB=t.impulseB,this.impulseLX=t.impulseLX,this.impulseLY=t.impulseLY,this.impulseLZ=t.impulseLZ},__class__:Bn};var kn=function(){this._normalX=0,this._normalY=0,this._normalZ=0,this._tangentX=0,this._tangentY=0,this._tangentZ=0,this._binormalX=0,this._binormalY=0,this._binormalZ=0,this._numPoints=0;var t=new Array(xn.maxManifoldPoints);this._points=t;for(var e=0,a=xn.maxManifoldPoints;e<a;){var i=e++;this._points[i]=new Sn}};(i["oimo.dynamics.constraint.contact.Manifold"]=kn).__name__=!0,kn.prototype={_normalX:null,_normalY:null,_normalZ:null,_tangentX:null,_tangentY:null,_tangentZ:null,_binormalX:null,_binormalY:null,_binormalZ:null,_numPoints:null,_points:null,_clear:function(){for(var t=0,e=this._numPoints;t<e;){var a=t++,i=this._points[a];i._localPos1X=0,i._localPos1Y=0,i._localPos1Z=0,i._localPos2X=0,i._localPos2Y=0,i._localPos2Z=0,i._relPos1X=0,i._relPos1Y=0,i._relPos1Z=0,i._relPos2X=0,i._relPos2Y=0,i._relPos2Z=0,i._pos1X=0,i._pos1Y=0,i._pos1Z=0,i._pos2X=0,i._pos2Y=0,i._pos2Z=0,i._depth=0;var n=i._impulse;n.impulseN=0,n.impulseT=0,n.impulseB=0,n.impulseP=0,n.impulseLX=0,n.impulseLY=0,n.impulseLZ=0,i._warmStarted=!1,i._disabled=!1,i._id=-1}this._numPoints=0},_buildBasis:function(t){var e=t;this._normalX=e.x,this._normalY=e.y,this._normalZ=e.z;var a,i,n,s,r,o,l=t.x,_=t.y,h=t.z,f=l*l,u=_*_,c=h*h;if(f<u)if(f<c){var d=1/Math.sqrt(u+c);a=0,s=_*(n=_*d)-h*(i=-h*d),r=-l*n,o=l*i}else{var g=1/Math.sqrt(f+u);n=0,s=-h*(i=l*g),r=h*(a=-_*g),o=l*i-_*a}else if(u<c){var p=1/Math.sqrt(f+c);i=0,s=_*(n=-l*p),r=h*(a=h*p)-l*n,o=-_*a}else{var m=1/Math.sqrt(f+u);n=0,s=-h*(i=l*m),r=h*(a=-_*m),o=l*i-_*a}this._tangentX=a,this._tangentY=i,this._tangentZ=n,this._binormalX=s,this._binormalY=r,this._binormalZ=o},_updateDepthsAndPositions:function(t,e){for(var a=0,i=this._numPoints;a<i;){var n,s,r,o,l,_,h,f,u,c=a++,d=this._points[c];n=t._rotation00*d._localPos1X+t._rotation01*d._localPos1Y+t._rotation02*d._localPos1Z,s=t._rotation10*d._localPos1X+t._rotation11*d._localPos1Y+t._rotation12*d._localPos1Z,r=t._rotation20*d._localPos1X+t._rotation21*d._localPos1Y+t._rotation22*d._localPos1Z,d._relPos1X=n,d._relPos1Y=s,d._relPos1Z=r,o=e._rotation00*d._localPos2X+e._rotation01*d._localPos2Y+e._rotation02*d._localPos2Z,l=e._rotation10*d._localPos2X+e._rotation11*d._localPos2Y+e._rotation12*d._localPos2Z,_=e._rotation20*d._localPos2X+e._rotation21*d._localPos2Y+e._rotation22*d._localPos2Z,d._relPos2X=o,d._relPos2Y=l,d._relPos2Z=_,d._pos1X=d._relPos1X+t._positionX,d._pos1Y=d._relPos1Y+t._positionY,d._pos1Z=d._relPos1Z+t._positionZ,d._pos2X=d._relPos2X+e._positionX,d._pos2Y=d._relPos2Y+e._positionY,d._pos2Z=d._relPos2Z+e._positionZ,h=d._pos1X-d._pos2X,f=d._pos1Y-d._pos2Y,u=d._pos1Z-d._pos2Z;var g=h*this._normalX+f*this._normalY+u*this._normalZ;d._depth=-g}},__class__:kn};var Sn=function(){this._localPos1X=0,this._localPos1Y=0,this._localPos1Z=0,this._localPos2X=0,this._localPos2Y=0,this._localPos2Z=0,this._relPos1X=0,this._relPos1Y=0,this._relPos1Z=0,this._relPos2X=0,this._relPos2Y=0,this._relPos2Z=0,this._pos1X=0,this._pos1Y=0,this._pos1Z=0,this._pos2X=0,this._pos2Y=0,this._pos2Z=0,this._depth=0,this._impulse=new Bn,this._warmStarted=!1,this._disabled=!1,this._id=-1};(i["oimo.dynamics.constraint.contact.ManifoldPoint"]=Sn).__name__=!0,Sn.prototype={_localPos1X:null,_localPos1Y:null,_localPos1Z:null,_localPos2X:null,_localPos2Y:null,_localPos2Z:null,_relPos1X:null,_relPos1Y:null,_relPos1Z:null,_relPos2X:null,_relPos2Y:null,_relPos2Z:null,_pos1X:null,_pos1Y:null,_pos1Z:null,_pos2X:null,_pos2Y:null,_pos2Z:null,_depth:null,_impulse:null,_warmStarted:null,_disabled:null,_id:null,__class__:Sn};var Xn=function(t){this._manifold=t,this.numOldPoints=0;var e=new Array(xn.maxManifoldPoints);this.oldPoints=e;for(var a=0,i=xn.maxManifoldPoints;a<i;){var n=a++;this.oldPoints[n]=new Sn}};(i["oimo.dynamics.constraint.contact.ManifoldUpdater"]=Xn).__name__=!0,Xn.prototype={_manifold:null,numOldPoints:null,oldPoints:null,removeOutdatedPoints:function(){for(var t=this._manifold._numPoints;0<=--t;){var e,a,i,n=this._manifold._points[t];e=n._pos1X-n._pos2X,a=n._pos1Y-n._pos2Y,i=n._pos1Z-n._pos2Z;var s=this._manifold._normalX*e+this._manifold._normalY*a+this._manifold._normalZ*i;s>xn.contactPersistenceThreshold?this.removeManifoldPoint(t):(e+=this._manifold._normalX*-s)*e+(a+=this._manifold._normalY*-s)*a+(i+=this._manifold._normalZ*-s)*i>xn.contactPersistenceThreshold*xn.contactPersistenceThreshold&&this.removeManifoldPoint(t)}},removeManifoldPoint:function(t){var e=--this._manifold._numPoints;if(t!=e){var a=this._manifold._points[t];this._manifold._points[t]=this._manifold._points[e],this._manifold._points[e]=a}var i=this._manifold._points[e];i._localPos1X=0,i._localPos1Y=0,i._localPos1Z=0,i._localPos2X=0,i._localPos2Y=0,i._localPos2Z=0,i._relPos1X=0,i._relPos1Y=0,i._relPos1Z=0,i._relPos2X=0,i._relPos2Y=0,i._relPos2Z=0,i._pos1X=0,i._pos1Y=0,i._pos1Z=0,i._pos2X=0,i._pos2Y=0,i._pos2Z=0,i._depth=0;var n=i._impulse;n.impulseN=0,n.impulseT=0,n.impulseB=0,n.impulseP=0,n.impulseLX=0,n.impulseLY=0,n.impulseLZ=0,i._warmStarted=!1,i._disabled=!1,i._id=-1},addManifoldPoint:function(t,e,a){var i=this._manifold._numPoints;if(i==xn.maxManifoldPoints){var n=this.computeTargetIndex(t,e,a),s=this._manifold._points[n],r=t.position1;s._pos1X=r.x,s._pos1Y=r.y,s._pos1Z=r.z;var o,l,_,h,f,u,c=t.position2;s._pos2X=c.x,s._pos2Y=c.y,s._pos2Z=c.z,s._relPos1X=s._pos1X-e._positionX,s._relPos1Y=s._pos1Y-e._positionY,s._relPos1Z=s._pos1Z-e._positionZ,s._relPos2X=s._pos2X-a._positionX,s._relPos2Y=s._pos2Y-a._positionY,s._relPos2Z=s._pos2Z-a._positionZ,o=e._rotation00*s._relPos1X+e._rotation10*s._relPos1Y+e._rotation20*s._relPos1Z,l=e._rotation01*s._relPos1X+e._rotation11*s._relPos1Y+e._rotation21*s._relPos1Z,_=e._rotation02*s._relPos1X+e._rotation12*s._relPos1Y+e._rotation22*s._relPos1Z,s._localPos1X=o,s._localPos1Y=l,s._localPos1Z=_,h=a._rotation00*s._relPos2X+a._rotation10*s._relPos2Y+a._rotation20*s._relPos2Z,f=a._rotation01*s._relPos2X+a._rotation11*s._relPos2Y+a._rotation21*s._relPos2Z,u=a._rotation02*s._relPos2X+a._rotation12*s._relPos2Y+a._rotation22*s._relPos2Z,s._localPos2X=h,s._localPos2Y=f,s._localPos2Z=u,s._depth=t.depth;var d=s._impulse;return d.impulseN=0,d.impulseT=0,d.impulseB=0,d.impulseP=0,d.impulseLX=0,d.impulseLY=0,d.impulseLZ=0,s._id=t.id,s._warmStarted=!1,void(s._disabled=!1)}var g=this._manifold._points[i],p=t.position1;g._pos1X=p.x,g._pos1Y=p.y,g._pos1Z=p.z;var m,v,b,I,M,y,w=t.position2;g._pos2X=w.x,g._pos2Y=w.y,g._pos2Z=w.z,g._relPos1X=g._pos1X-e._positionX,g._relPos1Y=g._pos1Y-e._positionY,g._relPos1Z=g._pos1Z-e._positionZ,g._relPos2X=g._pos2X-a._positionX,g._relPos2Y=g._pos2Y-a._positionY,g._relPos2Z=g._pos2Z-a._positionZ,m=e._rotation00*g._relPos1X+e._rotation10*g._relPos1Y+e._rotation20*g._relPos1Z,v=e._rotation01*g._relPos1X+e._rotation11*g._relPos1Y+e._rotation21*g._relPos1Z,b=e._rotation02*g._relPos1X+e._rotation12*g._relPos1Y+e._rotation22*g._relPos1Z,g._localPos1X=m,g._localPos1Y=v,g._localPos1Z=b,I=a._rotation00*g._relPos2X+a._rotation10*g._relPos2Y+a._rotation20*g._relPos2Z,M=a._rotation01*g._relPos2X+a._rotation11*g._relPos2Y+a._rotation21*g._relPos2Z,y=a._rotation02*g._relPos2X+a._rotation12*g._relPos2Y+a._rotation22*g._relPos2Z,g._localPos2X=I,g._localPos2Y=M,g._localPos2Z=y,g._depth=t.depth;var x=g._impulse;x.impulseN=0,x.impulseT=0,x.impulseB=0,x.impulseP=0,x.impulseLX=0,x.impulseLY=0,x.impulseLZ=0,g._id=t.id,g._warmStarted=!1,g._disabled=!1,this._manifold._numPoints++},computeTargetIndex:function(t,e,a){var i,n,s,r=this._manifold._points[0],o=this._manifold._points[1],l=this._manifold._points[2],_=this._manifold._points[3],h=r._depth,f=0;o._depth>h&&(h=o._depth,f=1),l._depth>h&&(h=l._depth,f=2),_._depth>h&&(h=_._depth,f=3);var u=t.position1;i=u.x,n=u.y,s=u.z,i-=e._positionX,n-=e._positionY,s-=e._positionZ;var c,d,g,p,m,v,b,I,M,y,w,x,C,A,Z,z,B,k,S,X,Y,N,L,G,W,D,T,V,K,j,R,H,P,F,O,E,U,J,Q,q,$,tt,et,at,it,nt,st,rt,ot,lt,_t,ht,ft,ut,ct,dt,gt,pt,mt,vt,bt,It,Mt,yt,wt,xt,Ct,At,Zt,zt,Bt,kt,St,Xt,Yt,Nt,Lt,Gt,Wt,Dt,Tt,Vt,Kt,jt,Rt,Ht,Pt,Ft,Ot,Et,Ut,Jt,Qt,qt,$t,te,ee,ae,ie,ne,se,re,oe,le,_e,he,fe,ue,ce=o._relPos1X,de=o._relPos1Y,ge=o._relPos1Z,pe=l._relPos1X,me=l._relPos1Y,ve=l._relPos1Z,be=_._relPos1X,Ie=_._relPos1Y,Me=_._relPos1Z,ye=(S=(d=me-de)*(v=s-Me)-(g=ve-ge)*(m=n-Ie))*S+(X=g*(p=i-be)-(c=pe-ce)*v)*X+(Y=c*m-d*p)*Y,we=(N=(I=Ie-de)*(x=s-ve)-(M=Me-ge)*(w=n-me))*N+(L=M*(y=i-pe)-(b=be-ce)*x)*L+(G=b*w-I*y)*G,xe=(W=(A=n-de)*(k=Me-ve)-(Z=s-ge)*(B=Ie-me))*W+(D=Z*(z=be-pe)-(C=i-ce)*k)*D+(T=C*B-A*z)*T,Ce=we<ye?xe<ye?ye:xe:xe<we?we:xe,Ae=r._relPos1X,Ze=r._relPos1Y,ze=r._relPos1Z,Be=l._relPos1X,ke=l._relPos1Y,Se=l._relPos1Z,Xe=_._relPos1X,Ye=_._relPos1Y,Ne=_._relPos1Z,Le=(nt=(K=ke-Ze)*(P=s-Ne)-(j=Se-ze)*(H=n-Ye))*nt+(st=j*(R=i-Xe)-(V=Be-Ae)*P)*st+(rt=V*H-K*R)*rt,Ge=(ot=(O=Ye-Ze)*(Q=s-Se)-(E=Ne-ze)*(J=n-ke))*ot+(lt=E*(U=i-Be)-(F=Xe-Ae)*Q)*lt+(_t=F*J-O*U)*_t,We=(ht=($=n-Ze)*(it=Ne-Se)-(tt=s-ze)*(at=Ye-ke))*ht+(ft=tt*(et=Xe-Be)-(q=i-Ae)*it)*ft+(ut=q*at-$*et)*ut,De=Ge<Le?We<Le?Le:We:We<Ge?Ge:We,Te=r._relPos1X,Ve=r._relPos1Y,Ke=r._relPos1Z,je=o._relPos1X,Re=o._relPos1Y,He=o._relPos1Z,Pe=_._relPos1X,Fe=_._relPos1Y,Oe=_._relPos1Z,Ee=(St=(dt=Re-Ve)*(vt=s-Oe)-(gt=He-Ke)*(mt=n-Fe))*St+(Xt=gt*(pt=i-Pe)-(ct=je-Te)*vt)*Xt+(Yt=ct*mt-dt*pt)*Yt,Ue=(Nt=(It=Fe-Ve)*(xt=s-He)-(Mt=Oe-Ke)*(wt=n-Re))*Nt+(Lt=Mt*(yt=i-je)-(bt=Pe-Te)*xt)*Lt+(Gt=bt*wt-It*yt)*Gt,Je=(Wt=(At=n-Ve)*(kt=Oe-He)-(Zt=s-Ke)*(Bt=Fe-Re))*Wt+(Dt=Zt*(zt=Pe-je)-(Ct=i-Te)*kt)*Dt+(Tt=Ct*Bt-At*zt)*Tt,Qe=Ue<Ee?Je<Ee?Ee:Je:Je<Ue?Ue:Je,qe=r._relPos1X,$e=r._relPos1Y,ta=r._relPos1Z,ea=o._relPos1X,aa=o._relPos1Y,ia=o._relPos1Z,na=l._relPos1X,sa=l._relPos1Y,ra=l._relPos1Z,oa=(ne=(Kt=aa-$e)*(Pt=s-ra)-(jt=ia-ta)*(Ht=n-sa))*ne+(se=jt*(Rt=i-na)-(Vt=ea-qe)*Pt)*se+(re=Vt*Ht-Kt*Rt)*re,la=(oe=(Ot=sa-$e)*(Qt=s-ia)-(Et=ra-ta)*(Jt=n-aa))*oe+(le=Et*(Ut=i-ea)-(Ft=na-qe)*Qt)*le+(_e=Ft*Jt-Ot*Ut)*_e,_a=(he=($t=n-$e)*(ie=ra-ia)-(te=s-ta)*(ae=sa-aa))*he+(fe=te*(ee=na-ea)-(qt=i-qe)*ie)*fe+(ue=qt*ae-$t*ee)*ue,ha=la<oa?_a<oa?oa:_a:_a<la?la:_a,fa=Ce,ua=0;return(fa<De&&1!=f||0==f)&&(fa=De,ua=1),fa<Qe&&2!=f&&(fa=Qe,ua=2),fa<ha&&3!=f&&(fa=ha,ua=3),ua},findNearestContactPointIndex:function(t,e,a){for(var i=xn.contactPersistenceThreshold*xn.contactPersistenceThreshold,n=-1,s=0,r=this._manifold._numPoints;s<r;){var o,l,_,h,f,u,c=s++,d=this._manifold._points[c],g=t.position1;o=g.x,l=g.y,_=g.z;var p,m,v,b,I,M,y=t.position2;h=y.x,f=y.y,u=y.z,o-=e._positionX,l-=e._positionY,_-=e._positionZ,h-=a._positionX,f-=a._positionY,u-=a._positionZ;var w=(p=d._relPos1X-o)*p+(m=d._relPos1Y-l)*m+(v=d._relPos1Z-_)*v,x=(b=d._relPos2X-h)*b+(I=d._relPos2Y-f)*I+(M=d._relPos2Z-u)*M,C=w<x?w:x;C<i&&(i=C,n=c)}return n},totalUpdate:function(t,e,a){this.numOldPoints=this._manifold._numPoints;for(var i=0,n=this.numOldPoints;i<n;){var s=i++,r=this.oldPoints[s],o=this._manifold._points[s];r._localPos1X=o._localPos1X,r._localPos1Y=o._localPos1Y,r._localPos1Z=o._localPos1Z,r._localPos2X=o._localPos2X,r._localPos2Y=o._localPos2Y,r._localPos2Z=o._localPos2Z,r._relPos1X=o._relPos1X,r._relPos1Y=o._relPos1Y,r._relPos1Z=o._relPos1Z,r._relPos2X=o._relPos2X,r._relPos2Y=o._relPos2Y,r._relPos2Z=o._relPos2Z,r._pos1X=o._pos1X,r._pos1Y=o._pos1Y,r._pos1Z=o._pos1Z,r._pos2X=o._pos2X,r._pos2Y=o._pos2Y,r._pos2Z=o._pos2Z,r._depth=o._depth,r._impulse.copyFrom(o._impulse),r._id=o._id,r._warmStarted=o._warmStarted,r._disabled=!1}for(var l=t.numPoints,_=0,h=this._manifold._numPoints=l;_<h;){var f=_++,u=this._manifold._points[f],c=t.points[f],d=c.position1;u._pos1X=d.x,u._pos1Y=d.y,u._pos1Z=d.z;var g,p,m,v,b,I,M=c.position2;u._pos2X=M.x,u._pos2Y=M.y,u._pos2Z=M.z,u._relPos1X=u._pos1X-e._positionX,u._relPos1Y=u._pos1Y-e._positionY,u._relPos1Z=u._pos1Z-e._positionZ,u._relPos2X=u._pos2X-a._positionX,u._relPos2Y=u._pos2Y-a._positionY,u._relPos2Z=u._pos2Z-a._positionZ,g=e._rotation00*u._relPos1X+e._rotation10*u._relPos1Y+e._rotation20*u._relPos1Z,p=e._rotation01*u._relPos1X+e._rotation11*u._relPos1Y+e._rotation21*u._relPos1Z,m=e._rotation02*u._relPos1X+e._rotation12*u._relPos1Y+e._rotation22*u._relPos1Z,u._localPos1X=g,u._localPos1Y=p,u._localPos1Z=m,v=a._rotation00*u._relPos2X+a._rotation10*u._relPos2Y+a._rotation20*u._relPos2Z,b=a._rotation01*u._relPos2X+a._rotation11*u._relPos2Y+a._rotation21*u._relPos2Z,I=a._rotation02*u._relPos2X+a._rotation12*u._relPos2Y+a._rotation22*u._relPos2Z,u._localPos2X=v,u._localPos2Y=b,u._localPos2Z=I,u._depth=c.depth;var y=u._impulse;y.impulseN=0,y.impulseT=0,y.impulseB=0,y.impulseP=0,y.impulseLX=0,y.impulseLY=0,y.impulseLZ=0,u._id=c.id,u._warmStarted=!1,u._disabled=!1;for(var w=0,x=this.numOldPoints;w<x;){var C=w++,A=this.oldPoints[C];if(u._id==A._id){u._impulse.copyFrom(A._impulse),u._warmStarted=!0;break}}}},incrementalUpdate:function(t,e,a){this._manifold._updateDepthsAndPositions(e,a);for(var i=0,n=this._manifold._numPoints;i<n;){var s=i++;this._manifold._points[s]._warmStarted=!0}var r=t.points[0],o=this.findNearestContactPointIndex(r,e,a);if(-1==o)this.addManifoldPoint(r,e,a);else{var l=this._manifold._points[o],_=r.position1;l._pos1X=_.x,l._pos1Y=_.y,l._pos1Z=_.z;var h,f,u,c,d,g,p=r.position2;l._pos2X=p.x,l._pos2Y=p.y,l._pos2Z=p.z,l._relPos1X=l._pos1X-e._positionX,l._relPos1Y=l._pos1Y-e._positionY,l._relPos1Z=l._pos1Z-e._positionZ,l._relPos2X=l._pos2X-a._positionX,l._relPos2Y=l._pos2Y-a._positionY,l._relPos2Z=l._pos2Z-a._positionZ,h=e._rotation00*l._relPos1X+e._rotation10*l._relPos1Y+e._rotation20*l._relPos1Z,f=e._rotation01*l._relPos1X+e._rotation11*l._relPos1Y+e._rotation21*l._relPos1Z,u=e._rotation02*l._relPos1X+e._rotation12*l._relPos1Y+e._rotation22*l._relPos1Z,l._localPos1X=h,l._localPos1Y=f,l._localPos1Z=u,c=a._rotation00*l._relPos2X+a._rotation10*l._relPos2Y+a._rotation20*l._relPos2Z,d=a._rotation01*l._relPos2X+a._rotation11*l._relPos2Y+a._rotation21*l._relPos2Z,g=a._rotation02*l._relPos2X+a._rotation12*l._relPos2Y+a._rotation22*l._relPos2Z,l._localPos2X=c,l._localPos2Y=d,l._localPos2Z=g,l._depth=r.depth}this.removeOutdatedPoints()},__class__:Xn};var Yn=function(){this.lin1X=0,this.lin1Y=0,this.lin1Z=0,this.lin2X=0,this.lin2Y=0,this.lin2Z=0,this.ang1X=0,this.ang1Y=0,this.ang1Z=0,this.ang2X=0,this.ang2Y=0,this.ang2Z=0,this.flag=0};(i["oimo.dynamics.constraint.info.JacobianRow"]=Yn).__name__=!0,Yn.prototype={lin1X:null,lin1Y:null,lin1Z:null,lin2X:null,lin2Y:null,lin2Z:null,ang1X:null,ang1Y:null,ang1Z:null,ang2X:null,ang2Y:null,ang2Z:null,flag:null,updateSparsity:function(){(this.flag=0)==this.lin1X&&0==this.lin1Y&&0==this.lin1Z&&0==this.lin2X&&0==this.lin2Y&&0==this.lin2Z||(this.flag|=1),0==this.ang1X&&0==this.ang1Y&&0==this.ang1Z&&0==this.ang2X&&0==this.ang2Y&&0==this.ang2Z||(this.flag|=2)},__class__:Yn};var Nn=function(){this.b1=null,this.b2=null,this.numRows=0;var t=new Array(xn.maxManifoldPoints);this.rows=t;for(var e=0,a=this.rows.length;e<a;){var i=e++;this.rows[i]=new Ln}};(i["oimo.dynamics.constraint.info.contact.ContactSolverInfo"]=Nn).__name__=!0,Nn.prototype={b1:null,b2:null,numRows:null,rows:null,__class__:Nn};var Ln=function(){this.jacobianN=new Yn,this.jacobianT=new Yn,this.jacobianB=new Yn,this.rhs=0,this.cfm=0,this.friction=0,this.impulse=null};(i["oimo.dynamics.constraint.info.contact.ContactSolverInfoRow"]=Ln).__name__=!0,Ln.prototype={jacobianN:null,jacobianT:null,jacobianB:null,rhs:null,cfm:null,friction:null,impulse:null,__class__:Ln};var Gn=function(){this.b1=null,this.b2=null,this.numRows=0;var t=new Array(xn.maxJacobianRows);this.rows=t;for(var e=0,a=this.rows.length;e<a;){var i=e++;this.rows[i]=new Wn}};(i["oimo.dynamics.constraint.info.joint.JointSolverInfo"]=Gn).__name__=!0,Gn.prototype={b1:null,b2:null,numRows:null,rows:null,__class__:Gn};var Wn=function(){this.jacobian=new Yn,this.rhs=0,this.cfm=0,this.minImpulse=0,this.maxImpulse=0,this.motorSpeed=0,this.motorMaxImpulse=0,this.impulse=null};(i["oimo.dynamics.constraint.info.joint.JointSolverInfoRow"]=Wn).__name__=!0,Wn.prototype={jacobian:null,rhs:null,cfm:null,minImpulse:null,maxImpulse:null,motorSpeed:null,motorMaxImpulse:null,impulse:null,__class__:Wn};var Dn=function(t,e){switch(this._link1=new Kn(this),this._link2=new Kn(this),this._positionCorrectionAlgorithm=xn.defaultJointPositionCorrectionAlgorithm,this._type=e,this._world=null,this._b1=t.rigidBody1,this._b2=t.rigidBody2,this._allowCollision=t.allowCollision,this._breakForce=t.breakForce,this._breakTorque=t.breakTorque,t.solverType){case 0:this._solver=new Qn(this);break;case 1:this._solver=new En(this)}var a=t.localAnchor1;this._localAnchor1X=a.x,this._localAnchor1Y=a.y,this._localAnchor1Z=a.z;var i=t.localAnchor2;this._localAnchor2X=i.x,this._localAnchor2Y=i.y,this._localAnchor2Z=i.z,this._relativeAnchor1X=0,this._relativeAnchor1Y=0,this._relativeAnchor1Z=0,this._relativeAnchor2X=0,this._relativeAnchor2Y=0,this._relativeAnchor2Z=0,this._anchor1X=0,this._anchor1Y=0,this._anchor1Z=0,this._anchor2X=0,this._anchor2Y=0,this._anchor2Z=0,this._localBasisX1X=0,this._localBasisX1Y=0,this._localBasisX1Z=0,this._localBasisY1X=0,this._localBasisY1Y=0,this._localBasisY1Z=0,this._localBasisZ1X=0,this._localBasisZ1Y=0,this._localBasisZ1Z=0,this._localBasisX2X=0,this._localBasisX2Y=0,this._localBasisX2Z=0,this._localBasisY2X=0,this._localBasisY2Y=0,this._localBasisY2Z=0,this._localBasisZ2X=0,this._localBasisZ2Y=0,this._localBasisZ2Z=0;var n=new Array(xn.maxJacobianRows);this._impulses=n;for(var s=0,r=xn.maxJacobianRows;s<r;){var o=s++;this._impulses[o]=new Vn}};(i["oimo.dynamics.constraint.joint.Joint"]=Dn).__name__=!0,Dn.prototype={_b1:null,_b2:null,_link1:null,_link2:null,_positionCorrectionAlgorithm:null,_allowCollision:null,_prev:null,_next:null,_world:null,_localAnchor1X:null,_localAnchor1Y:null,_localAnchor1Z:null,_localAnchor2X:null,_localAnchor2Y:null,_localAnchor2Z:null,_relativeAnchor1X:null,_relativeAnchor1Y:null,_relativeAnchor1Z:null,_relativeAnchor2X:null,_relativeAnchor2Y:null,_relativeAnchor2Z:null,_anchor1X:null,_anchor1Y:null,_anchor1Z:null,_anchor2X:null,_anchor2Y:null,_anchor2Z:null,_localBasisX1X:null,_localBasisX1Y:null,_localBasisX1Z:null,_localBasisY1X:null,_localBasisY1Y:null,_localBasisY1Z:null,_localBasisZ1X:null,_localBasisZ1Y:null,_localBasisZ1Z:null,_localBasisX2X:null,_localBasisX2Y:null,_localBasisX2Z:null,_localBasisY2X:null,_localBasisY2Y:null,_localBasisY2Z:null,_localBasisZ2X:null,_localBasisZ2Y:null,_localBasisZ2Z:null,_basisX1X:null,_basisX1Y:null,_basisX1Z:null,_basisY1X:null,_basisY1Y:null,_basisY1Z:null,_basisZ1X:null,_basisZ1Y:null,_basisZ1Z:null,_basisX2X:null,_basisX2Y:null,_basisX2Z:null,_basisY2X:null,_basisY2Y:null,_basisY2Z:null,_basisZ2X:null,_basisZ2Y:null,_basisZ2Z:null,_impulses:null,_appliedForceX:null,_appliedForceY:null,_appliedForceZ:null,_appliedTorqueX:null,_appliedTorqueY:null,_appliedTorqueZ:null,_breakForce:null,_breakTorque:null,_type:null,_solver:null,_syncAnchors:function(){var t,e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b,I,M,y,w,x=this._b1._transform,C=this._b2._transform;t=x._rotation00*this._localAnchor1X+x._rotation01*this._localAnchor1Y+x._rotation02*this._localAnchor1Z,e=x._rotation10*this._localAnchor1X+x._rotation11*this._localAnchor1Y+x._rotation12*this._localAnchor1Z,a=x._rotation20*this._localAnchor1X+x._rotation21*this._localAnchor1Y+x._rotation22*this._localAnchor1Z,this._relativeAnchor1X=t,this._relativeAnchor1Y=e,this._relativeAnchor1Z=a,i=C._rotation00*this._localAnchor2X+C._rotation01*this._localAnchor2Y+C._rotation02*this._localAnchor2Z,n=C._rotation10*this._localAnchor2X+C._rotation11*this._localAnchor2Y+C._rotation12*this._localAnchor2Z,s=C._rotation20*this._localAnchor2X+C._rotation21*this._localAnchor2Y+C._rotation22*this._localAnchor2Z,this._relativeAnchor2X=i,this._relativeAnchor2Y=n,this._relativeAnchor2Z=s,this._anchor1X=this._relativeAnchor1X+x._positionX,this._anchor1Y=this._relativeAnchor1Y+x._positionY,this._anchor1Z=this._relativeAnchor1Z+x._positionZ,this._anchor2X=this._relativeAnchor2X+C._positionX,this._anchor2Y=this._relativeAnchor2Y+C._positionY,this._anchor2Z=this._relativeAnchor2Z+C._positionZ,r=x._rotation00*this._localBasisX1X+x._rotation01*this._localBasisX1Y+x._rotation02*this._localBasisX1Z,o=x._rotation10*this._localBasisX1X+x._rotation11*this._localBasisX1Y+x._rotation12*this._localBasisX1Z,l=x._rotation20*this._localBasisX1X+x._rotation21*this._localBasisX1Y+x._rotation22*this._localBasisX1Z,this._basisX1X=r,this._basisX1Y=o,this._basisX1Z=l,_=x._rotation00*this._localBasisY1X+x._rotation01*this._localBasisY1Y+x._rotation02*this._localBasisY1Z,h=x._rotation10*this._localBasisY1X+x._rotation11*this._localBasisY1Y+x._rotation12*this._localBasisY1Z,f=x._rotation20*this._localBasisY1X+x._rotation21*this._localBasisY1Y+x._rotation22*this._localBasisY1Z,this._basisY1X=_,this._basisY1Y=h,this._basisY1Z=f,u=x._rotation00*this._localBasisZ1X+x._rotation01*this._localBasisZ1Y+x._rotation02*this._localBasisZ1Z,c=x._rotation10*this._localBasisZ1X+x._rotation11*this._localBasisZ1Y+x._rotation12*this._localBasisZ1Z,d=x._rotation20*this._localBasisZ1X+x._rotation21*this._localBasisZ1Y+x._rotation22*this._localBasisZ1Z,this._basisZ1X=u,this._basisZ1Y=c,this._basisZ1Z=d,g=C._rotation00*this._localBasisX2X+C._rotation01*this._localBasisX2Y+C._rotation02*this._localBasisX2Z,p=C._rotation10*this._localBasisX2X+C._rotation11*this._localBasisX2Y+C._rotation12*this._localBasisX2Z,m=C._rotation20*this._localBasisX2X+C._rotation21*this._localBasisX2Y+C._rotation22*this._localBasisX2Z,this._basisX2X=g,this._basisX2Y=p,this._basisX2Z=m,v=C._rotation00*this._localBasisY2X+C._rotation01*this._localBasisY2Y+C._rotation02*this._localBasisY2Z,b=C._rotation10*this._localBasisY2X+C._rotation11*this._localBasisY2Y+C._rotation12*this._localBasisY2Z,I=C._rotation20*this._localBasisY2X+C._rotation21*this._localBasisY2Y+C._rotation22*this._localBasisY2Z,this._basisY2X=v,this._basisY2Y=b,this._basisY2Z=I,M=C._rotation00*this._localBasisZ2X+C._rotation01*this._localBasisZ2Y+C._rotation02*this._localBasisZ2Z,y=C._rotation10*this._localBasisZ2X+C._rotation11*this._localBasisZ2Y+C._rotation12*this._localBasisZ2Z,w=C._rotation20*this._localBasisZ2X+C._rotation21*this._localBasisZ2Y+C._rotation22*this._localBasisZ2Z,this._basisZ2X=M,this._basisZ2Y=y,this._basisZ2Z=w},_getVelocitySolverInfo:function(t,e){e.b1=this._b1,e.b2=this._b2,e.numRows=0},_getPositionSolverInfo:function(t){t.b1=this._b1,t.b2=this._b2,t.numRows=0},_checkDestruction:function(){var t=this._appliedForceX*this._appliedForceX+this._appliedForceY*this._appliedForceY+this._appliedForceZ*this._appliedForceZ,e=this._appliedTorqueX*this._appliedTorqueX+this._appliedTorqueY*this._appliedTorqueY+this._appliedTorqueZ*this._appliedTorqueZ;0<this._breakForce&&t>this._breakForce*this._breakForce?this._world.removeJoint(this):0<this._breakTorque&&e>this._breakTorque*this._breakTorque&&this._world.removeJoint(this)},__class__:Dn};var Tn=function(){this.rigidBody1=null,this.rigidBody2=null,this.localAnchor1=new Et,this.localAnchor2=new Et,this.allowCollision=!1,this.solverType=xn.defaultJointConstraintSolverType,this.positionCorrectionAlgorithm=xn.defaultJointPositionCorrectionAlgorithm,this.breakForce=0,this.breakTorque=0};(i["oimo.dynamics.constraint.joint.JointConfig"]=Tn).__name__=!0,Tn.prototype={rigidBody1:null,rigidBody2:null,localAnchor1:null,localAnchor2:null,allowCollision:null,solverType:null,positionCorrectionAlgorithm:null,breakForce:null,breakTorque:null,__class__:Tn};var Vn=function(){this.impulse=0,this.impulseM=0,this.impulseP=0};(i["oimo.dynamics.constraint.joint.JointImpulse"]=Vn).__name__=!0,Vn.prototype={impulse:null,impulseM:null,impulseP:null,__class__:Vn};var Kn=function(t){this._joint=t};(i["oimo.dynamics.constraint.joint.JointLink"]=Kn).__name__=!0,Kn.prototype={_prev:null,_next:null,_joint:null,_other:null,__class__:Kn};var jn=function(){this.invMLinN1X=0,this.invMLinN1Y=0,this.invMLinN1Z=0,this.invMLinN2X=0,this.invMLinN2Y=0,this.invMLinN2Z=0,this.invMAngN1X=0,this.invMAngN1Y=0,this.invMAngN1Z=0,this.invMAngN2X=0,this.invMAngN2Y=0,this.invMAngN2Z=0,this.invMLinT1X=0,this.invMLinT1Y=0,this.invMLinT1Z=0,this.invMLinT2X=0,this.invMLinT2Y=0,this.invMLinT2Z=0,this.invMAngT1X=0,this.invMAngT1Y=0,this.invMAngT1Z=0,this.invMAngT2X=0,this.invMAngT2Y=0,this.invMAngT2Z=0,this.invMLinB1X=0,this.invMLinB1Y=0,this.invMLinB1Z=0,this.invMLinB2X=0,this.invMLinB2Y=0,this.invMLinB2Z=0,this.invMAngB1X=0,this.invMAngB1Y=0,this.invMAngB1Z=0,this.invMAngB2X=0,this.invMAngB2Y=0,this.invMAngB2Z=0,this.massN=0,this.massTB00=0,this.massTB01=0,this.massTB10=0,this.massTB11=0};(i["oimo.dynamics.constraint.solver.common.ContactSolverMassDataRow"]=jn).__name__=!0,jn.prototype={invMLinN1X:null,invMLinN1Y:null,invMLinN1Z:null,invMLinN2X:null,invMLinN2Y:null,invMLinN2Z:null,invMAngN1X:null,invMAngN1Y:null,invMAngN1Z:null,invMAngN2X:null,invMAngN2Y:null,invMAngN2Z:null,invMLinT1X:null,invMLinT1Y:null,invMLinT1Z:null,invMLinT2X:null,invMLinT2Y:null,invMLinT2Z:null,invMAngT1X:null,invMAngT1Y:null,invMAngT1Z:null,invMAngT2X:null,invMAngT2Y:null,invMAngT2Z:null,invMLinB1X:null,invMLinB1Y:null,invMLinB1Z:null,invMLinB2X:null,invMLinB2Y:null,invMLinB2Z:null,invMAngB1X:null,invMAngB1Y:null,invMAngB1Z:null,invMAngB2X:null,invMAngB2Y:null,invMAngB2Z:null,massN:null,massTB00:null,massTB01:null,massTB10:null,massTB11:null,__class__:jn};var Rn=function(){this.invMLin1X=0,this.invMLin1Y=0,this.invMLin1Z=0,this.invMLin2X=0,this.invMLin2Y=0,this.invMLin2Z=0,this.invMAng1X=0,this.invMAng1Y=0,this.invMAng1Z=0,this.invMAng2X=0,this.invMAng2Y=0,this.invMAng2Z=0,this.mass=0,this.massWithoutCfm=0};(i["oimo.dynamics.constraint.solver.common.JointSolverMassDataRow"]=Rn).__name__=!0,Rn.prototype={invMLin1X:null,invMLin1Y:null,invMLin1Z:null,invMLin2X:null,invMLin2Y:null,invMLin2Z:null,invMAng1X:null,invMAng1Y:null,invMAng1Z:null,invMAng2X:null,invMAng2Y:null,invMAng2Z:null,mass:null,massWithoutCfm:null,__class__:Rn};var Hn=function(t){var e=new Array(t);this.iBounded=e;var a=new Array(t);this.iUnbounded=a;var i=new Array(t);this.signs=i;var n=new Array(t);this.b=n,this.numBounded=0,this.numUnbounded=0,this.matrixId=0};(i["oimo.dynamics.constraint.solver.direct.Boundary"]=Hn).__name__=!0,Hn.prototype={numBounded:null,iBounded:null,signs:null,numUnbounded:null,iUnbounded:null,b:null,matrixId:null,init:function(t){this.numBounded=t.numBounded;for(var e=0,a=this.numBounded;e<a;){var i=e++;this.iBounded[i]=t.iBounded[i],this.signs[i]=t.signs[i]}this.numUnbounded=t.numUnbounded;for(var n=this.matrixId=0,s=this.numUnbounded;n<s;){var r=n++,o=t.iUnbounded[r];this.iUnbounded[r]=o,this.matrixId|=1<<o}},computeImpulses:function(t,e,a,i,n,s,r){for(var o=0,l=this.numUnbounded;o<l;){var _=o++,h=this.iUnbounded[_],f=t.rows[h],u=a[h];this.b[h]=f.rhs*s-u-f.cfm*i[h]}for(var c=e._invMassWithoutCfm,d=0,g=this.numBounded;d<g;){var p=d++,m=this.iBounded[p],v=this.signs[p],b=t.rows[m],I=i[m],M=(v<0?b.minImpulse:0<v?b.maxImpulse:0)-I;if(0!=(n[m]=M))for(var y=0,w=this.numUnbounded;y<w;){var x=y++,C=this.iUnbounded[x],A=c[m][C]*M,Z=C,z=this.b;z[Z]=z[Z]-A}}for(var B,k=this.iUnbounded,S=this.numUnbounded,X=0,Y=0,N=S;Y<N;){X|=1<<k[Y++]}e._cacheComputed[X]||(e.computeSubmatrix(X,k,S),e._cacheComputed[X]=!0),B=e._cachedSubmatrices[X];for(var L=!0,G=0,W=this.numUnbounded;G<W;){for(var D=G++,T=this.iUnbounded[D],V=t.rows[T],K=i[T],j=K,R=0,H=this.numUnbounded;R<H;){var P=R++,F=this.iUnbounded[P];j+=this.b[F]*B[D][P]}if(j<V.minImpulse-xn.directMlcpSolverEps||j>V.maxImpulse+xn.directMlcpSolverEps){L=!1;break}n[T]=j-K}if(r)return!0;if(!L)return!1;for(var O=0,E=this.numBounded;O<E;){for(var U,J=O++,Q=this.iBounded[J],q=t.rows[Q],$=this.signs[J],tt=i[Q]+n[Q],et=a[Q],at=0,it=t.numRows;at<it;){var nt=at++;et+=c[Q][nt]*n[nt]}if(U=q.rhs*s-et-q.cfm*tt,$<0&&U>xn.directMlcpSolverEps||0<$&&U<-xn.directMlcpSolverEps){L=!1;break}}return L},__class__:Hn};var Pn=function(t){this.size=t,this.numBounded=0;var e=new Array(t);this.iBounded=e;var a=new Array(t);this.signs=a,this.numUnbounded=0;var i=new Array(t);this.iUnbounded=i};(i["oimo.dynamics.constraint.solver.direct.BoundaryBuildInfo"]=Pn).__name__=!0,Pn.prototype={size:null,numBounded:null,iBounded:null,signs:null,numUnbounded:null,iUnbounded:null,__class__:Pn};var Fn=function(t){this.maxRows=t,this.numBoundaries=0;var e=new Array(1<<t);this.boundaries=e,this.bbInfo=new Pn(t)};(i["oimo.dynamics.constraint.solver.direct.BoundaryBuilder"]=Fn).__name__=!0,Fn.prototype={numBoundaries:null,boundaries:null,maxRows:null,bbInfo:null,buildBoundariesRecursive:function(t,e){if(e==t.numRows)return null==this.boundaries[this.numBoundaries]&&(this.boundaries[this.numBoundaries]=new Hn(this.maxRows)),void this.boundaries[this.numBoundaries++].init(this.bbInfo);var a=t.rows[e],i=a.minImpulse>-1/0,n=a.maxImpulse<1/0;if(0==a.minImpulse&&0==a.maxImpulse){var s=this.bbInfo;return s.iBounded[s.numBounded]=e,s.signs[s.numBounded]=0,s.numBounded++,this.buildBoundariesRecursive(t,e+1),void this.bbInfo.numBounded--}var r=this.bbInfo;if(r.iUnbounded[r.numUnbounded]=e,r.numUnbounded++,this.buildBoundariesRecursive(t,e+1),this.bbInfo.numUnbounded--,i){var o=this.bbInfo;o.iBounded[o.numBounded]=e,o.signs[o.numBounded]=-1,o.numBounded++,this.buildBoundariesRecursive(t,e+1),this.bbInfo.numBounded--}if(n){var l=this.bbInfo;l.iBounded[l.numBounded]=e,l.signs[l.numBounded]=1,l.numBounded++,this.buildBoundariesRecursive(t,e+1),this.bbInfo.numBounded--}},__class__:Fn};var On=function(t){this.n=t;var e=new Array(t);this.indices=e;var a=new Array(t);this.tmpIndices=a;for(var i=0,n=t;i<n;){var s=i++;this.indices[s]=s}};(i["oimo.dynamics.constraint.solver.direct.BoundarySelector"]=On).__name__=!0,On.prototype={n:null,indices:null,tmpIndices:null,__class__:On};var En=function(t){An.call(this),this.joint=t,this.info=new Gn;var e=xn.maxJacobianRows;this.massMatrix=new Un(e),this.boundaryBuilder=new Fn(e);var a=new Array(e);this.massData=a;for(var i=0,n=this.massData.length;i<n;){var s=i++;this.massData[s]=new Rn}var r=this.boundaryBuilder.boundaries.length;this.velBoundarySelector=new On(r),this.posBoundarySelector=new On(r);var o=new Array(e);this.relVels=o;var l=new Array(e);this.impulses=l;var _=new Array(e);this.dImpulses=_;var h=new Array(e);this.dTotalImpulses=h;for(var f=0,u=e;f<u;){var c=f++;this.relVels[c]=0,this.impulses[c]=0,this.dImpulses[c]=0,this.dTotalImpulses[c]=0}};(i["oimo.dynamics.constraint.solver.direct.DirectJointConstraintSolver"]=En).__name__=!0,En.__super__=An,En.prototype=s(An.prototype,{info:null,massData:null,relVels:null,impulses:null,dImpulses:null,dTotalImpulses:null,joint:null,massMatrix:null,boundaryBuilder:null,velBoundarySelector:null,posBoundarySelector:null,preSolveVelocity:function(t){this.joint._syncAnchors(),this.joint._getVelocitySolverInfo(t,this.info),this._b1=this.info.b1,this._b2=this.info.b2,this.massMatrix.computeInvMass(this.info,this.massData);var e=this.boundaryBuilder;e.numBoundaries=0;var a=e.bbInfo;a.numBounded=0,a.numUnbounded=0,e.buildBoundariesRecursive(this.info,0);for(var i=this.velBoundarySelector,n=this.boundaryBuilder.numBoundaries,s=0,r=0,o=0,l=i.n;o<l;){var _=o++,h=i.indices[_];h<n?(i.tmpIndices[s]=h,++s):(i.tmpIndices[n+r]=h,++r)}var f=i.indices;i.indices=i.tmpIndices,i.tmpIndices=f},warmStart:function(t){var e=this.joint._positionCorrectionAlgorithm==Zn.BAUMGARTE?xn.jointWarmStartingFactorForBaungarte:xn.jointWarmStartingFactor;if((e*=t.dtRatio)<=0)for(var a=0,i=this.info.numRows;a<i;){var n=a++,s=this.info.rows[n].impulse;s.impulse=0,s.impulseM=0,s.impulseP=0}else{for(var r=0,o=this.info.numRows;r<o;){var l=r++,_=this.info.rows[l],h=_.impulse,f=h.impulse*e;if(f<_.minImpulse?f=_.minImpulse:f>_.maxImpulse&&(f=_.maxImpulse),h.impulse=f,0<_.motorMaxImpulse){var u=h.impulseM*e,c=_.motorMaxImpulse;u<-c?u=-c:c<u&&(u=c),h.impulseM=u}else h.impulseM=0;this.dImpulses[l]=h.impulse+h.impulseM}var d,g,p,m,v,b,I,M,y,w,x,C,A=this.dImpulses,Z=!1,z=!1;d=this._b1._velX,g=this._b1._velY,p=this._b1._velZ,m=this._b2._velX,v=this._b2._velY,b=this._b2._velZ,I=this._b1._angVelX,M=this._b1._angVelY,y=this._b1._angVelZ,w=this._b2._angVelX,x=this._b2._angVelY,C=this._b2._angVelZ;for(var B=0,k=this.info.numRows;B<k;){var S=B++,X=this.info.rows[S].jacobian,Y=this.massData[S],N=A[S];0!=(1&X.flag)&&(d+=Y.invMLin1X*N,g+=Y.invMLin1Y*N,p+=Y.invMLin1Z*N,m+=Y.invMLin2X*-N,v+=Y.invMLin2Y*-N,b+=Y.invMLin2Z*-N,Z=!0),0!=(2&X.flag)&&(I+=Y.invMAng1X*N,M+=Y.invMAng1Y*N,y+=Y.invMAng1Z*N,w+=Y.invMAng2X*-N,x+=Y.invMAng2Y*-N,C+=Y.invMAng2Z*-N,z=!0)}Z&&(this._b1._velX=d,this._b1._velY=g,this._b1._velZ=p,this._b2._velX=m,this._b2._velY=v,this._b2._velZ=b),z&&(this._b1._angVelX=I,this._b1._angVelY=M,this._b1._angVelZ=y,this._b2._angVelX=w,this._b2._angVelY=x,this._b2._angVelZ=C)}},solveVelocity:function(){var t,e,a,i,n,s,r,o,l,_,h,f,u=this.info.numRows;t=this._b1._velX,e=this._b1._velY,a=this._b1._velZ,i=this._b2._velX,n=this._b2._velY,s=this._b2._velZ,r=this._b1._angVelX,o=this._b1._angVelY,l=this._b1._angVelZ,_=this._b2._angVelX,h=this._b2._angVelY,f=this._b2._angVelZ;for(var c=0,d=u;c<d;){var g=c++,p=this.info.rows[g],m=p.impulse,v=p.jacobian,b=0;b+=t*v.lin1X+e*v.lin1Y+a*v.lin1Z,b-=i*v.lin2X+n*v.lin2Y+s*v.lin2Z,b+=r*v.ang1X+o*v.ang1Y+l*v.ang1Z,b-=_*v.ang2X+h*v.ang2Y+f*v.ang2Z,this.relVels[g]=b,this.impulses[g]=m.impulse,this.dTotalImpulses[g]=0}for(var I=this.massMatrix._invMassWithoutCfm,M=0,y=u;M<y;){var w=M++,x=this.info.rows[w],C=x.impulse,A=this.massData[w];if(0<x.motorMaxImpulse){var Z=C.impulseM,z=Z+A.massWithoutCfm*(-x.motorSpeed-this.relVels[w]),B=C.impulseM;z<-B?z=-B:B<z&&(z=B);var k=(C.impulseM=z)-Z;this.dTotalImpulses[w]=k;for(var S=0,X=u;S<X;){var Y=S++,N=Y,L=this.relVels;L[N]=L[N]+k*I[w][Y]}}}for(var G=!1,W=0,D=this.boundaryBuilder.numBoundaries;W<D;){var T=W++,V=this.velBoundarySelector.indices[T];if(this.boundaryBuilder.boundaries[V].computeImpulses(this.info,this.massMatrix,this.relVels,this.impulses,this.dImpulses,1,!1)){for(var K=0,j=u;K<j;){var R=K++,H=this.info.rows[R].impulse,P=this.dImpulses[R];H.impulse+=P;var F=R,O=this.dTotalImpulses;O[F]=O[F]+P}var E,U,J,Q,q,$,tt,et,at,it,nt,st,rt=this.dTotalImpulses,ot=!1,lt=!1;E=this._b1._velX,U=this._b1._velY,J=this._b1._velZ,Q=this._b2._velX,q=this._b2._velY,$=this._b2._velZ,tt=this._b1._angVelX,et=this._b1._angVelY,at=this._b1._angVelZ,it=this._b2._angVelX,nt=this._b2._angVelY,st=this._b2._angVelZ;for(var _t=0,ht=this.info.numRows;_t<ht;){var ft=_t++,ut=this.info.rows[ft].jacobian,ct=this.massData[ft],dt=rt[ft];0!=(1&ut.flag)&&(E+=ct.invMLin1X*dt,U+=ct.invMLin1Y*dt,J+=ct.invMLin1Z*dt,Q+=ct.invMLin2X*-dt,q+=ct.invMLin2Y*-dt,$+=ct.invMLin2Z*-dt,ot=!0),0!=(2&ut.flag)&&(tt+=ct.invMAng1X*dt,et+=ct.invMAng1Y*dt,at+=ct.invMAng1Z*dt,it+=ct.invMAng2X*-dt,nt+=ct.invMAng2Y*-dt,st+=ct.invMAng2Z*-dt,lt=!0)}ot&&(this._b1._velX=E,this._b1._velY=U,this._b1._velZ=J,this._b2._velX=Q,this._b2._velY=q,this._b2._velZ=$),lt&&(this._b1._angVelX=tt,this._b1._angVelY=et,this._b1._angVelZ=at,this._b2._angVelX=it,this._b2._angVelY=nt,this._b2._angVelZ=st);for(var gt=this.velBoundarySelector,pt=0;gt.indices[pt]!=V;)++pt;for(;0<pt;){var mt=gt.indices[pt];gt.indices[pt]=gt.indices[pt-1],gt.indices[pt-1]=mt,--pt}G=!0;break}}G||Fe.trace("could not find solution. (velocity)",{fileName:"Sources/oimo/dynamics/constraint/solver/direct/DirectJointConstraintSolver.hx",lineNumber:338,className:"oimo.dynamics.constraint.solver.direct.DirectJointConstraintSolver",methodName:"solveVelocity"})},postSolveVelocity:function(t){for(var e,a,i,n,s,r,o=r=s=n=i=a=e=0,l=this.info.numRows;o<l;){var _=o++,h=this.info.rows[_],f=h.impulse,u=h.jacobian;0!=(1&u.flag)?(e+=u.lin1X*f.impulse,a+=u.lin1Y*f.impulse,i+=u.lin1Z*f.impulse):0!=(2&u.flag)&&(n+=u.ang1X*f.impulse,s+=u.ang1Y*f.impulse,r+=u.ang1Z*f.impulse)}this.joint._appliedForceX=e*t.invDt,this.joint._appliedForceY=a*t.invDt,this.joint._appliedForceZ=i*t.invDt,this.joint._appliedTorqueX=n*t.invDt,this.joint._appliedTorqueY=s*t.invDt,this.joint._appliedTorqueZ=r*t.invDt},preSolvePosition:function(t){this.joint._syncAnchors(),this.joint._getPositionSolverInfo(this.info),this._b1=this.info.b1,this._b2=this.info.b2,this.massMatrix.computeInvMass(this.info,this.massData);var e=this.boundaryBuilder;e.numBoundaries=0;var a=e.bbInfo;a.numBounded=0,a.numUnbounded=0,e.buildBoundariesRecursive(this.info,0);for(var i=this.posBoundarySelector,n=this.boundaryBuilder.numBoundaries,s=0,r=0,o=0,l=i.n;o<l;){var _=o++,h=i.indices[_];h<n?(i.tmpIndices[s]=h,++s):(i.tmpIndices[n+r]=h,++r)}var f=i.indices;i.indices=i.tmpIndices,i.tmpIndices=f;for(var u=0,c=this.info.numRows;u<c;){var d=u++;this.info.rows[d].impulse.impulseP=0}},solvePositionSplitImpulse:function(){var t,e,a,i,n,s,r,o,l,_,h,f,u=this.info.numRows;t=this._b1._pseudoVelX,e=this._b1._pseudoVelY,a=this._b1._pseudoVelZ,i=this._b2._pseudoVelX,n=this._b2._pseudoVelY,s=this._b2._pseudoVelZ,r=this._b1._angPseudoVelX,o=this._b1._angPseudoVelY,l=this._b1._angPseudoVelZ,_=this._b2._angPseudoVelX,h=this._b2._angPseudoVelY,f=this._b2._angPseudoVelZ;for(var c=0,d=u;c<d;){var g=c++,p=this.info.rows[g],m=p.impulse,v=p.jacobian,b=0;b+=t*v.lin1X+e*v.lin1Y+a*v.lin1Z,b-=i*v.lin2X+n*v.lin2Y+s*v.lin2Z,b+=r*v.ang1X+o*v.ang1Y+l*v.ang1Z,b-=_*v.ang2X+h*v.ang2Y+f*v.ang2Z,this.relVels[g]=b,this.impulses[g]=m.impulseP}for(var I=!1,M=0,y=this.boundaryBuilder.numBoundaries;M<y;){var w=M++,x=this.posBoundarySelector.indices[w];if(this.boundaryBuilder.boundaries[x].computeImpulses(this.info,this.massMatrix,this.relVels,this.impulses,this.dImpulses,xn.positionSplitImpulseBaumgarte,!1)){for(var C=0,A=u;C<A;){var Z=C++,z=this.info.rows[Z].impulse,B=this.dImpulses[Z];z.impulseP+=B}var k,S,X,Y,N,L,G,W,D,T,V,K,j=this.dImpulses,R=!1,H=!1;k=this._b1._pseudoVelX,S=this._b1._pseudoVelY,X=this._b1._pseudoVelZ,Y=this._b2._pseudoVelX,N=this._b2._pseudoVelY,L=this._b2._pseudoVelZ,G=this._b1._angPseudoVelX,W=this._b1._angPseudoVelY,D=this._b1._angPseudoVelZ,T=this._b2._angPseudoVelX,V=this._b2._angPseudoVelY,K=this._b2._angPseudoVelZ;for(var P=0,F=this.info.numRows;P<F;){var O=P++,E=this.info.rows[O].jacobian,U=this.massData[O],J=j[O];0!=(1&E.flag)&&(k+=U.invMLin1X*J,S+=U.invMLin1Y*J,X+=U.invMLin1Z*J,Y+=U.invMLin2X*-J,N+=U.invMLin2Y*-J,L+=U.invMLin2Z*-J,R=!0),0!=(2&E.flag)&&(G+=U.invMAng1X*J,W+=U.invMAng1Y*J,D+=U.invMAng1Z*J,T+=U.invMAng2X*-J,V+=U.invMAng2Y*-J,K+=U.invMAng2Z*-J,H=!0)}R&&(this._b1._pseudoVelX=k,this._b1._pseudoVelY=S,this._b1._pseudoVelZ=X,this._b2._pseudoVelX=Y,this._b2._pseudoVelY=N,this._b2._pseudoVelZ=L),H&&(this._b1._angPseudoVelX=G,this._b1._angPseudoVelY=W,this._b1._angPseudoVelZ=D,this._b2._angPseudoVelX=T,this._b2._angPseudoVelY=V,this._b2._angPseudoVelZ=K);for(var Q=this.posBoundarySelector,q=0;Q.indices[q]!=x;)++q;for(;0<q;){var $=Q.indices[q];Q.indices[q]=Q.indices[q-1],Q.indices[q-1]=$,--q}I=!0;break}}I||Fe.trace("could not find solution. (split impulse)",{fileName:"Sources/oimo/dynamics/constraint/solver/direct/DirectJointConstraintSolver.hx",lineNumber:454,className:"oimo.dynamics.constraint.solver.direct.DirectJointConstraintSolver",methodName:"solvePositionSplitImpulse"})},solvePositionNgs:function(t){this.joint._syncAnchors(),this.joint._getPositionSolverInfo(this.info),this._b1=this.info.b1,this._b2=this.info.b2,this.massMatrix.computeInvMass(this.info,this.massData);var e=this.boundaryBuilder;e.numBoundaries=0;var a=e.bbInfo;a.numBounded=0,a.numUnbounded=0,e.buildBoundariesRecursive(this.info,0);for(var i=this.posBoundarySelector,n=this.boundaryBuilder.numBoundaries,s=0,r=0,o=0,l=i.n;o<l;){var _=o++,h=i.indices[_];h<n?(i.tmpIndices[s]=h,++s):(i.tmpIndices[n+r]=h,++r)}var f=i.indices;i.indices=i.tmpIndices,i.tmpIndices=f;for(var u=this.info.numRows,c=0,d=u;c<d;){var g=c++,p=this.info.rows[g],m=p.impulse;p.jacobian;this.relVels[g]=0,this.impulses[g]=m.impulseP}for(var v=!1,b=0,I=this.boundaryBuilder.numBoundaries;b<I;){var M=b++,y=this.posBoundarySelector.indices[M];if(this.boundaryBuilder.boundaries[y].computeImpulses(this.info,this.massMatrix,this.relVels,this.impulses,this.dImpulses,xn.positionNgsBaumgarte,!1)){for(var w=0,x=u;w<x;){var C=w++,A=this.info.rows[C].impulse,Z=this.dImpulses[C];A.impulseP+=Z}for(var z,B,k,S,X,Y,N,L,G,W,D,T,V=this.dImpulses,K=!1,j=!1,R=T=D=W=G=L=N=Y=X=S=k=B=z=0,H=this.info.numRows;R<H;){var P=R++,F=this.info.rows[P].jacobian,O=this.massData[P],E=V[P];0!=(1&F.flag)&&(z+=O.invMLin1X*E,B+=O.invMLin1Y*E,k+=O.invMLin1Z*E,S+=O.invMLin2X*-E,X+=O.invMLin2Y*-E,Y+=O.invMLin2Z*-E,K=!0),0!=(2&F.flag)&&(N+=O.invMAng1X*E,L+=O.invMAng1Y*E,G+=O.invMAng1Z*E,W+=O.invMAng2X*-E,D+=O.invMAng2Y*-E,T+=O.invMAng2Z*-E,j=!0)}if(K){var U=this._b1;U._transform._positionX+=z,U._transform._positionY+=B,U._transform._positionZ+=k;var J=this._b2;J._transform._positionX+=S,J._transform._positionY+=X,J._transform._positionZ+=Y}if(j){var Q,q,$,tt,et,at,it,nt,st,rt,ot=this._b1,lt=Math.sqrt(N*N+L*L+G*G),_t=.5*lt;if(_t<.5){var ht=_t*_t;Q=.5*(1-.16666666666666666*ht+ht*ht*.008333333333333333),q=1-.5*ht+ht*ht*.041666666666666664}else Q=Math.sin(_t)/lt,q=Math.cos(_t);$=N*Q,tt=L*Q,et=G*Q,at=q;var ft,ut=ot._transform._rotation00,ct=ot._transform._rotation11,dt=ot._transform._rotation22,gt=ut+ct+dt;0<gt?(rt=.5*(ft=Math.sqrt(gt+1)),ft=.5/ft,it=(ot._transform._rotation21-ot._transform._rotation12)*ft,nt=(ot._transform._rotation02-ot._transform._rotation20)*ft,st=(ot._transform._rotation10-ot._transform._rotation01)*ft):ct<ut?dt<ut?(it=.5*(ft=Math.sqrt(ut-ct-dt+1)),ft=.5/ft,nt=(ot._transform._rotation01+ot._transform._rotation10)*ft,st=(ot._transform._rotation02+ot._transform._rotation20)*ft,rt=(ot._transform._rotation21-ot._transform._rotation12)*ft):(st=.5*(ft=Math.sqrt(dt-ut-ct+1)),ft=.5/ft,it=(ot._transform._rotation02+ot._transform._rotation20)*ft,nt=(ot._transform._rotation12+ot._transform._rotation21)*ft,rt=(ot._transform._rotation10-ot._transform._rotation01)*ft):dt<ct?(nt=.5*(ft=Math.sqrt(ct-dt-ut+1)),ft=.5/ft,it=(ot._transform._rotation01+ot._transform._rotation10)*ft,st=(ot._transform._rotation12+ot._transform._rotation21)*ft,rt=(ot._transform._rotation02-ot._transform._rotation20)*ft):(st=.5*(ft=Math.sqrt(dt-ut-ct+1)),ft=.5/ft,it=(ot._transform._rotation02+ot._transform._rotation20)*ft,nt=(ot._transform._rotation12+ot._transform._rotation21)*ft,rt=(ot._transform._rotation10-ot._transform._rotation01)*ft);var pt=(it=at*it+$*rt+tt*st-et*nt)*it+(nt=at*nt-$*st+tt*rt+et*it)*nt+(st=at*st+$*nt-tt*it+et*rt)*st+(rt=at*rt-$*it-tt*nt-et*st)*rt;1e-32<pt&&(pt=1/Math.sqrt(pt));it*=pt,nt*=pt,st*=pt,rt*=pt;var mt,vt,bt,It,Mt,yt,wt,xt,Ct,At,Zt,zt,Bt,kt,St,Xt,Yt,Nt,Lt=2*it,Gt=2*nt,Wt=2*st,Dt=it*Lt,Tt=nt*Gt,Vt=st*Wt,Kt=it*Gt,jt=nt*Wt,Rt=it*Wt,Ht=rt*Lt,Pt=rt*Gt,Ft=rt*Wt;ot._transform._rotation00=1-Tt-Vt,ot._transform._rotation01=Kt-Ft,ot._transform._rotation02=Rt+Pt,ot._transform._rotation10=Kt+Ft,ot._transform._rotation11=1-Dt-Vt,ot._transform._rotation12=jt-Ht,ot._transform._rotation20=Rt-Pt,ot._transform._rotation21=jt+Ht,ot._transform._rotation22=1-Dt-Tt,mt=ot._transform._rotation00*ot._invLocalInertia00+ot._transform._rotation01*ot._invLocalInertia10+ot._transform._rotation02*ot._invLocalInertia20,vt=ot._transform._rotation00*ot._invLocalInertia01+ot._transform._rotation01*ot._invLocalInertia11+ot._transform._rotation02*ot._invLocalInertia21,bt=ot._transform._rotation00*ot._invLocalInertia02+ot._transform._rotation01*ot._invLocalInertia12+ot._transform._rotation02*ot._invLocalInertia22,It=ot._transform._rotation10*ot._invLocalInertia00+ot._transform._rotation11*ot._invLocalInertia10+ot._transform._rotation12*ot._invLocalInertia20,Mt=ot._transform._rotation10*ot._invLocalInertia01+ot._transform._rotation11*ot._invLocalInertia11+ot._transform._rotation12*ot._invLocalInertia21,yt=ot._transform._rotation10*ot._invLocalInertia02+ot._transform._rotation11*ot._invLocalInertia12+ot._transform._rotation12*ot._invLocalInertia22,wt=ot._transform._rotation20*ot._invLocalInertia00+ot._transform._rotation21*ot._invLocalInertia10+ot._transform._rotation22*ot._invLocalInertia20,xt=ot._transform._rotation20*ot._invLocalInertia01+ot._transform._rotation21*ot._invLocalInertia11+ot._transform._rotation22*ot._invLocalInertia21,Ct=ot._transform._rotation20*ot._invLocalInertia02+ot._transform._rotation21*ot._invLocalInertia12+ot._transform._rotation22*ot._invLocalInertia22,ot._invInertia00=mt,ot._invInertia01=vt,ot._invInertia02=bt,ot._invInertia10=It,ot._invInertia11=Mt,ot._invInertia12=yt,ot._invInertia20=wt,ot._invInertia21=xt,ot._invInertia22=Ct,At=ot._invInertia00*ot._transform._rotation00+ot._invInertia01*ot._transform._rotation01+ot._invInertia02*ot._transform._rotation02,Zt=ot._invInertia00*ot._transform._rotation10+ot._invInertia01*ot._transform._rotation11+ot._invInertia02*ot._transform._rotation12,zt=ot._invInertia00*ot._transform._rotation20+ot._invInertia01*ot._transform._rotation21+ot._invInertia02*ot._transform._rotation22,Bt=ot._invInertia10*ot._transform._rotation00+ot._invInertia11*ot._transform._rotation01+ot._invInertia12*ot._transform._rotation02,kt=ot._invInertia10*ot._transform._rotation10+ot._invInertia11*ot._transform._rotation11+ot._invInertia12*ot._transform._rotation12,St=ot._invInertia10*ot._transform._rotation20+ot._invInertia11*ot._transform._rotation21+ot._invInertia12*ot._transform._rotation22,Xt=ot._invInertia20*ot._transform._rotation00+ot._invInertia21*ot._transform._rotation01+ot._invInertia22*ot._transform._rotation02,Yt=ot._invInertia20*ot._transform._rotation10+ot._invInertia21*ot._transform._rotation11+ot._invInertia22*ot._transform._rotation12,Nt=ot._invInertia20*ot._transform._rotation20+ot._invInertia21*ot._transform._rotation21+ot._invInertia22*ot._transform._rotation22,ot._invInertia00=At,ot._invInertia01=Zt,ot._invInertia02=zt,ot._invInertia10=Bt,ot._invInertia11=kt,ot._invInertia12=St,ot._invInertia20=Xt,ot._invInertia21=Yt,ot._invInertia22=Nt,ot._invInertia00*=ot._rotFactor.x,ot._invInertia01*=ot._rotFactor.x,ot._invInertia02*=ot._rotFactor.x,ot._invInertia10*=ot._rotFactor.y,ot._invInertia11*=ot._rotFactor.y,ot._invInertia12*=ot._rotFactor.y,ot._invInertia20*=ot._rotFactor.z,ot._invInertia21*=ot._rotFactor.z,ot._invInertia22*=ot._rotFactor.z;var Ot,Et,Ut,Jt,Qt,qt,$t,te,ee,ae,ie=this._b2,ne=Math.sqrt(W*W+D*D+T*T),se=.5*ne;if(se<.5){var re=se*se;Ot=.5*(1-.16666666666666666*re+re*re*.008333333333333333),Et=1-.5*re+re*re*.041666666666666664}else Ot=Math.sin(se)/ne,Et=Math.cos(se);Ut=W*Ot,Jt=D*Ot,Qt=T*Ot,qt=Et;var oe,le=ie._transform._rotation00,_e=ie._transform._rotation11,he=ie._transform._rotation22,fe=le+_e+he;0<fe?(ae=.5*(oe=Math.sqrt(fe+1)),oe=.5/oe,$t=(ie._transform._rotation21-ie._transform._rotation12)*oe,te=(ie._transform._rotation02-ie._transform._rotation20)*oe,ee=(ie._transform._rotation10-ie._transform._rotation01)*oe):_e<le?he<le?($t=.5*(oe=Math.sqrt(le-_e-he+1)),oe=.5/oe,te=(ie._transform._rotation01+ie._transform._rotation10)*oe,ee=(ie._transform._rotation02+ie._transform._rotation20)*oe,ae=(ie._transform._rotation21-ie._transform._rotation12)*oe):(ee=.5*(oe=Math.sqrt(he-le-_e+1)),oe=.5/oe,$t=(ie._transform._rotation02+ie._transform._rotation20)*oe,te=(ie._transform._rotation12+ie._transform._rotation21)*oe,ae=(ie._transform._rotation10-ie._transform._rotation01)*oe):he<_e?(te=.5*(oe=Math.sqrt(_e-he-le+1)),oe=.5/oe,$t=(ie._transform._rotation01+ie._transform._rotation10)*oe,ee=(ie._transform._rotation12+ie._transform._rotation21)*oe,ae=(ie._transform._rotation02-ie._transform._rotation20)*oe):(ee=.5*(oe=Math.sqrt(he-le-_e+1)),oe=.5/oe,$t=(ie._transform._rotation02+ie._transform._rotation20)*oe,te=(ie._transform._rotation12+ie._transform._rotation21)*oe,ae=(ie._transform._rotation10-ie._transform._rotation01)*oe);var ue=($t=qt*$t+Ut*ae+Jt*ee-Qt*te)*$t+(te=qt*te-Ut*ee+Jt*ae+Qt*$t)*te+(ee=qt*ee+Ut*te-Jt*$t+Qt*ae)*ee+(ae=qt*ae-Ut*$t-Jt*te-Qt*ee)*ae;1e-32<ue&&(ue=1/Math.sqrt(ue));$t*=ue,te*=ue,ee*=ue,ae*=ue;var ce,de,ge,pe,me,ve,be,Ie,Me,ye,we,xe,Ce,Ae,Ze,ze,Be,ke,Se=2*$t,Xe=2*te,Ye=2*ee,Ne=$t*Se,Le=te*Xe,Ge=ee*Ye,We=$t*Xe,De=te*Ye,Te=$t*Ye,Ve=ae*Se,Ke=ae*Xe,je=ae*Ye;ie._transform._rotation00=1-Le-Ge,ie._transform._rotation01=We-je,ie._transform._rotation02=Te+Ke,ie._transform._rotation10=We+je,ie._transform._rotation11=1-Ne-Ge,ie._transform._rotation12=De-Ve,ie._transform._rotation20=Te-Ke,ie._transform._rotation21=De+Ve,ie._transform._rotation22=1-Ne-Le,ce=ie._transform._rotation00*ie._invLocalInertia00+ie._transform._rotation01*ie._invLocalInertia10+ie._transform._rotation02*ie._invLocalInertia20,de=ie._transform._rotation00*ie._invLocalInertia01+ie._transform._rotation01*ie._invLocalInertia11+ie._transform._rotation02*ie._invLocalInertia21,ge=ie._transform._rotation00*ie._invLocalInertia02+ie._transform._rotation01*ie._invLocalInertia12+ie._transform._rotation02*ie._invLocalInertia22,pe=ie._transform._rotation10*ie._invLocalInertia00+ie._transform._rotation11*ie._invLocalInertia10+ie._transform._rotation12*ie._invLocalInertia20,me=ie._transform._rotation10*ie._invLocalInertia01+ie._transform._rotation11*ie._invLocalInertia11+ie._transform._rotation12*ie._invLocalInertia21,ve=ie._transform._rotation10*ie._invLocalInertia02+ie._transform._rotation11*ie._invLocalInertia12+ie._transform._rotation12*ie._invLocalInertia22,be=ie._transform._rotation20*ie._invLocalInertia00+ie._transform._rotation21*ie._invLocalInertia10+ie._transform._rotation22*ie._invLocalInertia20,Ie=ie._transform._rotation20*ie._invLocalInertia01+ie._transform._rotation21*ie._invLocalInertia11+ie._transform._rotation22*ie._invLocalInertia21,Me=ie._transform._rotation20*ie._invLocalInertia02+ie._transform._rotation21*ie._invLocalInertia12+ie._transform._rotation22*ie._invLocalInertia22,ie._invInertia00=ce,ie._invInertia01=de,ie._invInertia02=ge,ie._invInertia10=pe,ie._invInertia11=me,ie._invInertia12=ve,ie._invInertia20=be,ie._invInertia21=Ie,ie._invInertia22=Me,ye=ie._invInertia00*ie._transform._rotation00+ie._invInertia01*ie._transform._rotation01+ie._invInertia02*ie._transform._rotation02,we=ie._invInertia00*ie._transform._rotation10+ie._invInertia01*ie._transform._rotation11+ie._invInertia02*ie._transform._rotation12,xe=ie._invInertia00*ie._transform._rotation20+ie._invInertia01*ie._transform._rotation21+ie._invInertia02*ie._transform._rotation22,Ce=ie._invInertia10*ie._transform._rotation00+ie._invInertia11*ie._transform._rotation01+ie._invInertia12*ie._transform._rotation02,Ae=ie._invInertia10*ie._transform._rotation10+ie._invInertia11*ie._transform._rotation11+ie._invInertia12*ie._transform._rotation12,Ze=ie._invInertia10*ie._transform._rotation20+ie._invInertia11*ie._transform._rotation21+ie._invInertia12*ie._transform._rotation22,ze=ie._invInertia20*ie._transform._rotation00+ie._invInertia21*ie._transform._rotation01+ie._invInertia22*ie._transform._rotation02,Be=ie._invInertia20*ie._transform._rotation10+ie._invInertia21*ie._transform._rotation11+ie._invInertia22*ie._transform._rotation12,ke=ie._invInertia20*ie._transform._rotation20+ie._invInertia21*ie._transform._rotation21+ie._invInertia22*ie._transform._rotation22,ie._invInertia00=ye,ie._invInertia01=we,ie._invInertia02=xe,ie._invInertia10=Ce,ie._invInertia11=Ae,ie._invInertia12=Ze,ie._invInertia20=ze,ie._invInertia21=Be,ie._invInertia22=ke,ie._invInertia00*=ie._rotFactor.x,ie._invInertia01*=ie._rotFactor.x,ie._invInertia02*=ie._rotFactor.x,ie._invInertia10*=ie._rotFactor.y,ie._invInertia11*=ie._rotFactor.y,ie._invInertia12*=ie._rotFactor.y,ie._invInertia20*=ie._rotFactor.z,ie._invInertia21*=ie._rotFactor.z,ie._invInertia22*=ie._rotFactor.z}for(var Re=this.posBoundarySelector,He=0;Re.indices[He]!=y;)++He;for(;0<He;){var Pe=Re.indices[He];Re.indices[He]=Re.indices[He-1],Re.indices[He-1]=Pe,--He}v=!0;break}}v||Fe.trace("could not find solution. (NGS)",{fileName:"Sources/oimo/dynamics/constraint/solver/direct/DirectJointConstraintSolver.hx",lineNumber:506,className:"oimo.dynamics.constraint.solver.direct.DirectJointConstraintSolver",methodName:"solvePositionNgs"})},postSolve:function(){this.joint._syncAnchors(),this.joint._checkDestruction()},__class__:En});var Un=function(t){this._size=t;var e=new Array(this._size);this.tmpMatrix=e;var a=new Array(this._size);this._invMass=a;var i=new Array(this._size);this._invMassWithoutCfm=i;for(var n=0,s=this._size;n<s;){var r=n++,o=this.tmpMatrix,l=new Array(this._size);o[r]=l;var _=this._invMass,h=new Array(this._size);_[r]=h;var f=this._invMassWithoutCfm,u=new Array(this._size);f[r]=u;for(var c=0,d=this._size;c<d;){var g=c++;this.tmpMatrix[r][g]=0,this._invMass[r][g]=0,this._invMassWithoutCfm[r][g]=0}}this._maxSubmatrixId=1<<this._size;var p=new Array(this._maxSubmatrixId);this._cacheComputed=p;var m=new Array(this._maxSubmatrixId);this._cachedSubmatrices=m;for(var v=0,b=this._maxSubmatrixId;v<b;){for(var I=v++,M=I,y=M=(15&(M=(51&(M=(85&M)+(M>>1&85)))+(M>>2&51)))+(M>>4&15),w=new Array(y),x=0,C=y;x<C;){var A=x++,Z=new Array(y);w[A]=Z;for(var z=0,B=y;z<B;){var k=z++;w[A][k]=0}}this._cacheComputed[I]=!1,this._cachedSubmatrices[I]=w}};(i["oimo.dynamics.constraint.solver.direct.MassMatrix"]=Un).__name__=!0,Un.prototype={_size:null,_invMass:null,_invMassWithoutCfm:null,_cachedSubmatrices:null,_cacheComputed:null,_maxSubmatrixId:null,tmpMatrix:null,computeSubmatrix:function(t,e,a){for(var i=0,n=a;i<n;)for(var s=i++,r=e[s],o=0,l=a;o<l;){var _=o++;this.tmpMatrix[s][_]=this._invMass[r][e[_]]}var h,f,u,c,d,g=this.tmpMatrix,p=this._cachedSubmatrices[t];switch(a){case 4:h=g[0],f=p[0],d=1/h[0],f[0]=d,h[1]=h[1]*d,h[2]=h[2]*d,h[3]=h[3]*d,u=g[1],(c=p[1])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u=g[2],(c=p[2])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u=g[3],(c=p[3])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],h=g[1],f=p[1],d=1/h[1],f[1]=d,f[0]=f[0]*d,h[2]=h[2]*d,h[3]=h[3]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],h=g[2],f=p[2],d=1/h[2],f[2]=d,f[0]=f[0]*d,f[1]=f[1]*d,h[3]=h[3]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[2],u[3]=u[3]-h[3]*u[2],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],u[3]=u[3]-h[3]*u[2],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],c[2]=-d*u[2],u[3]=u[3]-h[3]*u[2],h=g[3],f=p[3],d=1/h[3],f[3]=d,f[0]=f[0]*d,f[1]=f[1]*d,f[2]=f[2]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[3],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],c[2]=c[2]-f[2]*u[3],f=p[1],p[0][1]=f[0],f=p[2],p[0][2]=f[0],p[1][2]=f[1],f=p[3],p[0][3]=f[0],p[1][3]=f[1],p[2][3]=f[2];break;case 5:h=g[0],f=p[0],d=1/h[0],f[0]=d,h[1]=h[1]*d,h[2]=h[2]*d,h[3]=h[3]*d,h[4]=h[4]*d,u=g[1],(c=p[1])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u=g[2],(c=p[2])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u=g[3],(c=p[3])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u=g[4],(c=p[4])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],h=g[1],f=p[1],d=1/h[1],f[1]=d,f[0]=f[0]*d,h[2]=h[2]*d,h[3]=h[3]*d,h[4]=h[4]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],h=g[2],f=p[2],d=1/h[2],f[2]=d,f[0]=f[0]*d,f[1]=f[1]*d,h[3]=h[3]*d,h[4]=h[4]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],c[2]=-d*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],c[2]=-d*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],h=g[3],f=p[3],d=1/h[3],f[3]=d,f[0]=f[0]*d,f[1]=f[1]*d,f[2]=f[2]*d,h[4]=h[4]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[3],u[4]=u[4]-h[4]*u[3],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],u[4]=u[4]-h[4]*u[3],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],c[2]=c[2]-f[2]*u[3],u[4]=u[4]-h[4]*u[3],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],c[2]=c[2]-f[2]*u[3],c[3]=-d*u[3],u[4]=u[4]-h[4]*u[3],h=g[4],f=p[4],d=1/h[4],f[4]=d,f[0]=f[0]*d,f[1]=f[1]*d,f[2]=f[2]*d,f[3]=f[3]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[4],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],c[2]=c[2]-f[2]*u[4],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],c[2]=c[2]-f[2]*u[4],c[3]=c[3]-f[3]*u[4],f=p[1],p[0][1]=f[0],f=p[2],p[0][2]=f[0],p[1][2]=f[1],f=p[3],p[0][3]=f[0],p[1][3]=f[1],p[2][3]=f[2],f=p[4],p[0][4]=f[0],p[1][4]=f[1],p[2][4]=f[2],p[3][4]=f[3];break;case 6:h=g[0],f=p[0],d=1/h[0],f[0]=d,h[1]=h[1]*d,h[2]=h[2]*d,h[3]=h[3]*d,h[4]=h[4]*d,h[5]=h[5]*d,u=g[1],(c=p[1])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u[5]=u[5]-h[5]*u[0],u=g[2],(c=p[2])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u[5]=u[5]-h[5]*u[0],u=g[3],(c=p[3])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u[5]=u[5]-h[5]*u[0],u=g[4],(c=p[4])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u[5]=u[5]-h[5]*u[0],u=g[5],(c=p[5])[0]=-d*u[0],u[1]=u[1]-h[1]*u[0],u[2]=u[2]-h[2]*u[0],u[3]=u[3]-h[3]*u[0],u[4]=u[4]-h[4]*u[0],u[5]=u[5]-h[5]*u[0],h=g[1],f=p[1],d=1/h[1],f[1]=d,f[0]=f[0]*d,h[2]=h[2]*d,h[3]=h[3]*d,h[4]=h[4]*d,h[5]=h[5]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u[5]=u[5]-h[5]*u[1],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u[5]=u[5]-h[5]*u[1],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u[5]=u[5]-h[5]*u[1],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u[5]=u[5]-h[5]*u[1],u=g[5],(c=p[5])[0]=c[0]-f[0]*u[1],c[1]=-d*u[1],u[2]=u[2]-h[2]*u[1],u[3]=u[3]-h[3]*u[1],u[4]=u[4]-h[4]*u[1],u[5]=u[5]-h[5]*u[1],h=g[2],f=p[2],d=1/h[2],f[2]=d,f[0]=f[0]*d,f[1]=f[1]*d,h[3]=h[3]*d,h[4]=h[4]*d,h[5]=h[5]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u[5]=u[5]-h[5]*u[2],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u[5]=u[5]-h[5]*u[2],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],c[2]=-d*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u[5]=u[5]-h[5]*u[2],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],c[2]=-d*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u[5]=u[5]-h[5]*u[2],u=g[5],(c=p[5])[0]=c[0]-f[0]*u[2],c[1]=c[1]-f[1]*u[2],c[2]=-d*u[2],u[3]=u[3]-h[3]*u[2],u[4]=u[4]-h[4]*u[2],u[5]=u[5]-h[5]*u[2],h=g[3],f=p[3],d=1/h[3],f[3]=d,f[0]=f[0]*d,f[1]=f[1]*d,f[2]=f[2]*d,h[4]=h[4]*d,h[5]=h[5]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[3],u[4]=u[4]-h[4]*u[3],u[5]=u[5]-h[5]*u[3],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],u[4]=u[4]-h[4]*u[3],u[5]=u[5]-h[5]*u[3],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],c[2]=c[2]-f[2]*u[3],u[4]=u[4]-h[4]*u[3],u[5]=u[5]-h[5]*u[3],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],c[2]=c[2]-f[2]*u[3],c[3]=-d*u[3],u[4]=u[4]-h[4]*u[3],u[5]=u[5]-h[5]*u[3],u=g[5],(c=p[5])[0]=c[0]-f[0]*u[3],c[1]=c[1]-f[1]*u[3],c[2]=c[2]-f[2]*u[3],c[3]=-d*u[3],u[4]=u[4]-h[4]*u[3],u[5]=u[5]-h[5]*u[3],h=g[4],f=p[4],d=1/h[4],f[4]=d,f[0]=f[0]*d,f[1]=f[1]*d,f[2]=f[2]*d,f[3]=f[3]*d,h[5]=h[5]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[4],u[5]=u[5]-h[5]*u[4],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],u[5]=u[5]-h[5]*u[4],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],c[2]=c[2]-f[2]*u[4],u[5]=u[5]-h[5]*u[4],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],c[2]=c[2]-f[2]*u[4],c[3]=c[3]-f[3]*u[4],u[5]=u[5]-h[5]*u[4],u=g[5],(c=p[5])[0]=c[0]-f[0]*u[4],c[1]=c[1]-f[1]*u[4],c[2]=c[2]-f[2]*u[4],c[3]=c[3]-f[3]*u[4],c[4]=-d*u[4],u[5]=u[5]-h[5]*u[4],h=g[5],f=p[5],d=1/h[5],f[5]=d,f[0]=f[0]*d,f[1]=f[1]*d,f[2]=f[2]*d,f[3]=f[3]*d,f[4]=f[4]*d,u=g[0],(c=p[0])[0]=c[0]-f[0]*u[5],u=g[1],(c=p[1])[0]=c[0]-f[0]*u[5],c[1]=c[1]-f[1]*u[5],u=g[2],(c=p[2])[0]=c[0]-f[0]*u[5],c[1]=c[1]-f[1]*u[5],c[2]=c[2]-f[2]*u[5],u=g[3],(c=p[3])[0]=c[0]-f[0]*u[5],c[1]=c[1]-f[1]*u[5],c[2]=c[2]-f[2]*u[5],c[3]=c[3]-f[3]*u[5],u=g[4],(c=p[4])[0]=c[0]-f[0]*u[5],c[1]=c[1]-f[1]*u[5],c[2]=c[2]-f[2]*u[5],c[3]=c[3]-f[3]*u[5],c[4]=c[4]-f[4]*u[5],f=p[1],p[0][1]=f[0],f=p[2],p[0][2]=f[0],p[1][2]=f[1],f=p[3],p[0][3]=f[0],p[1][3]=f[1],p[2][3]=f[2],f=p[4],p[0][4]=f[0],p[1][4]=f[1],p[2][4]=f[2],p[3][4]=f[3],f=p[5],p[0][5]=f[0],p[1][5]=f[1],p[2][5]=f[2],p[3][5]=f[3],p[4][5]=f[4];break;default:for(var m=0,v=a;m<v;){var b=m++;h=g[b],f=p[b];var I=1/h[b];f[b]=I;for(var M=0,y=b;M<y;){var w=M++;f[w]=f[w]*I}for(var x=b+1,C=a;x<C;){var A=x++;h[A]=h[A]*I}for(var Z=0,z=b;Z<z;){var B=Z++;u=g[B],c=p[B];for(var k=0,S=B+1;k<S;){var X=k++;c[X]=c[X]-f[X]*u[b]}for(var Y=b+1,N=a;Y<N;){var L=Y++;u[L]=u[L]-h[L]*u[b]}}for(var G=b+1,W=a;G<W;){var D=G++;u=g[D],c=p[D];for(var T=0,V=b;T<V;){var K=T++;c[K]=c[K]-f[K]*u[b]}c[b]=-I*u[b];for(var j=b+1,R=a;j<R;){var H=j++;u[H]=u[H]-h[H]*u[b]}}}for(var P=1,F=a;P<F;){var O=P++;f=p[O];for(var E=0,U=O;E<U;){var J=E++;p[J][O]=f[J]}}}},computeInvMass:function(t,e){var a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b,I=this._invMass,M=this._invMassWithoutCfm,y=t.numRows,w=t.b1,x=t.b2,C=w._invMass,A=x._invMass;a=w._invInertia00,i=w._invInertia01,n=w._invInertia02,s=w._invInertia10,r=w._invInertia11,o=w._invInertia12,l=w._invInertia20,_=w._invInertia21,h=w._invInertia22,f=x._invInertia00,u=x._invInertia01,c=x._invInertia02,d=x._invInertia10,g=x._invInertia11,p=x._invInertia12,m=x._invInertia20,v=x._invInertia21,b=x._invInertia22;for(var Z=0,z=y;Z<z;){var B,k,S,X,Y,N,L=Z++,G=t.rows[L].jacobian,W=e[L];if(G.updateSparsity(),0!=(1&G.flag)?(W.invMLin1X=G.lin1X*C,W.invMLin1Y=G.lin1Y*C,W.invMLin1Z=G.lin1Z*C,W.invMLin2X=G.lin2X*A,W.invMLin2Y=G.lin2Y*A,W.invMLin2Z=G.lin2Z*A):(W.invMLin1X=0,W.invMLin1Y=0,W.invMLin1Z=0,W.invMLin2X=0,W.invMLin2Y=0,W.invMLin2Z=0),0!=(2&G.flag))B=a*G.ang1X+i*G.ang1Y+n*G.ang1Z,k=s*G.ang1X+r*G.ang1Y+o*G.ang1Z,S=l*G.ang1X+_*G.ang1Y+h*G.ang1Z,W.invMAng1X=B,W.invMAng1Y=k,W.invMAng1Z=S,X=f*G.ang2X+u*G.ang2Y+c*G.ang2Z,Y=d*G.ang2X+g*G.ang2Y+p*G.ang2Z,N=m*G.ang2X+v*G.ang2Y+b*G.ang2Z,W.invMAng2X=X,W.invMAng2Y=Y,W.invMAng2Z=N;else W.invMAng1X=0,W.invMAng1Y=0,W.invMAng1Z=0,W.invMAng2X=0,W.invMAng2Y=0,W.invMAng2Z=0}for(var D=0,T=y;D<T;)for(var V=D++,K=t.rows[V].jacobian,j=V,R=y;j<R;){var H=j++,P=(t.rows[H].jacobian,e[H]),F=K.lin1X*P.invMLin1X+K.lin1Y*P.invMLin1Y+K.lin1Z*P.invMLin1Z+(K.ang1X*P.invMAng1X+K.ang1Y*P.invMAng1Y+K.ang1Z*P.invMAng1Z)+(K.lin2X*P.invMLin2X+K.lin2Y*P.invMLin2Y+K.lin2Z*P.invMLin2Z)+(K.ang2X*P.invMAng2X+K.ang2Y*P.invMAng2Y+K.ang2Z*P.invMAng2Z);V==H?(I[V][H]=F+t.rows[V].cfm,M[V][H]=F,P.mass=F+t.rows[V].cfm,P.massWithoutCfm=F,0!=P.mass&&(P.mass=1/P.mass),0!=P.massWithoutCfm&&(P.massWithoutCfm=1/P.massWithoutCfm)):(I[V][H]=F,I[H][V]=F,M[V][H]=F,M[H][V]=F)}for(var O=0,E=this._maxSubmatrixId;O<E;){var U=O++;this._cacheComputed[U]=!1}},__class__:Un};var Jn=function(t){An.call(this),this.constraint=t,this.info=new Nn;var e=new Array(xn.maxManifoldPoints);this.massData=e;for(var a=0,i=this.massData.length;a<i;){var n=a++;this.massData[n]=new jn}};(i["oimo.dynamics.constraint.solver.pgs.PgsContactConstraintSolver"]=Jn).__name__=!0,Jn.__super__=An,Jn.prototype=s(An.prototype,{constraint:null,info:null,massData:null,preSolveVelocity:function(t){this.constraint._getVelocitySolverInfo(t,this.info),this._b1=this.info.b1,this._b2=this.info.b2;var e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b=this._b1._invMass,I=this._b2._invMass;e=this._b1._invInertia00,a=this._b1._invInertia01,i=this._b1._invInertia02,n=this._b1._invInertia10,s=this._b1._invInertia11,r=this._b1._invInertia12,o=this._b1._invInertia20,l=this._b1._invInertia21,_=this._b1._invInertia22,h=this._b2._invInertia00,f=this._b2._invInertia01,u=this._b2._invInertia02,c=this._b2._invInertia10,d=this._b2._invInertia11,g=this._b2._invInertia12,p=this._b2._invInertia20,m=this._b2._invInertia21,v=this._b2._invInertia22;for(var M=0,y=this.info.numRows;M<y;){var w,x,C,A,Z,z,B=M++,k=this.info.rows[B],S=this.massData[B],X=k.jacobianN;S.invMLinN1X=X.lin1X*b,S.invMLinN1Y=X.lin1Y*b,S.invMLinN1Z=X.lin1Z*b,S.invMLinN2X=X.lin2X*I,S.invMLinN2Y=X.lin2Y*I,S.invMLinN2Z=X.lin2Z*I,w=e*X.ang1X+a*X.ang1Y+i*X.ang1Z,x=n*X.ang1X+s*X.ang1Y+r*X.ang1Z,C=o*X.ang1X+l*X.ang1Y+_*X.ang1Z,S.invMAngN1X=w,S.invMAngN1Y=x,S.invMAngN1Z=C,A=h*X.ang2X+f*X.ang2Y+u*X.ang2Z,Z=c*X.ang2X+d*X.ang2Y+g*X.ang2Z,z=p*X.ang2X+m*X.ang2Y+v*X.ang2Z,S.invMAngN2X=A,S.invMAngN2Y=Z,S.invMAngN2Z=z,S.massN=b+I+(S.invMAngN1X*X.ang1X+S.invMAngN1Y*X.ang1Y+S.invMAngN1Z*X.ang1Z)+(S.invMAngN2X*X.ang2X+S.invMAngN2Y*X.ang2Y+S.invMAngN2Z*X.ang2Z),0!=S.massN&&(S.massN=1/S.massN);var Y,N,L,G,W,D,T,V,K,j,R,H,P=k.jacobianT,F=k.jacobianB;S.invMLinT1X=P.lin1X*b,S.invMLinT1Y=P.lin1Y*b,S.invMLinT1Z=P.lin1Z*b,S.invMLinT2X=P.lin2X*I,S.invMLinT2Y=P.lin2Y*I,S.invMLinT2Z=P.lin2Z*I,S.invMLinB1X=F.lin1X*b,S.invMLinB1Y=F.lin1Y*b,S.invMLinB1Z=F.lin1Z*b,S.invMLinB2X=F.lin2X*I,S.invMLinB2Y=F.lin2Y*I,S.invMLinB2Z=F.lin2Z*I,Y=e*P.ang1X+a*P.ang1Y+i*P.ang1Z,N=n*P.ang1X+s*P.ang1Y+r*P.ang1Z,L=o*P.ang1X+l*P.ang1Y+_*P.ang1Z,S.invMAngT1X=Y,S.invMAngT1Y=N,S.invMAngT1Z=L,G=h*P.ang2X+f*P.ang2Y+u*P.ang2Z,W=c*P.ang2X+d*P.ang2Y+g*P.ang2Z,D=p*P.ang2X+m*P.ang2Y+v*P.ang2Z,S.invMAngT2X=G,S.invMAngT2Y=W,S.invMAngT2Z=D,T=e*F.ang1X+a*F.ang1Y+i*F.ang1Z,V=n*F.ang1X+s*F.ang1Y+r*F.ang1Z,K=o*F.ang1X+l*F.ang1Y+_*F.ang1Z,S.invMAngB1X=T,S.invMAngB1Y=V,S.invMAngB1Z=K,j=h*F.ang2X+f*F.ang2Y+u*F.ang2Z,R=c*F.ang2X+d*F.ang2Y+g*F.ang2Z,H=p*F.ang2X+m*F.ang2Y+v*F.ang2Z,S.invMAngB2X=j,S.invMAngB2Y=R,S.invMAngB2Z=H;var O=b+I+(S.invMAngT1X*P.ang1X+S.invMAngT1Y*P.ang1Y+S.invMAngT1Z*P.ang1Z)+(S.invMAngT2X*P.ang2X+S.invMAngT2Y*P.ang2Y+S.invMAngT2Z*P.ang2Z),E=S.invMAngT1X*F.ang1X+S.invMAngT1Y*F.ang1Y+S.invMAngT1Z*F.ang1Z+(S.invMAngT2X*F.ang2X+S.invMAngT2Y*F.ang2Y+S.invMAngT2Z*F.ang2Z),U=E,J=b+I+(S.invMAngB1X*F.ang1X+S.invMAngB1Y*F.ang1Y+S.invMAngB1Z*F.ang1Z)+(S.invMAngB2X*F.ang2X+S.invMAngB2Y*F.ang2Y+S.invMAngB2Z*F.ang2Z),Q=O*J-E*U;0!=Q&&(Q=1/Q),S.massTB00=J*Q,S.massTB01=-E*Q,S.massTB10=-U*Q,S.massTB11=O*Q}},warmStart:function(t){var e,a,i,n,s,r,o,l,_,h,f,u;e=this._b1._velX,a=this._b1._velY,i=this._b1._velZ,n=this._b2._velX,s=this._b2._velY,r=this._b2._velZ,o=this._b1._angVelX,l=this._b1._angVelY,_=this._b1._angVelZ,h=this._b2._angVelX,f=this._b2._angVelY,u=this._b2._angVelZ;for(var c=0,d=this.info.numRows;c<d;){var g=c++,p=this.info.rows[g],m=p.impulse,v=this.massData[g],b=p.jacobianT,I=p.jacobianB,M=m.impulseN,y=m.impulseLX*b.lin1X+m.impulseLY*b.lin1Y+m.impulseLZ*b.lin1Z,w=m.impulseLX*I.lin1X+m.impulseLY*I.lin1Y+m.impulseLZ*I.lin1Z;m.impulseT=y,m.impulseB=w,m.impulseN*=t.dtRatio,m.impulseT*=t.dtRatio,m.impulseB*=t.dtRatio,e+=v.invMLinN1X*M,a+=v.invMLinN1Y*M,i+=v.invMLinN1Z*M,e+=v.invMLinT1X*y,a+=v.invMLinT1Y*y,i+=v.invMLinT1Z*y,e+=v.invMLinB1X*w,a+=v.invMLinB1Y*w,i+=v.invMLinB1Z*w,n+=v.invMLinN2X*-M,s+=v.invMLinN2Y*-M,r+=v.invMLinN2Z*-M,n+=v.invMLinT2X*-y,s+=v.invMLinT2Y*-y,r+=v.invMLinT2Z*-y,n+=v.invMLinB2X*-w,s+=v.invMLinB2Y*-w,r+=v.invMLinB2Z*-w,o+=v.invMAngN1X*M,l+=v.invMAngN1Y*M,_+=v.invMAngN1Z*M,o+=v.invMAngT1X*y,l+=v.invMAngT1Y*y,_+=v.invMAngT1Z*y,o+=v.invMAngB1X*w,l+=v.invMAngB1Y*w,_+=v.invMAngB1Z*w,h+=v.invMAngN2X*-M,f+=v.invMAngN2Y*-M,u+=v.invMAngN2Z*-M,h+=v.invMAngT2X*-y,f+=v.invMAngT2Y*-y,u+=v.invMAngT2Z*-y,h+=v.invMAngB2X*-w,f+=v.invMAngB2Y*-w,u+=v.invMAngB2Z*-w}this._b1._velX=e,this._b1._velY=a,this._b1._velZ=i,this._b2._velX=n,this._b2._velY=s,this._b2._velZ=r,this._b1._angVelX=o,this._b1._angVelY=l,this._b1._angVelZ=_,this._b2._angVelX=h,this._b2._angVelY=f,this._b2._angVelZ=u},solveVelocity:function(){var t,e,a,i,n,s,r,o,l,_,h,f;t=this._b1._velX,e=this._b1._velY,a=this._b1._velZ,i=this._b2._velX,n=this._b2._velY,s=this._b2._velZ,r=this._b1._angVelX,o=this._b1._angVelY,l=this._b1._angVelZ,_=this._b2._angVelX,h=this._b2._angVelY,f=this._b2._angVelZ;for(var u=0,c=this.info.numRows;u<c;){var d=u++,g=this.info.rows[d],p=this.massData[d],m=g.impulse,v=0,b=g.jacobianT;v+=t*b.lin1X+e*b.lin1Y+a*b.lin1Z,v-=i*b.lin2X+n*b.lin2Y+s*b.lin2Z,v+=r*b.ang1X+o*b.ang1Y+l*b.ang1Z,v-=_*b.ang2X+h*b.ang2Y+f*b.ang2Z;var I=0;I+=t*(b=g.jacobianB).lin1X+e*b.lin1Y+a*b.lin1Z,I-=i*b.lin2X+n*b.lin2Y+s*b.lin2Z,I+=r*b.ang1X+o*b.ang1Y+l*b.ang1Z,I-=_*b.ang2X+h*b.ang2Y+f*b.ang2Z;var M=-(v*p.massTB00+I*p.massTB01),y=-(v*p.massTB10+I*p.massTB11),w=m.impulseT,x=m.impulseB;m.impulseT+=M,m.impulseB+=y;var C=g.friction*m.impulseN;if(0==C)m.impulseT=0,m.impulseB=0;else{var A=m.impulseT*m.impulseT+m.impulseB*m.impulseB;if(C*C<A){var Z=C/Math.sqrt(A);m.impulseT*=Z,m.impulseB*=Z}}M=m.impulseT-w,y=m.impulseB-x,t+=p.invMLinT1X*M,e+=p.invMLinT1Y*M,a+=p.invMLinT1Z*M,t+=p.invMLinB1X*y,e+=p.invMLinB1Y*y,a+=p.invMLinB1Z*y,i+=p.invMLinT2X*-M,n+=p.invMLinT2Y*-M,s+=p.invMLinT2Z*-M,i+=p.invMLinB2X*-y,n+=p.invMLinB2Y*-y,s+=p.invMLinB2Z*-y,r+=p.invMAngT1X*M,o+=p.invMAngT1Y*M,l+=p.invMAngT1Z*M,r+=p.invMAngB1X*y,o+=p.invMAngB1Y*y,l+=p.invMAngB1Z*y,_+=p.invMAngT2X*-M,h+=p.invMAngT2Y*-M,f+=p.invMAngT2Z*-M,_+=p.invMAngB2X*-y,h+=p.invMAngB2Y*-y,f+=p.invMAngB2Z*-y}for(var z=0,B=this.info.numRows;z<B;){var k=z++,S=this.info.rows[k],X=this.massData[k],Y=S.impulse,N=0,L=S.jacobianN;N+=t*L.lin1X+e*L.lin1Y+a*L.lin1Z,N-=i*L.lin2X+n*L.lin2Y+s*L.lin2Z,N+=r*L.ang1X+o*L.ang1Y+l*L.ang1Z,N-=_*L.ang2X+h*L.ang2Y+f*L.ang2Z;var G=(S.rhs-N)*X.massN,W=Y.impulseN;Y.impulseN+=G,Y.impulseN<0&&(Y.impulseN=0),G=Y.impulseN-W,t+=X.invMLinN1X*G,e+=X.invMLinN1Y*G,a+=X.invMLinN1Z*G,i+=X.invMLinN2X*-G,n+=X.invMLinN2Y*-G,s+=X.invMLinN2Z*-G,r+=X.invMAngN1X*G,o+=X.invMAngN1Y*G,l+=X.invMAngN1Z*G,_+=X.invMAngN2X*-G,h+=X.invMAngN2Y*-G,f+=X.invMAngN2Z*-G}this._b1._velX=t,this._b1._velY=e,this._b1._velZ=a,this._b2._velX=i,this._b2._velY=n,this._b2._velZ=s,this._b1._angVelX=r,this._b1._angVelY=o,this._b1._angVelZ=l,this._b2._angVelX=_,this._b2._angVelY=h,this._b2._angVelZ=f},preSolvePosition:function(t){this.constraint._syncManifold(),this.constraint._getPositionSolverInfo(this.info);var e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b=this._b1._invMass,I=this._b2._invMass;e=this._b1._invInertia00,a=this._b1._invInertia01,i=this._b1._invInertia02,n=this._b1._invInertia10,s=this._b1._invInertia11,r=this._b1._invInertia12,o=this._b1._invInertia20,l=this._b1._invInertia21,_=this._b1._invInertia22,h=this._b2._invInertia00,f=this._b2._invInertia01,u=this._b2._invInertia02,c=this._b2._invInertia10,d=this._b2._invInertia11,g=this._b2._invInertia12,p=this._b2._invInertia20,m=this._b2._invInertia21,v=this._b2._invInertia22;for(var M=0,y=this.info.numRows;M<y;){var w,x,C,A,Z,z,B=M++,k=this.info.rows[B],S=this.massData[B],X=k.jacobianN;S.invMLinN1X=X.lin1X*b,S.invMLinN1Y=X.lin1Y*b,S.invMLinN1Z=X.lin1Z*b,S.invMLinN2X=X.lin2X*I,S.invMLinN2Y=X.lin2Y*I,S.invMLinN2Z=X.lin2Z*I,w=e*X.ang1X+a*X.ang1Y+i*X.ang1Z,x=n*X.ang1X+s*X.ang1Y+r*X.ang1Z,C=o*X.ang1X+l*X.ang1Y+_*X.ang1Z,S.invMAngN1X=w,S.invMAngN1Y=x,S.invMAngN1Z=C,A=h*X.ang2X+f*X.ang2Y+u*X.ang2Z,Z=c*X.ang2X+d*X.ang2Y+g*X.ang2Z,z=p*X.ang2X+m*X.ang2Y+v*X.ang2Z,S.invMAngN2X=A,S.invMAngN2Y=Z,S.invMAngN2Z=z,S.massN=b+I+(S.invMAngN1X*X.ang1X+S.invMAngN1Y*X.ang1Y+S.invMAngN1Z*X.ang1Z)+(S.invMAngN2X*X.ang2X+S.invMAngN2Y*X.ang2Y+S.invMAngN2Z*X.ang2Z),0!=S.massN&&(S.massN=1/S.massN)}for(var Y=0,N=this.info.numRows;Y<N;){var L=Y++;this.info.rows[L].impulse.impulseP=0}},solvePositionSplitImpulse:function(){var t,e,a,i,n,s,r,o,l,_,h,f;t=this._b1._pseudoVelX,e=this._b1._pseudoVelY,a=this._b1._pseudoVelZ,i=this._b2._pseudoVelX,n=this._b2._pseudoVelY,s=this._b2._pseudoVelZ,r=this._b1._angPseudoVelX,o=this._b1._angPseudoVelY,l=this._b1._angPseudoVelZ,_=this._b2._angPseudoVelX,h=this._b2._angPseudoVelY,f=this._b2._angPseudoVelZ;for(var u=0,c=this.info.numRows;u<c;){var d=u++,g=this.info.rows[d],p=this.massData[d],m=g.impulse,v=g.jacobianN,b=0;b+=t*v.lin1X+e*v.lin1Y+a*v.lin1Z,b-=i*v.lin2X+n*v.lin2Y+s*v.lin2Z,b+=r*v.ang1X+o*v.ang1Y+l*v.ang1Z,b-=_*v.ang2X+h*v.ang2Y+f*v.ang2Z;var I=(g.rhs-b)*p.massN*xn.positionSplitImpulseBaumgarte,M=m.impulseP;m.impulseP+=I,m.impulseP<0&&(m.impulseP=0),I=m.impulseP-M,t+=p.invMLinN1X*I,e+=p.invMLinN1Y*I,a+=p.invMLinN1Z*I,i+=p.invMLinN2X*-I,n+=p.invMLinN2Y*-I,s+=p.invMLinN2Z*-I,r+=p.invMAngN1X*I,o+=p.invMAngN1Y*I,l+=p.invMAngN1Z*I,_+=p.invMAngN2X*-I,h+=p.invMAngN2Y*-I,f+=p.invMAngN2Z*-I}this._b1._pseudoVelX=t,this._b1._pseudoVelY=e,this._b1._pseudoVelZ=a,this._b2._pseudoVelX=i,this._b2._pseudoVelY=n,this._b2._pseudoVelZ=s,this._b1._angPseudoVelX=r,this._b1._angPseudoVelY=o,this._b1._angPseudoVelZ=l,this._b2._angPseudoVelX=_,this._b2._angPseudoVelY=h,this._b2._angPseudoVelZ=f},solvePositionNgs:function(t){this.constraint._syncManifold(),this.constraint._getPositionSolverInfo(this.info);var e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b=this._b1._invMass,I=this._b2._invMass;e=this._b1._invInertia00,a=this._b1._invInertia01,i=this._b1._invInertia02,n=this._b1._invInertia10,s=this._b1._invInertia11,r=this._b1._invInertia12,o=this._b1._invInertia20,l=this._b1._invInertia21,_=this._b1._invInertia22,h=this._b2._invInertia00,f=this._b2._invInertia01,u=this._b2._invInertia02,c=this._b2._invInertia10,d=this._b2._invInertia11,g=this._b2._invInertia12,p=this._b2._invInertia20,m=this._b2._invInertia21,v=this._b2._invInertia22;for(var M,y,w,x,C,A,Z,z,B,k,S,X,Y=0,N=this.info.numRows;Y<N;){var L,G,W,D,T,V,K=Y++,j=this.info.rows[K],R=this.massData[K],H=j.jacobianN;R.invMLinN1X=H.lin1X*b,R.invMLinN1Y=H.lin1Y*b,R.invMLinN1Z=H.lin1Z*b,R.invMLinN2X=H.lin2X*I,R.invMLinN2Y=H.lin2Y*I,R.invMLinN2Z=H.lin2Z*I,L=e*H.ang1X+a*H.ang1Y+i*H.ang1Z,G=n*H.ang1X+s*H.ang1Y+r*H.ang1Z,W=o*H.ang1X+l*H.ang1Y+_*H.ang1Z,R.invMAngN1X=L,R.invMAngN1Y=G,R.invMAngN1Z=W,D=h*H.ang2X+f*H.ang2Y+u*H.ang2Z,T=c*H.ang2X+d*H.ang2Y+g*H.ang2Z,V=p*H.ang2X+m*H.ang2Y+v*H.ang2Z,R.invMAngN2X=D,R.invMAngN2Y=T,R.invMAngN2Z=V,R.massN=b+I+(R.invMAngN1X*H.ang1X+R.invMAngN1Y*H.ang1Y+R.invMAngN1Z*H.ang1Z)+(R.invMAngN2X*H.ang2X+R.invMAngN2Y*H.ang2Y+R.invMAngN2Z*H.ang2Z),0!=R.massN&&(R.massN=1/R.massN)}for(var P=X=S=k=B=z=Z=A=C=x=w=y=M=0,F=this.info.numRows;P<F;){var O=P++,E=this.info.rows[O],U=this.massData[O],J=E.impulse,Q=E.jacobianN,q=0;q+=M*Q.lin1X+y*Q.lin1Y+w*Q.lin1Z,q-=x*Q.lin2X+C*Q.lin2Y+A*Q.lin2Z,q+=Z*Q.ang1X+z*Q.ang1Y+B*Q.ang1Z,q-=k*Q.ang2X+S*Q.ang2Y+X*Q.ang2Z;var $=(E.rhs-q)*U.massN*xn.positionNgsBaumgarte,tt=J.impulseP;J.impulseP+=$,J.impulseP<0&&(J.impulseP=0),$=J.impulseP-tt,M+=U.invMLinN1X*$,y+=U.invMLinN1Y*$,w+=U.invMLinN1Z*$,x+=U.invMLinN2X*-$,C+=U.invMLinN2Y*-$,A+=U.invMLinN2Z*-$,Z+=U.invMAngN1X*$,z+=U.invMAngN1Y*$,B+=U.invMAngN1Z*$,k+=U.invMAngN2X*-$,S+=U.invMAngN2Y*-$,X+=U.invMAngN2Z*-$}var et=this._b1;et._transform._positionX+=M,et._transform._positionY+=y,et._transform._positionZ+=w;var at=this._b2;at._transform._positionX+=x,at._transform._positionY+=C,at._transform._positionZ+=A;var it,nt,st,rt,ot,lt,_t,ht,ft,ut,ct=this._b1,dt=Math.sqrt(Z*Z+z*z+B*B),gt=.5*dt;if(gt<.5){var pt=gt*gt;it=.5*(1-.16666666666666666*pt+pt*pt*.008333333333333333),nt=1-.5*pt+pt*pt*.041666666666666664}else it=Math.sin(gt)/dt,nt=Math.cos(gt);st=Z*it,rt=z*it,ot=B*it,lt=nt;var mt,vt=ct._transform._rotation00,bt=ct._transform._rotation11,It=ct._transform._rotation22,Mt=vt+bt+It;0<Mt?(ut=.5*(mt=Math.sqrt(Mt+1)),mt=.5/mt,_t=(ct._transform._rotation21-ct._transform._rotation12)*mt,ht=(ct._transform._rotation02-ct._transform._rotation20)*mt,ft=(ct._transform._rotation10-ct._transform._rotation01)*mt):bt<vt?It<vt?(_t=.5*(mt=Math.sqrt(vt-bt-It+1)),mt=.5/mt,ht=(ct._transform._rotation01+ct._transform._rotation10)*mt,ft=(ct._transform._rotation02+ct._transform._rotation20)*mt,ut=(ct._transform._rotation21-ct._transform._rotation12)*mt):(ft=.5*(mt=Math.sqrt(It-vt-bt+1)),mt=.5/mt,_t=(ct._transform._rotation02+ct._transform._rotation20)*mt,ht=(ct._transform._rotation12+ct._transform._rotation21)*mt,ut=(ct._transform._rotation10-ct._transform._rotation01)*mt):It<bt?(ht=.5*(mt=Math.sqrt(bt-It-vt+1)),mt=.5/mt,_t=(ct._transform._rotation01+ct._transform._rotation10)*mt,ft=(ct._transform._rotation12+ct._transform._rotation21)*mt,ut=(ct._transform._rotation02-ct._transform._rotation20)*mt):(ft=.5*(mt=Math.sqrt(It-vt-bt+1)),mt=.5/mt,_t=(ct._transform._rotation02+ct._transform._rotation20)*mt,ht=(ct._transform._rotation12+ct._transform._rotation21)*mt,ut=(ct._transform._rotation10-ct._transform._rotation01)*mt);var yt=(_t=lt*_t+st*ut+rt*ft-ot*ht)*_t+(ht=lt*ht-st*ft+rt*ut+ot*_t)*ht+(ft=lt*ft+st*ht-rt*_t+ot*ut)*ft+(ut=lt*ut-st*_t-rt*ht-ot*ft)*ut;1e-32<yt&&(yt=1/Math.sqrt(yt));_t*=yt,ht*=yt,ft*=yt,ut*=yt;var wt,xt,Ct,At,Zt,zt,Bt,kt,St,Xt,Yt,Nt,Lt,Gt,Wt,Dt,Tt,Vt,Kt=2*_t,jt=2*ht,Rt=2*ft,Ht=_t*Kt,Pt=ht*jt,Ft=ft*Rt,Ot=_t*jt,Et=ht*Rt,Ut=_t*Rt,Jt=ut*Kt,Qt=ut*jt,qt=ut*Rt;ct._transform._rotation00=1-Pt-Ft,ct._transform._rotation01=Ot-qt,ct._transform._rotation02=Ut+Qt,ct._transform._rotation10=Ot+qt,ct._transform._rotation11=1-Ht-Ft,ct._transform._rotation12=Et-Jt,ct._transform._rotation20=Ut-Qt,ct._transform._rotation21=Et+Jt,ct._transform._rotation22=1-Ht-Pt,wt=ct._transform._rotation00*ct._invLocalInertia00+ct._transform._rotation01*ct._invLocalInertia10+ct._transform._rotation02*ct._invLocalInertia20,xt=ct._transform._rotation00*ct._invLocalInertia01+ct._transform._rotation01*ct._invLocalInertia11+ct._transform._rotation02*ct._invLocalInertia21,Ct=ct._transform._rotation00*ct._invLocalInertia02+ct._transform._rotation01*ct._invLocalInertia12+ct._transform._rotation02*ct._invLocalInertia22,At=ct._transform._rotation10*ct._invLocalInertia00+ct._transform._rotation11*ct._invLocalInertia10+ct._transform._rotation12*ct._invLocalInertia20,Zt=ct._transform._rotation10*ct._invLocalInertia01+ct._transform._rotation11*ct._invLocalInertia11+ct._transform._rotation12*ct._invLocalInertia21,zt=ct._transform._rotation10*ct._invLocalInertia02+ct._transform._rotation11*ct._invLocalInertia12+ct._transform._rotation12*ct._invLocalInertia22,Bt=ct._transform._rotation20*ct._invLocalInertia00+ct._transform._rotation21*ct._invLocalInertia10+ct._transform._rotation22*ct._invLocalInertia20,kt=ct._transform._rotation20*ct._invLocalInertia01+ct._transform._rotation21*ct._invLocalInertia11+ct._transform._rotation22*ct._invLocalInertia21,St=ct._transform._rotation20*ct._invLocalInertia02+ct._transform._rotation21*ct._invLocalInertia12+ct._transform._rotation22*ct._invLocalInertia22,ct._invInertia00=wt,ct._invInertia01=xt,ct._invInertia02=Ct,ct._invInertia10=At,ct._invInertia11=Zt,ct._invInertia12=zt,ct._invInertia20=Bt,ct._invInertia21=kt,ct._invInertia22=St,Xt=ct._invInertia00*ct._transform._rotation00+ct._invInertia01*ct._transform._rotation01+ct._invInertia02*ct._transform._rotation02,Yt=ct._invInertia00*ct._transform._rotation10+ct._invInertia01*ct._transform._rotation11+ct._invInertia02*ct._transform._rotation12,Nt=ct._invInertia00*ct._transform._rotation20+ct._invInertia01*ct._transform._rotation21+ct._invInertia02*ct._transform._rotation22,Lt=ct._invInertia10*ct._transform._rotation00+ct._invInertia11*ct._transform._rotation01+ct._invInertia12*ct._transform._rotation02,Gt=ct._invInertia10*ct._transform._rotation10+ct._invInertia11*ct._transform._rotation11+ct._invInertia12*ct._transform._rotation12,Wt=ct._invInertia10*ct._transform._rotation20+ct._invInertia11*ct._transform._rotation21+ct._invInertia12*ct._transform._rotation22,Dt=ct._invInertia20*ct._transform._rotation00+ct._invInertia21*ct._transform._rotation01+ct._invInertia22*ct._transform._rotation02,Tt=ct._invInertia20*ct._transform._rotation10+ct._invInertia21*ct._transform._rotation11+ct._invInertia22*ct._transform._rotation12,Vt=ct._invInertia20*ct._transform._rotation20+ct._invInertia21*ct._transform._rotation21+ct._invInertia22*ct._transform._rotation22,ct._invInertia00=Xt,ct._invInertia01=Yt,ct._invInertia02=Nt,ct._invInertia10=Lt,ct._invInertia11=Gt,ct._invInertia12=Wt,ct._invInertia20=Dt,ct._invInertia21=Tt,ct._invInertia22=Vt,ct._invInertia00*=ct._rotFactor.x,ct._invInertia01*=ct._rotFactor.x,ct._invInertia02*=ct._rotFactor.x,ct._invInertia10*=ct._rotFactor.y,ct._invInertia11*=ct._rotFactor.y,ct._invInertia12*=ct._rotFactor.y,ct._invInertia20*=ct._rotFactor.z,ct._invInertia21*=ct._rotFactor.z,ct._invInertia22*=ct._rotFactor.z;var $t,te,ee,ae,ie,ne,se,re,oe,le,_e=this._b2,he=Math.sqrt(k*k+S*S+X*X),fe=.5*he;if(fe<.5){var ue=fe*fe;$t=.5*(1-.16666666666666666*ue+ue*ue*.008333333333333333),te=1-.5*ue+ue*ue*.041666666666666664}else $t=Math.sin(fe)/he,te=Math.cos(fe);ee=k*$t,ae=S*$t,ie=X*$t,ne=te;var ce,de=_e._transform._rotation00,ge=_e._transform._rotation11,pe=_e._transform._rotation22,me=de+ge+pe;0<me?(le=.5*(ce=Math.sqrt(me+1)),ce=.5/ce,se=(_e._transform._rotation21-_e._transform._rotation12)*ce,re=(_e._transform._rotation02-_e._transform._rotation20)*ce,oe=(_e._transform._rotation10-_e._transform._rotation01)*ce):ge<de?pe<de?(se=.5*(ce=Math.sqrt(de-ge-pe+1)),ce=.5/ce,re=(_e._transform._rotation01+_e._transform._rotation10)*ce,oe=(_e._transform._rotation02+_e._transform._rotation20)*ce,le=(_e._transform._rotation21-_e._transform._rotation12)*ce):(oe=.5*(ce=Math.sqrt(pe-de-ge+1)),ce=.5/ce,se=(_e._transform._rotation02+_e._transform._rotation20)*ce,re=(_e._transform._rotation12+_e._transform._rotation21)*ce,le=(_e._transform._rotation10-_e._transform._rotation01)*ce):pe<ge?(re=.5*(ce=Math.sqrt(ge-pe-de+1)),ce=.5/ce,se=(_e._transform._rotation01+_e._transform._rotation10)*ce,oe=(_e._transform._rotation12+_e._transform._rotation21)*ce,le=(_e._transform._rotation02-_e._transform._rotation20)*ce):(oe=.5*(ce=Math.sqrt(pe-de-ge+1)),ce=.5/ce,se=(_e._transform._rotation02+_e._transform._rotation20)*ce,re=(_e._transform._rotation12+_e._transform._rotation21)*ce,le=(_e._transform._rotation10-_e._transform._rotation01)*ce);var ve=(se=ne*se+ee*le+ae*oe-ie*re)*se+(re=ne*re-ee*oe+ae*le+ie*se)*re+(oe=ne*oe+ee*re-ae*se+ie*le)*oe+(le=ne*le-ee*se-ae*re-ie*oe)*le;1e-32<ve&&(ve=1/Math.sqrt(ve));se*=ve,re*=ve,oe*=ve,le*=ve;var be,Ie,Me,ye,we,xe,Ce,Ae,Ze,ze,Be,ke,Se,Xe,Ye,Ne,Le,Ge,We=2*se,De=2*re,Te=2*oe,Ve=se*We,Ke=re*De,je=oe*Te,Re=se*De,He=re*Te,Pe=se*Te,Fe=le*We,Oe=le*De,Ee=le*Te;_e._transform._rotation00=1-Ke-je,_e._transform._rotation01=Re-Ee,_e._transform._rotation02=Pe+Oe,_e._transform._rotation10=Re+Ee,_e._transform._rotation11=1-Ve-je,_e._transform._rotation12=He-Fe,_e._transform._rotation20=Pe-Oe,_e._transform._rotation21=He+Fe,_e._transform._rotation22=1-Ve-Ke,be=_e._transform._rotation00*_e._invLocalInertia00+_e._transform._rotation01*_e._invLocalInertia10+_e._transform._rotation02*_e._invLocalInertia20,Ie=_e._transform._rotation00*_e._invLocalInertia01+_e._transform._rotation01*_e._invLocalInertia11+_e._transform._rotation02*_e._invLocalInertia21,Me=_e._transform._rotation00*_e._invLocalInertia02+_e._transform._rotation01*_e._invLocalInertia12+_e._transform._rotation02*_e._invLocalInertia22,ye=_e._transform._rotation10*_e._invLocalInertia00+_e._transform._rotation11*_e._invLocalInertia10+_e._transform._rotation12*_e._invLocalInertia20,we=_e._transform._rotation10*_e._invLocalInertia01+_e._transform._rotation11*_e._invLocalInertia11+_e._transform._rotation12*_e._invLocalInertia21,xe=_e._transform._rotation10*_e._invLocalInertia02+_e._transform._rotation11*_e._invLocalInertia12+_e._transform._rotation12*_e._invLocalInertia22,Ce=_e._transform._rotation20*_e._invLocalInertia00+_e._transform._rotation21*_e._invLocalInertia10+_e._transform._rotation22*_e._invLocalInertia20,Ae=_e._transform._rotation20*_e._invLocalInertia01+_e._transform._rotation21*_e._invLocalInertia11+_e._transform._rotation22*_e._invLocalInertia21,Ze=_e._transform._rotation20*_e._invLocalInertia02+_e._transform._rotation21*_e._invLocalInertia12+_e._transform._rotation22*_e._invLocalInertia22,_e._invInertia00=be,_e._invInertia01=Ie,_e._invInertia02=Me,_e._invInertia10=ye,_e._invInertia11=we,_e._invInertia12=xe,_e._invInertia20=Ce,_e._invInertia21=Ae,_e._invInertia22=Ze,ze=_e._invInertia00*_e._transform._rotation00+_e._invInertia01*_e._transform._rotation01+_e._invInertia02*_e._transform._rotation02,Be=_e._invInertia00*_e._transform._rotation10+_e._invInertia01*_e._transform._rotation11+_e._invInertia02*_e._transform._rotation12,ke=_e._invInertia00*_e._transform._rotation20+_e._invInertia01*_e._transform._rotation21+_e._invInertia02*_e._transform._rotation22,Se=_e._invInertia10*_e._transform._rotation00+_e._invInertia11*_e._transform._rotation01+_e._invInertia12*_e._transform._rotation02,Xe=_e._invInertia10*_e._transform._rotation10+_e._invInertia11*_e._transform._rotation11+_e._invInertia12*_e._transform._rotation12,Ye=_e._invInertia10*_e._transform._rotation20+_e._invInertia11*_e._transform._rotation21+_e._invInertia12*_e._transform._rotation22,Ne=_e._invInertia20*_e._transform._rotation00+_e._invInertia21*_e._transform._rotation01+_e._invInertia22*_e._transform._rotation02,Le=_e._invInertia20*_e._transform._rotation10+_e._invInertia21*_e._transform._rotation11+_e._invInertia22*_e._transform._rotation12,Ge=_e._invInertia20*_e._transform._rotation20+_e._invInertia21*_e._transform._rotation21+_e._invInertia22*_e._transform._rotation22,_e._invInertia00=ze,_e._invInertia01=Be,_e._invInertia02=ke,_e._invInertia10=Se,_e._invInertia11=Xe,_e._invInertia12=Ye,_e._invInertia20=Ne,_e._invInertia21=Le,_e._invInertia22=Ge,_e._invInertia00*=_e._rotFactor.x,_e._invInertia01*=_e._rotFactor.x,_e._invInertia02*=_e._rotFactor.x,_e._invInertia10*=_e._rotFactor.y,_e._invInertia11*=_e._rotFactor.y,_e._invInertia12*=_e._rotFactor.y,_e._invInertia20*=_e._rotFactor.z,_e._invInertia21*=_e._rotFactor.z,_e._invInertia22*=_e._rotFactor.z},postSolve:function(){for(var t=0,e=this.info.numRows;t<e;){var a,i,n,s=t++,r=this.info.rows[s],o=r.impulse,l=r.jacobianT,_=r.jacobianB;n=i=a=0,a+=l.lin1X*o.impulseT,i+=l.lin1Y*o.impulseT,n+=l.lin1Z*o.impulseT,a+=_.lin1X*o.impulseB,i+=_.lin1Y*o.impulseB,n+=_.lin1Z*o.impulseB,o.impulseLX=a,o.impulseLY=i,o.impulseLZ=n}this.constraint._syncManifold()},__class__:Jn});var Qn=function(t){An.call(this),this.joint=t,this.info=new Gn;var e=new Array(xn.maxJacobianRows);this.massData=e;for(var a=0,i=this.massData.length;a<i;){var n=a++;this.massData[n]=new Rn}};(i["oimo.dynamics.constraint.solver.pgs.PgsJointConstraintSolver"]=Qn).__name__=!0,Qn.__super__=An,Qn.prototype=s(An.prototype,{joint:null,info:null,massData:null,preSolveVelocity:function(t){this.joint._syncAnchors(),this.joint._getVelocitySolverInfo(t,this.info),this._b1=this.info.b1,this._b2=this.info.b2;var e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b=this._b1._invMass,I=this._b2._invMass;e=this._b1._invInertia00,a=this._b1._invInertia01,i=this._b1._invInertia02,n=this._b1._invInertia10,s=this._b1._invInertia11,r=this._b1._invInertia12,o=this._b1._invInertia20,l=this._b1._invInertia21,_=this._b1._invInertia22,h=this._b2._invInertia00,f=this._b2._invInertia01,u=this._b2._invInertia02,c=this._b2._invInertia10,d=this._b2._invInertia11,g=this._b2._invInertia12,p=this._b2._invInertia20,m=this._b2._invInertia21,v=this._b2._invInertia22;for(var M=0,y=this.info.numRows;M<y;){var w,x,C,A,Z,z,B=M++,k=this.info.rows[B],S=this.massData[B],X=k.jacobian;if(X.updateSparsity(),0!=(1&X.flag)?(S.invMLin1X=X.lin1X*b,S.invMLin1Y=X.lin1Y*b,S.invMLin1Z=X.lin1Z*b,S.invMLin2X=X.lin2X*I,S.invMLin2Y=X.lin2Y*I,S.invMLin2Z=X.lin2Z*I):(S.invMLin1X=0,S.invMLin1Y=0,S.invMLin1Z=0,S.invMLin2X=0,S.invMLin2Y=0,S.invMLin2Z=0),0!=(2&X.flag))w=e*X.ang1X+a*X.ang1Y+i*X.ang1Z,x=n*X.ang1X+s*X.ang1Y+r*X.ang1Z,C=o*X.ang1X+l*X.ang1Y+_*X.ang1Z,S.invMAng1X=w,S.invMAng1Y=x,S.invMAng1Z=C,A=h*X.ang2X+f*X.ang2Y+u*X.ang2Z,Z=c*X.ang2X+d*X.ang2Y+g*X.ang2Z,z=p*X.ang2X+m*X.ang2Y+v*X.ang2Z,S.invMAng2X=A,S.invMAng2Y=Z,S.invMAng2Z=z;else S.invMAng1X=0,S.invMAng1Y=0,S.invMAng1Z=0,S.invMAng2X=0,S.invMAng2Y=0,S.invMAng2Z=0;S.massWithoutCfm=S.invMLin1X*X.lin1X+S.invMLin1Y*X.lin1Y+S.invMLin1Z*X.lin1Z+(S.invMLin2X*X.lin2X+S.invMLin2Y*X.lin2Y+S.invMLin2Z*X.lin2Z)+(S.invMAng1X*X.ang1X+S.invMAng1Y*X.ang1Y+S.invMAng1Z*X.ang1Z)+(S.invMAng2X*X.ang2X+S.invMAng2Y*X.ang2Y+S.invMAng2Z*X.ang2Z),S.mass=S.massWithoutCfm+k.cfm,0!=S.massWithoutCfm&&(S.massWithoutCfm=1/S.massWithoutCfm),0!=S.mass&&(S.mass=1/S.mass)}},warmStart:function(t){var e=this.joint._positionCorrectionAlgorithm==Zn.BAUMGARTE?xn.jointWarmStartingFactorForBaungarte:xn.jointWarmStartingFactor;if((e*=t.dtRatio)<=0)for(var a=0,i=this.info.numRows;a<i;){var n=a++,s=this.info.rows[n].impulse;s.impulse=0,s.impulseM=0,s.impulseP=0}else{var r,o,l,_,h,f,u,c,d,g,p,m;r=this._b1._velX,o=this._b1._velY,l=this._b1._velZ,_=this._b2._velX,h=this._b2._velY,f=this._b2._velZ,u=this._b1._angVelX,c=this._b1._angVelY,d=this._b1._angVelZ,g=this._b2._angVelX,p=this._b2._angVelY,m=this._b2._angVelZ;for(var v=0,b=this.info.numRows;v<b;){var I=v++,M=this.info.rows[I],y=this.massData[I],w=M.impulse;M.jacobian;w.impulse*=e,w.impulseM*=e;var x=w.impulse+w.impulseM;r+=y.invMLin1X*x,o+=y.invMLin1Y*x,l+=y.invMLin1Z*x,_+=y.invMLin2X*-x,h+=y.invMLin2Y*-x,f+=y.invMLin2Z*-x,u+=y.invMAng1X*x,c+=y.invMAng1Y*x,d+=y.invMAng1Z*x,g+=y.invMAng2X*-x,p+=y.invMAng2Y*-x,m+=y.invMAng2Z*-x}this._b1._velX=r,this._b1._velY=o,this._b1._velZ=l,this._b2._velX=_,this._b2._velY=h,this._b2._velZ=f,this._b1._angVelX=u,this._b1._angVelY=c,this._b1._angVelZ=d,this._b2._angVelX=g,this._b2._angVelY=p,this._b2._angVelZ=m}},solveVelocity:function(){var t,e,a,i,n,s,r,o,l,_,h,f;t=this._b1._velX,e=this._b1._velY,a=this._b1._velZ,i=this._b2._velX,n=this._b2._velY,s=this._b2._velZ,r=this._b1._angVelX,o=this._b1._angVelY,l=this._b1._angVelZ,_=this._b2._angVelX,h=this._b2._angVelY,f=this._b2._angVelZ;for(var u=0,c=this.info.numRows;u<c;){var d=u++,g=this.info.rows[d],p=this.massData[d],m=g.impulse,v=g.jacobian;if(0!=g.motorMaxImpulse){var b=0;b+=t*v.lin1X+e*v.lin1Y+a*v.lin1Z,b-=i*v.lin2X+n*v.lin2Y+s*v.lin2Z,b+=r*v.ang1X+o*v.ang1Y+l*v.ang1Z,b-=_*v.ang2X+h*v.ang2Y+f*v.ang2Z;var I=(-g.motorSpeed-b)*p.massWithoutCfm,M=m.impulseM;m.impulseM+=I,m.impulseM<-g.motorMaxImpulse?m.impulseM=-g.motorMaxImpulse:m.impulseM>g.motorMaxImpulse&&(m.impulseM=g.motorMaxImpulse),I=m.impulseM-M,0!=(1&v.flag)&&(t+=p.invMLin1X*I,e+=p.invMLin1Y*I,a+=p.invMLin1Z*I,i+=p.invMLin2X*-I,n+=p.invMLin2Y*-I,s+=p.invMLin2Z*-I),0!=(2&v.flag)&&(r+=p.invMAng1X*I,o+=p.invMAng1Y*I,l+=p.invMAng1Z*I,_+=p.invMAng2X*-I,h+=p.invMAng2Y*-I,f+=p.invMAng2Z*-I)}}for(var y=0,w=this.info.numRows;y<w;){var x=y++,C=this.info.rows[x],A=this.massData[x],Z=C.impulse,z=C.jacobian,B=0;B+=t*z.lin1X+e*z.lin1Y+a*z.lin1Z,B-=i*z.lin2X+n*z.lin2Y+s*z.lin2Z,B+=r*z.ang1X+o*z.ang1Y+l*z.ang1Z,B-=_*z.ang2X+h*z.ang2Y+f*z.ang2Z;var k=(C.rhs-B-Z.impulse*C.cfm)*A.mass,S=Z.impulse;Z.impulse+=k,Z.impulse<C.minImpulse?Z.impulse=C.minImpulse:Z.impulse>C.maxImpulse&&(Z.impulse=C.maxImpulse),k=Z.impulse-S,0!=(1&z.flag)&&(t+=A.invMLin1X*k,e+=A.invMLin1Y*k,a+=A.invMLin1Z*k,i+=A.invMLin2X*-k,n+=A.invMLin2Y*-k,s+=A.invMLin2Z*-k),0!=(2&z.flag)&&(r+=A.invMAng1X*k,o+=A.invMAng1Y*k,l+=A.invMAng1Z*k,_+=A.invMAng2X*-k,h+=A.invMAng2Y*-k,f+=A.invMAng2Z*-k)}this._b1._velX=t,this._b1._velY=e,this._b1._velZ=a,this._b2._velX=i,this._b2._velY=n,this._b2._velZ=s,this._b1._angVelX=r,this._b1._angVelY=o,this._b1._angVelZ=l,this._b2._angVelX=_,this._b2._angVelY=h,this._b2._angVelZ=f},postSolveVelocity:function(t){for(var e,a,i,n,s,r,o=r=s=n=i=a=e=0,l=this.info.numRows;o<l;){var _=o++,h=this.info.rows[_],f=h.impulse,u=h.jacobian;0!=(1&u.flag)?(e+=u.lin1X*f.impulse,a+=u.lin1Y*f.impulse,i+=u.lin1Z*f.impulse):0!=(2&u.flag)&&(n+=u.ang1X*f.impulse,s+=u.ang1Y*f.impulse,r+=u.ang1Z*f.impulse)}this.joint._appliedForceX=e*t.invDt,this.joint._appliedForceY=a*t.invDt,this.joint._appliedForceZ=i*t.invDt,this.joint._appliedTorqueX=n*t.invDt,this.joint._appliedTorqueY=s*t.invDt,this.joint._appliedTorqueZ=r*t.invDt},preSolvePosition:function(t){this.joint._syncAnchors(),this.joint._getPositionSolverInfo(this.info),this._b1=this.info.b1,this._b2=this.info.b2;var e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b=this._b1._invMass,I=this._b2._invMass;e=this._b1._invInertia00,a=this._b1._invInertia01,i=this._b1._invInertia02,n=this._b1._invInertia10,s=this._b1._invInertia11,r=this._b1._invInertia12,o=this._b1._invInertia20,l=this._b1._invInertia21,_=this._b1._invInertia22,h=this._b2._invInertia00,f=this._b2._invInertia01,u=this._b2._invInertia02,c=this._b2._invInertia10,d=this._b2._invInertia11,g=this._b2._invInertia12,p=this._b2._invInertia20,m=this._b2._invInertia21,v=this._b2._invInertia22;for(var M=0,y=this.info.numRows;M<y;){var w,x,C,A,Z,z,B=M++,k=this.info.rows[B],S=this.massData[B],X=(k.impulse,k.jacobian);S.invMLin1X=X.lin1X*b,S.invMLin1Y=X.lin1Y*b,S.invMLin1Z=X.lin1Z*b,S.invMLin2X=X.lin2X*I,S.invMLin2Y=X.lin2Y*I,S.invMLin2Z=X.lin2Z*I,w=e*X.ang1X+a*X.ang1Y+i*X.ang1Z,x=n*X.ang1X+s*X.ang1Y+r*X.ang1Z,C=o*X.ang1X+l*X.ang1Y+_*X.ang1Z,S.invMAng1X=w,S.invMAng1Y=x,S.invMAng1Z=C,A=h*X.ang2X+f*X.ang2Y+u*X.ang2Z,Z=c*X.ang2X+d*X.ang2Y+g*X.ang2Z,z=p*X.ang2X+m*X.ang2Y+v*X.ang2Z,S.invMAng2X=A,S.invMAng2Y=Z,S.invMAng2Z=z,S.mass=S.invMLin1X*X.lin1X+S.invMLin1Y*X.lin1Y+S.invMLin1Z*X.lin1Z+(S.invMLin2X*X.lin2X+S.invMLin2Y*X.lin2Y+S.invMLin2Z*X.lin2Z)+(S.invMAng1X*X.ang1X+S.invMAng1Y*X.ang1Y+S.invMAng1Z*X.ang1Z)+(S.invMAng2X*X.ang2X+S.invMAng2Y*X.ang2Y+S.invMAng2Z*X.ang2Z),0!=S.mass&&(S.mass=1/S.mass)}for(var Y=0,N=this.info.numRows;Y<N;){var L=Y++;this.info.rows[L].impulse.impulseP=0}},solvePositionSplitImpulse:function(){var t,e,a,i,n,s,r,o,l,_,h,f;t=this._b1._pseudoVelX,e=this._b1._pseudoVelY,a=this._b1._pseudoVelZ,i=this._b2._pseudoVelX,n=this._b2._pseudoVelY,s=this._b2._pseudoVelZ,r=this._b1._angPseudoVelX,o=this._b1._angPseudoVelY,l=this._b1._angPseudoVelZ,_=this._b2._angPseudoVelX,h=this._b2._angPseudoVelY,f=this._b2._angPseudoVelZ;for(var u=0,c=this.info.numRows;u<c;){var d=u++,g=this.info.rows[d],p=this.massData[d],m=g.impulse,v=g.jacobian,b=0;b+=t*v.lin1X+e*v.lin1Y+a*v.lin1Z,b-=i*v.lin2X+n*v.lin2Y+s*v.lin2Z,b+=r*v.ang1X+o*v.ang1Y+l*v.ang1Z,b-=_*v.ang2X+h*v.ang2Y+f*v.ang2Z;var I=(g.rhs*xn.positionSplitImpulseBaumgarte-b)*p.mass,M=m.impulseP;m.impulseP+=I,m.impulseP<g.minImpulse?m.impulseP=g.minImpulse:m.impulseP>g.maxImpulse&&(m.impulseP=g.maxImpulse),I=m.impulseP-M,t+=p.invMLin1X*I,e+=p.invMLin1Y*I,a+=p.invMLin1Z*I,i+=p.invMLin2X*-I,n+=p.invMLin2Y*-I,s+=p.invMLin2Z*-I,r+=p.invMAng1X*I,o+=p.invMAng1Y*I,l+=p.invMAng1Z*I,_+=p.invMAng2X*-I,h+=p.invMAng2Y*-I,f+=p.invMAng2Z*-I}this._b1._pseudoVelX=t,this._b1._pseudoVelY=e,this._b1._pseudoVelZ=a,this._b2._pseudoVelX=i,this._b2._pseudoVelY=n,this._b2._pseudoVelZ=s,this._b1._angPseudoVelX=r,this._b1._angPseudoVelY=o,this._b1._angPseudoVelZ=l,this._b2._angPseudoVelX=_,this._b2._angPseudoVelY=h,this._b2._angPseudoVelZ=f},solvePositionNgs:function(t){this.joint._syncAnchors(),this.joint._getPositionSolverInfo(this.info),this._b1=this.info.b1,this._b2=this.info.b2;var e,a,i,n,s,r,o,l,_,h,f,u,c,d,g,p,m,v,b=this._b1._invMass,I=this._b2._invMass;e=this._b1._invInertia00,a=this._b1._invInertia01,i=this._b1._invInertia02,n=this._b1._invInertia10,s=this._b1._invInertia11,r=this._b1._invInertia12,o=this._b1._invInertia20,l=this._b1._invInertia21,_=this._b1._invInertia22,h=this._b2._invInertia00,f=this._b2._invInertia01,u=this._b2._invInertia02,c=this._b2._invInertia10,d=this._b2._invInertia11,g=this._b2._invInertia12,p=this._b2._invInertia20,m=this._b2._invInertia21,v=this._b2._invInertia22;for(var M,y,w,x,C,A,Z,z,B,k,S,X,Y=0,N=this.info.numRows;Y<N;){var L,G,W,D,T,V,K=Y++,j=this.info.rows[K],R=this.massData[K],H=(j.impulse,j.jacobian);R.invMLin1X=H.lin1X*b,R.invMLin1Y=H.lin1Y*b,R.invMLin1Z=H.lin1Z*b,R.invMLin2X=H.lin2X*I,R.invMLin2Y=H.lin2Y*I,R.invMLin2Z=H.lin2Z*I,L=e*H.ang1X+a*H.ang1Y+i*H.ang1Z,G=n*H.ang1X+s*H.ang1Y+r*H.ang1Z,W=o*H.ang1X+l*H.ang1Y+_*H.ang1Z,R.invMAng1X=L,R.invMAng1Y=G,R.invMAng1Z=W,D=h*H.ang2X+f*H.ang2Y+u*H.ang2Z,T=c*H.ang2X+d*H.ang2Y+g*H.ang2Z,V=p*H.ang2X+m*H.ang2Y+v*H.ang2Z,R.invMAng2X=D,R.invMAng2Y=T,R.invMAng2Z=V,R.mass=R.invMLin1X*H.lin1X+R.invMLin1Y*H.lin1Y+R.invMLin1Z*H.lin1Z+(R.invMLin2X*H.lin2X+R.invMLin2Y*H.lin2Y+R.invMLin2Z*H.lin2Z)+(R.invMAng1X*H.ang1X+R.invMAng1Y*H.ang1Y+R.invMAng1Z*H.ang1Z)+(R.invMAng2X*H.ang2X+R.invMAng2Y*H.ang2Y+R.invMAng2Z*H.ang2Z),0!=R.mass&&(R.mass=1/R.mass)}for(var P=X=S=k=B=z=Z=A=C=x=w=y=M=0,F=this.info.numRows;P<F;){var O=P++,E=this.info.rows[O],U=this.massData[O],J=E.impulse,Q=E.jacobian,q=0;q+=M*Q.lin1X+y*Q.lin1Y+w*Q.lin1Z,q-=x*Q.lin2X+C*Q.lin2Y+A*Q.lin2Z,q+=Z*Q.ang1X+z*Q.ang1Y+B*Q.ang1Z,q-=k*Q.ang2X+S*Q.ang2Y+X*Q.ang2Z;var $=(E.rhs*xn.positionNgsBaumgarte-q)*U.mass,tt=J.impulseP;J.impulseP+=$,J.impulseP<E.minImpulse?J.impulseP=E.minImpulse:J.impulseP>E.maxImpulse&&(J.impulseP=E.maxImpulse),$=J.impulseP-tt,M+=U.invMLin1X*$,y+=U.invMLin1Y*$,w+=U.invMLin1Z*$,x+=U.invMLin2X*-$,C+=U.invMLin2Y*-$,A+=U.invMLin2Z*-$,Z+=U.invMAng1X*$,z+=U.invMAng1Y*$,B+=U.invMAng1Z*$,k+=U.invMAng2X*-$,S+=U.invMAng2Y*-$,X+=U.invMAng2Z*-$}var et=this._b1;et._transform._positionX+=M,et._transform._positionY+=y,et._transform._positionZ+=w;var at=this._b2;at._transform._positionX+=x,at._transform._positionY+=C,at._transform._positionZ+=A;var it,nt,st,rt,ot,lt,_t,ht,ft,ut,ct=this._b1,dt=Math.sqrt(Z*Z+z*z+B*B),gt=.5*dt;if(gt<.5){var pt=gt*gt;it=.5*(1-.16666666666666666*pt+pt*pt*.008333333333333333),nt=1-.5*pt+pt*pt*.041666666666666664}else it=Math.sin(gt)/dt,nt=Math.cos(gt);st=Z*it,rt=z*it,ot=B*it,lt=nt;var mt,vt=ct._transform._rotation00,bt=ct._transform._rotation11,It=ct._transform._rotation22,Mt=vt+bt+It;0<Mt?(ut=.5*(mt=Math.sqrt(Mt+1)),mt=.5/mt,_t=(ct._transform._rotation21-ct._transform._rotation12)*mt,ht=(ct._transform._rotation02-ct._transform._rotation20)*mt,ft=(ct._transform._rotation10-ct._transform._rotation01)*mt):bt<vt?It<vt?(_t=.5*(mt=Math.sqrt(vt-bt-It+1)),mt=.5/mt,ht=(ct._transform._rotation01+ct._transform._rotation10)*mt,ft=(ct._transform._rotation02+ct._transform._rotation20)*mt,ut=(ct._transform._rotation21-ct._transform._rotation12)*mt):(ft=.5*(mt=Math.sqrt(It-vt-bt+1)),mt=.5/mt,_t=(ct._transform._rotation02+ct._transform._rotation20)*mt,ht=(ct._transform._rotation12+ct._transform._rotation21)*mt,ut=(ct._transform._rotation10-ct._transform._rotation01)*mt):It<bt?(ht=.5*(mt=Math.sqrt(bt-It-vt+1)),mt=.5/mt,_t=(ct._transform._rotation01+ct._transform._rotation10)*mt,ft=(ct._transform._rotation12+ct._transform._rotation21)*mt,ut=(ct._transform._rotation02-ct._transform._rotation20)*mt):(ft=.5*(mt=Math.sqrt(It-vt-bt+1)),mt=.5/mt,_t=(ct._transform._rotation02+ct._transform._rotation20)*mt,ht=(ct._transform._rotation12+ct._transform._rotation21)*mt,ut=(ct._transform._rotation10-ct._transform._rotation01)*mt);var yt=(_t=lt*_t+st*ut+rt*ft-ot*ht)*_t+(ht=lt*ht-st*ft+rt*ut+ot*_t)*ht+(ft=lt*ft+st*ht-rt*_t+ot*ut)*ft+(ut=lt*ut-st*_t-rt*ht-ot*ft)*ut;1e-32<yt&&(yt=1/Math.sqrt(yt));_t*=yt,ht*=yt,ft*=yt,ut*=yt;var wt,xt,Ct,At,Zt,zt,Bt,kt,St,Xt,Yt,Nt,Lt,Gt,Wt,Dt,Tt,Vt,Kt=2*_t,jt=2*ht,Rt=2*ft,Ht=_t*Kt,Pt=ht*jt,Ft=ft*Rt,Ot=_t*jt,Et=ht*Rt,Ut=_t*Rt,Jt=ut*Kt,Qt=ut*jt,qt=ut*Rt;ct._transform._rotation00=1-Pt-Ft,ct._transform._rotation01=Ot-qt,ct._transform._rotation02=Ut+Qt,ct._transform._rotation10=Ot+qt,ct._transform._rotation11=1-Ht-Ft,ct._transform._rotation12=Et-Jt,ct._transform._rotation20=Ut-Qt,ct._transform._rotation21=Et+Jt,ct._transform._rotation22=1-Ht-Pt,wt=ct._transform._rotation00*ct._invLocalInertia00+ct._transform._rotation01*ct._invLocalInertia10+ct._transform._rotation02*ct._invLocalInertia20,xt=ct._transform._rotation00*ct._invLocalInertia01+ct._transform._rotation01*ct._invLocalInertia11+ct._transform._rotation02*ct._invLocalInertia21,Ct=ct._transform._rotation00*ct._invLocalInertia02+ct._transform._rotation01*ct._invLocalInertia12+ct._transform._rotation02*ct._invLocalInertia22,At=ct._transform._rotation10*ct._invLocalInertia00+ct._transform._rotation11*ct._invLocalInertia10+ct._transform._rotation12*ct._invLocalInertia20,Zt=ct._transform._rotation10*ct._invLocalInertia01+ct._transform._rotation11*ct._invLocalInertia11+ct._transform._rotation12*ct._invLocalInertia21,zt=ct._transform._rotation10*ct._invLocalInertia02+ct._transform._rotation11*ct._invLocalInertia12+ct._transform._rotation12*ct._invLocalInertia22,Bt=ct._transform._rotation20*ct._invLocalInertia00+ct._transform._rotation21*ct._invLocalInertia10+ct._transform._rotation22*ct._invLocalInertia20,kt=ct._transform._rotation20*ct._invLocalInertia01+ct._transform._rotation21*ct._invLocalInertia11+ct._transform._rotation22*ct._invLocalInertia21,St=ct._transform._rotation20*ct._invLocalInertia02+ct._transform._rotation21*ct._invLocalInertia12+ct._transform._rotation22*ct._invLocalInertia22,ct._invInertia00=wt,ct._invInertia01=xt,ct._invInertia02=Ct,ct._invInertia10=At,ct._invInertia11=Zt,ct._invInertia12=zt,ct._invInertia20=Bt,ct._invInertia21=kt,ct._invInertia22=St,Xt=ct._invInertia00*ct._transform._rotation00+ct._invInertia01*ct._transform._rotation01+ct._invInertia02*ct._transform._rotation02,Yt=ct._invInertia00*ct._transform._rotation10+ct._invInertia01*ct._transform._rotation11+ct._invInertia02*ct._transform._rotation12,Nt=ct._invInertia00*ct._transform._rotation20+ct._invInertia01*ct._transform._rotation21+ct._invInertia02*ct._transform._rotation22,Lt=ct._invInertia10*ct._transform._rotation00+ct._invInertia11*ct._transform._rotation01+ct._invInertia12*ct._transform._rotation02,Gt=ct._invInertia10*ct._transform._rotation10+ct._invInertia11*ct._transform._rotation11+ct._invInertia12*ct._transform._rotation12,Wt=ct._invInertia10*ct._transform._rotation20+ct._invInertia11*ct._transform._rotation21+ct._invInertia12*ct._transform._rotation22,Dt=ct._invInertia20*ct._transform._rotation00+ct._invInertia21*ct._transform._rotation01+ct._invInertia22*ct._transform._rotation02,Tt=ct._invInertia20*ct._transform._rotation10+ct._invInertia21*ct._transform._rotation11+ct._invInertia22*ct._transform._rotation12,Vt=ct._invInertia20*ct._transform._rotation20+ct._invInertia21*ct._transform._rotation21+ct._invInertia22*ct._transform._rotation22,ct._invInertia00=Xt,ct._invInertia01=Yt,ct._invInertia02=Nt,ct._invInertia10=Lt,ct._invInertia11=Gt,ct._invInertia12=Wt,ct._invInertia20=Dt,ct._invInertia21=Tt,ct._invInertia22=Vt,ct._invInertia00*=ct._rotFactor.x,ct._invInertia01*=ct._rotFactor.x,ct._invInertia02*=ct._rotFactor.x,ct._invInertia10*=ct._rotFactor.y,ct._invInertia11*=ct._rotFactor.y,ct._invInertia12*=ct._rotFactor.y,ct._invInertia20*=ct._rotFactor.z,ct._invInertia21*=ct._rotFactor.z,ct._invInertia22*=ct._rotFactor.z;var $t,te,ee,ae,ie,ne,se,re,oe,le,_e=this._b2,he=Math.sqrt(k*k+S*S+X*X),fe=.5*he;if(fe<.5){var ue=fe*fe;$t=.5*(1-.16666666666666666*ue+ue*ue*.008333333333333333),te=1-.5*ue+ue*ue*.041666666666666664}else $t=Math.sin(fe)/he,te=Math.cos(fe);ee=k*$t,ae=S*$t,ie=X*$t,ne=te;var ce,de=_e._transform._rotation00,ge=_e._transform._rotation11,pe=_e._transform._rotation22,me=de+ge+pe;0<me?(le=.5*(ce=Math.sqrt(me+1)),ce=.5/ce,se=(_e._transform._rotation21-_e._transform._rotation12)*ce,re=(_e._transform._rotation02-_e._transform._rotation20)*ce,oe=(_e._transform._rotation10-_e._transform._rotation01)*ce):ge<de?pe<de?(se=.5*(ce=Math.sqrt(de-ge-pe+1)),ce=.5/ce,re=(_e._transform._rotation01+_e._transform._rotation10)*ce,oe=(_e._transform._rotation02+_e._transform._rotation20)*ce,le=(_e._transform._rotation21-_e._transform._rotation12)*ce):(oe=.5*(ce=Math.sqrt(pe-de-ge+1)),ce=.5/ce,se=(_e._transform._rotation02+_e._transform._rotation20)*ce,re=(_e._transform._rotation12+_e._transform._rotation21)*ce,le=(_e._transform._rotation10-_e._transform._rotation01)*ce):pe<ge?(re=.5*(ce=Math.sqrt(ge-pe-de+1)),ce=.5/ce,se=(_e._transform._rotation01+_e._transform._rotation10)*ce,oe=(_e._transform._rotation12+_e._transform._rotation21)*ce,le=(_e._transform._rotation02-_e._transform._rotation20)*ce):(oe=.5*(ce=Math.sqrt(pe-de-ge+1)),ce=.5/ce,se=(_e._transform._rotation02+_e._transform._rotation20)*ce,re=(_e._transform._rotation12+_e._transform._rotation21)*ce,le=(_e._transform._rotation10-_e._transform._rotation01)*ce);var ve=(se=ne*se+ee*le+ae*oe-ie*re)*se+(re=ne*re-ee*oe+ae*le+ie*se)*re+(oe=ne*oe+ee*re-ae*se+ie*le)*oe+(le=ne*le-ee*se-ae*re-ie*oe)*le;1e-32<ve&&(ve=1/Math.sqrt(ve));se*=ve,re*=ve,oe*=ve,le*=ve;var be,Ie,Me,ye,we,xe,Ce,Ae,Ze,ze,Be,ke,Se,Xe,Ye,Ne,Le,Ge,We=2*se,De=2*re,Te=2*oe,Ve=se*We,Ke=re*De,je=oe*Te,Re=se*De,He=re*Te,Pe=se*Te,Fe=le*We,Oe=le*De,Ee=le*Te;_e._transform._rotation00=1-Ke-je,_e._transform._rotation01=Re-Ee,_e._transform._rotation02=Pe+Oe,_e._transform._rotation10=Re+Ee,_e._transform._rotation11=1-Ve-je,_e._transform._rotation12=He-Fe,_e._transform._rotation20=Pe-Oe,_e._transform._rotation21=He+Fe,_e._transform._rotation22=1-Ve-Ke,be=_e._transform._rotation00*_e._invLocalInertia00+_e._transform._rotation01*_e._invLocalInertia10+_e._transform._rotation02*_e._invLocalInertia20,Ie=_e._transform._rotation00*_e._invLocalInertia01+_e._transform._rotation01*_e._invLocalInertia11+_e._transform._rotation02*_e._invLocalInertia21,Me=_e._transform._rotation00*_e._invLocalInertia02+_e._transform._rotation01*_e._invLocalInertia12+_e._transform._rotation02*_e._invLocalInertia22,ye=_e._transform._rotation10*_e._invLocalInertia00+_e._transform._rotation11*_e._invLocalInertia10+_e._transform._rotation12*_e._invLocalInertia20,we=_e._transform._rotation10*_e._invLocalInertia01+_e._transform._rotation11*_e._invLocalInertia11+_e._transform._rotation12*_e._invLocalInertia21,xe=_e._transform._rotation10*_e._invLocalInertia02+_e._transform._rotation11*_e._invLocalInertia12+_e._transform._rotation12*_e._invLocalInertia22,Ce=_e._transform._rotation20*_e._invLocalInertia00+_e._transform._rotation21*_e._invLocalInertia10+_e._transform._rotation22*_e._invLocalInertia20,Ae=_e._transform._rotation20*_e._invLocalInertia01+_e._transform._rotation21*_e._invLocalInertia11+_e._transform._rotation22*_e._invLocalInertia21,Ze=_e._transform._rotation20*_e._invLocalInertia02+_e._transform._rotation21*_e._invLocalInertia12+_e._transform._rotation22*_e._invLocalInertia22,_e._invInertia00=be,_e._invInertia01=Ie,_e._invInertia02=Me,_e._invInertia10=ye,_e._invInertia11=we,_e._invInertia12=xe,_e._invInertia20=Ce,_e._invInertia21=Ae,_e._invInertia22=Ze,ze=_e._invInertia00*_e._transform._rotation00+_e._invInertia01*_e._transform._rotation01+_e._invInertia02*_e._transform._rotation02,Be=_e._invInertia00*_e._transform._rotation10+_e._invInertia01*_e._transform._rotation11+_e._invInertia02*_e._transform._rotation12,ke=_e._invInertia00*_e._transform._rotation20+_e._invInertia01*_e._transform._rotation21+_e._invInertia02*_e._transform._rotation22,Se=_e._invInertia10*_e._transform._rotation00+_e._invInertia11*_e._transform._rotation01+_e._invInertia12*_e._transform._rotation02,Xe=_e._invInertia10*_e._transform._rotation10+_e._invInertia11*_e._transform._rotation11+_e._invInertia12*_e._transform._rotation12,Ye=_e._invInertia10*_e._transform._rotation20+_e._invInertia11*_e._transform._rotation21+_e._invInertia12*_e._transform._rotation22,Ne=_e._invInertia20*_e._transform._rotation00+_e._invInertia21*_e._transform._rotation01+_e._invInertia22*_e._transform._rotation02,Le=_e._invInertia20*_e._transform._rotation10+_e._invInertia21*_e._transform._rotation11+_e._invInertia22*_e._transform._rotation12,Ge=_e._invInertia20*_e._transform._rotation20+_e._invInertia21*_e._transform._rotation21+_e._invInertia22*_e._transform._rotation22,_e._invInertia00=ze,_e._invInertia01=Be,_e._invInertia02=ke,_e._invInertia10=Se,_e._invInertia11=Xe,_e._invInertia12=Ye,_e._invInertia20=Ne,_e._invInertia21=Le,_e._invInertia22=Ge,_e._invInertia00*=_e._rotFactor.x,_e._invInertia01*=_e._rotFactor.x,_e._invInertia02*=_e._rotFactor.x,_e._invInertia10*=_e._rotFactor.y,_e._invInertia11*=_e._rotFactor.y,_e._invInertia12*=_e._rotFactor.y,_e._invInertia20*=_e._rotFactor.z,_e._invInertia21*=_e._rotFactor.z,_e._invInertia22*=_e._rotFactor.z},postSolve:function(){this.joint._syncAnchors(),this.joint._checkDestruction()},__class__:Qn});var qn=function(t){this._next=null,this._prev=null,this._shapeList=null,this._shapeListLast=null,this._numShapes=0,this._contactLinkList=null,this._contactLinkListLast=null,this._numContactLinks=0,this._jointLinkList=null,this._jointLinkListLast=null,this._numJointLinks=0;var e=t.linearVelocity;this._velX=e.x,this._velY=e.y,this._velZ=e.z;var a=t.angularVelocity;this._angVelX=a.x,this._angVelY=a.y,this._angVelZ=a.z,this._pseudoVelX=0,this._pseudoVelY=0,this._pseudoVelZ=0,this._angPseudoVelX=0,this._angPseudoVelY=0,this._angPseudoVelZ=0,this._ptransform=new rn,this._transform=new rn;var i=t.position;this._ptransform._positionX=i.x,this._ptransform._positionY=i.y,this._ptransform._positionZ=i.z;var n=t.rotation;this._ptransform._rotation00=n.e00,this._ptransform._rotation01=n.e01,this._ptransform._rotation02=n.e02,this._ptransform._rotation10=n.e10,this._ptransform._rotation11=n.e11,this._ptransform._rotation12=n.e12,this._ptransform._rotation20=n.e20,this._ptransform._rotation21=n.e21,this._ptransform._rotation22=n.e22;var s=this._transform,r=this._ptransform;s._positionX=r._positionX,s._positionY=r._positionY,s._positionZ=r._positionZ,s._rotation00=r._rotation00,s._rotation01=r._rotation01,s._rotation02=r._rotation02,s._rotation10=r._rotation10,s._rotation11=r._rotation11,s._rotation12=r._rotation12,s._rotation20=r._rotation20,s._rotation21=r._rotation21,s._rotation22=r._rotation22,this._type=t.type,this._sleepTime=0,this._sleeping=!1,this._autoSleep=t.autoSleep,this._mass=0,this._invMass=0,this._localInertia00=0,this._localInertia01=0,this._localInertia02=0,this._localInertia10=0,this._localInertia11=0,this._localInertia12=0,this._localInertia20=0,this._localInertia21=0,this._localInertia22=0,this._invLocalInertia00=0,this._invLocalInertia01=0,this._invLocalInertia02=0,this._invLocalInertia10=0,this._invLocalInertia11=0,this._invLocalInertia12=0,this._invLocalInertia20=0,this._invLocalInertia21=0,this._invLocalInertia22=0,this._invLocalInertiaWithoutRotFactor00=0,this._invLocalInertiaWithoutRotFactor01=0,this._invLocalInertiaWithoutRotFactor02=0,this._invLocalInertiaWithoutRotFactor10=0,this._invLocalInertiaWithoutRotFactor11=0,this._invLocalInertiaWithoutRotFactor12=0,this._invLocalInertiaWithoutRotFactor20=0,this._invLocalInertiaWithoutRotFactor21=0,this._invLocalInertiaWithoutRotFactor22=0,this._invInertia00=0,this._invInertia01=0,this._invInertia02=0,this._invInertia10=0,this._invInertia11=0,this._invInertia12=0,this._invInertia20=0,this._invInertia21=0,this._invInertia22=0,this._linearDamping=t.linearDamping,this._angularDamping=t.angularDamping,this._forceX=0,this._forceY=0,this._forceZ=0,this._torqueX=0,this._torqueY=0,this._torqueZ=0,this._rotFactor=new Et(1,1,1),this._addedToIsland=!1,this._gravityScale=1,this._world=null};(i["oimo.dynamics.rigidbody.RigidBody"]=qn).__name__=!0,qn.prototype={_next:null,_prev:null,_shapeList:null,_shapeListLast:null,_numShapes:null,_velX:null,_velY:null,_velZ:null,_angVelX:null,_angVelY:null,_angVelZ:null,_pseudoVelX:null,_pseudoVelY:null,_pseudoVelZ:null,_angPseudoVelX:null,_angPseudoVelY:null,_angPseudoVelZ:null,_ptransform:null,_transform:null,_type:null,_sleepTime:null,_sleeping:null,_autoSleep:null,_mass:null,_invMass:null,_localInertia00:null,_localInertia01:null,_localInertia02:null,_localInertia10:null,_localInertia11:null,_localInertia12:null,_localInertia20:null,_localInertia21:null,_localInertia22:null,_rotFactor:null,_invLocalInertia00:null,_invLocalInertia01:null,_invLocalInertia02:null,_invLocalInertia10:null,_invLocalInertia11:null,_invLocalInertia12:null,_invLocalInertia20:null,_invLocalInertia21:null,_invLocalInertia22:null,_invLocalInertiaWithoutRotFactor00:null,_invLocalInertiaWithoutRotFactor01:null,_invLocalInertiaWithoutRotFactor02:null,_invLocalInertiaWithoutRotFactor10:null,_invLocalInertiaWithoutRotFactor11:null,_invLocalInertiaWithoutRotFactor12:null,_invLocalInertiaWithoutRotFactor20:null,_invLocalInertiaWithoutRotFactor21:null,_invLocalInertiaWithoutRotFactor22:null,_invInertia00:null,_invInertia01:null,_invInertia02:null,_invInertia10:null,_invInertia11:null,_invInertia12:null,_invInertia20:null,_invInertia21:null,_invInertia22:null,_linearDamping:null,_angularDamping:null,_forceX:null,_forceY:null,_forceZ:null,_torqueX:null,_torqueY:null,_torqueZ:null,_world:null,_contactLinkList:null,_contactLinkListLast:null,_numContactLinks:null,_jointLinkList:null,_jointLinkListLast:null,_numJointLinks:null,_addedToIsland:null,_gravityScale:null,_integrate:function(t){switch(this._type){case 1:this._velX=0,this._velY=0,this._velZ=0,this._angVelX=0,this._angVelY=0,this._angVelZ=0,this._pseudoVelX=0,this._pseudoVelY=0,this._pseudoVelZ=0,this._angPseudoVelX=0,this._angPseudoVelY=0,this._angPseudoVelZ=0;break;case 0:case 2:var e,a,i,n,s,r,o=(e=this._velX*t)*e+(a=this._velY*t)*a+(i=this._velZ*t)*i,l=(n=this._angVelX*t)*n+(s=this._angVelY*t)*s+(r=this._angVelZ*t)*r;if(0==o&&0==l)return;if(o>xn.maxTranslationPerStep*xn.maxTranslationPerStep){var _=xn.maxTranslationPerStep/Math.sqrt(o);this._velX*=_,this._velY*=_,this._velZ*=_,e*=_,a*=_,i*=_}if(l>xn.maxRotationPerStep*xn.maxRotationPerStep){var h=xn.maxRotationPerStep/Math.sqrt(l);this._angVelX*=h,this._angVelY*=h,this._angVelZ*=h,n*=h,s*=h,r*=h}this._transform._positionX+=e,this._transform._positionY+=a,this._transform._positionZ+=i;var f,u,c,d,g,p,m,v,b,I,M=Math.sqrt(n*n+s*s+r*r),y=.5*M;if(y<.5){var w=y*y;f=.5*(1-.16666666666666666*w+w*w*.008333333333333333),u=1-.5*w+w*w*.041666666666666664}else f=Math.sin(y)/M,u=Math.cos(y);c=n*f,d=s*f,g=r*f,p=u;var x,C=this._transform._rotation00,A=this._transform._rotation11,Z=this._transform._rotation22,z=C+A+Z;0<z?(I=.5*(x=Math.sqrt(z+1)),x=.5/x,m=(this._transform._rotation21-this._transform._rotation12)*x,v=(this._transform._rotation02-this._transform._rotation20)*x,b=(this._transform._rotation10-this._transform._rotation01)*x):A<C?Z<C?(m=.5*(x=Math.sqrt(C-A-Z+1)),x=.5/x,v=(this._transform._rotation01+this._transform._rotation10)*x,b=(this._transform._rotation02+this._transform._rotation20)*x,I=(this._transform._rotation21-this._transform._rotation12)*x):(b=.5*(x=Math.sqrt(Z-C-A+1)),x=.5/x,m=(this._transform._rotation02+this._transform._rotation20)*x,v=(this._transform._rotation12+this._transform._rotation21)*x,I=(this._transform._rotation10-this._transform._rotation01)*x):Z<A?(v=.5*(x=Math.sqrt(A-Z-C+1)),x=.5/x,m=(this._transform._rotation01+this._transform._rotation10)*x,b=(this._transform._rotation12+this._transform._rotation21)*x,I=(this._transform._rotation02-this._transform._rotation20)*x):(b=.5*(x=Math.sqrt(Z-C-A+1)),x=.5/x,m=(this._transform._rotation02+this._transform._rotation20)*x,v=(this._transform._rotation12+this._transform._rotation21)*x,I=(this._transform._rotation10-this._transform._rotation01)*x);var B=(m=p*m+c*I+d*b-g*v)*m+(v=p*v-c*b+d*I+g*m)*v+(b=p*b+c*v-d*m+g*I)*b+(I=p*I-c*m-d*v-g*b)*I;1e-32<B&&(B=1/Math.sqrt(B));m*=B,v*=B,b*=B,I*=B;var k,S,X,Y,N,L,G,W,D,T,V,K,j,R,H,P,F,O,E=2*m,U=2*v,J=2*b,Q=m*E,q=v*U,$=b*J,tt=m*U,et=v*J,at=m*J,it=I*E,nt=I*U,st=I*J;this._transform._rotation00=1-q-$,this._transform._rotation01=tt-st,this._transform._rotation02=at+nt,this._transform._rotation10=tt+st,this._transform._rotation11=1-Q-$,this._transform._rotation12=et-it,this._transform._rotation20=at-nt,this._transform._rotation21=et+it,this._transform._rotation22=1-Q-q,k=this._transform._rotation00*this._invLocalInertia00+this._transform._rotation01*this._invLocalInertia10+this._transform._rotation02*this._invLocalInertia20,S=this._transform._rotation00*this._invLocalInertia01+this._transform._rotation01*this._invLocalInertia11+this._transform._rotation02*this._invLocalInertia21,X=this._transform._rotation00*this._invLocalInertia02+this._transform._rotation01*this._invLocalInertia12+this._transform._rotation02*this._invLocalInertia22,Y=this._transform._rotation10*this._invLocalInertia00+this._transform._rotation11*this._invLocalInertia10+this._transform._rotation12*this._invLocalInertia20,N=this._transform._rotation10*this._invLocalInertia01+this._transform._rotation11*this._invLocalInertia11+this._transform._rotation12*this._invLocalInertia21,L=this._transform._rotation10*this._invLocalInertia02+this._transform._rotation11*this._invLocalInertia12+this._transform._rotation12*this._invLocalInertia22,G=this._transform._rotation20*this._invLocalInertia00+this._transform._rotation21*this._invLocalInertia10+this._transform._rotation22*this._invLocalInertia20,W=this._transform._rotation20*this._invLocalInertia01+this._transform._rotation21*this._invLocalInertia11+this._transform._rotation22*this._invLocalInertia21,D=this._transform._rotation20*this._invLocalInertia02+this._transform._rotation21*this._invLocalInertia12+this._transform._rotation22*this._invLocalInertia22,this._invInertia00=k,this._invInertia01=S,this._invInertia02=X,this._invInertia10=Y,this._invInertia11=N,this._invInertia12=L,this._invInertia20=G,this._invInertia21=W,this._invInertia22=D,T=this._invInertia00*this._transform._rotation00+this._invInertia01*this._transform._rotation01+this._invInertia02*this._transform._rotation02,V=this._invInertia00*this._transform._rotation10+this._invInertia01*this._transform._rotation11+this._invInertia02*this._transform._rotation12,K=this._invInertia00*this._transform._rotation20+this._invInertia01*this._transform._rotation21+this._invInertia02*this._transform._rotation22,j=this._invInertia10*this._transform._rotation00+this._invInertia11*this._transform._rotation01+this._invInertia12*this._transform._rotation02,R=this._invInertia10*this._transform._rotation10+this._invInertia11*this._transform._rotation11+this._invInertia12*this._transform._rotation12,H=this._invInertia10*this._transform._rotation20+this._invInertia11*this._transform._rotation21+this._invInertia12*this._transform._rotation22,P=this._invInertia20*this._transform._rotation00+this._invInertia21*this._transform._rotation01+this._invInertia22*this._transform._rotation02,F=this._invInertia20*this._transform._rotation10+this._invInertia21*this._transform._rotation11+this._invInertia22*this._transform._rotation12,O=this._invInertia20*this._transform._rotation20+this._invInertia21*this._transform._rotation21+this._invInertia22*this._transform._rotation22,this._invInertia00=T,this._invInertia01=V,this._invInertia02=K,this._invInertia10=j,this._invInertia11=R,this._invInertia12=H,this._invInertia20=P,this._invInertia21=F,this._invInertia22=O,this._invInertia00*=this._rotFactor.x,this._invInertia01*=this._rotFactor.x,this._invInertia02*=this._rotFactor.x,this._invInertia10*=this._rotFactor.y,this._invInertia11*=this._rotFactor.y,this._invInertia12*=this._rotFactor.y,this._invInertia20*=this._rotFactor.z,this._invInertia21*=this._rotFactor.z,this._invInertia22*=this._rotFactor.z}},_integratePseudoVelocity:function(){var t=this._pseudoVelX*this._pseudoVelX+this._pseudoVelY*this._pseudoVelY+this._pseudoVelZ*this._pseudoVelZ,e=this._angPseudoVelX*this._angPseudoVelX+this._angPseudoVelY*this._angPseudoVelY+this._angPseudoVelZ*this._angPseudoVelZ;if(0!=t||0!=e)switch(this._type){case 1:this._pseudoVelX=0,this._pseudoVelY=0,this._pseudoVelZ=0,this._angPseudoVelX=0,this._angPseudoVelY=0,this._angPseudoVelZ=0;break;case 0:case 2:var a,i,n,s,r,o;a=this._pseudoVelX,i=this._pseudoVelY,n=this._pseudoVelZ,s=this._angPseudoVelX,r=this._angPseudoVelY,o=this._angPseudoVelZ,this._pseudoVelX=0,this._pseudoVelY=0,this._pseudoVelZ=0,this._angPseudoVelX=0,this._angPseudoVelY=0,this._angPseudoVelZ=0,this._transform._positionX+=a,this._transform._positionY+=i,this._transform._positionZ+=n;var l,_,h,f,u,c,d,g,p,m,v=Math.sqrt(s*s+r*r+o*o),b=.5*v;if(b<.5){var I=b*b;l=.5*(1-.16666666666666666*I+I*I*.008333333333333333),_=1-.5*I+I*I*.041666666666666664}else l=Math.sin(b)/v,_=Math.cos(b);h=s*l,f=r*l,u=o*l,c=_;var M,y=this._transform._rotation00,w=this._transform._rotation11,x=this._transform._rotation22,C=y+w+x;0<C?(m=.5*(M=Math.sqrt(C+1)),M=.5/M,d=(this._transform._rotation21-this._transform._rotation12)*M,g=(this._transform._rotation02-this._transform._rotation20)*M,p=(this._transform._rotation10-this._transform._rotation01)*M):w<y?x<y?(d=.5*(M=Math.sqrt(y-w-x+1)),M=.5/M,g=(this._transform._rotation01+this._transform._rotation10)*M,p=(this._transform._rotation02+this._transform._rotation20)*M,m=(this._transform._rotation21-this._transform._rotation12)*M):(p=.5*(M=Math.sqrt(x-y-w+1)),M=.5/M,d=(this._transform._rotation02+this._transform._rotation20)*M,g=(this._transform._rotation12+this._transform._rotation21)*M,m=(this._transform._rotation10-this._transform._rotation01)*M):x<w?(g=.5*(M=Math.sqrt(w-x-y+1)),M=.5/M,d=(this._transform._rotation01+this._transform._rotation10)*M,p=(this._transform._rotation12+this._transform._rotation21)*M,m=(this._transform._rotation02-this._transform._rotation20)*M):(p=.5*(M=Math.sqrt(x-y-w+1)),M=.5/M,d=(this._transform._rotation02+this._transform._rotation20)*M,g=(this._transform._rotation12+this._transform._rotation21)*M,m=(this._transform._rotation10-this._transform._rotation01)*M);var A=(d=c*d+h*m+f*p-u*g)*d+(g=c*g-h*p+f*m+u*d)*g+(p=c*p+h*g-f*d+u*m)*p+(m=c*m-h*d-f*g-u*p)*m;1e-32<A&&(A=1/Math.sqrt(A));d*=A,g*=A,p*=A,m*=A;var Z,z,B,k,S,X,Y,N,L,G,W,D,T,V,K,j,R,H,P=2*d,F=2*g,O=2*p,E=d*P,U=g*F,J=p*O,Q=d*F,q=g*O,$=d*O,tt=m*P,et=m*F,at=m*O;this._transform._rotation00=1-U-J,this._transform._rotation01=Q-at,this._transform._rotation02=$+et,this._transform._rotation10=Q+at,this._transform._rotation11=1-E-J,this._transform._rotation12=q-tt,this._transform._rotation20=$-et,this._transform._rotation21=q+tt,this._transform._rotation22=1-E-U,Z=this._transform._rotation00*this._invLocalInertia00+this._transform._rotation01*this._invLocalInertia10+this._transform._rotation02*this._invLocalInertia20,z=this._transform._rotation00*this._invLocalInertia01+this._transform._rotation01*this._invLocalInertia11+this._transform._rotation02*this._invLocalInertia21,B=this._transform._rotation00*this._invLocalInertia02+this._transform._rotation01*this._invLocalInertia12+this._transform._rotation02*this._invLocalInertia22,k=this._transform._rotation10*this._invLocalInertia00+this._transform._rotation11*this._invLocalInertia10+this._transform._rotation12*this._invLocalInertia20,S=this._transform._rotation10*this._invLocalInertia01+this._transform._rotation11*this._invLocalInertia11+this._transform._rotation12*this._invLocalInertia21,X=this._transform._rotation10*this._invLocalInertia02+this._transform._rotation11*this._invLocalInertia12+this._transform._rotation12*this._invLocalInertia22,Y=this._transform._rotation20*this._invLocalInertia00+this._transform._rotation21*this._invLocalInertia10+this._transform._rotation22*this._invLocalInertia20,N=this._transform._rotation20*this._invLocalInertia01+this._transform._rotation21*this._invLocalInertia11+this._transform._rotation22*this._invLocalInertia21,L=this._transform._rotation20*this._invLocalInertia02+this._transform._rotation21*this._invLocalInertia12+this._transform._rotation22*this._invLocalInertia22,this._invInertia00=Z,this._invInertia01=z,this._invInertia02=B,this._invInertia10=k,this._invInertia11=S,this._invInertia12=X,this._invInertia20=Y,this._invInertia21=N,this._invInertia22=L,G=this._invInertia00*this._transform._rotation00+this._invInertia01*this._transform._rotation01+this._invInertia02*this._transform._rotation02,W=this._invInertia00*this._transform._rotation10+this._invInertia01*this._transform._rotation11+this._invInertia02*this._transform._rotation12,D=this._invInertia00*this._transform._rotation20+this._invInertia01*this._transform._rotation21+this._invInertia02*this._transform._rotation22,T=this._invInertia10*this._transform._rotation00+this._invInertia11*this._transform._rotation01+this._invInertia12*this._transform._rotation02,V=this._invInertia10*this._transform._rotation10+this._invInertia11*this._transform._rotation11+this._invInertia12*this._transform._rotation12,K=this._invInertia10*this._transform._rotation20+this._invInertia11*this._transform._rotation21+this._invInertia12*this._transform._rotation22,j=this._invInertia20*this._transform._rotation00+this._invInertia21*this._transform._rotation01+this._invInertia22*this._transform._rotation02,R=this._invInertia20*this._transform._rotation10+this._invInertia21*this._transform._rotation11+this._invInertia22*this._transform._rotation12,H=this._invInertia20*this._transform._rotation20+this._invInertia21*this._transform._rotation21+this._invInertia22*this._transform._rotation22,this._invInertia00=G,this._invInertia01=W,this._invInertia02=D,this._invInertia10=T,this._invInertia11=V,this._invInertia12=K,this._invInertia20=j,this._invInertia21=R,this._invInertia22=H,this._invInertia00*=this._rotFactor.x,this._invInertia01*=this._rotFactor.x,this._invInertia02*=this._rotFactor.x,this._invInertia10*=this._rotFactor.y,this._invInertia11*=this._rotFactor.y,this._invInertia12*=this._rotFactor.y,this._invInertia20*=this._rotFactor.z,this._invInertia21*=this._rotFactor.z,this._invInertia22*=this._rotFactor.z}},updateMass:function(){for(var t,e,a,i,n,s,r,o,l,_=l=o=r=s=n=i=a=e=t=0,h=this._shapeList;null!=h;){var f=h._next,u=h._geom;u._updateMass();var c,d,g,p,m,v,b,I,M,y,w,x,C,A,Z,z,B,k,S,X=h._density*u._volume;y=h._localTransform._rotation00*u._inertiaCoeff00+h._localTransform._rotation01*u._inertiaCoeff10+h._localTransform._rotation02*u._inertiaCoeff20,d=h._localTransform._rotation00*u._inertiaCoeff01+h._localTransform._rotation01*u._inertiaCoeff11+h._localTransform._rotation02*u._inertiaCoeff21,g=h._localTransform._rotation00*u._inertiaCoeff02+h._localTransform._rotation01*u._inertiaCoeff12+h._localTransform._rotation02*u._inertiaCoeff22,p=h._localTransform._rotation10*u._inertiaCoeff00+h._localTransform._rotation11*u._inertiaCoeff10+h._localTransform._rotation12*u._inertiaCoeff20,m=h._localTransform._rotation10*u._inertiaCoeff01+h._localTransform._rotation11*u._inertiaCoeff11+h._localTransform._rotation12*u._inertiaCoeff21,v=h._localTransform._rotation10*u._inertiaCoeff02+h._localTransform._rotation11*u._inertiaCoeff12+h._localTransform._rotation12*u._inertiaCoeff22,b=h._localTransform._rotation20*u._inertiaCoeff00+h._localTransform._rotation21*u._inertiaCoeff10+h._localTransform._rotation22*u._inertiaCoeff20,I=h._localTransform._rotation20*u._inertiaCoeff01+h._localTransform._rotation21*u._inertiaCoeff11+h._localTransform._rotation22*u._inertiaCoeff21,M=h._localTransform._rotation20*u._inertiaCoeff02+h._localTransform._rotation21*u._inertiaCoeff12+h._localTransform._rotation22*u._inertiaCoeff22,w=(c=y)*h._localTransform._rotation00+d*h._localTransform._rotation01+g*h._localTransform._rotation02,x=c*h._localTransform._rotation10+d*h._localTransform._rotation11+g*h._localTransform._rotation12,C=c*h._localTransform._rotation20+d*h._localTransform._rotation21+g*h._localTransform._rotation22,A=p*h._localTransform._rotation00+m*h._localTransform._rotation01+v*h._localTransform._rotation02,Z=p*h._localTransform._rotation10+m*h._localTransform._rotation11+v*h._localTransform._rotation12,z=p*h._localTransform._rotation20+m*h._localTransform._rotation21+v*h._localTransform._rotation22,B=b*h._localTransform._rotation00+I*h._localTransform._rotation01+M*h._localTransform._rotation02,k=b*h._localTransform._rotation10+I*h._localTransform._rotation11+M*h._localTransform._rotation12,S=b*h._localTransform._rotation20+I*h._localTransform._rotation21+M*h._localTransform._rotation22,c=w,d=x,g=C,p=A,m=Z,v=z,b=B,I=k,M=S,c*=X,d*=X,g*=X,p*=X,m*=X,v*=X,b*=X,I*=X,M*=X;var Y=h._localTransform._positionX*h._localTransform._positionX,N=h._localTransform._positionY*h._localTransform._positionY,L=h._localTransform._positionZ*h._localTransform._positionZ,G=-h._localTransform._positionX*h._localTransform._positionY,W=-h._localTransform._positionY*h._localTransform._positionZ,D=-h._localTransform._positionZ*h._localTransform._positionX;_+=X,t+=c+=(N+L)*X,e+=d+=G*X,a+=g+=D*X,i+=p+=G*X,n+=m+=(Y+L)*X,s+=v+=W*X,r+=b+=D*X,o+=I+=W*X,l+=M+=(Y+N)*X,h=f}this._mass=_,this._localInertia00=t,this._localInertia01=e,this._localInertia02=a,this._localInertia10=i,this._localInertia11=n,this._localInertia12=s,this._localInertia20=r,this._localInertia21=o,this._localInertia22=l;var T,V,K,j,R,H,P,F,O,E,U,J,Q,q,$,tt,et,at,it=this._localInertia11*this._localInertia22-this._localInertia12*this._localInertia21,nt=this._localInertia10*this._localInertia22-this._localInertia12*this._localInertia20,st=this._localInertia10*this._localInertia21-this._localInertia11*this._localInertia20,rt=this._localInertia00*it-this._localInertia01*nt+this._localInertia02*st;if(0<this._mass&&0<rt&&0==this._type){this._invMass=1/this._mass;var ot=this._localInertia11*this._localInertia22-this._localInertia12*this._localInertia21,lt=this._localInertia10*this._localInertia22-this._localInertia12*this._localInertia20,_t=this._localInertia10*this._localInertia21-this._localInertia11*this._localInertia20,ht=this._localInertia01*this._localInertia22-this._localInertia02*this._localInertia21,ft=this._localInertia00*this._localInertia22-this._localInertia02*this._localInertia20,ut=this._localInertia00*this._localInertia21-this._localInertia01*this._localInertia20,ct=this._localInertia01*this._localInertia12-this._localInertia02*this._localInertia11,dt=this._localInertia00*this._localInertia12-this._localInertia02*this._localInertia10,gt=this._localInertia00*this._localInertia11-this._localInertia01*this._localInertia10,pt=this._localInertia00*ot-this._localInertia01*lt+this._localInertia02*_t;(pt<-1e-32||1e-32<pt)&&(pt=1/pt),this._invLocalInertia00=ot*pt,this._invLocalInertia01=-ht*pt,this._invLocalInertia02=ct*pt,this._invLocalInertia10=-lt*pt,this._invLocalInertia11=ft*pt,this._invLocalInertia12=-dt*pt,this._invLocalInertia20=_t*pt,this._invLocalInertia21=-ut*pt,this._invLocalInertia22=gt*pt,this._invLocalInertiaWithoutRotFactor00=this._invLocalInertia00,this._invLocalInertiaWithoutRotFactor01=this._invLocalInertia01,this._invLocalInertiaWithoutRotFactor02=this._invLocalInertia02,this._invLocalInertiaWithoutRotFactor10=this._invLocalInertia10,this._invLocalInertiaWithoutRotFactor11=this._invLocalInertia11,this._invLocalInertiaWithoutRotFactor12=this._invLocalInertia12,this._invLocalInertiaWithoutRotFactor20=this._invLocalInertia20,this._invLocalInertiaWithoutRotFactor21=this._invLocalInertia21,this._invLocalInertiaWithoutRotFactor22=this._invLocalInertia22,this._invLocalInertia00=this._invLocalInertiaWithoutRotFactor00*this._rotFactor.x,this._invLocalInertia01=this._invLocalInertiaWithoutRotFactor01*this._rotFactor.x,this._invLocalInertia02=this._invLocalInertiaWithoutRotFactor02*this._rotFactor.x,this._invLocalInertia10=this._invLocalInertiaWithoutRotFactor10*this._rotFactor.y,this._invLocalInertia11=this._invLocalInertiaWithoutRotFactor11*this._rotFactor.y,this._invLocalInertia12=this._invLocalInertiaWithoutRotFactor12*this._rotFactor.y,this._invLocalInertia20=this._invLocalInertiaWithoutRotFactor20*this._rotFactor.z,this._invLocalInertia21=this._invLocalInertiaWithoutRotFactor21*this._rotFactor.z,this._invLocalInertia22=this._invLocalInertiaWithoutRotFactor22*this._rotFactor.z}else this._invMass=0,this._invLocalInertia00=0,this._invLocalInertia01=0,this._invLocalInertia02=0,this._invLocalInertia10=0,this._invLocalInertia11=0,this._invLocalInertia12=0,this._invLocalInertia20=0,this._invLocalInertia21=0,this._invLocalInertia22=0,this._invLocalInertiaWithoutRotFactor00=0,this._invLocalInertiaWithoutRotFactor01=0,this._invLocalInertiaWithoutRotFactor02=0,this._invLocalInertiaWithoutRotFactor10=0,this._invLocalInertiaWithoutRotFactor11=0,this._invLocalInertiaWithoutRotFactor12=0,this._invLocalInertiaWithoutRotFactor20=0,this._invLocalInertiaWithoutRotFactor21=0,(this._invLocalInertiaWithoutRotFactor22=0)==this._type&&(this._type=1);T=this._transform._rotation00*this._invLocalInertia00+this._transform._rotation01*this._invLocalInertia10+this._transform._rotation02*this._invLocalInertia20,V=this._transform._rotation00*this._invLocalInertia01+this._transform._rotation01*this._invLocalInertia11+this._transform._rotation02*this._invLocalInertia21,K=this._transform._rotation00*this._invLocalInertia02+this._transform._rotation01*this._invLocalInertia12+this._transform._rotation02*this._invLocalInertia22,j=this._transform._rotation10*this._invLocalInertia00+this._transform._rotation11*this._invLocalInertia10+this._transform._rotation12*this._invLocalInertia20,R=this._transform._rotation10*this._invLocalInertia01+this._transform._rotation11*this._invLocalInertia11+this._transform._rotation12*this._invLocalInertia21,H=this._transform._rotation10*this._invLocalInertia02+this._transform._rotation11*this._invLocalInertia12+this._transform._rotation12*this._invLocalInertia22,P=this._transform._rotation20*this._invLocalInertia00+this._transform._rotation21*this._invLocalInertia10+this._transform._rotation22*this._invLocalInertia20,F=this._transform._rotation20*this._invLocalInertia01+this._transform._rotation21*this._invLocalInertia11+this._transform._rotation22*this._invLocalInertia21,O=this._transform._rotation20*this._invLocalInertia02+this._transform._rotation21*this._invLocalInertia12+this._transform._rotation22*this._invLocalInertia22,this._invInertia00=T,this._invInertia01=V,this._invInertia02=K,this._invInertia10=j,this._invInertia11=R,this._invInertia12=H,this._invInertia20=P,this._invInertia21=F,this._invInertia22=O,E=this._invInertia00*this._transform._rotation00+this._invInertia01*this._transform._rotation01+this._invInertia02*this._transform._rotation02,U=this._invInertia00*this._transform._rotation10+this._invInertia01*this._transform._rotation11+this._invInertia02*this._transform._rotation12,J=this._invInertia00*this._transform._rotation20+this._invInertia01*this._transform._rotation21+this._invInertia02*this._transform._rotation22,Q=this._invInertia10*this._transform._rotation00+this._invInertia11*this._transform._rotation01+this._invInertia12*this._transform._rotation02,q=this._invInertia10*this._transform._rotation10+this._invInertia11*this._transform._rotation11+this._invInertia12*this._transform._rotation12,$=this._invInertia10*this._transform._rotation20+this._invInertia11*this._transform._rotation21+this._invInertia12*this._transform._rotation22,tt=this._invInertia20*this._transform._rotation00+this._invInertia21*this._transform._rotation01+this._invInertia22*this._transform._rotation02,et=this._invInertia20*this._transform._rotation10+this._invInertia21*this._transform._rotation11+this._invInertia22*this._transform._rotation12,at=this._invInertia20*this._transform._rotation20+this._invInertia21*this._transform._rotation21+this._invInertia22*this._transform._rotation22,this._invInertia00=E,this._invInertia01=U,this._invInertia02=J,this._invInertia10=Q,this._invInertia11=q,this._invInertia12=$,this._invInertia20=tt,this._invInertia21=et,this._invInertia22=at,this._invInertia00*=this._rotFactor.x,this._invInertia01*=this._rotFactor.x,this._invInertia02*=this._rotFactor.x,this._invInertia10*=this._rotFactor.y,this._invInertia11*=this._rotFactor.y,this._invInertia12*=this._rotFactor.y,this._invInertia20*=this._rotFactor.z,this._invInertia21*=this._rotFactor.z,this._invInertia22*=this._rotFactor.z,this._sleeping=!1,this._sleepTime=0},applyImpulse:function(t,e){var a,i,n,s,r,o,l,_,h,f=t;a=f.x,i=f.y,n=f.z,this._velX+=a*this._invMass,this._velY+=i*this._invMass,this._velZ+=n*this._invMass;var u,c,d,g=e;l=g.x,_=g.y,h=g.z,l-=this._transform._positionX,s=(_-=this._transform._positionY)*n-(h-=this._transform._positionZ)*i,r=h*a-l*n,o=l*i-_*a,u=this._invInertia00*s+this._invInertia01*r+this._invInertia02*o,c=this._invInertia10*s+this._invInertia11*r+this._invInertia12*o,d=this._invInertia20*s+this._invInertia21*r+this._invInertia22*o,s=u,r=c,o=d,this._angVelX+=s,this._angVelY+=r,this._angVelZ+=o,this._sleeping=!1,this._sleepTime=0},addShape:function(t){if(null==this._shapeList?this._shapeList=t:(this._shapeListLast._next=t)._prev=this._shapeListLast,this._shapeListLast=t,this._numShapes++,null!=(t._rigidBody=this)._world){var e=this._world;t._proxy=e._broadPhase.createProxy(t,t._aabb),t._id=e._shapeIdCount++,e._numShapes++}this.updateMass();for(var a=this._shapeList;null!=a;){var i,n,s,r,o,l,_,h,f,u,c,d,g=a._next,p=a._ptransform,m=a._localTransform,v=this._ptransform;i=v._rotation00*m._rotation00+v._rotation01*m._rotation10+v._rotation02*m._rotation20,n=v._rotation00*m._rotation01+v._rotation01*m._rotation11+v._rotation02*m._rotation21,s=v._rotation00*m._rotation02+v._rotation01*m._rotation12+v._rotation02*m._rotation22,r=v._rotation10*m._rotation00+v._rotation11*m._rotation10+v._rotation12*m._rotation20,o=v._rotation10*m._rotation01+v._rotation11*m._rotation11+v._rotation12*m._rotation21,l=v._rotation10*m._rotation02+v._rotation11*m._rotation12+v._rotation12*m._rotation22,_=v._rotation20*m._rotation00+v._rotation21*m._rotation10+v._rotation22*m._rotation20,h=v._rotation20*m._rotation01+v._rotation21*m._rotation11+v._rotation22*m._rotation21,f=v._rotation20*m._rotation02+v._rotation21*m._rotation12+v._rotation22*m._rotation22,p._rotation00=i,p._rotation01=n,p._rotation02=s,p._rotation10=r,p._rotation11=o,p._rotation12=l,p._rotation20=_,p._rotation21=h,p._rotation22=f,u=v._rotation00*m._positionX+v._rotation01*m._positionY+v._rotation02*m._positionZ,c=v._rotation10*m._positionX+v._rotation11*m._positionY+v._rotation12*m._positionZ,d=v._rotation20*m._positionX+v._rotation21*m._positionY+v._rotation22*m._positionZ,p._positionX=u,p._positionY=c,p._positionZ=d,p._positionX+=v._positionX,p._positionY+=v._positionY,p._positionZ+=v._positionZ;var b,I,M,y,w,x,C,A,Z,z,B,k,S,X,Y,N,L,G,W=a._transform,D=a._localTransform,T=this._transform;if(b=T._rotation00*D._rotation00+T._rotation01*D._rotation10+T._rotation02*D._rotation20,I=T._rotation00*D._rotation01+T._rotation01*D._rotation11+T._rotation02*D._rotation21,M=T._rotation00*D._rotation02+T._rotation01*D._rotation12+T._rotation02*D._rotation22,y=T._rotation10*D._rotation00+T._rotation11*D._rotation10+T._rotation12*D._rotation20,w=T._rotation10*D._rotation01+T._rotation11*D._rotation11+T._rotation12*D._rotation21,x=T._rotation10*D._rotation02+T._rotation11*D._rotation12+T._rotation12*D._rotation22,C=T._rotation20*D._rotation00+T._rotation21*D._rotation10+T._rotation22*D._rotation20,A=T._rotation20*D._rotation01+T._rotation21*D._rotation11+T._rotation22*D._rotation21,Z=T._rotation20*D._rotation02+T._rotation21*D._rotation12+T._rotation22*D._rotation22,W._rotation00=b,W._rotation01=I,W._rotation02=M,W._rotation10=y,W._rotation11=w,W._rotation12=x,W._rotation20=C,W._rotation21=A,W._rotation22=Z,z=T._rotation00*D._positionX+T._rotation01*D._positionY+T._rotation02*D._positionZ,B=T._rotation10*D._positionX+T._rotation11*D._positionY+T._rotation12*D._positionZ,k=T._rotation20*D._positionX+T._rotation21*D._positionY+T._rotation22*D._positionZ,W._positionX=z,W._positionY=B,W._positionZ=k,W._positionX+=T._positionX,W._positionY+=T._positionY,W._positionZ+=T._positionZ,a._geom._computeAabb(a._aabb,a._ptransform),S=a._aabb._minX,X=a._aabb._minY,Y=a._aabb._minZ,N=a._aabb._maxX,L=a._aabb._maxY,G=a._aabb._maxZ,a._geom._computeAabb(a._aabb,a._transform),a._aabb._minX=S<a._aabb._minX?S:a._aabb._minX,a._aabb._minY=X<a._aabb._minY?X:a._aabb._minY,a._aabb._minZ=Y<a._aabb._minZ?Y:a._aabb._minZ,a._aabb._maxX=N>a._aabb._maxX?N:a._aabb._maxX,a._aabb._maxY=L>a._aabb._maxY?L:a._aabb._maxY,a._aabb._maxZ=G>a._aabb._maxZ?G:a._aabb._maxZ,null!=a._proxy){var V,K,j;V=a._transform._positionX-a._ptransform._positionX,K=a._transform._positionY-a._ptransform._positionY,j=a._transform._positionZ-a._ptransform._positionZ;var R=a.displacement;R.x=V,R.y=K,R.z=j,a._rigidBody._world._broadPhase.moveProxy(a._proxy,a._aabb,a.displacement)}a=g}},__class__:qn};var $n=function(){this.position=new Et,this.rotation=new _n,this.linearVelocity=new Et,this.angularVelocity=new Et,this.type=0,this.autoSleep=!0,this.linearDamping=0,this.angularDamping=0};(i["oimo.dynamics.rigidbody.RigidBodyConfig"]=$n).__name__=!0,$n.prototype={position:null,rotation:null,linearVelocity:null,angularVelocity:null,type:null,autoSleep:null,linearDamping:null,angularDamping:null,__class__:$n};var ts=function(){};(i["oimo.dynamics.rigidbody.RigidBodyType"]=ts).__name__=!0;var es=function(t){this._id=-1,this._localTransform=new rn,this._ptransform=new rn,this._transform=new rn;var e=t.position;this._localTransform._positionX=e.x,this._localTransform._positionY=e.y,this._localTransform._positionZ=e.z;var a=t.rotation;this._localTransform._rotation00=a.e00,this._localTransform._rotation01=a.e01,this._localTransform._rotation02=a.e02,this._localTransform._rotation10=a.e10,this._localTransform._rotation11=a.e11,this._localTransform._rotation12=a.e12,this._localTransform._rotation20=a.e20,this._localTransform._rotation21=a.e21,this._localTransform._rotation22=a.e22;var i=this._ptransform,n=this._localTransform;i._positionX=n._positionX,i._positionY=n._positionY,i._positionZ=n._positionZ,i._rotation00=n._rotation00,i._rotation01=n._rotation01,i._rotation02=n._rotation02,i._rotation10=n._rotation10,i._rotation11=n._rotation11,i._rotation12=n._rotation12,i._rotation20=n._rotation20,i._rotation21=n._rotation21,i._rotation22=n._rotation22;var s=this._transform,r=this._localTransform;s._positionX=r._positionX,s._positionY=r._positionY,s._positionZ=r._positionZ,s._rotation00=r._rotation00,s._rotation01=r._rotation01,s._rotation02=r._rotation02,s._rotation10=r._rotation10,s._rotation11=r._rotation11,s._rotation12=r._rotation12,s._rotation20=r._rotation20,s._rotation21=r._rotation21,s._rotation22=r._rotation22,this._restitution=t.restitution,this._friction=t.friction,this._density=t.density,this._geom=t.geometry,this._collisionGroup=t.collisionGroup,this._collisionMask=t.collisionMask,this._contactCallback=t.contactCallback,this._aabb=new Li,this._proxy=null,this.displacement=new Et};(i["oimo.dynamics.rigidbody.Shape"]=es).__name__=!0,es.prototype={_id:null,_prev:null,_next:null,_rigidBody:null,_geom:null,_localTransform:null,_ptransform:null,_transform:null,_restitution:null,_friction:null,_density:null,_aabb:null,_proxy:null,_collisionGroup:null,_collisionMask:null,_contactCallback:null,displacement:null,__class__:es};var as=function(){this.position=new Et,this.rotation=new _n,this.friction=xn.defaultFriction,this.restitution=xn.defaultRestitution,this.density=xn.defaultDensity,this.collisionGroup=xn.defaultCollisionGroup,this.collisionMask=xn.defaultCollisionMask,this.geometry=null,this.contactCallback=null};(i["oimo.dynamics.rigidbody.ShapeConfig"]=as).__name__=!0,as.prototype={position:null,rotation:null,friction:null,restitution:null,density:null,geometry:null,collisionGroup:null,collisionMask:null,contactCallback:null,__class__:as};var is=0;function ns(t,e){return null==e?null:(null==e.__id__&&(e.__id__=is++),null==t.hx__closures__?t.hx__closures__={}:a=t.hx__closures__[e.__id__],null==a&&(a=e.bind(t),t.hx__closures__[e.__id__]=a),a);var a}i.Math=Math,String.prototype.__class__=i.String=String,String.__name__=!0,i.Array=Array,Array.__name__=!0,Date.prototype.__class__=i.Date=Date,Date.__name__=["Date"];var ss={},rs={},os=Number,ls=Boolean,_s={},hs={};Be.count=0;var fs={};Object.defineProperty(Jt.prototype,"message",{get:function(){return String(this.val)}});var us=e.ArrayBuffer||Dt;null==us.prototype.slice&&(us.prototype.slice=Dt.sliceImpl);var cs=e.DataView||Tt,ds=e.Float32Array||Vt._new,gs=e.Uint8Array||Kt._new;da.helpVec=new lo,da.helpMat=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),A.helpVec0=new lo,A.helpVec1=new lo,A.helpVec2=new lo,A.helpMat=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),A.xAxis=new lo(1,0,0),A.yAxis=new lo(0,1,0),v.q=new A,M.datasetRGB1=[-1.099459,-.1335146,-4.083223,5.919603,-.1104166,1.600158,-1326538e-12,4.917807,.5127716,-1.169858,-.1832793,.9694744,.09495762,-.04738918,.2194171,.1095749,3.603604,.3815119,-.9665225,-.1403888,5.194457,-1.107607,-.8135181,4.969661,-.2300508,-2.48935,1.279158,-1.292508,-.1299552,-2.071404,-.04752482,1.215598,-1.904179,.3027985,8.707768,.06332446,-.9264666,-.169678,4.57407,-.4232936,-7.575833,5.079755,-.2576343,-4.506805,.6908129,-1.139072,-.1796056,1.923311,6.788529,-2.364389,-1.064041,.171701,1.534681,.501581,-1.107257,-.1384411,-4.285744,5.713157,-.1015992,1.372638,.06555893,5.127514,.6550471,-1.187337,-.1969013,.8551048,.05289708,-.07626406,.01733153,.1779454,3.801038,.4742709,-.9685321,-.1553308,4.732492,-1.178935,-.7852791,4.604492,-.2666518,-2.367663,1.177527,-1.252817,-.05129949,-2.800433,-.01295992,1.308964,-2.204331,.7276011,8.699265,.1188388,-.9459509,-.2322133,4.375041,-.1712018,-7.451681,5.078019,-.4223538,-4.595561,1.074719,-1.125092,-.179675,1.626399,6.989743,-2.406382,-.9060383,.2961611,1.337715,.543814,-1.135338,-.171616,-1.499253,2.373491,-.1654023,.9566404,.1113453,4.528473,.6579439,-1.13278,-.1456214,-1.736672,1.756589,-.1087003,.3757927,.252507,7.178513,.5003814,-1.167176,-.2927225,5.727667,-3.139244,-.6425204,2.822634,-.1457812,-6.78708,1.017072,-1.042529,.04110823,-4.000629,4.362364,1.09054,-1.338674,.8246964,10.95249,.2912211,-1.061598,-.2096143,3.803155,-7.977069,-3.63788,3.707671,-.1903128,-3.397953,.99715,-1.07356,-.2077964,1.492052,16.26322,-5.015304,-.4059889,.2659782,.639538,.5634436,-1.172794,-.2111186,-1.360013,1.60408,-.08473723,.7217312,.154803,4.25701,.6328974,-1.238374,-.2670827,.3247678,.5466311,-.7425952,.527644,.02678026,5.484169,.6814734,-1.176923,-.2574586,2.304045,-2.797678,1.464405,1.998552,.2550559,-4.199772,.7544892,-1.003284,.01943984,-2.145066,10.30924,-15.25413,-2.02301,.5448699,8.159497,.5539148,-1.060017,-.2037206,2.483018,-4.595459,6.526991,4.031804,.1206513,-2.586527,.7875752,-1.081141,-.2123302,1.092275,2.683841,-4.166938,-1.396582,.4371205,1.030233,.6664862,-1.222392,-.2651924,-.4625037,.3521964,.02148855,.5078494,.179159,3.852516,.5998216,-1.42461,-.4710155,-.1826815,1.786277,-1.952442,.5277612,-.01773629,2.415874,.6701272,-1.130655,-.1358609,.9171203,-4.660394,6.251162,1.904529,.2639668,1.85613,.822844,-.9739015,-.06674749,-.4768897,12.48589,-19.94688,-2.353043,.5885575,1.287251,.4830135,-1.082178,-.1974495,1.050245,-4.792855,8.663406,3.246969,.1556731,.8117442,.8050376,-1.063354,-.1727108,.9681592,2.736077,-4.969269,-.836057,.5994612,1.024039,.6786935,-1.261936,-.3053676,-.4262222,.4000196,-.02059388,.4721802,.1480028,3.505343,.6121337,-1.681088,-.6971919,-.1105652,.7437426,-.6594399,.2254221,.08710195,1.263913,.5681865,-.9453001,.03460388,.6067038,-1.985128,3.457236,2.655483,-.01162354,3.304716,1.00195,-1.086609,-.2029011,-.639917,6.926885,-15.12189,-3.793051,.945612,.2222222,.2893725,-1.041259,-.138879,1.147331,6.282086,3.679836,4.398314,-.1355232,1.031134,.9273509,-1.063473,-.1916051,.6556979,-.003371891,-3.699664,-1.926783,.7371154,1.179975,.6367068,-1.33639,-.3778927,-.7259477,.2270247,.4627513,.1366459,.2637347,3.292059,.4998211,-2.119878,-1.055472,.5422052,.7826648,-1.286065,.9517905,-.1432358,-.2379816,.5910513,-.7761432,.2124336,-.6845184,-.9812342,4.347257,.967198,.377315,5.789529,.9646598,-1.118734,-.3513815,.5500918,.9449627,-12.6207,-1.82528,.473126,-3.326892,.3568768,-1.026437,-.08257946,.3221701,11.98372,1.55513,2.560304,.1406465,2.912858,.8643181,-1.069949,-.2029607,.5825042,-.002398595,-3.278335,-1.349882,.7208433,.8505164,.6625391,-1.392309,-.4454945,-.5664,.6283393,-.3761727,.6949802,.07748178,3.192797,.5968661,-2.713405,-1.395112,.202923,.1877272,-.3715859,-.1652929,.2385861,-.4150768,.1375467,-.9588644,.024339,-1.527493,-.9632874,5.496269,1.094931,.2004044,6.084554,1.369604,-.8028546,-.2473563,1.617898,2.073591,-11.49446,-.8394131,.2726847,-4.634538,.1367293,-1.198326,-.1804865,-.3565414,4.0732,1.662086,1.23977,.3367978,2.997402,.9360383,-1.013531,-.185906,.5799857,13.31883,-4.346873,-1.11382,.5275714,.8045177,.6496373,-1.530103,-.6107468,-.3841771,1.881508,-1.464807,.665469,-5950797e-12,2.738912,.8101012,-2.415469,-1.057499,-.4161968,-2.357548,.6300296,.6224915,.01545048,2.038561,-.1339415,-3.096796,-1.465688,-1.199232,4.567061,3.26098,-.9794907,.8950491,2.049235,1.331015,.2713904,.2852852,1.20209,-8.206784,-5.805762,1.804431,-.6090648,-1.990902,.3288858,-1.45658,-.345596,-.06409257,16.67697,-2.311094,-.9771104,.6759863,1.245136,.7911932,-.9860389,-.2099564,.294665,-.0035478,-2.268313,-.06205647,.4705185,.8657995,.6856284,-1.971736,-.9414047,-.3400557,1.468763,-1.474284,.5501062,-110975e-10,2.35637,.9001702,-1.589845,-.7797079,-.558224,-.8137376,.5846617,.1129459,-.02658005,2.707248,-.2112486,-6.940173,-2.823963,-1.620848,1.090696,2.39173,1.370047,.5890462,1.7284,1.331253,1.293144,-.001919778,1.644206,-.8666967,-7.161953,-1.385018,-.1505374,-1.388643,.2530122,-1.48888,-.2495496,-.2377137,11.67714,-.8617124,1.053828,.1992744,.3633564,.8553304,-1.060891,-.4035829,.2823207,-.002369798,-1.876577,-.5950265,.4241017,.3140802,.6631669,-1.101204,-.1351353,-4.030882,6.096353,-.1148599,1.606507,-1555474e-12,4.436084,.5973715,-1.154597,-.1923378,.8512132,.2934895,-.06522777,.1389077,.09091469,3.133307,.2108541,-1.031588,-.1546804,5.266214,-.949139,-.7184867,4.875626,-.1911907,-2.865642,1.087895,-1.159454,-.09546699,-1.508146,-.02031411,1.040653,-2.333508,.2540592,8.594981,.0931677,-1.03594,-.2021151,4.719343,-.9019318,-7.858046,3.901234,-.2233137,-4.344739,.6550733,-1.096669,-.1558196,2.057553,6.274495,-2.678352,-1.814927,.1550676,1.903276,.4998989,-1.114209,-.1473531,-7.602914,8.973685,-.04980074,1.289198,.08366906,4.557987,.6118757,-1.149397,-.1981628,4.914096,-3.498986,-.0625709,.1667401,.104898,2.284689,.5935965,-1.056121,-.1456172,.4272656,2.912649,-.5501745,4.406542,-.138768,1.245555,.9733011,-1.125047,-.04003662,1.058457,-3.462236,.4395278,-2.395805,.5177589,4.866247,.4253189,-1.051444,-.2804541,3.364668,3.293787,-10.15741,3.807407,-.3592377,-3.367415,.7900825,-1.093847,-.1436965,2.38478,5.78707,-2.445987,-1.311171,.2326563,1.158439,.5555416,-1.134824,-.1680468,-3.32562,4.458596,-.1135063,1.1045,.07794544,4.609952,.6854854,-1.143017,-.1565926,.3014687,-.1763027,-.03557925,-.2342406,.2528705,5.884085,.4750602,-1.136801,-.2907502,3.682423,-.4061202,-.8728159,4.00151,-.1522202,-5.528713,1.044847,-1.063652,.07808107,-1.983678,.3648078,2.102276,-3.06505,.8431951,10.3883,.2662834,-1.061015,-.2859814,4.223615,-2.290138,-8.31401,4.405718,-.4613627,-4.50291,1.008383,-1.106302,-.1697123,2.087196,8.238929,-2.992416,-1.821776,.3434859,.7755179,.534119,-1.17111,-.2106304,-1.614361,2.378103,-.1625969,.8504483,.1059312,4.046256,.6618227,-1.20048,-.2235733,1.01439,-1.174074,-.444018,.2262406,.1665868,5.461829,.567631,-1.223587,-.3502622,1.699106,.6724266,1.268567,2.135102,.0008039374,-5.221111,.944569,-.9452673,.1468459,-1.335034,4.346628,-12.85652,-1.807046,.8175243,9.301065,.3656798,-1.134681,-.3310951,3.571244,-2.208948,6.04158,3.107577,-.3112127,-4.186351,.9188333,-1.083237,-.1831394,2.062654,1.385424,-5.00495,-1.332669,.3627352,.332315,.6191181,-1.211527,-.2590617,-.1660874,.3627905,-.1039258,.4697924,.1671653,3.507497,.6022506,-1.433017,-.4733592,.1724445,.9953236,-1.874457,.4432099,.0171581,2.339272,.644147,-1.08492,-.1587903,.8999585,-2.537516,5.877859,2.014554,.09689141,.3177242,.9030399,-1.008242,.00279303,-.3507469,10.283,-20.80454,-2.781026,.899509,3.366951,.3473867,-1.103151,-.2799598,2.525791,-4.255704,9.903388,3.722668,-.3603941,-1.303292,.9369454,-1.102235,-.2025061,2.08566,1.686787,-5.010957,-1.656458,.4584029,-.2751759,.6184162,-1.25613,-.3104904,.163935,.1315502,-.7297583,.477848,.1259265,3.012108,.6202728,-1.620114,-.655267,-.2877157,1.094371,.2818914,.369683,.09428521,1.450951,.5681308,-.9686204,-.03755647,1.46998,-3.103414,2.856583,1.883209,-.05746099,1.286383,1.001751,-1.089377,-.1023062,-1.498891,10.66455,-17.20184,-2.759314,1.061258,2.910211,.2624701,-1.044681,-.2156857,3.230136,-.5863862,6.09664,3.550019,-.4255773,-1.500033,.9687696,-1.133658,-.2505101,1.71784,.008480428,-5.011789,-1.740989,.498343,-.2081829,.6088641,-1.335366,-.3863319,-.5279971,.3638324,.3230699,.08339707,.2483293,2.678646,.4998346,-2.004511,-.9957121,1.250807,.01625025,-.3410754,.7858244,-.09506757,.02651876,.5788643,-.8714157,.1192051,-.8486879,-.3702497,1.818277,1.103427,.2454866,3.841575,.984735,-1.042618,-.2285793,.3620175,2.983368,-9.776844,-1.971587,.6691674,-.7901947,.32132,-1.099112,-.1869868,2.044065,2.062964,1.265668,2.71013,-.1099443,.2179353,.9024108,-1.106985,-.2396881,1.809807,8.523319,-5.011788,-1.590086,.3248449,-.1003187,.6550606,-1.421285,-.4767024,-.3885004,.827459,-.3644229,.6999513,.0519671,2.578431,.624631,-2.611217,-1.398846,.4527425,-.5932142,.2224617,-.5593581,.3389633,-.7767112,.06536004,-.9881543,.04684782,-.8616613,.8799807,4.00313,1.739543,-.08098378,5.524802,1.499673,-.7544759,-.2314808,.812577,-.7724135,-9.577645,-1.629433,.6790832,-4.193895,-.02526624,-1.273719,-.218703,1.401798,5.231832,.7405093,1.775166,-.07269476,1.996087,1.05745,-1.046864,-.2247559,1.679449,11.40057,-4.948829,-1.182664,.3241038,-.2470012,.61159,-1.514607,-.598543,-.187761,1.75693,-1.314206,.611581,-597046e-11,2.412975,.8124304,-2.308414,-1.083797,-.1179959,-1.728246,.7784742,.5494505,.006203168,.9326251,-.1419518,-3.230837,-1.43867,-.9868286,2.974393,1.949339,-.6337857,.8160271,3.278606,1.354373,.5149378,.2754789,1.040965,-4.501186,-3.399057,.9661861,-.4736173,-4.037574,.2794847,-1.62187,-.3192763,.8786242,9.785565,-2.727652,.01903691,.5521261,2.138764,.8419871,-.9951701,-.2550607,1.498952,-.002737197,-3.101832,-.5921329,.2864422,-.4405218,.663141,-1.902954,-.9056918,-.206957,1.191499,-1.092577,.5849556,-9649602e-12,2.048407,.9001527,-1.271627,-.7193923,-.01136606,-.1167951,.003286175,-.05262827,-.02473874,1.716125,-.2187133,-7.647175,-3.114129,-1.490128,-.5266488,3.06309,1.474262,.5481458,2.052174,1.353089,2.191403,.342112,1.44651,2.170943,-7.768187,-1.471207,-.1456708,-1.753574,.2310576,-1.932296,-.3814739,.6245422,6.748294,-.3060171,1.067747,.2500671,-.1252596,.8614611,-.9471101,-.405264,1.300174,-.003951536,-1.908284,-.5385721,.2133578,-.6250292,.6658012],M.datasetRGBRad1=[1.962684,1.159831,4.450588,5.079633,4.437388,4.324573,1.946487,1.287515,3.703696,8.782833,3.440437,5.160333,1.88217,1.335878,2.648641,13.58368,3.105473,5.907387,1.738159,1.624289,-.008786695,21.18253,2.770255,7.055672,1.571896,2.301786,-4.028545,29.66806,1.630876,8.711031,1.475048,2.679086,-6.311315,33.77896,2.140975,9.385283,1.326174,3.378759,-9.831444,39.42061,2.852702,10.82542,1.153344,3.967771,-12.65181,41.95016,7.468239,12.2135,.9746081,4.051626,-12.98454,37.54964,17.49232,14.20619,.8448016,3.181809,-8.757338,21.97962,35.24033,16.39549,2.029623,1.364434,4.201529,5.415099,9.825839,10.63328,2.023126,1.494728,3.420413,9.072178,9.205157,11.86639,1.956307,1.648665,2.039712,14.30239,9.039526,13.30453,1.825053,1.985022,-.8036307,22.02493,9.415361,15.17659,1.650367,2.593201,-4.469328,29.69817,9.410977,17.4485,1.555202,2.962925,-6.60817,33.29887,10.64559,18.50816,1.412478,3.439403,-9.196616,36.85077,13.45341,20.03128,1.25299,3.820805,-11.15338,37.21593,20.14916,21.8232,1.091952,3.663027,-10.3133,29.78985,32.96835,23.7545,.9501691,2.664579,-5.545167,12.81159,51.54768,25.74284],M.datasetRGB2=[-1.14053,-.1982747,-7.51273,8.403899,-.05699038,.9015907,.03392161,4.772522,.5111184,-1.165117,-.1852955,2.963684,-2.262274,-.1571683,.6339974,.04977879,7.243307,.4220053,-1.169936,-.3357429,1.911291,-.2391074,-.4791643,1.446113,-.09178108,-4.700239,.8096219,-1.060246,-.1051633,.5013829,2.832309,-.3707855,1.523131,.09163749,5.604183,.7208566,-1.089753,-.2382167,2.360312,-5.902562,-8.799894,1.377692,-.06131633,-1.415472,.6124057,-1.075481,-.1242391,1.425781,8.810319,-2.922646,1.48652,.0327058,3.889783,.4999482,-1.149342,-.2076337,-7.446587,8.014559,-.04866227,.8203043,.06386483,4.894198,.5452051,-1.120531,-.1513311,2.735504,-2.417591,-.1361114,.4296342,.09427488,8.171403,.4102448,-1.226964,-.3516378,1.308298,-.05097487,-.4846783,1.654619,-.113494,-3.347854,1.131147,-.9664377,.02767589,.1658235,2.407439,-.1300304,.9170958,.2742895,6.642633,.2550064,-1.153358,-.3126223,2.078934,-5.857733,-8.659848,1.758505,-.09616094,-1.230863,.9663832,-1.05385,-.1330743,1.481738,10.49485,-3.528854,.9142363,.124488,2.644615,.5001048,-1.173687,-.2360362,-3.741454,4.088507,-.07528205,.6645237,.07718265,4.65122,.5586318,-1.213757,-.2589561,.7132551,-.4259327,-.1980821,.3627815,.0466656,5.807984,.5847377,-1.108794,-.225987,1.574179,-.3753731,-.5984743,1.659414,-.01681021,.6785219,.8647325,-1.060896,-.0134669,-.7529656,1.711319,-.9792435,.2022433,.3826487,5.725157,.5290714,-1.085145,-.2840715,2.088029,-4.935097,-9.056542,1.976149,-.03912485,-.8636064,.7452125,-1.077983,-.1416633,1.100848,10.15875,-2.943712,.5255135,.2164224,2.941143,.6699937,-1.223293,-.2867444,-1.624136,1.668299,-.09537589,.5015947,.1130741,4.244812,.5082152,-1.325342,-.4280991,.470549,.06926592,-.4572587,.5344144,-.02554192,3.093939,.6639401,-1.113581,-.1192133,.4011536,.7011889,.2052842,.9880724,.01807533,4.69016,.857624,-1.016063,-.1038138,-.2280391,.7898918,-11.27333,.2074545,.5388182,1.364263,.4660455,-1.099582,-.2228607,1.332648,5.135188,1.653152,1.41702,-.1087532,1.809275,.8080874,-1.064357,-.1520775,.8207368,-.001323565,-5.009523,.3946298,.4337902,2.593198,.6719172,-1.278702,-.3512866,-.4511055,.389576,-.2429672,.4270577,.1135348,3.71913,.4998867,-1.580069,-.7095475,-.3198904,1.715748,-1.185915,.4523161,-.01026159,.7927188,.553835,-.9474023,.1173703,.4881381,-2.618684,3.251661,1.213931,-.01736274,8.000768,1.025998,-1.129091,-.3287694,-.3524077,3.352892,-14.16073,-.8485617,.6560766,-2.820937,.3111303,-1.030884,-.1137581,1.109855,8.082276,1.519214,2.112433,-.1592299,3.675905,.8703367,-1.075192,-.1627166,.351491,1.168164,-4.255822,-.6015348,.6265776,2.884818,.6548384,-1.316017,-.3889652,-.5030854,.4488704,-.31868,.4570763,.08909201,3.659274,.5011746,-1.731876,-.8493806,.1194871,2.002781,-2.006547,.4872233,-.02854606,.2662137,.4611629,-.927368,.1380954,-.3302179,-3.553265,4.633345,.9696729,.08799775,8.291129,1.094451,-1.099377,-.3325392,.2501063,2.613712,-13.28142,-.5579527,.4992081,-3.504402,.3022924,-1.04842,-.1227773,.5845373,11.05869,.03813151,1.330409,.01978131,3.95943,.8396439,-1.063233,-.1560639,.2840033,.8751565,-3.41182,-.1436564,.584658,2.899292,.6799095,-1.376715,-.4541567,-1.445491,1.569898,-.1390627,.555827,.04109877,3.349451,.5516123,-1.953391,-1.035869,1.690563,-.196469,-.7787096,.5799605,.02945626,.04217906,.2451373,-1.012422,.07136451,-1.862534,-.7228653,.1947997,.2091805,.06399233,7.928994,1.290733,-.9706708,-.288095,1.107797,-2.731734,-8.445995,.4296774,.5117648,-3.824277,.1761207,-1.110611,-.1789409,.2108488,20.7143,-1.763174,.09554695,-.02943103,3.422079,.8815496,-1.048334,-.1614087,.2475184,.02146938,-2.983901,.2538224,.560137,2.461925,.6777394,-1.393719,-.5002724,-2.40894,2.680983,-.1362825,.7395067,-3300343e-12,3.260889,.8132057,-2.128663,-1.151182,2.923026,-1.931838,-.442617,.2309983,-.00548589,.3279529,-.2229467,-1.618022,-.376649,-3.163544,1.611608,-.3967476,.393368,.3006742,6.835177,1.613765,-.5669064,-.1481749,2.071817,-8.157422,-5.988088,.2387202,.1447191,-4.296385,.05011258,-1.241724,-.2519348,-.1908609,29.52235,-3.33366,-.01837651,.1022249,2.92932,.8867262,-1.02167,-.1667327,.1789771,-.002178108,-2.641572,-.05641484,.5303758,2.138196,.678035,-1.669332,-.7588708,-2.993557,3.17876,-.08066442,.6544672,-808988e-11,2.628924,.9001272,-1.755806,-.8735348,3.258881,-2.504785,-.3300791,.1180565,-.009315982,1.785154,-.3205824,-3.720277,-1.73335,-3.332272,1.515869,.1734218,.8011956,.199544,3.817666,1.638502,.4724641,.3209828,2.051443,-5.105574,-6.509139,-.4232041,.2598931,-2.151756,-.00349391,-1.5256,-.4897606,-.09891121,23.46818,-2.278152,.1681219,-.04469389,1.051,.9294666,-.9908649,-.2008182,.1605143,-.002463113,-2.477349,-.1218647,.4750121,1.460813,.6661364,-2.122119,-1.125475,-3.066599,3.145078,-.05411593,.5133628,-7823408e-12,2.268448,.9001416,-1.528158,-.9370249,2.567559,-1.591439,-.363446,.1763256,.001119624,1.811848,-.2637929,-6.524387,-2.673507,-2.940472,-.6025609,.7852067,1.073499,-.03540435,3.517416,1.490466,.8886026,-.09681828,1.430554,4.993717,-6.071355,-.6053986,.5092997,-1.27301,.07491329,-1.481997,-.5897282,.2659264,1.267239,-.5741291,.05983011,-.2217312,-.3016452,.926083,-1.010943,-.2075134,.05066749,14.70708,-3.780501,.07253223,.4045458,1.320164,.6559925,-1.129907,-.1884011,-8.04767,9.035776,-.05539419,.8823349,.03197135,4.839388,.5042822,-1.133821,-.1510781,3.362822,-2.453381,-.1463925,.4728708,.0595814,7.6363,.4805162,-1.176518,-.3549902,1.729044,-.2160966,-.5075865,1.675584,-.08906902,-5.386842,.5452218,-1.043563,-.07520975,.8750644,2.510518,.007584882,.936125,.07889083,6.066644,.5813108,-1.081304,-.2222253,2.517638,-4.45382,-8.663691,.8662558,-.04802657,-.8965449,.4886656,-1.083774,-.1375469,1.685818,5.63112,-3.100752,.4045941,.02346895,3.390321,.5008309,-1.143158,-.2058334,-9.660198,10.62394,-.04434119,.8607615,.03177325,4.416481,.5918162,-1.146773,-.1727385,4.626048,-4.684602,-.08307137,.1619616,.1484866,7.572868,.2681126,-1.151324,-.3099303,.4125596,2.340752,-.4214444,1.987375,-.191341,-3.845978,1.337311,-1.034258,-.007778759,.7050094,-.8036369,.313857,.2469452,.355997,7.485917,.04790329,-1.096568,-.2673169,2.575654,-.8057121,-8.884928,1.41617,-.2091315,-1.543494,1.065445,-1.083304,-.1528265,1.697727,2.503702,-2.885296,-.12985,.154887,2.479652,.5066496,-1.165736,-.2329945,-5.967964,6.705959,-.05931355,.7485638,.03913878,4.221591,.6183926,-1.212422,-.254591,2.418626,-2.266104,-.1102014,.01363887,.1055411,5.648062,.4557412,-1.070436,-.2163341,.7098718,.7843075,-.432393,2.109823,-.095897,-.1985193,1.060428,-1.104879,-.03013622,.02976276,1.069707,.141,-.488002,.4452288,6.41859,.3195986,-1.048969,-.2655317,2.689426,-3.941038,-9.506461,1.837119,-.1892124,-1.562146,.9043414,-1.106145,-.1601642,1.544544,7.388492,-2.9246,-.4328453,.1763161,2.523111,.5851902,-1.203666,-.2776587,-2.084286,2.45084,-.08746613,.5258507,.07983316,3.860055,.5486167,-1.340448,-.423059,.3462849,.4707607,-.2512626,.1530746,.02724218,3.035216,.5876133,-1.014554,-.116879,.9477794,-1.061218,-.419673,2.058832,-.05989624,3.058168,.9763861,-1.137388,-.0985403,-.2984893,3.64782,-.6585571,-1.47918,.6102932,3.265914,.3480333,-1.021816,-.2344957,2.463671,-7.240685,-8.862697,2.514058,-.2122768,-.03313968,.9028136,-1.126581,-.1874347,1.454154,10.34398,-3.237393,-.8654927,.2457248,1.845769,.6002482,-1.263727,-.3439354,-.1786388,.3980166,-.3349517,.3825166,.1029225,3.331096,.4998955,-1.53001,-.6879698,.2380415,1.608216,-1.682679,.354636,-.00391522,.4517655,.5128605,-.9685659,.09480403,.06076844,-3.217561,4.568074,1.069299,.02083638,7.301088,1.072165,-1.113925,-.3112382,.3954133,5.105907,-14.56866,-.4917378,.5289909,-2.678374,.3014709,-1.046864,-.1215754,1.778308,4.661489,.2565583,1.35368,-.1175767,3.415972,.8457746,-1.10448,-.1940913,1.343668,-.001759206,-5.009204,-.4186951,.312571,1.628183,.6720408,-1.286902,-.3781238,-.08977253,.3545393,-.4866515,.3843664,.08281675,3.122231,.5046991,-1.712597,-.8549112,.4809286,1.515398,-2.212211,.2539029,.02335997,-.06089466,.4268444,-.8807283,.1646097,-.4437898,-3.188247,5.984417,1.334779,-.04026975,7.546431,1.175751,-1.147253,-.3538199,.6101836,4.43778,-15.59813,-1.103222,.6242039,-3.091472,.217429,-1.03823,-.1213475,1.547505,5.893176,1.368738,1.663127,-.137713,3.185279,.8736453,-1.101026,-.1874907,1.272667,3.596524,-5.007243,-.6352483,.3048985,1.931613,.6788844,-1.342753,-.4384971,-1.213491,1.621399,-.1551441,.5614218,.02591739,2.958967,.5782132,-1.937684,-1.066019,1.913336,-.7347719,-.5916167,.158759,.1092568,-.6275002,.1599071,-.9302391,.1486187,-1.603835,.1783713,1.100461,1.174181,-.1602361,7.868331,1.468971,-1.053631,-.372705,1.114117,-.9603286,-10.62469,-1.16214,.7952797,-4.478765,-.04440862,-1.083629,-.1261405,1.229344,11.27825,.131901,1.624729,-.2825898,3.661082,1.036911,-1.09395,-.2067455,1.258035,7.548645,-4.598387,-.8944932,.3292634,1.311304,.6291871,-1.385867,-.5068139,-1.48649,1.969049,-.1698025,.6629167,-5289365e-12,2.760315,.8644368,-2.107367,-1.175639,2.313241,-1.001653,-.4843139,.1124485,3901494e-11,-.3502469,-.320478,-1.475244,-.2833055,-2.085824,1.192563,-.76452,.8380081,.220358,7.157885,1.753702,-.6644372,-.2549735,1.600273,-8.589034,-6.144718,-.7599731,.289837,-5.770923,-.09656242,-1.211687,-.1653494,.83934,27.92988,-3.395461,.9933752,-.03976877,3.776659,.9546526,-1.063757,-.2037563,1.117207,-.001252806,-3.33233,-.6971409,.3388719,1.311398,.6635171,-1.678889,-.7992295,-2.421687,2.871029,-.07662842,.6046208,-7598099e-12,2.002314,.9001307,-1.692144,-.880425,3.060895,-2.000009,-.3183563,.08385862,-.006326713,1.206639,-.3369967,-3.676795,-1.719207,-2.534697,1.005285,.1550407,1.07291,.1318094,3.717018,1.689191,.5424542,.3263528,1.551055,-3.841058,-6.598996,-1.201779,.3530669,-2.542945,-.06482523,-1.553849,-.457686,.9324676,19.50982,-2.344516,1.12102,-.1221537,.7285496,.9582816,-1.02065,-.2215797,1.009774,-.002056855,-2.740338,-.8122355,.3328967,.8982766,.6594676,-2.24736,-1.221267,-3.072346,3.385139,-.04387559,.5084887,-7418833e-12,1.750107,.9001401,-1.248499,-.8442718,3.062611,-2.020314,-.2815341,.05254745,.003345008,1.433225,-.2835911,-7.004119,-2.927978,-2.649852,.7971894,.5466893,1.442667,-.06063912,2.806194,1.547429,1.434882,.09114639,1.170089,.03512808,-5.861915,-1.411843,.5400486,-.7746522,.02386984,-1.559053,-.5502302,1.200396,13.47741,-2.344397,.8868907,-.3292661,-1.362105,.9217826,-1.044436,-.2360719,.7054471,-.002904518,-2.092829,-.5119668,.4174861,.9687435,.6588427],M.datasetRGBRad2=[1.59033,1.355401,1.151412,13.59116,5.857714,8.090833,1.55254,1.51004,.1276413,16.04643,5.912162,8.350009,1.470871,1.880464,-1.865398,20.30808,5.471461,9.109834,1.356563,2.373866,-4.653245,25.70922,5.686009,10.0948,1.244232,2.851519,-7.130942,29.93449,6.38212,11.14578,1.173693,3.120604,-8.491886,31.87393,7.290615,11.80066,1.091845,3.368888,-9.722083,32.68508,10.32424,12.36508,.9858985,3.500541,-10.26328,30.92956,16.10881,13.31222,.8864993,3.172888,-8.68755,23.62161,26.21851,14.74967,.7946973,2.189355,-4.207953,9.399091,40.62849,16.81753,1.711696,1.657311,.9328021,13.1788,15.06751,18.63556,1.666968,1.849993,-.2088601,15.86653,14.8688,19.40719,1.584846,2.170022,-2.019597,19.70826,14.90684,20.45055,1.469412,2.524017,-4.197267,23.65249,16.64588,21.34477,1.369714,2.843548,-6.059031,26.34993,18.81361,22.32186,1.310477,2.984444,-6.831686,26.8234,21.23267,22.59755,1.222552,3.176523,-7.731496,26.7176,24.84358,23.36863,1.115781,3.130635,-7.581744,23.36531,31.71048,24.13859,1.013181,2.699342,-5.602709,15.00158,42.17613,25.15957,.8976323,1.726948,-1.29612,1.183675,55.03215,26.43066],M.datasetRGB3=[-1.372629,-.4905585,-41.00789,41.22169,-.00738936,.4839359,.006474757,3.471755,.5092936,-1.523025,-.6497084,6.249857,-5.662543,-.01908402,.551281,-2181049e-11,2.507663,.4339598,-1.035567,-.0747874,.922103,-2.140047,-.02374146,.3795517,-.01769134,7.479831,.7729303,-1.271086,-.558819,.6908023,2.096832,-.2453967,1.410648,.04475036,-4.719115,.5741186,-.9712598,-.07033926,.9167274,-.9502097,.3004684,.4547054,-.05929017,5.266196,.7204135,-1.087457,-.1888896,.8156686,.3101712,-2.155419,1.422205,.09692261,3.122404,.499943,-1.42528,-.5413508,-34.54883,34.81142,-.008686975,.4914268,-2479243e-12,3.239879,.6094201,-1.688557,-.8070865,7.018459,-6.244574,-.02149341,.3993971,.01252502,1.630662,.109786,-.8664152,.07869125,-.5236535,-1.21896,-.02059093,.6684898,-.05584112,8.602299,1.410496,-1.319763,-.5985323,1.253918,1.914706,-.3216739,.9011213,.1324845,-5.252749,.06231252,-.9706008,-.05914059,.569315,-1.175362,.5221644,.7518213,-.08247655,5.875635,.9850863,-1.08533,-.1956105,.8019605,.5338101,-3.423464,1.110444,.1507923,2.864942,.4999481,-1.431967,-.5478935,-32.86288,33.05288,-.008380797,.477205,-3044274e-12,3.289973,.5976303,-1.801361,-.9315889,5.391756,-4.588592,-.02040076,.4144684,.01814534,1.051795,.1145651,-.7905357,.1451332,-.1605661,-1.592174,.0004561348,.3380323,-.07770275,8.775384,1.489512,-1.308575,-.5539232,.9184133,2.011479,-.3842472,1.432274,.1637153,-4.408856,.05272957,-.9829872,-.08183048,.4464556,-1.442716,1.029641,-.06991617,.008702356,5.706417,.9116452,-1.08713,-.2038013,.7260801,.9164376,-5.006183,1.511271,.1257134,2.715439,.6201652,-1.448662,-.5799075,-28.33268,28.58023,-.009134061,.4404783,-2709026e-12,3.029357,.5540071,-2.061772,-1.14519,7.918478,-7.212525,-.0202076,.2962715,.0468967,.8517209,.2334587,-.6413755,.1780425,-2.412919,1.064484,-.01949986,.6769741,-.175276,7.262714,1.325869,-1.304871,-.3975581,1.219002,.7285178,-.2710105,.7779727,.3247139,-.8818168,.1839517,-1.001104,-.1994801,.3676742,-1.409737,.2901555,.250694,.002468899,3.398923,.8584645,-1.111552,-.2487204,.7410842,1.703749,-5.007855,1.057763,.1354511,2.088715,.6600013,-1.547227,-.6679466,-18.61465,18.84045,-.0124221,.4157339,-2432805e-12,2.812423,.5446957,-2.04389,-1.149081,2.304118,-1.715757,-.02433628,.2816836,.07185458,1.06486,.2706789,-.904072,-.08274472,-.2555676,-.6326215,-.0277088,.6676024,-.2513532,5.903839,1.241452,-1.000013,-.1010774,.3699166,.8774526,-.3042007,.6951053,.4361813,.6793421,.2573892,-1.171332,-.3768188,.3701377,-1.470757,.5525942,.02991456,.01581823,2.365233,.8214514,-1.068667,-.232633,.6725059,2.243733,-4.61437,1.033677,.1376291,2.013334,.6865304,-1.592991,-.7246948,-25.98204,26.2196,-.008365176,.4207571,-2742772e-12,2.623735,.587319,-2.271349,-1.280884,6.308739,-5.75835,-.01977049,.3671835,.06698038,1.150597,.1759218,-.636862,-.007436052,-2.230026,1.640997,-.01548497,.3145331,-.2492644,5.083843,1.260215,-1.177925,-.09628114,.3051152,-.03749544,-.2713209,1.164226,.4559969,2.175429,.2874284,-1.0785,-.3801779,.4788906,-.4795969,.5977621,-.4488535,.03386874,1.538143,.8062054,-1.108028,-.2596892,.5162202,1.557081,-4.265039,1.182535,.1563762,2.095084,.6883383,-1.668427,-.7908511,-27.7969,27.99746,-.007186935,.3757766,-3326858e-12,2.563421,.5439687,-2.156175,-1.220004,3.585732,-3.235988,-.01086239,.1846143,.1046017,1.234427,.2842191,-1.117051,-.4101627,-.846373,.7671472,-.02226609,.8574943,-.3434124,4.475715,1.154824,-.744484,.2312078,-.5393724,.1574213,-.1763914,.2751692,.55642,2.217672,.3483932,-1.273036,-.5275562,.4902512,-.04498436,.4339366,.2386682,.02380879,1.413444,.7855923,-1.084192,-.2936753,.4719432,1.384436,-3.257789,.6119543,.1681884,1.650441,.6936631,-1.84849,-.951267,-30.05251,30.24315,-.005635304,.344778,-2782999e-12,2.309422,.5643559,-2.300008,-1.252335,-1.218876,1.49373,-.0061071,.0797486,.1023449,1.505934,.2360948,-1.483705,-.8547575,-.7797146,.6447971,-.02678052,1.091263,-.3344889,3.830416,1.189425,-.5348005,.3982733,-.4071573,.3265569,-.08658789,-.2370892,.5369097,1.478279,.3143303,-1.320401,-.6043247,.3019196,-.07732911,.4768381,.6745764,.03694098,1.158234,.8169056,-1.10104,-.3420019,.3775661,1.769338,-2.990515,.1649529,.1970125,1.453355,.6759757,-2.251946,-1.229349,-32.71808,32.83114,-.004252027,.3372289,-3001937e-12,2.154046,.5842674,-1.867834,-.9531252,-12.29365,12.69149,-.006844772,.1185107,.07539587,1.846381,.1899412,-3.398629,-2.180862,2.335213,-3.382823,-.008613985,.8431602,-.2393567,3.11246,1.218556,.5708381,.940603,-.6890113,2.746233,-.05772068,.1096005,.3491978,.7281453,.3212049,-1.705909,-.8517224,.113116,-2.141434,.4274043,.33976,.178649,.9026101,.78828,-1.012865,-.3495551,.3369038,3.724205,-3.089586,.1266964,.146179,1.170199,.6931052,-2.890318,-1.665573,-34.93756,35.00369,-.002984251,.2622419,-425936e-11,1.947681,.6905752,-1.956022,-1.0629,-19.19714,19.75164,-.008865396,.216554,.05475637,1.761134,.003164249,-5.612198,-3.101371,4.098034,-6.144001,.009944958,.2905472,-.170711,3.199107,1.33766,.8353756,.4855943,-1.243589,5.147385,-.07013963,.938041,.2335714,.1727744,.2802696,-1.524329,-.7388547,.3259025,-4.050634,.4058549,-.2591384,.1898299,.3556071,.7884126,-1.070371,-.4207858,.1739862,5.29341,-3.136757,.2323856,.1673706,1.007227,.6844287,-1.34172,-.4834889,-46.33447,46.82148,-.006137296,.4599216,.007047323,2.895798,.4999398,-1.529104,-.6498631,15.34103,-14.50675,-.01531439,.3280082,.01682926,1.901587,.5013227,-1.014776,-.1454495,-4.071085,2.954982,-.02630348,.5681531,-.03016505,6.773854,.5003504,-1.172413,-.402632,2.960428,.202071,-.2004947,.9375572,.05998168,-4.945934,.4502898,-.9898161,-.05772814,.4470024,-.5786656,.1158168,.346804,-.0504336,6.867947,.8012363,-1.085111,-.1882675,1.223748,.3565495,-3.688357,.5653723,.06727646,2.69013,.49994,-1.389119,-.529025,-40.55774,41.05972,-.007062577,.456006,-1736334e-12,2.775512,.6671455,-1.584641,-.7200619,12.48067,-11.56028,-.01659568,.3050029,.01099895,1.438927,-.02138015,-.9826068,-.08887254,-2.960031,1.808816,-.02478159,.6035733,-.04868441,7.347705,1.584739,-1.150423,-.4073793,2.412991,.487084,-.2337902,.8295114,.1129914,-5.150045,-.09016643,-1.016933,-.06311501,.5218937,-.571643,.1250993,.3601524,-.05497586,7.060139,1.018333,-1.073151,-.1845444,1.155394,.3004486,-3.431711,.4657031,.09401223,2.68862,.4999544,-1.391257,-.5365815,-42.55881,42.99132,-.005838466,.4229134,-2760038e-12,2.775531,.6234597,-1.780062,-.922888,13.76172,-12.60946,-.01507526,.3117435,.02205045,.6093731,.03463446,-.7388169,.127567,-3.999528,2.223993,-.01856853,.543931,-.08834054,8.037139,1.645951,-1.322387,-.5320143,2.659359,1.086712,-.2129712,.8704649,.1800315,-4.967241,-.138372,-.9378288,-.01599895,.3607555,-1.980561,.3791456,.1212268,-.02845992,6.825542,1.059139,-1.100832,-.2172313,1.211561,2.002721,-5.010011,.5717583,.06777702,2.160006,.5676392,-1.409373,-.5708751,-30.34974,30.79809,-.007280715,.3723304,-2436279e-12,2.577348,.5913377,-1.954312,-1.11651,5.399148,-4.299553,-.01724739,.3742824,.04187077,.1044883,.1232727,-.6772215,.2001396,-.3670523,-1.014628,-.003497152,.4099858,-.1584633,7.7504,1.514559,-1.2916,-.4977437,.9641914,1.56242,-.3227782,.9055427,.3046444,-3.385619,.009546291,-.9750857,-.0877056,.9054256,-1.429236,.8974777,-.1217961,-.05194608,4.909409,.9589153,-1.088007,-.1959301,.9745799,1.260761,-5.008864,.7271248,.1096661,2.717295,.6340731,-1.45605,-.6223072,-22.28088,22.69604,-.009340812,.4118308,-2418083e-12,2.442117,.5589638,-2.176449,-1.302416,2.222836,-1.22273,-.01728051,.1323513,.07027731,.04835745,.2093351,-.5789641,.2215407,.2142291,-1.201725,-.01185728,.8122982,-.238042,6.706841,1.404146,-1.307463,-.4515174,.6447827,1.223841,-.2902391,.4986588,.4073652,-1.706696,.1060885,-.9698678,-.1307094,.9389347,-1.522852,.7768797,-.1368595,-.03857426,3.676935,.8980966,-1.104349,-.2380323,1.047043,1.865421,-5.011664,.7014954,.09622701,1.89136,.6687354,-1.502249,-.6724523,-28.88092,29.3036,-.006685766,.3685464,-2469442e-12,2.310797,.5566754,-2.217125,-1.364924,4.048243,-3.111333,-.01317747,.1921948,.08627702,.001981769,.2213689,-.6215757,.1687995,-.5949131,-.1551293,.0003356129,.6897657,-.2855053,6.271042,1.363084,-1.216317,-.3489429,.7566226,.5409809,-.2830843,.6191825,.4755163,-.9131387,.1383909,-1.030437,-.2034064,.8335995,-1.050947,.8689093,-.367231,-.04056183,3.111269,.8856842,-1.078984,-.2070549,.9683145,1.497022,-5.007653,.7702541,.1285822,2.225188,.6587911,-1.559291,-.7374039,-35.96311,36.3447,-.004667132,.3277964,-2487945e-12,2.215652,.5764681,-2.356929,-1.444755,6.244526,-5.540162,-.00879451,.17921,.09578517,.3737676,.1922194,-.6589752,-.0292691,-1.831779,1.869962,-.002030095,.7552089,-.3168157,4.632196,1.294054,-1.161046,-.1472506,.6494138,-.8327174,-.2320724,.3391212,.5269637,.9376341,.2458573,-1.034427,-.3062504,.8975634,.3203531,.8565142,-.1250162,-.04094017,1.861304,.8223468,-1.109954,-.2740277,1.063811,.7077398,-4.695734,.5621696,.1248956,1.297723,.678972,-1.788293,-.9368751,-43.8298,44.24963,-.00365253,.3094331,-2810503e-12,1.904402,.5861599,-2.268206,-1.312676,2.863082,-2.373727,-.00514498,.1711072,.09316041,.9309598,.1791683,-1.376966,-.7418582,-1.349589,1.563419,-.003124219,.6967139,-.3061887,3.602731,1.255669,-.601754,.2815928,.5424052,-.688545,-.1620001,.2980046,.4995571,.7371203,.2812466,-1.278853,-.5245326,.787052,.3125067,.7748105,-.07788581,.003490956,1.283748,.813019,-1.05093,-.2786331,1.056344,1.053002,-4.047789,.4432174,.1169077,.9532621,.6806764,-2.084927,-1.203954,-48.81638,49.2016,-.002896045,.2882977,-3073517e-12,1.702211,.637418,-2.328567,-1.238023,-1.891019,2.45152,-.005847581,.2084702,.0784813,1.211048,.08095008,-2.634632,-1.78946,-.1370558,-.3326435,.002783737,.5239451,-.2548881,2.896327,1.324116,.06882616,.5997821,.1535398,1.375209,-.1267285,.4239743,.4013122,.1794675,.2395382,-1.430918,-.6439041,.832598,-1.705612,.7236426,-.05567593,.06408718,.6836524,.8388887,-1.037956,-.3215402,.9457349,3.178114,-4.152156,.2230992,.1156198,.7606223,.6656923,-2.967314,-1.728778,-37.30988,37.55578,-.002588835,.2927966,-3935038e-12,1.592161,.6868694,-2.123311,-1.175148,-13.14988,13.86882,-.007828537,.1852026,.05481038,1.294309,.02428177,-5.443597,-3.156344,2.110838,-3.421556,.0118189,.1196951,-.1742902,2.404353,1.272805,1.029898,.5912521,-.3983531,3.286069,-.09252065,1.331381,.2560642,.8001754,.3624178,-1.547574,-.7881604,1.020902,-2.897069,.521347,-.9242315,.1185594,-1.150721,.7317211,-.9621043,-.1991406,.6531287,3.925839,-3.596904,.6317332,.1531334,1.457846,.6966285],M.datasetRGBRad3=[.9926518,1.999494,-4.136109,18.5627,13.51028,13.90238,.9634366,2.119694,-4.614523,19.19701,13.76644,14.18731,.9446537,2.17161,-4.915556,19.1824,15.37135,14.0053,.9073074,2.330536,-5.577596,19.61615,16.88365,14.46955,.8739124,2.388682,-5.842995,19.23265,18.87735,14.85698,.8563688,2.391534,-5.769133,18.28709,20.97209,14.69587,.8270533,2.34279,-5.558071,16.84993,23.56498,15.05975,.7908339,2.190341,-4.852571,13.74862,28.06846,15.48444,.7403619,1.783998,-2.983854,7.622563,35.0761,16.15805,.6840111,1.154457,-.239383,-.7896893,42.82765,17.79469,1.1683,1.860993,-2.129074,12.51952,30.32499,29.38716,1.150338,1.918813,-2.413527,12.74862,30.87134,29.51432,1.114719,1.964689,-2.625423,12.47837,32.37949,29.43596,1.077948,2.006292,-2.846934,11.90195,34.59293,29.37492,1.035143,1.986681,-2.752584,10.60972,37.22185,29.18594,1.015992,1.992054,-2.812626,10.01416,38.473,29.24624,.9756887,1.939897,-2.533281,8.319176,40.83907,29.25586,.9264164,1.716454,-1.597044,4.739725,45.07683,28.78915,.8595191,1.346034,-.02801895,-.6582906,50.17523,28.52953,.7754116,.7709245,2.200201,-7.487661,54.36622,28.93432],M.datasetsRGB=[M.datasetRGB1,M.datasetRGB2,M.datasetRGB3],M.datasetsRGBRad=[M.datasetRGBRad1,M.datasetRGBRad2,M.datasetRGBRad3],x.drawMeshes=w.drawMeshes,Ot.timeStep=.016666666666666666,Ot.fixedStep=.016666666666666666,k.numCreations=0,Et.numCreations=0,be.nextId=0,be.v1=new Et,be.v2=new Et,be.q1=new k,Ut.DEFAULT_RESOLVER=new N,Ut.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",R.i64tmp=new Y(0,0),R.helper=new cs(new us(8)),P.traitInits=[],P.traitUpdates=[],P.traitLateUpdates=[],P.traitRenders=[],P.traitRenders2D=[],P.pauseUpdates=!1,P.lastw=-1,P.lasth=-1,h_.uidCounter=0,h_.framePassed=!0,at.cachedSceneRaws=new et,at.cachedMeshes=new et,at.cachedLights=new et,at.cachedCameras=new et,at.cachedMaterials=new et,at.cachedWorlds=new et,at.cachedShaders=new et,at.cachedBlobs=new et,at.cachedImages=new et,at.cachedSounds=new et,at.dataPath="",at.loadingMeshes=new et,at.loadingLights=new et,at.loadingCameras=new et,at.loadingMaterials=new et,at.loadingWorlds=new et,at.loadingShaders=new et,at.loadingSceneRaws=new et,at.assetsLoaded=0,at.loadingBlobs=new et,at.loadingImages=new et,at.loadingSounds=new et,ht.uidCounter=0,ft.num=0,Pe.m1=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),Pe.m2=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),Pe.vpos=new lo,Pe.vpos2=new lo,Pe.vscl=new lo,Pe.vscl2=new lo,Pe.q1=new A,Pe.q2=new A,Pe.q3=new A,Pe.vp=new lo,Pe.vs=new lo,f_.skinMaxBones=50,f_.m=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),f_.m1=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),f_.m2=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),f_.vpos=new lo,f_.vscl=new lo,f_.q1=new A,f_.q2=new A,f_.q3=new A,f_.vpos2=new lo,f_.vscl2=new lo,f_.v1=new lo,f_.v2=new lo,mt.uidCounter=0,mt.seed=1,vt.temp=new lo,vt.sphereCenter=new lo,sa.cascadeBounds=1,sa.m=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),sa.p1=new lo,sa.p2=new lo,sa.p3=new lo,je.temp=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),je.q=new A,c_.biasMat=new da(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),c_.helpMat=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),c_.helpMat2=new da(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),c_.helpMat3=new pt(1,0,0,0,1,0,0,0,1),c_.helpVec=new lo,c_.helpVec2=new lo,c_.helpQuat=new A,zt.occupied=!1,zt.gamepads=[],zt.registered=!1,St.buttons=["left","right","middle"],Yt.keys=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9",".",",","space","backspace","tab","enter","shift","control","alt","escape","delete","back","up","right","left","down"],Gt.buttonsPS=["cross","circle","square","triangle","l1","r1","l2","r2","share","options","l3","r3","up","down","left","right","home","touchpad"],Gt.buttons=Gt.buttonsPS,fo.scale=1,fo.last=0,fo.realDelta=0,Wt.eases=[Wt.easeLinear,Wt.easeSineIn,Wt.easeSineOut,Wt.easeSineInOut,Wt.easeQuadIn,Wt.easeQuadOut,Wt.easeQuadInOut,Wt.easeCubicIn,Wt.easeCubicOut,Wt.easeCubicInOut,Wt.easeQuartIn,Wt.easeQuartOut,Wt.easeQuartInOut,Wt.easeQuintIn,Wt.easeQuintOut,Wt.easeQuintInOut,Wt.easeExpoIn,Wt.easeExpoOut,Wt.easeExpoInOut,Wt.easeCircIn,Wt.easeCircOut,Wt.easeCircInOut,Wt.easeBackIn,Wt.easeBackOut,Wt.easeBackInOut],Wt.anims=[],Wt.registered=!1,d_.__toStr={}.toString,Vt.BYTES_PER_ELEMENT=4,Kt.BYTES_PER_ELEMENT=1,qt.images=new jt,qt.sounds=new Rt,qt.blobs=new Ht,qt.fonts=new Pt,qt.videos=new Qt,ne.canvas_id="khanvas",se.instance=new se,uo.DIF_COUNT=3,uo.maxframetime=.5,uo.startTime=0,de.Blue_shadowmap_fragData0="s103:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdm9pZCBtYWluKCkKewp9Cgo",de.Blue_shadowmap_fragData1="s106:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2b2lkIG1haW4oKQp7Cn0KCg",de.Blue_shadowmap_fragData2="s107:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdm9pZCBtYWluKCkKewp9Cgo",de.Blue_mesh_vertData0="s592:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CnVuaWZvcm0gbWF0NCBMV1ZQOwoKYXR0cmlidXRlIHZlYzMgcG9zOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleDsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKdmFyeWluZyB2ZWMzIHdub3JtYWw7CmF0dHJpYnV0ZSB2ZWMzIG5vcjsKdmFyeWluZyB2ZWM0IGxpZ2h0UG9zaXRpb247Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIHRleENvb3JkID0gdGV4OwogICAgd3Bvc2l0aW9uID0gdmVjNChXICogc3BvcykueHl6OwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKICAgIGxpZ2h0UG9zaXRpb24gPSBMV1ZQICogc3BvczsKfQoK",de.Blue_mesh_vertData1="s720:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXOwp1bmlmb3JtIG1lZGl1bXAgbWF0MyBOOwp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXVlA7CnVuaWZvcm0gbWVkaXVtcCBtYXQ0IExXVlA7CgphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIHBvczsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4Owp2YXJ5aW5nIG1lZGl1bXAgdmVjMyB3cG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWMzIHdub3JtYWw7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzMgbm9yOwp2YXJ5aW5nIG1lZGl1bXAgdmVjNCBsaWdodFBvc2l0aW9uOwoKdm9pZCBtYWluKCkKewogICAgbWVkaXVtcCB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIHRleENvb3JkID0gdGV4OwogICAgd3Bvc2l0aW9uID0gdmVjNChXICogc3BvcykueHl6OwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKICAgIGxpZ2h0UG9zaXRpb24gPSBMV1ZQICogc3BvczsKfQoK",de.Blue_mesh_vertData2="s547:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CnVuaWZvcm0gbWF0NCBMV1ZQOwoKaW4gdmVjMyBwb3M7Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleDsKb3V0IHZlYzMgd3Bvc2l0aW9uOwpvdXQgdmVjMyB3bm9ybWFsOwppbiB2ZWMzIG5vcjsKb3V0IHZlYzQgbGlnaHRQb3NpdGlvbjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXg7CiAgICB3cG9zaXRpb24gPSB2ZWM0KFcgKiBzcG9zKS54eXo7CiAgICB3bm9ybWFsID0gbm9ybWFsaXplKE4gKiBub3IpOwogICAgZ2xfUG9zaXRpb24gPSBXVlAgKiBzcG9zOwogICAgbGlnaHRQb3NpdGlvbiA9IExXVlAgKiBzcG9zOwp9Cgo",de.Blue_mesh_fragData0="s4380:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyBoaWdocCB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgaGlnaHAgdmVjMyB3cG9zaXRpb247CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmUsIHRleENvb3JkKTsKICAgIGhpZ2hwIHZlYzMgSW1hZ2VUZXh0dXJlX0NvbG9yX3JlcyA9IEltYWdlVGV4dHVyZV9zdG9yZS54eXo7CiAgICBoaWdocCB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuMDE5NjkzMDA1ODMwMDQ5NTE0NzcwNTA3ODEyNSwgMC4yODkzMzcyMTc4MDc3Njk3NzUzOTA2MjUsIDAuNzc0MjM3ODcxMTcwMDQzOTQ1MzEyNSk7CiAgICBoaWdocCBmbG9hdCByb3VnaG5lc3MgPSBJbWFnZVRleHR1cmVfQ29sb3JfcmVzLng7CiAgICBoaWdocCBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHNwZWN1bGFyID0gMS4wOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIGhpZ2hwIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.Blue_mesh_fragData1="s4108:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgSW1hZ2VUZXh0dXJlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZlYzMgc2hJcnJhZGlhbmNlKHZlYzMgbm9yKQp7CiAgICB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmUsIHRleENvb3JkKTsKICAgIHZlYzMgSW1hZ2VUZXh0dXJlX0NvbG9yX3JlcyA9IEltYWdlVGV4dHVyZV9zdG9yZS54eXo7CiAgICB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuMDE5NjkzMDA1ODMwMDQ5NTE0NzcwNTA3ODEyNSwgMC4yODkzMzcyMTc4MDc3Njk3NzUzOTA2MjUsIDAuNzc0MjM3ODcxMTcwMDQzOTQ1MzEyNSk7CiAgICBmbG9hdCByb3VnaG5lc3MgPSBJbWFnZVRleHR1cmVfQ29sb3JfcmVzLng7CiAgICBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGZsb2F0IHNwZWN1bGFyID0gMS4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.Blue_mesh_fragData2="s4370:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMyIHRleENvb3JkOwppbiBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CmluIGhpZ2hwIHZlYzMgd3Bvc2l0aW9uOwpvdXQgaGlnaHAgdmVjNCBmcmFnQ29sb3I7CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUoSW1hZ2VUZXh0dXJlLCB0ZXhDb29yZCk7CiAgICBoaWdocCB2ZWMzIEltYWdlVGV4dHVyZV9Db2xvcl9yZXMgPSBJbWFnZVRleHR1cmVfc3RvcmUueHl6OwogICAgaGlnaHAgdmVjMyBiYXNlY29sID0gdmVjMygwLjAxOTY5MzAwNTgzMDA0OTUxNDc3MDUwNzgxMjUsIDAuMjg5MzM3MjE3ODA3NzY5Nzc1MzkwNjI1LCAwLjc3NDIzNzg3MTE3MDA0Mzk0NTMxMjUpOwogICAgaGlnaHAgZmxvYXQgcm91Z2huZXNzID0gSW1hZ2VUZXh0dXJlX0NvbG9yX3Jlcy54OwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaWYgKGxpZ2h0UG9zaXRpb24udyA%IDAuMCkKICAgIHsKICAgICAgICBoaWdocCB2ZWMzIGxQb3MgPSBsaWdodFBvc2l0aW9uLnh5eiAvIHZlYzMobGlnaHRQb3NpdGlvbi53KTsKICAgICAgICB2aXNpYmlsaXR5ID0gMC4wOwogICAgICAgIHZpc2liaWxpdHkgKz0gZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5KS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKC0wLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAwLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBmcmFnQ29sb3IgPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIHNoSXJyYWRpYW5jZShuKSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7Cn0KCg",de.Blue_shadowmap_vertData0="s180:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgTFdWUDsKCmF0dHJpYnV0ZSB2ZWMzIHBvczsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgZ2xfUG9zaXRpb24gPSBMV1ZQICogc3BvczsKfQoK",de.Blue_shadowmap_vertData1="s212:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBMV1ZQOwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyBwb3M7Cgp2b2lkIG1haW4oKQp7CiAgICBtZWRpdW1wIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgZ2xfUG9zaXRpb24gPSBMV1ZQICogc3BvczsKfQoK",de.Blue_shadowmap_vertData2="s175:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgTFdWUDsKCmluIHZlYzMgcG9zOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCBzcG9zID0gdmVjNChwb3MsIDEuMCk7CiAgICBnbF9Qb3NpdGlvbiA9IExXVlAgKiBzcG9zOwp9Cgo",de.Material_001_mesh_vertData0="s508:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CnVuaWZvcm0gbWF0NCBMV1ZQOwoKYXR0cmlidXRlIHZlYzMgcG9zOwp2YXJ5aW5nIHZlYzMgd3Bvc2l0aW9uOwp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKYXR0cmlidXRlIHZlYzMgbm9yOwp2YXJ5aW5nIHZlYzQgbGlnaHRQb3NpdGlvbjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgd3Bvc2l0aW9uID0gdmVjNChXICogc3BvcykueHl6OwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKICAgIGxpZ2h0UG9zaXRpb24gPSBMV1ZQICogc3BvczsKfQoK",de.Material_001_mesh_vertData1="s615:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXOwp1bmlmb3JtIG1lZGl1bXAgbWF0MyBOOwp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXVlA7CnVuaWZvcm0gbWVkaXVtcCBtYXQ0IExXVlA7CgphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIHBvczsKdmFyeWluZyBtZWRpdW1wIHZlYzMgd3Bvc2l0aW9uOwp2YXJ5aW5nIG1lZGl1bXAgdmVjMyB3bm9ybWFsOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIG5vcjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgbGlnaHRQb3NpdGlvbjsKCnZvaWQgbWFpbigpCnsKICAgIG1lZGl1bXAgdmVjNCBzcG9zID0gdmVjNChwb3MsIDEuMCk7CiAgICB3cG9zaXRpb24gPSB2ZWM0KFcgKiBzcG9zKS54eXo7CiAgICB3bm9ybWFsID0gbm9ybWFsaXplKE4gKiBub3IpOwogICAgZ2xfUG9zaXRpb24gPSBXVlAgKiBzcG9zOwogICAgbGlnaHRQb3NpdGlvbiA9IExXVlAgKiBzcG9zOwp9Cgo",de.Material_001_mesh_vertData2="s478:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CnVuaWZvcm0gbWF0NCBMV1ZQOwoKaW4gdmVjMyBwb3M7Cm91dCB2ZWMzIHdwb3NpdGlvbjsKb3V0IHZlYzMgd25vcm1hbDsKaW4gdmVjMyBub3I7Cm91dCB2ZWM0IGxpZ2h0UG9zaXRpb247Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIHdwb3NpdGlvbiA9IHZlYzQoVyAqIHNwb3MpLnh5ejsKICAgIHdub3JtYWwgPSBub3JtYWxpemUoTiAqIG5vcik7CiAgICBnbF9Qb3NpdGlvbiA9IFdWUCAqIHNwb3M7CiAgICBsaWdodFBvc2l0aW9uID0gTFdWUCAqIHNwb3M7Cn0KCg",de.Material_001_mesh_fragData0="s4007:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcDsKdW5pZm9ybSBoaWdocCBmbG9hdCBzaGFkb3dzQmlhczsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodFBvczsKdW5pZm9ybSBoaWdocCBmbG9hdCBlbnZtYXBTdHJlbmd0aDsKCnZhcnlpbmcgaGlnaHAgdmVjMyB3bm9ybWFsOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgbGlnaHRQb3NpdGlvbjsKdmFyeWluZyBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKCmhpZ2hwIGZsb2F0IGF0dGVudWF0ZShoaWdocCBmbG9hdCBkaXN0KQp7CiAgICByZXR1cm4gMS4wIC8gKGRpc3QgKiBkaXN0KTsKfQoKaGlnaHAgdmVjMyBzaElycmFkaWFuY2UoaGlnaHAgdmVjMyBub3IpCnsKICAgIGhpZ2hwIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICBoaWdocCB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIGhpZ2hwIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgaGlnaHAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICBoaWdocCB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIGhpZ2hwIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgaGlnaHAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoKC1ub3IueikgKiAoLW5vci56KSkpKSArICgoKGNsMjAgKiAwLjc0MzEyNTAyMTQ1NzY3MjExOTE0MDYyNSkgKiBub3IueCkgKiBub3IueCkpICsgKGNsMDAgKiAwLjg4NjIyNzAxMTY4MDYwMzAyNzM0Mzc1KSkgLSAoY2wyMCAqIDAuMjQ3NzA3OTkyNzkyMTI5NTE2NjAxNTYyNSkpICsgKCgoY2wybTIgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqICgtbm9yLnopKSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqICgtbm9yLnopKSAqIG5vci54KSkgKyAoKGNsMTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci55KSkgKyAoKGNsMW0xICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiAoLW5vci56KSkpICsgKChjbDEwICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueCk7Cn0KCnZvaWQgbWFpbigpCnsKICAgIGhpZ2hwIHZlYzMgbiA9IG5vcm1hbGl6ZSh3bm9ybWFsKTsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC4xOTAxNzIxNjU2MzIyNDc5MjQ4MDQ2ODc1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgc3BlY3VsYXIgPSAwLjA7CiAgICBoaWdocCBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgaGlnaHAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGlmIChsaWdodFBvc2l0aW9uLncgPiAwLjApCiAgICB7CiAgICAgICAgaGlnaHAgdmVjMyBsUG9zID0gbGlnaHRQb3NpdGlvbi54eXogLyB2ZWMzKGxpZ2h0UG9zaXRpb24udyk7CiAgICAgICAgdmlzaWJpbGl0eSA9IDAuMDsKICAgICAgICB2aXNpYmlsaXR5ICs9IGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5KS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigtMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAwLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIC0wLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5IC89IDIuNTsKICAgICAgICB2aXNpYmlsaXR5ID0gbWF4KHZpc2liaWxpdHksIDAuMjAwMDAwMDAyOTgwMjMyMjM4NzY5NTMxMjUpOwogICAgfQogICAgaGlnaHAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiBzaElycmFkaWFuY2UobikpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwp9Cgo",de.Material_001_mesh_fragData1="s3756:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gdmVjMyBsaWdodERpcjsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gdmVjMyBsaWdodENvbG9yOwp1bmlmb3JtIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZlYzMgc2hJcnJhZGlhbmNlKHZlYzMgbm9yKQp7CiAgICB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuMTkwMTcyMTY1NjMyMjQ3OTI0ODA0Njg3NSk7CiAgICBmbG9hdCByb3VnaG5lc3MgPSAwLjA7CiAgICBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGZsb2F0IHNwZWN1bGFyID0gMC4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.Material_001_mesh_fragData2="s4006:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcDsKdW5pZm9ybSBoaWdocCBmbG9hdCBzaGFkb3dzQmlhczsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodFBvczsKdW5pZm9ybSBoaWdocCBmbG9hdCBlbnZtYXBTdHJlbmd0aDsKCmluIGhpZ2hwIHZlYzMgd25vcm1hbDsKaW4gaGlnaHAgdmVjNCBsaWdodFBvc2l0aW9uOwppbiBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKb3V0IGhpZ2hwIHZlYzQgZnJhZ0NvbG9yOwoKaGlnaHAgZmxvYXQgYXR0ZW51YXRlKGhpZ2hwIGZsb2F0IGRpc3QpCnsKICAgIHJldHVybiAxLjAgLyAoZGlzdCAqIGRpc3QpOwp9CgpoaWdocCB2ZWMzIHNoSXJyYWRpYW5jZShoaWdocCB2ZWMzIG5vcikKewogICAgaGlnaHAgdmVjMyBjbDAwID0gdmVjMyhzaGlyclswXS54LCBzaGlyclswXS55LCBzaGlyclswXS56KTsKICAgIGhpZ2hwIHZlYzMgY2wxbTEgPSB2ZWMzKHNoaXJyWzBdLncsIHNoaXJyWzFdLngsIHNoaXJyWzFdLnkpOwogICAgaGlnaHAgdmVjMyBjbDEwID0gdmVjMyhzaGlyclsxXS56LCBzaGlyclsxXS53LCBzaGlyclsyXS54KTsKICAgIGhpZ2hwIHZlYzMgY2wxMSA9IHZlYzMoc2hpcnJbMl0ueSwgc2hpcnJbMl0ueiwgc2hpcnJbMl0udyk7CiAgICBoaWdocCB2ZWMzIGNsMm0yID0gdmVjMyhzaGlyclszXS54LCBzaGlyclszXS55LCBzaGlyclszXS56KTsKICAgIGhpZ2hwIHZlYzMgY2wybTEgPSB2ZWMzKHNoaXJyWzNdLncsIHNoaXJyWzRdLngsIHNoaXJyWzRdLnkpOwogICAgaGlnaHAgdmVjMyBjbDIwID0gdmVjMyhzaGlycls0XS56LCBzaGlycls0XS53LCBzaGlycls1XS54KTsKICAgIGhpZ2hwIHZlYzMgY2wyMSA9IHZlYzMoc2hpcnJbNV0ueSwgc2hpcnJbNV0ueiwgc2hpcnJbNV0udyk7CiAgICBoaWdocCB2ZWMzIGNsMjIgPSB2ZWMzKHNoaXJyWzZdLngsIHNoaXJyWzZdLnksIHNoaXJyWzZdLnopOwogICAgcmV0dXJuICgoKCgoKCgoKChjbDIyICogMC40MjkwNDI5OTQ5NzYwNDM3MDExNzE4NzUpICogKChub3IueSAqIG5vci55KSAtICgoLW5vci56KSAqICgtbm9yLnopKSkpICsgKCgoY2wyMCAqIDAuNzQzMTI1MDIxNDU3NjcyMTE5MTQwNjI1KSAqIG5vci54KSAqIG5vci54KSkgKyAoY2wwMCAqIDAuODg2MjI3MDExNjgwNjAzMDI3MzQzNzUpKSAtIChjbDIwICogMC4yNDc3MDc5OTI3OTIxMjk1MTY2MDE1NjI1KSkgKyAoKChjbDJtMiAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogKC1ub3IueikpKSArICgoKGNsMjEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqIG5vci54KSkgKyAoKChjbDJtMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogKC1ub3IueikpICogbm9yLngpKSArICgoY2wxMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLnkpKSArICgoY2wxbTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqICgtbm9yLnopKSkgKyAoKGNsMTAgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci54KTsKfQoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgaGlnaHAgdmVjMyBiYXNlY29sID0gdmVjMygwLjE5MDE3MjE2NTYzMjI0NzkyNDgwNDY4NzUpOwogICAgaGlnaHAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaWYgKGxpZ2h0UG9zaXRpb24udyA%IDAuMCkKICAgIHsKICAgICAgICBoaWdocCB2ZWMzIGxQb3MgPSBsaWdodFBvc2l0aW9uLnh5eiAvIHZlYzMobGlnaHRQb3NpdGlvbi53KTsKICAgICAgICB2aXNpYmlsaXR5ID0gMC4wOwogICAgICAgIHZpc2liaWxpdHkgKz0gZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5KS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKC0wLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAwLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBmcmFnQ29sb3IgPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIHNoSXJyYWRpYW5jZShuKSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7Cn0KCg",de.Material_003_mesh_fragData0="s4080:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcDsKdW5pZm9ybSBoaWdocCBmbG9hdCBzaGFkb3dzQmlhczsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodFBvczsKdW5pZm9ybSBoaWdocCBmbG9hdCBlbnZtYXBTdHJlbmd0aDsKCnZhcnlpbmcgaGlnaHAgdmVjMyB3bm9ybWFsOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgbGlnaHRQb3NpdGlvbjsKdmFyeWluZyBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKCmhpZ2hwIGZsb2F0IGF0dGVudWF0ZShoaWdocCBmbG9hdCBkaXN0KQp7CiAgICByZXR1cm4gMS4wIC8gKGRpc3QgKiBkaXN0KTsKfQoKaGlnaHAgdmVjMyBzaElycmFkaWFuY2UoaGlnaHAgdmVjMyBub3IpCnsKICAgIGhpZ2hwIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICBoaWdocCB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIGhpZ2hwIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgaGlnaHAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICBoaWdocCB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIGhpZ2hwIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgaGlnaHAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoKC1ub3IueikgKiAoLW5vci56KSkpKSArICgoKGNsMjAgKiAwLjc0MzEyNTAyMTQ1NzY3MjExOTE0MDYyNSkgKiBub3IueCkgKiBub3IueCkpICsgKGNsMDAgKiAwLjg4NjIyNzAxMTY4MDYwMzAyNzM0Mzc1KSkgLSAoY2wyMCAqIDAuMjQ3NzA3OTkyNzkyMTI5NTE2NjAxNTYyNSkpICsgKCgoY2wybTIgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqICgtbm9yLnopKSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqICgtbm9yLnopKSAqIG5vci54KSkgKyAoKGNsMTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci55KSkgKyAoKGNsMW0xICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiAoLW5vci56KSkpICsgKChjbDEwICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueCk7Cn0KCnZvaWQgbWFpbigpCnsKICAgIGhpZ2hwIHZlYzMgbiA9IG5vcm1hbGl6ZSh3bm9ybWFsKTsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC44MDAwMDAwNzE1MjU1NzM3MzA0Njg3NSwgMC43MTUzMDc4MzE3NjQyMjExOTE0MDYyNSwgMC4wMDg1NjY2NjI2NjkxODE4MjM3MzA0Njg3NSk7CiAgICBoaWdocCBmbG9hdCByb3VnaG5lc3MgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHNwZWN1bGFyID0gMC4wOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIGhpZ2hwIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.Material_003_mesh_fragData1="s3830:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gdmVjMyBsaWdodERpcjsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gdmVjMyBsaWdodENvbG9yOwp1bmlmb3JtIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZlYzMgc2hJcnJhZGlhbmNlKHZlYzMgbm9yKQp7CiAgICB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDcxNTI1NTczNzMwNDY4NzUsIDAuNzE1MzA3ODMxNzY0MjIxMTkxNDA2MjUsIDAuMDA4NTY2NjYyNjY5MTgxODIzNzMwNDY4NzUpOwogICAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBmbG9hdCBzcGVjdWxhciA9IDAuMDsKICAgIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaWYgKGxpZ2h0UG9zaXRpb24udyA%IDAuMCkKICAgIHsKICAgICAgICB2ZWMzIGxQb3MgPSBsaWdodFBvc2l0aW9uLnh5eiAvIHZlYzMobGlnaHRQb3NpdGlvbi53KTsKICAgICAgICB2aXNpYmlsaXR5ID0gMC4wOwogICAgICAgIHZpc2liaWxpdHkgKz0gZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKC0wLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIDAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgLTAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgLz0gMi41OwogICAgICAgIHZpc2liaWxpdHkgPSBtYXgodmlzaWJpbGl0eSwgMC4yMDAwMDAwMDI5ODAyMzIyMzg3Njk1MzEyNSk7CiAgICB9CiAgICB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIHNoSXJyYWRpYW5jZShuKSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7Cn0KCg",de.Material_003_mesh_fragData2="s4079:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcDsKdW5pZm9ybSBoaWdocCBmbG9hdCBzaGFkb3dzQmlhczsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodFBvczsKdW5pZm9ybSBoaWdocCBmbG9hdCBlbnZtYXBTdHJlbmd0aDsKCmluIGhpZ2hwIHZlYzMgd25vcm1hbDsKaW4gaGlnaHAgdmVjNCBsaWdodFBvc2l0aW9uOwppbiBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKb3V0IGhpZ2hwIHZlYzQgZnJhZ0NvbG9yOwoKaGlnaHAgZmxvYXQgYXR0ZW51YXRlKGhpZ2hwIGZsb2F0IGRpc3QpCnsKICAgIHJldHVybiAxLjAgLyAoZGlzdCAqIGRpc3QpOwp9CgpoaWdocCB2ZWMzIHNoSXJyYWRpYW5jZShoaWdocCB2ZWMzIG5vcikKewogICAgaGlnaHAgdmVjMyBjbDAwID0gdmVjMyhzaGlyclswXS54LCBzaGlyclswXS55LCBzaGlyclswXS56KTsKICAgIGhpZ2hwIHZlYzMgY2wxbTEgPSB2ZWMzKHNoaXJyWzBdLncsIHNoaXJyWzFdLngsIHNoaXJyWzFdLnkpOwogICAgaGlnaHAgdmVjMyBjbDEwID0gdmVjMyhzaGlyclsxXS56LCBzaGlyclsxXS53LCBzaGlyclsyXS54KTsKICAgIGhpZ2hwIHZlYzMgY2wxMSA9IHZlYzMoc2hpcnJbMl0ueSwgc2hpcnJbMl0ueiwgc2hpcnJbMl0udyk7CiAgICBoaWdocCB2ZWMzIGNsMm0yID0gdmVjMyhzaGlyclszXS54LCBzaGlyclszXS55LCBzaGlyclszXS56KTsKICAgIGhpZ2hwIHZlYzMgY2wybTEgPSB2ZWMzKHNoaXJyWzNdLncsIHNoaXJyWzRdLngsIHNoaXJyWzRdLnkpOwogICAgaGlnaHAgdmVjMyBjbDIwID0gdmVjMyhzaGlycls0XS56LCBzaGlycls0XS53LCBzaGlycls1XS54KTsKICAgIGhpZ2hwIHZlYzMgY2wyMSA9IHZlYzMoc2hpcnJbNV0ueSwgc2hpcnJbNV0ueiwgc2hpcnJbNV0udyk7CiAgICBoaWdocCB2ZWMzIGNsMjIgPSB2ZWMzKHNoaXJyWzZdLngsIHNoaXJyWzZdLnksIHNoaXJyWzZdLnopOwogICAgcmV0dXJuICgoKCgoKCgoKChjbDIyICogMC40MjkwNDI5OTQ5NzYwNDM3MDExNzE4NzUpICogKChub3IueSAqIG5vci55KSAtICgoLW5vci56KSAqICgtbm9yLnopKSkpICsgKCgoY2wyMCAqIDAuNzQzMTI1MDIxNDU3NjcyMTE5MTQwNjI1KSAqIG5vci54KSAqIG5vci54KSkgKyAoY2wwMCAqIDAuODg2MjI3MDExNjgwNjAzMDI3MzQzNzUpKSAtIChjbDIwICogMC4yNDc3MDc5OTI3OTIxMjk1MTY2MDE1NjI1KSkgKyAoKChjbDJtMiAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogKC1ub3IueikpKSArICgoKGNsMjEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqIG5vci54KSkgKyAoKChjbDJtMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogKC1ub3IueikpICogbm9yLngpKSArICgoY2wxMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLnkpKSArICgoY2wxbTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqICgtbm9yLnopKSkgKyAoKGNsMTAgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci54KTsKfQoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgaGlnaHAgdmVjMyBiYXNlY29sID0gdmVjMygwLjgwMDAwMDA3MTUyNTU3MzczMDQ2ODc1LCAwLjcxNTMwNzgzMTc2NDIyMTE5MTQwNjI1LCAwLjAwODU2NjY2MjY2OTE4MTgyMzczMDQ2ODc1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgc3BlY3VsYXIgPSAwLjA7CiAgICBoaWdocCBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgaGlnaHAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGlmIChsaWdodFBvc2l0aW9uLncgPiAwLjApCiAgICB7CiAgICAgICAgaGlnaHAgdmVjMyBsUG9zID0gbGlnaHRQb3NpdGlvbi54eXogLyB2ZWMzKGxpZ2h0UG9zaXRpb24udyk7CiAgICAgICAgdmlzaWJpbGl0eSA9IDAuMDsKICAgICAgICB2aXNpYmlsaXR5ICs9IGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigtMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgLTAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgLz0gMi41OwogICAgICAgIHZpc2liaWxpdHkgPSBtYXgodmlzaWJpbGl0eSwgMC4yMDAwMDAwMDI5ODAyMzIyMzg3Njk1MzEyNSk7CiAgICB9CiAgICBoaWdocCB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZnJhZ0NvbG9yID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiBzaElycmFkaWFuY2UobikpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwp9Cgo",de.Plane_001_mesh_fragData0="s4782:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmVfMDAyOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyBoaWdocCB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgaGlnaHAgdmVjMyB3cG9zaXRpb247CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV8wMDJfc3RvcmUgPSB0ZXh0dXJlMkQoSW1hZ2VUZXh0dXJlXzAwMiwgdGV4Q29vcmQpOwogICAgaGlnaHAgdmVjMyBfMjA2ID0gcG93KEltYWdlVGV4dHVyZV8wMDJfc3RvcmUueHl6LCB2ZWMzKDIuMjAwMDAwMDQ3NjgzNzE1ODIwMzEyNSkpOwogICAgSW1hZ2VUZXh0dXJlXzAwMl9zdG9yZSA9IHZlYzQoXzIwNi54LCBfMjA2LnksIF8yMDYueiwgSW1hZ2VUZXh0dXJlXzAwMl9zdG9yZS53KTsKICAgIGhpZ2hwIHZlYzQgSW1hZ2VUZXh0dXJlX3N0b3JlID0gdGV4dHVyZTJEKEltYWdlVGV4dHVyZSwgdGV4Q29vcmQpOwogICAgaGlnaHAgdmVjMyBJbWFnZVRleHR1cmVfMDAyX0NvbG9yX3JlcyA9IEltYWdlVGV4dHVyZV8wMDJfc3RvcmUueHl6OwogICAgaGlnaHAgdmVjMyBJbWFnZVRleHR1cmVfQ29sb3JfcmVzID0gSW1hZ2VUZXh0dXJlX3N0b3JlLnh5ejsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IEltYWdlVGV4dHVyZV8wMDJfQ29sb3JfcmVzOwogICAgaGlnaHAgZmxvYXQgcm91Z2huZXNzID0gSW1hZ2VUZXh0dXJlX0NvbG9yX3Jlcy54OwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaWYgKGxpZ2h0UG9zaXRpb24udyA%IDAuMCkKICAgIHsKICAgICAgICBoaWdocCB2ZWMzIGxQb3MgPSBsaWdodFBvc2l0aW9uLnh5eiAvIHZlYzMobGlnaHRQb3NpdGlvbi53KTsKICAgICAgICB2aXNpYmlsaXR5ID0gMC4wOwogICAgICAgIHZpc2liaWxpdHkgKz0gZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKC0wLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIDAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgLTAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgLz0gMi41OwogICAgICAgIHZpc2liaWxpdHkgPSBtYXgodmlzaWJpbGl0eSwgMC4yMDAwMDAwMDI5ODAyMzIyMzg3Njk1MzEyNSk7CiAgICB9CiAgICBoaWdocCB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIHNoSXJyYWRpYW5jZShuKSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7Cn0KCg",de.Plane_001_mesh_fragData1="s4488:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgSW1hZ2VUZXh0dXJlXzAwMjsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gdmVjMyBsaWdodERpcjsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gdmVjMyBsaWdodENvbG9yOwp1bmlmb3JtIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIHZlYzQgbGlnaHRQb3NpdGlvbjsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKCmZsb2F0IGF0dGVudWF0ZShmbG9hdCBkaXN0KQp7CiAgICByZXR1cm4gMS4wIC8gKGRpc3QgKiBkaXN0KTsKfQoKdmVjMyBzaElycmFkaWFuY2UodmVjMyBub3IpCnsKICAgIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoKC1ub3IueikgKiAoLW5vci56KSkpKSArICgoKGNsMjAgKiAwLjc0MzEyNTAyMTQ1NzY3MjExOTE0MDYyNSkgKiBub3IueCkgKiBub3IueCkpICsgKGNsMDAgKiAwLjg4NjIyNzAxMTY4MDYwMzAyNzM0Mzc1KSkgLSAoY2wyMCAqIDAuMjQ3NzA3OTkyNzkyMTI5NTE2NjAxNTYyNSkpICsgKCgoY2wybTIgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqICgtbm9yLnopKSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqICgtbm9yLnopKSAqIG5vci54KSkgKyAoKGNsMTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci55KSkgKyAoKGNsMW0xICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiAoLW5vci56KSkpICsgKChjbDEwICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueCk7Cn0KCnZvaWQgbWFpbigpCnsKICAgIHZlYzMgbiA9IG5vcm1hbGl6ZSh3bm9ybWFsKTsKICAgIHZlYzQgSW1hZ2VUZXh0dXJlXzAwMl9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmVfMDAyLCB0ZXhDb29yZCk7CiAgICB2ZWMzIF8yMDYgPSBwb3coSW1hZ2VUZXh0dXJlXzAwMl9zdG9yZS54eXosIHZlYzMoMi4yMDAwMDAwNDc2ODM3MTU4MjAzMTI1KSk7CiAgICBJbWFnZVRleHR1cmVfMDAyX3N0b3JlID0gdmVjNChfMjA2LngsIF8yMDYueSwgXzIwNi56LCBJbWFnZVRleHR1cmVfMDAyX3N0b3JlLncpOwogICAgdmVjNCBJbWFnZVRleHR1cmVfc3RvcmUgPSB0ZXh0dXJlMkQoSW1hZ2VUZXh0dXJlLCB0ZXhDb29yZCk7CiAgICB2ZWMzIEltYWdlVGV4dHVyZV8wMDJfQ29sb3JfcmVzID0gSW1hZ2VUZXh0dXJlXzAwMl9zdG9yZS54eXo7CiAgICB2ZWMzIEltYWdlVGV4dHVyZV9Db2xvcl9yZXMgPSBJbWFnZVRleHR1cmVfc3RvcmUueHl6OwogICAgdmVjMyBiYXNlY29sID0gSW1hZ2VUZXh0dXJlXzAwMl9Db2xvcl9yZXM7CiAgICBmbG9hdCByb3VnaG5lc3MgPSBJbWFnZVRleHR1cmVfQ29sb3JfcmVzLng7CiAgICBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGZsb2F0IHNwZWN1bGFyID0gMS4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAtMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSAvPSAyLjU7CiAgICAgICAgdmlzaWJpbGl0eSA9IG1heCh2aXNpYmlsaXR5LCAwLjIwMDAwMDAwMjk4MDIzMjIzODc2OTUzMTI1KTsKICAgIH0KICAgIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.Plane_001_mesh_fragData2="s4768:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmVfMDAyOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMyIHRleENvb3JkOwppbiBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CmluIGhpZ2hwIHZlYzMgd3Bvc2l0aW9uOwpvdXQgaGlnaHAgdmVjNCBmcmFnQ29sb3I7CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV8wMDJfc3RvcmUgPSB0ZXh0dXJlKEltYWdlVGV4dHVyZV8wMDIsIHRleENvb3JkKTsKICAgIGhpZ2hwIHZlYzMgXzIwNiA9IHBvdyhJbWFnZVRleHR1cmVfMDAyX3N0b3JlLnh5eiwgdmVjMygyLjIwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKTsKICAgIEltYWdlVGV4dHVyZV8wMDJfc3RvcmUgPSB2ZWM0KF8yMDYueCwgXzIwNi55LCBfMjA2LnosIEltYWdlVGV4dHVyZV8wMDJfc3RvcmUudyk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUoSW1hZ2VUZXh0dXJlLCB0ZXhDb29yZCk7CiAgICBoaWdocCB2ZWMzIEltYWdlVGV4dHVyZV8wMDJfQ29sb3JfcmVzID0gSW1hZ2VUZXh0dXJlXzAwMl9zdG9yZS54eXo7CiAgICBoaWdocCB2ZWMzIEltYWdlVGV4dHVyZV9Db2xvcl9yZXMgPSBJbWFnZVRleHR1cmVfc3RvcmUueHl6OwogICAgaGlnaHAgdmVjMyBiYXNlY29sID0gSW1hZ2VUZXh0dXJlXzAwMl9Db2xvcl9yZXM7CiAgICBoaWdocCBmbG9hdCByb3VnaG5lc3MgPSBJbWFnZVRleHR1cmVfQ29sb3JfcmVzLng7CiAgICBoaWdocCBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHNwZWN1bGFyID0gMS4wOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIGhpZ2hwIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIDAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIC0wLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5IC89IDIuNTsKICAgICAgICB2aXNpYmlsaXR5ID0gbWF4KHZpc2liaWxpdHksIDAuMjAwMDAwMDAyOTgwMjMyMjM4NzY5NTMxMjUpOwogICAgfQogICAgaGlnaHAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGZyYWdDb2xvciA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.compositor_pass_vertData0="s214:I3ZlcnNpb24gMTAwCgp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHBvczsKCnZvaWQgbWFpbigpCnsKICAgIHRleENvb3JkID0gKHBvcyAqIHZlYzIoMC41KSkgKyB2ZWMyKDAuNSk7CiAgICBnbF9Qb3NpdGlvbiA9IHZlYzQocG9zLCAwLjAsIDEuMCk7Cn0KCg",de.compositor_pass_vertData1="s235:I3ZlcnNpb24gMTAwCgp2YXJ5aW5nIG1lZGl1bXAgdmVjMiB0ZXhDb29yZDsKYXR0cmlidXRlIG1lZGl1bXAgdmVjMiBwb3M7Cgp2b2lkIG1haW4oKQp7CiAgICB0ZXhDb29yZCA9IChwb3MgKiB2ZWMyKDAuNSkpICsgdmVjMigwLjUpOwogICAgZ2xfUG9zaXRpb24gPSB2ZWM0KHBvcywgMC4wLCAxLjApOwp9Cgo",de.compositor_pass_vertData2="s203:I3ZlcnNpb24gMzAwIGVzCgpvdXQgdmVjMiB0ZXhDb29yZDsKaW4gdmVjMiBwb3M7Cgp2b2lkIG1haW4oKQp7CiAgICB0ZXhDb29yZCA9IChwb3MgKiB2ZWMyKDAuNSkpICsgdmVjMigwLjUpOwogICAgZ2xfUG9zaXRpb24gPSB2ZWM0KHBvcywgMC4wLCAxLjApOwp9Cgo",de.Wall_mesh_fragData0="s4510:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyBoaWdocCB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgaGlnaHAgdmVjMyB3cG9zaXRpb247CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmUsIHRleENvb3JkKTsKICAgIGhpZ2hwIHZlYzMgXzIwNiA9IHBvdyhJbWFnZVRleHR1cmVfc3RvcmUueHl6LCB2ZWMzKDIuMjAwMDAwMDQ3NjgzNzE1ODIwMzEyNSkpOwogICAgSW1hZ2VUZXh0dXJlX3N0b3JlID0gdmVjNChfMjA2LngsIF8yMDYueSwgXzIwNi56LCBJbWFnZVRleHR1cmVfc3RvcmUudyk7CiAgICBoaWdocCB2ZWMzIEltYWdlVGV4dHVyZV9Db2xvcl9yZXMgPSBJbWFnZVRleHR1cmVfc3RvcmUueHl6OwogICAgaGlnaHAgdmVjMyBiYXNlY29sID0gSW1hZ2VUZXh0dXJlX0NvbG9yX3JlczsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMTAwMDAwMDAxNDkwMTE2MTE5Mzg0NzY1NjI1OwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaWYgKGxpZ2h0UG9zaXRpb24udyA%IDAuMCkKICAgIHsKICAgICAgICBoaWdocCB2ZWMzIGxQb3MgPSBsaWdodFBvc2l0aW9uLnh5eiAvIHZlYzMobGlnaHRQb3NpdGlvbi53KTsKICAgICAgICB2aXNpYmlsaXR5ID0gMC4wOwogICAgICAgIHZpc2liaWxpdHkgKz0gZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKC0wLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIDAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgLTAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgLz0gMi41OwogICAgICAgIHZpc2liaWxpdHkgPSBtYXgodmlzaWJpbGl0eSwgMC4yMDAwMDAwMDI5ODAyMzIyMzg3Njk1MzEyNSk7CiAgICB9CiAgICBoaWdocCB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIHNoSXJyYWRpYW5jZShuKSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7Cn0KCg",de.Wall_mesh_fragData1="s4230:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgSW1hZ2VUZXh0dXJlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZlYzMgc2hJcnJhZGlhbmNlKHZlYzMgbm9yKQp7CiAgICB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmUsIHRleENvb3JkKTsKICAgIHZlYzMgXzIwNiA9IHBvdyhJbWFnZVRleHR1cmVfc3RvcmUueHl6LCB2ZWMzKDIuMjAwMDAwMDQ3NjgzNzE1ODIwMzEyNSkpOwogICAgSW1hZ2VUZXh0dXJlX3N0b3JlID0gdmVjNChfMjA2LngsIF8yMDYueSwgXzIwNi56LCBJbWFnZVRleHR1cmVfc3RvcmUudyk7CiAgICB2ZWMzIEltYWdlVGV4dHVyZV9Db2xvcl9yZXMgPSBJbWFnZVRleHR1cmVfc3RvcmUueHl6OwogICAgdmVjMyBiYXNlY29sID0gSW1hZ2VUZXh0dXJlX0NvbG9yX3JlczsKICAgIGZsb2F0IHJvdWdobmVzcyA9IDAuMTAwMDAwMDAxNDkwMTE2MTE5Mzg0NzY1NjI1OwogICAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBmbG9hdCBzcGVjdWxhciA9IDEuMDsKICAgIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaWYgKGxpZ2h0UG9zaXRpb24udyA%IDAuMCkKICAgIHsKICAgICAgICB2ZWMzIGxQb3MgPSBsaWdodFBvc2l0aW9uLnh5eiAvIHZlYzMobGlnaHRQb3NpdGlvbi53KTsKICAgICAgICB2aXNpYmlsaXR5ID0gMC4wOwogICAgICAgIHZpc2liaWxpdHkgKz0gZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKC0wLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIDAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUyRChzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgLTAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgLz0gMi41OwogICAgICAgIHZpc2liaWxpdHkgPSBtYXgodmlzaWJpbGl0eSwgMC4yMDAwMDAwMDI5ODAyMzIyMzg3Njk1MzEyNSk7CiAgICB9CiAgICB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIHNoSXJyYWRpYW5jZShuKSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7Cn0KCg",de.Wall_mesh_fragData2="s4499:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMyIHRleENvb3JkOwppbiBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CmluIGhpZ2hwIHZlYzMgd3Bvc2l0aW9uOwpvdXQgaGlnaHAgdmVjNCBmcmFnQ29sb3I7CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUoSW1hZ2VUZXh0dXJlLCB0ZXhDb29yZCk7CiAgICBoaWdocCB2ZWMzIF8yMDYgPSBwb3coSW1hZ2VUZXh0dXJlX3N0b3JlLnh5eiwgdmVjMygyLjIwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKTsKICAgIEltYWdlVGV4dHVyZV9zdG9yZSA9IHZlYzQoXzIwNi54LCBfMjA2LnksIF8yMDYueiwgSW1hZ2VUZXh0dXJlX3N0b3JlLncpOwogICAgaGlnaHAgdmVjMyBJbWFnZVRleHR1cmVfQ29sb3JfcmVzID0gSW1hZ2VUZXh0dXJlX3N0b3JlLnh5ejsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IEltYWdlVGV4dHVyZV9Db2xvcl9yZXM7CiAgICBoaWdocCBmbG9hdCByb3VnaG5lc3MgPSAwLjEwMDAwMDAwMTQ5MDExNjExOTM4NDc2NTYyNTsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgc3BlY3VsYXIgPSAxLjA7CiAgICBoaWdocCBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgaGlnaHAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGlmIChsaWdodFBvc2l0aW9uLncgPiAwLjApCiAgICB7CiAgICAgICAgaGlnaHAgdmVjMyBsUG9zID0gbGlnaHRQb3NpdGlvbi54eXogLyB2ZWMzKGxpZ2h0UG9zaXRpb24udyk7CiAgICAgICAgdmlzaWJpbGl0eSA9IDAuMDsKICAgICAgICB2aXNpYmlsaXR5ICs9IGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3Mueik7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAwMDQ4ODI4MTI1LCAwLjApKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigtMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgMC4wMDA0ODgyODEyNSkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC41KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkgKyB2ZWMyKDAuMCwgLTAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuMjUpOwogICAgICAgIHZpc2liaWxpdHkgLz0gMi41OwogICAgICAgIHZpc2liaWxpdHkgPSBtYXgodmlzaWJpbGl0eSwgMC4yMDAwMDAwMDI5ODAyMzIyMzg3Njk1MzEyNSk7CiAgICB9CiAgICBoaWdocCB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZnJhZ0NvbG9yID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiBzaElycmFkaWFuY2UobikpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwp9Cgo",de.compositor_pass_fragData0="s3506:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMyIHRleFN0ZXA7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHRleDsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgZ2J1ZmZlckQ7Cgp2YXJ5aW5nIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7CgpoaWdocCB2ZWMzIHRvbmVtYXBGaWxtaWMoaGlnaHAgdmVjMyBjb2xvcikKewogICAgaGlnaHAgdmVjMyB4ID0gbWF4KHZlYzMoMC4wKSwgY29sb3IgLSB2ZWMzKDAuMDA0MDAwMDAwMTg5OTg5ODA1MjIxNTU3NjE3MTg3NSkpOwogICAgcmV0dXJuICh4ICogKCh4ICogNi4xOTk5OTk4MDkyNjUxMzY3MTg3NSkgKyB2ZWMzKDAuNSkpKSAvICgoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygxLjcwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKSkgKyB2ZWMzKDAuMDU5OTk5OTk4NjU4ODk1NDkyNTUzNzEwOTM3NSkpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMyIHRleENvID0gdGV4Q29vcmQ7CiAgICBoaWdocCB2ZWMyIHRjcmdiTlcgPSB0ZXhDbyArICh2ZWMyKC0xLjApICogdGV4U3RlcCk7CiAgICBoaWdocCB2ZWMyIHRjcmdiTkUgPSB0ZXhDbyArICh2ZWMyKDEuMCwgLTEuMCkgKiB0ZXhTdGVwKTsKICAgIGhpZ2hwIHZlYzIgdGNyZ2JTVyA9IHRleENvICsgKHZlYzIoLTEuMCwgMS4wKSAqIHRleFN0ZXApOwogICAgaGlnaHAgdmVjMiB0Y3JnYlNFID0gdGV4Q28gKyAodmVjMigxLjApICogdGV4U3RlcCk7CiAgICBoaWdocCB2ZWMyIHRjcmdiTSA9IHZlYzIodGV4Q28pOwogICAgaGlnaHAgdmVjMyByZ2JOVyA9IHRleHR1cmUyRCh0ZXgsIHRjcmdiTlcpLnh5ejsKICAgIGhpZ2hwIHZlYzMgcmdiTkUgPSB0ZXh0dXJlMkQodGV4LCB0Y3JnYk5FKS54eXo7CiAgICBoaWdocCB2ZWMzIHJnYlNXID0gdGV4dHVyZTJEKHRleCwgdGNyZ2JTVykueHl6OwogICAgaGlnaHAgdmVjMyByZ2JTRSA9IHRleHR1cmUyRCh0ZXgsIHRjcmdiU0UpLnh5ejsKICAgIGhpZ2hwIHZlYzMgcmdiTSA9IHRleHR1cmUyRCh0ZXgsIHRjcmdiTSkueHl6OwogICAgaGlnaHAgdmVjMyBsdW1hID0gdmVjMygwLjI5ODk5OTk5NDk5MzIwOTgzODg2NzE4NzUsIDAuNTg3MDAwMDEyMzk3NzY2MTEzMjgxMjUsIDAuMTE0MDAwMDAwMDU5NjA0NjQ0Nzc1MzkwNjI1KTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFOVyA9IGRvdChyZ2JOVywgbHVtYSk7CiAgICBoaWdocCBmbG9hdCBsdW1hTkUgPSBkb3QocmdiTkUsIGx1bWEpOwogICAgaGlnaHAgZmxvYXQgbHVtYVNXID0gZG90KHJnYlNXLCBsdW1hKTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFTRSA9IGRvdChyZ2JTRSwgbHVtYSk7CiAgICBoaWdocCBmbG9hdCBsdW1hTSA9IGRvdChyZ2JNLCBsdW1hKTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFNaW4gPSBtaW4obHVtYU0sIG1pbihtaW4obHVtYU5XLCBsdW1hTkUpLCBtaW4obHVtYVNXLCBsdW1hU0UpKSk7CiAgICBoaWdocCBmbG9hdCBsdW1hTWF4ID0gbWF4KGx1bWFNLCBtYXgobWF4KGx1bWFOVywgbHVtYU5FKSwgbWF4KGx1bWFTVywgbHVtYVNFKSkpOwogICAgaGlnaHAgdmVjMiBkaXI7CiAgICBkaXIueCA9IC0oKGx1bWFOVyArIGx1bWFORSkgLSAobHVtYVNXICsgbHVtYVNFKSk7CiAgICBkaXIueSA9IChsdW1hTlcgKyBsdW1hU1cpIC0gKGx1bWFORSArIGx1bWFTRSk7CiAgICBoaWdocCBmbG9hdCBkaXJSZWR1Y2UgPSBtYXgoKCgobHVtYU5XICsgbHVtYU5FKSArIGx1bWFTVykgKyBsdW1hU0UpICogMC4wMzEyNSwgMC4wMDc4MTI1KTsKICAgIGhpZ2hwIGZsb2F0IHJjcERpck1pbiA9IDEuMCAvIChtaW4oYWJzKGRpci54KSwgYWJzKGRpci55KSkgKyBkaXJSZWR1Y2UpOwogICAgZGlyID0gbWluKHZlYzIoOC4wKSwgbWF4KHZlYzIoLTguMCksIGRpciAqIHJjcERpck1pbikpICogdGV4U3RlcDsKICAgIGhpZ2hwIHZlYzMgcmdiQSA9ICh0ZXh0dXJlMkQodGV4LCB0ZXhDbyArIChkaXIgKiAoLTAuMTY2NjY2NjcxNjMzNzIwMzk3OTQ5MjE4NzUpKSkueHl6ICsgdGV4dHVyZTJEKHRleCwgdGV4Q28gKyAoZGlyICogMC4xNjY2NjY2NzE2MzM3MjAzOTc5NDkyMTg3NSkpLnh5eikgKiAwLjU7CiAgICBoaWdocCB2ZWMzIHJnYkIgPSAocmdiQSAqIDAuNSkgKyAoKHRleHR1cmUyRCh0ZXgsIHRleENvICsgKGRpciAqICgtMC41KSkpLnh5eiArIHRleHR1cmUyRCh0ZXgsIHRleENvICsgKGRpciAqIDAuNSkpLnh5eikgKiAwLjI1KTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFCID0gZG90KHJnYkIsIGx1bWEpOwogICAgaWYgKChsdW1hQiA8IGx1bWFNaW4pIHx8IChsdW1hQiA%IGx1bWFNYXgpKQogICAgewogICAgICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChyZ2JBLngsIHJnYkEueSwgcmdiQS56LCBnbF9GcmFnRGF0YVswXS53KTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQocmdiQi54LCByZ2JCLnksIHJnYkIueiwgZ2xfRnJhZ0RhdGFbMF0udyk7CiAgICB9CiAgICBoaWdocCB2ZWMzIF8yNzcgPSB0b25lbWFwRmlsbWljKGdsX0ZyYWdEYXRhWzBdLnh5eik7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoXzI3Ny54LCBfMjc3LnksIF8yNzcueiwgZ2xfRnJhZ0RhdGFbMF0udyk7Cn0KCg",de.compositor_pass_fragData1="s3266:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzIgdGV4U3RlcDsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCB0ZXg7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgZ2J1ZmZlckQ7Cgp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2ZWMzIHRvbmVtYXBGaWxtaWModmVjMyBjb2xvcikKewogICAgdmVjMyB4ID0gbWF4KHZlYzMoMC4wKSwgY29sb3IgLSB2ZWMzKDAuMDA0MDAwMDAwMTg5OTg5ODA1MjIxNTU3NjE3MTg3NSkpOwogICAgcmV0dXJuICh4ICogKCh4ICogNi4xOTk5OTk4MDkyNjUxMzY3MTg3NSkgKyB2ZWMzKDAuNSkpKSAvICgoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygxLjcwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKSkgKyB2ZWMzKDAuMDU5OTk5OTk4NjU4ODk1NDkyNTUzNzEwOTM3NSkpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMyIHRleENvID0gdGV4Q29vcmQ7CiAgICB2ZWMyIHRjcmdiTlcgPSB0ZXhDbyArICh2ZWMyKC0xLjApICogdGV4U3RlcCk7CiAgICB2ZWMyIHRjcmdiTkUgPSB0ZXhDbyArICh2ZWMyKDEuMCwgLTEuMCkgKiB0ZXhTdGVwKTsKICAgIHZlYzIgdGNyZ2JTVyA9IHRleENvICsgKHZlYzIoLTEuMCwgMS4wKSAqIHRleFN0ZXApOwogICAgdmVjMiB0Y3JnYlNFID0gdGV4Q28gKyAodmVjMigxLjApICogdGV4U3RlcCk7CiAgICB2ZWMyIHRjcmdiTSA9IHZlYzIodGV4Q28pOwogICAgdmVjMyByZ2JOVyA9IHRleHR1cmUyRCh0ZXgsIHRjcmdiTlcpLnh5ejsKICAgIHZlYzMgcmdiTkUgPSB0ZXh0dXJlMkQodGV4LCB0Y3JnYk5FKS54eXo7CiAgICB2ZWMzIHJnYlNXID0gdGV4dHVyZTJEKHRleCwgdGNyZ2JTVykueHl6OwogICAgdmVjMyByZ2JTRSA9IHRleHR1cmUyRCh0ZXgsIHRjcmdiU0UpLnh5ejsKICAgIHZlYzMgcmdiTSA9IHRleHR1cmUyRCh0ZXgsIHRjcmdiTSkueHl6OwogICAgdmVjMyBsdW1hID0gdmVjMygwLjI5ODk5OTk5NDk5MzIwOTgzODg2NzE4NzUsIDAuNTg3MDAwMDEyMzk3NzY2MTEzMjgxMjUsIDAuMTE0MDAwMDAwMDU5NjA0NjQ0Nzc1MzkwNjI1KTsKICAgIGZsb2F0IGx1bWFOVyA9IGRvdChyZ2JOVywgbHVtYSk7CiAgICBmbG9hdCBsdW1hTkUgPSBkb3QocmdiTkUsIGx1bWEpOwogICAgZmxvYXQgbHVtYVNXID0gZG90KHJnYlNXLCBsdW1hKTsKICAgIGZsb2F0IGx1bWFTRSA9IGRvdChyZ2JTRSwgbHVtYSk7CiAgICBmbG9hdCBsdW1hTSA9IGRvdChyZ2JNLCBsdW1hKTsKICAgIGZsb2F0IGx1bWFNaW4gPSBtaW4obHVtYU0sIG1pbihtaW4obHVtYU5XLCBsdW1hTkUpLCBtaW4obHVtYVNXLCBsdW1hU0UpKSk7CiAgICBmbG9hdCBsdW1hTWF4ID0gbWF4KGx1bWFNLCBtYXgobWF4KGx1bWFOVywgbHVtYU5FKSwgbWF4KGx1bWFTVywgbHVtYVNFKSkpOwogICAgdmVjMiBkaXI7CiAgICBkaXIueCA9IC0oKGx1bWFOVyArIGx1bWFORSkgLSAobHVtYVNXICsgbHVtYVNFKSk7CiAgICBkaXIueSA9IChsdW1hTlcgKyBsdW1hU1cpIC0gKGx1bWFORSArIGx1bWFTRSk7CiAgICBmbG9hdCBkaXJSZWR1Y2UgPSBtYXgoKCgobHVtYU5XICsgbHVtYU5FKSArIGx1bWFTVykgKyBsdW1hU0UpICogMC4wMzEyNSwgMC4wMDc4MTI1KTsKICAgIGZsb2F0IHJjcERpck1pbiA9IDEuMCAvIChtaW4oYWJzKGRpci54KSwgYWJzKGRpci55KSkgKyBkaXJSZWR1Y2UpOwogICAgZGlyID0gbWluKHZlYzIoOC4wKSwgbWF4KHZlYzIoLTguMCksIGRpciAqIHJjcERpck1pbikpICogdGV4U3RlcDsKICAgIHZlYzMgcmdiQSA9ICh0ZXh0dXJlMkQodGV4LCB0ZXhDbyArIChkaXIgKiAoLTAuMTY2NjY2NjcxNjMzNzIwMzk3OTQ5MjE4NzUpKSkueHl6ICsgdGV4dHVyZTJEKHRleCwgdGV4Q28gKyAoZGlyICogMC4xNjY2NjY2NzE2MzM3MjAzOTc5NDkyMTg3NSkpLnh5eikgKiAwLjU7CiAgICB2ZWMzIHJnYkIgPSAocmdiQSAqIDAuNSkgKyAoKHRleHR1cmUyRCh0ZXgsIHRleENvICsgKGRpciAqICgtMC41KSkpLnh5eiArIHRleHR1cmUyRCh0ZXgsIHRleENvICsgKGRpciAqIDAuNSkpLnh5eikgKiAwLjI1KTsKICAgIGZsb2F0IGx1bWFCID0gZG90KHJnYkIsIGx1bWEpOwogICAgaWYgKChsdW1hQiA8IGx1bWFNaW4pIHx8IChsdW1hQiA%IGx1bWFNYXgpKQogICAgewogICAgICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChyZ2JBLngsIHJnYkEueSwgcmdiQS56LCBnbF9GcmFnRGF0YVswXS53KTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQocmdiQi54LCByZ2JCLnksIHJnYkIueiwgZ2xfRnJhZ0RhdGFbMF0udyk7CiAgICB9CiAgICB2ZWMzIF8yNzcgPSB0b25lbWFwRmlsbWljKGdsX0ZyYWdEYXRhWzBdLnh5eik7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoXzI3Ny54LCBfMjc3LnksIF8yNzcueiwgZ2xfRnJhZ0RhdGFbMF0udyk7Cn0KCg",de.compositor_pass_fragData2="s3467:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMyIHRleFN0ZXA7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHRleDsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgZ2J1ZmZlckQ7CgppbiBoaWdocCB2ZWMyIHRleENvb3JkOwpvdXQgaGlnaHAgdmVjNCBmcmFnQ29sb3I7CgpoaWdocCB2ZWMzIHRvbmVtYXBGaWxtaWMoaGlnaHAgdmVjMyBjb2xvcikKewogICAgaGlnaHAgdmVjMyB4ID0gbWF4KHZlYzMoMC4wKSwgY29sb3IgLSB2ZWMzKDAuMDA0MDAwMDAwMTg5OTg5ODA1MjIxNTU3NjE3MTg3NSkpOwogICAgcmV0dXJuICh4ICogKCh4ICogNi4xOTk5OTk4MDkyNjUxMzY3MTg3NSkgKyB2ZWMzKDAuNSkpKSAvICgoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygxLjcwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKSkgKyB2ZWMzKDAuMDU5OTk5OTk4NjU4ODk1NDkyNTUzNzEwOTM3NSkpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMyIHRleENvID0gdGV4Q29vcmQ7CiAgICBoaWdocCB2ZWMyIHRjcmdiTlcgPSB0ZXhDbyArICh2ZWMyKC0xLjApICogdGV4U3RlcCk7CiAgICBoaWdocCB2ZWMyIHRjcmdiTkUgPSB0ZXhDbyArICh2ZWMyKDEuMCwgLTEuMCkgKiB0ZXhTdGVwKTsKICAgIGhpZ2hwIHZlYzIgdGNyZ2JTVyA9IHRleENvICsgKHZlYzIoLTEuMCwgMS4wKSAqIHRleFN0ZXApOwogICAgaGlnaHAgdmVjMiB0Y3JnYlNFID0gdGV4Q28gKyAodmVjMigxLjApICogdGV4U3RlcCk7CiAgICBoaWdocCB2ZWMyIHRjcmdiTSA9IHZlYzIodGV4Q28pOwogICAgaGlnaHAgdmVjMyByZ2JOVyA9IHRleHR1cmUodGV4LCB0Y3JnYk5XKS54eXo7CiAgICBoaWdocCB2ZWMzIHJnYk5FID0gdGV4dHVyZSh0ZXgsIHRjcmdiTkUpLnh5ejsKICAgIGhpZ2hwIHZlYzMgcmdiU1cgPSB0ZXh0dXJlKHRleCwgdGNyZ2JTVykueHl6OwogICAgaGlnaHAgdmVjMyByZ2JTRSA9IHRleHR1cmUodGV4LCB0Y3JnYlNFKS54eXo7CiAgICBoaWdocCB2ZWMzIHJnYk0gPSB0ZXh0dXJlKHRleCwgdGNyZ2JNKS54eXo7CiAgICBoaWdocCB2ZWMzIGx1bWEgPSB2ZWMzKDAuMjk4OTk5OTk0OTkzMjA5ODM4ODY3MTg3NSwgMC41ODcwMDAwMTIzOTc3NjYxMTMyODEyNSwgMC4xMTQwMDAwMDAwNTk2MDQ2NDQ3NzUzOTA2MjUpOwogICAgaGlnaHAgZmxvYXQgbHVtYU5XID0gZG90KHJnYk5XLCBsdW1hKTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFORSA9IGRvdChyZ2JORSwgbHVtYSk7CiAgICBoaWdocCBmbG9hdCBsdW1hU1cgPSBkb3QocmdiU1csIGx1bWEpOwogICAgaGlnaHAgZmxvYXQgbHVtYVNFID0gZG90KHJnYlNFLCBsdW1hKTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFNID0gZG90KHJnYk0sIGx1bWEpOwogICAgaGlnaHAgZmxvYXQgbHVtYU1pbiA9IG1pbihsdW1hTSwgbWluKG1pbihsdW1hTlcsIGx1bWFORSksIG1pbihsdW1hU1csIGx1bWFTRSkpKTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFNYXggPSBtYXgobHVtYU0sIG1heChtYXgobHVtYU5XLCBsdW1hTkUpLCBtYXgobHVtYVNXLCBsdW1hU0UpKSk7CiAgICBoaWdocCB2ZWMyIGRpcjsKICAgIGRpci54ID0gLSgobHVtYU5XICsgbHVtYU5FKSAtIChsdW1hU1cgKyBsdW1hU0UpKTsKICAgIGRpci55ID0gKGx1bWFOVyArIGx1bWFTVykgLSAobHVtYU5FICsgbHVtYVNFKTsKICAgIGhpZ2hwIGZsb2F0IGRpclJlZHVjZSA9IG1heCgoKChsdW1hTlcgKyBsdW1hTkUpICsgbHVtYVNXKSArIGx1bWFTRSkgKiAwLjAzMTI1LCAwLjAwNzgxMjUpOwogICAgaGlnaHAgZmxvYXQgcmNwRGlyTWluID0gMS4wIC8gKG1pbihhYnMoZGlyLngpLCBhYnMoZGlyLnkpKSArIGRpclJlZHVjZSk7CiAgICBkaXIgPSBtaW4odmVjMig4LjApLCBtYXgodmVjMigtOC4wKSwgZGlyICogcmNwRGlyTWluKSkgKiB0ZXhTdGVwOwogICAgaGlnaHAgdmVjMyByZ2JBID0gKHRleHR1cmUodGV4LCB0ZXhDbyArIChkaXIgKiAoLTAuMTY2NjY2NjcxNjMzNzIwMzk3OTQ5MjE4NzUpKSkueHl6ICsgdGV4dHVyZSh0ZXgsIHRleENvICsgKGRpciAqIDAuMTY2NjY2NjcxNjMzNzIwMzk3OTQ5MjE4NzUpKS54eXopICogMC41OwogICAgaGlnaHAgdmVjMyByZ2JCID0gKHJnYkEgKiAwLjUpICsgKCh0ZXh0dXJlKHRleCwgdGV4Q28gKyAoZGlyICogKC0wLjUpKSkueHl6ICsgdGV4dHVyZSh0ZXgsIHRleENvICsgKGRpciAqIDAuNSkpLnh5eikgKiAwLjI1KTsKICAgIGhpZ2hwIGZsb2F0IGx1bWFCID0gZG90KHJnYkIsIGx1bWEpOwogICAgaWYgKChsdW1hQiA8IGx1bWFNaW4pIHx8IChsdW1hQiA%IGx1bWFNYXgpKQogICAgewogICAgICAgIGZyYWdDb2xvciA9IHZlYzQocmdiQS54LCByZ2JBLnksIHJnYkEueiwgZnJhZ0NvbG9yLncpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGZyYWdDb2xvciA9IHZlYzQocmdiQi54LCByZ2JCLnksIHJnYkIueiwgZnJhZ0NvbG9yLncpOwogICAgfQogICAgaGlnaHAgdmVjMyBfMjc3ID0gdG9uZW1hcEZpbG1pYyhmcmFnQ29sb3IueHl6KTsKICAgIGZyYWdDb2xvciA9IHZlYzQoXzI3Ny54LCBfMjc3LnksIF8yNzcueiwgZnJhZ0NvbG9yLncpOwp9Cgo",de.Red_mesh_fragData0="s4375:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyBoaWdocCB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgaGlnaHAgdmVjMyB3cG9zaXRpb247CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmUsIHRleENvb3JkKTsKICAgIGhpZ2hwIHZlYzMgSW1hZ2VUZXh0dXJlX0NvbG9yX3JlcyA9IEltYWdlVGV4dHVyZV9zdG9yZS54eXo7CiAgICBoaWdocCB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuNzc0MjM3ODcxMTcwMDQzOTQ1MzEyNSwgMC4xMzEwNDQxNDkzOTg4MDM3MTA5Mzc1LCAwLjA4ODQwNTIzNjYwMTgyOTUyODgwODU5Mzc1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IEltYWdlVGV4dHVyZV9Db2xvcl9yZXMueDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgc3BlY3VsYXIgPSAxLjA7CiAgICBoaWdocCBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgaGlnaHAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGlmIChsaWdodFBvc2l0aW9uLncgPiAwLjApCiAgICB7CiAgICAgICAgaGlnaHAgdmVjMyBsUG9zID0gbGlnaHRQb3NpdGlvbi54eXogLyB2ZWMzKGxpZ2h0UG9zaXRpb24udyk7CiAgICAgICAgdmlzaWJpbGl0eSA9IDAuMDsKICAgICAgICB2aXNpYmlsaXR5ICs9IGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5KS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigtMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAwLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIC0wLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5IC89IDIuNTsKICAgICAgICB2aXNpYmlsaXR5ID0gbWF4KHZpc2liaWxpdHksIDAuMjAwMDAwMDAyOTgwMjMyMjM4NzY5NTMxMjUpOwogICAgfQogICAgaGlnaHAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiBzaElycmFkaWFuY2UobikpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwp9Cgo",de.Red_mesh_fragData1="s4103:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgSW1hZ2VUZXh0dXJlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGxpZ2h0UG9zaXRpb247CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZlYzMgc2hJcnJhZGlhbmNlKHZlYzMgbm9yKQp7CiAgICB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUyRChJbWFnZVRleHR1cmUsIHRleENvb3JkKTsKICAgIHZlYzMgSW1hZ2VUZXh0dXJlX0NvbG9yX3JlcyA9IEltYWdlVGV4dHVyZV9zdG9yZS54eXo7CiAgICB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuNzc0MjM3ODcxMTcwMDQzOTQ1MzEyNSwgMC4xMzEwNDQxNDkzOTg4MDM3MTA5Mzc1LCAwLjA4ODQwNTIzNjYwMTgyOTUyODgwODU5Mzc1KTsKICAgIGZsb2F0IHJvdWdobmVzcyA9IEltYWdlVGV4dHVyZV9Db2xvcl9yZXMueDsKICAgIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgZmxvYXQgc3BlY3VsYXIgPSAxLjA7CiAgICBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGlmIChsaWdodFBvc2l0aW9uLncgPiAwLjApCiAgICB7CiAgICAgICAgdmVjMyBsUG9zID0gbGlnaHRQb3NpdGlvbi54eXogLyB2ZWMzKGxpZ2h0UG9zaXRpb24udyk7CiAgICAgICAgdmlzaWJpbGl0eSA9IDAuMDsKICAgICAgICB2aXNpYmlsaXR5ICs9IGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5KS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigtMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5ICs9IChmbG9hdCgodGV4dHVyZTJEKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wLCAwLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlMkQoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIC0wLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5IC89IDIuNTsKICAgICAgICB2aXNpYmlsaXR5ID0gbWF4KHZpc2liaWxpdHksIDAuMjAwMDAwMDAyOTgwMjMyMjM4NzY5NTMxMjUpOwogICAgfQogICAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiBzaElycmFkaWFuY2UobikpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwp9Cgo",de.Red_mesh_fragData2="s4364:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBJbWFnZVRleHR1cmU7CnVuaWZvcm0gaGlnaHAgdmVjMyBsaWdodERpcjsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgc2hhZG93TWFwOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IHNoYWRvd3NCaWFzOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMyIHRleENvb3JkOwppbiBoaWdocCB2ZWM0IGxpZ2h0UG9zaXRpb247CmluIGhpZ2hwIHZlYzMgd3Bvc2l0aW9uOwpvdXQgaGlnaHAgdmVjNCBmcmFnQ29sb3I7CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIHZlYzMgc2hJcnJhZGlhbmNlKGhpZ2hwIHZlYzMgbm9yKQp7CiAgICBoaWdocCB2ZWMzIGNsMDAgPSB2ZWMzKHNoaXJyWzBdLngsIHNoaXJyWzBdLnksIHNoaXJyWzBdLnopOwogICAgaGlnaHAgdmVjMyBjbDFtMSA9IHZlYzMoc2hpcnJbMF0udywgc2hpcnJbMV0ueCwgc2hpcnJbMV0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMTAgPSB2ZWMzKHNoaXJyWzFdLnosIHNoaXJyWzFdLncsIHNoaXJyWzJdLngpOwogICAgaGlnaHAgdmVjMyBjbDExID0gdmVjMyhzaGlyclsyXS55LCBzaGlyclsyXS56LCBzaGlyclsyXS53KTsKICAgIGhpZ2hwIHZlYzMgY2wybTIgPSB2ZWMzKHNoaXJyWzNdLngsIHNoaXJyWzNdLnksIHNoaXJyWzNdLnopOwogICAgaGlnaHAgdmVjMyBjbDJtMSA9IHZlYzMoc2hpcnJbM10udywgc2hpcnJbNF0ueCwgc2hpcnJbNF0ueSk7CiAgICBoaWdocCB2ZWMzIGNsMjAgPSB2ZWMzKHNoaXJyWzRdLnosIHNoaXJyWzRdLncsIHNoaXJyWzVdLngpOwogICAgaGlnaHAgdmVjMyBjbDIxID0gdmVjMyhzaGlycls1XS55LCBzaGlycls1XS56LCBzaGlycls1XS53KTsKICAgIGhpZ2hwIHZlYzMgY2wyMiA9IHZlYzMoc2hpcnJbNl0ueCwgc2hpcnJbNl0ueSwgc2hpcnJbNl0ueik7CiAgICByZXR1cm4gKCgoKCgoKCgoKGNsMjIgKiAwLjQyOTA0Mjk5NDk3NjA0MzcwMTE3MTg3NSkgKiAoKG5vci55ICogbm9yLnkpIC0gKCgtbm9yLnopICogKC1ub3IueikpKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAoLW5vci56KSkpICsgKCgoY2wyMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogbm9yLngpKSArICgoKGNsMm0xICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiAoLW5vci56KSkgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogKC1ub3IueikpKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWM0IEltYWdlVGV4dHVyZV9zdG9yZSA9IHRleHR1cmUoSW1hZ2VUZXh0dXJlLCB0ZXhDb29yZCk7CiAgICBoaWdocCB2ZWMzIEltYWdlVGV4dHVyZV9Db2xvcl9yZXMgPSBJbWFnZVRleHR1cmVfc3RvcmUueHl6OwogICAgaGlnaHAgdmVjMyBiYXNlY29sID0gdmVjMygwLjc3NDIzNzg3MTE3MDA0Mzk0NTMxMjUsIDAuMTMxMDQ0MTQ5Mzk4ODAzNzEwOTM3NSwgMC4wODg0MDUyMzY2MDE4Mjk1Mjg4MDg1OTM3NSk7CiAgICBoaWdocCBmbG9hdCByb3VnaG5lc3MgPSBJbWFnZVRleHR1cmVfQ29sb3JfcmVzLng7CiAgICBoaWdocCBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IHNwZWN1bGFyID0gMS4wOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICBpZiAobGlnaHRQb3NpdGlvbi53ID4gMC4wKQogICAgewogICAgICAgIGhpZ2hwIHZlYzMgbFBvcyA9IGxpZ2h0UG9zaXRpb24ueHl6IC8gdmVjMyhsaWdodFBvc2l0aW9uLncpOwogICAgICAgIHZpc2liaWxpdHkgPSAwLjA7CiAgICAgICAgdmlzaWJpbGl0eSArPSBmbG9hdCgodGV4dHVyZShzaGFkb3dNYXAsIGxQb3MueHkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoMC4wMDA0ODgyODEyNSwgMC4wKSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjUpOwogICAgICAgIHZpc2liaWxpdHkgKz0gKGZsb2F0KCh0ZXh0dXJlKHNoYWRvd01hcCwgbFBvcy54eSArIHZlYzIoLTAuMDAwNDg4MjgxMjUsIDAuMCkpLnggKyBzaGFkb3dzQmlhcykgPiBsUG9zLnopICogMC4yNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIDAuMDAwNDg4MjgxMjUpKS54ICsgc2hhZG93c0JpYXMpID4gbFBvcy56KSAqIDAuNSk7CiAgICAgICAgdmlzaWJpbGl0eSArPSAoZmxvYXQoKHRleHR1cmUoc2hhZG93TWFwLCBsUG9zLnh5ICsgdmVjMigwLjAsIC0wLjAwMDQ4ODI4MTI1KSkueCArIHNoYWRvd3NCaWFzKSA%IGxQb3MueikgKiAwLjI1KTsKICAgICAgICB2aXNpYmlsaXR5IC89IDIuNTsKICAgICAgICB2aXNpYmlsaXR5ID0gbWF4KHZpc2liaWxpdHksIDAuMjAwMDAwMDAyOTgwMjMyMjM4NzY5NTMxMjUpOwogICAgfQogICAgaGlnaHAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGZyYWdDb2xvciA9IHZlYzQoKGRpcmVjdCAqIHZpc2liaWxpdHkpICsgKChiYXNlY29sICogc2hJcnJhZGlhbmNlKG4pKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKfQoK",de.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",de.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",de.painter_colored_fragData2="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",de.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",de.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",de.painter_image_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",de.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",de.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",de.painter_text_fragData2="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",de.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",de.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",de.painter_image_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",de.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",de.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",de.painter_text_vertData2="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",de.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",de.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",de.painter_video_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",de.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",de.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",de.painter_video_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",de.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",de.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",de.painter_colored_vertData2="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",co.renderListeners=[],co.foregroundListeners=[],co.backgroundListeners=[],ve.mobile=!1,ve.ios=!1,ve.mobileAudioPlaying=!1,ve.chrome=!1,ve.firefox=!1,ve.ie=!1,ve.insideInputEvent=!1,ve.leftMouseCtrlDown=!1,ve.minimumScroll=999,ve.lastFirstTouchX=0,ve.lastFirstTouchY=0,ve.iosSoundEnabled=!1,ve.soundEnabled=!1,ve.iosTouchs=[],ye.windows=[],Ye.INVALID_BITS=-1,Ge.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],aa.fontGlyphs=function(t){for(var e=[],a=32;a<256;){var i=a++;e.push(i)}return e}(),ya.GL_RGBA16F=34842,ya.GL_RGBA32F=34836,ya.GL_R16F=33325,ya.GL_R32F=33326,ya.GL_DEPTH_COMPONENT24=33190,ya.GL_DEPTH24_STENCIL8=35056,ya.GL_DEPTH32F_STENCIL8=36013,Oa.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Oa.instances=[],Oa.connectListeners=[],Oa.disconnectListeners=[],Ua.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Ja.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},ti.bufferSize=2e3,ei.exposurePattern=new r("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),ei.formatPattern=new r("FORMAT=32-bit_rle_rgbe","i"),ei.widthHeightPattern=new r("-Y ([0-9]+) \\+X ([0-9]+)","i"),ai.todo=[],_i.loading=[],bi.nextId=0,xn.defaultFriction=.2,xn.defaultRestitution=.2,xn.defaultDensity=1,xn.defaultCollisionGroup=1,xn.defaultCollisionMask=1,xn.maxTranslationPerStep=20,xn.maxRotationPerStep=3.14159265358979,xn.bvhProxyPadding=.1,xn.bvhIncrementalCollisionThreshold=.45,xn.defaultGJKMargin=.05,xn.enableGJKCaching=!0,xn.maxEPAVertices=128,xn.contactEnableBounceThreshold=.5,xn.velocityBaumgarte=.2,xn.positionSplitImpulseBaumgarte=.4,xn.positionNgsBaumgarte=1,xn.contactUseAlternativePositionCorrectionAlgorithmDepthThreshold=.05,xn.defaultContactPositionCorrectionAlgorithm=0,xn.alternativeContactPositionCorrectionAlgorithm=1,xn.contactPersistenceThreshold=.05,xn.maxManifoldPoints=4,xn.defaultJointConstraintSolverType=0,xn.defaultJointPositionCorrectionAlgorithm=0,xn.jointWarmStartingFactorForBaungarte=.8,xn.jointWarmStartingFactor=.95,xn.maxJacobianRows=6,xn.directMlcpSolverEps=1e-9,xn.islandInitialRigidBodyArraySize=128,xn.islandInitialConstraintArraySize=128,xn.sleepingVelocityThreshold=.2,xn.sleepingAngularVelocityThreshold=.5,xn.sleepingTimeThreshold=1,xn.disableSleeping=!1,xn.linearSlop=.005,on.instance=new on,ln.SUCCEEDED=0,ln.EPA_FAILED_TO_INIT=257,ln.EPA_FAILED_TO_ADD_VERTEX=258,ln.EPA_DID_NOT_CONVERGE=259,_n.numCreations=0,Cn.broadPhaseCollisionTime=0,Cn.narrowPhaseCollisionTime=0,Cn.dynamicsTime=0,Cn.totalTime=0,Zn.BAUMGARTE=0,Zn.SPLIT_IMPULSE=1,Zn.NGS=2,ts.DYNAMIC=0,ts.STATIC=1,o.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
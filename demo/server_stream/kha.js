!function(e,t){"use strict";e.kha=e.kha||{},e.kha.input=e.kha.input||{},e.kha._Color=e.kha._Color||{};var a={},i=function(){return tt.__string_rec(this,"")};function s(e,t){function a(){}a.prototype=e;var i=new a;for(var s in t)i[s]=t[s];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}var r=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};a.EReg=r,r.__name__=!0,r.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw new et("EReg::matched")},__class__:r};var n=function(){};a.HxOverrides=n,n.__name__=!0,n.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),a=new Date;return a.setTime(0),a.setUTCHours(t[0]),a.setUTCMinutes(t[1]),a.setUTCSeconds(t[2]),a;case 10:var i=e.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var s=e.split(" "),r=s[0].split("-"),n=s[1].split(":");return new Date(r[0],r[1]-1,r[2],n[0],n[1],n[2]);default:throw new et("Invalid date format : "+e)}},n.cca=function(e,t){var a=e.charCodeAt(t);if(a==a)return a},n.substr=function(e,t,a){if(null==a)a=e.length;else if(a<0){if(0!=t)return"";a=e.length+a}return e.substr(t,a)},n.remove=function(e,t){var a=e.indexOf(t);return-1!=a&&(e.splice(a,1),!0)},n.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=function(){};a.Lambda=l,l.__name__=!0,l.exists=function(e,t){for(var a,i=((a=e)instanceof Array?function(){return n.iter(a)}:"function"==typeof a.iterator?Ci(a,a.iterator):a.iterator)();i.hasNext();){if(t(i.next()))return!0}return!1};var o=function(){this.length=0};a.List=o,o.__name__=!0,o.prototype={add:function(e){var t=new h(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},push:function(e){var t=new h(e,this.h);this.h=t,null==this.q&&(this.q=t),this.length++},first:function(){return null==this.h?null:this.h.item},iterator:function(){return new c(this.h)},__class__:o};var h=function(e,t){this.item=e,this.next=t};a["_List.ListNode"]=h,h.__name__=!0,h.prototype={__class__:h};var c=function(e){this.head=e};a["_List.ListIterator"]=c,c.__name__=!0,c.prototype={hasNext:function(){return null!=this.head},next:function(){var e=this.head.item;return this.head=this.head.next,e},__class__:c};var d=a["kha.WindowMode"]={__ename__:!0,__constructs__:["Window","BorderlessWindow","Fullscreen"]};d.Window=["Window",0],d.Window.toString=i,d.Window.__enum__=d,d.BorderlessWindow=["BorderlessWindow",1],d.BorderlessWindow.toString=i,d.BorderlessWindow.__enum__=d,d.Fullscreen=["Fullscreen",2],d.Fullscreen.toString=i,d.Fullscreen.__enum__=d;var u=function(){};a.Main=u,u.__name__=!0,u.main=function(){Ne.skinMaxBones=8,u.state=1,u.state--,u.start()},u.start=function(){u.state>0||(b.register(),u.projectWindowMode==d.Fullscreen?(u.projectWindowMode=d.BorderlessWindow,u.projectWidth=gt.width(0),u.projectHeight=gt.height(0)):(u.projectWidth=0|Math.min(u.projectWidth,gt.width(0)),u.projectHeight=0|Math.min(u.projectHeight,gt.height(0))),Bt.init({title:"poly",width:u.projectWidth,height:u.projectHeight,samplesPerPixel:4,vSync:!0,windowMode:u.projectWindowMode,resizable:!1,maximizable:!1,minimizable:!0},function(){ee.init(function(){var e=null,t=e=function(t){null!=le.active&&le.active.ready?ee.removeRender2D(e):M.render(t,he.assetsLoaded,5)};ee.notifyOnRender2D(t),le.setActive("Scene",function(e){se.setActive(A.get())})})}))},Math.__name__=!0;var g=function(){};a.Reflect=g,g.__name__=!0,g.field=function(e,t){try{return e[t]}catch(e){return null}},g.getProperty=function(e,t){var a;return null==e?null:!!e.__properties__&&(a=e.__properties__["get_"+t])?e[a]():e[t]},g.setProperty=function(e,t,a){var i;!!e.__properties__&&(i=e.__properties__["set_"+t])?e[i](a):e[t]=a},g.fields=function(e){var t=[];if(null!=e){var a=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&a.call(e,i)&&t.push(i)}return t},g.isFunction=function(e){return"function"==typeof e&&!(e.__name__||e.__ename__)};var f=function(){};a.Std=f,f.__name__=!0,f.string=function(e){return tt.__string_rec(e,"")},f.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=n.cca(e,1)&&88!=n.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t};var p=function(){};a.StringTools=p,p.__name__=!0,p.endsWith=function(e,t){var a=t.length,i=e.length;return i>=a&&n.substr(e,i-a,a)==t},p.replace=function(e,t,a){return e.split(t).join(a)};var m=function(){};a.Type=m,m.__name__=!0,m.resolveClass=function(e){var t=a[e];return null!=t&&t.__name__?t:null},m.resolveEnum=function(e){var t=a[e];return null!=t&&t.__ename__?t:null},m.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new et("Too many arguments")}},m.createEmptyInstance=function(e){function t(){}return t.prototype=e.prototype,new t},m.createEnum=function(e,t,a){var i=g.field(e,t);if(null==i)throw new et("No such constructor "+t);if(g.isFunction(i)){if(null==a)throw new et("Constructor "+t+" need parameters");return i.apply(e,a)}if(null!=a&&0!=a.length)throw new et("Constructor "+t+" does not need parameters");return i};var v={};a["_UInt.UInt_Impl_"]=v,v.__name__=!0,v.gt=function(e,t){var a=e<0;return a!=t<0?a:e>t},v.gte=function(e,t){var a=e<0;return a!=t<0?a:e>=t},v.toFloat=function(e){return e<0?4294967296+e:e+0};var _=function(){this._render2D=null,this._render=null,this._lateUpdate=null,this._update=null,this._remove=null,this._init=null,this._add=null};a["iron.Trait"]=_,_.__name__=!0,_.prototype={remove:function(){this.object.removeTrait(this)},notifyOnInit:function(e){null==this._init&&(this._init=[]),this._init.push(e),ee.notifyOnInit(e)},notifyOnUpdate:function(e){null==this._update&&(this._update=[]),this._update.push(e),ee.notifyOnUpdate(e)},__class__:_};var I=function(){_.call(this),this.notifyOnUpdate(Ci(this,this.update))};a["arm.ArcBall"]=I,I.__name__=!0,I.__super__=_,I.prototype=s(_.prototype,{update:function(){var e=je.getMouse();e.down()&&(this.object.transform.rotate(new ae(0,0,1),e.movementX/100),this.object.transform.buildMatrix())},__class__:I});var w=function(){var e=this;_.call(this),this.notifyOnInit(function(){var t=new y("https://poly.googleapis.com/v1/assets/0XrQdpjc4Vk/?key=AIzaSyAME8tuXn8gIaPcxmVaz0qbar0DkR4Kw6Q");t.onData=function(a){var i=JSON.parse(a),s=e.getFormat(i,"OBJ");if(null!=s){var r=s.root;(t=new y(r.url)).onData=Ci(e,e.makeMesh),t.request()}},t.request()})};a["arm.LoadTrait"]=w,w.__name__=!0,w.__super__=_,w.prototype=s(_.prototype,{getFormat:function(e,t){for(var a=e.formats,i=0,s=a.length;i<s;){var r=i++;if(a[r].formatType==t)return a[r]}return null},makeMesh:function(e){var t=new Ae(ei.fromBytes(x.ofString(e))),a={name:"Mesh",vertex_arrays:[{values:t.posa,attrib:"pos"},{values:t.nora,attrib:"nor"}],index_arrays:[{values:t.inda,material:0}]};new ve(a,function(e){var t=tt.__cast(le.active.getChild("Cube"),ze);t.data.delete(),t.setData(e)})},__class__:w});var b=function(){};a["armory.object.Uniforms"]=b,b.__name__=!0,b.register=function(){Re.externalTextureLinks=[b.externalTextureLink],Re.externalVec3Links=[b.externalVec3Link],Re.externalFloatLinks=[b.externalFloatLink]},b.externalTextureLink=function(e){if("_smaaSearch"==e){var t=le.active.embedded;return null!=Gi["smaa_search.png"]?t.getReserved("smaa_search.png"):t.h["smaa_search.png"]}if("_smaaArea"==e){var a=le.active.embedded;return null!=Gi["smaa_area.png"]?a.getReserved("smaa_area.png"):a.h["smaa_area.png"]}if("_lensTexture"==e){var i=le.active.embedded;return null!=Gi["lenstexture.jpg"]?i.getReserved("lenstexture.jpg"):i.h["lenstexture.jpg"]}if("_lutTexture"==e){var s=le.active.embedded;return null!=Gi["luttexture.jpg"]?s.getReserved("luttexture.jpg"):s.h["luttexture.jpg"]}if("_cloudsTexture"==e){var r=le.active.embedded;return null!=Gi["cloudstexture.png"]?r.getReserved("cloudstexture.png"):r.h["cloudstexture.png"]}return null},b.externalVec3Link=function(e){return null},b.externalFloatLink=function(e){return"_dynamicScale"==e?C.dynamicScale:0};var C=function(){};a["armory.renderpath.DynamicResolutionScale"]=C,C.__name__=!0;var A=function(){};a["armory.renderpath.RenderPathCreator"]=A,A.__name__=!0,A.get=function(){return A.path=new se,A.init(),A.path.commands=A.commands,A.path},A.init=function(){A.initEmpty()},A.commands=function(){A.path;for(var e,t=0,a=e=(le.active.lamps.length>0?le.active.lamps[A.path.currentLampIndex]:null).data.raw.shadowmap_cube?6:1;t<a;){var i=t++;e>1&&(A.path.currentFace=i),A.path.setTarget(A.getShadowMap()),A.path.clearTarget(null,1),A.path.drawMeshes("shadowmap")}A.path.currentFace=-1,A.path.setTarget(""),A.path.clearTarget(-1,1),A.bindShadowMap();A.path.drawMeshes("mesh")},A.bindShadowMap=function(){"shadowMapCube"==A.shadowMapName()?(A.path.bindTarget("arm_empty","shadowMap"),A.path.bindTarget("shadowMapCube","shadowMapCube")):(A.path.lampIsSun()||A.path.bindTarget("arm_empty_cube","shadowMapCube"),A.path.bindTarget("shadowMap","shadowMap"))},A.shadowMapName=function(){A.path;return(le.active.lamps.length>0?le.active.lamps[A.path.currentLampIndex]:null).data.raw.shadowmap_cube?"shadowMapCube":"shadowMap"},A.getShadowMap=function(){var e=A.shadowMapName(),t=A.path.renderTargets,a=null!=Gi[e]?t.getReserved(e):t.h[e];if(null==a){A.path;if((le.active.lamps.length>0?le.active.lamps[A.path.currentLampIndex]:null).data.raw.shadowmap_cube){A.path;var i=0|(le.active.lamps.length>0?le.active.lamps[A.path.currentLampIndex]:null).data.raw.shadowmap_size,s=new re;s.name=e,s.width=i,s.height=i,s.format="DEPTH16",s.is_cubemap=!0,a=A.path.createRenderTarget(s)}else{A.path;var r=(le.active.lamps.length>0?le.active.lamps[A.path.currentLampIndex]:null).data.raw.shadowmap_size,n=r,l=new re;l.name=e,l.width=r,l.height=n,l.format="DEPTH16",a=A.path.createRenderTarget(l)}}return e},A.initEmpty=function(){var e=new re;e.name="arm_empty",e.width=1,e.height=1,e.format="DEPTH16",A.path.createRenderTarget(e);var t=new re;t.name="arm_empty_cube",t.width=1,t.height=1,t.format="DEPTH16",t.is_cubemap=!0,A.path.createRenderTarget(t)};var M=function(){};a["armory.trait.internal.LoadingScreen"]=M,M.__name__=!0,M.render=function(e,t,a){e.set_color(-3200189),e.fillRect(0,Bt.windowHeight()-6,Bt.windowWidth()/a*t,6)};var B=function(){};a["haxe.IMap"]=B,B.__name__=!0;var y=function(e){this.url=e,this.headers=new o,this.params=new o,this.async=!0,this.withCredentials=!1};a["haxe.Http"]=y,y.__name__=!0,y.prototype={request:function(e){var t=this;t.responseData=null;var a=this.req=at.createXMLHttpRequest(),i=function(e){if(4==a.readyState){var i;try{i=a.status}catch(e){i=null}if(null!=i&&"undefined"!=typeof window){var s=window.location.protocol.toLowerCase();new r("^(?:about|app|app-storage|.+-extension|file|res|widget):$","").match(s)&&(i=null!=a.responseText?200:404)}if(null==i&&(i=null),null!=i&&t.onStatus(i),null!=i&&i>=200&&i<400)t.req=null,t.onData(t.responseData=a.responseText);else if(null==i)t.req=null,t.onError("Failed to connect or resolve host");else switch(i){case 12007:t.req=null,t.onError("Unknown host");break;case 12029:t.req=null,t.onError("Failed to connect to host");break;default:t.req=null,t.responseData=a.responseText,t.onError("Http Error #"+a.status)}}};this.async&&(a.onreadystatechange=i);var s=this.postData;if(null!=s)e=!0;else for(var n=this.params.h;null!=n;){var o=n.item;n=n.next;var h=o;null==s?s="":s+="&";var c=h.param,d=encodeURIComponent(c)+"=",u=h.value;s+=d+encodeURIComponent(u)}try{if(e)a.open("POST",this.url,this.async);else if(null!=s){var g=this.url.split("?").length<=1;a.open("GET",this.url+(g?"?":"&")+s,this.async),s=null}else a.open("GET",this.url,this.async)}catch(e){return e instanceof et&&(e=e.val),t.req=null,void this.onError(e.toString())}a.withCredentials=this.withCredentials,!l.exists(this.headers,function(e){return"Content-Type"==e.header})&&e&&null==this.postData&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var f=this.headers.h;null!=f;){var p=f.item;f=f.next;var m=p;a.setRequestHeader(m.header,m.value)}a.send(s),this.async||i()},onData:function(e){},onError:function(e){},onStatus:function(e){},__class__:y};var N=function(e,t){this.high=e,this.low=t};a["haxe._Int64.___Int64"]=N,N.__name__=!0,N.prototype={__class__:N};var S=function(){};a["haxe.Log"]=S,S.__name__=!0,S.trace=function(e,t){tt.__trace(e,t)};var G=function(){};a["haxe._Unserializer.DefaultResolver"]=G,G.__name__=!0,G.prototype={resolveClass:function(e){return m.resolveClass(e)},resolveEnum:function(e){return m.resolveEnum(e)},__class__:G};var k=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=k.DEFAULT_RESOLVER;null==t&&(t=new G,k.DEFAULT_RESOLVER=t),this.resolver=t};a["haxe.Unserializer"]=k,k.__name__=!0,k.initCodes=function(){for(var e=[],t=0,a=k.BASE64.length;t<a;){var i=t++;e[k.BASE64.charCodeAt(i)]=i}return e},k.run=function(e){return new k(e).unserialize()},k.prototype={readDigits:function(){for(var e=0,t=!1,a=this.pos;;){var i=this.buf.charCodeAt(this.pos);if(i!=i)break;if(45!=i){if(i<48||i>57)break;e=10*e+(i-48),this.pos++}else{if(this.pos!=a)break;t=!0,this.pos++}}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(!(t>=43&&t<58||101==t||69==t))break;this.pos++}return parseFloat(n.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new et("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new et("Invalid object key");var a=this.unserialize();e[t]=a}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new et("Invalid enum format");var a=this.readDigits();if(0==a)return m.createEnum(e,t);for(var i=[];a-- >0;)i.push(this.unserialize());return m.createEnum(e,t,i)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var e=this.unserialize(),t=this.resolver.resolveClass(e);if(null==t)throw new et("Class not found "+e);return t;case 66:var a=this.unserialize(),i=this.resolver.resolveEnum(a);if(null==i)throw new et("Enum not found "+a);return i;case 67:var s=this.unserialize(),r=this.resolver.resolveClass(s);if(null==r)throw new et("Class not found "+s);var l=m.createEmptyInstance(r);if(this.cache.push(l),l.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new et("Invalid custom data");return l;case 77:var h=new z;this.cache.push(h);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var c=this.unserialize();h.set(c,this.unserialize())}return this.pos++,h;case 82:var d=this.readDigits();if(d<0||d>=this.scache.length)throw new et("Invalid string reference");return this.scache[d];case 97:this.buf;var u=[];for(this.cache.push(u);;){var g=this.buf.charCodeAt(this.pos);if(104==g){this.pos++;break}if(117==g){this.pos++;var f=this.readDigits();u[u.length+f-1]=null}else u.push(this.unserialize())}return u;case 98:var p=new T;this.cache.push(p);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var v=this.unserialize(),_=this.unserialize();null!=Gi[v]?p.setReserved(v,_):p.h[v]=_}return this.pos++,p;case 99:var I=this.unserialize(),w=this.resolver.resolveClass(I);if(null==w)throw new et("Class not found "+I);var b=m.createEmptyInstance(w);return this.cache.push(b),this.unserializeObject(b),b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var C=this.unserialize(),A=this.resolver.resolveEnum(C);if(null==A)throw new et("Enum not found "+C);this.pos++;var M=this.readDigits(),B=A.__constructs__.slice()[M];if(null==B)throw new et("Unknown enum index "+C+"@"+M);var y=this.unserializeEnum(A,B);return this.cache.push(y),y;case 107:return NaN;case 108:var N=new o;this.cache.push(N);for(this.buf;104!=this.buf.charCodeAt(this.pos);)N.add(this.unserialize());return this.pos++,N;case 109:return-1/0;case 110:return null;case 111:var S={};return this.cache.push(S),this.unserializeObject(S),S;case 112:return 1/0;case 113:var G=new Z;this.cache.push(G);this.buf;for(var D=this.buf.charCodeAt(this.pos++);58==D;){var W=this.readDigits(),V=this.unserialize();G.h[W]=V,D=this.buf.charCodeAt(this.pos++)}if(104!=D)throw new et("Invalid IntMap format");return G;case 114:var K=this.readDigits();if(K<0||K>=this.cache.length)throw new et("Invalid reference");return this.cache[K];case 115:var F=this.readDigits(),Y=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<F)throw new et("Invalid bytes length");var H=k.CODES;null==H&&(H=k.initCodes(),k.CODES=H);for(var R=this.pos,L=3&F,X=R+(F-L),j=new x(new ki(3*(F>>2)+(L>=2?L-1:0))),E=0;R<X;){var O=H[Y.charCodeAt(R++)],U=H[Y.charCodeAt(R++)];j.b[E++]=255&(O<<2|U>>4);var P=H[Y.charCodeAt(R++)];j.b[E++]=255&(U<<4|P>>2);var Q=H[Y.charCodeAt(R++)];j.b[E++]=255&(P<<6|Q)}if(L>=2){var J=H[Y.charCodeAt(R++)],q=H[Y.charCodeAt(R++)];if(j.b[E++]=255&(J<<2|q>>4),3==L){var $=H[Y.charCodeAt(R++)];j.b[E++]=255&(q<<4|$>>2)}}return this.pos+=F,this.cache.push(j),j;case 116:return!0;case 118:var ee;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))ee=n.strDate(n.substr(this.buf,this.pos,19)),this.pos+=19;else{var te=this.readFloat();ee=new Date(te)}return this.cache.push(ee),ee;case 119:var ae=this.unserialize(),ie=this.resolver.resolveEnum(ae);if(null==ie)throw new et("Enum not found "+ae);var se=this.unserializeEnum(ie,this.unserialize());return this.cache.push(se),se;case 120:throw et.wrap(this.unserialize());case 121:var re=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<re)throw new et("Invalid string length");var ne=n.substr(this.buf,this.pos,re);return this.pos+=re,ne=decodeURIComponent(ne.split("+").join(" ")),this.scache.push(ne),ne;case 122:return 0}throw this.pos--,new et("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:k};var D=function(){this.a1=1,this.a2=0};a["haxe.crypto.Adler32"]=D,D.__name__=!0,D.read=function(e){var t=new D,a=e.readByte(),i=e.readByte(),s=e.readByte(),r=e.readByte();return t.a1=s<<8|r,t.a2=a<<8|i,t},D.prototype={update:function(e,t,a){for(var i=this.a1,s=this.a2,r=t,n=t+a;r<n;){var l=r++;s=(s+(i=(i+e.b[l])%65521))%65521}this.a1=i,this.a2=s},equals:function(e){return e.a1==this.a1&&e.a2==this.a2},__class__:D};var x=function(e){this.length=e.byteLength,this.b=new Zi(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b};a["haxe.io.Bytes"]=x,x.__name__=!0,x.ofString=function(e){for(var t=[],a=0;a<e.length;){var i=e.charCodeAt(a++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&e.charCodeAt(a++)),i<=127?t.push(i):i<=2047?(t.push(192|i>>6),t.push(128|63&i)):i<=65535?(t.push(224|i>>12),t.push(128|i>>6&63),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|i>>12&63),t.push(128|i>>6&63),t.push(128|63&i))}return new x(new Zi(t).buffer)},x.ofData=function(e){var t=e.hxBytes;return null!=t?t:new x(e)},x.prototype={blit:function(e,t,a,i){if(e<0||a<0||i<0||e+i>this.length||a+i>t.length)throw new et(L.OutsideBounds);0==a&&i==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(a,a+i),e)},sub:function(e,t){if(e<0||t<0||e+t>this.length)throw new et(L.OutsideBounds);return new x(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))},getFloat:function(e){return null==this.data&&(this.data=new Di(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)},setInt32:function(e,t){null==this.data&&(this.data=new Di(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new et(L.OutsideBounds);for(var a="",i=this.b,s=String.fromCharCode,r=e,n=e+t;r<n;){var l=i[r++];if(l<128){if(0==l)break;a+=s(l)}else if(l<224)a+=s((63&l)<<6|127&i[r++]);else if(l<240){a+=s((31&l)<<12|(127&i[r++])<<6|127&i[r++])}else{var o=(15&l)<<18|(127&i[r++])<<12|(127&i[r++])<<6|127&i[r++];a+=s(55232+(o>>10)),a+=s(1023&o|56320)}}return a},toString:function(){return this.getString(0,this.length)},__class__:x};var Z=function(){this.h={}};a["haxe.ds.IntMap"]=Z,Z.__name__=!0,Z.__interfaces__=[B],Z.prototype={__class__:Z};var z=function(){this.h={__keys__:{}}};a["haxe.ds.ObjectMap"]=z,z.__name__=!0,z.__interfaces__=[B],z.prototype={set:function(e,t){var a=e.__id__||(e.__id__=++z.count);this.h[a]=t,this.h.__keys__[a]=e},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return n.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e.__id__]}}},__class__:z};var W=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};a["haxe.ds._StringMap.StringMapIterator"]=W,W.__name__=!0,W.prototype={hasNext:function(){return this.index<this.count},next:function(){var e=this.map,t=this.keys[this.index++];return null!=Gi[t]?e.getReserved(t):e.h[t]},__class__:W};var T=function(){this.h={}};a["haxe.ds.StringMap"]=T,T.__name__=!0,T.__interfaces__=[B],T.prototype={setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return null!=Gi[e]?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e))&&(delete this.rh[e],!0)):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},__class__:T};var V=function(){this.b=[]};a["haxe.io.BytesBuffer"]=V,V.__name__=!0,V.prototype={getBytes:function(){var e=new x(new Zi(this.b).buffer);return this.b=null,e},__class__:V};var K=function(){};a["haxe.io.Input"]=K,K.__name__=!0,K.prototype={readByte:function(){throw new et("Not implemented")},readBytes:function(e,t,a){var i=a,s=e.b;if(t<0||a<0||t+a>e.length)throw new et(L.OutsideBounds);try{for(;i>0;)s[t]=this.readByte(),++t,--i}catch(e){if(e instanceof et&&(e=e.val),!tt.__instanceof(e,R))throw e}return a-i},set_bigEndian:function(e){return this.bigEndian=e,e},readFullBytes:function(e,t,a){for(;a>0;){var i=this.readBytes(e,t,a);if(0==i)throw new et(L.Blocked);t+=i,a-=i}},read:function(e){for(var t=new x(new ki(e)),a=0;e>0;){var i=this.readBytes(t,a,e);if(0==i)throw new et(L.Blocked);a+=i,e-=i}return t},readFloat:function(){return X.i32ToFloat(this.readInt32())},readDouble:function(){var e=this.readInt32(),t=this.readInt32();return this.bigEndian?X.i64ToDouble(t,e):X.i64ToDouble(e,t)},readInt8:function(){var e=this.readByte();return e>=128?e-256:e},readInt16:function(){var e=this.readByte(),t=this.readByte(),a=this.bigEndian?t|e<<8:e|t<<8;return 0!=(32768&a)?a-65536:a},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},readInt32:function(){var e=this.readByte(),t=this.readByte(),a=this.readByte(),i=this.readByte();return this.bigEndian?i|a<<8|t<<16|e<<24:e|t<<8|a<<16|i<<24},readString:function(e){var t=new x(new ki(e));return this.readFullBytes(t,0,e),t.toString()},__class__:K,__properties__:{set_bigEndian:"set_bigEndian"}};var F=function(e,t,a){if(null==t&&(t=0),null==a&&(a=e.length-t),t<0||a<0||t+a>e.length)throw new et(L.OutsideBounds);this.b=e.b,this.pos=t,this.len=a,this.totlen=a};a["haxe.io.BytesInput"]=F,F.__name__=!0,F.__super__=K,F.prototype=s(K.prototype,{set_position:function(e){return e<0?e=0:e>this.totlen&&(e=this.totlen),this.len=this.totlen-e,this.pos=e},readByte:function(){if(0==this.len)throw new et(new R);return this.len--,this.b[this.pos++]},readBytes:function(e,t,a){if(t<0||a<0||t+a>e.length)throw new et(L.OutsideBounds);if(0==this.len&&a>0)throw new et(new R);this.len<a&&(a=this.len);for(var i=this.b,s=e.b,r=0,n=a;r<n;){var l=r++;s[t+l]=i[this.pos+l]}return this.pos+=a,this.len-=a,a},__class__:F,__properties__:s(K.prototype.__properties__,{set_position:"set_position"})});var Y=function(){};a["haxe.io.Output"]=Y,Y.__name__=!0,Y.prototype={writeByte:function(e){throw new et("Not implemented")},writeBytes:function(e,t,a){if(t<0||a<0||t+a>e.length)throw new et(L.OutsideBounds);for(var i=e.b,s=a;s>0;)this.writeByte(i[t]),++t,--s;return a},write:function(e){for(var t=e.length,a=0;t>0;){var i=this.writeBytes(e,a,t);if(0==i)throw new et(L.Blocked);a+=i,t-=i}},writeFloat:function(e){this.writeInt32(X.floatToI32(e))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},__class__:Y};var H=function(){this.b=new V};a["haxe.io.BytesOutput"]=H,H.__name__=!0,H.__super__=Y,H.prototype=s(Y.prototype,{writeByte:function(e){this.b.b.push(e)},writeBytes:function(e,t,a){var i=this.b;if(t<0||a<0||t+a>e.length)throw new et(L.OutsideBounds);i.b;for(var s=e.b,r=t,n=t+a;r<n;){var l=r++;i.b.push(s[l])}return a},getBytes:function(){return this.b.getBytes()},__class__:H});var R=function(){};a["haxe.io.Eof"]=R,R.__name__=!0,R.prototype={toString:function(){return"Eof"},__class__:R};var L=a["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};L.Blocked=["Blocked",0],L.Blocked.toString=i,L.Blocked.__enum__=L,L.Overflow=["Overflow",1],L.Overflow.toString=i,L.Overflow.__enum__=L,L.OutsideBounds=["OutsideBounds",2],L.OutsideBounds.toString=i,L.OutsideBounds.__enum__=L,L.Custom=function(e){var t=["Custom",3,e];return t.__enum__=L,t.toString=i,t};var X=function(){};a["haxe.io.FPHelper"]=X,X.__name__=!0,X.i32ToFloat=function(e){var t=e>>>23&255,a=8388607&e;return 0==a&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*a)*Math.pow(2,t-127)},X.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,a=Math.floor(Math.log(t)/.6931471805599453);a<-127?a=-127:a>128&&(a=128);var i=Math.round(8388608*(t/Math.pow(2,a)-1));return 8388608==i&&a<128&&(i=0,++a),(e<0?-2147483648:0)|a+127<<23|i},X.i64ToDouble=function(e,t){var a=(t>>20&2047)-1023,i=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==i&&-1023==a?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*i)*Math.pow(2,a)},X.doubleToI64=function(e){var t=X.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var a=e<0?-e:e,i=Math.floor(Math.log(a)/.6931471805599453),s=Math.round(4503599627370496*(a/Math.pow(2,i)-1)),r=0|s,n=s/4294967296|0;t.low=r,t.high=(e<0?-2147483648:0)|i+1023<<20|n}else e>0?(t.low=0,t.high=2146435072):(t.low=0,t.high=-1048576);return t};var j={};a["haxe.io._UInt8Array.UInt8Array_Impl_"]=j,j.__name__=!0,j.fromBytes=function(e,t,a){return null==t&&(t=0),null==a&&(a=e.length-t),new Zi(e.b.bufferValue,t,a)};var E=a["haxe.zip.ExtraField"]={__ename__:!0,__constructs__:["FUnknown","FInfoZipUnicodePath","FUtf8"]};E.FUnknown=function(e,t){var a=["FUnknown",0,e,t];return a.__enum__=E,a.toString=i,a},E.FInfoZipUnicodePath=function(e,t){var a=["FInfoZipUnicodePath",1,e,t];return a.__enum__=E,a.toString=i,a},E.FUtf8=["FUtf8",2],E.FUtf8.toString=i,E.FUtf8.__enum__=E;var O=a["haxe.zip.Huffman"]={__ename__:!0,__constructs__:["Found","NeedBit","NeedBits"]};O.Found=function(e){var t=["Found",0,e];return t.__enum__=O,t.toString=i,t},O.NeedBit=function(e,t){var a=["NeedBit",1,e,t];return a.__enum__=O,a.toString=i,a},O.NeedBits=function(e,t){var a=["NeedBits",2,e,t];return a.__enum__=O,a.toString=i,a};var U=function(){};a["haxe.zip.HuffTools"]=U,U.__name__=!0,U.prototype={treeDepth:function(e){switch(e[1]){case 0:return 0;case 1:var t=e[3],a=e[2],i=this.treeDepth(a),s=this.treeDepth(t);return 1+(i<s?i:s);case 2:throw new et("assert")}},treeCompress:function(e){var t=this.treeDepth(e);if(0==t)return e;if(1==t){if(1==e[1]){var a=e[3],i=e[2];return O.NeedBit(this.treeCompress(i),this.treeCompress(a))}throw new et("assert")}for(var s=[],r=0,n=1<<t;r<n;){r++;s.push(O.Found(-1))}return this.treeWalk(s,0,0,t,e),O.NeedBits(t,s)},treeWalk:function(e,t,a,i,s){if(1==s[1]){var r=s[3],n=s[2];i>0?(this.treeWalk(e,t,a+1,i-1,n),this.treeWalk(e,t|1<<a,a+1,i-1,r)):e[t]=this.treeCompress(s)}else e[t]=this.treeCompress(s)},treeMake:function(e,t,a,i){if(i>t)throw new et("Invalid huffman");var s=a<<5|i;return e.h.hasOwnProperty(s)?O.Found(e.h[s]):(a<<=1,++i,O.NeedBit(this.treeMake(e,t,a,i),this.treeMake(e,t,1|a,i)))},make:function(e,t,a,i){var s=[],r=[];if(i>32)throw new et("Invalid huffman");for(var n=0,l=i;n<l;){n++;s.push(0),r.push(0)}for(var o=0,h=a;o<h;){var c=e[o+++t];if(c>=i)throw new et("Invalid huffman");s[c]++}for(var d=0,u=1,g=i-1;u<g;){var f=u++;d=d+s[f]<<1,r[f]=d}for(var p=new Z,m=0,v=a;m<v;){var _=m++,I=e[_+t];if(0!=I){var w=r[I-1];r[I-1]=w+1,p.h[w<<5|I]=_}}return this.treeCompress(O.NeedBit(this.treeMake(p,i,0,1),this.treeMake(p,i,1,1)))},__class__:U};var P=function(e){this.buffer=new x(new ki(65536)),this.pos=0,e&&(this.crc=new D)};a["haxe.zip._InflateImpl.Window"]=P,P.__name__=!0,P.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var e=new x(new ki(65536));this.pos-=32768,e.blit(0,this.buffer,32768,this.pos),this.buffer=e},addBytes:function(e,t,a){this.pos+a>65536&&this.slide(),this.buffer.blit(this.pos,e,t,a),this.pos+=a},addByte:function(e){65536==this.pos&&this.slide(),this.buffer.b[this.pos]=255&e,this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){return null!=this.crc&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:P};var Q=a["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:["Head","Block","CData","Flat","Crc","Dist","DistOne","Done"]};Q.Head=["Head",0],Q.Head.toString=i,Q.Head.__enum__=Q,Q.Block=["Block",1],Q.Block.toString=i,Q.Block.__enum__=Q,Q.CData=["CData",2],Q.CData.toString=i,Q.CData.__enum__=Q,Q.Flat=["Flat",3],Q.Flat.toString=i,Q.Flat.__enum__=Q,Q.Crc=["Crc",4],Q.Crc.toString=i,Q.Crc.__enum__=Q,Q.Dist=["Dist",5],Q.Dist.toString=i,Q.Dist.__enum__=Q,Q.DistOne=["DistOne",6],Q.DistOne.toString=i,Q.DistOne.__enum__=Q,Q.Done=["Done",7],Q.Done.toString=i,Q.Done.__enum__=Q;var J=function(e,t,a){null==a&&(a=!0),null==t&&(t=!0),this.final=!1,this.htools=new U,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=t?Q.Head:Q.Block,this.input=e,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[];for(var i=0;i<19;){i++;this.lengths.push(-1)}this.window=new P(a)};a["haxe.zip.InflateImpl"]=J,J.__name__=!0,J.prototype={buildFixedHuffman:function(){if(null!=J.FIXED_HUFFMAN)return J.FIXED_HUFFMAN;for(var e=[],t=0;t<288;){var a=t++;e.push(a<=143?8:a<=255?9:a<=279?7:8)}return J.FIXED_HUFFMAN=this.htools.make(e,0,288,10)},readBytes:function(e,t,a){if(this.needed=a,this.outpos=t,this.output=e,a>0)for(;this.inflateLoop(););return a-this.needed},getBits:function(e){for(;this.nbits<e;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var t=this.bits&(1<<e)-1;return this.nbits-=e,this.bits>>=e,t},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var e=1==(1&this.bits);return this.nbits--,this.bits>>=1,e},getRevBits:function(e){return 0==e?0:this.getBit()?1<<e-1|this.getRevBits(e-1):this.getRevBits(e-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(e,t,a){this.window.addBytes(e,t,a),this.output.blit(this.outpos,e,t,a),this.needed-=a,this.outpos+=a},addByte:function(e){this.window.addByte(e),this.output.b[this.outpos]=255&e,this.needed--,this.outpos++},addDistOne:function(e){for(var t=this.window.getLastChar(),a=0,i=e;a<i;){a++;this.addByte(t)}},addDist:function(e,t){this.addBytes(this.window.buffer,this.window.pos-e,t)},applyHuffman:function(e){switch(e[1]){case 0:return e[2];case 1:var t=e[3],a=e[2];return this.applyHuffman(this.getBit()?t:a);case 2:var i=e[3],s=e[2];return this.applyHuffman(i[this.getBits(s)])}},inflateLengths:function(e,t){for(var a=0,i=0;a<t;){var s=this.applyHuffman(this.huffman);switch(s){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:i=s,e[a]=s,++a;break;case 16:var r=a+3+this.getBits(2);if(r>t)throw new et("Invalid data");for(;a<r;)e[a]=i,++a;break;case 17:if((a+=3+this.getBits(3))>t)throw new et("Invalid data");break;case 18:if((a+=11+this.getBits(7))>t)throw new et("Invalid data");break;default:throw new et("Invalid data")}}},inflateLoop:function(){switch(this.state[1]){case 0:var e=this.input.readByte();if(8!=(15&e))throw new et("Invalid data");var t=this.input.readByte(),a=0!=(32&t);if(((e<<8)+t)%31!=0)throw new et("Invalid data");if(a)throw new et("Unsupported dictionary");return this.state=Q.Block,!0;case 1:switch(this.final=this.getBit(),this.getBits(2)){case 0:if(this.len=this.input.readUInt16(),this.input.readUInt16()!=65535-this.len)throw new et("Invalid data");this.state=Q.Flat;var i=this.inflateLoop();return this.resetBits(),i;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=Q.CData,!0;case 2:for(var s=this.getBits(5)+257,r=this.getBits(5)+1,n=this.getBits(4)+4,l=0,o=n;l<o;){var h=l++;this.lengths[J.CODE_LENGTHS_POS[h]]=this.getBits(3)}for(var c=n;c<19;){var d=c++;this.lengths[J.CODE_LENGTHS_POS[d]]=0}this.huffman=this.htools.make(this.lengths,0,19,8);for(var u=[],g=0,f=s+r;g<f;){g++;u.push(0)}return this.inflateLengths(u,s+r),this.huffdist=this.htools.make(u,s,r,16),this.huffman=this.htools.make(u,0,s,16),this.state=Q.CData,!0;default:throw new et("Invalid data")}break;case 2:var p=this.applyHuffman(this.huffman);if(p<256)return this.addByte(p),this.needed>0;if(256==p)return this.state=this.final?Q.Crc:Q.Block,!0;var m=J.LEN_EXTRA_BITS_TBL[p-=257];if(-1==m)throw new et("Invalid data");this.len=J.LEN_BASE_VAL_TBL[p]+this.getBits(m);var v=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);if(-1==(m=J.DIST_EXTRA_BITS_TBL[v]))throw new et("Invalid data");if(this.dist=J.DIST_BASE_VAL_TBL[v]+this.getBits(m),this.dist>this.window.available())throw new et("Invalid data");return this.state=1==this.dist?Q.DistOne:Q.Dist,!0;case 3:var _=this.len<this.needed?this.len:this.needed,I=this.input.read(_);return this.len-=_,this.addBytes(I,0,_),0==this.len&&(this.state=this.final?Q.Crc:Q.Block),this.needed>0;case 4:var w=this.window.checksum();if(null==w)return this.state=Q.Done,!0;var b=D.read(this.input);if(!w.equals(b))throw new et("Invalid CRC");return this.state=Q.Done,!0;case 5:for(;this.len>0&&this.needed>0;){var C=this.len<this.dist?this.len:this.dist,A=this.needed<C?this.needed:C;this.addDist(this.dist,A),this.len-=A}return 0==this.len&&(this.state=Q.CData),this.needed>0;case 6:var M=this.len<this.needed?this.len:this.needed;return this.addDistOne(M),this.len-=M,0==this.len&&(this.state=Q.CData),this.needed>0;case 7:return!1}},__class__:J};var q=function(e){this.i=e};a["haxe.zip.Reader"]=q,q.__name__=!0,q.readZip=function(e){return new q(e).read()},q.unzip=function(e){if(!e.compressed)return e.data;var t=new $(-15),a=new x(new ki(e.fileSize)),i=t.execute(e.data,0,a,0);if(t.close(),!i.done||i.read!=e.data.length||i.write!=e.fileSize)throw new et("Invalid compressed data for "+e.fileName);return e.compressed=!1,e.dataSize=e.fileSize,e.data=a,e.data},q.prototype={readZipDate:function(){var e=this.i.readUInt16(),t=e>>11&31,a=e>>5&63,i=31&e,s=this.i.readUInt16();return new Date((s>>9)+1980,(s>>5&15)-1,31&s,t,a,i<<1)},readExtraFields:function(e){for(var t=new o;e>0;){if(e<4)throw new et("Invalid extra fields data");var a=this.i.readUInt16(),i=this.i.readUInt16();if(e<i)throw new et("Invalid extra fields data");if(28789==a){var s=this.i.readByte();if(1!=s){var r=new V;r.b.push(s);for(var n=this.i.read(i-1),l=(r.b,n.b),h=0,c=n.length;h<c;){var d=h++;r.b.push(l[d])}t.add(E.FUnknown(a,r.getBytes()))}else{var u=this.i.readInt32(),g=this.i.read(i-5).toString();t.add(E.FInfoZipUnicodePath(g,u))}}else t.add(E.FUnknown(a,this.i.read(i)));e-=4+i}return t},readEntryHeader:function(){var e=this.i,t=e.readInt32();if(33639248==t||101010256==t)return null;if(67324752!=t)throw new et("Invalid Zip Data");e.readUInt16();var a=e.readUInt16(),i=0!=(2048&a);if(0!=(63473&a))throw new et("Unsupported flags "+a);var s=e.readUInt16(),r=0!=s;if(r&&8!=s)throw new et("Unsupported compression "+s);var n=this.readZipDate(),l=e.readInt32(),o=e.readInt32(),h=e.readInt32(),c=e.readInt16(),d=e.readInt16(),u=e.readString(c),g=this.readExtraFields(d);i&&g.push(E.FUtf8);return 0!=(8&a)&&(l=null),{fileName:u,fileSize:h,fileTime:n,compressed:r,dataSize:o,data:null,crc32:l,extraFields:g}},read:function(){for(var e=new o,t=null;;){var a=this.readEntryHeader();if(null==a)break;if(null==a.crc32){if(a.compressed){null==t&&(t=new x(new ki(65536)));for(var i=new V,s=new J(this.i,!1,!1);;){var r=s.readBytes(t,0,65536);if(r<0||r>t.length)throw new et(L.OutsideBounds);i.b;for(var n=t.b,l=0,h=r;l<h;){var c=l++;i.b.push(n[c])}if(r<65536)break}a.data=i.getBytes()}else a.data=this.i.read(a.dataSize);a.crc32=this.i.readInt32(),134695760==a.crc32&&(a.crc32=this.i.readInt32()),a.dataSize=this.i.readInt32(),a.fileSize=this.i.readInt32(),a.dataSize=a.fileSize,a.compressed=!1}else a.data=this.i.read(a.dataSize);e.add(a)}return e},__class__:q};var $=function(e){throw new et("Not implemented for this platform")};a["haxe.zip.Uncompress"]=$,$.__name__=!0,$.prototype={execute:function(e,t,a,i){return null},close:function(){},__class__:$};var ee=function(e){e(),Bt.notifyOnRender(ee.render),bt.addTimeTask(ee.update,0,.016666666666666666*qe.scale)};a["iron.App"]=ee,ee.__name__=!0,ee.init=function(e){new ee(e)},ee.update=function(){if(null!=le.active&&le.active.ready&&!ee.pauseUpdates){if($e.update(),qe.update(),le.active.updateFrame(),ee.traitInits.length>0){for(var e=0,t=ee.traitInits;e<t.length;){var a=t[e];if(++e,0==ee.traitInits.length)break;a()}ee.traitInits.splice(0,ee.traitInits.length)}for(var i=0,s=ee.traitUpdates.length;i<s;)ee.traitUpdates[i](),s<=ee.traitUpdates.length?++i:s=ee.traitUpdates.length;for(i=0,s=ee.traitLateUpdates.length;i<s;)ee.traitLateUpdates[i](),s<=ee.traitLateUpdates.length?++i:s=ee.traitLateUpdates.length;je.endFrame(),-1==ee.lastw&&(ee.lastw=Bt.windowWidth(),ee.lasth=Bt.windowHeight()),ee.lastw==Bt.windowWidth()&&ee.lasth==Bt.windowHeight()||null!=le.active&&null!=le.active.camera&&le.active.camera.buildProjection(),ee.lastw=Bt.windowWidth(),ee.lasth=Bt.windowHeight()}},ee.render=function(e){if(null!=le.active&&le.active.ready){if(ee.traitInits.length>0){for(var t=0,a=ee.traitInits;t<a.length;){var i=a[t];if(++t,0==ee.traitInits.length)break;i()}ee.traitInits.splice(0,ee.traitInits.length)}le.active.renderFrame(e.get_g4());for(var s=0,r=ee.traitRenders;s<r.length;){var n=r[s];if(++s,0==ee.traitRenders.length)break;n(e.get_g4())}ee.render2D(e)}else ee.render2D(e)},ee.render2D=function(e){if(ee.traitRenders2D.length>0){e.get_g2().begin(!1);for(var t=0,a=ee.traitRenders2D;t<a.length;){var i=a[t];if(++t,0==ee.traitRenders2D.length)break;i(e.get_g2())}e.get_g2().end()}},ee.notifyOnInit=function(e){ee.traitInits.push(e)},ee.removeInit=function(e){n.remove(ee.traitInits,e)},ee.notifyOnUpdate=function(e){ee.traitUpdates.push(e)},ee.removeUpdate=function(e){n.remove(ee.traitUpdates,e)},ee.removeLateUpdate=function(e){n.remove(ee.traitLateUpdates,e)},ee.removeRender=function(e){n.remove(ee.traitRenders,e)},ee.notifyOnRender2D=function(e){ee.traitRenders2D.push(e)},ee.removeRender2D=function(e){n.remove(ee.traitRenders2D,e)},ee.prototype={__class__:ee};var te=function(e,t,a,i,s,r,n,l,o,h,c,d,u,g,f,p){this._00=e,this._10=t,this._20=a,this._30=i,this._01=s,this._11=r,this._21=n,this._31=l,this._02=o,this._12=h,this._22=c,this._32=d,this._03=u,this._13=g,this._23=f,this._33=p};a["kha.math.FastMatrix4"]=te,te.__name__=!0,te.orthogonalProjection=function(e,t,a,i,s,r){return new te(2/(t-e),0,0,-(t+e)/(t-e),0,2/(i-a),0,-(i+a)/(i-a),0,0,-2/(r-s),-(r+s)/(r-s),0,0,0,1)},te.prototype={__class__:te};var ae=function(e,t,a,i){null==i&&(i=1),null==a&&(a=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=a,this.w=i};a["iron.math.Vec4"]=ae,ae.__name__=!0,ae.lerp=function(e,t,a){var i=new ae;return i.x=t.x+(e.x-t.x)*a,i.y=t.y+(e.y-t.y)*a,i.z=t.z+(e.z-t.z)*a,i},ae.distance3d=function(e,t){var a=e.x-t.x,i=e.y-t.y,s=e.z-t.z;return Math.sqrt(a*a+i*i+s*s)},ae.distance=function(e,t){var a=e.x-t.x,i=e.y-t.y,s=e.z-t.z;return Math.sqrt(a*a+i*i+s*s)},ae.distancef=function(e,t,a,i,s,r){var n=e-i,l=t-s,o=a-r;return Math.sqrt(n*n+l*l+o*o)},ae.xAxis=function(){return new ae(1,0,0)},ae.yAxis=function(){return new ae(0,1,0)},ae.zAxis=function(){return new ae(0,0,1)},ae.one=function(){return new ae(1,1,1)},ae.zero=function(){return new ae(0,0,0,0)},ae.back=function(){return new ae(0,-1,0)},ae.forward=function(){return new ae(0,1,0)},ae.down=function(){return new ae(0,0,-1)},ae.up=function(){return new ae(0,0,1)},ae.left=function(){return new ae(-1,0,0)},ae.right=function(){return new ae(1,0,0)},ae.negativeInfinity=function(){return new ae(-1/0,-1/0,-1/0,-1/0)},ae.positiveInfinity=function(){return new ae(1/0,1/0,1/0,1/0)},ae.prototype={cross:function(e){var t=this.y*e.z-this.z*e.y,a=this.z*e.x-this.x*e.z,i=this.x*e.y-this.y*e.x;return this.x=t,this.y=a,this.z=i,this},set:function(e,t,a,i){return null==i&&(i=1),this.x=e,this.y=t,this.z=a,this.w=i,this},addf:function(e,t,a){return this.x+=e,this.y+=t,this.z+=a,this},addvecs:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},subvecs:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(e>0){var t=1/e;this.x*=t,this.y*=t,this.z*=t}return this},mult:function(e){return this.x*=e,this.y*=e,this.z*=e,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},setFrom:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},applymat:function(e){var t=this.x,a=this.y,i=this.z;return this.x=e.self._00*t+e.self._10*a+e.self._20*i+e.self._30,this.y=e.self._01*t+e.self._11*a+e.self._21*i+e.self._31,this.z=e.self._02*t+e.self._12*a+e.self._22*i+e.self._32,this},applymat4:function(e){var t=this.x,a=this.y,i=this.z,s=this.w;return this.x=e.self._00*t+e.self._10*a+e.self._20*i+e.self._30*s,this.y=e.self._01*t+e.self._11*a+e.self._21*i+e.self._31*s,this.z=e.self._02*t+e.self._12*a+e.self._22*i+e.self._32*s,this.w=e.self._03*t+e.self._13*a+e.self._23*i+e.self._33*s,this},__class__:ae};var ie=function(e,t,a,i,s,r,n,l,o,h,c,d,u,g,f,p){this.self=new te(e,t,a,i,s,r,n,l,o,h,c,d,u,g,f,p)};a["iron.math.Mat4"]=ie,ie.__name__=!0,ie.identity=function(){return new ie(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},ie.fromFloat32Array=function(e,t){return null==t&&(t=0),new ie(e[t],e[1+t],e[2+t],e[3+t],e[4+t],e[5+t],e[6+t],e[7+t],e[8+t],e[9+t],e[10+t],e[11+t],e[12+t],e[13+t],e[14+t],e[15+t])},ie.persp=function(e,t,a,i){var s=1/Math.tan(e/2);return new ie(s/t,0,0,0,0,s,0,0,0,0,(i+a)/(a-i),2*i*a/(a-i),0,0,-1,0)},ie.ortho=function(e,t,a,i,s,r){var n=t-e,l=i-a,o=r-s;return new ie(2/n,0,0,-(t+e)/n,0,2/l,0,-(i+a)/l,0,0,-2/o,-(r+s)/o,0,0,0,1)},ie.prototype={compose:function(e,t,a){return this.fromQuaternion(t),this.scale(a),this.setLocation(e),this},decompose:function(e,t,a){ie.helpVec.w=0;var i=ie.helpVec.set(this.self._00,this.self._01,this.self._02),s=Math.sqrt(i.x*i.x+i.y*i.y+i.z*i.z),r=ie.helpVec.set(this.self._10,this.self._11,this.self._12),n=Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z),l=ie.helpVec.set(this.self._20,this.self._21,this.self._22),o=Math.sqrt(l.x*l.x+l.y*l.y+l.z*l.z),h=this.self,c=h._12,d=h._22,u=h._32,g=h._13,f=h._23,p=h._33,m=h._11*(d*p-u*f)-h._21*(c*p-u*g)+h._31*(c*f-d*g),v=h._12,_=h._22,I=h._32,w=h._13,b=h._23,C=h._33,A=h._10*(_*C-I*b)-h._20*(v*C-I*w)+h._30*(v*b-_*w),M=h._11,B=h._21,y=h._31,N=h._13,S=h._23,G=h._33,k=h._10*(B*G-y*S)-h._20*(M*G-y*N)+h._30*(M*S-B*N),D=h._11,x=h._21,Z=h._31,z=h._12,W=h._22,T=h._32,V=h._10*(x*T-Z*W)-h._20*(D*T-Z*z)+h._30*(D*W-x*z);h._00*m-h._01*A+h._02*k-h._03*V<0&&(s=-s),e.x=this.self._30,e.y=this.self._31,e.z=this.self._32,ie.helpMat.self._00=this.self._00,ie.helpMat.self._10=this.self._10,ie.helpMat.self._20=this.self._20,ie.helpMat.self._30=this.self._30,ie.helpMat.self._01=this.self._01,ie.helpMat.self._11=this.self._11,ie.helpMat.self._21=this.self._21,ie.helpMat.self._31=this.self._31,ie.helpMat.self._02=this.self._02,ie.helpMat.self._12=this.self._12,ie.helpMat.self._22=this.self._22,ie.helpMat.self._32=this.self._32,ie.helpMat.self._03=this.self._03,ie.helpMat.self._13=this.self._13,ie.helpMat.self._23=this.self._23,ie.helpMat.self._33=this.self._33;var K=1/s,F=1/n,Y=1/o;return ie.helpMat.self._00*=K,ie.helpMat.self._01*=K,ie.helpMat.self._02*=K,ie.helpMat.self._03=0,ie.helpMat.self._10*=F,ie.helpMat.self._11*=F,ie.helpMat.self._12*=F,ie.helpMat.self._13=0,ie.helpMat.self._20*=Y,ie.helpMat.self._21*=Y,ie.helpMat.self._22*=Y,ie.helpMat.self._23=0,ie.helpMat.self._30=0,ie.helpMat.self._31=0,ie.helpMat.self._32=0,ie.helpMat.self._33=0,t.fromRotationMat(ie.helpMat),a.x=s,a.y=n,a.z=o,this},setLocation:function(e){return this.self._30=e.x,this.self._31=e.y,this.self._32=e.z,this},fromQuaternion:function(e){var t=e.x,a=e.y,i=e.z,s=e.w,r=t+t,n=a+a,l=i+i,o=t*r,h=t*n,c=t*l,d=a*n,u=a*l,g=i*l,f=s*r,p=s*n,m=s*l;return this.self._00=1-(d+g),this.self._10=h-m,this.self._20=c+p,this.self._01=h+m,this.self._11=1-(o+g),this.self._21=u-f,this.self._02=c-p,this.self._12=u+f,this.self._22=1-(o+d),this.self._03=0,this.self._13=0,this.self._23=0,this.self._30=0,this.self._31=0,this.self._32=0,this.self._33=1,this},setIdentity:function(){return this.self._00=1,this.self._01=0,this.self._02=0,this.self._03=0,this.self._10=0,this.self._11=1,this.self._12=0,this.self._13=0,this.self._20=0,this.self._21=0,this.self._22=1,this.self._23=0,this.self._30=0,this.self._31=0,this.self._32=0,this.self._33=1,this},initTranslate:function(e,t,a){null==a&&(a=0),null==t&&(t=0),null==e&&(e=0),this.self._00=1,this.self._01=0,this.self._02=0,this.self._03=0,this.self._10=0,this.self._11=1,this.self._12=0,this.self._13=0,this.self._20=0,this.self._21=0,this.self._22=1,this.self._23=0,this.self._30=e,this.self._31=t,this.self._32=a,this.self._33=1},scale:function(e){this.self._00*=e.x;this.self._01*=e.x;this.self._02*=e.x;this.self._03*=e.x;this.self._10*=e.y;this.self._11*=e.y;this.self._12*=e.y;this.self._13*=e.y;this.self._20*=e.z;this.self._21*=e.z;this.self._22*=e.z;this.self._23*=e.z},multmat3x4:function(e,t){var a=e.self._00,i=e.self._01,s=e.self._02,r=e.self._10,n=e.self._11,l=e.self._12,o=e.self._20,h=e.self._21,c=e.self._22,d=e.self._30,u=e.self._31,g=e.self._32,f=t.self._00,p=t.self._01,m=t.self._02,v=t.self._10,_=t.self._11,I=t.self._12,w=t.self._20,b=t.self._21,C=t.self._22,A=t.self._30,M=t.self._31,B=t.self._32;this.self._00=a*f+i*v+s*w,this.self._01=a*p+i*_+s*b,this.self._02=a*m+i*I+s*C,this.self._03=0,this.self._10=r*f+n*v+l*w,this.self._11=r*p+n*_+l*b,this.self._12=r*m+n*I+l*C,this.self._13=0,this.self._20=o*f+h*v+c*w,this.self._21=o*p+h*_+c*b,this.self._22=o*m+h*I+c*C,this.self._23=0,this.self._30=d*f+u*v+g*w+A,this.self._31=d*p+u*_+g*b+M,this.self._32=d*m+u*I+g*C+B,this.self._33=1},multmat2:function(e){var t=this.self._00,a=this.self._01,i=this.self._02,s=this.self._03,r=this.self._10,n=this.self._11,l=this.self._12,o=this.self._13,h=this.self._20,c=this.self._21,d=this.self._22,u=this.self._23,g=this.self._30,f=this.self._31,p=this.self._32,m=this.self._33,v=e.self._00,_=e.self._01,I=e.self._02,w=e.self._03,b=e.self._10,C=e.self._11,A=e.self._12,M=e.self._13,B=e.self._20,y=e.self._21,N=e.self._22,S=e.self._23,G=e.self._30,k=e.self._31,D=e.self._32,x=e.self._33;return this.self._00=t*v+a*b+i*B+s*G,this.self._01=t*_+a*C+i*y+s*k,this.self._02=t*I+a*A+i*N+s*D,this.self._03=t*w+a*M+i*S+s*x,this.self._10=r*v+n*b+l*B+o*G,this.self._11=r*_+n*C+l*y+o*k,this.self._12=r*I+n*A+l*N+o*D,this.self._13=r*w+n*M+l*S+o*x,this.self._20=h*v+c*b+d*B+u*G,this.self._21=h*_+c*C+d*y+u*k,this.self._22=h*I+c*A+d*N+u*D,this.self._23=h*w+c*M+d*S+u*x,this.self._30=g*v+f*b+p*B+m*G,this.self._31=g*_+f*C+p*y+m*k,this.self._32=g*I+f*A+p*N+m*D,this.self._33=g*w+f*M+p*S+m*x,this},multmats:function(e,t){var a=e.self._00,i=e.self._10,s=e.self._20,r=e.self._30,n=e.self._01,l=e.self._11,o=e.self._21,h=e.self._31,c=e.self._02,d=e.self._12,u=e.self._22,g=e.self._32,f=e.self._03,p=e.self._13,m=e.self._23,v=e.self._33,_=t.self._00,I=t.self._10,w=t.self._20,b=t.self._30,C=t.self._01,A=t.self._11,M=t.self._21,B=t.self._31,y=t.self._02,N=t.self._12,S=t.self._22,G=t.self._32,k=t.self._03,D=t.self._13,x=t.self._23,Z=t.self._33;return this.self._00=a*_+i*C+s*y+r*k,this.self._10=a*I+i*A+s*N+r*D,this.self._20=a*w+i*M+s*S+r*x,this.self._30=a*b+i*B+s*G+r*Z,this.self._01=n*_+l*C+o*y+h*k,this.self._11=n*I+l*A+o*N+h*D,this.self._21=n*w+l*M+o*S+h*x,this.self._31=n*b+l*B+o*G+h*Z,this.self._02=c*_+d*C+u*y+g*k,this.self._12=c*I+d*A+u*N+g*D,this.self._22=c*w+d*M+u*S+g*x,this.self._32=c*b+d*B+u*G+g*Z,this.self._03=f*_+p*C+m*y+v*k,this.self._13=f*I+p*A+m*N+v*D,this.self._23=f*w+p*M+m*S+v*x,this.self._33=f*b+p*B+m*G+v*Z,this},getInverse:function(e){var t=e.self._00,a=e.self._10,i=e.self._20,s=e.self._30,r=e.self._01,n=e.self._11,l=e.self._21,o=e.self._31,h=e.self._02,c=e.self._12,d=e.self._22,u=e.self._32,g=e.self._03,f=e.self._13,p=e.self._23,m=e.self._33;this.self._00=l*u*f-o*d*f+o*c*p-n*u*p-l*c*m+n*d*m,this.self._10=s*d*f-i*u*f-s*c*p+a*u*p+i*c*m-a*d*m,this.self._20=i*o*f-s*l*f+s*n*p-a*o*p-i*n*m+a*l*m,this.self._30=s*l*c-i*o*c-s*n*d+a*o*d+i*n*u-a*l*u,this.self._01=o*d*g-l*u*g-o*h*p+r*u*p+l*h*m-r*d*m,this.self._11=i*u*g-s*d*g+s*h*p-t*u*p-i*h*m+t*d*m,this.self._21=s*l*g-i*o*g-s*r*p+t*o*p+i*r*m-t*l*m,this.self._31=i*o*h-s*l*h+s*r*d-t*o*d-i*r*u+t*l*u,this.self._02=n*u*g-o*c*g+o*h*f-r*u*f-n*h*m+r*c*m,this.self._12=s*c*g-a*u*g-s*h*f+t*u*f+a*h*m-t*c*m,this.self._22=a*o*g-s*n*g+s*r*f-t*o*f-a*r*m+t*n*m,this.self._32=s*n*h-a*o*h-s*r*c+t*o*c+a*r*u-t*n*u,this.self._03=l*c*g-n*d*g-l*h*f+r*d*f+n*h*p-r*c*p,this.self._13=a*d*g-i*c*g+i*h*f-t*d*f-a*h*p+t*c*p,this.self._23=i*n*g-a*l*g-i*r*f+t*l*f+a*r*p-t*n*p,this.self._33=a*l*h-i*n*h+i*r*c-t*l*c-a*r*d+t*n*d;var v=t*this.self._00+r*this.self._10+h*this.self._20+g*this.self._30;return 0==v?this.setIdentity():(this.mult(1/v),this)},transpose:function(){var e=this.self._01;this.self._01=this.self._10,this.self._10=e,e=this.self._02,this.self._02=this.self._20,this.self._20=e,e=this.self._03,this.self._03=this.self._30,this.self._30=e,e=this.self._12,this.self._12=this.self._21,this.self._21=e,e=this.self._13,this.self._13=this.self._31,this.self._31=e,e=this.self._23,this.self._23=this.self._32,this.self._32=e},transpose3x3:function(){var e=this.self._01;this.self._01=this.self._10,this.self._10=e,e=this.self._02,this.self._02=this.self._20,this.self._20=e,e=this.self._12,this.self._12=this.self._21,this.self._21=e},setF32:function(e,t){null==t&&(t=0),this.self._00=e[t],this.self._10=e[1+t],this.self._20=e[2+t],this.self._30=e[3+t],this.self._01=e[4+t],this.self._11=e[5+t],this.self._21=e[6+t],this.self._31=e[7+t],this.self._02=e[8+t],this.self._12=e[9+t],this.self._22=e[10+t],this.self._32=e[11+t],this.self._03=e[12+t],this.self._13=e[13+t],this.self._23=e[14+t],this.self._33=e[15+t]},setFrom:function(e){this.self._00=e.self._00,this.self._01=e.self._01,this.self._02=e.self._02,this.self._03=e.self._03,this.self._10=e.self._10,this.self._11=e.self._11,this.self._12=e.self._12,this.self._13=e.self._13,this.self._20=e.self._20,this.self._21=e.self._21,this.self._22=e.self._22,this.self._23=e.self._23,this.self._30=e.self._30,this.self._31=e.self._31,this.self._32=e.self._32,this.self._33=e.self._33},getScale:function(){return new ae(Math.sqrt(this.self._00*this.self._00+this.self._10*this.self._10+this.self._20*this.self._20),Math.sqrt(this.self._01*this.self._01+this.self._11*this.self._11+this.self._21*this.self._21),Math.sqrt(this.self._02*this.self._02+this.self._12*this.self._12+this.self._22*this.self._22))},mult:function(e){this.self._00*=e;this.self._10*=e;this.self._20*=e;this.self._30*=e;this.self._01*=e;this.self._11*=e;this.self._21*=e;this.self._31*=e;this.self._02*=e;this.self._12*=e;this.self._22*=e;this.self._32*=e;this.self._03*=e;this.self._13*=e;this.self._23*=e;return this.self._33*=e,this},toRotation:function(){var e=new ae,t=e.set(this.self._00,this.self._01,this.self._02),a=1/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=e.set(this.self._10,this.self._11,this.self._12),s=1/Math.sqrt(i.x*i.x+i.y*i.y+i.z*i.z),r=e.set(this.self._20,this.self._21,this.self._22),n=1/Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z);return this.self._00*=a,this.self._01*=a,this.self._02*=a,this.self._03=0,this.self._10*=s,this.self._11*=s,this.self._12*=s,this.self._13=0,this.self._20*=n,this.self._21*=n,this.self._22*=n,this.self._23=0,this.self._30=0,this.self._31=0,this.self._32=0,this.self._33=1,this},setLookAt:function(e,t,a){var i=t.x-e.x,s=t.y-e.y,r=t.z-e.z,n=1/Math.sqrt(i*i+s*s+r*r);i*=n,r*=n;var l=(s*=n)*a.z-r*a.y,o=r*a.x-i*a.z,h=i*a.y-s*a.x,c=(o*=n=1/Math.sqrt(l*l+o*o+h*h))*r-(h*=n)*s,d=h*i-(l*=n)*r,u=l*s-o*i,g=-e.x*l-e.y*o-e.z*h,f=-e.x*c-e.y*d-e.z*u,p=e.x*i+e.y*s+e.z*r;return this.self._00=l,this.self._10=o,this.self._20=h,this.self._30=g,this.self._01=c,this.self._11=d,this.self._21=u,this.self._31=f,this.self._02=-i,this.self._12=-s,this.self._22=-r,this.self._32=p,this.self._03=0,this.self._13=0,this.self._23=0,this.self._33=1,this},__class__:ie};var se=function(){this.depthBuffers=[],this.currentMaterial=null,this.depthToRenderTarget=new T,this.renderTargets=new T,this.commands=null,this.loading=0,this.paused=!1,this.lastFrameTime=0,this.viewportScaled=!1,this.scissorSet=!1,this.lastH=0,this.lastW=0,this.currentLampIndex=0,this.frameTime=0,this.frameScissorH=0,this.frameScissorW=0,this.frameScissorY=0,this.frameScissorX=0,this.frameScissor=!1};a["iron.RenderPath"]=se,se.__name__=!0,se.setActive=function(e){se.active=e},se.sortMeshes=function(e,t){for(var a=t.transform.world.self._30,i=t.transform.world.self._31,s=t.transform.world.self._32,r=0;r<e.length;){var n=e[r];++r;var l=a-n.transform.world.self._30,o=i-n.transform.world.self._31,h=s-n.transform.world.self._32;n.cameraDistance=Math.sqrt(l*l+o*o+h*h)}e.sort(function(e,t){return e.cameraDistance>=t.cameraDistance?1:-1})},se.prototype={get_ready:function(){return 0==this.loading},lampIsSun:function(){return"sun"==(le.active.lamps.length>0?le.active.lamps[this.currentLampIndex]:null).data.raw.type},renderFrame:function(e){if(this.get_ready()&&!this.paused&&0!=Bt.windowWidth()&&0!=Bt.windowHeight()){this.lastW>0&&(this.lastW!=Bt.windowWidth()||this.lastH!=Bt.windowHeight())&&this.resize(),this.lastW=Bt.windowWidth(),this.lastH=Bt.windowHeight(),this.frameTime=bt.time()-this.lastFrameTime,this.lastFrameTime=bt.time(),this.frameG=null==le.active.camera.data.mirror?e:le.active.camera.data.mirror.get_g4(),this.currentG=this.frameG,this.currentW=Bt.windowWidth(),this.currentH=Bt.windowHeight(),this.currentD=1,this.currentCube=!1,this.currentFace=-1,this.meshesSorted=!1,this.currentLampIndex=0;for(var t=0,a=le.active.lamps;t<a.length;){var i=a[t];++t,i.visible&&i.buildMatrices(le.active.camera)}this.commands()}},setTarget:function(e,t,a){if(null==a&&(a=1),""==e){this.currentG=this.frameG,this.currentW=Bt.windowWidth(),this.currentH=Bt.windowHeight(),this.currentD=1,this.currentCube=!1,this.currentFace=-1,this.frameScissor&&this.setFrameScissor(),this.currentG.begin(null)}else{var i=this.renderTargets,s=null!=Gi[e]?i.getReserved(e):i.h[e],r=null;if(null!=t){r=[];for(var n=0;n<t.length;){var l=t[n];++n;var o=this.renderTargets,h=null!=Gi[l]?o.getReserved(l):o.h[l];r.push(h.image)}}this.currentG=s.isCubeMap?s.cubeMap.get_g4():s.image.get_g4(),this.currentW=s.isCubeMap?s.cubeMap.get_width():s.image.get_width(),this.currentH=s.isCubeMap?s.cubeMap.get_height():s.image.get_height(),s.is3D&&(this.currentD=s.image.get_depth()),this.currentCube=s.isCubeMap;var c=this.currentG,d=this.currentFace;d>=0?c.beginFace(5-d):c.begin(r)}if(1!=a){this.viewportScaled=!0;var u=this.currentW*a|0,g=this.currentH*a|0;this.currentG.viewport(0,g,u,g),this.currentG.scissor(0,g,u,g)}else this.viewportScaled&&(this.viewportScaled=!1,this.setCurrentViewport(this.currentW,this.currentH),this.setCurrentScissor(this.currentW,this.currentH));this.bindParams=null},setCurrentViewport:function(e,t){this.currentG.viewport(0,this.currentH-t,e,t)},setCurrentScissor:function(e,t){this.currentG.scissor(0,this.currentH-t,e,t),this.scissorSet=!0},setFrameScissor:function(){this.frameG.scissor(this.frameScissorX,this.currentH-(this.frameScissorH-this.frameScissorY),this.frameScissorW,this.frameScissorH)},clearTarget:function(e,t){-1==e&&(e=le.active.world.raw.background_color),this.currentG.clear(e,t,null)},drawMeshes:function(e){var t=le.active.lamps.length>0?le.active.lamps[this.currentLampIndex]:null;if((null==t||t.visible||!(this.currentLampIndex>0))&&(!("shadowmap"==e)||null!=t&&t.data.raw.cast_shadow)){this.currentFace>=0&&null!=t&&t.setCubeFace(5-this.currentFace,le.active.camera);var a=this.currentG;this.submitDraw(e),a.end(),this.scissorSet&&(a.disableScissor(),this.scissorSet=!1),this.bindParams=null}},submitDraw:function(e){var t=le.active.lamps.length>0?le.active.lamps[this.currentLampIndex]:null,a=this.currentG;this.meshesSorted||(se.sortMeshes(le.active.meshes,le.active.camera),this.meshesSorted=!0);for(var i=0,s=le.active.meshes;i<s.length;){var r=s[i];++i,r.render(a,e,le.active.camera,t,this.bindParams)}},bindTarget:function(e,t){null!=this.bindParams?(this.bindParams.push(e),this.bindParams.push(t)):this.bindParams=[e,t]},resize:function(){for(var e=this.renderTargets,t=new W(e,e.arrayKeys());t.hasNext();){var a=t.next();if(0==a.raw.width&&(a.image.unload(),a.image=this.createImage(a.raw,a.depthStencil),""!=a.depthStencilFrom)){var i=a.depthStencilFrom,s=this.depthToRenderTarget;a.image.setDepthStencilFrom((null!=Gi[i]?s.getReserved(i):s.h[i]).image)}}},createRenderTarget:function(e){var t=this.createTarget(e),a=e.name,i=this.renderTargets;return null!=Gi[a]?i.setReserved(a,t):i.h[a]=t,t},createTarget:function(e){var t=new ne(e);if(null!=e.depth_buffer){t.hasDepth=!0;var a=e.depth_buffer,i=this.depthToRenderTarget,s=null!=Gi[a]?i.getReserved(a):i.h[a];if(null==s)for(var r=0,n=this.depthBuffers;r<n.length;){var l=n[r];if(++r,l.name==e.depth_buffer){var o=l.name,h=this.depthToRenderTarget;null!=Gi[o]?h.setReserved(o,t):h.h[o]=t;var c,d=l.format;if(null==d||""==d)c=1;else switch(d){case"DEPTH16":c=5;break;case"DEPTH24":c=1;break;default:c=1}t.depthStencil=c,t.image=this.createImage(e,t.depthStencil);break}}else t.depthStencil=0,t.depthStencilFrom=e.depth_buffer,t.image=this.createImage(e,t.depthStencil),t.image.setDepthStencilFrom(s.image)}else t.hasDepth=!1,null!=e.depth&&e.depth>1&&(t.is3D=!0),e.is_cubemap?(t.isCubeMap=!0,t.depthStencil=0,t.cubeMap=this.createCubeMap(e,t.depthStencil)):(t.depthStencil=0,t.image=this.createImage(e,t.depthStencil));return t},createImage:function(e,t){var a,i=0==e.width?Bt.windowWidth():e.width,s=0==e.height?Bt.windowHeight():e.height,r=null!=e.depth?e.depth:0;if(null!=e.displayp&&(i>s?(i=i*(e.displayp/s)|0,s=e.displayp):(s=s*(e.displayp/i)|0,i=e.displayp)),null!=e.scale&&(i=i*e.scale|0,s=s*e.scale|0,r=r*e.scale|0),null!=e.depth&&e.depth>1){var n;if(null!=e.format)switch(e.format){case"A16":n=Ya.A16;break;case"A32":n=Ya.A32;break;case"A8":n=Ya.L8;break;case"DEPTH16":n=Ya.DEPTH16;break;case"R16":n=Ya.A16;break;case"R32":n=Ya.A32;break;case"R8":n=Ya.L8;break;case"RGBA128":n=Ya.RGBA128;break;case"RGBA32":n=Ya.RGBA32;break;case"RGBA64":n=Ya.RGBA64;break;default:n=Ya.RGBA32}else n=Ya.RGBA32;var l=ht.create3D(i,s,r,n);return e.mipmaps&&l.generateMipmaps(1e3),l}if(null!=e.is_image&&e.is_image){var o;if(null!=e.format)switch(e.format){case"A16":o=Ya.A16;break;case"A32":o=Ya.A32;break;case"A8":o=Ya.L8;break;case"DEPTH16":o=Ya.DEPTH16;break;case"R16":o=Ya.A16;break;case"R32":o=Ya.A32;break;case"R8":o=Ya.L8;break;case"RGBA128":o=Ya.RGBA128;break;case"RGBA32":o=Ya.RGBA32;break;case"RGBA64":o=Ya.RGBA64;break;default:o=Ya.RGBA32}else o=Ya.RGBA32;return ht.create(i,s,o)}if(null!=e.format)switch(e.format){case"A16":a=Ya.A16;break;case"A32":a=Ya.A32;break;case"A8":a=Ya.L8;break;case"DEPTH16":a=Ya.DEPTH16;break;case"R16":a=Ya.A16;break;case"R32":a=Ya.A32;break;case"R8":a=Ya.L8;break;case"RGBA128":a=Ya.RGBA128;break;case"RGBA32":a=Ya.RGBA32;break;case"RGBA64":a=Ya.RGBA64;break;default:a=Ya.RGBA32}else a=Ya.RGBA32;return ht.createRenderTarget(i,s,a,t)},createCubeMap:function(e,t){var a;if(null!=e.format)switch(e.format){case"A16":a=Ya.A16;break;case"A32":a=Ya.A32;break;case"A8":a=Ya.L8;break;case"DEPTH16":a=Ya.DEPTH16;break;case"R16":a=Ya.A16;break;case"R32":a=Ya.A32;break;case"R8":a=Ya.L8;break;case"RGBA128":a=Ya.RGBA128;break;case"RGBA32":a=Ya.RGBA32;break;case"RGBA64":a=Ya.RGBA64;break;default:a=Ya.RGBA32}else a=Ya.RGBA32;return Ca.createRenderTarget(e.width,a,t)},__class__:se,__properties__:{get_ready:"get_ready"}};var re=function(){this.is_cubemap=null,this.is_image=null,this.depth=null,this.mipmaps=null,this.depth_buffer=null,this.displayp=null,this.scale=null,this.format=null};a["iron.RenderTargetRaw"]=re,re.__name__=!0,re.prototype={__class__:re};var ne=function(e){this.isCubeMap=!1,this.is3D=!1,this.hasDepth=!1,this.cubeMap=null,this.image=null,this.depthStencilFrom="",this.raw=e};a["iron.RenderTarget"]=ne,ne.__name__=!0,ne.prototype={__class__:ne};var le=function(){this.traitInits=[],this.groups=null,this.meshBatch=null,this.meshes=[],this.lamps=[],this.cameras=[],this.speakers=[],this.decals=[],this.empties=[],this.animations=[],this.armatures=[],this.embedded=new T,this.root=new Se,this.root.name="Root",this.traitInits=[],null==le.global&&(le.global=new Se)};a["iron.Scene"]=le,le.__name__=!0,le.create=function(e,t){le.active=new le,le.active.ready=!1,le.active.raw=e,he.getWorld(e.name,e.world_ref,function(a){le.active.world=a,le.active.addScene(e.name,null,function(a){0==le.active.cameras.length&&(S.trace('No camera found for scene "'+e.name+'"!',{fileName:"Scene.hx",lineNumber:91,className:"iron.Scene",methodName:"create"}),t(null)),le.active.camera=le.active.getCamera(e.camera_ref),le.active.ready=!0;for(var i=0,s=le.active.traitInits;i<s.length;){var r=s[i];++i,r()}le.active.traitInits=[],t(a)})})},le.setActive=function(e,t){le.framePassed&&(le.framePassed=!1,null!=le.active&&le.active.remove(),he.getSceneRaw(e,function(e){le.create(e,function(e){null!=t&&t(e)})}))},le.generateTranform=function(e,t){t.world=ie.fromFloat32Array(e.transform.values),t.world.decompose(t.loc,t.rot,t.scale),null!=e.local_transform_only&&(t.localOnly=e.local_transform_only),null!=t.object.parent&&t.update()},le.createTraits=function(e,t){if(null!=e)for(var a=0;a<e.length;){var i=e[a];if(++a,"Script"==i.type){var s=[];if(null!=i.parameters)for(var r=0,n=i.parameters;r<n.length;){var l=n[r];++r,s.push(le.parseArg(l))}var o=le.createTraitClassInstance(i.class_name,s);if(null==o){S.trace("Error: Trait '"+i.class_name+"' referenced in object '"+t.name+"' not found",{fileName:"Scene.hx",lineNumber:576,className:"iron.Scene",methodName:"createTraits"});continue}if(null!=i.props)for(var h=0,c=i.props.length/2|0;h<c;){var d=h++,u=i.props[2*d],f=i.props[2*d+1];""!=f&&g.setProperty(o,u,le.parseArg(f))}t.addTrait(o)}}},le.parseArg=function(e){if("true"==e)return!0;if("false"==e)return!1;if("null"==e)return null;if("'"==e.charAt(0))return p.replace(e,"'","");if('"'==e.charAt(0))return p.replace(e,'"',"");if("["==e.charAt(0)){e=p.replace(e,"[",""),e=p.replace(e,"]","");for(var t=[],a=(e=p.replace(e," ","")).split(","),i=0;i<a.length;){var s=a[i];++i,t.push(le.parseArg(s))}return t}var r=parseFloat(e),n=f.parseInt(e);return r==n?n:r},le.createConstraints=function(e,t){if(null!=e){t.constraints=[];for(var a=0;a<e.length;){var i=e[a];++a;var s=new De(i);t.constraints.push(s)}}},le.createTraitClassInstance=function(e,t){var a=m.resolveClass(e);return null==a?null:m.createInstance(a,t)},le.prototype={remove:function(){null!=this.meshBatch&&this.meshBatch.remove();for(var e=0,t=this.meshes;e<t.length;){var a=t[e];++e,a.remove()}for(var i=0,s=this.lamps;i<s.length;){var r=s[i];++i,r.remove()}for(var n=0,l=this.cameras;n<l.length;){var o=l[n];++n,o.remove()}for(var h=0,c=this.speakers;h<c.length;){var d=c[h];++h,d.remove()}for(var u=0,g=this.decals;u<g.length;){var f=g[u];++u,f.remove()}for(var p=0,m=this.empties;p<m.length;){var v=m[p];++p,v.remove()}this.groups=null,this.root.remove()},updateFrame:function(){if(this.ready){for(var e=0,t=this.animations;e<t.length;){var a=t[e];++e,a.update(.016666666666666666*qe.scale)}for(var i=0,s=this.empties;i<s.length;){var r=s[i];++i,null!=r&&null!=r.parent&&r.transform.update()}}},renderFrame:function(e){if(this.ready&&null!=se.active){le.framePassed=!0;for(var t=this.camera,a=0,i=this.cameras;a<i.length;){var s=i[a];++a,null!=s.data.mirror&&(this.camera=s,this.camera.renderFrame(e))}this.camera=t,this.camera.renderFrame(e)}},addObject:function(e){var t=new Se;return null!=e?e.addChild(t):this.root.addChild(t),t},getChild:function(e){return this.root.getChild(e)},getCamera:function(e){for(var t=0,a=this.cameras;t<a.length;){var i=a[t];if(++t,i.name==e)return i}return null},addMeshObject:function(e,t,a){var i=new ze(e,t);return null!=a?a.addChild(i):this.root.addChild(i),i},addLampObject:function(e,t){var a=new Ze(e);return null!=t?t.addChild(a):this.root.addChild(a),a},addCameraObject:function(e,t){var a=new Ge(e);return null!=t?t.addChild(a):this.root.addChild(a),a},addSpeakerObject:function(e,t){var a=new Ke(e);return null!=t?t.addChild(a):this.root.addChild(a),a},addDecalObject:function(e,t){var a=new xe(e);return null!=t?t.addChild(a):this.root.addChild(a),a},addScene:function(e,t,a){var i=this;null==t&&((t=this.addObject()).name=e),he.getSceneRaw(e,function(e){le.createTraits(e.traits,t),i.loadEmbeddedData(e.embedded_datas,function(){var s=0,r=i.getObjectsCount(e.objects),n=null;(n=function(t,a,l,o){if(null!=a)for(var h=0,c=a.length;h<c;){var d=[a[h++]];if(null==d[0].spawn||0!=d[0].spawn){var u=d[0],g=function(e){return function(t){null!=t&&n(t,e[0].children,e[0],o),(s+=1)==r&&o()}}(d);i.createObject(u,e,t,l,g)}else(s+=1)==r&&o()}})(t,e.objects,null,function(){a(t)})})})},getObjectsCount:function(e,t){null==t&&(t=!0);for(var a=e.length,i=0;i<e.length;){var s=e[i];++i,t&&null!=s.spawn&&0==s.spawn||null!=s.children&&(a+=this.getObjectsCount(s.children))}return a},spawnObject:function(e,t,a,i){null==i&&(i=!0);var s=this,r=0,n=this.getObj(this.raw,e),l=i?this.getObjectsCount([n],!1):1,o=null;(o=function(e,t,a){s.createObject(e,s.raw,t,null,function(t){if(i&&null!=e.children)for(var s=0,n=e.children;s<n.length;){var h=n[s];++s,o(h,t,a)}(r+=1)==l&&null!=a&&a(t)})})(n,t,a)},getObj:function(e,t){return this.traverseObjs(e.objects,t)},traverseObjs:function(e,t){for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i;if(null!=i.children){var s=this.traverseObjs(i.children,t);if(null!=s)return s}}return null},createObject:function(e,t,a,i,s){var r=this,n=t.name;if("camera_object"==e.type)he.getCamera(n,e.data_ref,function(t){var i=r.addCameraObject(t,a);r.returnObject(i,e,s)});else if("lamp_object"==e.type)he.getLamp(n,e.data_ref,function(t){var i=r.addLampObject(t,a);r.returnObject(i,e,s)});else if("mesh_object"==e.type)if(null==e.material_refs||0==e.material_refs.length){var l=this.addObject(a);this.returnObject(l,e,s)}else for(var o=e.material_refs.length,h=new Array(o),c=0,d=0,u=e.material_refs.length;d<u;){var g=[d++],f=e.material_refs[g[0]],p=function(t){return function(l){if(h[t[0]]=l,(c+=1)==e.material_refs.length){var o=e.data_ref.split("/"),d="",u="";if(2==o.length?(d=o[0],u=o[1]):(d=n,u=e.data_ref),null!=i&&null!=i.bone_actions)for(var g=[],f=0,p=i.bone_actions;f<p.length;){var m=p[f];++f,he.getSceneRaw(m,function(t){if(g.push(t),g.length==i.bone_actions.length){var l=new oe(i.name,g);r.armatures.push(l),r.returnMeshObject(d,u,n,l,h,a,e,s)}})}else r.returnMeshObject(d,u,n,null,h,a,e,s)}}}(g);he.getMaterial(n,f,p)}else if("speaker_object"==e.type){var m=this.addSpeakerObject(he.getSpeakerRawByName(t.speaker_datas,e.data_ref),a);this.returnObject(m,e,s)}else if("decal_object"==e.type)if(null!=e.material_refs&&e.material_refs.length>0)he.getMaterial(n,e.material_refs[0],function(t){var i=r.addDecalObject(t,a);r.returnObject(i,e,s)});else{var v=this.addDecalObject(null,a);this.returnObject(v,e,s)}else if("object"==e.type){var _=this.addObject(a);this.returnObject(_,e,function(t){if(null!=e.group_ref){var a=0,i=r.getGroupObjectRefs(e.group_ref);if(0==i.length)s(t);else for(var n=0;n<i.length;){var l=i[n];++n,r.spawnObject(l,t,function(e){(a+=1)==i.length&&s(t)})}}else s(t)})}else s(null)},getGroupObjectRefs:function(e){for(var t=0,a=this.raw.groups;t<a.length;){var i=a[t];if(++t,i.name==e)return i.object_refs}return null},returnMeshObject:function(e,t,a,i,s,r,n,l){var o=this;he.getMesh(e,t,i,function(e){var t=o.addMeshObject(e,s,r);if(null!=n.particle_refs)for(var i=0,h=n.particle_refs;i<h.length;){var c=h[i];++i,tt.__cast(t,ze).setupParticleSystem(a,c)}null!=n.tilesheet_ref&&tt.__cast(t,ze).setupTilesheet(a,n.tilesheet_ref,n.tilesheet_action_ref),o.returnObject(t,n,l)})},returnObject:function(e,t,a){var i=this;if(null!=e&&null!=t.object_actions){for(var s=[];s.length<t.object_actions.length;)s.push(null);for(var r=0,n=0,l=t.object_actions.length;n<l;){var o=[n++],h=t.object_actions[o[0]];"null"!=h?he.getSceneRaw(h,function(n){return function(l){s[n[0]]=l,(r+=1)==t.object_actions.length&&i.returnObjectLoaded(e,t,s,a)}}(o)):r+=1}}else this.returnObjectLoaded(e,t,null,a)},returnObjectLoaded:function(e,t,a,i){if(null!=e){if(e.raw=t,e.name=t.name,null!=t.visible&&(e.visible=t.visible),null!=t.visible_mesh&&(e.visibleMesh=t.visible_mesh),null!=t.visible_shadow&&(e.visibleShadow=t.visible_shadow),le.createConstraints(t.constraints,e),le.generateTranform(t,e.transform),e.setupAnimation(a),null!=t.groups){null==this.groups&&(this.groups=new T);for(var s=0,r=t.groups;s<r.length;){var n=r[s];++s;var l=this.groups,o=null!=Gi[n]?l.getReserved(n):l.h[n];if(null==o){o=[];var h=this.groups;null!=Gi[n]?h.setReserved(n,o):h.h[n]=o}o.push(e)}}le.createTraits(t.traits,e)}i(e)},loadEmbeddedData:function(e,t){var a=this;if(null!=e)for(var i=0,s=0;s<e.length;){var r=[e[s]];++s,he.getImage(r[0],function(s){return function(r){var n=a.embedded;null!=Gi[s[0]]?n.setReserved(s[0],r):n.h[s[0]]=r,(i+=1)==e.length&&t()}}(r))}else t()},notifyOnInit:function(e){this.ready?e():this.traitInits.push(e)},__class__:le};var oe=function(e,t){this.matsReady=!1,this.actions=[],this.name=e;for(var a=0;a<t.length;){var i=t[a];++a;for(var s=0,r=i.objects;s<r.length;){var n=r[s];++s,oe.setParents(n)}var l=[[]];oe.traverseBones(i.objects,function(e){return function(t){e[0].push(t)}}(l)),this.actions.push({name:i.name,bones:l[0],mats:null})}};a["iron.data.Armature"]=oe,oe.__name__=!0,oe.setParents=function(e){if(null!=e.children)for(var t=0,a=e.children;t<a.length;){var i=a[t];++t,i.parent=e,oe.setParents(i)}},oe.traverseBones=function(e,t){for(var a=0,i=e.length;a<i;){var s=a++;oe.traverseBonesStep(e[s],t)}},oe.traverseBonesStep=function(e,t){if("bone_object"==e.type&&t(e),null!=e.children)for(var a=0,i=e.children.length;a<i;){var s=a++;oe.traverseBonesStep(e.children[s],t)}},oe.prototype={initMats:function(){if(!this.matsReady){this.matsReady=!0;for(var e=0,t=this.actions;e<t.length;){var a=t[e];if(++e,null==a.mats){a.mats=[];for(var i=0,s=a.bones;i<s.length;){var r=s[i];++i,a.mats.push(ie.fromFloat32Array(r.transform.values))}}}}},getAction:function(e){for(var t=0,a=this.actions;t<a.length;){var i=a[t];if(++t,i.name==e)return i}return null},__class__:oe};var he=function(){};a["iron.data.Data"]=he,he.__name__=!0,he.getMesh=function(e,t,a,i){var s=e+t,r=he.cachedMeshes,n=null!=Gi[s]?r.getReserved(s):r.h[s];if(null==n){var l=he.loadingMeshes,o=null!=Gi[s]?l.getReserved(s):l.h[s];if(null==o){var h=he.loadingMeshes,c=e+t,d=[i];null!=Gi[c]?h.setReserved(c,d):h.h[c]=d,ve.parse(e,t,a,function(a){var i=he.cachedMeshes,r=e+t;null!=Gi[r]?i.setReserved(r,a):i.h[r]=a,a.handle=s;for(var n=0,l=he.loadingMeshes,o=e+t,h=null!=Gi[o]?l.getReserved(o):l.h[o];n<h.length;){var c=h[n];++n,c(a)}he.loadingMeshes.remove(e+t)})}else o.push(i)}else i(n)},he.getLamp=function(e,t,a){var i=he.cachedLamps,s=e+t,r=null!=Gi[s]?i.getReserved(s):i.h[s];if(null==r){var n=he.loadingLamps,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];if(null==o){var h=he.loadingLamps,c=e+t,d=[a];null!=Gi[c]?h.setReserved(c,d):h.h[c]=d,ue.parse(e,t,function(a){var i=he.cachedLamps,s=e+t;null!=Gi[s]?i.setReserved(s,a):i.h[s]=a;for(var r=0,n=he.loadingLamps,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];r<o.length;){var h=o[r];++r,h(a)}he.loadingLamps.remove(e+t)})}else o.push(a)}else a(r)},he.getCamera=function(e,t,a){var i=he.cachedCameras,s=e+t,r=null!=Gi[s]?i.getReserved(s):i.h[s];if(null==r){var n=he.loadingCameras,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];if(null==o){var h=he.loadingCameras,c=e+t,d=[a];null!=Gi[c]?h.setReserved(c,d):h.h[c]=d,ce.parse(e,t,function(a){var i=he.cachedCameras,s=e+t;null!=Gi[s]?i.setReserved(s,a):i.h[s]=a;for(var r=0,n=he.loadingCameras,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];r<o.length;){var h=o[r];++r,h(a)}he.loadingCameras.remove(e+t)})}else o.push(a)}else a(r)},he.getMaterial=function(e,t,a){var i=he.cachedMaterials,s=e+t,r=null!=Gi[s]?i.getReserved(s):i.h[s];if(null==r){var n=he.loadingMaterials,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];if(null==o){var h=he.loadingMaterials,c=e+t,d=[a];null!=Gi[c]?h.setReserved(c,d):h.h[c]=d,ge.parse(e,t,function(a){var i=he.cachedMaterials,s=e+t;null!=Gi[s]?i.setReserved(s,a):i.h[s]=a;for(var r=0,n=he.loadingMaterials,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];r<o.length;){var h=o[r];++r,h(a)}he.loadingMaterials.remove(e+t)})}else o.push(a)}else a(r)},he.getParticle=function(e,t,a){var i=he.cachedParticles,s=e+t,r=null!=Gi[s]?i.getReserved(s):i.h[s];if(null==r){var n=he.loadingParticles,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];if(null==o){var h=he.loadingParticles,c=e+t,d=[a];null!=Gi[c]?h.setReserved(c,d):h.h[c]=d,_e.parse(e,t,function(a){var i=he.cachedParticles,s=e+t;null!=Gi[s]?i.setReserved(s,a):i.h[s]=a;for(var r=0,n=he.loadingParticles,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];r<o.length;){var h=o[r];++r,h(a)}he.loadingParticles.remove(e+t)})}else o.push(a)}else a(r)},he.getWorld=function(e,t,a){if(null!=t){var i=he.cachedWorlds,s=e+t,r=null!=Gi[s]?i.getReserved(s):i.h[s];if(null==r){var n=he.loadingWorlds,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];if(null==o){var h=he.loadingWorlds,c=e+t,d=[a];null!=Gi[c]?h.setReserved(c,d):h.h[c]=d,be.parse(e,t,function(a){var i=he.cachedWorlds,s=e+t;null!=Gi[s]?i.setReserved(s,a):i.h[s]=a;for(var r=0,n=he.loadingWorlds,l=e+t,o=null!=Gi[l]?n.getReserved(l):n.h[l];r<o.length;){var h=o[r];++r,h(a)}he.loadingWorlds.remove(e+t)})}else o.push(a)}else a(r)}else a(null)},he.getShader=function(e,t,a,i){var s=t;null!=a&&(s+="2");var r=he.cachedShaders,n=null!=Gi[s]?r.getReserved(s):r.h[s];if(null==n){var l=he.loadingShaders,o=null!=Gi[s]?l.getReserved(s):l.h[s];if(null==o){var h=he.loadingShaders,c=[i];null!=Gi[s]?h.setReserved(s,c):h.h[s]=c,Ie.parse(e,t,a,function(e){var t=he.cachedShaders;null!=Gi[s]?t.setReserved(s,e):t.h[s]=e;for(var a=0,i=he.loadingShaders,r=null!=Gi[s]?i.getReserved(s):i.h[s];a<r.length;){var n=r[a];++a,n(e)}he.loadingShaders.remove(s)})}else o.push(i)}else i(n)},he.getSceneRaw=function(e,t){var a=he.cachedSceneRaws,i=null!=Gi[e]?a.getReserved(e):a.h[e];if(null==i){var s=he.loadingSceneRaws,r=null!=Gi[e]?s.getReserved(e):s.h[e];if(null==r){var n=he.loadingSceneRaws,l=[t];null!=Gi[e]?n.setReserved(e,l):n.h[e]=l;var o=p.endsWith(e,".zip"),h=p.endsWith(e,".json"),c=o||h||p.endsWith(e,".arm")?"":".arm";he.getBlob(e+c,function(t){if(o){var a=new F(t.toBytes()),i=q.readZip(a).first();if(null==i)return void S.trace("Failed to uncompress "+e,{fileName:"Data.hx",lineNumber:238,className:"iron.data.Data",methodName:"getSceneRaw"});t=i.compressed?ei.fromBytes(q.unzip(i)):ei.fromBytes(i.data)}var s=null;if(h){var r=t.toString();if("{"==r.charAt(0))s=JSON.parse(r);else{var n=new F(t.toBytes());n.set_bigEndian(!0),s=Le.read(n)}}else{var l=new F(t.toBytes());l.set_bigEndian(!0),s=Le.read(l)}he.returnSceneRaw(e,s)})}else r.push(t)}else t(i)},he.returnSceneRaw=function(e,t){var a=he.cachedSceneRaws;null!=Gi[e]?a.setReserved(e,t):a.h[e]=t;for(var i=0,s=he.loadingSceneRaws,r=null!=Gi[e]?s.getReserved(e):s.h[e];i<r.length;){var n=r[i];++i,n(t)}he.loadingSceneRaws.remove(e)},he.getMeshRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getLampRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getCameraRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getMaterialRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getParticleRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getWorldRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getShaderRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getSpeakerRawByName=function(e,t){if(""==t)return e[0];for(var a=0;a<e.length;){var i=e[a];if(++a,i.name==t)return i}return null},he.getBlob=function(e,t){var a=he.cachedBlobs,i=null!=Gi[e]?a.getReserved(e):a.h[e];if(null==i){var s=he.loadingBlobs,r=null!=Gi[e]?s.getReserved(e):s.h[e];if(null==r){var n=he.loadingBlobs,l=[t];null!=Gi[e]?n.setReserved(e,l):n.h[e]=l;var o={files:[e]};_t.loadBlobFromDescription(o,function(t){var a=he.cachedBlobs;null!=Gi[e]?a.setReserved(e,t):a.h[e]=t;for(var i=0,s=he.loadingBlobs,r=null!=Gi[e]?s.getReserved(e):s.h[e];i<r.length;){var n=r[i];++i,n(t)}he.loadingBlobs.remove(e),he.assetsLoaded++})}else r.push(t)}else t(i)},he.getImage=function(e,t,a,i){null==i&&(i="RGBA32"),null==a&&(a=!1);var s=he.cachedImages,r=null!=Gi[e]?s.getReserved(e):s.h[e];if(null==r){var n=he.loadingImages,l=null!=Gi[e]?n.getReserved(e):n.h[e];if(null==l){var o=he.loadingImages,h=[t];null!=Gi[e]?o.setReserved(e,h):o.h[e]=h;var c={files:[e],readable:a,format:i};_t.loadImageFromDescription(c,function(t){var a=he.cachedImages;null!=Gi[e]?a.setReserved(e,t):a.h[e]=t;for(var i=0,s=he.loadingImages,r=null!=Gi[e]?s.getReserved(e):s.h[e];i<r.length;){var n=r[i];++i,n(t)}he.loadingImages.remove(e),he.assetsLoaded++})}else l.push(t)}else t(r)},he.getSound=function(e,t){p.endsWith(e,".wav")&&(e=e.substring(0,e.length-4)+".ogg");var a=he.cachedSounds,i=null!=Gi[e]?a.getReserved(e):a.h[e];if(null==i){var s=he.loadingSounds,r=null!=Gi[e]?s.getReserved(e):s.h[e];if(null==r){var n=he.loadingSounds,l=[t];null!=Gi[e]?n.setReserved(e,l):n.h[e]=l;var o={files:[e]};_t.loadSoundFromDescription(o,function(t){t.uncompress(function(){var a=he.cachedSounds;null!=Gi[e]?a.setReserved(e,t):a.h[e]=t;for(var i=0,s=he.loadingSounds,r=null!=Gi[e]?s.getReserved(e):s.h[e];i<r.length;){var n=r[i];++i,n(t)}he.loadingSounds.remove(e),he.assetsLoaded++})})}else r.push(t)}else t(i)},he.prototype={__class__:he};var ce=function(e,t,a){null==a&&(a=""),this.mirror=null,he.call(this),this.raw=e,this.name=e.name,e.render_to_texture&&(this.mirror=ht.createRenderTarget(e.texture_resolution_x,e.texture_resolution_y,Ya.RGBA32,0)),t(this)};a["iron.data.CameraData"]=ce,ce.__name__=!0,ce.parse=function(e,t,a){he.getSceneRaw(e,function(i){var s=he.getCameraRawByName(i.camera_datas,t);null==s&&(S.trace('Camera data "'+t+'" not found!',{fileName:"CameraData.hx",lineNumber:30,className:"iron.data.CameraData",methodName:"parse"}),a(null)),new ce(s,a,e)})},ce.__super__=he,ce.prototype=s(he.prototype,{__class__:ce});var de=function(e,t,a,i,s,r,n,l,o,h,c,d){this.mats=null,this.actions=null,this.skeletonBoneRefs=null,this.skeletonTransformsI=null,this.skinBoneWeights=null,this.skinBoneIndices=null,this.skinBoneCounts=null,this.instanceCount=0,this.instanced=!1,this.instancedVB=null,this.numTris=0,this.ready=!1,null==c&&(c=Ra.StaticUsage),this.indices=e,this.materialIndices=t,this.usage=c,this.positions=a,this.normals=i,this.uvs=s,this.uvs1=r,this.cols=n,this.tangents=l,this.bones=o,this.weights=h,this.instanceOffsets=d,this.struct=de.getVertexStructure(null!=a,null!=i,null!=s,null!=r,null!=n,null!=l,null!=o,null!=h),this.structLength=this.struct.byteSize()/4|0};a["iron.data.Geometry"]=de,de.__name__=!0,de.getVertexStructure=function(e,t,a,i,s,r,n,l){null==l&&(l=!1),null==n&&(n=!1),null==r&&(r=!1),null==s&&(s=!1),null==i&&(i=!1),null==a&&(a=!1),null==t&&(t=!1),null==e&&(e=!1);var o=new Oa;return e&&o.add("pos",Xa.Float3),t&&o.add("nor",Xa.Float3),a&&o.add("tex",Xa.Float2),i&&o.add("tex1",Xa.Float2),s&&o.add("col",Xa.Float3),r&&o.add("tang",Xa.Float3),n&&o.add("bone",Xa.Float4),l&&o.add("weight",Xa.Float4),o},de.buildVertices=function(e,t,a,i,s,r,n,l,o,h){null==h&&(h=0);for(var c=-1+h,d=0,u=t.length/3|0;d<u;){var g=d++;e[++c]=t[3*g],e[++c]=t[3*g+1],e[++c]=t[3*g+2],null!=a&&(e[++c]=a[3*g],e[++c]=a[3*g+1],e[++c]=a[3*g+2]),null!=i&&(e[++c]=i[2*g],e[++c]=i[2*g+1]),null!=s&&(e[++c]=s[2*g],e[++c]=s[2*g+1]),null!=r&&(e[++c]=r[3*g],e[++c]=r[3*g+1],e[++c]=r[3*g+2]),null!=n&&(e[++c]=n[3*g],e[++c]=n[3*g+1],e[++c]=n[3*g+2]),null!=l&&(e[++c]=l[4*g],e[++c]=l[4*g+1],e[++c]=l[4*g+2],e[++c]=l[4*g+3]),null!=o&&(e[++c]=o[4*g],e[++c]=o[4*g+1],e[++c]=o[4*g+2],e[++c]=o[4*g+3])}},de.prototype={delete:function(){this.vertexBuffer.delete();for(var e=0,t=this.indexBuffers;e<t.length;){var a=t[e];++e,a.delete()}},applyScale:function(e,t,a){for(var i=this.vertexBuffer.lock(),s=0,r=i.length/this.structLength|0;s<r;){var n=s++;i[n*this.structLength]*=e,i[n*this.structLength+1]*=t,i[n*this.structLength+2]*=a}this.vertexBuffer.unlock()},setupInstanced:function(e,t){this.offsetVecs=[];for(var a=0,i=e.length/3|0;a<i;){var s=a++;this.offsetVecs.push(new ae(e[3*s],e[3*s+1],e[3*s+2]))}this.instanced=!0,this.instanceCount=e.length/3|0;var r=new Oa;r.instanced=!0,r.add("off",Xa.Float3),this.instancedVB=new La(this.instanceCount,r,t,1);for(var n=this.instancedVB.lock(),l=0,o=n.length;l<o;){var h=l++;n[h]=e[h]}this.instancedVB.unlock()},build:function(){if(!this.ready){this.vertexBuffer=new La(this.positions.length/3|0,this.struct,this.usage),this.vertices=this.vertexBuffer.lock(),de.buildVertices(this.vertices,this.positions,this.normals,this.uvs,this.uvs1,this.cols,this.tangents,this.bones,this.weights),this.vertexBuffer.unlock(),this.indexBuffers=[];for(var e=0,t=this.indices;e<t.length;){var a=t[e];if(++e,0!=a.length){var i=new Da(a.length,this.usage);this.numTris+=a.length/3|0,i._data=a,i.unlock(),this.indexBuffers.push(i)}}null!=this.instanceOffsets&&this.setupInstanced(this.instanceOffsets,this.usage),this.ready=!0}},setArmature:function(e){for(var t=0,a=e.actions;t<a.length;){var i=a[t];++t,this.addAction(i.bones,i.name)}},addAction:function(e,t){if(null!=e){null==this.actions&&(this.actions=new T,this.mats=new T);for(var a=[],i=0,s=this.skeletonBoneRefs;i<s.length;){var r=s[i];++i;for(var n=0;n<e.length;){var l=e[n];++n,l.name==r&&a.push(l)}}var o=this.actions;null!=Gi[t]?o.setReserved(t,a):o.h[t]=a;for(var h=[],c=0;c<a.length;){var d=a[c];++c,h.push(ie.fromFloat32Array(d.transform.values))}var u=this.mats;null!=Gi[t]?u.setReserved(t,h):u.h[t]=h}},initSkeletonTransforms:function(e){this.skeletonTransformsI=[];for(var t=0;t<e.length;){var a=e[t];++t;var i=ie.fromFloat32Array(a);this.skeletonTransformsI.push(i)}},__class__:de};var ue=function(e,t){this.colorTexture=null;var a=this;he.call(this),this.raw=e,this.name=e.name,null!=e.color_texture?he.getImage(e.color_texture,function(e){a.colorTexture=e,t(a)}):t(this)};a["iron.data.LampData"]=ue,ue.__name__=!0,ue.parse=function(e,t,a){he.getSceneRaw(e,function(e){var i=he.getLampRawByName(e.lamp_datas,t);null==i&&(S.trace('Lamp data "'+t+'" not found!',{fileName:"LampData.hx",lineNumber:42,className:"iron.data.LampData",methodName:"parse"}),a(null)),new ue(i,a)})},ue.__super__=he,ue.prototype=s(he.prototype,{__class__:ue});var ge=function(e,t,a){null==a&&(a=""),this.contexts=null;var i=this;he.call(this),this.uid=++ge.uidCounter,this.raw=e,this.name=e.name;var s=e.shader.split("/"),r="",n="";2==s.length?(r=s[0],n=s[1]):(r=a,n=e.shader),he.getShader(r,n,e.override_context,function(a){for(i.shader=a,i.contexts=[];i.contexts.length<e.contexts.length;)i.contexts.push(null);for(var s=0,r=0,n=e.contexts.length;r<n;){var l=[r++],o=e.contexts[l[0]];new fe(o,function(a){return function(r){i.contexts[a[0]]=r,(s+=1)==e.contexts.length&&t(i)}}(l))}})};a["iron.data.MaterialData"]=ge,ge.__name__=!0,ge.parse=function(e,t,a){he.getSceneRaw(e,function(i){var s=he.getMaterialRawByName(i.material_datas,t);null==s&&(S.trace('Material data "'+t+'" not found!',{fileName:"MaterialData.hx",lineNumber:61,className:"iron.data.MaterialData",methodName:"parse"}),a(null)),new ge(s,a,e)})},ge.__super__=he,ge.prototype=s(he.prototype,{getContext:function(e){for(var t=0,a=this.contexts;t<a.length;){var i=a[t];if(++t,n.substr(i.raw.name,0,e.length)==e)return i}return null},__class__:ge});var fe=function(e,t){this.id=0,this.textures=null;var a=this;if(this.raw=e,this.id=fe.num++,null!=e.bind_textures&&e.bind_textures.length>0){var i=e.bind_textures.length,s=new Array(i);this.textures=s;for(var r=0,n=0,l=e.bind_textures.length;n<l;){var o=[n++],h=[e.bind_textures[o[0]]];""!=h[0].file?he.getImage(h[0].file,function(i,s){return function(n){if(a.textures[s[0]]=n,r+=1,null!=i[0].mipmaps){for(var l=[];l.length<i[0].mipmaps.length;)l.push(null);for(var o=0,h=0,c=i[0].mipmaps.length;h<c;){var d=[h++],u=i[0].mipmaps[d[0]];he.getImage(u,function(i,s){return function(h){l[i[0]]=h,(o+=1)==s[0].mipmaps.length&&(n.setMipmaps(l),s[0].mipmaps=null,s[0].generate_mipmaps=!1,r==e.bind_textures.length&&t(a))}}(d,i))}}else 1==i[0].generate_mipmaps&&null!=n?(n.generateMipmaps(1e3),i[0].mipmaps=null,i[0].generate_mipmaps=!1,r==e.bind_textures.length&&t(a)):r==e.bind_textures.length&&t(a)}}(h,o),!1,null!=h[0].format?h[0].format:"RGBA32"):(r+=1)==e.bind_textures.length&&t(this)}}else t(this)};a["iron.data.MaterialContext"]=fe,fe.__name__=!0,fe.prototype={setTextureParameters:function(e,t,a,i){a.paramsSet[i]||(a.setTextureParameters(e,i,this.raw.bind_textures[t]),a.paramsSet[i]=!0)},__class__:fe};var pe=function(){this.buckets=new z};a["iron.data.MeshBatch"]=pe,pe.__name__=!0,pe.prototype={remove:function(){for(var e=this.buckets.iterator();e.hasNext();){e.next();this.remove()}},__class__:pe};var me=function(){};a["iron.data.Bucket"]=me,me.__name__=!0;var ve=function(e,t){this.refcount=0,he.call(this),this.raw=e,this.name=e.name;for(var a=[],i=[],s=0,r=e.index_arrays;s<r.length;){var n=r[s];++s,a.push(n.values),i.push(n.material)}var l=this.getVertexArrayValues("pos"),o=this.getVertexArrayValues("nor"),h=this.getVertexArrayValues("tex"),c=this.getVertexArrayValues("tex1"),d=this.getVertexArrayValues("col"),u=this.getVertexArrayValues("tang");this.isSkinned=null!=e.skin;var g=Ra.StaticUsage;null!=e.dynamic_usage&&1==e.dynamic_usage&&(g=Ra.DynamicUsage);var f=g,p=null,m=null;if(this.isSkinned){var v=4*(l.length/3|0);p=new xi(v),m=new xi(v);for(var _=0,I=0,w=0,b=l.length/3|0;w<b;){for(var C=w++,A=e.skin.bone_count_array[C],M=_,B=_+A;M<B;){var y=M++;p[I]=e.skin.bone_index_array[y],m[I]=e.skin.bone_weight_array[y],++I}for(var N=A;N<4;){N++;p[I]=0,m[I]=0,++I}_+=A}}this.geom=new de(a,i,l,o,h,c,d,u,p,m,f,e.instance_offsets),t(this)};a["iron.data.MeshData"]=ve,ve.__name__=!0,ve.parse=function(e,t,a,i){he.getSceneRaw(e,function(e){var s=he.getMeshRawByName(e.mesh_datas,t);null==s&&(S.trace('Mesh data "'+t+'" not found!',{fileName:"MeshData.hx",lineNumber:105,className:"iron.data.MeshData",methodName:"parse"}),i(null)),new ve(s,function(t){null!=s.skin&&(t.geom.skinBoneCounts=s.skin.bone_count_array,t.geom.skinBoneIndices=s.skin.bone_index_array,t.geom.skinBoneWeights=s.skin.bone_weight_array,t.geom.skeletonBoneRefs=s.skin.skeleton.bone_ref_array,t.geom.initSkeletonTransforms(s.skin.skeleton.transformsI),null!=a?t.geom.setArmature(a):t.geom.addAction(e.objects,"none")),i(t)})})},ve.__super__=he,ve.prototype=s(he.prototype,{delete:function(){this.geom.delete()},getVertexArrayValues:function(e){for(var t=0,a=this.raw.vertex_arrays;t<a.length;){var i=a[t];if(++t,i.attrib==e)return i.values}return null},__class__:ve});var _e=function(e,t){he.call(this),this.raw=e,this.name=e.name,t(this)};a["iron.data.ParticleData"]=_e,_e.__name__=!0,_e.parse=function(e,t,a){he.getSceneRaw(e,function(e){var i=he.getParticleRawByName(e.particle_datas,t);null==i&&(S.trace('Particle data "'+t+'" not found!',{fileName:"ParticleData.hx",lineNumber:23,className:"iron.data.ParticleData",methodName:"parse"}),a(null)),new _e(i,a)})},_e.__super__=he,_e.prototype=s(he.prototype,{__class__:_e});var Ie=function(e,t,a){this.contexts=[];var i=this;he.call(this),this.raw=e,this.name=e.name;for(var s=0,r=e.contexts;s<r.length;){r[s];++s,this.contexts.push(null)}for(var n=0,l=0,o=e.contexts.length;l<o;){var h=[l++],c=e.contexts[h[0]];new we(c,t,function(t){return function(s){i.contexts[t[0]]=s,(n+=1)==e.contexts.length&&a(i)}}(h))}};a["iron.data.ShaderData"]=Ie,Ie.__name__=!0,Ie.parse=function(e,t,a,i){he.getSceneRaw(e,function(e){var s=he.getShaderRawByName(e.shader_datas,t);null==s&&(S.trace('Shader data "'+t+'" not found!',{fileName:"ShaderData.hx",lineNumber:49,className:"iron.data.ShaderData",methodName:"parse"}),i(null)),new Ie(s,a,i)})},Ie.__super__=he,Ie.prototype=s(he.prototype,{getContext:function(e){for(var t=0,a=this.contexts;t<a.length;){var i=a[t];if(++t,i.raw.name==e)return i}return null},__class__:Ie});var we=function(e,t,a){this.instancing=!1,this.raw=e,this.overrideContext=t,"rect"==e.name?(this.structure=we.getStructureRect(),this.instancing=!1):this.parseVertexStructure(),this.compile(a)};a["iron.data.ShaderContext"]=we,we.__name__=!0,we.getStructureRect=function(){return null==we.structureRect&&(we.structureRect=new Oa,we.structureRect.add("pos",Xa.Float2)),we.structureRect},we.prototype={compile:function(e){if(null!=this.pipeState&&this.pipeState.delete(),this.pipeState=new za,this.constants=[],this.textureUnits=[],this.paramsSet=[],this.instancing){var t=new Oa;t.add("off",Xa.Float3),t.instanced=!0,this.pipeState.inputLayout=[this.structure,t]}else this.pipeState.inputLayout=[this.structure];if(this.pipeState.depthWrite=this.raw.depth_write,this.pipeState.depthMode=this.getCompareMode(this.raw.compare_mode),null!=this.raw.stencil_mode&&("always"==this.raw.stencil_mode?this.pipeState.stencilMode=wa.Always:"equal"==this.raw.stencil_mode?this.pipeState.stencilMode=wa.Equal:"not_equal"==this.raw.stencil_mode&&(this.pipeState.stencilMode=wa.NotEqual)),null!=this.raw.stencil_pass&&("replace"==this.raw.stencil_pass?this.pipeState.stencilBothPass=Wa.Replace:"keep"==this.raw.stencil_pass&&(this.pipeState.stencilBothPass=Wa.Keep)),null!=this.raw.stencil_fail&&"keep"==this.raw.stencil_fail&&(this.pipeState.stencilDepthFail=Wa.Keep,this.pipeState.stencilFail=Wa.Keep),null!=this.raw.stencil_reference_value&&(this.pipeState.stencilReferenceValue=this.raw.stencil_reference_value),this.pipeState.cullMode=this.getCullMode(this.raw.cull_mode),null!=this.raw.blend_source&&(this.pipeState.blendSource=this.getBlendingFactor(this.raw.blend_source)),null!=this.raw.blend_destination&&(this.pipeState.blendDestination=this.getBlendingFactor(this.raw.blend_destination)),null!=this.raw.blend_operation&&(this.pipeState.blendOperation=this.getBlendingOperation(this.raw.blend_operation)),null!=this.raw.alpha_blend_source&&(this.pipeState.alphaBlendSource=this.getBlendingFactor(this.raw.alpha_blend_source)),null!=this.raw.alpha_blend_destination&&(this.pipeState.alphaBlendDestination=this.getBlendingFactor(this.raw.alpha_blend_destination)),null!=this.raw.alpha_blend_operation&&(this.pipeState.alphaBlendOperation=this.getBlendingOperation(this.raw.alpha_blend_operation)),null!=this.raw.color_write_red&&(this.pipeState.colorWriteMaskRed=this.raw.color_write_red),null!=this.raw.color_write_green&&(this.pipeState.colorWriteMaskGreen=this.raw.color_write_green),null!=this.raw.color_write_blue&&(this.pipeState.colorWriteMaskBlue=this.raw.color_write_blue),null!=this.raw.color_write_alpha&&(this.pipeState.colorWriteMaskAlpha=this.raw.color_write_alpha),null!=this.raw.conservative_raster&&(this.pipeState.conservativeRasterization=this.raw.conservative_raster),this.raw.shader_from_source)this.pipeState.fragmentShader=Ma.fromSource(this.raw.fragment_shader),this.pipeState.vertexShader=Ea.fromSource(this.raw.vertex_shader),this.finishCompile(e);else{var a=p.replace(this.raw.fragment_shader,".","_");this.pipeState.fragmentShader=g.field(At,a);var i=p.replace(this.raw.vertex_shader,".","_");if(this.pipeState.vertexShader=g.field(At,i),null!=this.raw.geometry_shader){var s=p.replace(this.raw.geometry_shader,".","_");this.pipeState.geometryShader=g.field(At,s)}if(null!=this.raw.tesscontrol_shader){var r=p.replace(this.raw.tesscontrol_shader,".","_");this.pipeState.tessellationControlShader=g.field(At,r)}if(null!=this.raw.tesseval_shader){var n=p.replace(this.raw.tesseval_shader,".","_");this.pipeState.tessellationEvaluationShader=g.field(At,n)}this.finishCompile(e)}},finishCompile:function(e){if(null!=this.overrideContext&&null!=this.overrideContext.cull_mode&&(this.pipeState.cullMode=this.getCullMode(this.overrideContext.cull_mode)),this.pipeState.compile(),null!=this.raw.constants)for(var t=0,a=this.raw.constants;t<a.length;){var i=a[t];++t,this.addConstant(i)}if(null!=this.raw.texture_units)for(var s=0,r=this.raw.texture_units;s<r.length;){var n=r[s];++s,this.addTexture(n)}e(this)},sizeToVD:function(e){return 1==e?Xa.Float1:2==e?Xa.Float2:3==e?Xa.Float3:4==e?Xa.Float4:null},parseVertexStructure:function(){this.structure=new Oa;for(var e=0,t=this.raw.vertex_structure;e<t.length;){var a=t[e];++e,"off"!=a.name?this.structure.add(a.name,this.sizeToVD(a.size)):this.instancing=!0}},getCompareMode:function(e){switch(e){case"always":return wa.Always;case"equal":return wa.Equal;case"greater":return wa.Greater;case"greater_equal":return wa.GreaterEqual;case"less":return wa.Less;case"less_equal":return wa.LessEqual;case"never":return wa.Never;case"not_equal":return wa.NotEqual;default:return wa.Less}},getCullMode:function(e){switch(e){case"clockwise":return Aa.Clockwise;case"none":return Aa.None;default:return Aa.CounterClockwise}},getBlendingOperation:function(e){switch(e){case"add":return Ia.Add;case"max":return Ia.Max;case"min":return Ia.Min;case"reverse_substract":return Ia.ReverseSubtract;case"substract":return Ia.Subtract;default:return Ia.Add}},getBlendingFactor:function(e){switch(e){case"blend_one":return _a.BlendOne;case"blend_zero":return _a.BlendZero;case"destination_alpha":return _a.DestinationAlpha;case"destination_color":return _a.DestinationColor;case"inverse_destination_alpha":return _a.InverseDestinationAlpha;case"inverse_destination_color":return _a.InverseDestinationColor;case"inverse_source_alpha":return _a.InverseSourceAlpha;case"inverse_source_color":return _a.InverseSourceColor;case"source_alpha":return _a.SourceAlpha;case"source_color":return _a.SourceColor;default:return _a.Undefined}},getTextureAddresing:function(e){switch(e){case"mirror":return Ka.Mirror;case"repeat":return Ka.Repeat;default:return Ka.Clamp}},getTextureFilter:function(e){switch(e){case"linear":return Fa.LinearFilter;case"point":return Fa.PointFilter;default:return Fa.AnisotropicFilter}},getMipmapFilter:function(e){switch(e){case"no":return xa.NoMipFilter;case"point":return xa.PointMipFilter;default:return xa.LinearMipFilter}},addConstant:function(e){this.constants.push(this.pipeState.getConstantLocation(e.name))},addTexture:function(e){var t=this.pipeState.getTextureUnit(e.name);this.textureUnits.push(t),this.paramsSet.push(!1)},setTextureParameters:function(e,t,a){var i=this.textureUnits[t];e.setTextureParameters(i,null==a.u_addressing?Ka.Repeat:this.getTextureAddresing(a.u_addressing),null==a.v_addressing?Ka.Repeat:this.getTextureAddresing(a.v_addressing),null==a.min_filter?Fa.LinearFilter:this.getTextureFilter(a.min_filter),null==a.mag_filter?Fa.LinearFilter:this.getTextureFilter(a.mag_filter),null==a.mipmap_filter?xa.NoMipFilter:this.getMipmapFilter(a.mipmap_filter))},__class__:we};var be=function(e,t){this.vec=new ae,this.shirr=null;var a=this;if(he.call(this),this.raw=e,this.name=e.name,null!=e.probes&&e.probes.length>0){this.probes=[];for(var i=0,s=e.probes;i<s.length;){var r=s[i];++i,new Ce(r,function(i){a.probes.push(i),a.probes.length==e.probes.length&&a.loadEnvmap(t)})}}else this.loadEnvmap(t)};a["iron.data.WorldData"]=be,be.__name__=!0,be.parse=function(e,t,a){he.getSceneRaw(e,function(e){var i=he.getWorldRawByName(e.world_datas,t);null==i&&(S.trace('World data "'+t+'" not found!',{fileName:"WorldData.hx",lineNumber:51,className:"iron.data.WorldData",methodName:"parse"}),a(null)),new be(i,a)})},be.getEmptyIrradiance=function(){if(null==be.emptyIrr){var e=new Array(28);be.emptyIrr=e;for(var t=0,a=be.emptyIrr.length;t<a;){var i=t++;be.emptyIrr[i]=0}}return be.emptyIrr},be.__super__=he,be.prototype=s(he.prototype,{loadEnvmap:function(e){var t=this;null!=this.raw.envmap?he.getImage(this.raw.envmap,function(a){t.envmap=a,e(t)}):e(this)},getGlobalProbe:function(){return this.probes[0]},getSHIrradiance:function(){if(null==this.shirr){var e=new Array(28);this.shirr=e;for(var t=this.probes[0],a=0,i=t.irradiance.length;a<i;){var s=a++;this.shirr[s]=t.irradiance[s]}}return this.shirr},getProbeID:function(e){this.vec.x=e.world.self._30,this.vec.y=e.world.self._31,this.vec.z=e.world.self._32;for(var t=e.dim,a=1,i=this.probes.length;a<i;){var s=a++,r=this.probes[s];if(!(this.vec.x+t.x/2<r.volumeMin.x||this.vec.x-t.x/2>r.volumeMax.x||this.vec.y+t.y/2<r.volumeMin.y||this.vec.y-t.y/2>r.volumeMax.y||this.vec.z+t.z/2<r.volumeMin.z||this.vec.z-t.z/2>r.volumeMax.z))return s}return 0},getProbeVolumeCenter:function(e){return this.probes[this.getProbeID(e)].volumeCenter},getProbeVolumeSize:function(e){return this.probes[this.getProbeID(e)].volume},getProbeStrength:function(e){return this.probes[this.getProbeID(e)].raw.strength},getProbeBlending:function(e){return this.probes[this.getProbeID(e)].raw.blending},__class__:be});var Ce=function(e,t){var a=this;this.raw=e,this.setIrradiance(function(i){a.irradiance=i,null!=e.radiance?he.getImage(e.radiance,function(i){a.radiance=i;for(var s=[];s.length<e.radiance_mipmaps;)s.push(null);for(var r=e.radiance.substring(e.radiance.length-4),n=e.radiance.substring(0,e.radiance.length-4),l=0,o=0,h=e.radiance_mipmaps;o<h;){var c=[o++];he.getImage(n+"_"+c[0]+r,function(i){return function(r){s[i[0]]=r,(l+=1)==e.radiance_mipmaps&&(a.radiance.setMipmaps(s),a.mipsSet(t))}}(c),!0)}}):a.mipsSet(t)})};a["iron.data.Probe"]=Ce,Ce.__name__=!0,Ce.prototype={mipsSet:function(e){this.volume=new ae(this.raw.volume[0],this.raw.volume[1],this.raw.volume[2]),this.volumeCenter=new ae(this.raw.volume_center[0],this.raw.volume_center[1],this.raw.volume_center[2]),this.volumeMin=new ae(this.volumeCenter.x-this.volume.x,this.volumeCenter.y-this.volume.y,this.volumeCenter.z-this.volume.z),this.volumeMax=new ae(this.volumeCenter.x+this.volume.x,this.volumeCenter.y+this.volume.y,this.volumeCenter.z+this.volume.z),e(this)},setIrradiance:function(e){if(""==this.raw.irradiance){e([.7759665994411109,1.1676103577251633,1.498638725994038,.1336947481217397,.2152815237067897,.05665912629858376,-.02226816760879319,-.019376587567080147,-.010651384270937897,.000279290102432495,.0001858273851672515,633030727032015e-19,-678543609893525e-19,-.0003936997772915445,-.0007750453454300294,.010973699524451886,.02726825295855786,.04391820633315139,.08526796789315332,.07367063541652231,.03887702349408202,-134621815948975e-19,-39675084850967e-18,-37799572176155e-18,.13517727692935497,.11561459222778457,.06079408647605916])}else he.getBlob(this.raw.irradiance+".arm",function(t){var a=new F(t.toBytes());a.set_bigEndian(!0);for(var i=Le.read(a),s=new Array(28),r=0;r<27;){var n=r++;s[n]=i.irradiance[n]}s[27]=0,e(s)})},__class__:Ce};var Ae=function(e){this.inda=null,this.texa=null,this.nora=null,this.posa=null;for(var t=[],a=[],i=[],s=[],r=[],n=[],l=0;l<e.get_length();){for(var o="";;){var h=String.fromCharCode(e.readU8(l));if(++l,"\n"==h)break;if(l>=e.get_length())break;o+=h}var c=o.split(" ");if("v"==c[0])s.push(parseFloat(c[1])),s.push(parseFloat(c[2])),s.push(parseFloat(c[3]));else if("vt"==c[0])r.push(parseFloat(c[1])),r.push(parseFloat(c[2]));else if("vn"==c[0])n.push(parseFloat(c[1])),n.push(parseFloat(c[2])),n.push(parseFloat(c[3]));else if("f"==c[0]){var d=c[1].split("/"),u=c[2].split("/"),g=c[3].split("/"),f=c.length>4?c[4].split("/"):null,p=0|parseFloat(d[0]),m=0|parseFloat(u[0]),v=0|parseFloat(g[0]);if(t.push(p),t.push(m),t.push(v),c.length>4&&(t.push(v),t.push(0|parseFloat(f[0])),t.push(p)),r.length>0){var _=0|parseFloat(d[1]),I=0|parseFloat(u[1]),w=0|parseFloat(g[1]);a.push(_),a.push(I),a.push(w),c.length>4&&(a.push(w),a.push(0|parseFloat(f[1])),a.push(_))}if(n.length>0){var b=0|parseFloat(d[2]),C=0|parseFloat(u[2]),A=0|parseFloat(g[2]);i.push(b),i.push(C),i.push(A),c.length>4&&(i.push(A),i.push(0|parseFloat(f[2])),i.push(b))}}}var M=new xi(3*t.length);this.posa=M;var B=new Uint32Array(t.length);this.inda=B;for(var y=0,N=t.length;y<N;){var S=y++;this.posa[3*S]=s[3*(t[S]-1)],this.posa[3*S+1]=-s[3*(t[S]-1)+2],this.posa[3*S+2]=s[3*(t[S]-1)+1],this.inda[S]=S}var G=new xi(3*i.length);if(this.nora=G,i.length>0)for(var k=0,D=t.length;k<D;){var x=k++;this.nora[3*x]=n[3*(i[x]-1)],this.nora[3*x+1]=-n[3*(i[x]-1)+2],this.nora[3*x+2]=n[3*(i[x]-1)+1]}else for(var Z=new ae,z=new ae,W=new ae,T=new ae,V=new ae,K=0,F=t.length/3|0;K<F;){var Y=K++;Z.set(this.posa[3*Y],this.posa[3*Y+1],this.posa[3*Y+2]),z.set(this.posa[3*(Y+1)],this.posa[3*(Y+1)+1],this.posa[3*(Y+1)+2]),W.set(this.posa[3*(Y+2)],this.posa[3*(Y+2)+1],this.posa[3*(Y+2)+2]),T.subvecs(W,z),V.subvecs(Z,z),T.cross(V),T.normalize(),T=V,this.nora[9*Y]=T.x,this.nora[9*Y+1]=T.y,this.nora[9*Y+2]=T.z,this.nora[9*Y+3]=T.x,this.nora[9*Y+4]=T.y,this.nora[9*Y+5]=T.z,this.nora[9*Y+6]=T.x,this.nora[9*Y+7]=T.y,this.nora[9*Y+8]=T.z}if(a.length>0){var H=new xi(2*a.length);this.texa=H;for(var R=0,L=t.length;R<L;){var X=R++;this.texa[2*X]=r[2*(a[X]-1)],this.texa[2*X+1]=1-r[2*(a[X]-1)+1]}}};a["iron.format.obj.ObjParser"]=Ae,Ae.__name__=!0,Ae.prototype={__class__:Ae};var Me=function(e,t,a,i,s,r,n,l,o){this.self=new He(e,t,a,i,s,r,n,l,o)};a["iron.math.Mat3"]=Me,Me.__name__=!0,Me.identity=function(){return new Me(1,0,0,0,1,0,0,0,1)},Me.prototype={setFrom4:function(e){this.self._00=e.self._00,this.self._01=e.self._01,this.self._02=e.self._02,this.self._10=e.self._10,this.self._11=e.self._11,this.self._12=e.self._12,this.self._20=e.self._20,this.self._21=e.self._21,this.self._22=e.self._22},__class__:Me};var Be=function(e,t,a,i){null==i&&(i=1),null==a&&(a=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=a,this.w=i};a["iron.math.Quat"]=Be,Be.__name__=!0,Be.identity=function(){return new Be(0,0,0,1)},Be.lerp=function(e,t,a){var i=new Be,s=new Be;return s.setFrom(e),e.dot(t)<0&&(s.w=-s.w,s.x=-s.x,s.y=-s.y,s.z=-s.z),i.x=s.x+(t.x-s.x)*a,i.y=s.y+(t.y-s.y)*a,i.z=s.z+(t.z-s.z)*a,i.w=s.w+(t.w-s.w)*a,i.normalize(),i},Be.slerp=function(e,t,a){var i=new Be,s=e.dot(t);if(Math.abs(s)>=1)return i.x=e.x,i.y=e.y,i.z=e.z,i.w=e.w,i;var r=Math.acos(s),n=1/Math.sqrt(1-s*s);if(Math.abs(n)>1e3)return Be.lerp(e,t,.5);var l=Math.sin((1-a)*r)*n,o=Math.sin(a*r)*n*(s<0?-1:1);return i.x=e.x*l+t.x*o,i.y=e.y*l+t.y*o,i.z=e.z*l+t.z*o,i.w=e.w*l+t.w*o,i},Be.prototype={fromAxisAngle:function(e,t){var a=Math.sin(.5*t);this.x=e.x*a,this.y=e.y*a,this.z=e.z*a,this.w=Math.cos(.5*t),this.normalize()},fromRotationMat:function(e){var t=e.self._00,a=e.self._10,i=e.self._20,s=e.self._01,r=e.self._11,n=e.self._21,l=e.self._02,o=e.self._12,h=e.self._22,c=t+r+h,d=0;return c>0?(d=.5/Math.sqrt(c+1),this.w=.25/d,this.x=(o-n)*d,this.y=(i-l)*d,this.z=(s-a)*d):t>r&&t>h?(d=2*Math.sqrt(1+t-r-h),this.w=(o-n)/d,this.x=.25*d,this.y=(a+s)/d,this.z=(i+l)/d):r>h?(d=2*Math.sqrt(1+r-t-h),this.w=(i-l)/d,this.x=(a+s)/d,this.y=.25*d,this.z=(n+o)/d):(d=2*Math.sqrt(1+h-t-r),this.w=(s-a)/d,this.x=(i+l)/d,this.y=(n+o)/d,this.z=.25*d),this},multquats:function(e,t){var a=e.x*t.w+e.w*t.x+e.y*t.z-e.z*t.y,i=e.w*t.y-e.x*t.z+e.y*t.w+e.z*t.x,s=e.w*t.z+e.x*t.y-e.y*t.x+e.z*t.w,r=e.w*t.w-e.x*t.x-e.y*t.y-e.z*t.z;this.x=a,this.y=i,this.z=s,this.w=r},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0==e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e)},setFrom:function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},fromEuler:function(e,t,a){var i=Math.cos(e/2),s=Math.cos(t/2),r=Math.cos(a/2),n=Math.sin(e/2),l=Math.sin(t/2),o=Math.sin(a/2);return this.x=n*s*r+i*l*o,this.y=i*l*r+n*s*o,this.z=i*s*o-n*l*r,this.w=i*s*r-n*l*o,this},toMat:function(e){var t=this.x+this.x,a=this.y+this.y,i=this.z+this.z,s=this.x*t,r=this.x*a,n=this.x*i,l=this.y*a,o=this.y*i,h=this.z*i,c=this.w*t,d=this.w*a,u=this.w*i;return e.self._00=1-(l+h),e.self._10=r-u,e.self._20=n+d,e.self._01=r+u,e.self._11=1-(s+h),e.self._21=o-c,e.self._02=n-d,e.self._12=o+c,e.self._22=1-(s+l),e.self._03=0,e.self._13=0,e.self._23=0,e.self._30=0,e.self._31=0,e.self._32=0,e.self._33=1,e},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},__class__:Be};var ye=function(){this.markerEvents=null,this.lastFrameIndex=-1,this.blendAction="",this.blendCurrent=0,this.blendTime=0,this.paused=!1,this.onComplete=null,this.frameIndex=0,this.loop=!0,this.speed=1,this.time=0,this.action="",le.active.animations.push(this),this.frameTime=le.active.raw.frame_time,this.play()};a["iron.object.Animation"]=ye,ye.__name__=!0,ye.prototype={play:function(e,t,a,i,s){null==s&&(s=!0),null==i&&(i=1),null==a&&(a=0),null==e&&(e=""),a>0?(this.blendTime=a,this.blendCurrent=0,this.blendAction=this.action):this.frameIndex=-1,this.action=e,this.onComplete=t,this.speed=i,this.loop=s,this.paused=!1},remove:function(){n.remove(le.active.animations,this)},update:function(e){this.paused||(this.time+=e*this.speed,this.blendTime>0&&(this.blendCurrent+=e,this.blendCurrent>=this.blendTime&&(this.blendTime=0)))},rewind:function(e){this.frameIndex=this.speed>0?0:e.frames.length-1,this.time=e.frames[this.frameIndex]*this.frameTime},updateTrack:function(e){if(null!=e){var t=e.tracks[0];-1==this.frameIndex&&this.rewind(t);for(var a=this.speed>0?1:-1;;){var i=t.frames;if(!(this.speed>0?this.frameIndex+1<i.length&&this.time>i[this.frameIndex+1]*this.frameTime:this.frameIndex-1>-1&&this.time<i[this.frameIndex-1]*this.frameTime))break;this.frameIndex+=a}if(null!=this.markerEvents&&null!=e.marker_names&&this.frameIndex!=this.lastFrameIndex){for(var s=0,r=e.marker_frames.length;s<r;){var n=s++;if(this.frameIndex==e.marker_frames[n])for(var l=e.marker_names[n],o=this.markerEvents,h=null!=Gi[l]?o.getReserved(l):o.h[l],c=0;c<h.length;){var d=h[c];++c,d()}}this.lastFrameIndex=this.frameIndex}(this.speed>0?this.frameIndex>=t.frames.length-1:this.frameIndex<=0)&&(null!=this.onComplete&&0==this.blendTime&&this.onComplete(),this.loop||this.blendTime>0?this.rewind(t):(this.frameIndex-=a,this.paused=!0))}},updateAnimSampled:function(e,t){if(null!=e){var a=e.tracks[0],i=this.speed>0?1:-1,s=this.time,r=this.frameIndex,n=a.frames[r]*this.frameTime,l=(s-n)/(a.frames[r+i]*this.frameTime-n);ye.m1.setF32(a.values,16*r),ye.m2.setF32(a.values,16*(r+i)),ye.m1.decompose(ye.vpos,ye.q1,ye.vscl),ye.m2.decompose(ye.vpos2,ye.q2,ye.vscl2);var o=ae.lerp(ye.vpos,ye.vpos2,1-l),h=ae.lerp(ye.vscl,ye.vscl2,1-l),c=t;Be.lerp(ye.q1,ye.q2,l).toMat(c),c.scale(h),c.self._30=o.x,c.self._31=o.y,c.self._32=o.z}},__class__:ye};var Ne=function(e){null==e&&(e=""),this.onUpdate=null,this.m2=ie.identity(),this.m1=ie.identity(),this.m=ie.identity(),this.boneChildren=null,this.skeletonMatsBlend=null,this.skeletonBonesBlend=null,this.absMats=null,this.skeletonMats=null,this.skeletonBones=null,ye.call(this),this.isSampled=!1;for(var t=0,a=le.active.armatures;t<a.length;){var i=a[t];if(++t,i.name==e){this.armature=i;break}}};a["iron.object.BoneAnimation"]=Ne,Ne.__name__=!0,Ne.__super__=ye,Ne.prototype=s(ye.prototype,{setSkin:function(e){var t=this;if(this.object=e,this.data=null!=e?e.data:null,this.isSkinned=null!=this.data&&this.data.isSkinned,this.isSkinned){var a=8*Ne.skinMaxBones,i=new Array(a);this.skinBuffer=i;for(var s=0,r=this.skinBuffer.length;s<r;){var n=s++;this.skinBuffer[n]=0}var l=this.object.transform.rot;l.x=0,l.y=0,l.z=0,l.w=1,this.object.transform.buildMatrix();var o=e.parent.raw.bone_actions;null!=o&&o.length>0&&he.getSceneRaw(o[0],function(e){t.play(e.name)})}},addBoneChild:function(e,t){null==this.boneChildren&&(this.boneChildren=new T);var a=this.boneChildren,i=null!=Gi[e]?a.getReserved(e):a.h[e];if(null==i){i=[];var s=this.boneChildren;null!=Gi[e]?s.setReserved(e,i):s.h[e]=i}i.push(t)},updateBoneChildren:function(e,t){var a=e.name,i=this.boneChildren,s=null!=Gi[a]?i.getReserved(a):i.h[a];if(null!=s)for(var r=0;r<s.length;){var n=s[r];++r;var l=n.transform;if(null==l.boneParent&&(l.boneParent=ie.identity()),null!=n.raw.parent_bone_tail){var o=n.raw.parent_bone_tail;l.boneParent.initTranslate(o[0],o[1],o[2]),l.boneParent.multmat2(t)}else l.boneParent.setFrom(t);l.buildMatrix()}},setAction:function(e){if(this.isSkinned){var t=this.data.geom.actions;this.skeletonBones=null!=Gi[e]?t.getReserved(e):t.h[e];var a=this.data.geom.mats;this.skeletonMats=null!=Gi[e]?a.getReserved(e):a.h[e]}else{this.armature.initMats();var i=this.armature.getAction(e);this.skeletonBones=i.bones,this.skeletonMats=i.mats}},setActionBlend:function(e){if(this.isSkinned){this.skeletonBonesBlend=this.skeletonBones,this.skeletonMatsBlend=this.skeletonMats;var t=this.data.geom.actions;this.skeletonBones=null!=Gi[e]?t.getReserved(e):t.h[e];var a=this.data.geom.mats;this.skeletonMats=null!=Gi[e]?a.getReserved(e):a.h[e]}else{this.armature.initMats();var i=this.armature.getAction(e);this.skeletonBones=i.bones,this.skeletonMats=i.mats}},play:function(e,t,a,i,s){null==s&&(s=!0),null==i&&(i=1),null==a&&(a=.2),null==e&&(e=""),ye.prototype.play.call(this,e,t,a,i,s),""!=e&&(a>0?this.setActionBlend(e):this.setAction(e))},update:function(e){this.isSkinned||null!=this.skeletonBones||this.setAction(this.armature.actions[0].name),(null==this.object||this.object.visible&&!this.object.culled)&&null!=this.skeletonBones&&0!=this.skeletonBones.length&&(ye.prototype.update.call(this,e),this.paused||this.updateAnim())},updateAnim:function(){for(var e=0,t=this.skeletonBones;e<t.length;){var a=t[e];if(++e,null!=a.anim){this.updateTrack(a.anim);break}}for(var i=0,s=this.skeletonBones.length;i<s;){var r=i++;this.updateAnimSampled(this.skeletonBones[r].anim,this.skeletonMats[r])}if(this.blendTime>0&&null!=this.skeletonBonesBlend){for(var n=0,l=this.skeletonBonesBlend;n<l.length;){var o=l[n];if(++n,null!=o.anim){this.updateTrack(o.anim);break}}for(var h=0,c=this.skeletonBonesBlend.length;h<c;){var d=h++;this.updateAnimSampled(this.skeletonBonesBlend[d].anim,this.skeletonMatsBlend[d])}}null!=this.onUpdate&&this.onUpdate(),this.isSkinned?this.updateSkinGpu():this.updateBonesOnly()},updateBonesOnly:function(){for(var e=0,t=this.skeletonBones.length;e<t;){var a=e++,i=this.skeletonBones[a];this.m.setFrom(this.skeletonMats[a]),this.applyParent(this.m,i,this.skeletonMats,this.skeletonBones),null!=this.boneChildren&&this.updateBoneChildren(i,this.m)}},applyParent:function(e,t,a,i){for(var s=t.parent;null!=s;){var r=this.getBoneIndex(s,i);if(-1!=r){var n=a[r];e.multmat2(n),s=s.parent}}},updateSkinGpu:function(){var e=this.skeletonBones,t=this.blendCurrent/this.blendTime;t=t*t*(3-2*t);for(var a=0,i=e.length;a<i;){var s=a++;if(this.blendTime>0&&null!=this.skeletonBonesBlend){var r=this.skeletonBonesBlend;this.m1.setFrom(this.skeletonMatsBlend[s]),this.applyParent(this.m1,r[s],this.skeletonMatsBlend,this.skeletonBonesBlend),this.m2.setFrom(this.skeletonMats[s]),this.applyParent(this.m2,e[s],this.skeletonMats,this.skeletonBones),this.m1.decompose(Ne.vpos,Ne.q1,Ne.vscl),this.m2.decompose(Ne.vpos2,Ne.q2,Ne.vscl2);var n=ae.lerp(Ne.vpos,Ne.vpos2,1-t),l=ae.lerp(Ne.vscl,Ne.vscl2,1-t);Be.lerp(Ne.q1,Ne.q2,t).toMat(this.m1),this.m1.scale(l),this.m1.self._30=n.x,this.m1.self._31=n.y,this.m1.self._32=n.z,this.m.setFrom(this.m1)}else this.m.setFrom(this.skeletonMats[s]),this.applyParent(this.m,e[s],this.skeletonMats,this.skeletonBones);null!=this.absMats&&s<this.absMats.length&&this.absMats[s].setFrom(this.m),null!=this.boneChildren&&this.updateBoneChildren(e[s],this.m),this.m.multmats(this.m,this.data.geom.skeletonTransformsI[s]),this.m.decompose(Ne.vpos,Ne.q1,Ne.vscl),Ne.q1.normalize();var o=Ne.q2;o.x=Ne.vpos.x,o.y=Ne.vpos.y,o.z=Ne.vpos.z,o.w=0,Ne.q2.multquats(Ne.q2,Ne.q1),Ne.q2.x*=.5,Ne.q2.y*=.5,Ne.q2.z*=.5,Ne.q2.w*=.5,this.skinBuffer[8*s]=Ne.q1.x,this.skinBuffer[8*s+1]=Ne.q1.y,this.skinBuffer[8*s+2]=Ne.q1.z,this.skinBuffer[8*s+3]=Ne.q1.w,this.skinBuffer[8*s+4]=Ne.q2.x,this.skinBuffer[8*s+5]=Ne.q2.y,this.skinBuffer[8*s+6]=Ne.q2.z,this.skinBuffer[8*s+7]=Ne.q2.w}},getBoneIndex:function(e,t){if(null==t&&(t=this.skeletonBones),null==t)return-1;for(var a=0,i=t.length;a<i;){var s=a++;if(t[s]==e)return s}return-1},__class__:Ne});var Se=function(){this.isEmpty=!1,this.culledShadow=!1,this.culledMesh=!1,this.culled=!1,this.visibleShadow=!0,this.visibleMesh=!0,this.visible=!0,this.animation=null,this.lods=null,this.children=[],this.parent=null,this.traits=[],this.constraints=null,this.name="",this.raw=null,this.uid=Se.uidCounter++,this.urandom=Se.seededRandom(),this.transform=new Ye(this),this.isEmpty=tt.getClass(this)==Se,this.isEmpty&&null!=le.active&&le.active.empties.push(this)};a["iron.object.Object"]=Se,Se.__name__=!0,Se.seededRandom=function(){return Se.seed=(9301*Se.seed+49297)%233280,Se.seed/233280},Se.prototype={addChild:function(e,t){null==t&&(t=!1),e.parent!=this&&(this.children.push(e),e.parent=this,t&&e.transform.applyParentInverse())},remove:function(){for(this.isEmpty&&null!=le.active&&n.remove(le.active.empties,this),null!=this.animation&&this.animation.remove();this.children.length>0;)this.children[0].remove();for(;this.traits.length>0;)this.traits[0].remove();null!=this.parent&&(n.remove(this.parent.children,this),this.parent=null)},getChild:function(e){if(this.name==e)return this;for(var t=0,a=this.children;t<a.length;){var i=a[t];++t;var s=i.getChild(e);if(null!=s)return s}return null},addTrait:function(e){if(this.traits.push(e),e.object=this,null!=e._add){for(var t=0,a=e._add;t<a.length;){var i=a[t];++t,i()}e._add=null}},removeTrait:function(e){if(null!=e._init){for(var t=0,a=e._init;t<a.length;){var i=a[t];++t,ee.removeInit(i)}e._init=null}if(null!=e._update){for(var s=0,r=e._update;s<r.length;){var l=r[s];++s,ee.removeUpdate(l)}e._update=null}if(null!=e._lateUpdate){for(var o=0,h=e._lateUpdate;o<h.length;){var c=h[o];++o,ee.removeLateUpdate(c)}e._lateUpdate=null}if(null!=e._render){for(var d=0,u=e._render;d<u.length;){var g=u[d];++d,ee.removeRender(g)}e._render=null}if(null!=e._render2D){for(var f=0,p=e._render2D;f<p.length;){var m=p[f];++f,ee.removeRender2D(m)}e._render2D=null}if(null!=e._remove){for(var v=0,_=e._remove;v<_.length;){var I=_[v];++v,I()}e._remove=null}n.remove(this.traits,e),e.object=null},setupAnimation:function(e){null!=e&&(this.animation=new We(this,e))},__class__:Se};var Ge=function(e){if(this.frustumPlanes=null,this.prevV=null,Se.call(this),this.data=e,this.nearPlane=e.raw.near_plane,this.farPlane=e.raw.far_plane,this.buildProjection(),this.V=ie.identity(),this.VP=ie.identity(),e.raw.frustum_culling){this.frustumPlanes=[];for(var t=0;t<6;){t++;this.frustumPlanes.push(new ke)}}le.active.cameras.push(this)};a["iron.object.CameraObject"]=Ge,Ge.__name__=!0,Ge.buildViewFrustum=function(e,t){var a=t[0],i=e.self._33+e.self._30;a.normal.set(e.self._03+e.self._00,e.self._13+e.self._10,e.self._23+e.self._20),a.constant=i;var s=t[1],r=e.self._33-e.self._30;s.normal.set(e.self._03-e.self._00,e.self._13-e.self._10,e.self._23-e.self._20),s.constant=r;var n=t[2],l=e.self._33-e.self._31;n.normal.set(e.self._03-e.self._01,e.self._13-e.self._11,e.self._23-e.self._21),n.constant=l;var o=t[3],h=e.self._33+e.self._31;o.normal.set(e.self._03+e.self._01,e.self._13+e.self._11,e.self._23+e.self._21),o.constant=h;var c=t[4],d=e.self._32;c.normal.set(e.self._02,e.self._12,e.self._22),c.constant=d;var u=t[5],g=e.self._33-e.self._32;u.normal.set(e.self._03-e.self._02,e.self._13-e.self._12,e.self._23-e.self._22),u.constant=g;for(var f=0;f<t.length;){var p=t[f];++f,p.normalize()}},Ge.sphereInFrustum=function(e,t,a,i,s,r){null==r&&(r=0),null==s&&(s=0),null==i&&(i=0),null==a&&(a=1);for(var n=t.radius*a,l=0;l<e.length;){var o=e[l];if(++l,Ge.sphereCenter.set(t.world.self._30+i,t.world.self._31+s,t.world.self._32+r),o.distanceToSphere(Ge.sphereCenter,n)+2*n<0)return!1}return!0},Ge.__super__=Se,Ge.prototype=s(Se.prototype,{buildProjection:function(){var e=null!=this.data.raw.aspect?this.data.raw.aspect:Bt.windowWidth()/Bt.windowHeight();if(null!=this.data.raw.ortho_scale){var t=this.data.raw.ortho_scale;this.P=ie.ortho(-e*t,e*t,-1*t,t,-this.farPlane,this.farPlane)}else this.P=ie.persp(this.data.raw.fov,e,this.nearPlane,this.farPlane)},remove:function(){n.remove(le.active.cameras,this),Se.prototype.remove.call(this)},renderFrame:function(e){this.buildMatrix(),null==this.prevV&&(this.prevV=ie.identity(),this.prevV.setFrom(this.V)),se.active.renderFrame(e),this.prevV.setFrom(this.V)},buildMatrix:function(){this.transform.buildMatrix();var e=this.transform.world.getScale();Ge.temp.set(1/e.x,1/e.y,1/e.z),this.transform.world.scale(Ge.temp),this.V.getInverse(this.transform.world),this.VP.multmats(this.P,this.V),this.data.raw.frustum_culling&&Ge.buildViewFrustum(this.VP,this.frustumPlanes)},__class__:Ge});var ke=function(){this.constant=0,this.normal=new ae(1,0,0)};a["iron.object.FrustumPlane"]=ke,ke.__name__=!0,ke.prototype={normalize:function(){var e=this.normal,t=1/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);this.normal.mult(t),this.constant*=t},distanceToSphere:function(e,t){return this.normal.dot(e)+this.constant-t},__class__:ke};var De=function(e){this.target=null,this.raw=e};a["iron.object.Constraint"]=De,De.__name__=!0,De.prototype={apply:function(e){if(null==this.target&&null!=this.raw.target&&(this.target=le.active.getChild(this.raw.target).transform),"COPY_LOCATION"==this.raw.type){if(this.raw.use_x)if(e.world.self._30=this.target.loc.x,this.raw.use_offset)e.world.self._30+=e.loc.x;if(this.raw.use_y)if(e.world.self._31=this.target.loc.y,this.raw.use_offset)e.world.self._31+=e.loc.y;if(this.raw.use_z)if(e.world.self._32=this.target.loc.z,this.raw.use_offset)e.world.self._32+=e.loc.z}},__class__:De};var xe=function(e){Se.call(this),this.material=e,le.active.decals.push(this)};a["iron.object.DecalObject"]=xe,xe.__name__=!0,xe.__super__=Se,xe.prototype=s(Se.prototype,{remove:function(){null!=le.active&&n.remove(le.active.decals,this),Se.prototype.remove.call(this)},__class__:xe});var Ze=function(e){this.frustumPlanes=null,this.VP=ie.identity(),this.P=null,this.V=ie.identity(),this.camSlicedP=null,Se.call(this),this.data=e;var t=e.raw.type,a=e.raw.fov;if("sun"==t){if(null==Ze.corners){Ze.corners=[];for(var i=0;i<8;){i++;Ze.corners.push(new ae)}}this.P=ie.identity()}else"point"==t||"area"==t?this.P=ie.persp(a,1,e.raw.near_plane,e.raw.far_plane):"spot"==t&&(this.P=ie.persp(a,1,e.raw.near_plane,e.raw.far_plane));le.active.lamps.push(this)};a["iron.object.LampObject"]=Ze,Ze.__name__=!0,Ze.setCorners=function(){Ze.corners[0].set(-1,-1,1),Ze.corners[1].set(-1,-1,-1),Ze.corners[2].set(-1,1,1),Ze.corners[3].set(-1,1,-1),Ze.corners[4].set(1,-1,1),Ze.corners[5].set(1,-1,-1),Ze.corners[6].set(1,1,1),Ze.corners[7].set(1,1,-1)},Ze.__super__=Se,Ze.prototype=s(Se.prototype,{remove:function(){null!=le.active&&n.remove(le.active.lamps,this),Se.prototype.remove.call(this)},buildMatrices:function(e){this.transform.buildMatrix(),"sun"==this.data.raw.type?this.setCascade(e,0):(this.V.getInverse(this.transform.world),this.updateViewFrustum(e))},setCascade:function(e,t){if(Ze.m.setFrom(e.V),null==this.camSlicedP){var a=e.data.raw.fov,i=this.data.raw.near_plane,s=this.data.raw.far_plane,r=null!=e.data.raw.aspect?e.data.raw.aspect:Bt.windowWidth()/Bt.windowHeight();this.camSlicedP=ie.persp(a,r,i,s)}Ze.m.multmat2(this.camSlicedP),Ze.m.getInverse(Ze.m),this.V.getInverse(this.transform.world),this.V.toRotation(),Ze.m.multmat2(this.V),Ze.setCorners();for(var n=0,l=Ze.corners;n<l.length;){var o=l[n];++n,o.applymat4(Ze.m),o.set(o.x/o.w,o.y/o.w,o.z/o.w)}for(var h=Ze.corners[0].x,c=Ze.corners[0].y,d=Ze.corners[0].z,u=Ze.corners[0].x,g=Ze.corners[0].y,f=Ze.corners[0].z,p=0,m=Ze.corners;p<m.length;){var v=m[p];++p,v.x<h&&(h=v.x),v.x>u&&(u=v.x),v.y<c&&(c=v.y),v.y>g&&(g=v.y),v.z<d&&(d=v.z),v.z>f&&(f=v.z)}var _=Ze.corners[0],I=Ze.corners[7],w=_.x-I.x,b=_.y-I.y,C=_.z-I.z,A=Math.sqrt(w*w+b*b+C*C),M=.5*(A-(u-h)),B=.5*(A-(g-c));h-=M,u+=M,c-=B,g+=B;var y=this.data.raw.shadowmap_size,N=(u-h)/y,S=(g-c)/y,G=(f-d)/y;h=Math.floor(h/N)*N,c=Math.floor(c/S)*S,d=Math.floor(d/G)*G;var k=((u=Math.floor(u/N)*N)-h)/2,D=((g=Math.floor(g/S)*S)-c)/2,x=((f=Math.floor(f/G)*G)-d)/2;this.V.self._30=-(h+k),this.V.self._31=-(c+D),this.V.self._32=-(d+x),Ze.m=ie.ortho(-k,k,-D,D,4*-x,x),this.P.setFrom(Ze.m),this.updateViewFrustum(e)},updateViewFrustum:function(e){if(this.VP.multmats(this.P,this.V),e.data.raw.frustum_culling){if(null==this.frustumPlanes){this.frustumPlanes=[];for(var t=0;t<6;){t++;this.frustumPlanes.push(new ke)}}Ge.buildViewFrustum(this.VP,this.frustumPlanes)}},setCubeFace:function(e,t){switch(Ze.p1.set(this.transform.world.self._30,this.transform.world.self._31,this.transform.world.self._32),Ze.p2.setFrom(Ze.p1),e){case 0:Ze.p2.addf(1,0,0),Ze.p3.set(0,-1,0);break;case 1:Ze.p2.addf(-1,0,0),Ze.p3.set(0,-1,0);break;case 2:Ze.p2.addf(0,1,0),Ze.p3.set(0,0,1);break;case 3:Ze.p2.addf(0,-1,0),Ze.p3.set(0,0,-1);break;case 4:Ze.p2.addf(0,0,1),Ze.p3.set(0,-1,0);break;case 5:Ze.p2.addf(0,0,-1),Ze.p3.set(0,-1,0)}this.V.setLookAt(Ze.p1,Ze.p2,Ze.p3),this.updateViewFrustum(t)},__class__:Ze});var ze=function(e,t){this.tilesheet=null,this.frustumCulling=!0,this.screenSize=0,this.particleIndex=-1,this.particleOwner=null,this.particleChildren=null,this.particleSystems=null,this.data=null,Se.call(this),this.materials=t,this.setData(e),le.active.meshes.push(this)};a["iron.object.MeshObject"]=ze,ze.__name__=!0,ze.__super__=Se,ze.prototype=s(Se.prototype,{setData:function(e){this.data=e,e.refcount++;e.geom.build()},remove:function(){if(null!=this.particleSystems){for(var e=0,t=this.particleSystems;e<t.length;){var a=t[e];++e,a.remove()}this.particleSystems=null}null!=this.tilesheet&&this.tilesheet.remove(),null!=le.active&&n.remove(le.active.meshes,this),this.data.refcount--,Se.prototype.remove.call(this)},setupAnimation:function(e){if(null!=this.parent&&null!=this.parent.raw&&null!=this.parent.raw.bone_actions){for(var t=this.parent.name,a=0,i=le.active.animations;a<i.length;){var s=i[a];if(++a,null!=s.armature&&s.armature.name==t){this.animation=s;break}}null==this.animation&&(this.animation=new Ne(t));var r=tt.__cast(this.animation,Ne);this.data.isSkinned?r.setSkin(this):null!=this.raw.parent_bone&&r.addBoneChild(this.raw.parent_bone,this)}Se.prototype.setupAnimation.call(this,e)},setupParticleSystem:function(e,t){null==this.particleSystems&&(this.particleSystems=[]);var a=new Te(e,t);this.particleSystems.push(a)},setupTilesheet:function(e,t,a){this.tilesheet=new Fe(e,t,a)},setCulled:function(e,t){return e?this.culledShadow=t:this.culledMesh=t,this.culled=this.culledMesh&&this.culledShadow,t},cullMaterial:function(e,t){var a=this.materials;if((null==this.raw||null==this.raw.lod_material||1!=this.raw.lod_material)&&null==a[0].getContext(e))return!0;var i="shadowmap"==e;return this.visibleMesh||i?!this.visibleShadow&&i?this.setCulled(i,!0):this.skipContext(e)?this.setCulled(i,!0):this.setCulled(i,!1):this.setCulled(i,!0)},cullMesh:function(e,t,a){if(t.data.raw.frustum_culling&&this.frustumCulling){var i=this.data.isSkinned?2:1;null==this.particleSystems&&null==this.particleOwner||(i*=1e3),"voxel"==e&&(i*=100);var s="shadowmap"==e,r=s?a.frustumPlanes:t.frustumPlanes;if(s&&"sun"!=a.data.raw.type&&(a.transform.radius=a.data.raw.far_plane,!Ge.sphereInFrustum(t.frustumPlanes,a.transform)))return this.setCulled(s,!0);if(this.data.geom.instanced){for(var n=!1,l=0,o=this.data.geom.offsetVecs;l<o.length;){var h=o[l];if(++l,Ge.sphereInFrustum(r,this.transform,i,h.x,h.y,h.z)){n=!0;break}}if(!n)return this.setCulled(s,!0)}else if(!Ge.sphereInFrustum(r,this.transform,i))return this.setCulled(s,!0)}return this.culled=!1,this.culled},skipContext:function(e){for(var t=0,a=this.materials;t<a.length;){var i=a[t];if(++t,null!=i.raw.skip_context&&i.raw.skip_context==e)return!0}return!1},getContexts:function(e,t,a,i){for(var s=0;s<t.length;){var r=t[s];++s;for(var l=0,o=r.raw.contexts.length;l<o;){var h=l++;if(n.substr(r.raw.contexts[h].name,0,e.length)==e){a.push(r.contexts[h]),i.push(r.shader.getContext(e));break}}}},render:function(e,t,a,i,s){if(null!=this.data&&this.data.geom.ready&&this.visible&&!(this.cullMesh(t,a,i)||null!=this.raw&&this.raw.is_particle&&null==this.particleOwner)){var r=null!=this.raw&&"mesh"==t;if(null!=this.particleSystems&&r){if(null==this.particleChildren){this.particleChildren=[];for(var n=0,l=this.particleSystems;n<l.length;){var o=l[n];++n;var h=le.active.getChild(o.data.raw.dupli_object);this.particleChildren.push(h),null!=h&&(h.particleOwner=this,h.particleIndex=this.particleChildren.length-1,h.transform=this.transform)}}for(var c=0,d=this.particleSystems.length;c<d;){var u=c++;this.particleSystems[u].update(this.particleChildren[u],this)}}if((!(null!=this.particleSystems&&this.particleSystems.length>0)||this.particleSystems[0].data.raw.render_emitter)&&(null!=this.tilesheet&&this.tilesheet.update(),!this.cullMaterial(t,a))){var g=this.materials,f=this;if(null!=this.raw&&null!=this.raw.lods&&this.raw.lods.length>0){var p=this.transform,m=p.dim.x*p.scale.x*p.dim.y*p.scale.y*p.dim.z*p.scale.z;if(this.screenSize=m*(1/this.cameraDistance),this.screenSize=this.screenSize>1?1:this.screenSize,null==this.lods){this.lods=[];for(var v=0,_=this.raw.lods;v<_.length;){var I=_[v];++v,""==I.object_ref?this.lods.push(null):this.lods.push(le.active.getChild(I.object_ref))}}if("voxel"==t)f=this.lods[this.lods.length-1];else for(var w=0,b=this.raw.lods.length;w<b;){var C=w++;if(this.screenSize>this.raw.lods[C].screen_size)break;f=this.lods[C],null!=this.raw&&null!=this.raw.lod_material&&1==this.raw.lod_material&&(g=f.materials)}if(null==f)return}if(null==this.raw||null==this.raw.lod_material||1!=this.raw.lod_material||null!=g[0].getContext(t)){var A=[],M=[];this.getContexts(t,g,A,M),this.transform.update();var B=f.data;B.geom.instanced?e.setVertexBuffers([B.geom.vertexBuffer,B.geom.instancedVB]):e.setVertexBuffer(B.geom.vertexBuffer);for(var y=0,N=B.geom.indexBuffers.length;y<N;){var S=y++,G=B.geom.materialIndices[S];M.length<=G||(e.setIndexBuffer(B.geom.indexBuffers[S]),e.setPipeline(M[G].pipeState),Re.setConstants(e,M[G],this,a,i,s),A.length>G&&Re.setMaterialConstants(e,M[G],A[G]),B.geom.instanced?e.drawIndexedVerticesInstanced(B.geom.instanceCount):e.drawIndexedVertices())}}}}},__class__:ze});var We=function(e,t){this.object=e,this.oactions=t,this.isSkinned=!1,ye.call(this)};a["iron.object.ObjectAnimation"]=We,We.__name__=!0,We.__super__=ye,We.prototype=s(ye.prototype,{getAction:function(e){for(var t=0,a=this.oactions;t<a.length;){var i=a[t];if(++t,null!=i&&i.objects[0].name==e)return i.objects[0]}return null},play:function(e,t,a,i,s){null==s&&(s=!0),null==i&&(i=1),null==a&&(a=0),null==e&&(e=""),ye.prototype.play.call(this,e,t,a,i,s),""==this.action&&null!=this.oactions[0]&&(this.action=this.oactions[0].objects[0].name),this.oaction=this.getAction(this.action),null!=this.oaction&&(this.isSampled=null!=this.oaction.sampled&&this.oaction.sampled)},update:function(e){this.object.visible&&!this.object.culled&&null!=this.oaction&&(ye.prototype.update.call(this,e),this.paused||this.isSkinned||this.updateObjectAnim())},updateObjectAnim:function(){if(this.isSampled){this.updateTrack(this.oaction.anim),this.updateAnimSampled(this.oaction.anim,this.object.transform.world),this.object.transform.world.decompose(this.object.transform.loc,this.object.transform.rot,this.object.transform.scale);for(var e=0,t=this.object.children;e<t.length;){var a=t[e];++e,a.transform.buildMatrix()}}else this.updateAnimNonSampled(this.oaction.anim,this.object.transform),this.object.transform.buildMatrix()},interpolateLinear:function(e,t,a){return(e-t)/(a-t)},interpolateBezier:function(e,t,a){var i=(e-t)/(a-t);return i=i*i*(3-2*i)},updateAnimNonSampled:function(e,t){if(null!=e){var a=e.end*this.frameTime-e.begin*this.frameTime;if(e.has_delta){var i=t;null==i.dloc&&(i.dloc=new ae,i.drot=new Be,i.dscale=new ae),i.dloc.set(0,0,0),i.dscale.set(0,0,0),i._deulerX=i._deulerY=i._deulerZ=0}for(var s=0,r=e.tracks;s<r.length;){var n=r[s];++s,-1==this.frameIndex&&this.rewind(n);for(var l=this.speed>0?1:-1,o=this.time+e.begin*this.frameTime;;){var h=n.frames;if(!(this.speed>0?this.frameIndex<h.length-2&&o>h[this.frameIndex+1]*this.frameTime:this.frameIndex>1&&o>h[this.frameIndex-1]*this.frameTime))break;this.frameIndex+=l}if(!(this.frameIndex>=n.frames.length)){if(this.time>a)return null!=this.onComplete&&this.onComplete(),void this.rewind(n);var c=this.frameIndex,d=n.frames[c]*this.frameTime,u=n.frames[c+l]*this.frameTime,g=Ci(this,this.interpolateLinear);switch(n.curve){case"bezier":g=Ci(this,this.interpolateBezier);break;case"linear":g=Ci(this,this.interpolateLinear)}var f=g(o,d,u),p=1-f,m=n.values[c]*p+n.values[c+l]*f;switch(n.target){case"dxloc":t.dloc.x=m;break;case"dxrot":t._deulerX=m;break;case"dxscl":t.dscale.x=m;break;case"dyloc":t.dloc.y=m;break;case"dyrot":t._deulerY=m;break;case"dyscl":t.dscale.y=m;break;case"dzloc":t.dloc.z=m;break;case"dzrot":t._deulerZ=m;break;case"dzscl":t.dscale.z=m;break;case"xloc":t.loc.x=m;break;case"xrot":t.setRotation(m,t._eulerY,t._eulerZ);break;case"xscl":t.scale.x=m;break;case"yloc":t.loc.y=m;break;case"yrot":t.setRotation(t._eulerX,m,t._eulerZ);break;case"yscl":t.scale.y=m;break;case"zloc":t.loc.z=m;break;case"zrot":t.setRotation(t._eulerX,t._eulerY,m);break;case"zscl":t.scale.z=m}}}}},__class__:We});var Te=function(e,t){this.m=ie.identity(),this.lapTime=0,this.lap=0,this.count=0,this.emitFrom=null,this.seed=0,this.spawnRate=0,this.time=0,this.animtime=0,this.lifetime=0,this.frameRate=24;var a=this;this.seed=t.seed,this.particles=[],this.ready=!1,he.getParticle(e,t.particle,function(e){a.data=e,a.r=a.data.raw,a.gx=le.active.raw.gravity[0]*a.r.weight_gravity,a.gy=le.active.raw.gravity[1]*a.r.weight_gravity,a.gz=le.active.raw.gravity[2]*a.r.weight_gravity,a.alignx=a.r.object_align_factor[0]/2,a.aligny=a.r.object_align_factor[1]/2,a.alignz=a.r.object_align_factor[2]/2,a.lifetime=a.r.lifetime/a.frameRate,a.animtime=(a.r.frame_end-a.r.frame_start)/a.frameRate,a.spawnRate=(a.r.frame_end-a.r.frame_start)/a.r.count/a.frameRate;for(var t=0,i=a.r.count;t<i;){var s=t++;a.particles.push(new Ve(s))}a.ready=!0})};a["iron.object.ParticleSystem"]=Te,Te.__name__=!0,Te.prototype={getData:function(){return this.m.self._00=this.r.loop?this.animtime:-this.animtime,this.m.self._01=this.spawnRate,this.m.self._02=this.lifetime,this.m.self._03=this.particles.length,this.m.self._10=this.alignx,this.m.self._11=this.aligny,this.m.self._12=this.alignz,this.m.self._13=this.r.factor_random,this.m.self._20=this.gx*this.r.mass,this.m.self._21=this.gy*this.r.mass,this.m.self._22=this.gz*this.r.mass,this.m.self._23=this.r.lifetime_random,this.m.self._30=this.tilesx,this.m.self._31=this.tilesy,this.m.self._32=1/this.tilesFramerate,this.m.self._33=this.lapTime,this.m},update:function(e,t){this.ready&&(this.dimx=e.transform.dim.x,this.dimy=e.transform.dim.y,null!=e.tilesheet&&(this.tilesx=e.tilesheet.raw.tilesx,this.tilesy=e.tilesheet.raw.tilesy,this.tilesFramerate=e.tilesheet.raw.framerate),this.time+=.016666666666666666*qe.scale,this.lap=this.time/this.animtime|0,this.lapTime=this.time-this.lap*this.animtime,this.count=this.lapTime/this.spawnRate|0,this.r.gpu_sim?this.updateGpu(e,t):this.updateCpu(e,t))},updateGpu:function(e,t){e.data.geom.instanced||this.setupGeomGpu(e,t)},updateCpu:function(e,t){if(e.data.geom.instanced||this.setupGeomCpu(e,t),null!=this.emitFrom){if(0==this.r.type)for(var a=0,i=this.particles;a<i.length;){var s=i[a];++a,this.computePos(s,e,this.particles.length,this.lap,this.count)}for(var r=e.data.geom.instancedVB.lock(),n=0,l=this.particles.length;n<l;){var o=n++,h=this.particles[o],c=h.x,d=h.y,u=h.z;c+=this.emitFrom[3*o],d+=this.emitFrom[3*o+1],u+=this.emitFrom[3*o+2],r[3*o]=c,r[3*o+1]=d,r[3*o+2]=u}e.data.geom.instancedVB.unlock()}},computePos:function(e,t,a,i,s){var r=e.i,n=this.lapTime-e.i*this.spawnRate;if(n-=n*this.fhash(r)*this.r.lifetime_random,this.r.loop)for(;n<0;)n+=this.animtime;n<0||n>this.lifetime?e.x=e.y=e.z=-99999:1==this.r.physics_type&&this.computeNewton(e,r,n)},computeNewton:function(e,t,a){e.x=this.alignx,e.y=this.aligny,e.z=this.alignz;var i=this.particles.length;e.x+=this.fhash(e.i+0*i)*this.r.factor_random-this.r.factor_random/2,e.y+=this.fhash(e.i+i)*this.r.factor_random-this.r.factor_random/2,e.z+=this.fhash(e.i+2*i)*this.r.factor_random-this.r.factor_random/2,e.x+=this.gx*this.r.mass*a/5,e.y+=this.gy*this.r.mass*a/5,e.z+=this.gz*this.r.mass*a/5,e.x*=a,e.y*=a,e.z*=a},setupGeomGpu:function(e,t){var a=new xi(3*this.particles.length),i=0;if(0==this.r.emit_from)for(var s=t.data.geom.positions,r=0,n=this.particles;r<n.length;){n[r];++r;var l=this.fhash(i)*(s.length/3)|0;a[i]=s[3*l],a[++i]=s[3*l+1],a[++i]=s[3*l+2],++i}else for(var o=0,h=this.particles;o<h.length;){h[o];++o,a[i]=(2*Math.random()-1)*(e.transform.dim.x/2),a[++i]=(2*Math.random()-1)*(e.transform.dim.y/2),a[++i]=(2*Math.random()-1)*(e.transform.dim.z/2),++i}1!=this.r.particle_size&&e.data.geom.applyScale(this.r.particle_size,this.r.particle_size,this.r.particle_size),e.data.geom.setupInstanced(a,Ra.StaticUsage)},setupGeomCpu:function(e,t){for(var a=new xi(3*this.particles.length),i=0,s=0,r=this.particles;s<r.length;){r[s];++s,a[i]=0,a[++i]=0,a[++i]=0,++i}1!=this.r.particle_size&&e.data.geom.applyScale(this.r.particle_size,this.r.particle_size,this.r.particle_size),e.data.geom.setupInstanced(a,Ra.DynamicUsage);var n=new xi(3*this.particles.length);if(this.emitFrom=n,i=0,0==this.r.emit_from)for(var l=t.data.geom.positions,o=0,h=this.particles;o<h.length;){h[o];++o;var c=this.fhash(i)*(l.length/3)|0;this.emitFrom[i]=l[3*c],++i,this.emitFrom[i]=l[3*c+1],++i,this.emitFrom[i]=l[3*c+2],++i}else for(var d=0,u=this.particles;d<u.length;){u[d];++d,this.emitFrom[i]=(2*Math.random()-1)*(e.transform.dim.x/2),++i,this.emitFrom[i]=(2*Math.random()-1)*(e.transform.dim.y/2),++i,this.emitFrom[i]=(2*Math.random()-1)*(e.transform.dim.z/2),++i}},fhash:function(e){var t=e+1;return(t=(9301*(t*=9301%t)+49297)%233280)/233280},remove:function(){},__class__:Te};var Ve=function(e){this.z=0,this.y=0,this.x=0,this.i=e};a["iron.object.Particle"]=Ve,Ve.__name__=!0,Ve.prototype={__class__:Ve};var Ke=function(e){this.sound=null;var t=this;Se.call(this),this.data=e,le.active.speakers.push(this),""!=e.sound&&he.getSound(e.sound,function(e){t.sound=e,le.active.notifyOnInit(Ci(t,t.init))})};a["iron.object.SpeakerObject"]=Ke,Ke.__name__=!0,Ke.__super__=Se,Ke.prototype=s(Se.prototype,{init:function(){this.visible&&this.data.play_on_start&&this.play()},play:function(){null==this.sound||this.data.muted||Xe.play(this.sound,this.data.loop)},remove:function(){null!=le.active&&n.remove(le.active.speakers,this),Se.prototype.remove.call(this)},__class__:Ke});var Fe=function(e,t,a){this.onActionComplete=null,this.time=0,this.frame=0,this.paused=!1,this.action=null,this.tileY=0,this.tileX=0;var i=this;this.ready=!1,he.getSceneRaw(e,function(e){for(var s=0,r=e.tilesheet_datas;s<r.length;){var n=r[s];if(++s,n.name==t){i.raw=n,i.play(a),i.ready=!0;break}}})};a["iron.object.Tilesheet"]=Fe,Fe.__name__=!0,Fe.prototype={play:function(e,t){this.onActionComplete=t;for(var a=0,i=this.raw.actions;a<i.length;){var s=i[a];if(++a,s.name==e){this.action=s;break}}this.setFrame(this.action.start),this.paused=!1},remove:function(){},update:function(){!this.ready||this.paused||this.action.start>=this.action.end||(this.time+=.016666666666666666*qe.scale,this.time>=1/this.raw.framerate&&this.setFrame(this.frame+1))},setFrame:function(e){this.frame=e,this.time=0;var t=this.frame%this.raw.tilesx,a=this.frame/this.raw.tilesx|0;this.tileX=t*(1/this.raw.tilesx),this.tileY=a*(1/this.raw.tilesy),this.frame>=this.action.end&&this.action.start<this.action.end&&(null!=this.onActionComplete&&this.onActionComplete(),this.action.loop?this.setFrame(this.action.start):this.paused=!0)},__class__:Fe};var Ye=function(e){this.dscale=null,this.drot=null,this.dloc=null,this.boneParent=null,this.appendMats=null,this.prependMats=null,this.localOnly=!1,this.object=e,this.reset()};a["iron.object.Transform"]=Ye,Ye.__name__=!0,Ye.prototype={reset:function(){this.world=ie.identity(),this.local=ie.identity(),this.loc=new ae,this.rot=new Be,this.scale=new ae(1,1,1),this.dim=new ae(2,2,2),this.dirty=!0},update:function(){this.dirty&&(this.dirty=!1,this.buildMatrix())},composeDelta:function(){this.dloc.addvecs(this.loc,this.dloc),this.dscale.addvecs(this.dscale,this.scale),this.drot.fromEuler(this._deulerX,this._deulerY,this._deulerZ),this.drot.multquats(this.rot,this.drot),this.local.compose(this.dloc,this.drot,this.dscale)},buildMatrix:function(){if(null==this.dloc?this.local.compose(this.loc,this.rot,this.scale):this.composeDelta(),null!=this.prependMats){Ye.temp.setIdentity();for(var e=0,t=this.prependMats;e<t.length;){var a=t[e];++e,Ye.temp.multmat2(a)}Ye.temp.multmat2(this.local),this.local.setFrom(Ye.temp)}if(null!=this.appendMats)for(var i=0,s=this.appendMats;i<s.length;){var r=s[i];++i,this.local.multmat2(r)}if(null!=this.boneParent&&this.local.multmats(this.boneParent,this.local),null==this.object.parent||this.localOnly?this.world.setFrom(this.local):this.world.multmat3x4(this.local,this.object.parent.transform.world),null!=this.object.constraints)for(var n=0,l=this.object.constraints;n<l.length;){var o=l[n];++n,o.apply(this)}this.computeDim();for(var h=0,c=this.object.children;h<c.length;){var d=c[h];++h,d.transform.buildMatrix()}},decompose:function(){this.local.decompose(this.loc,this.rot,this.scale)},rotate:function(e,t){var a=new Be;a.fromAxisAngle(e,t),this.rot.multquats(a,this.rot),this.dirty=!0},setRotation:function(e,t,a){this.rot.fromEuler(e,t,a),this.dirty=!0,this._eulerX=e,this._eulerY=t,this._eulerZ=a},computeRadius:function(){this.radius=Math.sqrt(this.dim.x*this.dim.x+this.dim.y*this.dim.y+this.dim.z*this.dim.z)},computeDim:function(){if(null!=this.object.raw){var e=this.object.raw.dimensions;null==e?this.dim.set(2*this.scale.x,2*this.scale.y,2*this.scale.z):this.dim.set(e[0]*this.scale.x,e[1]*this.scale.y,e[2]*this.scale.z),this.computeRadius()}},applyParentInverse:function(){var e=this.object.parent.transform;e.buildMatrix(),Ye.temp.getInverse(e.world),this.local.multmat2(Ye.temp),this.decompose(),this.buildMatrix()},__class__:Ye};var He=function(e,t,a,i,s,r,n,l,o){this._00=e,this._10=t,this._20=a,this._01=i,this._11=s,this._21=r,this._02=n,this._12=l,this._22=o};a["kha.math.FastMatrix3"]=He,He.__name__=!0,He.prototype={__class__:He};var Re=function(){};a["iron.object.Uniforms"]=Re,Re.__name__=!0,Re.setConstants=function(e,t,a,i,s,r){if(null!=t.raw.constants)for(var l=0,o=t.raw.constants.length;l<o;){var h=l++,c=t.raw.constants[h];Re.setConstant(e,a,i,s,t.constants[h],c)}if(null!=r)for(var d=0,u=r.length/2|0;d<u;){var g,f=2*d++,p=r[f],m=r[f+1],v=!1;if("_"==p.charAt(0)&&(v=!0,p=n.substr(p,1,null)),v){var _=se.active.depthToRenderTarget;g=null!=Gi[p]?_.getReserved(p):_.h[p]}else{var I=se.active.renderTargets;g=null!=Gi[p]?I.getReserved(p):I.h[p]}Re.bindRenderTarget(e,g,t,m,v)}if(null!=t.raw.texture_units)for(var w=0,b=t.raw.texture_units.length;w<b;){var C=w++,A=t.raw.texture_units[C].link;if(null!=A){t.raw.texture_units[C].name;if("_envmapRadiance"==A){var M=le.active.world;null!=M&&(e.setTexture(t.textureUnits[C],M.getGlobalProbe().radiance),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.LinearMipFilter))}else if("_envmap"==A){var B=le.active.world;null!=B&&e.setTexture(t.textureUnits[C],B.envmap)}else if("_envmapBrdf"==A){var y=le.active.embedded;e.setTexture(t.textureUnits[C],null!=Gi["brdf.png"]?y.getReserved("brdf.png"):y.h["brdf.png"])}else if("_noise8"==A){var N=le.active.embedded;e.setTexture(t.textureUnits[C],null!=Gi["noise8.png"]?N.getReserved("noise8.png"):N.h["noise8.png"]),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter)}else if("_noise64"==A){var S=le.active.embedded;e.setTexture(t.textureUnits[C],null!=Gi["noise64.png"]?S.getReserved("noise64.png"):S.h["noise64.png"]),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter)}else if("_blueNoise64"==A){var G=le.active.embedded;e.setTexture(t.textureUnits[C],null!=Gi["blue_noise64.png"]?G.getReserved("blue_noise64.png"):G.h["blue_noise64.png"]),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter)}else if("_noise256"==A){var k=le.active.embedded;e.setTexture(t.textureUnits[C],null!=Gi["noise256.png"]?k.getReserved("noise256.png"):k.h["noise256.png"]),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter)}else if("_lampColorTexture"==A)null!=s&&(e.setTexture(t.textureUnits[C],s.data.colorTexture),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter));else if("_iesTexture"==A){var D=le.active.embedded;e.setTexture(t.textureUnits[C],null!=Gi["iestexture.png"]?D.getReserved("iestexture.png"):D.h["iestexture.png"]),e.setTextureParameters(t.textureUnits[C],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter)}else if("_sdfTexture"!=A&&null!=Re.externalTextureLinks)for(var x=0,Z=Re.externalTextureLinks;x<Z.length;){var z=Z[x];++x;var W=z(A);if(null!=W){e.setTexture(t.textureUnits[C],W);break}}}}},Re.bindRenderTarget=function(e,t,a,i,s){if(null!=t)for(var r=a.raw.texture_units,n=0,l=r.length;n<l;){var o=n++;if(i==r[o].name){var h=null!=r[o].is_image&&r[o].is_image;t.raw.depth>1&&(e.setTexture3DParameters(a.textureUnits[o],Ka.Clamp,Ka.Clamp,Ka.Clamp,Fa.LinearFilter,Fa.PointFilter,xa.LinearMipFilter),a.paramsSet[o]=!0),h||(t.isCubeMap?s?e.setCubeMapDepth(a.textureUnits[o],t.cubeMap):e.setCubeMap(a.textureUnits[o],t.cubeMap):s?e.setTextureDepth(a.textureUnits[o],t.image):e.setTexture(a.textureUnits[o],t.image)),a.paramsSet[o]||null==t.raw.mipmaps||1!=t.raw.mipmaps||h||(e.setTextureParameters(a.textureUnits[o],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.LinearMipFilter),a.paramsSet[o]=!0),a.paramsSet[o]||(("shadowMap"==i||s)&&(e.setTextureParameters(a.textureUnits[o],Ka.Clamp,Ka.Clamp,Fa.PointFilter,Fa.PointFilter,xa.NoMipFilter),a.paramsSet[o]=!0),"shadowMapCube"==i&&(a.paramsSet[o]=!0)),a.paramsSet[o]||(e.setTextureParameters(a.textureUnits[o],Ka.Repeat,Ka.Repeat,Fa.LinearFilter,Fa.LinearFilter,xa.NoMipFilter),a.paramsSet[o]=!0)}}},Re.setConstant=function(e,t,a,i,s,r){if(null!=r.link)if("mat4"==r.type){var n=null;if("_worldMatrix"==r.link)n=t.transform.world;else if("_inverseWorldMatrix"==r.link)Re.helpMat.getInverse(t.transform.world),n=Re.helpMat;else if("_viewMatrix"==r.link)n=a.V;else if("_transposeInverseViewMatrix"==r.link)Re.helpMat.setFrom(a.V),Re.helpMat.getInverse(Re.helpMat),Re.helpMat.transpose(),n=Re.helpMat;else if("_inverseViewMatrix"==r.link)Re.helpMat.getInverse(a.V),n=Re.helpMat;else if("_transposeViewMatrix"==r.link)Re.helpMat.setFrom(a.V),Re.helpMat.transpose3x3(),n=Re.helpMat;else if("_projectionMatrix"==r.link)n=a.P;else if("_inverseProjectionMatrix"==r.link)Re.helpMat.getInverse(a.P),n=Re.helpMat;else if("_inverseViewProjectionMatrix"==r.link)Re.helpMat.setFrom(a.V),Re.helpMat.multmat2(a.P),Re.helpMat.getInverse(Re.helpMat),n=Re.helpMat;else if("_worldViewProjectionMatrix"==r.link)Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(a.V),Re.helpMat.multmat2(a.P),n=Re.helpMat;else if("_worldViewProjectionMatrixSphere"==r.link)Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(a.V),Re.helpMat.self._00=1,Re.helpMat.self._10=0,Re.helpMat.self._20=0,Re.helpMat.self._01=0,Re.helpMat.self._11=1,Re.helpMat.self._21=0,Re.helpMat.self._02=0,Re.helpMat.self._12=0,Re.helpMat.self._22=1,Re.helpMat.multmat2(a.P),n=Re.helpMat;else if("_worldViewProjectionMatrixCylinder"==r.link)Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(a.V),Re.helpMat.self._00=1,Re.helpMat.self._20=0,Re.helpMat.self._01=0,Re.helpMat.self._21=0,Re.helpMat.self._02=0,Re.helpMat.self._22=1,Re.helpMat.multmat2(a.P),n=Re.helpMat;else if("_worldViewMatrix"==r.link)Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(a.V),n=Re.helpMat;else if("_viewProjectionMatrix"==r.link)n=a.VP;else if("_prevViewProjectionMatrix"==r.link)Re.helpMat.setFrom(a.prevV),Re.helpMat.multmat2(a.P),n=Re.helpMat;else if("_lampWorldViewProjectionMatrix"==r.link)null!=i&&(null==t?Re.helpMat.setIdentity():Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(i.VP),n=Re.helpMat);else if("_lampWorldViewProjectionMatrixSphere"==r.link)null!=i&&(Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(a.V),Re.helpMat.self._00=1,Re.helpMat.self._10=0,Re.helpMat.self._20=0,Re.helpMat.self._01=0,Re.helpMat.self._11=1,Re.helpMat.self._21=0,Re.helpMat.self._02=0,Re.helpMat.self._12=0,Re.helpMat.self._22=1,Re.helpMat2.getInverse(a.V),Re.helpMat.multmat2(Re.helpMat2),Re.helpMat.multmat2(i.VP),n=Re.helpMat);else if("_lampWorldViewProjectionMatrixCylinder"==r.link)null!=i&&(Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(a.V),Re.helpMat.self._00=1,Re.helpMat.self._20=0,Re.helpMat.self._01=0,Re.helpMat.self._21=0,Re.helpMat.self._02=0,Re.helpMat.self._22=1,Re.helpMat2.getInverse(a.V),Re.helpMat.multmat2(Re.helpMat2),Re.helpMat.multmat2(i.VP),n=Re.helpMat);else if("_biasLampWorldViewProjectionMatrix"==r.link)null!=i&&(null==t?Re.helpMat.setIdentity():Re.helpMat.setFrom(t.transform.world),Re.helpMat.multmat2(i.VP),Re.helpMat.multmat2(Re.biasMat),n=Re.helpMat);else if("_lampViewProjectionMatrix"==r.link)null!=i&&(n=i.VP);else if("_biasLampViewProjectionMatrix"==r.link)null!=i&&(Re.helpMat.setFrom(i.VP),Re.helpMat.multmat2(Re.biasMat),n=Re.helpMat);else if("_lampVolumeWorldViewProjectionMatrix"==r.link){if(null!=i){var l=i.transform,o=i.data.raw.type;"spot"==o?(Re.helpVec.set(l.world.self._30,l.world.self._31,l.world.self._32),Re.helpVec2.set(i.data.raw.far_plane,2*i.data.raw.far_plane,2*i.data.raw.far_plane),Re.helpMat.compose(Re.helpVec,Re.helpQuat,Re.helpVec2)):"point"!=o&&"area"!=o||(Re.helpVec.set(l.world.self._30,l.world.self._31,l.world.self._32),Re.helpVec2.set(i.data.raw.far_plane,2*i.data.raw.far_plane,2*i.data.raw.far_plane),Re.helpMat.compose(Re.helpVec,Re.helpQuat,Re.helpVec2)),Re.helpMat.multmat2(a.V),Re.helpMat.multmat2(a.P),n=Re.helpMat}}else if("_skydomeMatrix"==r.link){var h=a.transform;Re.helpVec.set(h.world.self._30,h.world.self._31,h.world.self._32-3.5);var c=.95*a.farPlane;Re.helpVec2.set(c,c,c),Re.helpMat.compose(Re.helpVec,Re.helpQuat,Re.helpVec2),Re.helpMat.multmat2(a.V),Re.helpMat.multmat2(a.P),n=Re.helpMat}else if("_lampViewMatrix"==r.link)null!=i&&(n=i.V);else if("_lampProjectionMatrix"==r.link)null!=i&&(n=i.P);else if("_particleData"==r.link){var d=tt.__cast(t,ze);null!=d.particleOwner&&(n=d.particleOwner.particleSystems[d.particleIndex].getData())}else if(null!=Re.externalMat4Links)for(var u=0,g=Re.externalMat4Links;u<g.length;){var f=g[u];if(++u,null!=(n=f(r.link)))break}if(null==n)return;e.setMatrix(s,n.self)}else if("mat3"==r.type){var p=null;if("_normalMatrix"==r.link&&(Re.helpMat.setFrom(t.transform.world),Re.helpMat.getInverse(Re.helpMat),Re.helpMat.transpose3x3(),Re.helpMat3.setFrom4(Re.helpMat),p=Re.helpMat3),null==p)return;e.setMatrix3(s,p.self)}else if("vec4"==r.type){var m=null;if(Re.helpVec.set(0,0,0),"_input"==r.link)Re.helpVec.set(je.getMouse().x/Bt.windowWidth(),je.getMouse().y/Bt.windowHeight(),je.getMouse().down()?1:0,0),m=Re.helpVec;else if(null!=Re.externalVec4Links)for(var v=0,_=Re.externalVec4Links;v<_.length;){var I=_[v];if(++v,null!=(m=I(r.link)))break}if(null==m)return;e.setFloat4(s,m.x,m.y,m.z,m.w)}else if("vec3"==r.type){var w=null;if(Re.helpVec.set(0,0,0),"_lampPosition"==r.link)null!=i&&Re.helpVec.set(i.transform.world.self._30,i.transform.world.self._31,i.transform.world.self._32),w=Re.helpVec;else if("_lampDirection"==r.link)null!=i&&(Re.helpVec=new ae(i.V.self._02,i.V.self._12,i.V.self._22)),w=Re.helpVec;else if("_lampColor"==r.link){if(null!=i){var b=i.data.raw.strength;Re.helpVec.set(i.data.raw.color[0]*b,i.data.raw.color[1]*b,i.data.raw.color[2]*b)}w=Re.helpVec}else if("_lampColorVoxel"==r.link){if(null!=i){var C=i.data.raw.strength;Re.helpVec.set(i.data.raw.color[0]*C,i.data.raw.color[1]*C,i.data.raw.color[2]*C)}w=Re.helpVec}else if("_lampArea0"==r.link){if(null!=i&&null!=i.data.raw.size){var A=i.data.raw.size/2,M=i.data.raw.size_y/2;Re.helpVec.set(-A,M,0),Re.helpVec.applymat(i.transform.world),w=Re.helpVec}}else if("_lampArea1"==r.link){if(null!=i&&null!=i.data.raw.size){var B=i.data.raw.size/2,y=i.data.raw.size_y/2;Re.helpVec.set(B,y,0),Re.helpVec.applymat(i.transform.world),w=Re.helpVec}}else if("_lampArea2"==r.link){if(null!=i&&null!=i.data.raw.size){var N=i.data.raw.size/2,S=i.data.raw.size_y/2;Re.helpVec.set(N,-S,0),Re.helpVec.applymat(i.transform.world),w=Re.helpVec}}else if("_lampArea3"==r.link){if(null!=i&&null!=i.data.raw.size){var G=i.data.raw.size/2,k=i.data.raw.size_y/2;Re.helpVec.set(-G,-k,0),Re.helpVec.applymat(i.transform.world),w=Re.helpVec}}else if("_cameraPosition"==r.link)Re.helpVec.set(a.transform.world.self._30,a.transform.world.self._31,a.transform.world.self._32),w=Re.helpVec;else if("_cameraPositionSnap"!=r.link)if("_cameraLook"==r.link)Re.helpVec=new ae(-a.transform.world.self._20,-a.transform.world.self._21,-a.transform.world.self._22),w=Re.helpVec;else if("_cameraUp"==r.link)Re.helpVec=new ae(a.transform.world.self._10,a.transform.world.self._11,a.transform.world.self._12),w=Re.helpVec;else if("_cameraRight"==r.link)Re.helpVec=new ae(a.transform.world.self._00,a.transform.world.self._01,a.transform.world.self._02),w=Re.helpVec;else if("_backgroundCol"==r.link)Re.helpVec.set(a.data.raw.clear_color[0],a.data.raw.clear_color[1],a.data.raw.clear_color[2]),w=Re.helpVec;else if("_probeVolumeCenter"==r.link)w=le.active.world.getProbeVolumeCenter(t.transform);else if("_probeVolumeSize"==r.link)w=le.active.world.getProbeVolumeSize(t.transform);else if("_sunDirection"==r.link){var D=le.active.world;null!=D&&(Re.helpVec.set(D.raw.sun_direction[0],D.raw.sun_direction[1],D.raw.sun_direction[2]),w=Re.helpVec)}else if(null!=Re.externalVec3Links)for(var x=0,Z=Re.externalVec3Links;x<Z.length;){var z=Z[x];if(++x,null!=(w=z(r.link)))break}if(null==w)return;e.setFloat3(s,w.x,w.y,w.z)}else if("vec2"==r.type){var W=0,T=0;if("_vec2x"==r.link)W=1;else if("_vec2xInv"==r.link)W=1/se.active.currentW;else if("_vec2x2"==r.link)W=2;else if("_vec2x2Inv"==r.link)W=2/se.active.currentW;else if("_vec2y"==r.link)T=1;else if("_vec2yInv"==r.link)T=1/se.active.currentH;else if("_vec2y2"==r.link)T=2;else if("_vec2y2Inv"==r.link)T=2/se.active.currentH;else if("_vec2y3"==r.link)T=3;else if("_vec2y3Inv"==r.link)T=3/se.active.currentH;else if("_windowSize"==r.link)W=Bt.windowWidth(),T=Bt.windowHeight();else if("_windowSizeInv"==r.link)W=1/Bt.windowWidth(),T=1/Bt.windowHeight();else if("_screenSize"==r.link)W=se.active.currentW,T=se.active.currentH;else if("_screenSizeInv"==r.link)W=1/se.active.currentW,T=1/se.active.currentH;else if("_aspectRatio"==r.link)W=(W=se.active.currentH/se.active.currentW)>1?1:W,T=(T=se.active.currentW/se.active.currentH)>1?1:T;else if("_cameraPlane"==r.link)W=a.data.raw.near_plane,T=a.data.raw.far_plane;else if("_cameraPlaneProj"==r.link){var V=a.data.raw.near_plane,K=a.data.raw.far_plane;W=K/(K-V),T=-K*V/(K-V)}else if("_lampPlane"==r.link)W=null==i?0:i.data.raw.near_plane,T=null==i?0:i.data.raw.far_plane;else if("_lampPlaneProj"==r.link){if(null!=i){var F=i.data.raw.near_plane,Y=i.data.raw.far_plane,H=Y-F;W=(Y+F)/H,T=2*Y*F/H}}else if("_spotlampData"==r.link)W=null==i?0:i.data.raw.spot_size,T=null==i?0:W-i.data.raw.spot_blend;else if("_tilesheetOffset"==r.link){var R=tt.__cast(t,ze).tilesheet;W=R.tileX,T=R.tileY}else if(null!=Re.externalVec2Links)for(var L=0,X=Re.externalVec2Links;L<X.length;){var j=X[L];++L;var E=j(r.link);if(null!=E){W=E.x,T=E.y;break}}e.setFloat2(s,W,T)}else if("float"==r.type){var O=0;if("_time"==r.link)O=bt.time();else if("_deltaTime"==r.link)O=.016666666666666666*qe.scale;else if("_lampRadius"==r.link)O=null==i?0:i.data.raw.far_plane;else if("_lampShadowsBias"==r.link)O=null==i?0:i.data.raw.shadows_bias;else if("_lampSize"==r.link)null!=i&&null!=i.data.raw.lamp_size&&(O=i.data.raw.lamp_size);else if("_lampSizeUV"==r.link)null!=i&&null!=i.data.raw.lamp_size&&(O=i.data.raw.lamp_size/i.data.raw.fov);else if("_envmapStrength"==r.link)O=null==le.active.world?0:le.active.world.getGlobalProbe().raw.strength;else if("_probeStrength"==r.link)O=le.active.world.getProbeStrength(t.transform);else if("_probeBlending"==r.link)O=le.active.world.getProbeBlending(t.transform);else if("_aspectRatioF"==r.link)O=se.active.currentW/se.active.currentH;else if("_aspectRatioWindowF"==r.link)O=Bt.windowWidth()/Bt.windowHeight();else if("_objectInfoIndex"==r.link)O=t.uid;else if("_objectInfoMaterialIndex"==r.link)O=null!=se.active.currentMaterial?se.active.currentMaterial.uid:tt.__cast(t,ze).materials[0].uid;else if("_objectInfoRandom"==r.link)O=t.urandom;else if("_frameScale"==r.link)O=se.active.frameTime/(.016666666666666666*qe.scale);else if(null!=Re.externalFloatLinks)for(var U=0,P=Re.externalFloatLinks;U<P.length;){var Q=P[U];++U;var J=Q(r.link);if(null!=J){O=J;break}}e.setFloat(s,O)}else if("floats"==r.type){var q=null;if("_skinBones"==r.link)null!=t.animation&&(q=tt.__cast(t.animation,Ne).skinBuffer);else if("_envmapIrradiance"==r.link)q=null==le.active.world?be.getEmptyIrradiance():le.active.world.getSHIrradiance();else if(null!=Re.externalFloatsLinks)for(var $=0,ee=Re.externalFloatsLinks;$<ee.length;){var te=ee[$];if(++$,null!=(q=te(r.link)))break}null!=q&&e.setFloats(s,q)}else if("int"==r.type){var ie=0;if("_uid"==r.link&&(ie=t.uid),"_lampType"==r.link)if(null==i)ie=0;else switch(i.data.raw.type){case"area":ie=3;break;case"point":ie=1;break;case"spot":ie=2;break;case"sun":ie=0;break;default:ie=0}else if("_lampIndex"==r.link)ie=se.active.currentLampIndex;else if("_lampCastShadow"==r.link)null!=i&&i.data.raw.cast_shadow&&(ie=i.data.raw.shadowmap_cube?2:1);else if("_envmapNumMipmaps"==r.link){var re=le.active.world;ie=null!=re?re.getGlobalProbe().raw.radiance_mipmaps+1-2:1}else if(null!=Re.externalIntLinks)for(var ne=0,oe=Re.externalIntLinks;ne<oe.length;){var he=oe[ne];++ne;var ce=he(r.link);if(null!=ce){ie=ce;break}}e.setInt(s,ie)}},Re.setMaterialConstants=function(e,t,a){if(null!=a.raw.bind_constants)for(var i=0,s=a.raw.bind_constants.length;i<s;){for(var r=i++,n=a.raw.bind_constants[r],l=-1,o=0,h=t.raw.constants.length;o<h;){var c=o++;if(t.raw.constants[c].name==n.name){l=c;break}}if(-1!=l){var d=t.raw.constants[l];Re.setMaterialConstant(e,t.constants[l],d,n)}}if(null!=a.textures)for(var u=0,g=a.textures.length;u<g;)for(var f=u++,p=a.raw.bind_textures[f].name,m=0,v=t.textureUnits.length;m<v;){var _=m++;if(p==t.raw.texture_units[_].name){e.setTexture(t.textureUnits[_],a.textures[f]),a.setTextureParameters(e,f,t,_);break}}},Re.setMaterialConstant=function(e,t,a,i){switch(a.type){case"bool":e.setBool(t,i.bool);break;case"float":e.setFloat(t,i.float);break;case"int":e.setInt(t,i.int);break;case"vec2":e.setFloat2(t,i.vec2[0],i.vec2[1]);break;case"vec3":e.setFloat3(t,i.vec3[0],i.vec3[1],i.vec3[2]);break;case"vec4":e.setFloat4(t,i.vec4[0],i.vec4[1],i.vec4[2],i.vec4[3])}};var Le=function(){};a["iron.system.ArmPack"]=Le,Le.__name__=!0,Le.read=function(e){try{var t=e.readByte();switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return e.read(e.readByte());case 197:return e.read(e.readUInt16());case 198:return e.read(e.readInt32());case 202:return e.readFloat();case 203:return e.readDouble();case 204:return e.readByte();case 205:return e.readUInt16();case 206:return e.readInt32();case 208:return e.readInt8();case 209:return e.readInt16();case 210:return e.readInt32();case 217:return e.readString(e.readByte());case 218:return e.readString(e.readUInt16());case 219:return e.readString(e.readInt32());case 220:return Le.readArray(e,e.readUInt16());case 221:return Le.readArray(e,e.readInt32());case 222:return Le.readMap(e,e.readUInt16());case 223:return Le.readMap(e,e.readInt32());default:if(t<128)return t;if(t<144)return Le.readMap(e,15&t);if(t<160)return Le.readArray(e,15&t);if(t<192)return e.readString(31&t);if(t>223)return-256|t}}catch(e){if(e instanceof et&&(e=e.val),!tt.__instanceof(e,R))throw e}return null},Le.readArray=function(e,t){var a=e.readByte(),i=e,s=i.pos;if(i.set_position(s-1),202==a){var r=e,n=r.pos;r.set_position(n+1);for(var l=new xi(t),o=0,h=t;o<h;){l[o++]=e.readFloat()}return l}if(210==a){var c=e,d=c.pos;c.set_position(d+1);for(var u=new Uint32Array(t),g=0,f=t;g<f;){u[g++]=e.readInt32()}return u}for(var p=[],m=0,v=t;m<v;){m++;p.push(Le.read(e))}return p},Le.readMap=function(e,t){for(var a={},i=0,s=t;i<s;){i++;var r=Le.read(e),n=Le.read(e);a[f.string(r)]=n}return a};var Xe=function(){};a["iron.system.Audio"]=Xe,Xe.__name__=!0,Xe.play=function(e,t){null==t&&(t=!1),Dt.play(e,t)};var je=function(){};a["iron.system.Input"]=je,je.__name__=!0,je.endFrame=function(){null!=je.mouse&&je.mouse.endFrame(),null!=je.keyboard&&je.keyboard.endFrame();for(var e=0,t=je.gamepads;e<t.length;){var a=t[e];++e,a.endFrame()}if(null!=je.virtualButtons)for(var i=je.virtualButtons,s=new W(i,i.arrayKeys());s.hasNext();){var r=s.next();r.started=r.released=!1}},je.getMouse=function(){return null==je.mouse&&(je.mouse=new Ue),je.mouse};var Ee=function(){this.down=!1,this.released=!1,this.started=!1};a["iron.system.VirtualButton"]=Ee,Ee.__name__=!0,Ee.prototype={__class__:Ee};var Oe=function(){this.virtualButtons=null};a["iron.system.VirtualInput"]=Oe,Oe.__name__=!0,Oe.prototype={downVirtual:function(e){if(null!=this.virtualButtons){var t=this.virtualButtons,a=null!=Gi[e]?t.getReserved(e):t.h[e];null!=a&&(a.down=!0,a.started=!0)}},upVirtual:function(e){if(null!=this.virtualButtons){var t=this.virtualButtons,a=null!=Gi[e]?t.getReserved(e):t.h[e];null!=a&&(a.down=!1,a.released=!0)}},__class__:Oe};var Ue=function(){this.lastY=-1,this.lastX=-1,this.locked=!1,this.wheelDelta=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1,!1,!1],this.buttonsStarted=[!1,!1,!1],this.buttonsDown=[!1,!1,!1],Oe.call(this),Ja.get().notify(Ci(this,this.downListener),Ci(this,this.upListener),Ci(this,this.moveListener),Ci(this,this.wheelListener))};a["iron.system.Mouse"]=Ue,Ue.__name__=!0,Ue.__super__=Oe,Ue.prototype=s(Oe.prototype,{endFrame:function(){var e=this.buttonsStarted[1]=this.buttonsStarted[2]=!1;this.buttonsStarted[0]=e;var t=this.buttonsReleased[1]=this.buttonsReleased[2]=!1;this.buttonsReleased[0]=t,this.moved=!1,this.movementX=0,this.movementY=0,this.wheelDelta=0},buttonIndex:function(e){return"left"==e?0:"right"==e?1:2},down:function(e){return null==e&&(e="left"),this.buttonsDown[this.buttonIndex(e)]},downListener:function(e,t,a){this.buttonsDown[e]=!0,this.buttonsStarted[e]=!0,this.x=t,this.y=a,this.downVirtual(Ue.buttons[e])},upListener:function(e,t,a){this.buttonsDown[e]=!1,this.buttonsReleased[e]=!0,this.x=t,this.y=a,this.upVirtual(Ue.buttons[e])},moveListener:function(e,t,a,i){-1==this.lastX&&-1==this.lastY&&(this.lastX=e,this.lastY=t),this.locked?(this.movementX=a,this.movementY=i):(this.movementX=e-this.lastX,this.movementY=t-this.lastY),this.lastX=e,this.lastY=t,this.x=e,this.y=t,this.moved=!0},wheelListener:function(e){this.wheelDelta=e},__class__:Ue});var Pe=function(){this.keysFrame=[],this.keysReleased=new T,this.keysStarted=new T};a["iron.system.Keyboard"]=Pe,Pe.__name__=!0,Pe.__super__=Oe,Pe.prototype=s(Oe.prototype,{endFrame:function(){if(this.keysFrame.length>0){for(var e=0,t=this.keysFrame;e<t.length;){var a=t[e];++e;var i=this.keysStarted;null!=Gi[a]?i.setReserved(a,!1):i.h[a]=!1;var s=this.keysReleased;null!=Gi[a]?s.setReserved(a,!1):s.h[a]=!1}this.keysFrame.splice(0,this.keysFrame.length)}},__class__:Pe});var Qe=function(){this.movementY=0,this.movementX=0,this.moved=!1};a["iron.system.GamepadStick"]=Qe,Qe.__name__=!0,Qe.prototype={__class__:Qe};var Je=function(){this.rightStick=new Qe,this.leftStick=new Qe,this.buttonsFrame=[],this.buttonsReleased=[],this.buttonsStarted=[]};a["iron.system.Gamepad"]=Je,Je.__name__=!0,Je.__super__=Oe,Je.prototype=s(Oe.prototype,{endFrame:function(){if(this.buttonsFrame.length>0){for(var e=0,t=this.buttonsFrame;e<t.length;){var a=t[e];++e,this.buttonsStarted[a]=!1,this.buttonsReleased[a]=!1}this.buttonsFrame.splice(0,this.buttonsFrame.length)}this.leftStick.moved=!1,this.leftStick.movementX=0,this.leftStick.movementY=0,this.rightStick.moved=!1,this.rightStick.movementX=0,this.rightStick.movementY=0},__class__:Je});var qe=function(){};a["iron.system.Time"]=qe,qe.__name__=!0,qe.update=function(){qe.realDelta=bt.realTime()-qe.last,qe.last=bt.realTime()};var $e=function(){};a["iron.system.Tween"]=$e,$e.__name__=!0,$e.update=function(){for(var e=.016666666666666666*qe.scale,t=$e.anims.length;t-- >0&&$e.anims.length>0;){var a=$e.anims[t];if(!(a.delay>0&&(a.delay-=e,a.delay>0))){if(a._time+=e,a.isPlaying=a._time<a.duration,null!=a.target){tt.__instanceof(a.target,Ye)&&(a.target.dirty=!0);for(var i=g.fields(a.props),s=0,r=i.length;s<r;){var n=s++,l=i[n],o=a._time/a.duration;if(o>1&&(o=1),1==a._comps[n]){var h=a._x[n],c=h+(g.getProperty(a.props,l)-h)*$e.eases[a.ease](o);g.setProperty(a.target,l,c)}else{var d=g.getProperty(a.props,l),u=g.getProperty(d,"x"),f=g.getProperty(d,"y"),p=g.getProperty(d,"z"),m=g.getProperty(d,"w");if(a._normalize[n])a._x[n]*u+a._y[n]*f+a._z[n]*p+a._w[n]*m<0&&(u=-u,f=-f,p=-p,m=-m);var v=a._x[n]+(u-a._x[n])*$e.eases[a.ease](o),_=a._y[n]+(f-a._y[n])*$e.eases[a.ease](o),I=a._z[n]+(p-a._z[n])*$e.eases[a.ease](o),w=a._w[n]+(m-a._w[n])*$e.eases[a.ease](o);if(a._normalize[n]){var b=Math.sqrt(v*v+_*_+I*I+w*w);b>0&&(v*=b=1/b,_*=b,I*=b,w*=b)}var C=g.getProperty(a.target,l);g.setProperty(C,"x",v),g.setProperty(C,"y",_),g.setProperty(C,"z",I),g.setProperty(C,"w",w)}}}a.isPlaying?null!=a.tick&&a.tick():($e.anims.splice(t,1),--t,a.isPlaying=!1,null!=a.done&&a.done())}}},$e.easeLinear=function(e){return e},$e.easeSineIn=function(e){return 0==e?0:1==e?1:1-Math.cos(e*Math.PI/2)},$e.easeSineOut=function(e){return 0==e?0:1==e?1:Math.sin(e*(.5*Math.PI))},$e.easeSineInOut=function(e){return 0==e?0:1==e?1:-.5*(Math.cos(Math.PI*e)-1)},$e.easeQuadIn=function(e){return e*e},$e.easeQuadOut=function(e){return-e*(e-2)},$e.easeQuadInOut=function(e){return e<.5?2*e*e:--e*e*-2+1},$e.easeCubicIn=function(e){return e*e*e},$e.easeCubicOut=function(e){return--e*e*e+1},$e.easeCubicInOut=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},$e.easeQuartIn=function(e){return(e*=e)*e},$e.easeQuartOut=function(e){return 1-(e=--e*e)*e},$e.easeQuartInOut=function(e){return(e*=2)<1?.5*(e*=e)*e:-.5*((e=(e-=2)*e)*e-2)},$e.easeQuintIn=function(e){return e*(e*=e)*e},$e.easeQuintOut=function(e){return--e*(e*=e)*e+1},$e.easeQuintInOut=function(e){return(e*=2)<1?.5*e*(e*=e)*e:.5*(e-=2)*(e*=e)*e+1},$e.easeExpoIn=function(e){return 0==e?0:Math.pow(2,10*(e-1))},$e.easeExpoOut=function(e){return 1==e?1:1-Math.pow(2,-10*e)},$e.easeExpoInOut=function(e){return 0==e?0:1==e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},$e.easeCircIn=function(e){return-(Math.sqrt(1-e*e)-1)},$e.easeCircOut=function(e){return Math.sqrt(1-(e-1)*(e-1))},$e.easeCircInOut=function(e){return e<=.5?(Math.sqrt(1-e*e*4)-1)/-2:(Math.sqrt(1-(2*e-2)*(2*e-2))+1)/2},$e.easeBackIn=function(e){return 0==e?0:1==e?1:e*e*(2.70158*e-1.70158)},$e.easeBackOut=function(e){return 0==e?0:1==e?1:--e*e*(2.70158*e+1.70158)+1},$e.easeBackInOut=function(e){return 0==e?0:1==e?1:(e*=2)<1?e*e*(3.5949095*e-2.5949095)*.5:.5*((e-=2)*e*(3.5949095*e+2.5949095)+2)};var et=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,et)};a["js._Boot.HaxeError"]=et,et.__name__=!0,et.wrap=function(e){return e instanceof Error?e:new et(e)},et.__super__=Error,et.prototype=s(Error.prototype,{__class__:et});var tt=function(){};a["js.Boot"]=tt,tt.__name__=!0,tt.__unhtml=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},tt.__trace=function(e,t){var a,i=null!=t?t.fileName+":"+t.lineNumber+": ":"";if(i+=tt.__string_rec(e,""),null!=t&&null!=t.customParams)for(var s=0,r=t.customParams;s<r.length;){var n=r[s];++s,i+=","+tt.__string_rec(n,"")}"undefined"!=typeof document&&null!=(a=document.getElementById("haxe:trace"))?a.innerHTML+=tt.__unhtml(i)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(i)},tt.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var a=tt.__nativeClassName(e);return null!=a?tt.__resolveNativeClass(a):null},tt.__string_rec=function(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";var a=typeof e;switch("function"==a&&(e.__name__||e.__ename__)&&(a="object"),a){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="\t";for(var s=2,r=e.length;s<r;){var n=s++;i+=2!=n?","+tt.__string_rec(e[n],t):tt.__string_rec(e[n],t)}return i+")"}var l="[";t+="\t";for(var o=0,h=e.length;o<h;){var c=o++;l+=(c>0?",":"")+tt.__string_rec(e[c],t)}return l+="]"}var d;try{d=e.toString}catch(e){return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d){var u=e.toString();if("[object Object]"!=u)return u}var g=null,f="{\n";t+="\t";var p=null!=e.hasOwnProperty;for(var g in e)p&&!e.hasOwnProperty(g)||"prototype"!=g&&"__class__"!=g&&"__super__"!=g&&"__interfaces__"!=g&&"__properties__"!=g&&(2!=f.length&&(f+=", \n"),f+=t+g+" : "+tt.__string_rec(e[g],t));return f+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},tt.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var a=e.__interfaces__;if(null!=a)for(var i=0,s=a.length;i<s;){var r=a[i++];if(r==t||tt.__interfLoop(r,t))return!0}return tt.__interfLoop(e.__super__,t)},tt.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case yi:return"boolean"==typeof e;case Mi:return!0;case Bi:return"number"==typeof e;case Ai:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(tt.__interfLoop(tt.getClass(e),t))return!0}else if("object"==typeof t&&tt.__isNativeObj(t)&&e instanceof t)return!0;return t==Ni&&null!=e.__name__||(t==Si&&null!=e.__ename__||e.__enum__==t)}},tt.__cast=function(e,t){if(tt.__instanceof(e,t))return e;throw new et("Cannot cast "+f.string(e)+" to "+f.string(t))},tt.__nativeClassName=function(e){var t=tt.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},tt.__isNativeObj=function(e){return null!=tt.__nativeClassName(e)},tt.__resolveNativeClass=function(e){return t[e]};var at=function(){};a["js.Browser"]=at,at.__name__=!0,at.createXMLHttpRequest=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw new et("Unable to create XMLHttpRequest object.")};var it=function(e){if(e instanceof Array&&null==e.__enum__)this.a=e,this.byteLength=e.length;else{var t=e;this.a=[];for(var a=0,i=t;a<i;){var s=a++;this.a[s]=0}this.byteLength=t}};a["js.html.compat.ArrayBuffer"]=it,it.__name__=!0,it.sliceImpl=function(e,t){var a=new Zi(this,e,null==t?null:t-e),i=new ki(a.byteLength);return new Zi(i).set(a),i},it.prototype={slice:function(e,t){return new it(this.a.slice(e,t))},__class__:it};var st=function(e,t,a){if(this.buf=e,this.offset=null==t?0:t,this.length=null==a?e.byteLength-this.offset:a,this.offset<0||this.length<0||this.offset+this.length>e.byteLength)throw new et(L.OutsideBounds);this.byteLength=this.length,this.byteOffset=this.offset,this.buffer=this.buf};a["js.html.compat.DataView"]=st,st.__name__=!0,st.prototype={getInt8:function(e){var t=this.buf.a[this.offset+e];return t>=128?t-256:t},getUint8:function(e){return this.buf.a[this.offset+e]},getInt16:function(e,t){var a=this.getUint16(e,t);return a>=32768?a-65536:a},getUint16:function(e,t){return t?this.buf.a[this.offset+e]|this.buf.a[this.offset+e+1]<<8:this.buf.a[this.offset+e]<<8|this.buf.a[this.offset+e+1]},getInt32:function(e,t){var a=this.offset+e,i=this.buf.a[a++],s=this.buf.a[a++],r=this.buf.a[a++],n=this.buf.a[a++];return t?i|s<<8|r<<16|n<<24:n|r<<8|s<<16|i<<24},getUint32:function(e,t){var a=this.getInt32(e,t);return a<0?a+4294967296:a},getFloat32:function(e,t){return X.i32ToFloat(this.getInt32(e,t))},getFloat64:function(e,t){var a=this.getInt32(e,t),i=this.getInt32(e+4,t);return X.i64ToDouble(t?a:i,t?i:a)},setInt8:function(e,t){this.buf.a[e+this.offset]=t<0?t+128&255:255&t},setUint8:function(e,t){this.buf.a[e+this.offset]=255&t},setInt16:function(e,t,a){this.setUint16(e,t<0?t+65536:t,a)},setUint16:function(e,t,a){var i=e+this.offset;a?(this.buf.a[i]=255&t,this.buf.a[i++]=t>>8&255):(this.buf.a[i++]=t>>8&255,this.buf.a[i]=255&t)},setInt32:function(e,t,a){this.setUint32(e,t,a)},setUint32:function(e,t,a){var i=e+this.offset;a?(this.buf.a[i++]=255&t,this.buf.a[i++]=t>>8&255,this.buf.a[i++]=t>>16&255,this.buf.a[i++]=t>>>24):(this.buf.a[i++]=t>>>24,this.buf.a[i++]=t>>16&255,this.buf.a[i++]=t>>8&255,this.buf.a[i++]=255&t)},setFloat32:function(e,t,a){this.setUint32(e,X.floatToI32(t),a)},setFloat64:function(e,t,a){var i=X.doubleToI64(t);a?(this.setUint32(e,i.low),this.setUint32(e,i.high)):(this.setUint32(e,i.high),this.setUint32(e,i.low))},__class__:st};var rt=function(){};a["js.html.compat.Float32Array"]=rt,rt.__name__=!0,rt._new=function(e,t,a){var i;if("number"==typeof e){i=[];for(var s=0,r=e;s<r;){i[s++]=0}i.byteLength=i.length<<2,i.byteOffset=0;for(var n=[],l=0,o=i.length<<2;l<o;){l++;n.push(0)}i.buffer=new it(n)}else if(tt.__instanceof(e,it)){var h=e;null==t&&(t=0),null==a&&(a=h.byteLength-t>>2),i=[];for(var c=0,d=a;c<d;){c++;var u=h.a[t++]|h.a[t++]<<8|h.a[t++]<<16|h.a[t++]<<24;i.push(X.i32ToFloat(u))}i.byteLength=i.length<<2,i.byteOffset=t,i.buffer=h}else{if(!(e instanceof Array&&null==e.__enum__))throw new et("TODO "+f.string(e));i=e.slice();for(var g=[],p=0;p<i.length;){var m=i[p];++p;var v=X.floatToI32(m);g.push(255&v),g.push(v>>8&255),g.push(v>>16&255),g.push(v>>>24)}i.byteLength=i.length<<2,i.byteOffset=0,i.buffer=new it(g)}return i.subarray=rt._subarray,i.set=rt._set,i},rt._set=function(e,t){if(tt.__instanceof(e.buffer,it)){var a=e;if(e.byteLength+t>this.byteLength)throw new et("set() outside of range");for(var i=0,s=e.byteLength;i<s;){var r=i++;this[r+t]=a[r]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new et("TODO");var n=e;if(n.length+t>this.byteLength)throw new et("set() outside of range");for(var l=0,o=n.length;l<o;){var h=l++;this[h+t]=n[h]}}},rt._subarray=function(e,t){var a=rt._new(this.slice(e,t));return a.byteOffset=4*e,a};var nt=function(){};a["js.html.compat.Uint8Array"]=nt,nt.__name__=!0,nt._new=function(e,t,a){var i;if("number"==typeof e){i=[];for(var s=0,r=e;s<r;){i[s++]=0}i.byteLength=i.length,i.byteOffset=0,i.buffer=new it(i)}else if(tt.__instanceof(e,it)){var n=e;null==t&&(t=0),null==a&&(a=n.byteLength-t),(i=0==t?n.a:n.a.slice(t,t+a)).byteLength=i.length,i.byteOffset=t,i.buffer=n}else{if(!(e instanceof Array&&null==e.__enum__))throw new et("TODO "+f.string(e));(i=e.slice()).byteLength=i.length,i.byteOffset=0,i.buffer=new it(i)}return i.subarray=nt._subarray,i.set=nt._set,i},nt._set=function(e,t){if(tt.__instanceof(e.buffer,it)){var a=e;if(e.byteLength+t>this.byteLength)throw new et("set() outside of range");for(var i=0,s=e.byteLength;i<s;){var r=i++;this[r+t]=a[r]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new et("TODO");var n=e;if(n.length+t>this.byteLength)throw new et("set() outside of range");for(var l=0,o=n.length;l<o;){var h=l++;this[h+t]=n[h]}}},nt._subarray=function(e,t){var a=nt._new(this.slice(e,t));return a.byteOffset=e,a};var lt=function(){};a["kha.Canvas"]=lt,lt.__name__=!0,lt.prototype={__class__:lt,__properties__:{get_g4:"get_g4",get_height:"get_height",get_width:"get_width"}};var ot=function(){};a["kha.Resource"]=ot,ot.__name__=!0;var ht=function(){};a["kha.Image"]=ht,ht.__name__=!0,ht.__interfaces__=[ot,lt],ht.__properties__={get_nonPow2Supported:"get_nonPow2Supported"},ht.create=function(e,t,a,i){return null==a&&(a=Ya.RGBA32),null==i&&(i=Ra.StaticUsage),null==Nt.gl?new ct(e,t,a,!1):new St(e,t,a,!1,0)},ht.create3D=function(e,t,a,i,s){return null},ht.createRenderTarget=function(e,t,a,i,s,r){return null==r&&(r=0),null==s&&(s=1),null==i&&(i=0),null==a&&(a=Ya.RGBA32),null==Nt.gl?new ct(e,t,a,!0):new St(e,t,a,!0,i)},ht.fromImage=function(e,t){if(null==Nt.gl){var a=new ct(e.width,e.height,Ya.RGBA32,!1);return a.image=e,a.createTexture(),a}var i=new St(e.width,e.height,Ya.RGBA32,!1,0);return i.image=e,i.createTexture(),i},ht.fromBytes=function(e,t,a,i,s){if(null==i&&(i=Ya.RGBA32),null==s&&(s=Ra.StaticUsage),null!=Nt.gl){var r=new St(t,a,i,!1,0);return r.image=r.bytesToArray(e),r.createTexture(),r}return null},ht.get_nonPow2Supported=function(){return null!=Nt.gl},ht.prototype={unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},generateMipmaps:function(e){},setMipmaps:function(e){},setDepthStencilFrom:function(e){},get_width:function(){return 0},get_height:function(){return 0},get_depth:function(){return 1},get_g4:function(){return null},__class__:ht,__properties__:{get_g4:"get_g4",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var ct=function(e,t,a,i){this.myWidth=e,this.myHeight=t,this.format=a,this.renderTarget=i,this.image=null,this.video=null,i&&this.createTexture()};a["kha.CanvasImage"]=ct,ct.__name__=!0,ct.init=function(){var e=window.document.createElement("canvas");null!=e&&(ct.context=e.getContext("2d"),e.width=2048,e.height=2048,ct.context.globalCompositeOperation="copy")},ct.__super__=ht,ct.prototype=s(ht.prototype,{get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){null!=Nt.gl&&(this.texture=Nt.gl.createTexture(),Nt.gl.bindTexture(3553,this.texture),Nt.gl.texParameteri(3553,10240,9729),Nt.gl.texParameteri(3553,10241,9729),Nt.gl.texParameteri(3553,10242,33071),Nt.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=Nt.gl.createFramebuffer(),Nt.gl.bindFramebuffer(36160,this.frameBuffer),Nt.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),Nt.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),Nt.gl.bindFramebuffer(36160,null)):null!=this.video?Nt.gl.texImage2D(3553,0,6408,6408,5121,this.video):Nt.gl.texImage2D(3553,0,6408,6408,5121,this.image),Nt.gl.bindTexture(3553,null))},lock:function(e){return null==e&&(e=0),this.bytes=new x(new ki(this.format==Ya.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=Nt.gl){if(this.texture=Nt.gl.createTexture(),Nt.gl.bindTexture(3553,this.texture),Nt.gl.texParameteri(3553,10240,9729),Nt.gl.texParameteri(3553,10241,9729),Nt.gl.texParameteri(3553,10242,33071),Nt.gl.texParameteri(3553,10243,33071),Nt.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Zi(this.bytes.b.bufferValue)),1282==Nt.gl.getError()){for(var e=new x(new ki(this.get_width()*this.get_height()*4)),t=0,a=this.get_height();t<a;)for(var i=t++,s=0,r=this.get_width();s<r;){var n=s++,l=this.bytes,o=i*this.get_width()+n,h=l.b[o],c=i*this.get_width()*4+4*n;e.b[c]=255&h;var d=i*this.get_width()*4+4*n+1;e.b[d]=255&h;var u=i*this.get_width()*4+4*n+2;e.b[u]=255&h;var g=i*this.get_width()*4+4*n+3;e.b[g]=255}Nt.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Zi(e.b.bufferValue))}Nt.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:ct});var dt=e.kha._Color.Color_Impl_={};a["kha._Color.Color_Impl_"]=dt,dt.__name__=!0,dt.fromBytes=function(e,t,a,i){return null==i&&(i=255),dt._new(i<<24|e<<16|t<<8|a)},dt._new=function(e){return e};var ut=function(){};a["kha.CompilerDefines"]=ut,ut.__name__=!0;var gt=function(){};a["kha.DisplayImpl"]=gt,gt.__name__=!0,gt.width=function(e){return window.screen.width},gt.height=function(e){return window.screen.height};var ft=function(){};a["kha.EnvironmentVariables"]=ft,ft.__name__=!0,ft.prototype={__class__:ft};var pt=function(e,t,a,i){this.windowId=e,this.graphics1=t,this.graphics2=a,this.graphics4=i};a["kha.Framebuffer"]=pt,pt.__name__=!0,pt.__interfaces__=[lt],pt.prototype={init:function(e,t,a){this.graphics1=e,this.graphics2=t,this.graphics4=a},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return Bt.windowWidth(this.windowId)},get_height:function(){return Bt.windowHeight(this.windowId)},__class__:pt,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2"}};var mt=function(e,t,a,i,s,r,n,l){this.mySize=e,this.width=s,this.height=r,this.chars=n,this.baseline=t;for(var o=0;o<n.length;){var h=n[o];++o,h.yoff+=this.baseline}this.texture=ht.create(s,r,Ya.L8);for(var c=this.texture.lock(),d=0,u=0,g=r;u<g;){u++;for(var f=0,p=s;f<p;){f++;var m=l.readU8(d);c.b[d]=255&m,++d}}this.texture.unlock()};a["kha.KravurImage"]=mt,mt.__name__=!0,mt.prototype={getTexture:function(){return this.texture},getCharWidth:function(e){if(0==this.chars.length)return 0;var t=mt.gaps[0];if(e<t)return this.chars[0].xadvance;for(var a=1,i=mt.gaps.length/2|0;a<i;){var s=a++,r=mt.gaps[2*s-1],n=mt.gaps[2*s];e>n-1&&(t+=n-1-r)}return e-t>=this.chars.length?this.chars[0].xadvance:this.chars[e-t].xadvance},getHeight:function(){return this.mySize},stringWidth:function(e){for(var t=new String(e),a=0,i=0,s=t.length;i<s;){var r=i++;a+=this.getCharWidth(n.cca(t,r))}return a},charactersWidth:function(e,t,a){for(var i=0,s=t,r=t+a;s<r;){var n=s++;i+=this.getCharWidth(e[n])}return i},getBaselinePosition:function(){return this.baseline},__class__:mt};var vt=function(){this.images=new Z};a["kha.Kravur"]=vt,vt.__name__=!0,vt.__interfaces__=[ot],vt.prototype={_get:function(e,t){if(null==t&&(t=ia._glyphs),t!=this.oldGlyphs){this.oldGlyphs=t;for(var a=(mt.gaps=[t[0]])[0]+1,i=1,s=t.length;i<s;){var r=i++;t[r]!=a?(mt.gaps.push(t[r-1]),mt.gaps.push(t[r]),a=t[r]+1):++a}mt.gaps.push(t[t.length-1])}var n=null==t?e:1e4*e+t.length;if(!this.images.h.hasOwnProperty(n)){for(var l=64,o=32,h=t.length,c=new Array(h),d=0,u=c.length;d<u;){c[d++]=new ca}for(var g=null,f=-1;f<0;)o<l?o*=2:l*=2,g=ei.alloc(l*o),f=va.stbtt_BakeFontBitmap(this.blob,0,e,g,l,o,t,c);var p=new da;va.stbtt_InitFont(p,this.blob,0);var m=va.stbtt_GetFontVMetrics(p),v=va.stbtt_ScaleForPixelHeight(p,e),_=Math.round(m.ascent*v),I=Math.round(m.descent*v),w=Math.round(m.lineGap*v),b=new mt(0|e,_,I,w,l,o,c,g);return this.images.h[n]=b,b}return this.images.h[n]},__class__:vt};var _t=function(){};a["kha.LoaderImpl"]=_t,_t.__name__=!0,_t.loadImageFromDescription=function(e,t){var a=Object.prototype.hasOwnProperty.call(e,"readable")&&e.readable;if(p.endsWith(e.files[0],".hdr"))_t.loadBlobFromDescription(e,function(e){var i=ti.parse(e.toBytes()),s=ht.fromBytes(x.ofData(i.data.buffer),i.width,i.height,Ya.RGBA128,a?Ra.DynamicUsage:Ra.StaticUsage);t(s)});else{var i=window.document.createElement("img");i.onload=function(e){var s=ht.fromImage(i,a);t(s)},i.src=e.files[0],i.crossOrigin=""}},_t.loadSoundFromDescription=function(e,t){if(Nt._hasWebAudio){if(""!=window.document.createElement("audio").canPlayType("audio/mp4"))for(var a=0,i=e.files.length;a<i;){var s=a++,r=e.files[s];if(p.endsWith(r,".mp4"))return void new di(r,t)}for(var n=0,l=e.files.length;n<l;){var o=n++,h=e.files[o];if(p.endsWith(h,".ogg"))return void new di(h,t)}}else if(Nt.mobile){if(""!=window.document.createElement("audio").canPlayType("audio/mp4"))for(var c=0,d=e.files.length;c<d;){var u=c++,g=e.files[u];if(p.endsWith(g,".mp4"))return void new hi(g,t)}for(var f=0,m=e.files.length;f<m;){var v=f++,_=e.files[v];if(p.endsWith(_,".ogg"))return void new hi(_,t)}}else new ci(e.files,t)},_t.loadBlobFromDescription=function(e,t){var a=new XMLHttpRequest;a.open("GET",e.files[0],!0),a.responseType="arraybuffer",a.onreadystatechange=function(){if(4==a.readyState)if(a.status>=200&&a.status<400||0==a.status&&""==a.statusText){var i=null,s=a.response;if(null!=s){var r=new Zi(s);i=x.ofData(r)}else if(null!=a.responseBody){var n=VBArray(a.responseBody).toArray();i=new x(new ki(n.length));for(var l=0,o=n.length;l<o;){var h=l++;i.b[h]=255&n[h]}}else S.trace("Error loading "+e.files[0],{fileName:"LoaderImpl.hx",lineNumber:145,className:"kha.LoaderImpl",methodName:"loadBlobFromDescription"}),window.console.log("loadBlob failed");t(new ei(i))}else S.trace("Error loading "+e.files[0],{fileName:"LoaderImpl.hx",lineNumber:151,className:"kha.LoaderImpl",methodName:"loadBlobFromDescription"}),window.console.log("loadBlob failed")},a.send(null)};var It=function(){};a["kha.TimeTask"]=It,It.__name__=!0,It.prototype={__class__:It};var wt=function(){};a["kha.FrameTask"]=wt,wt.__name__=!0,wt.prototype={__class__:wt};var bt=function(){};a["kha.Scheduler"]=bt,bt.__name__=!0,bt.init=function(){bt.deltas=[];for(var e=0,t=bt.DIF_COUNT;e<t;){var a=e++;bt.deltas[a]=0}bt.stopped=!0,bt.frame_tasks_sorted=!0,bt.current=bt.lastTime=bt.realTime(),bt.currentFrameTaskId=0,bt.currentTimeTaskId=0,bt.currentGroupId=0,bt.timeTasks=[],bt.pausedTimeTasks=[],bt.outdatedTimeTasks=[],bt.timeTasksScratchpad=[],bt.frameTasks=[],bt.toDeleteFrame=[]},bt.start=function(e){null==e&&(e=!1),bt.vsync=Bt.get_vsync();var t=Bt.get_refreshRate();t>=57&&t<=63&&(t=60),bt.onedifhz=1/t,bt.stopped=!1,bt.resetTime(),bt.lastTime=bt.realTime()-bt.startTime;for(var a=0,i=bt.DIF_COUNT;a<i;){var s=a++;bt.deltas[s]=0}if(e){for(var r=0,n=bt.timeTasks;r<n.length;){var l=n[r];++r,l.paused=!1}for(var o=0,h=bt.frameTasks;o<h.length;){var c=h[o];++o,c.paused=!1}}},bt.executeFrame=function(){var e=bt.realTime()-bt.startTime-bt.lastTime,t=bt.current;if(e>=0){if(null==Ii.the())if(e>bt.maxframetime)bt.startTime+=e-bt.maxframetime,t+=e=bt.maxframetime;else if(bt.vsync){for(var a=bt.onedifhz;a<e-bt.onedifhz;)a+=bt.onedifhz;e=a;for(var i=0,s=bt.DIF_COUNT-2;i<s;){var r=i++;e+=bt.deltas[r],bt.deltas[r]=bt.deltas[r+1]}e+=bt.deltas[bt.DIF_COUNT-2],e/=bt.DIF_COUNT,bt.deltas[bt.DIF_COUNT-2]=a,t+=e}else{for(var l=0,o=bt.DIF_COUNT-1;l<o;){var h=l++;bt.deltas[h]=bt.deltas[h+1]}bt.deltas[bt.DIF_COUNT-1]=e;for(var c=0,d=0,u=bt.DIF_COUNT;d<u;){var g=d++;c+=bt.deltas[g]}t+=c/=bt.DIF_COUNT}else t+=e;bt.lastTime=t,bt.stopped||(bt.current=t);for(var f=0,p=bt.pausedTimeTasks;f<p.length;){var m=p[f];++f,m.next+=e}if(bt.stopped)for(var v=0,_=bt.timeTasks;v<_.length;){var I=_[v];++v,I.next+=e}bt.executeTimeTasks(t);for(var w=0,b=bt.outdatedTimeTasks;w<b.length;){var C=b[w];++w,C.next<t-10&&bt.timeTasksScratchpad.push(C)}for(var A=0,M=bt.timeTasksScratchpad;A<M.length;){var B=M[A];++A,n.remove(bt.outdatedTimeTasks,B)}for(;bt.timeTasksScratchpad.length>0;)n.remove(bt.timeTasksScratchpad,bt.timeTasksScratchpad[0])}bt.sortFrameTasks();for(var y=0,N=bt.frameTasks;y<N.length;){var S=N[y];++y,bt.stopped||S.paused||!S.active||S.task()||(S.active=!1)}for(var G=0,k=bt.frameTasks;G<k.length;){var D=k[G];++G,D.active||bt.toDeleteFrame.push(D)}for(;bt.toDeleteFrame.length>0;)n.remove(bt.frameTasks,bt.toDeleteFrame.pop())},bt.executeTimeTasks=function(e){for(;bt.timeTasks.length>0&&(bt.activeTimeTask=bt.timeTasks[0],bt.activeTimeTask.next<=e);)bt.activeTimeTask.next+=bt.activeTimeTask.period,n.remove(bt.timeTasks,bt.activeTimeTask),bt.activeTimeTask.active&&bt.activeTimeTask.task()?bt.activeTimeTask.period>0&&(0==bt.activeTimeTask.duration||bt.activeTimeTask.duration>=bt.activeTimeTask.start+bt.activeTimeTask.next)?bt.insertSorted(bt.timeTasks,bt.activeTimeTask):bt.archiveTimeTask(bt.activeTimeTask,e):(bt.activeTimeTask.active=!1,bt.archiveTimeTask(bt.activeTimeTask,e));bt.activeTimeTask=null},bt.archiveTimeTask=function(e,t){},bt.time=function(){return bt.current},bt.realTime=function(){return Bt.get_time()},bt.resetTime=function(){var e=Bt.get_time(),t=e-bt.startTime;bt.startTime=e;for(var a=0,i=bt.timeTasks;a<i.length;){var s=i[a];++a,s.start-=t,s.next-=t}for(var r=0,n=bt.DIF_COUNT;r<n;){var l=r++;bt.deltas[l]=0}bt.current=0,bt.lastTime=0},bt.addBreakableTimeTaskToGroup=function(e,t,a,i,s){null==s&&(s=0),null==i&&(i=0);var r=new It;return r.active=!0,r.task=t,r.id=++bt.currentTimeTaskId,r.groupId=e,r.start=bt.current+a,r.period=0,0!=i&&(r.period=i),r.duration=0,0!=s&&(r.duration=r.start+s),r.next=r.start,bt.insertSorted(bt.timeTasks,r),r.id},bt.addTimeTaskToGroup=function(e,t,a,i,s){return null==s&&(s=0),null==i&&(i=0),bt.addBreakableTimeTaskToGroup(e,function(){return t(),!0},a,i,s)},bt.addTimeTask=function(e,t,a,i){return null==i&&(i=0),null==a&&(a=0),bt.addTimeTaskToGroup(0,e,t,a,i)},bt.insertSorted=function(e,t){for(var a=0,i=e.length;a<i;){var s=a++;if(e[s].next>t.next)return void e.splice(s,0,t)}e.push(t)},bt.sortFrameTasks=function(){bt.frame_tasks_sorted||(bt.frameTasks.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),bt.frame_tasks_sorted=!0)};var Ct=a["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"]};Ct.RotationNone=["RotationNone",0],Ct.RotationNone.toString=i,Ct.RotationNone.__enum__=Ct,Ct.Rotation90=["Rotation90",1],Ct.Rotation90.toString=i,Ct.Rotation90.__enum__=Ct,Ct.Rotation180=["Rotation180",2],Ct.Rotation180.toString=i,Ct.Rotation180.__enum__=Ct,Ct.Rotation270=["Rotation270",3],Ct.Rotation270.toString=i,Ct.Rotation270.__enum__=Ct;var At=function(){};a["kha.Shaders"]=At,At.__name__=!0,At.init=function(){for(var e=[],t=0;t<3;){var a=t++,i=g.field(At,"Material_mesh_fragData"+a),s=k.run(i);e.push(ei.fromBytes(s))}At.Material_mesh_frag=new Ma(e,["Material_mesh.frag.essl","Material_mesh-relaxed.frag.essl","Material_mesh-webgl2.frag.essl"]);for(var r=[],n=0;n<3;){var l=n++,o=g.field(At,"Material_mesh_vertData"+l),h=k.run(o);r.push(ei.fromBytes(h))}At.Material_mesh_vert=new Ea(r,["Material_mesh.vert.essl","Material_mesh-relaxed.vert.essl","Material_mesh-webgl2.vert.essl"]);for(var c=[],d=0;d<3;){var u=d++,f=g.field(At,"Material_shadowmap_fragData"+u),p=k.run(f);c.push(ei.fromBytes(p))}At.Material_shadowmap_frag=new Ma(c,["Material_shadowmap.frag.essl","Material_shadowmap-relaxed.frag.essl","Material_shadowmap-webgl2.frag.essl"]);for(var m=[],v=0;v<3;){var _=v++,I=g.field(At,"Material_shadowmap_vertData"+_),w=k.run(I);m.push(ei.fromBytes(w))}At.Material_shadowmap_vert=new Ea(m,["Material_shadowmap.vert.essl","Material_shadowmap-relaxed.vert.essl","Material_shadowmap-webgl2.vert.essl"]);for(var b=[],C=0;C<3;){var A=C++,M=g.field(At,"armdefault_mesh_fragData"+A),B=k.run(M);b.push(ei.fromBytes(B))}At.armdefault_mesh_frag=new Ma(b,["armdefault_mesh.frag.essl","armdefault_mesh-relaxed.frag.essl","armdefault_mesh-webgl2.frag.essl"]);for(var y=[],N=0;N<3;){var S=N++,G=g.field(At,"painter_colored_fragData"+S),D=k.run(G);y.push(ei.fromBytes(D))}At.painter_colored_frag=new Ma(y,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);for(var x=[],Z=0;Z<3;){var z=Z++,W=g.field(At,"painter_image_fragData"+z),T=k.run(W);x.push(ei.fromBytes(T))}At.painter_image_frag=new Ma(x,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);for(var V=[],K=0;K<3;){var F=K++,Y=g.field(At,"painter_colored_vertData"+F),H=k.run(Y);V.push(ei.fromBytes(H))}At.painter_colored_vert=new Ea(V,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);for(var R=[],L=0;L<3;){var X=L++,j=g.field(At,"painter_text_vertData"+X),E=k.run(j);R.push(ei.fromBytes(E))}At.painter_text_vert=new Ea(R,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);for(var O=[],U=0;U<3;){var P=U++,Q=g.field(At,"painter_text_fragData"+P),J=k.run(Q);O.push(ei.fromBytes(J))}At.painter_text_frag=new Ma(O,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);for(var q=[],$=0;$<3;){var ee=$++,te=g.field(At,"painter_image_vertData"+ee),ae=k.run(te);q.push(ei.fromBytes(ae))}At.painter_image_vert=new Ea(q,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);for(var ie=[],se=0;se<3;){var re=se++,ne=g.field(At,"painter_video_vertData"+re),le=k.run(ne);ie.push(ei.fromBytes(le))}At.painter_video_vert=new Ea(ie,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"]);for(var oe=[],he=0;he<3;){var ce=he++,de=g.field(At,"painter_video_fragData"+ce),ue=k.run(de);oe.push(ei.fromBytes(ue))}At.painter_video_frag=new Ma(oe,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"])};var Mt=function(){};a["kha.Sound"]=Mt,Mt.__name__=!0,Mt.__interfaces__=[ot],Mt.prototype={uncompress:function(e){var t=new H,a=Tt.readAll(this.compressedData,t,!0),i=t.getBytes(),s=i.length/4|0;if(1==a.channel){var r=new Array(2*s);this.uncompressedData=r;for(var n=0,l=s;n<l;){var o=n++;this.uncompressedData[2*o]=i.getFloat(4*o),this.uncompressedData[2*o+1]=i.getFloat(4*o)}}else{var h=new Array(s);this.uncompressedData=h;for(var c=0,d=s;c<d;){var u=c++;this.uncompressedData[u]=i.getFloat(4*u)}}this.compressedData=null,e()},__class__:Mt};var Bt=function(){};a["kha.System"]=Bt,Bt.__name__=!0,Bt.__properties__={get_refreshRate:"get_refreshRate",get_vsync:"get_vsync",get_time:"get_time"},Bt.init=function(e,t){null==e.title&&(e.title="Kha"),null==e.width&&(e.width=800),null==e.height&&(e.height=600),null==e.samplesPerPixel&&(e.samplesPerPixel=1),null==e.vSync&&(e.vSync=!0),null==e.windowMode&&(e.windowMode=d.Window),null==e.resizable&&(e.resizable=!1),null==e.maximizable&&(e.maximizable=!1),null==e.minimizable&&(e.minimizable=!0),Bt.theTitle=e.title,Nt.init(e,t)},Bt.notifyOnRender=function(e,t){for(null==t&&(t=0);t>=Bt.renderListeners.length;)Bt.renderListeners.push([]);Bt.renderListeners[t].push(e)},Bt.render=function(e,t){if(0!=Bt.renderListeners.length)for(var a=0,i=Bt.renderListeners[e];a<i.length;){var s=i[a];++a,s(t)}},Bt.foreground=function(){for(var e=0,t=Bt.foregroundListeners;e<t.length;){var a=t[e];++e,a()}},Bt.background=function(){for(var e=0,t=Bt.backgroundListeners;e<t.length;){var a=t[e];++e,a()}},Bt.get_time=function(){return Nt.getTime()},Bt.windowWidth=function(e){return null==e&&(e=0),Nt.windowWidth(e)},Bt.windowHeight=function(e){return null==e&&(e=0),Nt.windowHeight(e)},Bt.get_vsync=function(){return Nt.getVsync()},Bt.get_refreshRate=function(){return Nt.getRefreshRate()};var yt=function(){this.axes=[],this.buttons=[]};a["kha.GamepadStates"]=yt,yt.__name__=!0,yt.prototype={__class__:yt};var Nt=function(){};a["kha.SystemImpl"]=Nt,Nt.__name__=!0,Nt.init=function(e,t){Nt.options=e,Nt.mobile=Nt.isMobile(),Nt.ios=Nt.isIOS(),Nt.chrome=Nt.isChrome(),Nt.firefox=Nt.isFirefox(),Nt.init2(),t()},Nt.isMobile=function(){var e=window.navigator.userAgent;return e.indexOf("Android")>=0||e.indexOf("webOS")>=0||e.indexOf("BlackBerry")>=0||e.indexOf("Windows Phone")>=0||!!Nt.isIOS()},Nt.isIOS=function(){var e=window.navigator.userAgent;return e.indexOf("iPhone")>=0||e.indexOf("iPad")>=0||e.indexOf("iPod")>=0},Nt.isChrome=function(){return window.navigator.userAgent.indexOf("Chrome")>=0},Nt.isFirefox=function(){return window.navigator.userAgent.indexOf("Firefox")>=0},Nt.windowWidth=function(e){return null==e&&(e=0),0==Nt.khanvas.width&&null!=Nt.options.width?Nt.options.width:Nt.khanvas.width},Nt.windowHeight=function(e){return null==e&&(e=0),0==Nt.khanvas.height&&null!=Nt.options.height?Nt.options.height:Nt.khanvas.height},Nt.setCanvas=function(e){Nt.khanvas=e},Nt.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},Nt.getVsync=function(){return!0},Nt.getRefreshRate=function(){return 60},Nt.init2=function(e){S.trace=tt.__trace,Nt.keyboard=new Qa,Nt.mouse=new qa,Nt.surface=new $a,Nt.gamepads=[],Nt.gamepadStates=[];for(var t=0;t<4;){var a=t++;Nt.gamepads[a]=new Ua(a),Nt.gamepadStates[a]=new yt}window.addEventListener("gamepadconnected",function(e){Ua.sendConnectEvent(e.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(e){Ua.sendDisconnectEvent(e.gamepad.index)}),Nt.pressedKeys=[];for(var i=0;i<256;){i++;Nt.pressedKeys.push(!1)}for(var s=0;s<256;){s++;Nt.pressedKeys.push(null)}window.document.addEventListener("copy",function(e){var t=e;if(null!=Bt.copyListener){var a=Bt.copyListener();null!=a&&t.clipboardData.setData("text/plain",a),t.preventDefault()}}),window.document.addEventListener("cut",function(e){var t=e;if(null!=Bt.cutListener){var a=Bt.cutListener();null!=a&&t.clipboardData.setData("text/plain",a),t.preventDefault()}}),window.document.addEventListener("paste",function(e){var t=e;if(null!=Bt.pasteListener){var a=t.clipboardData.getData("text/plain");Bt.pasteListener(a),t.preventDefault()}}),ct.init(),bt.init(),Nt.loadFinished(),ft.instance=new ri},Nt.getMouse=function(e){return 0!=e?null:Nt.mouse},Nt.checkGamepad=function(e){for(var t=0,a=e.axes.length;t<a;){var i=t++;if(null!=e.axes[i]&&Nt.gamepadStates[e.index].axes[i]!=e.axes[i]){var s=e.axes[i];i%2==1&&(s=-s),Nt.gamepadStates[e.index].axes[i]=s,Nt.gamepads[e.index].sendAxisEvent(i,s)}}for(var r=0,n=e.buttons.length;r<n;){var l=r++;null!=e.buttons[l]&&Nt.gamepadStates[e.index].buttons[l]!=e.buttons[l].value&&(Nt.gamepadStates[e.index].buttons[l]=e.buttons[l].value,Nt.gamepads[e.index].sendButtonEvent(l,e.buttons[l].value))}e.axes.length<=4&&e.buttons.length>7&&(Nt.gamepadStates[e.index].axes[4]=e.buttons[6].value,Nt.gamepads[e.index].sendAxisEvent(4,e.buttons[6].value),Nt.gamepadStates[e.index].axes[5]=e.buttons[7].value,Nt.gamepads[e.index].sendAxisEvent(5,e.buttons[7].value))},Nt.loadFinished=function(){var e=Nt.khanvas;null==e&&(e=window.document.getElementById(ut.canvas_id)),e.style.cursor="default";var t=!1;try{Nt.gl=e.getContext("webgl2",{alpha:!1,antialias:Nt.options.samplesPerPixel>1,stencil:!0,preserveDrawingBuffer:!0}),Nt.gl.pixelStorei(37441,1),Nt.halfFloat={HALF_FLOAT_OES:5131},Nt.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},Nt.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},Nt.elementIndexUint=!0,Nt.gl.getExtension("EXT_color_buffer_float"),Nt.gl.getExtension("OES_texture_float_linear"),Nt.gl.getExtension("OES_texture_half_float_linear"),Nt.anisotropicFilter=Nt.gl.getExtension("EXT_texture_filter_anisotropic"),null==Nt.anisotropicFilter&&(Nt.anisotropicFilter=Nt.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),t=!0,Nt.gl2=!0,At.init()}catch(e){S.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"SystemImpl.hx",lineNumber:335,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!Nt.gl2)try{Nt.gl=e.getContext("experimental-webgl",{alpha:!1,antialias:Nt.options.samplesPerPixel>1,stencil:!0,preserveDrawingBuffer:!0}),null!=Nt.gl&&(Nt.gl.pixelStorei(37441,1),Nt.gl.getExtension("OES_texture_float"),Nt.gl.getExtension("OES_texture_float_linear"),Nt.halfFloat=Nt.gl.getExtension("OES_texture_half_float"),Nt.gl.getExtension("OES_texture_half_float_linear"),Nt.depthTexture=Nt.gl.getExtension("WEBGL_depth_texture"),Nt.gl.getExtension("EXT_shader_texture_lod"),Nt.gl.getExtension("OES_standard_derivatives"),Nt.anisotropicFilter=Nt.gl.getExtension("EXT_texture_filter_anisotropic"),null==Nt.anisotropicFilter&&(Nt.anisotropicFilter=Nt.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),Nt.drawBuffers=Nt.gl.getExtension("WEBGL_draw_buffers"),Nt.elementIndexUint=Nt.gl.getExtension("OES_element_index_uint"),t=!0,At.init())}catch(e){S.trace("Could not initialize WebGL, falling back to Canvas.",{fileName:"SystemImpl.hx",lineNumber:359,className:"kha.SystemImpl",methodName:"loadFinished"})}if(Nt.setCanvas(e),t){var a=new gi;Nt.frame=new pt(0,null,null,a),Nt.frame.init(new sa(Nt.frame),new fi(Nt.frame),a)}else{ni.Kravur=vt,vt=ni;var i=new si(e.getContext("2d"));Nt.frame=new pt(0,null,i,null),Nt.frame.init(new sa(Nt.frame),i,null)}!Nt.mobile&&kt._init()?(Nt._hasWebAudio=!0,Dt._init()):Nt.mobile?(Nt._hasWebAudio=!1,li._init(),Dt=li):(Nt._hasWebAudio=!1,ii._compile(),Dt=ii),mi.instance=new vi,bt.start();var s=window,r=s.requestAnimationFrame;null==r&&(r=s.mozRequestAnimationFrame),null==r&&(r=s.webkitRequestAnimationFrame),null==r&&(r=s.msRequestAnimationFrame);var n=null,l=n=function(t){var a=window;null==r?a.setTimeout(n,16.666666666666668):r(n);var i=Nt.getGamepads();if(null!=i)for(var s=0,l=i.length;s<l;){var o=i[s++];null!=o&&Nt.checkGamepad(o)}if(bt.executeFrame(),e.getContext){var h=e.clientWidth,c=e.clientHeight;e.width==h&&e.height==c||(e.width=h,e.height=c),Bt.render(0,Nt.frame),null!=Nt.gl&&(Nt.gl.clearColor(1,1,1,1),Nt.gl.colorMask(!1,!1,!1,!0),Nt.gl.clear(16384),Nt.gl.colorMask(!0,!0,!0,!0))}};null==r?s.setTimeout(l,16.666666666666668):r(l),null==e.getAttribute("tabindex")&&e.setAttribute("tabindex","0"),e.focus(),e.oncontextmenu=function(e){e.stopPropagation(),e.preventDefault()},e.onmousedown=Nt.mouseDown,e.onmousemove=Nt.mouseMove,null!=Nt.keyboard&&(e.onkeydown=Nt.keyDown,e.onkeyup=Nt.keyUp,e.onkeypress=Nt.keyPress),e.onblur=Nt.onBlur,e.onfocus=Nt.onFocus,e.onmousewheel=e.onwheel=Nt.mouseWheel,e.onmouseleave=Nt.mouseLeave,e.addEventListener("wheel mousewheel",Nt.mouseWheel,!1),e.addEventListener("touchstart",Nt.touchDown,!1),e.addEventListener("touchend",Nt.touchUp,!1),e.addEventListener("touchmove",Nt.touchMove,!1),e.addEventListener("touchcancel",Nt.touchCancel,!1),window.addEventListener("unload",Nt.unload)},Nt.unload=function(e){},Nt.setMouseXY=function(e){var t=Nt.khanvas.getBoundingClientRect(),a=Nt.khanvas.clientLeft,i=Nt.khanvas.clientTop;Nt.mouseX=(e.clientX-t.left-a)*Nt.khanvas.width/(t.width-2*a)|0,Nt.mouseY=(e.clientY-t.top-i)*Nt.khanvas.height/(t.height-2*i)|0},Nt.unlockSoundOnIOS=function(){if(Nt.ios&&!Nt.iosSoundEnabled){var e=li._context.createBuffer(1,1,22050),t=li._context.createBufferSource();t.buffer=e,t.connect(li._context.destination),t.noteOn&&t.noteOn(0),Nt.iosSoundEnabled=!0}},Nt.mouseLeave=function(){Nt.mouse.sendLeaveEvent(0)},Nt.mouseWheel=function(e){return Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS(),e.preventDefault(),0==e.deltaMode?(e.deltaY<0?Nt.mouse.sendWheelEvent(0,-1):e.deltaY>0&&Nt.mouse.sendWheelEvent(0,1),Nt.insideInputEvent=!1,!1):1==e.deltaMode?(Nt.minimumScroll=0|Math.min(Nt.minimumScroll,Math.abs(e.deltaY)),Nt.mouse.sendWheelEvent(0,e.deltaY/Nt.minimumScroll|0),Nt.insideInputEvent=!1,!1):(Nt.insideInputEvent=!1,!1)},Nt.mouseDown=function(e){Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS(),Nt.setMouseXY(e),1==e.which?(e.ctrlKey?(Nt.leftMouseCtrlDown=!0,Nt.mouse.sendDownEvent(0,1,Nt.mouseX,Nt.mouseY)):(Nt.leftMouseCtrlDown=!1,Nt.mouse.sendDownEvent(0,0,Nt.mouseX,Nt.mouseY)),null!=Ci(wi=Nt.khanvas,wi.setCapture)?Nt.khanvas.setCapture():Nt.khanvas.ownerDocument.addEventListener("mousemove",Nt.documentMouseMove,!0),Nt.khanvas.ownerDocument.addEventListener("mouseup",Nt.mouseLeftUp)):2==e.which?(Nt.mouse.sendDownEvent(0,2,Nt.mouseX,Nt.mouseY),Nt.khanvas.ownerDocument.addEventListener("mouseup",Nt.mouseMiddleUp)):3==e.which&&(Nt.mouse.sendDownEvent(0,1,Nt.mouseX,Nt.mouseY),Nt.khanvas.ownerDocument.addEventListener("mouseup",Nt.mouseRightUp)),Nt.insideInputEvent=!1},Nt.mouseLeftUp=function(e){Nt.unlockSoundOnIOS(),1==e.which&&(Nt.insideInputEvent=!0,Nt.khanvas.ownerDocument.removeEventListener("mouseup",Nt.mouseLeftUp),null!=Ci(wi=Nt.khanvas,wi.releaseCapture)?Nt.khanvas.ownerDocument.releaseCapture():Nt.khanvas.ownerDocument.removeEventListener("mousemove",Nt.documentMouseMove,!0),Nt.leftMouseCtrlDown?Nt.mouse.sendUpEvent(0,1,Nt.mouseX,Nt.mouseY):Nt.mouse.sendUpEvent(0,0,Nt.mouseX,Nt.mouseY),Nt.leftMouseCtrlDown=!1,Nt.insideInputEvent=!1)},Nt.mouseMiddleUp=function(e){Nt.unlockSoundOnIOS(),2==e.which&&(Nt.insideInputEvent=!0,Nt.khanvas.ownerDocument.removeEventListener("mouseup",Nt.mouseMiddleUp),Nt.mouse.sendUpEvent(0,2,Nt.mouseX,Nt.mouseY),Nt.insideInputEvent=!1)},Nt.mouseRightUp=function(e){Nt.unlockSoundOnIOS(),3==e.which&&(Nt.insideInputEvent=!0,Nt.khanvas.ownerDocument.removeEventListener("mouseup",Nt.mouseRightUp),Nt.mouse.sendUpEvent(0,1,Nt.mouseX,Nt.mouseY),Nt.insideInputEvent=!1)},Nt.documentMouseMove=function(e){e.stopPropagation(),Nt.mouseMove(e)},Nt.mouseMove=function(e){Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS();var t=Nt.mouseX,a=Nt.mouseY;Nt.setMouseXY(e);var i=e.movementX,s=e.movementY;null==e.movementX&&(i=null!=e.mozMovementX?e.mozMovementX:null!=e.webkitMovementX?e.webkitMovementX:Nt.mouseX-t,s=null!=e.mozMovementY?e.mozMovementY:null!=e.webkitMovementY?e.webkitMovementY:Nt.mouseY-a),Nt.firefox&&(i=i*window.devicePixelRatio|0,s=s*window.devicePixelRatio|0),Nt.mouse.sendMoveEvent(0,Nt.mouseX,Nt.mouseY,i,s),Nt.insideInputEvent=!1},Nt.setTouchXY=function(e){var t=Nt.khanvas.getBoundingClientRect(),a=Nt.khanvas.clientLeft,i=Nt.khanvas.clientTop;Nt.touchX=(e.clientX-t.left-a)*Nt.khanvas.width/(t.width-2*a)|0,Nt.touchY=(e.clientY-t.top-i)*Nt.khanvas.height/(t.height-2*i)|0},Nt.touchDown=function(e){Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS(),e.stopPropagation(),e.preventDefault();for(var t=0,a=e.changedTouches;t<a.length;){var i=a[t];++t;var s=i.identifier;Nt.ios&&(-1==(s=Nt.iosTouchs.indexOf(-1))&&(s=Nt.iosTouchs.length),Nt.iosTouchs[s]=i.identifier),Nt.setTouchXY(i),Nt.mouse.sendDownEvent(0,0,Nt.touchX,Nt.touchY),Nt.surface.sendTouchStartEvent(s,Nt.touchX,Nt.touchY)}Nt.insideInputEvent=!1},Nt.touchUp=function(e){Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS();for(var t=0,a=e.changedTouches;t<a.length;){var i=a[t];++t;var s=i.identifier;Nt.ios&&(s=Nt.iosTouchs.indexOf(s),Nt.iosTouchs[s]=-1),Nt.setTouchXY(i),Nt.mouse.sendUpEvent(0,0,Nt.touchX,Nt.touchY),Nt.surface.sendTouchEndEvent(s,Nt.touchX,Nt.touchY)}Nt.insideInputEvent=!1},Nt.touchMove=function(e){Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS();for(var t=0,a=0,i=e.changedTouches;a<i.length;){var s=i[a];if(++a,Nt.setTouchXY(s),0==t){var r=Nt.touchX-Nt.lastFirstTouchX,n=Nt.touchY-Nt.lastFirstTouchY;Nt.lastFirstTouchX=Nt.touchX,Nt.lastFirstTouchY=Nt.touchY,Nt.mouse.sendMoveEvent(0,Nt.touchX,Nt.touchY,r,n)}var l=s.identifier;Nt.ios&&(l=Nt.iosTouchs.indexOf(l)),Nt.surface.sendMoveEvent(l,Nt.touchX,Nt.touchY),++t}Nt.insideInputEvent=!1},Nt.touchCancel=function(e){Nt.insideInputEvent=!0,Nt.unlockSoundOnIOS();for(var t=0,a=e.changedTouches;t<a.length;){var i=a[t];++t;var s=i.identifier;Nt.ios&&(s=Nt.iosTouchs.indexOf(s)),Nt.setTouchXY(i),Nt.mouse.sendUpEvent(0,0,Nt.touchX,Nt.touchY),Nt.surface.sendTouchEndEvent(s,Nt.touchX,Nt.touchY)}Nt.iosTouchs=[],Nt.insideInputEvent=!1},Nt.onBlur=function(){Bt.background()},Nt.onFocus=function(){Bt.foreground()},Nt.keyDown=function(e){e.stopPropagation(),Nt.pressedKeys[e.keyCode]?e.preventDefault():(Nt.pressedKeys[e.keyCode]=!0,Nt.keyboard.sendDownEvent(e.keyCode))},Nt.keyUp=function(e){e.preventDefault(),e.stopPropagation(),Nt.pressedKeys[e.keyCode]=!1,Nt.keyboard.sendUpEvent(e.keyCode)},Nt.keyPress=function(e){e.stopPropagation(),(!Nt.firefox||0!=e.which&&8!=e.which)&&Nt.keyboard.sendPressEvent(String.fromCharCode(e.which))},Nt.getGamepads=function(){return Nt.chrome&&mi.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null};var St=function(e,t,a,i,s){this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=t,this.format=a,this.renderTarget=i,this.image=null,this.video=null,this.depthStencilFormat=s,St.init(),i&&this.createTexture()};a["kha.WebGLImage"]=St,St.__name__=!0,St.init=function(){null==St.context&&(St.canvas=window.document.createElement("canvas"),null!=St.canvas&&(St.context=St.canvas.getContext("2d"),St.canvas.width=4096,St.canvas.height=4096,St.context.globalCompositeOperation="copy"))},St.formatByteSize=function(e){switch(e[1]){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}},St.__super__=ht,St.prototype=s(ht.prototype,{get_g4:function(){return null==this.graphics4&&(this.graphics4=new gi(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=Nt.gl){if(this.texture=Nt.gl.createTexture(),Nt.gl.bindTexture(3553,this.texture),Nt.gl.texParameteri(3553,10240,9729),Nt.gl.texParameteri(3553,10241,9729),Nt.gl.texParameteri(3553,10242,33071),Nt.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=Nt.gl.createFramebuffer(),Nt.gl.bindFramebuffer(36160,this.frameBuffer),this.format[1]){case 0:Nt.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:Nt.gl.texImage2D(3553,0,Nt.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:Nt.gl.texImage2D(3553,0,Nt.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:Nt.gl.texImage2D(3553,0,Nt.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,Nt.halfFloat.HALF_FLOAT_OES,null);break;case 5:Nt.gl.texImage2D(3553,0,Nt.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,Nt.gl2?6403:6406,5126,null);break;case 6:Nt.gl.texImage2D(3553,0,Nt.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,Nt.gl2?6403:6406,Nt.halfFloat.HALF_FLOAT_OES,null);break;default:Nt.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==Ya.DEPTH16){if(Nt.gl.texParameteri(3553,10240,9728),Nt.gl.texParameteri(3553,10241,9728),Nt.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!Nt.gl2){var e=Nt.gl.createTexture();Nt.gl.bindTexture(3553,e),Nt.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),Nt.gl.framebufferTexture2D(36160,36064,3553,e,0),Nt.gl.bindTexture(3553,this.texture)}}else Nt.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=Nt.gl.checkFramebufferStatus(36160)&&S.trace("WebGL error: Framebuffer incomplete",{fileName:"WebGLImage.hx",lineNumber:218,className:"kha.WebGLImage",methodName:"createTexture"}),Nt.gl.bindRenderbuffer(36161,null),Nt.gl.bindFramebuffer(36160,null)}else if(null!=this.video)Nt.gl.texImage2D(3553,0,6408,6408,5121,this.video);else{switch(this.format[1]){case 0:tt.__instanceof(this.image,Zi)?Nt.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):Nt.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 2:Nt.gl.texImage2D(3553,0,Nt.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:Nt.gl.texImage2D(3553,0,Nt.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Nt.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:Nt.gl.texImage2D(3553,0,Nt.gl2?33326:6406,this.myWidth,this.myHeight,0,Nt.gl2?6403:6406,5126,this.image);break;case 6:Nt.gl.texImage2D(3553,0,Nt.gl2?33325:6406,this.myWidth,this.myHeight,0,Nt.gl2?6403:6406,Nt.halfFloat.HALF_FLOAT_OES,this.image);break;default:Nt.gl.texImage2D(3553,0,6408,6408,5121,this.image)}}Nt.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:null==Nt.depthTexture?(this.renderBuffer=Nt.gl.createRenderbuffer(),Nt.gl.bindRenderbuffer(36161,this.renderBuffer),Nt.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),Nt.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=Nt.gl.createTexture(),Nt.gl.bindTexture(3553,this.depthTexture),1==e?Nt.gl.texImage2D(3553,0,Nt.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):Nt.gl.texImage2D(3553,0,Nt.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),Nt.gl.texParameteri(3553,10240,9728),Nt.gl.texParameteri(3553,10241,9728),Nt.gl.texParameteri(3553,10242,33071),Nt.gl.texParameteri(3553,10243,33071),Nt.gl.bindFramebuffer(36160,this.frameBuffer),Nt.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==Nt.depthTexture?(this.renderBuffer=Nt.gl.createRenderbuffer(),Nt.gl.bindRenderbuffer(36161,this.renderBuffer),Nt.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),Nt.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=Nt.gl.createTexture(),Nt.gl.bindTexture(3553,this.depthTexture),Nt.gl.texImage2D(3553,0,Nt.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,Nt.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),Nt.gl.texParameteri(3553,10240,9728),Nt.gl.texParameteri(3553,10241,9728),Nt.gl.texParameteri(3553,10242,33071),Nt.gl.texParameteri(3553,10243,33071),Nt.gl.bindFramebuffer(36160,this.frameBuffer),Nt.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(e){Nt.gl.activeTexture(33984+e),Nt.gl.bindTexture(3553,this.texture),null!=this.video&&Nt.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(e){Nt.gl.activeTexture(33984+e),Nt.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(e){Nt.gl.bindFramebuffer(36160,this.frameBuffer),Nt.gl.framebufferTexture2D(36160,36096,3553,tt.__cast(e,St).depthTexture,0)},bytesToArray:function(e){switch(this.format[1]){case 0:case 1:return new Zi(e.b.bufferValue);case 2:case 4:case 5:case 6:return new xi(e.b.bufferValue);default:return new Zi(e.b.bufferValue)}},lock:function(e){return null==e&&(e=0),this.bytes=new x(new ki(St.formatByteSize(this.format)*this.get_width()*this.get_height())),this.bytes},unlock:function(){if(null!=Nt.gl){switch(this.texture=Nt.gl.createTexture(),Nt.gl.bindTexture(3553,this.texture),Nt.gl.texParameteri(3553,10240,9729),Nt.gl.texParameteri(3553,10241,9729),Nt.gl.texParameteri(3553,10242,33071),Nt.gl.texParameteri(3553,10243,33071),this.format[1]){case 0:Nt.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(Nt.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==Nt.gl.getError()){for(var e=new x(new ki(this.get_width()*this.get_height()*4)),t=0,a=this.get_height();t<a;)for(var i=t++,s=0,r=this.get_width();s<r;){var n=s++,l=this.bytes,o=i*this.get_width()+n,h=l.b[o],c=i*this.get_width()*4+4*n;e.b[c]=255&h;var d=i*this.get_width()*4+4*n+1;e.b[d]=255&h;var u=i*this.get_width()*4+4*n+2;e.b[u]=255&h;var g=i*this.get_width()*4+4*n+3;e.b[g]=255}Nt.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(e))}break;case 2:Nt.gl.texImage2D(3553,0,Nt.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:Nt.gl.texImage2D(3553,0,Nt.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,Nt.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:Nt.gl.texImage2D(3553,0,Nt.gl2?33326:6406,this.get_width(),this.get_height(),0,Nt.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:Nt.gl.texImage2D(3553,0,Nt.gl2?33325:6406,this.get_width(),this.get_height(),0,Nt.gl2?6403:6406,Nt.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:Nt.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}Nt.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){null!=this.texture&&Nt.gl.deleteTexture(this.texture),null!=this.depthTexture&&Nt.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&Nt.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&Nt.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(e){Nt.gl.bindTexture(3553,this.texture),Nt.gl.generateMipmap(3553)},setMipmaps:function(e){if(Nt.gl.bindTexture(3553,this.texture),this.format==Ya.RGBA128)for(var t=0,a=e.length;t<a;){var i=t++;Nt.gl.texImage2D(3553,i+1,Nt.gl2?34836:6408,e[i].get_width(),e[i].get_height(),0,6408,5126,tt.__cast(e[i],St).image)}else if(this.format==Ya.RGBA64)for(var s=0,r=e.length;s<r;){var n=s++;Nt.gl.texImage2D(3553,n+1,Nt.gl2?34842:6408,e[n].get_width(),e[n].get_height(),0,6408,Nt.halfFloat.HALF_FLOAT_OES,tt.__cast(e[n],St).image)}else for(var l=0,o=e.length;l<o;){var h=l++;Nt.gl.texImage2D(3553,h+1,6408,6408,5121,tt.__cast(e[h],St).image)}},__class__:St});var Gt=function(){};a["kha.audio1.AudioChannel"]=Gt,Gt.__name__=!0,Gt.prototype={__class__:Gt};var kt=function(){};a["kha.audio2.Audio"]=kt,kt.__name__=!0,kt.initContext=function(){try{return void(kt._context=new AudioContext)}catch(e){}try{return void(this._context=new webkitAudioContext)}catch(e){}},kt._init=function(){if(kt.initContext(),null==kt._context)return!1;return kt.buffer=new Zt(8192,2,0|kt._context.sampleRate),kt.processingNode=kt._context.createScriptProcessor(2048,0,2),kt.processingNode.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),a=e.outputBuffer.getChannelData(1);if(null!=kt.audioCallback){kt.audioCallback(2*e.outputBuffer.length,kt.buffer);for(var i=0,s=e.outputBuffer.length;i<s;){var r=i++;t[r]=kt.buffer.data[kt.buffer.readLocation],kt.buffer.readLocation+=1,a[r]=kt.buffer.data[kt.buffer.readLocation],kt.buffer.readLocation+=1,kt.buffer.readLocation>=kt.buffer.size&&(kt.buffer.readLocation=0)}}else for(var n=0,l=e.outputBuffer.length;n<l;){var o=n++;t[o]=0,a[o]=0}},kt.processingNode.connect(kt._context.destination),!0};var Dt=function(){};a["kha.audio2.Audio1"]=Dt,Dt.__name__=!0,Dt._init=function(){var e=new Array(16);Dt.soundChannels=e;var t=new Array(16);Dt.streamChannels=t;var a=new Array(16);Dt.internalSoundChannels=a;var i=new Array(16);Dt.internalStreamChannels=i;var s=new Array(512);Dt.sampleCache1=s;var r=new Array(512);Dt.sampleCache2=r,kt.audioCallback=Dt.mix},Dt.mix=function(e,t){if(Dt.sampleCache1.length<e){var a=new Array(e);Dt.sampleCache1=a;var i=new Array(e);Dt.sampleCache2=i}for(var s=0,r=e;s<r;){var n=s++;Dt.sampleCache2[n]=0}for(var l=0;l<16;){var o=l++;Dt.internalSoundChannels[o]=Dt.soundChannels[o]}for(var h=0;h<16;){var c=h++;Dt.internalStreamChannels[c]=Dt.streamChannels[c]}for(var d=0,u=Dt.internalSoundChannels;d<u.length;){var g=u[d];if(++d,null!=g&&!g.get_finished()){g.nextSamples(Dt.sampleCache1,e,t.samplesPerSecond);for(var f=0,p=e;f<p;){var m=f++,v=m,_=Dt.sampleCache2,I=Dt.sampleCache1[m]*g.get_volume();_[v]=_[v]+I}}}for(var w=0,b=Dt.internalStreamChannels;w<b.length;){var C=b[w];if(++w,null!=C&&!C.get_finished()){C.nextSamples(Dt.sampleCache1,e,t.samplesPerSecond);for(var A=0,M=e;A<M;){var B=A++,y=B,N=Dt.sampleCache2,S=Dt.sampleCache1[B]*C.get_volume();N[y]=N[y]+S}}}for(var G=0,k=e;G<k;){var D=G++,x=Dt.sampleCache2[D],Z=x<1?x:1;t.data[t.writeLocation]=Z>-1?Z:-1,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}},Dt.play=function(e,t){null==t&&(t=!1);for(var a=null,i=0;i<16;){var s=i++;if(null==Dt.soundChannels[s]||Dt.soundChannels[s].get_finished()){(a=new xt(t)).data=e.uncompressedData,Dt.soundChannels[s]=a;break}}return a};var xt=function(e){this.paused=!1,this.looping=e,this.myVolume=1,this.myPosition=0};a["kha.audio2.AudioChannel"]=xt,xt.__name__=!0,xt.__interfaces__=[Gt],xt.prototype={nextSamples:function(e,t,a){if(this.paused)for(var i=0,s=t;i<s;){e[i++]=0}else{for(var r=0,n=0;r<t;){for(var l=this.data.length-this.myPosition,o=l<t-r?l:t-r;n<o;)e[r]=this.data[this.myPosition],++this.myPosition,++n,++r;if(!this.looping)break;n=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;r<t;)e[r]=0,++r}},get_volume:function(){return this.myVolume},get_finished:function(){return this.myPosition>=this.data.length},__class__:xt,__properties__:{get_finished:"get_finished",get_volume:"get_volume"}};var Zt=function(e,t,a){this.size=e;var i=new Array(e);this.data=i,this.channels=t,this.samplesPerSecond=a,this.readLocation=0,this.writeLocation=0};a["kha.audio2.Buffer"]=Zt,Zt.__name__=!0,Zt.prototype={__class__:Zt};var zt=function(){this.paused=!1,this.atend=!1};a["kha.audio2.StreamChannel"]=zt,zt.__name__=!0,zt.__interfaces__=[Gt],zt.prototype={nextSamples:function(e,t,a){if(this.paused)for(var i=0,s=t;i<s;){e[i++]=0}else{var r=2*this.reader.read(e,t/2|0,2,a,!0);if(r<t){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var n=r,l=t;n<l;){e[n++]=0}}}},get_volume:function(){return this.myVolume},get_finished:function(){return this.atend},__class__:zt,__properties__:{get_finished:"get_finished",get_volume:"get_volume"}};var Wt=function(){};a["kha.audio2.ogg.tools.Crc32"]=Wt,Wt.__name__=!0,Wt.init=function(){if(null==Wt.table){var e=new Array(256);Wt.table=e;for(var t=0;t<256;){for(var a=t++,i=a<<24,s=0;s<8;){s++;i=i<<1^(v.gte(i,1<<31)?79764919:0)}Wt.table[a]=i}}};var Tt=function(e,t,a){this.seekFunc=t,this.inputLength=a,this.decoder=Ft.start(e),this.decoder.setupSampleNumber(t,a),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};a["kha.audio2.ogg.vorbis.Reader"]=Tt,Tt.__name__=!0,Tt.openFromBytes=function(e){var t=new F(e),a=t;return new Tt(t,function(e){Tt.seekBytes(a,e)},e.length)},Tt.seekBytes=function(e,t){e.set_position(t)},Tt.readAll=function(e,t,a){null==a&&(a=!1);var i=new F(e),s=Ft.start(i),r=i;s.setupSampleNumber(function(e){Tt.seekBytes(r,e)},e.length);for(var n=s.header,l=4096*n.channel,o=new Array(l);;){for(var h=s.read(o,4096,n.channel,n.sampleRate,a),c=0,d=h*n.channel;c<d;){var u=c++;t.writeFloat(o[u])}if(0==h)break;h}return s.header},Tt.prototype={get_header:function(){return this.decoder.header},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(e){return this.decoder.seek(this.seekFunc,this.inputLength,e),this.decoder.currentSample},get_currentMillisecond:function(){var e=this.get_currentSample(),t=this.get_header().sampleRate;return v.toFloat(e)/v.toFloat(t)*1e3},set_currentMillisecond:function(e){var t=e/1e3,a=this.get_header().sampleRate;return this.set_currentSample(Math.floor(v.toFloat(a)*t)),this.get_currentMillisecond()},read:function(e,t,a,i,s){return null==s&&(s=!1),this.decoder.ensurePosition(this.seekFunc),null==t&&(t=this.decoder.totalSample),null==a&&(a=this.get_header().channel),null==i&&(i=this.get_header().sampleRate),this.decoder.read(e,t,a,i,s)},__class__:Tt,__properties__:{set_currentMillisecond:"set_currentMillisecond",get_currentMillisecond:"get_currentMillisecond",set_currentSample:"set_currentSample",get_currentSample:"get_currentSample",get_header:"get_header"}};var Vt=function(e){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=e,this.inputPosition=0,this.page=new Jt,Wt.init()};a["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Vt,Vt.__name__=!0,Vt.prototype={setup:function(e,t){this.inputPosition+=1;var a=this.input.readByte();this.inputPosition+=a;for(var i=new Array(a),s=0,r=a;s<r;){i[s++]=this.input.readByte()}if(this.segments=i,this.endSegWithKnownLoc=-2,-1!=e||-1!=t)for(var n=a-1;n>=0&&!(this.segments[n]<255);)n>=0&&(this.endSegWithKnownLoc=n,this.knownLocForPacket=e),--n;if(this.firstDecode){for(var l=0,o=new qt,h=0,c=a;h<c;){var d=h++;l+=this.segments[d]}l+=27+a,o.pageStart=this.firstAudioPageOffset,o.pageEnd=o.pageStart+l,o.firstDecodedSample=0,o.lastDecodedSample=e,this.pFirst=o}this.nextSeg=0},clone:function(e){var t=m.createEmptyInstance(Vt);return e(this.inputPosition),t.input=this.input,t.eof=this.eof,t.validBits=this.validBits,t.discardSamplesDeferred=this.discardSamplesDeferred,t.firstDecode=this.firstDecode,t.nextSeg=this.nextSeg,t.bytesInSeg=this.bytesInSeg,t.acc=t.acc,t.lastSeg=this.lastSeg,t.lastSegWhich=this.lastSegWhich,t.currentLoc=this.currentLoc,t.currentLocValid=this.currentLocValid,t.inputPosition=this.inputPosition,t.firstAudioPageOffset=this.firstAudioPageOffset,t.error=this.error,t.segments=this.segments,t.pFirst=this.pFirst,t.pLast=this.pLast,t.page=this.page.clone(),t},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(e){if(e instanceof et&&(e=e.val),tt.__instanceof(e,$t))return this.lastSeg=!0,this.error=e,0;throw e}if(0==(1&this.page.flag))throw new et(new $t(ea.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var e=this.segments[this.nextSeg++];e<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1);this.bytesInSeg;return this.bytesInSeg=e,e},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new et(new $t(ea.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,t,a,i,s=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){if(t instanceof et&&(t=t.val),!tt.__instanceof(t,R))throw t;s=!0,e=0}if(s)return!1;if(79==e?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?a=!0:(this.inputPosition+=1,a=103!=this.input.readByte()),a?t=!0:(this.inputPosition+=1,t=83!=this.input.readByte()),t)throw new et(new $t(ea.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(e){if(this.validBits<0)return 0;if(this.validBits<e){if(e>24)return this.readBits(24)+(this.readBits(e-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<e))break}if(this.validBits<0)return 0;var t=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,t}var a=this.acc&(1<<e)-1;return this.acc=this.acc>>>e,this.validBits-=e,a},firstPageValidate:function(){if(1!=this.segments.length)throw new et(new $t(ea.INVALID_FIRST_PAGE,"segmentCount",{fileName:"VorbisDecodeState.hx",lineNumber:307,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new et(new $t(ea.INVALID_FIRST_PAGE,"decodeState head",{fileName:"VorbisDecodeState.hx",lineNumber:310,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},finishDecodePacket:function(e,t,a){var i=a.left.start,s=!1,r=t>>1;if(this.firstDecode)this.currentLoc=-r,this.discardSamplesDeferred=t-a.right.end,s=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)a.left.start+=this.discardSamplesDeferred,i=a.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(s&&0!=(4&this.page.flag)){var n=this.knownLocForPacket-(t-a.right.end);if(n<this.currentLoc+a.right.end){var l=n<this.currentLoc?0:n-this.currentLoc;return l+=a.left.start,this.currentLoc+=l,{len:l,left:i,right:a.right.start}}}this.currentLoc=this.knownLocForPacket-(r-a.left.start),s=!0}return s&&(this.currentLoc+=a.right.start-a.left.start),{len:a.right.end,left:i,right:a.right.start}},getSampleNumber:function(e,t){var a=this.inputPosition,i=v.gte(t,65536)&&v.gte(t-65536,this.firstAudioPageOffset)?t-65536:this.firstAudioPageOffset;e(this.inputPosition=i);var s=0,r=!1,n=this.findPage(e,t);switch(n[1]){case 0:var l=n[3];s=n[2],r=l;break;case 1:throw new et(new $t(ea.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:518,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var o=this.inputPosition;try{for(;!r;){e(this.inputPosition=s);var h=this.findPage(e,t);switch(h[1]){case 0:var c=h[3];s=h[2],r=c;break;case 1:throw"__break__"}i=o+1,o=this.inputPosition}}catch(e){if("__break__"!=e)throw e}e(this.inputPosition=o),this.inputPosition+=6;for(var d=new Array(6),u=0;u<6;){d[u++]=this.input.readByte()}this.inputPosition+=4;var g=this.input.readInt32();this.inputPosition+=4;var f=this.input.readInt32();if(-1==g&&-1==f||f>0)throw new et(new $t(ea.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:552,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new qt,this.pLast.pageStart=o,this.pLast.pageEnd=s,this.pLast.lastDecodedSample=g,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=i,e(this.inputPosition=a),g},findPage:function(e,t){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var a,i,s=this.inputPosition;if(s-25>t)return Kt.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?a=!0:(this.inputPosition+=1,a=83!=this.input.readByte()),a)continue;var r=new Array(27);r[0]=79,r[1]=103,r[2]=103,r[3]=83;for(var n=4;n<27;){var l=n++;this.inputPosition+=1,r[l]=this.input.readByte()}if(0!=r[4]){e(this.inputPosition=s);continue}for(var o=r[22]+(r[23]<<8)+(r[24]<<16)+(r[25]<<24),h=22;h<26;){r[h++]=0}for(var c=0,d=0;d<27;){var u=d++;c=c<<8^Wt.table[r[u]^c>>>24]}var g=0;try{for(var f=0,p=r[26];f<p;){f++;this.inputPosition+=1;var m=this.input.readByte();c=c<<8^Wt.table[m^c>>>24],g+=m}for(var v=0,_=g;v<_;){v++;this.inputPosition+=1;var I=this.input.readByte();c=c<<8^Wt.table[I^c>>>24]}}catch(e){if(e instanceof et&&(e=e.val),tt.__instanceof(e,R))return Kt.NotFound;throw e}if(c==o){var w=this.inputPosition;return e(this.inputPosition=s-1),Kt.Found(w,0!=(4&r[5]))}}}}catch(e){if(e instanceof et&&(e=e.val),tt.__instanceof(e,R))return Kt.NotFound;throw e}},analyzePage:function(e,t){var a=new qt,i=new Array(255);a.pageStart=this.inputPosition,this.inputPosition+=27;for(var s=new Array(27),r=0;r<27;){s[r++]=this.input.readByte()}var n=s,l=n[26];this.inputPosition+=l;for(var o=new Array(l),h=0,c=l;h<c;){o[h++]=this.input.readByte()}for(var d=o,u=0,g=0,f=n[26];g<f;){u+=d[g++]}if(a.pageEnd=a.pageStart+27+n[26]+u,a.lastDecodedSample=n[6]+(n[7]<<8)+(n[8]<<16)+(n[9]<<16),0!=(4&n[5]))return a.firstDecodedSample=null,e(this.inputPosition=a.pageStart),a;for(var p=0,m=0==(1&n[5]),v=t.modes.length,_=0,I=n[26];_<I;){var w=_++;if(m){if(0==d[w])return e(this.inputPosition=a.pageStart),null;this.inputPosition+=1;var b=this.input.readByte();if(0!=(1&b))return e(this.inputPosition=a.pageStart),null;b>>=1;var C=v-1,A=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if((b&=(1<<(C<16384?C<16?A[C]:C<512?5+A[C>>5]:10+A[C>>10]:C<16777216?C<524288?15+A[C>>15]:20+A[C>>20]:C<536870912?25+A[C>>25]:C<-2147483648?30+A[C>>30]:0))-1)>=v)return e(this.inputPosition=a.pageStart),null;i[p++]=t.modes[b].blockflag;var M=d[w]-1;this.inputPosition+=M;for(var B=new Array(M),y=0,N=M;y<N;){B[y++]=this.input.readByte()}}else{var S=d[w];this.inputPosition+=S;for(var G=new Array(S),k=0,D=S;k<D;){G[k++]=this.input.readByte()}}m=d[w]<255}var x=0;p>1&&(x+=i[p-1]?t.blocksize1:t.blocksize0);for(var Z=p-2;Z>=1;)i[--Z]?i[Z+1]?x+=t.blocksize1>>1:x+=(t.blocksize1-t.blocksize0>>2)+(t.blocksize0>>1):x+=t.blocksize0>>1,--Z;return a.firstDecodedSample=a.lastDecodedSample-x,e(this.inputPosition=a.pageStart),a},decodeScalarRaw:function(e){this.prepHuffman();null!=e.sortedCodewords||e.codewords;var t=e.codewordLengths,a=e.codewords,i=e.sortedCodewords;if(e.entries>8?null!=i:null!=a){for(var s=this.acc,r=(s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8)>>>16|s<<16,n=0,l=e.sortedEntries;l>1;){var o=n+(l>>1);v.gte(r,i[o])?(n=o,l-=l>>1):l>>=1}e.sparse||(n=e.sortedValues[n]);var h=t[n];return this.validBits>=h?(this.acc=this.acc>>>h,this.validBits-=h,n):(this.validBits=0,-1)}e.sparse;for(var c=0,d=e.entries;c<d;){var u=c++,g=t[u];if(255!=g&&a[u]==(this.acc&(1<<g)-1))return this.validBits>=g?(this.acc=this.acc>>>g,this.validBits-=g,u):(this.validBits=0,-1)}return this.error=new $t(ea.INVALID_STREAM,null,{fileName:"VorbisDecodeState.hx",lineNumber:846,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:Vt};var Kt=a["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"]};Kt.Found=function(e,t){var a=["Found",0,e,t];return a.__enum__=Kt,a.toString=i,a},Kt.NotFound=["NotFound",1],Kt.NotFound.toString=i,Kt.NotFound.__enum__=Kt;var Ft=function(e,t){this.header=e,this.decodeState=t,this.totalSample=null,this.currentSample=0,this.previousLength=0;var a=e.channel,i=new Array(a);this.channelBuffers=i;var s=e.channel,r=new Array(s);this.previousWindow=r;var n=e.channel,l=new Array(n);this.finalY=l;for(var o=0,h=e.channel;o<h;){var c=o++,d=this.channelBuffers,u=e.blocksize1,g=new Array(u);d[c]=g;var f=this.previousWindow,p=e.blocksize1/2|0,m=new Array(p);f[c]=m,this.finalY[c]=[]}var v=new Array(2);this.a=v;var _=new Array(2);this.b=_;var I=new Array(2);this.c=I;var w=new Array(2);this.window=w;var b=new Array(2);this.bitReverseData=b,this.initBlocksize(0,e.blocksize0),this.initBlocksize(1,e.blocksize1)};a["kha.audio2.ogg.vorbis.VorbisDecoder"]=Ft,Ft.__name__=!0,Ft.start=function(e){var t=new Vt(e),a=Et.read(t),i=new Ft(a,t);return t.startFirstDecode(),i.pumpFirstFrame(),i},Ft.prototype={read:function(e,t,a,i,s){var r=this.header.sampleRate;if(0!=(v.toFloat(i)%v.toFloat(r)|0))throw new et("Unsupported sampleRate : can't convert "+f.string(v.toFloat(this.header.sampleRate))+" to "+i);if(a%this.header.channel!=0)throw new et("Unsupported channels : can't convert "+this.header.channel+" to "+a);var n=this.header.sampleRate,l=v.toFloat(i)/v.toFloat(n)|0,o=a/this.header.channel|0,h=0,c=Math.floor(t/l);null!=this.totalSample&&c>this.totalSample-this.currentSample&&(c=this.totalSample-this.currentSample);for(var d=0;h<c;){var u=this.channelBufferEnd-this.channelBufferStart;u>=c-h&&(u=c-h);for(var g=this.channelBufferStart,p=this.channelBufferStart+u;g<p;)for(var m=g++,_=0,I=l;_<I;){_++;for(var w=0,b=this.header.channel;w<b;)for(var C=w++,A=0,M=o;A<M;){A++;var B=this.channelBuffers[C][m];B>1?B=1:B<-1&&(B=-1),s&&(e[d]=B,++d)}}if(h+=u,this.channelBufferStart+=u,h==c||0==this.getFrameFloat())break}for(var y=h,N=c;y<N;){y++;for(var S=0,G=l;S<G;){S++;for(var k=0,D=this.header.channel;k<D;){k++;for(var x=0,Z=o;x<Z;){x++;s&&(e[d]=0,++d)}}}}return this.currentSample+=c,c*l},skipSamples:function(e){var t=0;for(null!=this.totalSample&&e>this.totalSample-this.currentSample&&(e=this.totalSample-this.currentSample);t<e;){var a=this.channelBufferEnd-this.channelBufferStart;if(a>=e-t&&(a=e-t),t+=a,this.channelBufferStart+=a,t==e||0==this.getFrameFloat())break}return this.currentSample+=e,e},setupSampleNumber:function(e,t){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(e,t))},seek:function(e,t,a){if(this.currentSample!=a){if(null==this.totalSample&&(this.setupSampleNumber(e,t),0==this.totalSample))throw new et(new $t(ea.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));a<0&&(a=0);var i=this.decodeState.pFirst,s=this.decodeState.pLast;if(a>=s.lastDecodedSample&&(a=s.lastDecodedSample-1),a<i.lastDecodedSample)this.seekFrameFromPage(e,i.pageStart,0,a);else{for(var r=0;i.pageEnd<s.pageStart;){var n=i.pageEnd,l=s.afterPreviousPageStart,o=i.lastDecodedSample,h=s.lastDecodedSample;if(null==o||null==h)throw new et(new $t(ea.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));v.gt(l,n+4e3)&&(l-=4e3);var c=n+Math.floor(v.toFloat(l-n)/v.toFloat(h-o)*(a-o));if(r>=4){var d=n+(l-n>>>1);r>=8?c=d:v.gt(d,c)?c+=d-c>>>1:c=d+(c-d>>>1)}switch(++r,e(this.decodeState.inputPosition=c),this.decodeState.findPage(e,t)[1]){case 0:break;case 1:throw new et(new $t(ea.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var u=this.decodeState.analyzePage(e,this.header);if(null==u)throw new et(new $t(ea.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));u.afterPreviousPageStart=c,u.pageStart!=s.pageStart?a<u.lastDecodedSample?s=u:i=u:s=u}if(!(i.lastDecodedSample<=a&&a<s.lastDecodedSample))throw new et(new $t(ea.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(e,s.pageStart,i.lastDecodedSample,a)}}},seekFrameFromPage:function(e,t,a,i){var s=0,r=a;e(this.decodeState.inputPosition=t),this.decodeState.nextSeg=-1;for(var n=0,l=0,o=null,h=null;;){o=h,h=this.decodeState.clone(e);var c=this.decodeInitial();if(null==c){h=o;break}l=c.left.start,n=c.left.end;var d=0==s?n:l;if(i<r+c.right.start-d)break;for(var u=this.decodeState;0!=u.bytesInSeg||!u.lastSeg&&0!=u.next();)u.bytesInSeg--,u.inputPosition+=1,u.input.readByte();r+=c.right.start-d,++s}this.decodeState=h,e(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=r,this.skipSamples(i-r)},ensurePosition:function(e){e(this.decodeState.inputPosition)},getFrameFloat:function(){var e=this.decodePacket();if(null==e)return this.channelBufferStart=this.channelBufferEnd=0,0;var t=this.finishFrame(e);return this.channelBufferStart=e.left,this.channelBufferEnd=e.left+t,t},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(e){var t=e.len,a=e.right,i=e.left;if(0!=this.previousLength)for(var s=this.previousLength,r=this.getWindow(s),n=0,l=this.header.channel;n<l;)for(var o=n++,h=this.channelBuffers[o],c=this.previousWindow[o],d=0,u=s;d<u;){var g=d++;h[i+g]=h[i+g]*r[g]+c[g]*r[s-1-g]}var f=this.previousLength;this.previousLength=t-a;for(var p=0,m=this.header.channel;p<m;)for(var v=p++,_=this.previousWindow[v],I=this.channelBuffers[v],w=0,b=t-a;w<b;){var C=w++;_[C]=I[a+C]}return 0==f?0:(t<a&&(a=t),a-i)},getWindow:function(e){return(e<<=1)==this.header.blocksize0?this.window[0]:e==this.header.blocksize1?this.window[1]:null},initBlocksize:function(e,t){var a=t>>1,i=t>>2,s=t>>3,r=this.a,n=new Array(a);r[e]=n;var l=this.b,o=new Array(a);l[e]=o;var h=this.c,c=new Array(i);h[e]=c;var d=this.window,u=new Array(a);d[e]=u;var g=this.bitReverseData,f=new Array(s);g[e]=f,Yt.computeTwiddleFactors(t,this.a[e],this.b[e],this.c[e]),Yt.computeWindow(t,this.window[e]),Yt.computeBitReverse(t,this.bitReverseData[e])},inverseMdct:function(e,t,a){for(var i=a?1:0,s=this.a[i],r=this.b[i],n=this.c[i],l=this.bitReverseData[i],o=t>>1,h=t>>2,c=t>>3,d=new Array(o),u=o-2,g=0,f=0,p=o;f!=p;)d[u+1]=e[f]*s[g]-e[f+2]*s[g+1],d[u]=e[f]*s[g+1]+e[f+2]*s[g],u-=2,g+=2,f+=4;for(f=o-3;u>=0;)d[u+1]=-e[f+2]*s[g]- -e[f]*s[g+1],d[u]=-e[f+2]*s[g+1]+-e[f]*s[g],u-=2,g+=2,f-=4;for(var m=e,v=d,_=o-8,I=h,w=0,b=h,C=0;_>=0;){var A=v[I+1]-v[w+1],M=v[I]-v[w];m[b+1]=v[I+1]+v[w+1],m[b]=v[I]+v[w],m[C+1]=A*s[_+4]-M*s[_+5],m[C]=M*s[_+4]+A*s[_+5],A=v[I+3]-v[w+3],M=v[I+2]-v[w+2],m[b+3]=v[I+3]+v[w+3],m[b+2]=v[I+2]+v[w+2],m[C+3]=A*s[_]-M*s[_+1],m[C+2]=M*s[_]+A*s[_+1],_-=8,b+=4,C+=4,I+=4,w+=4}for(var B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],y=(t<16384?t<16?B[t]:t<512?5+B[t>>5]:10+B[t>>10]:t<16777216?t<524288?15+B[t>>15]:20+B[t>>20]:t<536870912?25+B[t>>25]:t<-2147483648?30+B[t>>30]:0)-1,N=o-1-0*h,S=N,G=N+-(t>>3),k=0,D=1+(t>>4>>2);--D>0;){var x=m[S]-m[G],Z=m[S+-1]-m[G+-1],z=S,W=m;W[z]=W[z]+m[G];var T=S+-1,V=m;V[T]=V[T]+m[G+-1],m[G]=x*s[k]-Z*s[k+1],m[G+-1]=Z*s[k]+x*s[k+1],k+=8,x=m[S+-2]-m[G+-2],Z=m[S+-3]-m[G+-3];var K=S+-2,F=m;F[K]=F[K]+m[G+-2];var Y=S+-3,H=m;H[Y]=H[Y]+m[G+-3],m[G+-2]=x*s[k]-Z*s[k+1],m[G+-3]=Z*s[k]+x*s[k+1],k+=8,x=m[S+-4]-m[G+-4],Z=m[S+-5]-m[G+-5];var R=S+-4,L=m;L[R]=L[R]+m[G+-4];var X=S+-5,j=m;j[X]=j[X]+m[G+-5],m[G+-4]=x*s[k]-Z*s[k+1],m[G+-5]=Z*s[k]+x*s[k+1],k+=8,x=m[S+-6]-m[G+-6],Z=m[S+-7]-m[G+-7];var E=S+-6,O=m;O[E]=O[E]+m[G+-6];var U=S+-7,P=m;P[U]=P[U]+m[G+-7],m[G+-6]=x*s[k]-Z*s[k+1],m[G+-7]=Z*s[k]+x*s[k+1],k+=8,S-=8,G-=8}for(var Q=o-1-h,J=Q,q=Q+-(t>>3),$=0,ee=1+(t>>4>>2);--ee>0;){var te=m[J]-m[q],ae=m[J+-1]-m[q+-1],ie=J,se=m;se[ie]=se[ie]+m[q];var re=J+-1,ne=m;ne[re]=ne[re]+m[q+-1],m[q]=te*s[$]-ae*s[$+1],m[q+-1]=ae*s[$]+te*s[$+1],$+=8,te=m[J+-2]-m[q+-2],ae=m[J+-3]-m[q+-3];var le=J+-2,oe=m;oe[le]=oe[le]+m[q+-2];var he=J+-3,ce=m;ce[he]=ce[he]+m[q+-3],m[q+-2]=te*s[$]-ae*s[$+1],m[q+-3]=ae*s[$]+te*s[$+1],$+=8,te=m[J+-4]-m[q+-4],ae=m[J+-5]-m[q+-5];var de=J+-4,ue=m;ue[de]=ue[de]+m[q+-4];var ge=J+-5,fe=m;fe[ge]=fe[ge]+m[q+-5],m[q+-4]=te*s[$]-ae*s[$+1],m[q+-5]=ae*s[$]+te*s[$+1],$+=8,te=m[J+-6]-m[q+-6],ae=m[J+-7]-m[q+-7];var pe=J+-6,me=m;me[pe]=me[pe]+m[q+-6];var ve=J+-7,_e=m;_e[ve]=_e[ve]+m[q+-7],m[q+-6]=te*s[$]-ae*s[$+1],m[q+-7]=ae*s[$]+te*s[$+1],$+=8,J-=8,q-=8}for(var Ie=o-1-0*c,we=0,be=Ie,Ce=Ie+-(t>>4),Ae=1+(t>>5>>2);--Ae>0;){var Me=m[be]-m[Ce],Be=m[be+-1]-m[Ce+-1],ye=be,Ne=m;Ne[ye]=Ne[ye]+m[Ce];var Se=be+-1,Ge=m;Ge[Se]=Ge[Se]+m[Ce+-1],m[Ce]=Me*s[we]-Be*s[we+1],m[Ce+-1]=Be*s[we]+Me*s[we+1],we+=16,Me=m[be+-2]-m[Ce+-2],Be=m[be+-3]-m[Ce+-3];var ke=be+-2,De=m;De[ke]=De[ke]+m[Ce+-2];var xe=be+-3,Ze=m;Ze[xe]=Ze[xe]+m[Ce+-3],m[Ce+-2]=Me*s[we]-Be*s[we+1],m[Ce+-3]=Be*s[we]+Me*s[we+1],we+=16,Me=m[be+-4]-m[Ce+-4],Be=m[be+-5]-m[Ce+-5];var ze=be+-4,We=m;We[ze]=We[ze]+m[Ce+-4];var Te=be+-5,Ve=m;Ve[Te]=Ve[Te]+m[Ce+-5],m[Ce+-4]=Me*s[we]-Be*s[we+1],m[Ce+-5]=Be*s[we]+Me*s[we+1],we+=16,Me=m[be+-6]-m[Ce+-6],Be=m[be+-7]-m[Ce+-7];var Ke=be+-6,Fe=m;Fe[Ke]=Fe[Ke]+m[Ce+-6];var Ye=be+-7,He=m;He[Ye]=He[Ye]+m[Ce+-7],m[Ce+-6]=Me*s[we]-Be*s[we+1],m[Ce+-7]=Be*s[we]+Me*s[we+1],be-=8,Ce-=8,we+=16}for(var Re=o-1-c,Le=0,Xe=Re,je=Re+-(t>>4),Ee=1+(t>>5>>2);--Ee>0;){var Oe=m[Xe]-m[je],Ue=m[Xe+-1]-m[je+-1],Pe=Xe,Qe=m;Qe[Pe]=Qe[Pe]+m[je];var Je=Xe+-1,qe=m;qe[Je]=qe[Je]+m[je+-1],m[je]=Oe*s[Le]-Ue*s[Le+1],m[je+-1]=Ue*s[Le]+Oe*s[Le+1],Le+=16,Oe=m[Xe+-2]-m[je+-2],Ue=m[Xe+-3]-m[je+-3];var $e=Xe+-2,et=m;et[$e]=et[$e]+m[je+-2];var tt=Xe+-3,at=m;at[tt]=at[tt]+m[je+-3],m[je+-2]=Oe*s[Le]-Ue*s[Le+1],m[je+-3]=Ue*s[Le]+Oe*s[Le+1],Le+=16,Oe=m[Xe+-4]-m[je+-4],Ue=m[Xe+-5]-m[je+-5];var it=Xe+-4,st=m;st[it]=st[it]+m[je+-4];var rt=Xe+-5,nt=m;nt[rt]=nt[rt]+m[je+-5],m[je+-4]=Oe*s[Le]-Ue*s[Le+1],m[je+-5]=Ue*s[Le]+Oe*s[Le+1],Le+=16,Oe=m[Xe+-6]-m[je+-6],Ue=m[Xe+-7]-m[je+-7];var lt=Xe+-6,ot=m;ot[lt]=ot[lt]+m[je+-6];var ht=Xe+-7,ct=m;ct[ht]=ct[ht]+m[je+-7],m[je+-6]=Oe*s[Le]-Ue*s[Le+1],m[je+-7]=Ue*s[Le]+Oe*s[Le+1],Xe-=8,je-=8,Le+=16}for(var dt=o-1-2*c,ut=0,gt=dt,ft=dt+-(t>>4),pt=1+(t>>5>>2);--pt>0;){var mt=m[gt]-m[ft],vt=m[gt+-1]-m[ft+-1],_t=gt,It=m;It[_t]=It[_t]+m[ft];var wt=gt+-1,bt=m;bt[wt]=bt[wt]+m[ft+-1],m[ft]=mt*s[ut]-vt*s[ut+1],m[ft+-1]=vt*s[ut]+mt*s[ut+1],ut+=16,mt=m[gt+-2]-m[ft+-2],vt=m[gt+-3]-m[ft+-3];var Ct=gt+-2,At=m;At[Ct]=At[Ct]+m[ft+-2];var Mt=gt+-3,Bt=m;Bt[Mt]=Bt[Mt]+m[ft+-3],m[ft+-2]=mt*s[ut]-vt*s[ut+1],m[ft+-3]=vt*s[ut]+mt*s[ut+1],ut+=16,mt=m[gt+-4]-m[ft+-4],vt=m[gt+-5]-m[ft+-5];var yt=gt+-4,Nt=m;Nt[yt]=Nt[yt]+m[ft+-4];var St=gt+-5,Gt=m;Gt[St]=Gt[St]+m[ft+-5],m[ft+-4]=mt*s[ut]-vt*s[ut+1],m[ft+-5]=vt*s[ut]+mt*s[ut+1],ut+=16,mt=m[gt+-6]-m[ft+-6],vt=m[gt+-7]-m[ft+-7];var kt=gt+-6,Dt=m;Dt[kt]=Dt[kt]+m[ft+-6];var xt=gt+-7,Zt=m;Zt[xt]=Zt[xt]+m[ft+-7],m[ft+-6]=mt*s[ut]-vt*s[ut+1],m[ft+-7]=vt*s[ut]+mt*s[ut+1],gt-=8,ft-=8,ut+=16}for(var zt=o-1-3*c,Wt=0,Tt=zt,Vt=zt+-(t>>4),Kt=1+(t>>5>>2);--Kt>0;){var Ft=m[Tt]-m[Vt],Yt=m[Tt+-1]-m[Vt+-1],Ht=Tt,Rt=m;Rt[Ht]=Rt[Ht]+m[Vt];var Lt=Tt+-1,Xt=m;Xt[Lt]=Xt[Lt]+m[Vt+-1],m[Vt]=Ft*s[Wt]-Yt*s[Wt+1],m[Vt+-1]=Yt*s[Wt]+Ft*s[Wt+1],Wt+=16,Ft=m[Tt+-2]-m[Vt+-2],Yt=m[Tt+-3]-m[Vt+-3];var jt=Tt+-2,Et=m;Et[jt]=Et[jt]+m[Vt+-2];var Ot=Tt+-3,Ut=m;Ut[Ot]=Ut[Ot]+m[Vt+-3],m[Vt+-2]=Ft*s[Wt]-Yt*s[Wt+1],m[Vt+-3]=Yt*s[Wt]+Ft*s[Wt+1],Wt+=16,Ft=m[Tt+-4]-m[Vt+-4],Yt=m[Tt+-5]-m[Vt+-5];var Pt=Tt+-4,Qt=m;Qt[Pt]=Qt[Pt]+m[Vt+-4];var Jt=Tt+-5,qt=m;qt[Jt]=qt[Jt]+m[Vt+-5],m[Vt+-4]=Ft*s[Wt]-Yt*s[Wt+1],m[Vt+-5]=Yt*s[Wt]+Ft*s[Wt+1],Wt+=16,Ft=m[Tt+-6]-m[Vt+-6],Yt=m[Tt+-7]-m[Vt+-7];var $t=Tt+-6,ea=m;ea[$t]=ea[$t]+m[Vt+-6];var ta=Tt+-7,aa=m;aa[ta]=aa[ta]+m[Vt+-7],m[Vt+-6]=Ft*s[Wt]-Yt*s[Wt+1],m[Vt+-7]=Yt*s[Wt]+Ft*s[Wt+1],Tt-=8,Vt-=8,Wt+=16}for(var ia=2,sa=y-3>>1;ia<sa;)for(var ra=ia++,na=t>>ra+2,la=na>>1,oa=0,ha=1<<ra+1;oa<ha;)for(var ca=o-1-na*oa++,da=1<<ra+3,ua=0,ga=ca,fa=ca+-la,pa=1+(t>>ra+4>>2);--pa>0;){var ma=m[ga]-m[fa],va=m[ga+-1]-m[fa+-1],_a=ga,Ia=m;Ia[_a]=Ia[_a]+m[fa];var wa=ga+-1,ba=m;ba[wa]=ba[wa]+m[fa+-1],m[fa]=ma*s[ua]-va*s[ua+1],m[fa+-1]=va*s[ua]+ma*s[ua+1],ua+=da,ma=m[ga+-2]-m[fa+-2],va=m[ga+-3]-m[fa+-3];var Ca=ga+-2,Aa=m;Aa[Ca]=Aa[Ca]+m[fa+-2];var Ma=ga+-3,Ba=m;Ba[Ma]=Ba[Ma]+m[fa+-3],m[fa+-2]=ma*s[ua]-va*s[ua+1],m[fa+-3]=va*s[ua]+ma*s[ua+1],ua+=da,ma=m[ga+-4]-m[fa+-4],va=m[ga+-5]-m[fa+-5];var ya=ga+-4,Na=m;Na[ya]=Na[ya]+m[fa+-4];var Sa=ga+-5,Ga=m;Ga[Sa]=Ga[Sa]+m[fa+-5],m[fa+-4]=ma*s[ua]-va*s[ua+1],m[fa+-5]=va*s[ua]+ma*s[ua+1],ua+=da,ma=m[ga+-6]-m[fa+-6],va=m[ga+-7]-m[fa+-7];var ka=ga+-6,Da=m;Da[ka]=Da[ka]+m[fa+-6];var xa=ga+-7,Za=m;Za[xa]=Za[xa]+m[fa+-7],m[fa+-6]=ma*s[ua]-va*s[ua+1],m[fa+-7]=va*s[ua]+ma*s[ua+1],ga-=8,fa-=8,ua+=da}for(var za=y-3>>1,Wa=y-6;za<Wa;)for(var Ta=za++,Va=t>>Ta+2,Ka=1<<Ta+3,Fa=Va>>1,Ya=1<<Ta+1,Ha=0,Ra=o-1,La=(t>>Ta+6)+1;--La>0;){for(var Xa=s[Ha],ja=s[Ha+1],Ea=s[Ha+Ka],Oa=s[Ha+Ka+1],Ua=s[Ha+2*Ka],Pa=s[Ha+2*Ka+1],Qa=s[Ha+3*Ka],Ja=s[Ha+3*Ka+1],qa=Ra,$a=Ra+-Fa,ei=Ya+1;--ei>0;){var ti=m[qa]-m[$a],ai=m[qa+-1]-m[$a+-1];m[qa]=m[qa]+m[$a],m[qa+-1]=m[qa+-1]+m[$a+-1],m[$a]=ti*Xa-ai*ja,m[$a+-1]=ai*Xa+ti*ja,ti=m[qa+-2]-m[$a+-2],ai=m[qa+-3]-m[$a+-3],m[qa+-2]=m[qa+-2]+m[$a+-2],m[qa+-3]=m[qa+-3]+m[$a+-3],m[$a+-2]=ti*Ea-ai*Oa,m[$a+-3]=ai*Ea+ti*Oa,ti=m[qa+-4]-m[$a+-4],ai=m[qa+-5]-m[$a+-5],m[qa+-4]=m[qa+-4]+m[$a+-4],m[qa+-5]=m[qa+-5]+m[$a+-5],m[$a+-4]=ti*Ua-ai*Pa,m[$a+-5]=ai*Ua+ti*Pa,ti=m[qa+-6]-m[$a+-6],ai=m[qa+-7]-m[$a+-7],m[qa+-6]=m[qa+-6]+m[$a+-6],m[qa+-7]=m[qa+-7]+m[$a+-7],m[$a+-6]=ti*Qa-ai*Ja,m[$a+-7]=ai*Qa+ti*Ja,qa-=Va,$a-=Va}Ha+=4*Ka,Ra-=8}for(var ii=o-1,si=s[t>>3],ri=ii,ni=ii-16*(t>>5);ri>ni;){var li=m[ri],oi=m[ri+-8];m[ri+-8]=li-oi,m[ri]=li+oi,li=m[ri+-1],oi=m[ri+-9],m[ri+-9]=li-oi,m[ri+-1]=li+oi;var hi=(li=m[ri+-2])-(oi=m[ri+-10]);m[ri+-2]=li+oi;var ci=(li=m[ri+-3])-(oi=m[ri+-11]);m[ri+-3]=li+oi,m[ri+-10]=(hi+ci)*si,m[ri+-11]=(ci-hi)*si,li=m[ri+-4],hi=(oi=m[ri+-12])-li,m[ri+-4]=li+oi,ci=(li=m[ri+-5])-(oi=m[ri+-13]),m[ri+-5]=li+oi,m[ri+-12]=ci,m[ri+-13]=hi,li=m[ri+-6],hi=(oi=m[ri+-14])-li,m[ri+-6]=li+oi,ci=(li=m[ri+-7])-(oi=m[ri+-15]),m[ri+-7]=li+oi,m[ri+-14]=(hi+ci)*si,m[ri+-15]=(hi-ci)*si;var di=m[ri],ui=m[ri+-4],gi=di-ui,fi=di+ui,pi=(di=m[ri+-2])+(ui=m[ri+-6]),mi=di-ui;m[ri]=fi+pi,m[ri+-2]=fi-pi;var vi=m[ri+-3]-m[ri+-7];m[ri+-4]=gi+vi,m[ri+-6]=gi-vi;var _i=(di=m[ri+-1])-(ui=m[ri+-5]),Ii=di+ui,wi=m[ri+-3]+m[ri+-7];m[ri+-1]=Ii+wi,m[ri+-3]=Ii-wi,m[ri+-5]=_i-mi,m[ri+-7]=_i+mi;var bi=ri-8,Ci=m[bi],Ai=m[bi+-4],Mi=Ci-Ai,Bi=Ci+Ai,yi=(Ci=m[bi+-2])+(Ai=m[bi+-6]),Ni=Ci-Ai;m[bi]=Bi+yi,m[bi+-2]=Bi-yi;var Si=m[bi+-3]-m[bi+-7];m[bi+-4]=Mi+Si,m[bi+-6]=Mi-Si;var Gi=(Ci=m[bi+-1])-(Ai=m[bi+-5]),ki=Ci+Ai,Di=m[bi+-3]+m[bi+-7];m[bi+-1]=ki+Di,m[bi+-3]=ki-Di,m[bi+-5]=Gi-Ni,m[bi+-7]=Gi+Ni,ri-=16}for(var xi=0,Zi=h-4,zi=o-4;Zi>=0;){var Wi=l[xi];v[zi+3]=m[Wi],v[zi+2]=m[Wi+1],v[Zi+3]=m[Wi+2],v[Zi+2]=m[Wi+3],Wi=l[xi+1],v[zi+1]=m[Wi],v[zi]=m[Wi+1],v[Zi+1]=m[Wi+2],v[Zi]=m[Wi+3],Zi-=4,zi-=4,xi+=2}for(var Ti=0,Vi=0,Ki=o-4;Vi<Ki;){var Fi=v[Vi]-v[Ki+2],Yi=v[Vi+1]+v[Ki+3],Hi=n[Ti+1]*Fi+n[Ti]*Yi,Ri=n[Ti+1]*Yi-n[Ti]*Fi,Li=v[Vi]+v[Ki+2],Xi=v[Vi+1]-v[Ki+3];v[Vi]=Li+Hi,v[Vi+1]=Xi+Ri,v[Ki+2]=Li-Hi,v[Ki+3]=Ri-Xi,Fi=v[Vi+2]-v[Ki],Yi=v[Vi+3]+v[Ki+1],Hi=n[Ti+3]*Fi+n[Ti+2]*Yi,Ri=n[Ti+3]*Yi-n[Ti+2]*Fi,Li=v[Vi+2]+v[Ki],Xi=v[Vi+3]-v[Ki+1],v[Vi+2]=Li+Hi,v[Vi+3]=Xi+Ri,v[Ki]=Li-Hi,v[Ki+1]=Ri-Xi,Ti+=4,Vi+=4,Ki-=4}for(var ji=o-8,Ei=o-8,Oi=0,Ui=o-4,Pi=o,Qi=t-4;Ei>=0;){var Ji=d[Ei+6]*r[ji+7]-d[Ei+7]*r[ji+6],qi=-d[Ei+6]*r[ji+6]-d[Ei+7]*r[ji+7];e[Oi]=Ji,e[Ui+3]=-Ji,e[Pi]=qi,e[Qi+3]=qi;var $i=d[Ei+4]*r[ji+5]-d[Ei+5]*r[ji+4],es=-d[Ei+4]*r[ji+4]-d[Ei+5]*r[ji+5];e[Oi+1]=$i,e[Ui+2]=-$i,e[Pi+1]=es,e[Qi+2]=es,Ji=d[Ei+2]*r[ji+3]-d[Ei+3]*r[ji+2],qi=-d[Ei+2]*r[ji+2]-d[Ei+3]*r[ji+3],e[Oi+2]=Ji,e[Ui+1]=-Ji,e[Pi+2]=qi,e[Qi+1]=qi,$i=d[Ei]*r[ji+1]-d[Ei+1]*r[ji],es=-d[Ei]*r[ji]-d[Ei+1]*r[ji+1],e[Oi+3]=$i,e[Ui]=-$i,e[Pi+3]=es,e[Qi]=es,ji-=8,Ei-=8,Oi+=4,Pi+=4,Ui-=4,Qi-=4}},decodePacket:function(){var e=this.decodeInitial();return null==e?null:this.decodePacketRest(e)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;var e,t=this.decodeState;if(t.validBits<0)e=0;else if(t.validBits<1){for(0==t.validBits&&(t.acc=0);;){if(0==t.bytesInSeg&&(t.lastSeg||0==t.next())){t.validBits=-1;break}if(t.bytesInSeg--,t.inputPosition+=1,t.acc=t.acc+(t.input.readByte()<<t.validBits),t.validBits+=8,!(t.validBits<1))break}if(t.validBits<0)e=0;else{var a=1&t.acc;t.acc=t.acc>>>1,t.validBits-=1,e=a}}else{var i=1&t.acc;t.acc=t.acc>>>1,t.validBits-=1,e=i}if(0==e)break;for(;;){var s,r=this.decodeState;if(0!=r.bytesInSeg||!r.lastSeg&&0!=r.next()?(r.bytesInSeg--,r.inputPosition+=1,s=r.input.readByte()):s=-1,r.validBits=0,-1==s)break}}var n,l=this.decodeState,o=this.header.modes.length-1,h=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],c=o<16384?o<16?h[o]:o<512?5+h[o>>5]:10+h[o>>10]:o<16777216?o<524288?15+h[o>>15]:20+h[o>>20]:o<536870912?25+h[o>>25]:o<-2147483648?30+h[o>>30]:0;if(l.validBits<0)n=0;else if(l.validBits<c)if(c>24)n=l.readBits(24)+(l.readBits(c-24)<<24);else{for(0==l.validBits&&(l.acc=0);;){if(0==l.bytesInSeg&&(l.lastSeg||0==l.next())){l.validBits=-1;break}if(l.bytesInSeg--,l.inputPosition+=1,l.acc=l.acc+(l.input.readByte()<<l.validBits),l.validBits+=8,!(l.validBits<c))break}if(l.validBits<0)n=0;else{var d=l.acc&(1<<c)-1;l.acc=l.acc>>>c,l.validBits-=c,n=d}}else{var u=l.acc&(1<<c)-1;l.acc=l.acc>>>c,l.validBits-=c,n=u}if(-1==n||n>=this.header.modes.length)throw new et(new $t(ea.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var g,f,p,m=this.header.modes[n];if(m.blockflag){g=this.header.blocksize1;var v=this.decodeState;if(v.validBits<0)f=0;else if(v.validBits<1){for(0==v.validBits&&(v.acc=0);;){if(0==v.bytesInSeg&&(v.lastSeg||0==v.next())){v.validBits=-1;break}if(v.bytesInSeg--,v.inputPosition+=1,v.acc=v.acc+(v.input.readByte()<<v.validBits),v.validBits+=8,!(v.validBits<1))break}if(v.validBits<0)f=0;else{var _=1&v.acc;v.acc=v.acc>>>1,v.validBits-=1,f=_}}else{var I=1&v.acc;v.acc=v.acc>>>1,v.validBits-=1,f=I}var w=this.decodeState;if(w.validBits<0)p=0;else if(w.validBits<1){for(0==w.validBits&&(w.acc=0);;){if(0==w.bytesInSeg&&(w.lastSeg||0==w.next())){w.validBits=-1;break}if(w.bytesInSeg--,w.inputPosition+=1,w.acc=w.acc+(w.input.readByte()<<w.validBits),w.validBits+=8,!(w.validBits<1))break}if(w.validBits<0)p=0;else{var b=1&w.acc;w.acc=w.acc>>>1,w.validBits-=1,p=b}}else{var C=1&w.acc;w.acc=w.acc>>>1,w.validBits-=1,p=C}}else f=p=0,g=this.header.blocksize0;var A=g>>1;return{mode:n,left:m.blockflag&&0==f?{start:g-this.header.blocksize0>>2,end:g+this.header.blocksize0>>2}:{start:0,end:A},right:m.blockflag&&0==p?{start:3*g-this.header.blocksize0>>2,end:3*g+this.header.blocksize0>>2}:{start:A,end:g}}},decodePacketRest:function(e){for(var t=this.header.modes[e.mode],a=new Array(256),i=new Array(256),s=t.blockflag?this.header.blocksize1:this.header.blocksize0,r=this.header.mapping[t.mapping],n=s>>1,l=[256,128,86,64],o=this.header.codebooks,h=0,c=this.header.channel;h<c;){var d=h++,u=r.chan[d].mux;a[d]=!1;var g=this.header.floorConfig[r.submapFloor[u]];if(0==g.type)throw new et(new $t(ea.INVALID_STREAM,null,{fileName:"VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var f,p=g.floor1,m=this.decodeState;if(m.validBits<0)f=0;else if(m.validBits<1){for(0==m.validBits&&(m.acc=0);;){if(0==m.bytesInSeg&&(m.lastSeg||0==m.next())){m.validBits=-1;break}if(m.bytesInSeg--,m.inputPosition+=1,m.acc=m.acc+(m.input.readByte()<<m.validBits),m.validBits+=8,!(m.validBits<1))break}if(m.validBits<0)f=0;else{var v=1&m.acc;m.acc=m.acc>>>1,m.validBits-=1,f=v}}else{var _=1&m.acc;m.acc=m.acc>>>1,m.validBits-=1,f=_}if(0!=f){var I=[],w=new Array(256),b=l[p.floor1Multiplier-1],C=2;I=this.finalY[d];var A,M=this.decodeState,B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],y=(b<16384?b<16?B[b]:b<512?5+B[b>>5]:10+B[b>>10]:b<16777216?b<524288?15+B[b>>15]:20+B[b>>20]:b<536870912?25+B[b>>25]:b<-2147483648?30+B[b>>30]:0)-1;if(M.validBits<0)A=0;else if(M.validBits<y)if(y>24)A=M.readBits(24)+(M.readBits(y-24)<<24);else{for(0==M.validBits&&(M.acc=0);;){if(0==M.bytesInSeg&&(M.lastSeg||0==M.next())){M.validBits=-1;break}if(M.bytesInSeg--,M.inputPosition+=1,M.acc=M.acc+(M.input.readByte()<<M.validBits),M.validBits+=8,!(M.validBits<y))break}if(M.validBits<0)A=0;else{var N=M.acc&(1<<y)-1;M.acc=M.acc>>>y,M.validBits-=y,A=N}}else{var S=M.acc&(1<<y)-1;M.acc=M.acc>>>y,M.validBits-=y,A=S}I[0]=A;var G,k=this.decodeState,D=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],x=(b<16384?b<16?D[b]:b<512?5+D[b>>5]:10+D[b>>10]:b<16777216?b<524288?15+D[b>>15]:20+D[b>>20]:b<536870912?25+D[b>>25]:b<-2147483648?30+D[b>>30]:0)-1;if(k.validBits<0)G=0;else if(k.validBits<x)if(x>24)G=k.readBits(24)+(k.readBits(x-24)<<24);else{for(0==k.validBits&&(k.acc=0);;){if(0==k.bytesInSeg&&(k.lastSeg||0==k.next())){k.validBits=-1;break}if(k.bytesInSeg--,k.inputPosition+=1,k.acc=k.acc+(k.input.readByte()<<k.validBits),k.validBits+=8,!(k.validBits<x))break}if(k.validBits<0)G=0;else{var Z=k.acc&(1<<x)-1;k.acc=k.acc>>>x,k.validBits-=x,G=Z}}else{var z=k.acc&(1<<x)-1;k.acc=k.acc>>>x,k.validBits-=x,G=z}I[1]=G;for(var W=0,T=p.partitions;W<T;){var V=W++,K=p.partitionClassList[V],F=p.classDimensions[K],Y=p.classSubclasses[K],H=(1<<Y)-1,R=0;if(0!=Y){var L=o[p.classMasterbooks[K]],X=this.decodeState;X.validBits<10&&X.prepHuffman();var j,E=L.fastHuffman[1023&X.acc];if(E>=0){var O=L.codewordLengths[E];X.acc=X.acc>>>O,X.validBits-=O,X.validBits<0?(X.validBits=0,j=-1):j=E}else j=X.decodeScalarRaw(L);L.sparse&&(j=L.sortedValues[j]),R=j}for(var U=p.subclassBooks[K],P=0,Q=F;P<Q;){P++;var J=U[R&H];R>>=Y;var q,$=C++;if(J>=0){var ee=this.decodeState,te=o[J];ee.validBits<10&&ee.prepHuffman();var ae,ie=te.fastHuffman[1023&ee.acc];if(ie>=0){var se=te.codewordLengths[ie];ee.acc=ee.acc>>>se,ee.validBits-=se,ee.validBits<0?(ee.validBits=0,ae=-1):ae=ie}else ae=ee.decodeScalarRaw(te);te.sparse&&(ae=te.sortedValues[ae]),q=ae}else q=0;I[$]=q}}if(-1==this.decodeState.validBits){a[d]=!0;continue}w[0]=w[1]=!0;for(var re=p.neighbors,ne=p.xlist,le=2,oe=p.values;le<oe;){var he=le++,ce=re[he][0],de=re[he][1],ue=ne[ce],ge=I[ce],fe=I[de]-ge,pe=ne[de]-ue,me=Math.abs(fe)*(ne[he]-ue)/pe|0,ve=fe<0?ge-me:ge+me,_e=I[he],Ie=b-ve,we=Ie<ve?2*Ie:2*ve;0!=_e?(w[ce]=w[de]=!0,w[he]=!0,I[he]=_e>=we?Ie>ve?_e-ve+ve:ve-_e+Ie-1:0!=(1&_e)?ve-(_e+1>>1):ve+(_e>>1)):(w[he]=!1,I[he]=ve)}for(var be=0,Ce=p.values;be<Ce;){var Ae=be++;w[Ae]||(I[Ae]=-1)}}else a[d]=!0}for(var Me=0,Be=this.header.channel;Me<Be;){var ye=Me++;i[ye]=a[ye]}for(var Ne=0,Se=r.couplingSteps;Ne<Se;){var Ge=Ne++;a[r.chan[Ge].magnitude]&&a[r.chan[Ge].angle]||(a[r.chan[Ge].magnitude]=a[r.chan[Ge].angle]=!1)}for(var ke=0,De=r.submaps;ke<De;){for(var xe=ke++,Ze=this.header.channel,ze=new Array(Ze),We=new Array(256),Te=0,Ve=0,Ke=this.header.channel;Ve<Ke;){var Fe=Ve++;r.chan[Fe].mux==xe&&(a[Fe]?(We[Te]=!0,ze[Te]=null):(We[Te]=!1,ze[Te]=this.channelBuffers[Fe]),++Te)}var Ye=r.submapResidue[xe];this.header.residueConfig[Ye].decode(this.decodeState,this.header,ze,Te,n,We,this.channelBuffers)}for(var He=r.couplingSteps,Re=s>>1;--He>=0;)for(var Le=this.channelBuffers[r.chan[He].magnitude],Xe=this.channelBuffers[r.chan[He].angle],je=0,Ee=Re;je<Ee;){var Oe,Ue,Pe=je++;Le[Pe]>0?Xe[Pe]>0?(Ue=Le[Pe],Oe=Le[Pe]-Xe[Pe]):(Oe=Le[Pe],Ue=Le[Pe]+Xe[Pe]):Xe[Pe]>0?(Ue=Le[Pe],Oe=Le[Pe]+Xe[Pe]):(Oe=Le[Pe],Ue=Le[Pe]-Xe[Pe]),Le[Pe]=Ue,Xe[Pe]=Oe}for(var Qe=0,Je=this.header.channel;Qe<Je;){var qe=Qe++;if(i[qe])for(var $e=0,tt=Re;$e<tt;){var at=$e++;this.channelBuffers[qe][at]=0}else r.doFloor(this.header.floorConfig,qe,s,this.channelBuffers[qe],this.finalY[qe],null)}for(var it=0,st=this.header.channel;it<st;){var rt=it++;this.inverseMdct(this.channelBuffers[rt],s,t.blockflag)}for(var nt=this.decodeState;0!=nt.bytesInSeg||!nt.lastSeg&&0!=nt.next();)nt.bytesInSeg--,nt.inputPosition+=1,nt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,s,e)},__class__:Ft};var Yt=function(){};a["kha.audio2.ogg.vorbis.VorbisTools"]=Yt,Yt.__name__=!0,Yt.pointCompare=function(e,t){return e.x<t.x?-1:e.x>t.x?1:0},Yt.uintAsc=function(e,t){return v.gt(t,e)?-1:e==t?0:1},Yt.lookup1Values=function(e,t){var a=0|Math.exp(Math.log(e)/t);(0|Math.pow(a+1,t))<=e&&++a;Math.pow(a+1,t),Math.pow(a,t);return a},Yt.computeWindow=function(e,t){for(var a=e>>1,i=0,s=a;i<s;){var r=i++;t[r]=Math.sin(1.5707963267948966*Yt.square(Math.sin((r+.5)/a*.5*3.141592653589793)))}},Yt.square=function(e){return e*e},Yt.computeBitReverse=function(e,t){for(var a=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],i=(e<16384?e<16?a[e]:e<512?5+a[e>>5]:10+a[e>>10]:e<16777216?e<524288?15+a[e>>15]:20+a[e>>20]:e<536870912?25+a[e>>25]:e<-2147483648?30+a[e>>30]:0)-1,s=0,r=e>>3;s<r;){var n=s++,l=n;l=(-16711936&(l=(-252645136&(l=(-858993460&(l=(-1431655766&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,t[n]=(l>>>16|l<<16)>>>32-i+3<<2}},Yt.computeTwiddleFactors=function(e,t,a,i){for(var s=e>>3,r=0,n=0,l=e>>2;n<l;){var o=n++;t[r]=Math.cos(4*o*3.141592653589793/e),t[r+1]=-Math.sin(4*o*3.141592653589793/e),a[r]=.5*Math.cos(3.141592653589793*(r+1)/e/2),a[r+1]=.5*Math.sin(3.141592653589793*(r+1)/e/2),r+=2}for(var h=0,c=0,d=s;c<d;){c++;i[h]=Math.cos(2*(h+1)*3.141592653589793/e),i[h+1]=-Math.sin(2*(h+1)*3.141592653589793/e),h+=2}},Yt.drawLine=function(e,t,a,i,s,r){if(null==Yt.integerDivideTable){var n=new Array(32);Yt.integerDivideTable=n;for(var l=0;l<32;){var o=l++,h=Yt.integerDivideTable,c=new Array(64);h[o]=c;for(var d=1;d<64;){var u=d++;Yt.integerDivideTable[o][u]=o/u|0}}}var g,f,p=s-a,m=i-t,v=p<0?-p:p,_=t,I=a,w=0;m<64&&v<32?f=p<0?(g=-Yt.integerDivideTable[v][m])-1:(g=Yt.integerDivideTable[v][m])+1:(g=p/m|0,f=p<0?g-1:g+1),v-=(g<0?-g:g)*m,i>r&&(i=r);var b=_,C=e;C[b]=C[b]*Yt.INVERSE_DB_TABLE[I];for(var A=_+1,M=i;A<M;){(w+=v)>=m?(w-=m,I+=f):I+=g;var B=A++,y=e;y[B]=y[B]*Yt.INVERSE_DB_TABLE[I]}};var Ht=function(){};a["kha.audio2.ogg.vorbis.data.Codebook"]=Ht,Ht.__name__=!0,Ht.read=function(e){var t,a,i,s,r,n,l,o,h,c,d=new Ht;if(e.validBits<0)i=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)i=0;else{var u=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,i=u}}else{var g=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,i=g}if(66==i){var f;if(e.validBits<0)f=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)f=0;else{var p=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,f=p}}else{var m=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,f=m}a=67!=f}else a=!0;if(a)t=!0;else{var _;if(e.validBits<0)_=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)_=0;else{var I=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_=I}}else{var w=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,_=w}t=86!=_}if(t)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(e.validBits<0)s=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)s=0;else{var b=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=b}}else{var C=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=C}if(e.validBits<0)r=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)r=0;else{var A=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,r=A}}else{var M=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,r=M}if(d.dimensions=(r<<8)+s,e.validBits<0)n=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)n=0;else{var B=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=B}}else{var y=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=y}if(e.validBits<0)l=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)l=0;else{var N=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,l=N}}else{var S=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,l=S}if(e.validBits<0)o=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)o=0;else{var G=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,o=G}}else{var k=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,o=k}if(d.entries=(o<<16)+(l<<8)+n,e.validBits<0)h=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)h=0;else{var D=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,h=D}}else{var x=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,h=x}if(0!=h)c=!1;else{var Z;if(e.validBits<0)Z=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)Z=0;else{var z=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Z=z}}else{var W=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Z=W}c=0!=Z}d.sparse=c;var T=d.entries,V=new Array(T);d.sparse||(d.codewordLengths=V);var K,F=0;if(0!=h){var Y,H=0;if(e.validBits<0)Y=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)Y=0;else{var R=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,Y=R}}else{var L=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,Y=L}for(var X=Y+1;H<d.entries;){var j,E=d.entries-H,O=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],U=E<16384?E<16?O[E]:E<512?5+O[E>>5]:10+O[E>>10]:E<16777216?E<524288?15+O[E>>15]:20+O[E>>20]:E<536870912?25+O[E>>25]:E<-2147483648?30+O[E>>30]:0;if(e.validBits<0)j=0;else if(e.validBits<U)if(U>24)j=e.readBits(24)+(e.readBits(U-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<U))break}if(e.validBits<0)j=0;else{var P=e.acc&(1<<U)-1;e.acc=e.acc>>>U,e.validBits-=U,j=P}}else{var Q=e.acc&(1<<U)-1;e.acc=e.acc>>>U,e.validBits-=U,j=Q}if(H+j>d.entries)throw new et(new $t(ea.INVALID_SETUP,"codebook entrys",{fileName:"Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var J=0,q=j;J<q;){V[H+J++]=X}H+=j,++X}}else for(var $=0,ee=d.entries;$<ee;){var te,ae=$++;if(d.sparse)if(e.validBits<0)te=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)te=0;else{var ie=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,te=ie}}else{var se=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,te=se}else te=1;if(0!=te){var re;if(e.validBits<0)re=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)re=0;else{var ne=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,re=ne}}else{var le=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,re=le}V[ae]=re+1,++F}else V[ae]=255}if(d.sparse&&F>=d.entries>>2&&(d.codewordLengths=V,d.sparse=!1),d.sparse)K=F;else{for(var oe=0,he=0,ce=d.entries;he<ce;){var de=V[he++];de>10&&255!=de&&++oe}K=oe}d.sortedEntries=K;var ue,ge=null;if(d.sparse){if(0!=d.sortedEntries){var fe=d.sortedEntries,pe=new Array(fe);d.codewordLengths=pe;var me=d.entries,ve=new Array(me);d.codewords=ve;var _e=d.entries;ge=new Array(_e)}d.entries,d.sortedEntries}else{var Ie=d.entries,we=new Array(Ie);d.codewords=we}if(!d.computeCodewords(V,d.entries,ge))throw new et(new $t(ea.INVALID_SETUP,"compute codewords",{fileName:"Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=d.sortedEntries){d.sortedCodewords=[];var be=d.sortedEntries,Ce=new Array(be);d.sortedValues=Ce,d.computeSortedHuffman(V,ge)}if(d.sparse&&(ge=null,d.codewords=null,V=null),d.computeAcceleratedHuffman(),e.validBits<0)ue=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)ue=0;else{var Ae=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,ue=Ae}}else{var Me=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,ue=Me}if(d.lookupType=ue,d.lookupType>2)throw new et(new $t(ea.INVALID_SETUP,"codebook lookup type",{fileName:"Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(d.lookupType>0){var Be;if(e.validBits<0)Be=0;else if(e.validBits<32)Be=e.readBits(24)+(e.readBits(8)<<24);else{var ye=0&e.acc;e.acc=e.acc>>>32,e.validBits-=32,Be=ye}var Ne,Se=v.toFloat(2097151&Be),Ge=(2145386496&Be)>>>21,ke=0!=(-2147483648&Be)?-Se:Se;if(d.minimumValue=ke*Math.pow(2,Ge-788),e.validBits<0)Ne=0;else if(e.validBits<32)Ne=e.readBits(24)+(e.readBits(8)<<24);else{var De=0&e.acc;e.acc=e.acc>>>32,e.validBits-=32,Ne=De}var xe,Ze,ze=v.toFloat(2097151&Ne),We=(2145386496&Ne)>>>21,Te=0!=(-2147483648&Ne)?-ze:ze;if(d.deltaValue=Te*Math.pow(2,We-788),e.validBits<0)xe=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)xe=0;else{var Ve=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,xe=Ve}}else{var Ke=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,xe=Ke}if(d.valueBits=xe+1,e.validBits<0)Ze=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)Ze=0;else{var Fe=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Ze=Fe}}else{var Ye=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,Ze=Ye}d.sequenceP=0!=Ze,1==d.lookupType?d.lookupValues=Yt.lookup1Values(d.entries,d.dimensions):d.lookupValues=d.entries*d.dimensions;for(var He=d.lookupValues,Re=new Array(He),Le=0,Xe=d.lookupValues;Le<Xe;){var je,Ee=Le++,Oe=d.valueBits;if(e.validBits<0)je=0;else if(e.validBits<Oe)if(Oe>24)je=e.readBits(24)+(e.readBits(Oe-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<Oe))break}if(e.validBits<0)je=0;else{var Ue=e.acc&(1<<Oe)-1;e.acc=e.acc>>>Oe,e.validBits-=Oe,je=Ue}}else{var Pe=e.acc&(1<<Oe)-1;e.acc=e.acc>>>Oe,e.validBits-=Oe,je=Pe}if(-1==je)throw new et(new $t(ea.INVALID_SETUP,"fail lookup",{fileName:"Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));Re[Ee]=je}var Qe=d.lookupValues,Je=new Array(Qe);d.multiplicands=Je;for(var qe=0,$e=d.lookupValues;qe<$e;){var tt=qe++;d.multiplicands[tt]=Re[tt]*d.deltaValue+d.minimumValue}if(2==d.lookupType&&d.sequenceP){for(var at=1,it=d.lookupValues;at<it;){var st=at++;d.multiplicands[st]=d.multiplicands[st-1]}d.sequenceP=!1}}return d},Ht.prototype={computeCodewords:function(e,t,a){for(var i=new Array(32),s=0;s<32;){i[s++]=0}for(var r=0;r<t&&!(e[r]<255);)++r;if(r==t){this.sortedEntries;return!0}var n=0,l=n++;this.sparse?(this.codewords[l]=0,this.codewordLengths[l]=e[r],a[l]=r):this.codewords[r]=0;for(var o=0;++o<=e[r];)i[o]=1<<32-o;for(o=r;++o<t;){var h=e[o];if(255!=h){for(;h>0&&0==i[h];)--h;if(0==h)return!1;var c=i[h];i[h]=0;var d=c,u=(d=(-16711936&(d=(-252645136&(d=(-858993460&(d=(-1431655766&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8)>>>16|d<<16,g=n++;if(this.sparse?(this.codewords[g]=u,this.codewordLengths[g]=e[o],a[g]=o):this.codewords[o]=u,h!=e[o])for(var f=e[o];f>h;)i[f]=c+(1<<32-f),--f}}return!0},computeSortedHuffman:function(e,t){if(this.sparse)for(var a=0,i=this.sortedEntries;a<i;){var s=a++,r=this.codewords[s];r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,this.sortedCodewords[s]=r>>>16|r<<16}else{for(var n=0,l=0,o=this.entries;l<o;){var h=l++,c=e[h];if(this.sparse||255!=c&&c>10){var d=this.codewords[h];d=(-16711936&(d=(-252645136&(d=(-858993460&(d=(-1431655766&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8,this.sortedCodewords[n++]=d>>>16|d<<16}}this.sortedEntries}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(Yt.uintAsc);for(var u=0,g=this.sparse?this.sortedEntries:this.entries;u<g;){var f=u++,p=this.sparse?e[t[f]]:e[f];if(this.sparse||255!=p&&p>10){for(var m=this.codewords[f],_=(m=(-16711936&(m=(-252645136&(m=(-858993460&(m=(-1431655766&m)>>>1|(1431655765&m)<<1))>>>2|(858993459&m)<<2))>>>4|(252645135&m)<<4))>>>8|(16711935&m)<<8)>>>16|m<<16,I=0,w=this.sortedEntries;w>1;){var b=I+(w>>1);v.gte(_,this.sortedCodewords[b])?(I=b,w-=w>>1):w>>=1}this.sparse?(this.sortedValues[I]=t[f],this.codewordLengths[I]=p):this.sortedValues[I]=f}}},computeAcceleratedHuffman:function(){var e=new Array(1024);this.fastHuffman=e,this.fastHuffman[0]=-1;for(var t=0;t<1024;){var a=t++;this.fastHuffman[a]=-1}for(var i=0,s=this.sparse?this.sortedEntries:this.entries;i<s;){var r=i++;if(this.codewordLengths[r]<=10){var n;if(this.sparse){var l=this.sortedCodewords[r];n=(l=(-16711936&(l=(-252645136&(l=(-858993460&(l=(-1431655766&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8)>>>16|l<<16}else n=this.codewords[r];for(;n<1024;)this.fastHuffman[n]=r,n+=1<<this.codewordLengths[r]}}},codebookDecode:function(e,t,a,i){e.validBits<10&&e.prepHuffman();var s,r=this.fastHuffman[1023&e.acc];if(r>=0){var n=this.codewordLengths[r];e.acc=e.acc>>>n,e.validBits-=n,e.validBits<0?(e.validBits=0,s=-1):s=r}else s=e.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var l=s,o=this.lookupValues,h=this.sequenceP,c=this.multiplicands,d=this.minimumValue;if(l<0)return!1;if(i>this.dimensions&&(i=this.dimensions),1==this.lookupType){for(var u=1,g=0,f=0,p=i;f<p;){var m=f++,_=c[v.toFloat(l/u|0)%v.toFloat(o)|0]+g,I=a+m,w=t;w[I]=w[I]+_,h&&(g=_+d),u*=o}return!0}if(l*=this.dimensions,h)for(var b=0,C=0,A=i;C<A;){var M=C++,B=c[l+M]+b,y=a+M,N=t;N[y]=N[y]+B,b=B+d}else for(var S=0,G=i;S<G;){var k=S++,D=a+k,x=t;x[D]=x[D]+(c[l+k]+0)}return!0},codebookDecodeStep:function(e,t,a,i,s){e.validBits<10&&e.prepHuffman();var r,n=this.fastHuffman[1023&e.acc];if(n>=0){var l=this.codewordLengths[n];e.acc=e.acc>>>l,e.validBits-=l,e.validBits<0?(e.validBits=0,r=-1):r=n}else r=e.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var o=r,h=0;if(o<0)return!1;i>this.dimensions&&(i=this.dimensions);var c=this.lookupValues,d=this.sequenceP,u=this.multiplicands;if(1==this.lookupType){for(var g=1,f=0,p=i;f<p;){var m=f++,_=u[v.toFloat(o/g|0)%v.toFloat(c)|0]+h,I=a+m*s,w=t;w[I]=w[I]+_,d&&(h=_),g*=c}return!0}o*=this.dimensions;for(var b=0,C=i;b<C;){var A=b++,M=u[o+A]+h,B=a+A*s,y=t;y[B]=y[B]+M,d&&(h=M)}return!0},decodeDeinterleaveRepeat:function(e,t,a,i,s,r,n){var l=this.dimensions;if(0==this.lookupType)throw new et(new $t(ea.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var o=this.multiplicands,h=this.sequenceP,c=this.lookupValues;n>0;){var d=0;e.validBits<10&&e.prepHuffman();var u,g=this.fastHuffman[1023&e.acc];if(g>=0){var f=this.codewordLengths[g];e.acc=e.acc>>>f,e.validBits-=f,e.validBits<0?(e.validBits=0,u=-1):u=g}else u=e.decodeScalarRaw(this);this.sparse&&(u=this.sortedValues[u]);var p=u;if(p<0){if(0==e.bytesInSeg&&e.lastSeg)return null;throw new et(new $t(ea.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(i+s*a+l>r*a&&(l=r*a-(s*a-i)),1==this.lookupType){var m=1;if(h)for(var _=0,I=l;_<I;){_++;var w=o[v.toFloat(p/m|0)%v.toFloat(c)|0]+d,b=s,C=t[i];C[b]=C[b]+w,++i==a&&(i=0,++s),d=w,m*=c}else for(var A=0,M=l;A<M;){A++;var B=o[v.toFloat(p/m|0)%v.toFloat(c)|0]+d,y=s,N=t[i];N[y]=N[y]+B,++i==a&&(i=0,++s),m*=c}}else if(p*=this.dimensions,h)for(var S=0,G=l;S<G;){var k=o[p+S++]+d,D=s,x=t[i];x[D]=x[D]+k,++i==a&&(i=0,++s),d=k}else for(var Z=0,z=l;Z<z;){var W=o[p+Z++]+d,T=s,V=t[i];V[T]=V[T]+W,++i==a&&(i=0,++s)}n-=l}return{cInter:i,pInter:s}},residueDecode:function(e,t,a,i,s){if(0==s)for(var r=i/this.dimensions|0,n=0,l=r;n<l;){var o=n++;if(!this.codebookDecodeStep(e,t,a+o,i-a-o,r))return!1}else for(var h=0;h<i;){if(!this.codebookDecode(e,t,a,i-h))return!1;h+=this.dimensions,a+=this.dimensions}return!0},__class__:Ht};var Rt=function(){this.data=new T};a["kha.audio2.ogg.vorbis.data.Comment"]=Rt,Rt.__name__=!0,Rt.prototype={get_loopStart:function(){return f.parseInt(this.getString("loopstart"))},get_loopLength:function(){return f.parseInt(this.getString("looplength"))},add:function(e,t){e=e.toLowerCase();var a=this.data;if(null!=Gi[e]?a.existsReserved(e):a.h.hasOwnProperty(e)){var i=this.data;(null!=Gi[e]?i.getReserved(e):i.h[e]).push(t)}else{var s=[t],r=this.data;null!=Gi[e]?r.setReserved(e,s):r.h[e]=s}},getString:function(e){e=e.toLowerCase();var t=this.data;if(null!=Gi[e]?t.existsReserved(e):t.h.hasOwnProperty(e)){var a=this.data;return(null!=Gi[e]?a.getReserved(e):a.h[e])[0]}return null},__class__:Rt,__properties__:{get_loopLength:"get_loopLength",get_loopStart:"get_loopStart"}};var Lt=function(){};a["kha.audio2.ogg.vorbis.data.Floor"]=Lt,Lt.__name__=!0,Lt.read=function(e,t){var a,i=new Lt;if(e.validBits<0)a=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)a=0;else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=s}}else{var r=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=r}if(i.type=a,i.type>1)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var n,l,o,h,c,d,u=i.floor0=new Xt;if(e.validBits<0)n=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)n=0;else{var g=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=g}}else{var f=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,n=f}if(u.order=n,e.validBits<0)l=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)l=0;else{var p=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,l=p}}else{var m=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,l=m}if(u.rate=l,e.validBits<0)o=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)o=0;else{var v=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,o=v}}else{var _=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,o=_}if(u.barkMapSize=o,e.validBits<0)h=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)h=0;else{var I=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=I}}else{var w=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=w}if(u.amplitudeBits=h,e.validBits<0)c=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)c=0;else{var b=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,c=b}}else{var C=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,c=C}if(u.amplitudeOffset=c,e.validBits<0)d=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)d=0;else{var A=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,d=A}}else{var M=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,d=M}u.numberOfBooks=d+1;for(var B=0,y=u.numberOfBooks;B<y;){var N,S=B++,G=u.bookList;if(e.validBits<0)N=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)N=0;else{var k=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,N=k}}else{var D=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,N=D}G[S]=N}throw new et(new $t(ea.FEATURE_NOT_SUPPORTED,null,{fileName:"Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var x,Z=[],z=i.floor1=new jt,W=-1;if(e.validBits<0)x=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)x=0;else{var T=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,x=T}}else{var V=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,x=V}z.partitions=x;var K=z.partitions,F=new Array(K);z.partitionClassList=F;for(var Y=0,H=z.partitions;Y<H;){var R,L=Y++,X=z.partitionClassList;if(e.validBits<0)R=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)R=0;else{var j=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,R=j}}else{var E=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,R=E}X[L]=R,z.partitionClassList[L]>W&&(W=z.partitionClassList[L])}var O=new Array(W+1);z.classDimensions=O;var U=new Array(W+1);z.classMasterbooks=U;var P=new Array(W+1);z.classSubclasses=P;var Q=new Array(W+1);z.subclassBooks=Q;for(var J,q,$=0,ee=W+1;$<ee;){var te,ae=$++,ie=z.classDimensions;if(e.validBits<0)te=0;else if(e.validBits<3){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<3))break}if(e.validBits<0)te=0;else{var se=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,te=se}}else{var re=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,te=re}ie[ae]=te+1;var ne,le=z.classSubclasses;if(e.validBits<0)ne=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)ne=0;else{var oe=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,ne=oe}}else{var he=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,ne=he}if(le[ae]=ne,0!=z.classSubclasses[ae]){var ce,de=z.classMasterbooks;if(e.validBits<0)ce=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)ce=0;else{var ue=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,ce=ue}}else{var ge=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,ce=ge}if(de[ae]=ce,z.classMasterbooks[ae]>=t.length)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var fe=1<<z.classSubclasses[ae],pe=z.subclassBooks,me=new Array(fe);pe[ae]=me;for(var ve=0,_e=fe;ve<_e;){var Ie,we=ve++,be=z.subclassBooks[ae];if(e.validBits<0)Ie=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)Ie=0;else{var Ce=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,Ie=Ce}}else{var Ae=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,Ie=Ae}if(be[we]=Ie-1,z.subclassBooks[ae][we]>=t.length)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}if(e.validBits<0)J=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)J=0;else{var Me=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,J=Me}}else{var Be=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,J=Be}if(z.floor1Multiplier=J+1,e.validBits<0)q=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)q=0;else{var ye=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,q=ye}}else{var Ne=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,q=Ne}z.rangebits=q;var Se=new Array(250);z.xlist=Se,z.xlist[0]=0,z.xlist[1]=1<<z.rangebits,z.values=2;for(var Ge=0,ke=z.partitions;Ge<ke;)for(var De=Ge++,xe=z.partitionClassList[De],Ze=0,ze=z.classDimensions[xe];Ze<ze;){Ze++;var We,Te=z.xlist,Ve=z.values,Ke=z.rangebits;if(e.validBits<0)We=0;else if(e.validBits<Ke)if(Ke>24)We=e.readBits(24)+(e.readBits(Ke-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<Ke))break}if(e.validBits<0)We=0;else{var Fe=e.acc&(1<<Ke)-1;e.acc=e.acc>>>Ke,e.validBits-=Ke,We=Fe}}else{var Ye=e.acc&(1<<Ke)-1;e.acc=e.acc>>>Ke,e.validBits-=Ke,We=Ye}Te[Ve]=We,z.values++}for(var He=0,Re=z.values;He<Re;){var Le=He++;Z.push(new Ot),Z[Le].x=z.xlist[Le],Z[Le].y=Le}Z.sort(Yt.pointCompare);var Xe=z.values,je=new Array(Xe);z.sortedOrder=je;for(var Ee=0,Oe=z.values;Ee<Oe;){var Ue=Ee++;z.sortedOrder[Ue]=Z[Ue].y}var Pe=z.values,Qe=new Array(Pe);z.neighbors=Qe;for(var Je=2,qe=z.values;Je<qe;){for(var $e,tt,at=Je++,it=z.xlist,st=-1,rt=65536,nt=0,lt=0,ot=0,ht=at;ot<ht;){var ct=ot++;it[ct]>st&&it[ct]<it[at]&&(nt=ct,st=it[ct]),it[ct]<rt&&it[ct]>it[at]&&(lt=ct,rt=it[ct])}$e=nt,tt=lt;var dt=z.neighbors,ut=z.values,gt=new Array(ut);dt[at]=gt,z.neighbors[at][0]=$e,z.neighbors[at][1]=tt}return i},Lt.prototype={__class__:Lt};var Xt=function(){};a["kha.audio2.ogg.vorbis.data.Floor0"]=Xt,Xt.__name__=!0,Xt.prototype={__class__:Xt};var jt=function(){};a["kha.audio2.ogg.vorbis.data.Floor1"]=jt,jt.__name__=!0,jt.prototype={__class__:jt};var Et=function(){};a["kha.audio2.ogg.vorbis.data.Header"]=Et,Et.__name__=!0,Et.read=function(e){var t=e.page;if(t.start(e),0==(2&t.flag))throw new et(new $t(ea.INVALID_FIRST_PAGE,"not firstPage",{fileName:"Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&t.flag))throw new et(new $t(ea.INVALID_FIRST_PAGE,"lastPage",{fileName:"Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&t.flag))throw new et(new $t(ea.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.firstPageValidate(),e.inputPosition+=1,1!=e.input.readByte())throw new et(new $t(ea.INVALID_FIRST_PAGE,"decodeState head",{fileName:"Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var a=new x(new ki(6)),i=0;i<6;){var s,r=i++;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,s=e.input.readByte()):s=-1,e.validBits=0,a.b[r]=255&s}if("vorbis"!=a.toString())throw new et(new $t(ea.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));e.inputPosition+=4;var n=e.input.readInt32();if(0!=n)throw new et(new $t(ea.INVALID_FIRST_PAGE,"vorbis version : "+n,{fileName:"Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var l=new Et;if(e.inputPosition+=1,l.channel=e.input.readByte(),0==l.channel)throw new et(new $t(ea.INVALID_FIRST_PAGE,"no channel",{fileName:"Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(l.channel>16)throw new et(new $t(ea.TOO_MANY_CHANNELS,"too many channels",{fileName:"Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.inputPosition+=4,l.sampleRate=e.input.readInt32(),0==l.sampleRate)throw new et(new $t(ea.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=4,l.maximumBitRate=e.input.readInt32(),e.inputPosition+=4,l.nominalBitRate=e.input.readInt32(),e.inputPosition+=4,l.minimumBitRate=e.input.readInt32(),e.inputPosition+=1;var o=e.input.readByte(),h=15&o,c=o>>4;if(l.blocksize0=1<<h,l.blocksize1=1<<c,h<6||h>13)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(c<6||c>13)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(h>c)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=1;var d=e.input.readByte();if(0==(1&d))throw new et(new $t(ea.INVALID_FIRST_PAGE,null,{fileName:"Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.page.start(e),e.startPacket();for(var u=0,g=new H;0!=(u=e.next());)e.inputPosition+=u,g.write(e.input.read(u)),e.bytesInSeg=0;var f=new F(g.getBytes());f.readByte(),f.read(6);var p,m=f.readInt32();l.vendor=f.readString(m),l.comment=new Rt;for(var v=0,_=f.readInt32();v<_;){v++;var I=f.readInt32(),w=f.readString(I),b=w.indexOf("=");-1!=b&&l.comment.add(w.substring(0,b),w.substring(b+1))}if(0==(1&f.readByte()))throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.startPacket(),0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,p=e.input.readByte()):p=-1,e.validBits=0,5!=p)throw new et(new $t(ea.INVALID_SETUP,"setup packet",{fileName:"Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(var C,A=new x(new ki(6)),M=0;M<6;){var B,y=M++;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,B=e.input.readByte()):B=-1,e.validBits=0,A.b[y]=255&B}if("vorbis"!=A.toString())throw new et(new $t(ea.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));if(e.validBits<0)C=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)C=0;else{var N=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,C=N}}else{var S=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,C=S}var G=C+1,k=new Array(G);l.codebooks=k;for(var D,Z=0,z=G;Z<z;){var W=Z++;l.codebooks[W]=Ht.read(e)}if(e.validBits<0)D=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)D=0;else{var T=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,D=T}}else{var V=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,D=V}for(var K,Y=0,R=d=D+1;Y<R;){var L;Y++;if(e.validBits<0)L=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)L=0;else{var X=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,L=X}}else{var j=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,L=j}if(0!=L)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}if(e.validBits<0)K=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)K=0;else{var E=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,K=E}}else{var O=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,K=O}var U=K+1,P=new Array(U);l.floorConfig=P;for(var Q,J=0,q=U;J<q;){var $=J++;l.floorConfig[$]=Lt.read(e,l.codebooks)}if(e.validBits<0)Q=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)Q=0;else{var ee=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,Q=ee}}else{var te=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,Q=te}var ae=Q+1,ie=new Array(ae);l.residueConfig=ie;for(var se,re=0,ne=ae;re<ne;){var le=re++;l.residueConfig[le]=ta.read(e,l.codebooks)}if(e.validBits<0)se=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)se=0;else{var oe=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,se=oe}}else{var he=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,se=he}var ce=se+1,de=new Array(ce);l.mapping=de;for(var ue,ge=0,fe=ce;ge<fe;){var pe=ge++,me=Ut.read(e,l.channel);l.mapping[pe]=me;for(var ve=0,_e=me.submaps;ve<_e;){var Ie=ve++;if(me.submapFloor[Ie]>=l.floorConfig.length)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(me.submapResidue[Ie]>=l.residueConfig.length)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}}if(e.validBits<0)ue=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)ue=0;else{var we=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,ue=we}}else{var be=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,ue=be}var Ce=ue+1,Ae=new Array(Ce);l.modes=Ae;for(var Me=0,Be=Ce;Me<Be;){var ye=Me++,Ne=Qt.read(e);if(l.modes[ye]=Ne,Ne.mapping>=l.mapping.length)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next();)e.bytesInSeg--,e.inputPosition+=1,e.input.readByte();return l},Et.prototype={__class__:Et};var Ot=function(){};a["kha.audio2.ogg.vorbis.data.IntPoint"]=Ot,Ot.__name__=!0,Ot.prototype={__class__:Ot};var Ut=function(){};a["kha.audio2.ogg.vorbis.data.Mapping"]=Ut,Ut.__name__=!0,Ut.read=function(e,t){var a,i=new Ut;if(e.validBits<0)a=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)a=0;else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=s}}else{var r=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=r}if(0!=a)throw new et(new $t(ea.INVALID_SETUP,"mapping type "+a,{fileName:"Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var n=new Array(t);i.chan=n;for(var l,o,h,c=0,d=t;c<d;){var u=c++;i.chan[u]=new Pt}if(e.validBits<0)l=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)l=0;else{var g=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,l=g}}else{var f=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,l=f}if(0!=l){var p;if(e.validBits<0)p=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)p=0;else{var m=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,p=m}}else{var v=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,p=v}i.submaps=p+1}else i.submaps=1;if(e.validBits<0)o=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)o=0;else{var _=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,o=_}}else{var I=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,o=I}if(0!=o){var w;if(e.validBits<0)w=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)w=0;else{var b=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,w=b}}else{var C=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,w=C}i.couplingSteps=w+1;for(var A=0,M=i.couplingSteps;A<M;){var B,y=A++,N=i.chan[y],S=t-1,G=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=S<16384?S<16?G[S]:S<512?5+G[S>>5]:10+G[S>>10]:S<16777216?S<524288?15+G[S>>15]:20+G[S>>20]:S<536870912?25+G[S>>25]:S<-2147483648?30+G[S>>30]:0;if(e.validBits<0)B=0;else if(e.validBits<k)if(k>24)B=e.readBits(24)+(e.readBits(k-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<k))break}if(e.validBits<0)B=0;else{var D=e.acc&(1<<k)-1;e.acc=e.acc>>>k,e.validBits-=k,B=D}}else{var x=e.acc&(1<<k)-1;e.acc=e.acc>>>k,e.validBits-=k,B=x}N.magnitude=B;var Z,z=i.chan[y],W=t-1,T=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],V=W<16384?W<16?T[W]:W<512?5+T[W>>5]:10+T[W>>10]:W<16777216?W<524288?15+T[W>>15]:20+T[W>>20]:W<536870912?25+T[W>>25]:W<-2147483648?30+T[W>>30]:0;if(e.validBits<0)Z=0;else if(e.validBits<V)if(V>24)Z=e.readBits(24)+(e.readBits(V-24)<<24);else{for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<V))break}if(e.validBits<0)Z=0;else{var K=e.acc&(1<<V)-1;e.acc=e.acc>>>V,e.validBits-=V,Z=K}}else{var F=e.acc&(1<<V)-1;e.acc=e.acc>>>V,e.validBits-=V,Z=F}if(z.angle=Z,i.chan[y].magnitude>=t)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[y].angle>=t)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[y].magnitude==i.chan[y].angle)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(e.validBits<0)h=0;else if(e.validBits<2){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<2))break}if(e.validBits<0)h=0;else{var Y=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,h=Y}}else{var H=3&e.acc;e.acc=e.acc>>>2,e.validBits-=2,h=H}if(0!=h)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.submaps>1)for(var R=0,L=t;R<L;){var X,j=R++,E=i.chan[j];if(e.validBits<0)X=0;else if(e.validBits<4){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<4))break}if(e.validBits<0)X=0;else{var O=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,X=O}}else{var U=15&e.acc;e.acc=e.acc>>>4,e.validBits-=4,X=U}if(E.mux=X,i.chan[j].mux>=i.submaps)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var P=0,Q=t;P<Q;){var J=P++;i.chan[J].mux=0}var q=i.submaps,$=new Array(q);i.submapFloor=$;var ee=i.submaps,te=new Array(ee);i.submapResidue=te;for(var ae=0,ie=i.submaps;ae<ie;){var se=ae++;if(e.validBits>=0)if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits>=0){e.acc;e.acc=e.acc>>>8,e.validBits-=8}}else{e.acc;e.acc=e.acc>>>8,e.validBits-=8}var re,ne=i.submapFloor;if(e.validBits<0)re=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)re=0;else{var le=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,re=le}}else{var oe=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,re=oe}ne[se]=re;var he,ce=i.submapResidue;if(e.validBits<0)he=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)he=0;else{var de=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,he=de}}else{var ue=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,he=ue}ce[se]=he}return i},Ut.prototype={doFloor:function(e,t,a,i,s,r){var n=a>>1,l=this.chan[t].mux,o=e[this.submapFloor[l]];if(0==o.type)throw new et(new $t(ea.INVALID_STREAM,null,{fileName:"Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var h=o.floor1,c=0,d=s[0]*h.floor1Multiplier,u=1,g=h.values;u<g;){var f=u++,p=h.sortedOrder[f];if(s[p]>=0){var m=s[p]*h.floor1Multiplier,v=h.xlist[p];Yt.drawLine(i,c,d,v,m,n),c=v,d=m}}if(c<n)for(var _=c,I=n;_<I;){var w=_++,b=i;b[w]=b[w]*Yt.INVERSE_DB_TABLE[d]}},__class__:Ut};var Pt=function(){};a["kha.audio2.ogg.vorbis.data.MappingChannel"]=Pt,Pt.__name__=!0,Pt.prototype={__class__:Pt};var Qt=function(){};a["kha.audio2.ogg.vorbis.data.Mode"]=Qt,Qt.__name__=!0,Qt.read=function(e){var t,a,i,s,r=new Qt;if(e.validBits<0)t=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)t=0;else{var n=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,t=n}}else{var l=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,t=l}if(r.blockflag=0!=t,e.validBits<0)a=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)a=0;else{var o=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=o}}else{var h=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=h}if(r.windowtype=a,e.validBits<0)i=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)i=0;else{var c=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=c}}else{var d=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,i=d}if(r.transformtype=i,e.validBits<0)s=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)s=0;else{var u=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=u}}else{var g=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,s=g}if(r.mapping=s,0!=r.windowtype)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=r.transformtype)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return r},Qt.prototype={__class__:Qt};var Jt=function(){};a["kha.audio2.ogg.vorbis.data.Page"]=Jt,Jt.__name__=!0,Jt.prototype={clone:function(){var e=new Jt;return e.flag=this.flag,e},start:function(e){var t,a,i;if(e.inputPosition+=1,79==e.input.readByte()?(e.inputPosition+=1,i=103!=e.input.readByte()):i=!0,i?a=!0:(e.inputPosition+=1,a=103!=e.input.readByte()),a?t=!0:(e.inputPosition+=1,t=83!=e.input.readByte()),t)throw new et(new $t(ea.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:323,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(e)},startWithoutCapturePattern:function(e){e.inputPosition+=1;var t=e.input.readByte();if(0!=t)throw new et(new $t(ea.INVALID_STREAM_STRUCTURE_VERSION,""+t,{fileName:"Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));e.inputPosition+=1,this.flag=e.input.readByte(),e.inputPosition+=4;var a=e.input.readInt32();e.inputPosition+=4;var i=e.input.readInt32();e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.setup(a,i)},__class__:Jt};var qt=function(){};a["kha.audio2.ogg.vorbis.data.ProbedPage"]=qt,qt.__name__=!0,qt.prototype={__class__:qt};var $t=function(e,t,a){null==t&&(t=""),this.type=e,this.message=t,this.posInfos=a};a["kha.audio2.ogg.vorbis.data.ReaderError"]=$t,$t.__name__=!0,$t.prototype={__class__:$t};var ea=a["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"]};ea.NEED_MORE_DATA=["NEED_MORE_DATA",0],ea.NEED_MORE_DATA.toString=i,ea.NEED_MORE_DATA.__enum__=ea,ea.INVALID_API_MIXING=["INVALID_API_MIXING",1],ea.INVALID_API_MIXING.toString=i,ea.INVALID_API_MIXING.__enum__=ea,ea.OUTOFMEM=["OUTOFMEM",2],ea.OUTOFMEM.toString=i,ea.OUTOFMEM.__enum__=ea,ea.FEATURE_NOT_SUPPORTED=["FEATURE_NOT_SUPPORTED",3],ea.FEATURE_NOT_SUPPORTED.toString=i,ea.FEATURE_NOT_SUPPORTED.__enum__=ea,ea.TOO_MANY_CHANNELS=["TOO_MANY_CHANNELS",4],ea.TOO_MANY_CHANNELS.toString=i,ea.TOO_MANY_CHANNELS.__enum__=ea,ea.FILE_OPEN_FAILURE=["FILE_OPEN_FAILURE",5],ea.FILE_OPEN_FAILURE.toString=i,ea.FILE_OPEN_FAILURE.__enum__=ea,ea.SEEK_WITHOUT_LENGTH=["SEEK_WITHOUT_LENGTH",6],ea.SEEK_WITHOUT_LENGTH.toString=i,ea.SEEK_WITHOUT_LENGTH.__enum__=ea,ea.UNEXPECTED_EOF=["UNEXPECTED_EOF",7],ea.UNEXPECTED_EOF.toString=i,ea.UNEXPECTED_EOF.__enum__=ea,ea.SEEK_INVALID=["SEEK_INVALID",8],ea.SEEK_INVALID.toString=i,ea.SEEK_INVALID.__enum__=ea,ea.INVALID_SETUP=["INVALID_SETUP",9],ea.INVALID_SETUP.toString=i,ea.INVALID_SETUP.__enum__=ea,ea.INVALID_STREAM=["INVALID_STREAM",10],ea.INVALID_STREAM.toString=i,ea.INVALID_STREAM.__enum__=ea,ea.MISSING_CAPTURE_PATTERN=["MISSING_CAPTURE_PATTERN",11],ea.MISSING_CAPTURE_PATTERN.toString=i,ea.MISSING_CAPTURE_PATTERN.__enum__=ea,ea.INVALID_STREAM_STRUCTURE_VERSION=["INVALID_STREAM_STRUCTURE_VERSION",12],ea.INVALID_STREAM_STRUCTURE_VERSION.toString=i,ea.INVALID_STREAM_STRUCTURE_VERSION.__enum__=ea,ea.CONTINUED_PACKET_FLAG_INVALID=["CONTINUED_PACKET_FLAG_INVALID",13],ea.CONTINUED_PACKET_FLAG_INVALID.toString=i,ea.CONTINUED_PACKET_FLAG_INVALID.__enum__=ea,ea.INCORRECT_STREAM_SERIAL_NUMBER=["INCORRECT_STREAM_SERIAL_NUMBER",14],ea.INCORRECT_STREAM_SERIAL_NUMBER.toString=i,ea.INCORRECT_STREAM_SERIAL_NUMBER.__enum__=ea,ea.INVALID_FIRST_PAGE=["INVALID_FIRST_PAGE",15],ea.INVALID_FIRST_PAGE.toString=i,ea.INVALID_FIRST_PAGE.__enum__=ea,ea.BAD_PACKET_TYPE=["BAD_PACKET_TYPE",16],ea.BAD_PACKET_TYPE.toString=i,ea.BAD_PACKET_TYPE.__enum__=ea,ea.CANT_FIND_LAST_PAGE=["CANT_FIND_LAST_PAGE",17],ea.CANT_FIND_LAST_PAGE.toString=i,ea.CANT_FIND_LAST_PAGE.__enum__=ea,ea.SEEK_FAILED=["SEEK_FAILED",18],ea.SEEK_FAILED.toString=i,ea.SEEK_FAILED.__enum__=ea,ea.OTHER=["OTHER",19],ea.OTHER.toString=i,ea.OTHER.__enum__=ea;var ta=function(){};a["kha.audio2.ogg.vorbis.data.Residue"]=ta,ta.__name__=!0,ta.read=function(e,t){var a,i=new ta;if(e.validBits<0)a=0;else if(e.validBits<16){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<16))break}if(e.validBits<0)a=0;else{var s=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=s}}else{var r=65535&e.acc;e.acc=e.acc>>>16,e.validBits-=16,a=r}if(i.type=a,i.type>2)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var n,l,o,h,c=new Array(64);if(e.validBits<0)n=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)n=0;else{var d=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,n=d}}else{var u=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,n=u}if(i.begin=n,e.validBits<0)l=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)l=0;else{var g=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,l=g}}else{var f=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,l=f}if(i.end=l,e.validBits<0)o=0;else if(e.validBits<24){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<24))break}if(e.validBits<0)o=0;else{var p=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,o=p}}else{var m=16777215&e.acc;e.acc=e.acc>>>24,e.validBits-=24,o=m}if(i.partSize=o+1,e.validBits<0)h=0;else if(e.validBits<6){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<6))break}if(e.validBits<0)h=0;else{var v=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=v}}else{var _=63&e.acc;e.acc=e.acc>>>6,e.validBits-=6,h=_}var I,w=i.classifications=h+1;if(e.validBits<0)I=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)I=0;else{var b=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,I=b}}else{var C=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,I=C}i.classbook=I;for(var A=0,M=i.classifications;A<M;){var B,y,N=A++,S=0;if(e.validBits<0)B=0;else if(e.validBits<3){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<3))break}if(e.validBits<0)B=0;else{var G=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,B=G}}else{var k=7&e.acc;e.acc=e.acc>>>3,e.validBits-=3,B=k}if(e.validBits<0)y=0;else if(e.validBits<1){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<1))break}if(e.validBits<0)y=0;else{var D=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,y=D}}else{var x=1&e.acc;e.acc=e.acc>>>1,e.validBits-=1,y=x}if(0!=y)if(e.validBits<0)S=0;else if(e.validBits<5){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<5))break}if(e.validBits<0)S=0;else{var Z=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,S=Z}}else{var z=31&e.acc;e.acc=e.acc>>>5,e.validBits-=5,S=z}c[N]=8*S+B}var W=i.classifications,T=new Array(W);i.residueBooks=T;for(var V=0,K=i.classifications;V<K;){var F=V++,Y=i.residueBooks,H=new Array(8);Y[F]=H;for(var R=0;R<8;){var L=R++;if(0!=(c[F]&1<<L)){var X,j=i.residueBooks[F];if(e.validBits<0)X=0;else if(e.validBits<8){for(0==e.validBits&&(e.acc=0);;){if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())){e.validBits=-1;break}if(e.bytesInSeg--,e.inputPosition+=1,e.acc=e.acc+(e.input.readByte()<<e.validBits),e.validBits+=8,!(e.validBits<8))break}if(e.validBits<0)X=0;else{var E=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,X=E}}else{var O=255&e.acc;e.acc=e.acc>>>8,e.validBits-=8,X=O}if(j[L]=X,i.residueBooks[F][L]>=t.length)throw new et(new $t(ea.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[F][L]=-1}}var U=t[i.classbook].entries,P=t[i.classbook].dimensions,Q=new Array(U);i.classdata=Q;for(var J=0,q=U;J<q;)for(var $=J++,ee=$,te=P,ae=i.classdata,ie=new Array(P),se=ae[$]=ie;--te>=0;)se[te]=ee%w,ee=ee/w|0;return i},ta.prototype={decode:function(e,t,a,i,s,r,n){for(var l=t.codebooks,o=l[this.classbook].dimensions,h=this.end-this.begin,c=this.partSize,d=v.toFloat(h)/v.toFloat(c)|0,u=t.channel*d+1,g=new Array(u),f=0,p=i;f<p;){var m=f++;if(!r[m])for(var _=a[m],I=0,w=_.length;I<w;){_[I++]=0}}if(2!=this.type||1==i)for(var b=0;b<8;)for(var C=b++,A=0;A<d;){if(0==C)for(var M=0,B=i;M<B;){var y=M++;if(!r[y]){var N=l[this.classbook];e.validBits<10&&e.prepHuffman();var S,G=N.fastHuffman[1023&e.acc];if(G>=0){var k=N.codewordLengths[G];e.acc=e.acc>>>k,e.validBits-=k,e.validBits<0?(e.validBits=0,S=-1):S=G}else S=e.decodeScalarRaw(N);N.sparse&&(S=N.sortedValues[S]);var D=S;if(-1==D)return;for(var x=o;--x>=0;)g[y*d+x+A]=D%this.classifications,D=D/this.classifications|0}}for(var Z=0,z=o;Z<z;){Z++;if(A>=d)break;for(var W=0,T=i;W<T;){var V=W++;if(!r[V]){var K=g[V*d+A],F=this.residueBooks[K][C];if(F>=0){var Y=a[V],H=this.begin+A*c,R=c;if(!l[F].residueDecode(e,Y,H,R,this.type))return}}}++A}}else{for(var L=0,X=i;L<X;){var j=L++;if(!r[j])break;if(j==i-1)return}for(var E=0;E<8;){var O=E++,U=0;if(2==i)for(;U<d;){var P=this.begin+U*c,Q=1&P,J=P>>>1;if(0==O){var q=l[this.classbook];e.validBits<10&&e.prepHuffman();var $,ee=q.fastHuffman[1023&e.acc];if(ee>=0){var te=q.codewordLengths[ee];e.acc=e.acc>>>te,e.validBits-=te,e.validBits<0?(e.validBits=0,$=-1):$=ee}else $=e.decodeScalarRaw(q);q.sparse&&($=q.sortedValues[$]);var ae=$;if(-1==ae)return;for(var ie=o;--ie>=0;)g[ie+U]=ae%this.classifications,ae=ae/this.classifications|0}for(var se=0,re=o;se<re;){se++;if(U>=d)break;var ne=this.begin+U*c,le=g[U],oe=this.residueBooks[le][O];if(oe>=0){var he=l[oe].decodeDeinterleaveRepeat(e,a,i,Q,J,s,c);if(null==he)return;Q=he.cInter,J=he.pInter}else Q=1&(ne+=c),J=ne>>>1;++U}}else if(1==i)for(;U<d;){var ce=0,de=this.begin+U*c;if(0==O){var ue=l[this.classbook];e.validBits<10&&e.prepHuffman();var ge,fe=ue.fastHuffman[1023&e.acc];if(fe>=0){var pe=ue.codewordLengths[fe];e.acc=e.acc>>>pe,e.validBits-=pe,e.validBits<0?(e.validBits=0,ge=-1):ge=fe}else ge=e.decodeScalarRaw(ue);ue.sparse&&(ge=ue.sortedValues[ge]);var me=ge;if(-1==me)return;for(var ve=o;--ve>=0;)g[ve+U]=me%this.classifications,me=me/this.classifications|0}for(var _e=0,Ie=o;_e<Ie;){_e++;if(U>=d)break;var we=this.begin+U*c,be=this.residueBooks[g[U]][O];if(be>=0){var Ce=l[be].decodeDeinterleaveRepeat(e,a,i,ce,de,s,c);if(null==Ce)return;ce=Ce.cInter,de=Ce.pInter}else ce=0,de=we+=c;++U}}else for(;U<d;){var Ae=this.begin+U*c,Me=v.toFloat(Ae)%v.toFloat(i)|0,Be=v.toFloat(Ae)/v.toFloat(i)|0;if(0==O){var ye=l[this.classbook];e.validBits<10&&e.prepHuffman();var Ne,Se=ye.fastHuffman[1023&e.acc];if(Se>=0){var Ge=ye.codewordLengths[Se];e.acc=e.acc>>>Ge,e.validBits-=Ge,e.validBits<0?(e.validBits=0,Ne=-1):Ne=Se}else Ne=e.decodeScalarRaw(ye);ye.sparse&&(Ne=ye.sortedValues[Ne]);var ke=Ne;if(-1==ke)return;for(var De=o;--De>=0;)g[De+U]=ke%this.classifications,ke=ke/this.classifications|0}for(var xe=0,Ze=o;xe<Ze;){xe++;if(U>=d)break;var ze=this.begin+U*c,We=this.residueBooks[g[U]][O];if(We>=0){var Te=l[We].decodeDeinterleaveRepeat(e,a,i,Me,Be,s,c);if(null==Te)return;Me=Te.cInter,Be=Te.pInter}else ze+=c,Me=v.toFloat(ze)%v.toFloat(i)|0,Be=v.toFloat(ze)/v.toFloat(i)|0;++U}}}}},__class__:ta};var aa=function(){};a["kha.graphics1.Graphics"]=aa,aa.__name__=!0;var ia=function(){this.transformations=[],this.transformations.push(new He(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};a["kha.graphics2.Graphics"]=ia,ia.__name__=!0,ia.prototype={begin:function(e,t){null==e&&(e=!0)},end:function(){},fillRect:function(e,t,a,i){},set_color:function(e){return-16777216},get_fontSize:function(){return this.myFontSize},get_opacity:function(){return this.opacities[this.opacities.length-1]},__class__:ia,__properties__:{get_opacity:"get_opacity",get_fontSize:"get_fontSize",set_color:"set_color"}};var sa=function(e){this.canvas=e};a["kha.graphics2.Graphics1"]=sa,sa.__name__=!0,sa.__interfaces__=[aa],sa.prototype={__class__:sa};var ra=a["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"]};ra.Low=["Low",0],ra.Low.toString=i,ra.Low.__enum__=ra,ra.High=["High",1],ra.High.toString=i,ra.High.__enum__=ra;var na=function(){};a["kha.graphics2.truetype.VectorOfIntPointer"]=na,na.__name__=!0,na.prototype={__class__:na};var la=function(){};a["kha.graphics2.truetype.Stbtt_temp_rect"]=la,la.__name__=!0,la.prototype={__class__:la};var oa=function(){};a["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=oa,oa.__name__=!0,oa.prototype={__class__:oa};var ha=function(){};a["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=ha,ha.__name__=!0,ha.prototype={__class__:ha};var ca=function(){};a["kha.graphics2.truetype.Stbtt_bakedchar"]=ca,ca.__name__=!0,ca.prototype={__class__:ca};var da=function(){};a["kha.graphics2.truetype.Stbtt_fontinfo"]=da,da.__name__=!0,da.prototype={__class__:da};var ua=function(){};a["kha.graphics2.truetype.Stbtt_vertex"]=ua,ua.__name__=!0,ua.prototype={__class__:ua};var ga=function(){};a["kha.graphics2.truetype.Stbtt__bitmap"]=ga,ga.__name__=!0,ga.prototype={__class__:ga};var fa=function(){};a["kha.graphics2.truetype.Stbtt__edge"]=fa,fa.__name__=!0,fa.prototype={__class__:fa};var pa=function(){};a["kha.graphics2.truetype.Stbtt__active_edge"]=pa,pa.__name__=!0,pa.prototype={__class__:pa};var ma=function(){};a["kha.graphics2.truetype.Stbtt__point"]=ma,ma.__name__=!0,ma.prototype={__class__:ma};var va=function(){};a["kha.graphics2.truetype.StbTruetype"]=va,va.__name__=!0,va.stbtt__find_table=function(e,t,a){for(var i=t+4,s=e.readU8(i),r=t+12,l=0,o=e.readU8(i+1)|s<<8;l<o;){var h=r+16*l++,c=n.cca(a,0),d=n.cca(a,1),u=n.cca(a,2),g=n.cca(a,3);if(e.readU8(h)==c&&e.readU8(h+1)==d&&e.readU8(h+2)==u&&e.readU8(h+3)==g){var f=h+8,p=e.readU8(f),m=e.readU8(f+1),v=e.readU8(f+2);return e.readU8(f+3)|v<<8|m<<16|p<<24}}return 0},va.stbtt_InitFont=function(e,t,a){var i,s,r;if(e.data=t,e.fontstart=a,i=va.stbtt__find_table(t,a,"cmap"),e.loca=va.stbtt__find_table(t,a,"loca"),e.head=va.stbtt__find_table(t,a,"head"),e.glyf=va.stbtt__find_table(t,a,"glyf"),e.hhea=va.stbtt__find_table(t,a,"hhea"),e.hmtx=va.stbtt__find_table(t,a,"hmtx"),e.kern=va.stbtt__find_table(t,a,"kern"),0==i||0==e.loca||0==e.head||0==e.glyf||0==e.hhea||0==e.hmtx)return!1;if(0!=(s=va.stbtt__find_table(t,a,"maxp"))){var n=s+4,l=t.readU8(n),o=t.readU8(n+1);e.numGlyphs=o|l<<8}else e.numGlyphs=65535;var h=i+2,c=t.readU8(h);r=t.readU8(h+1)|c<<8,e.index_map=0;for(var d=0,u=r;d<u;){var g=i+4+8*d++,f=t.readU8(g);switch(t.readU8(g+1)|f<<8){case 0:var p=g+4,m=t.readU8(p),v=t.readU8(p+1),_=t.readU8(p+2),I=t.readU8(p+3);e.index_map=i+(I|_<<8|v<<16|m<<24);break;case 3:var w=g+2,b=t.readU8(w);switch(t.readU8(w+1)|b<<8){case 1:case 10:var C=g+4,A=t.readU8(C),M=t.readU8(C+1),B=t.readU8(C+2),y=t.readU8(C+3);e.index_map=i+(y|B<<8|M<<16|A<<24)}}}if(0==e.index_map)return!1;var N=e.head+50,S=t.readU8(N),G=t.readU8(N+1);return e.indexToLocFormat=G|S<<8,!0},va.stbtt_FindGlyphIndex=function(e,t){var a=e.data,i=e.index_map,s=a.readU8(i),r=a.readU8(i+1)|s<<8;if(0==r){var n=i+2,l=a.readU8(n);return t<(a.readU8(n+1)|l<<8)-6?a.readU8(i+6+t):0}if(6==r){var o=i+6,h=a.readU8(o),c=a.readU8(o+1)|h<<8,d=i+8,u=a.readU8(d),g=a.readU8(d+1);if(t>=c&&t<c+(g|u<<8)){var f=i+10+2*(t-c),p=a.readU8(f);return a.readU8(f+1)|p<<8}return 0}if(2==r)throw new et("Error");if(4==r){var m=i+6,v=a.readU8(m),_=(a.readU8(m+1)|v<<8)>>1,I=i+8,w=a.readU8(I),b=(a.readU8(I+1)|w<<8)>>1,C=i+10,A=a.readU8(C),M=a.readU8(C+1)|A<<8,B=i+12,y=a.readU8(B),N=(a.readU8(B+1)|y<<8)>>1,S=i+14,G=S;if(t>65535)return 0;var k,D,x=G+2*N,Z=a.readU8(x);for(t>=(a.readU8(x+1)|Z<<8)&&(G+=2*N),G-=2;0!=M;){var z=G+2*(b>>=1),W=a.readU8(z);t>(a.readU8(z+1)|W<<8)&&(G+=2*b),--M}var T=(G+=2)-S>>1,V=S+2*T,K=a.readU8(V);if(t>(a.readU8(V+1)|K<<8))throw new et("Error");var F=i+14+2*_+2+2*T,Y=a.readU8(F);if(t<(D=a.readU8(F+1)|Y<<8))return 0;var H=i+14+6*_+2+2*T,R=a.readU8(H);if(0==(k=a.readU8(H+1)|R<<8)){var L=i+14+4*_+2+2*T,X=a.readU8(L),j=a.readU8(L+1)|X<<8;return t+(0!=(32768&j)?j-65536:j)}var E=k+2*(t-D)+i+14+6*_+2+2*T,O=a.readU8(E);return a.readU8(E+1)|O<<8}if(12==r||13==r){var U,P,Q=i+12,J=a.readU8(Q),q=a.readU8(Q+1),$=a.readU8(Q+2);for(U=0,P=a.readU8(Q+3)|$<<8|q<<16|J<<24;U<P;){var ee=U+(P-U>>1),te=i+16+12*ee,ae=a.readU8(te),ie=a.readU8(te+1),se=a.readU8(te+2),re=a.readU8(te+3)|se<<8|ie<<16|ae<<24,ne=i+16+12*ee+4,le=a.readU8(ne),oe=a.readU8(ne+1),he=a.readU8(ne+2),ce=a.readU8(ne+3);if(t<re)P=ee;else{if(!(t>(ce|he<<8|oe<<16|le<<24))){var de=i+16+12*ee+8,ue=a.readU8(de),ge=a.readU8(de+1),fe=a.readU8(de+2),pe=a.readU8(de+3)|fe<<8|ge<<16|ue<<24;return 12==r?pe+t-re:pe}U=ee+1}}return 0}throw new et("Error")},va.stbtt_setvertex=function(e,t,a,i,s,r){e.type=t,e.x=a,e.y=i,e.cx=s,e.cy=r},va.stbtt__GetGlyfOffset=function(e,t){var a,i;if(t>=e.numGlyphs)return-1;if(e.indexToLocFormat>=2)return-1;if(0==e.indexToLocFormat){var s=e.glyf,r=e.data,n=e.loca+2*t,l=r.readU8(n);a=s+2*(r.readU8(n+1)|l<<8);var o=e.glyf,h=e.data,c=e.loca+2*t+2,d=h.readU8(c);i=o+2*(h.readU8(c+1)|d<<8)}else{var u=e.glyf,g=e.data,f=e.loca+4*t,p=g.readU8(f),m=g.readU8(f+1),v=g.readU8(f+2);a=u+(g.readU8(f+3)|v<<8|m<<16|p<<24);var _=e.glyf,I=e.data,w=e.loca+4*t+4,b=I.readU8(w),C=I.readU8(w+1),A=I.readU8(w+2);i=_+(I.readU8(w+3)|A<<8|C<<16|b<<24)}return a==i?-1:a},va.stbtt_GetGlyphBox=function(e,t,a){var i=va.stbtt__GetGlyfOffset(e,t);if(i<0)return!1;var s=e.data,r=i+2,n=s.readU8(r),l=s.readU8(r+1)|n<<8;a.x0=0!=(32768&l)?l-65536:l;var o=e.data,h=i+4,c=o.readU8(h),d=o.readU8(h+1)|c<<8;a.y0=0!=(32768&d)?d-65536:d;var u=e.data,g=i+6,f=u.readU8(g),p=u.readU8(g+1)|f<<8;a.x1=0!=(32768&p)?p-65536:p;var m=e.data,v=i+8,_=m.readU8(v),I=m.readU8(v+1)|_<<8;return a.y1=0!=(32768&I)?I-65536:I,!0},va.stbtt__close_shape=function(e,t,a,i,s,r,n,l,o,h){return i?(a&&va.stbtt_setvertex(e[t++],3,o+n>>1,h+l>>1,o,h),va.stbtt_setvertex(e[t++],3,s,r,n,l)):a?va.stbtt_setvertex(e[t++],3,s,r,o,h):va.stbtt_setvertex(e[t++],2,s,r,0,0),t},va.copyVertices=function(e,t,a,i){for(var s=0,r=i;s<r;){var n=s++;t[a+n]=e[n]}},va.stbtt_GetGlyphShape=function(e,t){var a,i,s=e.data,r=null,n=0,l=va.stbtt__GetGlyfOffset(e,t);if(l<0)return null;var o=s.readU8(l),h=s.readU8(l+1)|o<<8;if((a=0!=(32768&h)?h-65536:h)>0){var c,d,u,g,f,p,m,v,_,I,w,b,C,A,M=0,B=0,y=0,N=!1,S=!1,G=0;i=s.sub(l+10,s.get_length()-(l+10));var k=l+10+2*a,D=s.readU8(k);d=s.readU8(k+1)|D<<8,A=s.sub(l+10+2*a+2+d,s.get_length()-(l+10+2*a+2+d));var x=2*a-2,Z=i.readU8(x);if(u=(g=1+(i.readU8(x+1)|Z<<8))+2*a,null==(r=new Array(u)))return null;for(var z=0,W=r.length;z<W;){r[z++]=new ua}y=0,c=0,f=u-g;for(var T=0,V=g;T<V;){var K=T++;0==c?0!=(8&(M=A.readU8(G++)))&&(c=A.readU8(G++)):--c,r[f+K].type=M}p=0;for(var F=0,Y=g;F<Y;){var H=F++;if(0!=(2&(M=r[f+H].type))){var R=A.readU8(G++);p+=0!=(16&M)?R:-R}else if(0==(16&M)){var L=A.readU8(G),X=A.readU8(G+1)|L<<8;p+=0!=(32768&X)?X-65536:X,G+=2}r[f+H].x=p}m=0;for(var j=0,E=g;j<E;){var O=j++;if(0!=(4&(M=r[f+O].type))){var U=A.readU8(G++);m+=0!=(32&M)?U:-U}else if(0==(32&M)){var P=A.readU8(G),Q=A.readU8(G+1)|P<<8;m+=0!=(32768&Q)?Q-65536:Q,G+=2}r[f+O].y=m}n=0,I=w=v=_=b=C=0;for(var J=0;J<g;){if(M=r[f+J].type,p=r[f+J].x,m=r[f+J].y,y==J){0!=J&&(n=va.stbtt__close_shape(r,n,N,S,I,w,b,C,v,_)),(S=0==(1&M))?(b=p,C=m,0==(1&r[f+J+1].type)?(I=p+r[f+J+1].x>>1,w=m+r[f+J+1].y>>1):(I=r[f+J+1].x,w=r[f+J+1].y,++J)):(I=p,w=m),va.stbtt_setvertex(r[n++],1,I,w,0,0),N=!1;var q=2*B,$=i.readU8(q);y=1+(i.readU8(q+1)|$<<8),++B}else 0==(1&M)?(N&&va.stbtt_setvertex(r[n++],3,v+p>>1,_+m>>1,v,_),v=p,_=m,N=!0):(N?va.stbtt_setvertex(r[n++],3,p,m,v,_):va.stbtt_setvertex(r[n++],2,p,m,0,0),N=!1);++J}n=va.stbtt__close_shape(r,n,N,S,I,w,b,C,v,_)}else if(-1==a){var ee=1,te=s.sub(l+10,s.get_length()-(l+10)),ae=0;for(n=0,r=null;0!=ee;){var ie,se,re,ne,le,oe=0,he=null,ce=1,de=0,ue=0,ge=1,fe=0,pe=0,me=te.readU8(ae),ve=te.readU8(ae+1)|me<<8;ie=0!=(32768&ve)?ve-65536:ve,ae+=2;var _e=te.readU8(ae),Ie=te.readU8(ae+1)|_e<<8;if(se=0!=(32768&Ie)?Ie-65536:Ie,ae+=2,0==(2&ie))throw new et("Error");if(0!=(1&ie)){var we=te.readU8(ae),be=te.readU8(ae+1)|we<<8;fe=0!=(32768&be)?be-65536:be,ae+=2;var Ce=te.readU8(ae),Ae=te.readU8(ae+1)|Ce<<8;pe=0!=(32768&Ae)?Ae-65536:Ae,ae+=2}else{var Me=te.readU8(ae);fe=Me>=128?Me-256:Me,++ae;var Be=te.readU8(ae);pe=Be>=128?Be-256:Be,++ae}if(0!=(8&ie)){var ye=te.readU8(ae),Ne=te.readU8(ae+1)|ye<<8;ce=ge=(0!=(32768&Ne)?Ne-65536:Ne)/16384,ae+=2,de=ue=0}else if(0!=(64&ie)){var Se=te.readU8(ae),Ge=te.readU8(ae+1)|Se<<8;ce=(0!=(32768&Ge)?Ge-65536:Ge)/16384,ae+=2,de=ue=0;var ke=te.readU8(ae),De=te.readU8(ae+1)|ke<<8;ge=(0!=(32768&De)?De-65536:De)/16384,ae+=2}else if(0!=(128&ie)){var xe=te.readU8(ae),Ze=te.readU8(ae+1)|xe<<8;ce=(0!=(32768&Ze)?Ze-65536:Ze)/16384,ae+=2;var ze=te.readU8(ae),We=te.readU8(ae+1)|ze<<8;de=(0!=(32768&We)?We-65536:We)/16384,ae+=2;var Te=te.readU8(ae),Ve=te.readU8(ae+1)|Te<<8;ue=(0!=(32768&Ve)?Ve-65536:Ve)/16384,ae+=2;var Ke=te.readU8(ae),Fe=te.readU8(ae+1)|Ke<<8;ge=(0!=(32768&Fe)?Fe-65536:Fe)/16384,ae+=2}if(ne=Math.sqrt(ce*ce+de*de),le=Math.sqrt(ue*ue+ge*ge),(oe=null==(re=va.stbtt_GetGlyphShape(e,se))?0:re.length)>0){for(var Ye=0,He=oe;Ye<He;){var Re,Le,Xe=re[Ye++];Re=Xe.x,Le=Xe.y,Xe.x=ne*(ce*Re+ue*Le+fe)|0,Xe.y=le*(de*Re+ge*Le+pe)|0,Re=Xe.cx,Le=Xe.cy,Xe.cx=ne*(ce*Re+ue*Le+fe)|0,Xe.cy=le*(de*Re+ge*Le+pe)|0}if(null==(he=new Array(n+oe)))return null;n>0&&va.copyVertices(r,he,0,n),va.copyVertices(re,he,n,oe),r=he,n+=oe}ee=32&ie}}else if(a<0)throw new et("Error");if(null==r)return null;if(r.length<n)throw new et("Error");if(n<r.length){var je=new Array(n);return va.copyVertices(r,je,0,n),je}return r},va.stbtt_GetGlyphHMetrics=function(e,t){var a=e.data,i=e.hhea+34,s=a.readU8(i),r=a.readU8(i+1)|s<<8,n=new oa;if(t<r){var l=e.data,o=e.hmtx+4*t,h=l.readU8(o),c=l.readU8(o+1)|h<<8;n.advanceWidth=0!=(32768&c)?c-65536:c;var d=e.data,u=e.hmtx+4*t+2,g=d.readU8(u),f=d.readU8(u+1)|g<<8;n.leftSideBearing=0!=(32768&f)?f-65536:f}else{var p=e.data,m=e.hmtx+4*(r-1),v=p.readU8(m),_=p.readU8(m+1)|v<<8;n.advanceWidth=0!=(32768&_)?_-65536:_;var I=e.data,w=e.hmtx+4*r+2*(t-r),b=I.readU8(w),C=I.readU8(w+1)|b<<8;n.leftSideBearing=0!=(32768&C)?C-65536:C}return n},va.stbtt_GetFontVMetrics=function(e){var t=new ha,a=e.data,i=e.hhea+4,s=a.readU8(i),r=a.readU8(i+1)|s<<8;t.ascent=0!=(32768&r)?r-65536:r;var n=e.data,l=e.hhea+6,o=n.readU8(l),h=n.readU8(l+1)|o<<8;t.descent=0!=(32768&h)?h-65536:h;var c=e.data,d=e.hhea+8,u=c.readU8(d),g=c.readU8(d+1)|u<<8;return t.lineGap=0!=(32768&g)?g-65536:g,t},va.stbtt_ScaleForPixelHeight=function(e,t){var a=e.data,i=e.hhea+4,s=a.readU8(i),r=a.readU8(i+1)|s<<8,n=e.data,l=e.hhea+6,o=n.readU8(l),h=n.readU8(l+1)|o<<8;return t/((0!=(32768&r)?r-65536:r)-(0!=(32768&h)?h-65536:h))},va.stbtt_GetGlyphBitmapBoxSubpixel=function(e,t,a,i,s,r){var n=new la;if(va.stbtt_GetGlyphBox(e,t,n)){var l=n.x0,o=n.x1,h=n.y0,c=n.y1;n.x0=Math.floor(l*a+s),n.y0=Math.floor(-c*i+r),n.x1=Math.ceil(o*a+s),n.y1=Math.ceil(-h*i+r)}else n.x0=0,n.y0=0,n.x1=0,n.y1=0;return n},va.stbtt_GetGlyphBitmapBox=function(e,t,a,i){return va.stbtt_GetGlyphBitmapBoxSubpixel(e,t,a,i,0,0)},va.stbtt__new_active=function(e,t,a,i){var s=new pa,r=(e[t].x1-e[t].x0)/(e[t].y1-e[t].y0);return null==s?s:(s.fdx=r,s.fdy=0!=r?1/r:0,s.fx=e[t].x0+r*(i-e[t].y0),s.fx-=a,s.direction=e[t].invert?1:-1,s.sy=e[t].y0,s.ey=e[t].y1,s.next=null,s)},va.stbtt__handle_clipped_edge=function(e,t,a,i,s,r,n,l){if(r!=l){if(!(r<l))throw new et("Error");if(!(i.sy<=i.ey))throw new et("Error");if(!(r>i.ey||l<i.sy)){if(r<i.sy&&(s+=(n-s)*(i.sy-r)/(l-r),r=i.sy),l>i.ey&&(n+=(n-s)*(i.ey-l)/(l-r),l=i.ey),s==a){if(!(n<=a+1))throw new et("Error")}else if(s==a+1){if(!(n>=a))throw new et("Error")}else if(s<=a){if(!(n<=a))throw new et("Error")}else if(s>=a+1){if(!(n>=a+1))throw new et("Error")}else if(!(n>=a&&n<=a+1))throw new et("Error");if(s<=a&&n<=a){var o=t+a,h=e;h[o]=h[o]+i.direction*(l-r)}else if(!(s>=a+1&&n>=a+1)){if(!(s>=a&&s<=a+1&&n>=a&&n<=a+1))throw new et("Error");var c=t+a,d=e;d[c]=d[c]+i.direction*(l-r)*(1-(s-a+(n-a))/2)}}}},va.stbtt__fill_active_edges_new=function(e,t,a,i,s,r){for(var n=r+1;null!=s;){if(!(s.ey>=r))throw new et("Error");if(0==s.fdx){var l=s.fx;l<i&&(l>=0?(va.stbtt__handle_clipped_edge(e,0,0|l,s,l,r,l,n),va.stbtt__handle_clipped_edge(t,a-1,l+1|0,s,l,r,l,n)):va.stbtt__handle_clipped_edge(t,a-1,0,s,l,r,l,n))}else{var o,h,c,d,u=s.fx,g=s.fdx,f=u+g,p=s.fdy;if(!(s.sy<=n&&s.ey>=r))throw new et("Error");if(s.sy>r?(o=u+g*(s.sy-r),c=s.sy):(o=u,c=r),s.ey<n?(h=u+g*(s.ey-r),d=s.ey):(h=f,d=n),o>=0&&h>=0&&o<i&&h<i)if((0|o)==(0|h)){var m,v=0|o;if(m=d-c,!(v>=0&&v<i))throw new et("Error");var _=v,I=e;I[_]=I[_]+s.direction*(1-(o-v+(h-v))/2)*m;var w=a+v,b=t;b[w]=b[w]+s.direction*m}else{var C,A,M,B,y,N,S;if(o>h)S=c=n-(c-r),c=d=n-(d-r),d=S,S=h,h=o,o=S,g=-g,p=-p,S=u,u=f,f=S;A=0|h,M=((C=0|o)+1-u)*p+r,N=(y=s.direction)*(M-c);var G=C,k=e;k[G]=k[G]+N*(1-(o-C+(C+1-C))/2),B=y*p;for(var D=C+1,x=A;D<x;){var Z=D++,z=e;z[Z]=z[Z]+(N+B/2),N+=B}if(M+=p*(A-(C+1)),!(Math.abs(N)<=1.01))throw new et("Error");var W=A,T=e;T[W]=T[W]+(N+y*(1-(A-A+(h-A))/2)*(d-M));var V=a+A,K=t;K[V]=K[V]+y*(d-c)}else for(var F=0,Y=i;F<Y;){var H,R,L=F++,X=r,j=L,E=L+1,O=f,U=n;H=(L-u)/g+r,R=(L+1-u)/g+r,u<j&&O>E?(va.stbtt__handle_clipped_edge(e,0,L,s,u,X,j,H),va.stbtt__handle_clipped_edge(e,0,L,s,j,H,E,R),va.stbtt__handle_clipped_edge(e,0,L,s,E,R,O,U)):O<j&&u>E?(va.stbtt__handle_clipped_edge(e,0,L,s,u,X,E,R),va.stbtt__handle_clipped_edge(e,0,L,s,E,R,j,H),va.stbtt__handle_clipped_edge(e,0,L,s,j,H,O,U)):u<j&&O>j?(va.stbtt__handle_clipped_edge(e,0,L,s,u,X,j,H),va.stbtt__handle_clipped_edge(e,0,L,s,j,H,O,U)):O<j&&u>j?(va.stbtt__handle_clipped_edge(e,0,L,s,u,X,j,H),va.stbtt__handle_clipped_edge(e,0,L,s,j,H,O,U)):u<E&&O>E?(va.stbtt__handle_clipped_edge(e,0,L,s,u,X,E,R),va.stbtt__handle_clipped_edge(e,0,L,s,E,R,O,U)):O<E&&u>E?(va.stbtt__handle_clipped_edge(e,0,L,s,u,X,E,R),va.stbtt__handle_clipped_edge(e,0,L,s,E,R,O,U)):va.stbtt__handle_clipped_edge(e,0,L,s,u,X,O,U)}}s=s.next}},va.stbtt__rasterize_sorted_edges=function(e,t,a,i,s,r){var n,l,o,h,c=null,d=0,u=0;if(e.w>64){var g=2*e.w+1;l=new Array(g)}else{l=new Array(129)}for(o=l,h=e.w,n=r,t[u+a].y0=r+e.h+1;d<e.h;){var f,p,m=n+0,v=n+1;f=c,p=null;for(var _=0,I=e.w;_<I;){l[_++]=0}for(var w=0,b=e.w+1;w<b;){o[h+w++]=0}for(;null!=f;){var C=f;if(C.ey<=m){if(null==p?(c=C.next,f=C.next):(p.next=C.next,f=C.next),0==C.direction)throw new et("Error");C.direction=0}else p=f,f=f.next}for(;t[u].y0<=v;){if(t[u].y0!=t[u].y1){var A=va.stbtt__new_active(t,u,s,m);if(!(A.ey>=m))throw new et("Error");A.next=c,c=A}++u}null!=c&&va.stbtt__fill_active_edges_new(l,o,h+1,e.w,c,m);for(var M=0,B=0,y=e.w;B<y;){var N,S,G=B++;M+=o[h+G],N=l[G]+M,(S=0|(N=255*Math.abs(N)+.5))>255&&(S=255),e.pixels.writeU8(e.pixels_offset+d*e.stride+G,S)}for(p=null,f=c;null!=f;){var k=f;k.fx+=k.fdx,p=f,f=f.next}++n,++d}},va.STBTT__COMPARE=function(e,t){return e.y0<t.y0},va.stbtt__sort_edges_ins_sort=function(e,t){for(var a,i=1,s=t;i<s;){var r=i++,n=e[r],l=n;for(a=r;a>0;){var o=e[a-1];if(!va.STBTT__COMPARE(l,o))break;e[a]=e[a-1],--a}r!=a&&(e[a]=n)}},va.stbtt__sort_edges_quicksort=function(e,t,a){for(;a>12;){var i,s,r,n,l,o;if(r=a>>1,va.STBTT__COMPARE(e[t],e[t+r])!=(s=va.STBTT__COMPARE(e[t+r],e[t+a-1])))i=e[t+(o=va.STBTT__COMPARE(e[t],e[t+a-1])==s?0:a-1)],e[t+o]=e[t+r],e[t+r]=i;for(i=e[t],e[t]=e[t+r],e[t+r]=i,n=1,l=a-1;;){for(;va.STBTT__COMPARE(e[t+n],e[t]);)++n;for(;va.STBTT__COMPARE(e[t],e[t+l]);)--l;if(n>=l)break;i=e[t+n],e[t+n]=e[t+l],e[t+l]=i,++n,--l}l<a-n?(va.stbtt__sort_edges_quicksort(e,t,l),t+=n,a-=n):(va.stbtt__sort_edges_quicksort(e,t+n,a-n),a=l)}},va.stbtt__sort_edges=function(e,t){va.stbtt__sort_edges_quicksort(e,0,t),va.stbtt__sort_edges_ins_sort(e,t)},va.stbtt__rasterize=function(e,t,a,i,s,r,n,l,o,h,c){var d,u,g,f,p=c?-r:r;u=0;for(var m=0,v=i;m<v;){u+=a[m++]}if(null!=(d=new Array(u+1))){for(var _=0,I=d.length;_<I;){d[_++]=new fa}u=0,f=0;for(var w=0,b=i;w<b;){var C=w++,A=t,M=0+f;f+=a[C],g=a[C]-1;for(var B=0,y=a[C];B<y;){var N=B++,S=N,G=g;A[M+g].y!=A[M+N].y?(d[u].invert=!1,(c?A[M+g].y>A[M+N].y:A[M+g].y<A[M+N].y)&&(d[u].invert=!0,S=g,G=N),d[u].x0=A[M+S].x*s+n,d[u].y0=1*(A[M+S].y*p+l),d[u].x1=A[M+G].x*s+n,d[u].y1=1*(A[M+G].y*p+l),++u,g=N):g=N}}va.stbtt__sort_edges(d,u),va.stbtt__rasterize_sorted_edges(e,d,u,1,o,h)}},va.stbtt__add_point=function(e,t,a,i){null!=e&&(e[t].x=a,e[t].y=i)},va.stbtt__tesselate_curve=function(e,t,a,i,s,r,n,l,o,h){var c=(a+2*s+n)/4,d=(i+2*r+l)/4,u=(a+n)/2-c,g=(i+l)/2-d;return h>16?1:(u*u+g*g>o?(va.stbtt__tesselate_curve(e,t,a,i,(a+s)/2,(i+r)/2,c,d,o,h+1),va.stbtt__tesselate_curve(e,t,c,d,(s+n)/2,(r+l)/2,n,l,o,h+1)):(va.stbtt__add_point(e,t.value,n,l),t.value+=1),1)},va.stbtt_FlattenCurves=function(e,t,a,i,s){for(var r=null,n=0,l=a*a,o=0,h=0,c=0,d=t;c<d;){1==e[c++].type&&++o}if(s.value=o,0==o)return null;var u=new Array(o);if(i.value=u,null==i.value)return s.value=0,null;for(var g=0;g<2;){var f=0,p=0;if(1==g++){if(null==(r=new Array(n)))return i.value=null,s.value=0,null;for(var m=0,v=r.length;m<v;){r[m++]=new ma}}n=0,o=-1;for(var _=0,I=t;_<I;){var w=_++;switch(e[w].type){case 1:o>=0&&(i.value[o]=n-h),++o,h=n,f=e[w].x,p=e[w].y,va.stbtt__add_point(r,n++,f,p);break;case 2:f=e[w].x,p=e[w].y,va.stbtt__add_point(r,n++,f,p);break;case 3:var b={value:n};va.stbtt__tesselate_curve(r,b,f,p,e[w].cx,e[w].cy,e[w].x,e[w].y,l,0),n=b.value,f=e[w].x,p=e[w].y}}i.value[o]=n-h}return r},va.stbtt_Rasterize=function(e,t,a,i,s,r,n,l,o,h,c){var d,u=s>r?r:s,g=0,f={value:g},p=new na,m=va.stbtt_FlattenCurves(a,i,t/u,p,f);g=f.value,d=p.value,null!=m&&va.stbtt__rasterize(e,m,d,g,s,r,n,l,o,h,c)},va.stbtt_MakeGlyphBitmapSubpixel=function(e,t,a,i,s,r,n,l,o,h,c){var d,u,g=va.stbtt_GetGlyphShape(e,c),f=null==g?0:g.length,p=new ga,m=va.stbtt_GetGlyphBitmapBoxSubpixel(e,c,n,l,o,h);d=m.x0,u=m.y0,p.pixels=t,p.pixels_offset=a,p.w=i,p.h=s,p.stride=r,0!=p.w&&0!=p.h&&va.stbtt_Rasterize(p,.35,g,f,n,l,o,h,d,u,!0)},va.stbtt_MakeGlyphBitmap=function(e,t,a,i,s,r,n,l,o){va.stbtt_MakeGlyphBitmapSubpixel(e,t,a,i,s,r,n,l,0,0,o)},va.stbtt_BakeFontBitmap=function(e,t,a,i,s,r,n,l){var o,h,c,d,u=new da;if(!va.stbtt_InitFont(u,e,t))return-1;for(var g=0,f=s*r;g<f;){var p=g++;i.writeU8(p,0)}h=c=1,d=1,o=va.stbtt_ScaleForPixelHeight(u,a);for(var m=0,v=0;v<n.length;){var _,I,w,b,C,A=n[v];++v;var M=va.stbtt_FindGlyphIndex(u,A),B=va.stbtt_GetGlyphHMetrics(u,M);_=B.advanceWidth,B.leftSideBearing;var y=va.stbtt_GetGlyphBitmapBox(u,M,o,o);if(I=y.x0,w=y.y0,h+(b=y.x1-I)+1>=s&&(c=d,h=1),c+(C=y.y1-w)+1>=r)return-m;if(h+b>=s)throw new et("Error");if(c+C>=r)throw new et("Error");va.stbtt_MakeGlyphBitmap(u,i,h+c*s,b,C,s,o,o,M),l[m].x0=h,l[m].y0=c,l[m].x1=h+b,l[m].y1=c+C,l[m].xadvance=o*_,l[m].xoff=I,l[m].yoff=w,h=h+b+1,c+C+1>d&&(d=c+C+1),++m}return d};var _a=a["kha.graphics4.BlendingFactor"]={__ename__:!0,__constructs__:["Undefined","BlendOne","BlendZero","SourceAlpha","DestinationAlpha","InverseSourceAlpha","InverseDestinationAlpha","SourceColor","DestinationColor","InverseSourceColor","InverseDestinationColor"]};_a.Undefined=["Undefined",0],_a.Undefined.toString=i,_a.Undefined.__enum__=_a,_a.BlendOne=["BlendOne",1],_a.BlendOne.toString=i,_a.BlendOne.__enum__=_a,_a.BlendZero=["BlendZero",2],_a.BlendZero.toString=i,_a.BlendZero.__enum__=_a,_a.SourceAlpha=["SourceAlpha",3],_a.SourceAlpha.toString=i,_a.SourceAlpha.__enum__=_a,_a.DestinationAlpha=["DestinationAlpha",4],_a.DestinationAlpha.toString=i,_a.DestinationAlpha.__enum__=_a,_a.InverseSourceAlpha=["InverseSourceAlpha",5],_a.InverseSourceAlpha.toString=i,_a.InverseSourceAlpha.__enum__=_a,_a.InverseDestinationAlpha=["InverseDestinationAlpha",6],_a.InverseDestinationAlpha.toString=i,_a.InverseDestinationAlpha.__enum__=_a,_a.SourceColor=["SourceColor",7],_a.SourceColor.toString=i,_a.SourceColor.__enum__=_a,_a.DestinationColor=["DestinationColor",8],_a.DestinationColor.toString=i,_a.DestinationColor.__enum__=_a,_a.InverseSourceColor=["InverseSourceColor",9],_a.InverseSourceColor.toString=i,_a.InverseSourceColor.__enum__=_a,_a.InverseDestinationColor=["InverseDestinationColor",10],_a.InverseDestinationColor.toString=i,_a.InverseDestinationColor.__enum__=_a;var Ia=a["kha.graphics4.BlendingOperation"]={__ename__:!0,__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"]};Ia.Add=["Add",0],Ia.Add.toString=i,Ia.Add.__enum__=Ia,Ia.Subtract=["Subtract",1],Ia.Subtract.toString=i,Ia.Subtract.__enum__=Ia,Ia.ReverseSubtract=["ReverseSubtract",2],Ia.ReverseSubtract.toString=i,Ia.ReverseSubtract.__enum__=Ia,Ia.Min=["Min",3],Ia.Min.toString=i,Ia.Min.__enum__=Ia,Ia.Max=["Max",4],Ia.Max.toString=i,Ia.Max.__enum__=Ia;var wa=a["kha.graphics4.CompareMode"]={__ename__:!0,__constructs__:["Always","Never","Equal","NotEqual","Less","LessEqual","Greater","GreaterEqual"]};wa.Always=["Always",0],wa.Always.toString=i,wa.Always.__enum__=wa,wa.Never=["Never",1],wa.Never.toString=i,wa.Never.__enum__=wa,wa.Equal=["Equal",2],wa.Equal.toString=i,wa.Equal.__enum__=wa,wa.NotEqual=["NotEqual",3],wa.NotEqual.toString=i,wa.NotEqual.__enum__=wa,wa.Less=["Less",4],wa.Less.toString=i,wa.Less.__enum__=wa,wa.LessEqual=["LessEqual",5],wa.LessEqual.toString=i,wa.LessEqual.__enum__=wa,wa.Greater=["Greater",6],wa.Greater.toString=i,wa.Greater.__enum__=wa,wa.GreaterEqual=["GreaterEqual",7],wa.GreaterEqual.toString=i,wa.GreaterEqual.__enum__=wa;var ba=function(){};a["kha.graphics4.ConstantLocation"]=ba,ba.__name__=!0;var Ca=function(e,t,a,i){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=e,this.myHeight=e,this.format=t,this.renderTarget=a,this.depthStencilFormat=i,a&&this.createTexture()};a["kha.graphics4.CubeMap"]=Ca,Ca.__name__=!0,Ca.__interfaces__=[ot,lt],Ca.createRenderTarget=function(e,t,a,i){return null==i&&(i=0),null==t&&(t=Ya.RGBA32),null==a&&(a=0),new Ca(e,t,!0,a)},Ca.prototype={createTexture:function(){if(null!=Nt.gl){if(this.texture=Nt.gl.createTexture(),Nt.gl.bindTexture(34067,this.texture),Nt.gl.texParameteri(34067,10240,9729),Nt.gl.texParameteri(34067,10241,9729),Nt.gl.texParameteri(34067,10242,33071),Nt.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=Nt.gl.createFramebuffer(),Nt.gl.bindFramebuffer(36160,this.frameBuffer),this.format[1]){case 0:for(var e=0;e<6;){var t=e++;Nt.gl.texImage2D(34069+t,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}break;case 2:for(var a=0;a<6;){var i=a++;Nt.gl.texImage2D(34069+i,0,Nt.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null)}break;case 3:for(var s=0;s<6;){var r=s++;Nt.gl.texImage2D(34069+r,0,Nt.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null)}break;case 4:for(var n=0;n<6;){var l=n++;Nt.gl.texImage2D(34069+l,0,Nt.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Nt.halfFloat.HALF_FLOAT_OES,null)}break;case 5:for(var o=0;o<6;){var h=o++;Nt.gl.texImage2D(34069+h,0,Nt.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null)}break;case 6:for(var c=0;c<6;){var d=c++;Nt.gl.texImage2D(34069+d,0,Nt.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Nt.halfFloat.HALF_FLOAT_OES,null)}break;default:for(var u=0;u<6;){var g=u++;Nt.gl.texImage2D(34069+g,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}}if(this.format==Ya.DEPTH16&&(Nt.gl.texParameteri(34067,10240,9728),Nt.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!Nt.gl2)){var f=Nt.gl.createTexture();Nt.gl.bindTexture(34067,f);for(var p=0;p<6;){var m=p++;Nt.gl.texImage2D(34069+m,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Nt.gl.framebufferTexture2D(36160,36064,34069+m,f,0)}Nt.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),Nt.gl.bindFramebuffer(36160,null)}Nt.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(e){switch(e){case 0:break;case 1:case 5:this.depthTexture=Nt.gl.createTexture(),Nt.gl.bindTexture(34067,this.depthTexture),1==e?Nt.gl.texImage2D(34067,0,Nt.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):Nt.gl.texImage2D(34067,0,Nt.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Nt.gl.texParameteri(34067,10240,9728),Nt.gl.texParameteri(34067,10241,9728),Nt.gl.texParameteri(34067,10242,33071),Nt.gl.texParameteri(34067,10243,33071),Nt.gl.bindFramebuffer(36160,this.frameBuffer),Nt.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=Nt.gl.createTexture(),Nt.gl.bindTexture(34067,this.depthTexture),Nt.gl.texImage2D(34067,0,Nt.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,Nt.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),Nt.gl.texParameteri(34067,10240,9728),Nt.gl.texParameteri(34067,10241,9728),Nt.gl.texParameteri(34067,10242,33071),Nt.gl.texParameteri(34067,10243,33071),Nt.gl.bindFramebuffer(36160,this.frameBuffer),Nt.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(e){Nt.gl.activeTexture(33984+e),Nt.gl.bindTexture(34067,this.texture)},setDepth:function(e){Nt.gl.activeTexture(33984+e),Nt.gl.bindTexture(34067,this.depthTexture)},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){return null==this.graphics4&&(this.graphics4=new gi(this)),this.graphics4},__class__:Ca,__properties__:{get_g4:"get_g4",get_height:"get_height",get_width:"get_width"}};var Aa=a["kha.graphics4.CullMode"]={__ename__:!0,__constructs__:["Clockwise","CounterClockwise","None"]};Aa.Clockwise=["Clockwise",0],Aa.Clockwise.toString=i,Aa.Clockwise.__enum__=Aa,Aa.CounterClockwise=["CounterClockwise",1],Aa.CounterClockwise.toString=i,Aa.CounterClockwise.__enum__=Aa,Aa.None=["None",2],Aa.None.toString=i,Aa.None.__enum__=Aa;var Ma=function(e,t){this.sources=[];for(var a=0;a<e.length;){var i=e[a];++a,this.sources.push(i.toString())}this.type=35632,this.shader=null,this.files=t};a["kha.graphics4.FragmentShader"]=Ma,Ma.__name__=!0,Ma.fromSource=function(e){var t=new Ma([],["runtime-string"]);return t.sources.push(e),t},Ma.prototype={__class__:Ma};var Ba=function(){};a["kha.graphics4.GeometryShader"]=Ba,Ba.__name__=!0;var ya=function(){};a["kha.graphics4.Graphics"]=ya,ya.__name__=!0,ya.prototype={__class__:ya};var Na=function(e){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=e,this.bufferIndex=0,Na.initShaders(),this.initBuffers(),this.projectionLocation=Na.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Na.shaderPipeline.getTextureUnit("tex")};a["kha.graphics4.ImageShaderPainter"]=Na,Na.__name__=!0,Na.initShaders=function(){null==Na.shaderPipeline&&(Na.structure=ka.createImageVertexStructure(),Na.shaderPipeline=ka.createImagePipeline(Na.structure),Na.shaderPipeline.compile())},Na.prototype={get_pipeline:function(){return this.myPipeline},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){this.rectVertexBuffer=new La(4*Na.bufferSize,Na.structure,Ra.DynamicUsage),this.rectVertices=this.rectVertexBuffer.lock(),this.indexBuffer=new Da(3*Na.bufferSize*2,Ra.StaticUsage);for(var e=this.indexBuffer.lock(),t=0,a=Na.bufferSize;t<a;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}this.indexBuffer.unlock()},drawBuffer:function(){this.rectVertexBuffer.unlock(),this.g.setVertexBuffer(this.rectVertexBuffer),this.g.setIndexBuffer(this.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Na.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,this.lastTexture),this.g.setTextureParameters(this.textureLocation,Ka.Clamp,Ka.Clamp,this.bilinear?Fa.LinearFilter:Fa.PointFilter,this.bilinear?Fa.LinearFilter:Fa.PointFilter,this.bilinearMipmaps?xa.LinearMipFilter:xa.NoMipFilter),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*this.bufferIndex*3),this.g.setTexture(this.textureLocation,null),this.bufferIndex=0,this.rectVertices=this.rectVertexBuffer.lock()},end:function(){this.bufferIndex>0&&this.drawBuffer(),this.lastTexture=null},__class__:Na,__properties__:{get_pipeline:"get_pipeline"}};var Sa=function(e){this.myPipeline=null,this.g=e,this.bufferIndex=0,this.triangleBufferIndex=0,Sa.initShaders(),this.initBuffers(),this.projectionLocation=Sa.shaderPipeline.getConstantLocation("projectionMatrix")};a["kha.graphics4.ColoredShaderPainter"]=Sa,Sa.__name__=!0,Sa.initShaders=function(){null==Sa.shaderPipeline&&(Sa.structure=ka.createColoredVertexStructure(),Sa.shaderPipeline=ka.createColoredPipeline(Sa.structure),Sa.shaderPipeline.compile())},Sa.prototype={get_pipeline:function(){return this.myPipeline},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){this.rectVertexBuffer=new La(4*Sa.bufferSize,Sa.structure,Ra.DynamicUsage),this.rectVertices=this.rectVertexBuffer.lock(),this.indexBuffer=new Da(3*Sa.bufferSize*2,Ra.StaticUsage);for(var e=this.indexBuffer.lock(),t=0,a=Sa.bufferSize;t<a;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}this.indexBuffer.unlock(),this.triangleVertexBuffer=new La(3*Sa.triangleBufferSize,Sa.structure,Ra.DynamicUsage),this.triangleVertices=this.triangleVertexBuffer.lock(),this.triangleIndexBuffer=new Da(3*Sa.triangleBufferSize,Ra.StaticUsage);for(var s=this.triangleIndexBuffer.lock(),r=0,n=Sa.bufferSize;r<n;){var l=r++;s[3*l]=3*l,s[3*l+1]=3*l+1,s[3*l+2]=3*l+2}this.triangleIndexBuffer.unlock()},setRectVertices:function(e,t,a,i,s,r,n,l){var o=7*this.bufferIndex*4;this.rectVertices[o]=e,this.rectVertices[o+1]=t,this.rectVertices[o+2]=-5,this.rectVertices[o+7]=a,this.rectVertices[o+8]=i,this.rectVertices[o+9]=-5,this.rectVertices[o+14]=s,this.rectVertices[o+15]=r,this.rectVertices[o+16]=-5,this.rectVertices[o+21]=n,this.rectVertices[o+22]=l,this.rectVertices[o+23]=-5},setRectColors:function(e,t){var a=7*this.bufferIndex*4,i=e*(.00392156862745098*(t>>>24));this.rectVertices[a+3]=.00392156862745098*((16711680&t)>>>16),this.rectVertices[a+4]=.00392156862745098*((65280&t)>>>8),this.rectVertices[a+5]=.00392156862745098*(255&t),this.rectVertices[a+6]=i,this.rectVertices[a+10]=.00392156862745098*((16711680&t)>>>16),this.rectVertices[a+11]=.00392156862745098*((65280&t)>>>8),this.rectVertices[a+12]=.00392156862745098*(255&t),this.rectVertices[a+13]=i,this.rectVertices[a+17]=.00392156862745098*((16711680&t)>>>16),this.rectVertices[a+18]=.00392156862745098*((65280&t)>>>8),this.rectVertices[a+19]=.00392156862745098*(255&t),this.rectVertices[a+20]=i,this.rectVertices[a+24]=.00392156862745098*((16711680&t)>>>16),this.rectVertices[a+25]=.00392156862745098*((65280&t)>>>8),this.rectVertices[a+26]=.00392156862745098*(255&t),this.rectVertices[a+27]=i},drawBuffer:function(e){e||this.triangleBufferIndex>0&&this.drawTriBuffer(!0),this.rectVertexBuffer.unlock(),this.g.setVertexBuffer(this.rectVertexBuffer),this.g.setIndexBuffer(this.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Sa.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*this.bufferIndex*3),this.bufferIndex=0,this.rectVertices=this.rectVertexBuffer.lock()},drawTriBuffer:function(e){e||this.bufferIndex>0&&this.drawBuffer(!0),this.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(this.triangleVertexBuffer),this.g.setIndexBuffer(this.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?Sa.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*this.triangleBufferIndex),this.triangleBufferIndex=0,this.triangleVertices=this.triangleVertexBuffer.lock()},fillRect:function(e,t,a,i,s,r,n,l,o,h){this.triangleBufferIndex>0&&this.drawTriBuffer(!0),this.bufferIndex+1>=Sa.bufferSize&&this.drawBuffer(!1),this.setRectColors(e,t),this.setRectVertices(a,i,s,r,n,l,o,h),++this.bufferIndex},__class__:Sa,__properties__:{get_pipeline:"get_pipeline"}};var Ga=function(e){this.bilinear=!1,this.myPipeline=null,this.g=e,this.bufferIndex=0,Ga.initShaders(),this.initBuffers(),this.projectionLocation=Ga.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ga.shaderPipeline.getTextureUnit("tex")};a["kha.graphics4.TextShaderPainter"]=Ga,Ga.__name__=!0,Ga.initShaders=function(){null==Ga.shaderPipeline&&(Ga.structure=ka.createTextVertexStructure(),Ga.shaderPipeline=ka.createTextPipeline(Ga.structure),Ga.shaderPipeline.compile())},Ga.prototype={get_pipeline:function(){return this.myPipeline},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){this.rectVertexBuffer=new La(4*Ga.bufferSize,Ga.structure,Ra.DynamicUsage),this.rectVertices=this.rectVertexBuffer.lock(),this.indexBuffer=new Da(3*Ga.bufferSize*2,Ra.StaticUsage);for(var e=this.indexBuffer.lock(),t=0,a=Ga.bufferSize;t<a;){var i=t++;e[3*i*2]=4*i,e[3*i*2+1]=4*i+1,e[3*i*2+2]=4*i+2,e[3*i*2+3]=4*i,e[3*i*2+4]=4*i+2,e[3*i*2+5]=4*i+3}this.indexBuffer.unlock()},drawBuffer:function(){this.rectVertexBuffer.unlock(),this.g.setVertexBuffer(this.rectVertexBuffer),this.g.setIndexBuffer(this.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ga.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,this.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,Ka.Clamp,Ka.Clamp,this.bilinear?Fa.LinearFilter:Fa.PointFilter,this.bilinear?Fa.LinearFilter:Fa.PointFilter,xa.NoMipFilter),this.g.drawIndexedVertices(0,2*this.bufferIndex*3),this.g.setTexture(this.textureLocation,null),this.bufferIndex=0,this.rectVertices=this.rectVertexBuffer.lock()},end:function(){this.bufferIndex>0&&this.drawBuffer(),this.lastTexture=null},__class__:Ga,__properties__:{get_pipeline:"get_pipeline"}};var ka=function(e){ia.call(this),this.set_color(-1),this.canvas=e,this.g=e.get_g4(),this.imagePainter=new Na(this.g),this.coloredPainter=new Sa(this.g),this.textPainter=new Ga(this.g),this.textPainter.fontSize=this.get_fontSize(),this.setProjection(),null==ka.videoPipeline&&(ka.videoPipeline=ka.createImagePipeline(ka.createImageVertexStructure()),ka.videoPipeline.fragmentShader=At.painter_video_frag,ka.videoPipeline.vertexShader=At.painter_video_vert,ka.videoPipeline.compile())};a["kha.graphics4.Graphics2"]=ka,ka.__name__=!0,ka.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},ka.createImageVertexStructure=function(){var e=new Oa;return e.add("vertexPosition",Xa.Float3),e.add("texPosition",Xa.Float2),e.add("vertexColor",Xa.Float4),e},ka.createImagePipeline=function(e){var t=new za;return t.fragmentShader=At.painter_image_frag,t.vertexShader=At.painter_image_vert,t.inputLayout=[e],t.blendSource=_a.BlendOne,t.blendDestination=_a.InverseSourceAlpha,t.alphaBlendSource=_a.SourceAlpha,t.alphaBlendDestination=_a.InverseSourceAlpha,t},ka.createColoredVertexStructure=function(){var e=new Oa;return e.add("vertexPosition",Xa.Float3),e.add("vertexColor",Xa.Float4),e},ka.createColoredPipeline=function(e){var t=new za;return t.fragmentShader=At.painter_colored_frag,t.vertexShader=At.painter_colored_vert,t.inputLayout=[e],t.blendSource=_a.SourceAlpha,t.blendDestination=_a.InverseSourceAlpha,t.alphaBlendSource=_a.SourceAlpha,t.alphaBlendDestination=_a.InverseSourceAlpha,t},ka.createTextVertexStructure=function(){var e=new Oa;return e.add("vertexPosition",Xa.Float3),e.add("texPosition",Xa.Float2),e.add("vertexColor",Xa.Float4),e},ka.createTextPipeline=function(e){var t=new za;return t.fragmentShader=At.painter_text_frag,t.vertexShader=At.painter_text_vert,t.inputLayout=[e],t.blendSource=_a.SourceAlpha,t.blendDestination=_a.InverseSourceAlpha,t.alphaBlendSource=_a.SourceAlpha,t.alphaBlendDestination=_a.InverseSourceAlpha,t},ka.__super__=ia,ka.prototype=s(ia.prototype,{setProjection:function(){var e=this.canvas.get_width(),t=this.canvas.get_height();tt.__instanceof(this.canvas,pt)?this.projectionMatrix=te.orthogonalProjection(0,e,t,0,.1,1e3):(ht.get_nonPow2Supported()||(e=ka.upperPowerOfTwo(e),t=ka.upperPowerOfTwo(t)),this.g.renderTargetsInvertedY()?this.projectionMatrix=te.orthogonalProjection(0,e,0,t,.1,1e3):this.projectionMatrix=te.orthogonalProjection(0,e,t,0,.1,1e3)),this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},get_color:function(){return this.myColor},set_color:function(e){return this.myColor=e},fillRect:function(e,t,a,i){var s,r;this.imagePainter.end(),this.textPainter.end();var n,l=this.transformations[this.transformations.length-1],o=e;n=t+i;var h,c,d=l._02*o+l._12*n+l._22;r=(l._00*o+l._10*n+l._20)/d,s=(l._01*o+l._11*n+l._21)/d;var u,g=this.transformations[this.transformations.length-1],f=e;u=t;var p,m,v=g._02*f+g._12*u+g._22;c=(g._00*f+g._10*u+g._20)/v,h=(g._01*f+g._11*u+g._21)/v;var _,I=this.transformations[this.transformations.length-1],w=e+a;_=t;var b,C,A=I._02*w+I._12*_+I._22;m=(I._00*w+I._10*_+I._20)/A,p=(I._01*w+I._11*_+I._21)/A;var M,B=this.transformations[this.transformations.length-1],y=e+a;M=t+i;var N=B._02*y+B._12*M+B._22;C=(B._00*y+B._10*M+B._20)/N,b=(B._01*y+B._11*M+B._21)/N,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),r,s,c,h,m,p,C,b)},begin:function(e,t){null==e&&(e=!0),this.g.begin(),e&&this.clear(t),this.setProjection()},clear:function(e){this.flush(),this.g.clear(null==e?-16777216:e)},flush:function(){this.imagePainter.end(),this.textPainter.end();var e=this.coloredPainter;e.triangleBufferIndex>0&&e.drawTriBuffer(!1),e.bufferIndex>0&&e.drawBuffer(!1)},end:function(){this.flush(),this.g.end()},__class__:ka});var Da=function(e,t,a){null==a&&(a=!1),this.usage=t,this.mySize=e,this.buffer=Nt.gl.createBuffer();var i=new Uint32Array(e);this._data=i};a["kha.graphics4.IndexBuffer"]=Da,Da.__name__=!0,Da.prototype={delete:function(){this._data=null,Nt.gl.deleteBuffer(this.buffer)},lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e,e+t)},unlock:function(){Nt.gl.bindBuffer(34963,this.buffer);var e=null==Nt.elementIndexUint?new Uint16Array(this._data):this._data;Nt.gl.bufferData(34963,e,this.usage==Ra.DynamicUsage?35048:35044)},set:function(){Nt.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:Da};var xa=a["kha.graphics4.MipMapFilter"]={__ename__:!0,__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"]};xa.NoMipFilter=["NoMipFilter",0],xa.NoMipFilter.toString=i,xa.NoMipFilter.__enum__=xa,xa.PointMipFilter=["PointMipFilter",1],xa.PointMipFilter.toString=i,xa.PointMipFilter.__enum__=xa,xa.LinearMipFilter=["LinearMipFilter",2],xa.LinearMipFilter.toString=i,xa.LinearMipFilter.__enum__=xa;var Za=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=Aa.None,this.depthWrite=!1,this.depthMode=wa.Always,this.stencilMode=wa.Always,this.stencilBothPass=Wa.Keep,this.stencilDepthFail=Wa.Keep,this.stencilFail=Wa.Keep,this.stencilReferenceValue=0,this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=_a.BlendOne,this.blendDestination=_a.BlendZero,this.blendOperation=Ia.Add,this.alphaBlendSource=_a.BlendOne,this.alphaBlendDestination=_a.BlendZero,this.alphaBlendOperation=Ia.Add,this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=!0,this.conservativeRasterization=!1};a["kha.graphics4.PipelineStateBase"]=Za,Za.__name__=!0,Za.prototype={__class__:Za};var za=function(){this.program=null,Za.call(this),this.textures=[],this.textureValues=[]};a["kha.graphics4.PipelineState"]=za,za.__name__=!0,za.__super__=Za,za.prototype=s(Za.prototype,{delete:function(){null!=this.program&&Nt.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&Nt.gl.deleteProgram(this.program),this.program=Nt.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),Nt.gl.attachShader(this.program,this.vertexShader.shader),Nt.gl.attachShader(this.program,this.fragmentShader.shader);for(var e=0,t=0,a=this.inputLayout;t<a.length;){var i=a[t];++t;for(var s=0,r=i.elements;s<r.length;){var n=r[s];++s,Nt.gl.bindAttribLocation(this.program,e,n.name),n.data==Xa.Float4x4?e+=4:++e}}if(Nt.gl.linkProgram(this.program),!Nt.gl.getProgramParameter(this.program,35714))throw new et("Could not link the shader program:\n"+Nt.gl.getProgramInfoLog(this.program))},set:function(){Nt.gl.useProgram(this.program);for(var e=0,t=this.textureValues.length;e<t;){var a=e++;Nt.gl.uniform1i(this.textureValues[a],a)}Nt.gl.colorMask(this.colorWriteMaskRed,this.colorWriteMaskGreen,this.colorWriteMaskBlue,this.colorWriteMaskAlpha)},compileShader:function(e){if(null==e.shader){for(var t=Nt.gl.createShader(e.type),a=0!=Nt.gl.getShaderPrecisionFormat(35632,36338).precision,i=e.files,s=0,r=i.length;s<r;){var n=s++;if(Nt.gl2){if(i[n].indexOf("-webgl2")>=0||i[n].indexOf("runtime-string")>=0){Nt.gl.shaderSource(t,e.sources[n]);break}}else{if(!a&&(i[n].indexOf("-relaxed")>=0||i[n].indexOf("runtime-string")>=0)){Nt.gl.shaderSource(t,e.sources[n]);break}if(a&&(i[n].indexOf("-relaxed")<0||i[n].indexOf("runtime-string")>=0)){Nt.gl.shaderSource(t,e.sources[n]);break}}}if(Nt.gl.compileShader(t),!Nt.gl.getShaderParameter(t,35713))throw new et("Could not compile shader:\n"+Nt.gl.getShaderInfoLog(t));e.shader=t}},getConstantLocation:function(e){for(var t=Nt.gl.getUniformLocation(this.program,e),a=5126,i=0,s=Nt.gl.getProgramParameter(this.program,35718);i<s;){var r=i++,n=Nt.gl.getActiveUniform(this.program,r);if(n.name==e||n.name==e+"[0]"){a=n.type;break}}return new ui(t,a)},getTextureUnit:function(e){var t=this.findTexture(e);if(t<0){var a=Nt.gl.getUniformLocation(this.program,e);t=this.textures.length,this.textureValues.push(a),this.textures.push(e)}return new pi(t)},findTexture:function(e){for(var t=0,a=this.textures.length;t<a;){var i=t++;if(this.textures[i]==e)return i}return-1},__class__:za});var Wa=a["kha.graphics4.StencilAction"]={__ename__:!0,__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"]};Wa.Keep=["Keep",0],Wa.Keep.toString=i,Wa.Keep.__enum__=Wa,Wa.Zero=["Zero",1],Wa.Zero.toString=i,Wa.Zero.__enum__=Wa,Wa.Replace=["Replace",2],Wa.Replace.toString=i,Wa.Replace.__enum__=Wa,Wa.Increment=["Increment",3],Wa.Increment.toString=i,Wa.Increment.__enum__=Wa,Wa.IncrementWrap=["IncrementWrap",4],Wa.IncrementWrap.toString=i,Wa.IncrementWrap.__enum__=Wa,Wa.Decrement=["Decrement",5],Wa.Decrement.toString=i,Wa.Decrement.__enum__=Wa,Wa.DecrementWrap=["DecrementWrap",6],Wa.DecrementWrap.toString=i,Wa.DecrementWrap.__enum__=Wa,Wa.Invert=["Invert",7],Wa.Invert.toString=i,Wa.Invert.__enum__=Wa;var Ta=function(){};a["kha.graphics4.TessellationControlShader"]=Ta,Ta.__name__=!0;var Va=function(){};a["kha.graphics4.TessellationEvaluationShader"]=Va,Va.__name__=!0;var Ka=a["kha.graphics4.TextureAddressing"]={__ename__:!0,__constructs__:["Repeat","Mirror","Clamp"]};Ka.Repeat=["Repeat",0],Ka.Repeat.toString=i,Ka.Repeat.__enum__=Ka,Ka.Mirror=["Mirror",1],Ka.Mirror.toString=i,Ka.Mirror.__enum__=Ka,Ka.Clamp=["Clamp",2],Ka.Clamp.toString=i,Ka.Clamp.__enum__=Ka;var Fa=a["kha.graphics4.TextureFilter"]={__ename__:!0,__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"]};Fa.PointFilter=["PointFilter",0],Fa.PointFilter.toString=i,Fa.PointFilter.__enum__=Fa,Fa.LinearFilter=["LinearFilter",1],Fa.LinearFilter.toString=i,Fa.LinearFilter.__enum__=Fa,Fa.AnisotropicFilter=["AnisotropicFilter",2],Fa.AnisotropicFilter.toString=i,Fa.AnisotropicFilter.__enum__=Fa;var Ya=a["kha.graphics4.TextureFormat"]={__ename__:!0,__constructs__:["RGBA32","L8","RGBA128","DEPTH16","RGBA64","A32","A16"]};Ya.RGBA32=["RGBA32",0],Ya.RGBA32.toString=i,Ya.RGBA32.__enum__=Ya,Ya.L8=["L8",1],Ya.L8.toString=i,Ya.L8.__enum__=Ya,Ya.RGBA128=["RGBA128",2],Ya.RGBA128.toString=i,Ya.RGBA128.__enum__=Ya,Ya.DEPTH16=["DEPTH16",3],Ya.DEPTH16.toString=i,Ya.DEPTH16.__enum__=Ya,Ya.RGBA64=["RGBA64",4],Ya.RGBA64.toString=i,Ya.RGBA64.__enum__=Ya,Ya.A32=["A32",5],Ya.A32.toString=i,Ya.A32.__enum__=Ya,Ya.A16=["A16",6],Ya.A16.toString=i,Ya.A16.__enum__=Ya;var Ha=function(){};a["kha.graphics4.TextureUnit"]=Ha,Ha.__name__=!0;var Ra=a["kha.graphics4.Usage"]={__ename__:!0,__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"]};Ra.StaticUsage=["StaticUsage",0],Ra.StaticUsage.toString=i,Ra.StaticUsage.__enum__=Ra,Ra.DynamicUsage=["DynamicUsage",1],Ra.DynamicUsage.toString=i,Ra.DynamicUsage.__enum__=Ra,Ra.ReadableUsage=["ReadableUsage",2],Ra.ReadableUsage.toString=i,Ra.ReadableUsage.__enum__=Ra;var La=function(e,t,a,i,s){null==s&&(s=!1),null==i&&(i=0),this.usage=a,this.instanceDataStepRate=i,this.mySize=e,this.myStride=0;for(var r=0,n=t.elements;r<n.length;){var l=n[r];switch(++r,l.data[1]){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}}this.buffer=Nt.gl.createBuffer();var o=new xi(e*this.myStride/4|0);this._data=o,this.sizes=[],this.offsets=[],this.sizes[t.elements.length-1]=0,this.offsets[t.elements.length-1]=0;for(var h=0,c=0,d=0,u=t.elements;d<u.length;){var g,f=u[d];switch(++d,f.data[1]){case 0:g=1;break;case 1:g=2;break;case 2:g=3;break;case 3:g=4;break;case 4:g=16}switch(this.sizes[c]=g,this.offsets[c]=h,f.data[1]){case 0:h+=4;break;case 1:h+=8;break;case 2:h+=12;break;case 3:h+=16;break;case 4:h+=64}++c}};a["kha.graphics4.VertexBuffer"]=La,La.__name__=!0,La.prototype={delete:function(){this._data=null,Nt.gl.deleteBuffer(this.buffer)},lock:function(e,t){return null==e&&(e=0),null==t&&(t=this.mySize),this._data.subarray(e*this.stride(),(e+t)*this.stride())},unlock:function(){Nt.gl.bindBuffer(34962,this.buffer),Nt.gl.bufferData(34962,this._data,this.usage==Ra.DynamicUsage?35048:35044)},stride:function(){return this.myStride},set:function(e){var t=!!Nt.gl2||Nt.gl.getExtension("ANGLE_instanced_arrays");Nt.gl.bindBuffer(34962,this.buffer);for(var a=0,i=0,s=this.sizes.length;i<s;){var r=i++;if(this.sizes[r]>4)for(var n=this.sizes[r],l=0;n>0;)Nt.gl.enableVertexAttribArray(e+a),Nt.gl.vertexAttribPointer(e+a,4,5126,!1,this.myStride,this.offsets[r]+l),t&&(Nt.gl2?Nt.gl.vertexAttribDivisor(e+a,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+a,this.instanceDataStepRate)),n-=4,l+=16,++a;else Nt.gl.enableVertexAttribArray(e+a),Nt.gl.vertexAttribPointer(e+a,this.sizes[r],5126,!1,this.myStride,this.offsets[r]),t&&(Nt.gl2?Nt.gl.vertexAttribDivisor(e+a,this.instanceDataStepRate):t.vertexAttribDivisorANGLE(e+a,this.instanceDataStepRate)),++a}return a},__class__:La};var Xa=a["kha.graphics4.VertexData"]={__ename__:!0,__constructs__:["Float1","Float2","Float3","Float4","Float4x4"]};Xa.Float1=["Float1",0],Xa.Float1.toString=i,Xa.Float1.__enum__=Xa,Xa.Float2=["Float2",1],Xa.Float2.toString=i,Xa.Float2.__enum__=Xa,Xa.Float3=["Float3",2],Xa.Float3.toString=i,Xa.Float3.__enum__=Xa,Xa.Float4=["Float4",3],Xa.Float4.toString=i,Xa.Float4.__enum__=Xa,Xa.Float4x4=["Float4x4",4],Xa.Float4x4.toString=i,Xa.Float4x4.__enum__=Xa;var ja=function(e,t){this.name=e,this.data=t};a["kha.graphics4.VertexElement"]=ja,ja.__name__=!0,ja.prototype={__class__:ja};var Ea=function(e,t){this.sources=[];for(var a=0;a<e.length;){var i=e[a];++a,this.sources.push(i.toString())}this.type=35633,this.shader=null,this.files=t};a["kha.graphics4.VertexShader"]=Ea,Ea.__name__=!0,Ea.fromSource=function(e){var t=new Ea([],["runtime-string"]);return t.sources.push(e),t},Ea.prototype={__class__:Ea};var Oa=function(){this.elements=[],this.instanced=!1};a["kha.graphics4.VertexStructure"]=Oa,Oa.__name__=!0,Oa.prototype={add:function(e,t){this.elements.push(new ja(e,t))},size:function(){return this.elements.length},byteSize:function(){for(var e=0,t=0,a=this.elements.length;t<a;){var i=t++;e+=this.dataByteSize(this.elements[i].data)}return e},dataByteSize:function(e){switch(e[1]){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64}},get:function(e){return this.elements[e]},__class__:Oa};var Ua=e.kha.input.Gamepad=function(e,t){null==t&&(t="unknown"),null==e&&(e=0),this.index=e,this.axisListeners=[],this.buttonListeners=[],Ua.instances[e]=this};a["kha.input.Gamepad"]=Ua,Ua.__name__=!0,Ua.sendConnectEvent=function(e){Ua.instances[e].connected=!0;for(var t=0,a=Ua.connectListeners;t<a.length;){var i=a[t];++t,i(e)}},Ua.sendDisconnectEvent=function(e){Ua.instances[e].connected=!1;for(var t=0,a=Ua.disconnectListeners;t<a.length;){var i=a[t];++t,i(e)}},Ua.prototype={sendAxisEvent:function(e,t){for(var a=0,i=this.axisListeners;a<i.length;){var s=i[a];++a,s(e,t)}},sendButtonEvent:function(e,t){for(var a=0,i=this.buttonListeners;a<i.length;){var s=i[a];++a,s(e,t)}},__class__:Ua};var Pa=function(){this.__id=_i.nextId++,this._inputBuffer=new x(new ki(1))};a["kha.network.Controller"]=Pa,Pa.__name__=!0,Pa.prototype={_id:function(){return this.__id},__class__:Pa};var Qa=e.kha.input.Keyboard=function(){Pa.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Qa.instance=this};a["kha.input.Keyboard"]=Qa,Qa.__name__=!0,Qa.__super__=Pa,Qa.prototype=s(Pa.prototype,{sendDownEvent:function(e){if(null!=Ii.the()){var t=new x(new ki(4));t.setInt32(0,0),Ii.the().sendControllerUpdate(this._id(),t)}for(var a=0,i=this.downListeners;a<i.length;){var s=i[a];++a,s(e)}},sendUpEvent:function(e){if(null!=Ii.the()){var t=new x(new ki(4));t.setInt32(0,1),Ii.the().sendControllerUpdate(this._id(),t)}for(var a=0,i=this.upListeners;a<i.length;){var s=i[a];++a,s(e)}},sendPressEvent:function(e){if(null!=Ii.the()){var t=new x(new ki(5));t.setInt32(0,2);var a=n.cca(e,0);t.b[4]=255&a,Ii.the().sendControllerUpdate(this._id(),t)}for(var i=0,s=this.pressListeners;i<s.length;){var r=s[i];++i,r(e)}},__class__:Qa});var Ja=e.kha.input.Mouse=function(){Pa.call(this),Ja.instance=this};a["kha.input.Mouse"]=Ja,Ja.__name__=!0,Ja.get=function(e){return null==e&&(e=0),Nt.getMouse(e)},Ja.__super__=Pa,Ja.prototype=s(Pa.prototype,{notify:function(e,t,a,i,s){this.notifyWindowed(0,e,t,a,i,s)},notifyWindowed:function(e,t,a,i,s,r){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=a){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(a)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(i)}if(null!=s){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=e;)this.windowWheelListeners.push([]);this.windowWheelListeners[e].push(s)}if(null!=r){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=e;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[e].push(r)}},sendLeaveEvent:function(e){if(null!=Ii.the()){var t=new x(new ki(8));t.setInt32(0,0),t.setInt32(4,e),Ii.the().sendControllerUpdate(this._id(),t)}if(null!=this.windowLeaveListeners)for(var a=0,i=this.windowLeaveListeners[e];a<i.length;){var s=i[a];++a,s()}},sendDownEvent:function(e,t,a,i){if(null!=Ii.the()){var s=new x(new ki(20));s.setInt32(0,1),s.setInt32(4,e),s.setInt32(8,t),s.setInt32(12,a),s.setInt32(16,i),Ii.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowDownListeners)for(var r=0,n=this.windowDownListeners[e];r<n.length;){var l=n[r];++r,l(t,a,i)}},sendUpEvent:function(e,t,a,i){if(null!=Ii.the()){var s=new x(new ki(20));s.setInt32(0,2),s.setInt32(4,e),s.setInt32(8,t),s.setInt32(12,a),s.setInt32(16,i),Ii.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowUpListeners)for(var r=0,n=this.windowUpListeners[e];r<n.length;){var l=n[r];++r,l(t,a,i)}},sendMoveEvent:function(e,t,a,i,s){if(null!=Ii.the()){var r=new x(new ki(24));r.setInt32(0,3),r.setInt32(4,e),r.setInt32(8,t),r.setInt32(12,a),r.setInt32(16,i),r.setInt32(20,s),Ii.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowMoveListeners)for(var n=0,l=this.windowMoveListeners[e];n<l.length;){var o=l[n];++n,o(t,a,i,s)}},sendWheelEvent:function(e,t){if(null!=Ii.the()){var a=new x(new ki(12));a.setInt32(0,4),a.setInt32(4,e),a.setInt32(8,t),Ii.the().sendControllerUpdate(this._id(),a)}if(null!=this.windowWheelListeners)for(var i=0,s=this.windowWheelListeners[e];i<s.length;){var r=s[i];++i,r(t)}},__class__:Ja});var qa=function(){Ja.call(this)};a["kha.input.MouseImpl"]=qa,qa.__name__=!0,qa.__super__=Ja,qa.prototype=s(Ja.prototype,{__class__:qa});var $a=e.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],$a.instance=this};a["kha.input.Surface"]=$a,$a.__name__=!0,$a.prototype={sendTouchStartEvent:function(e,t,a){for(var i=0,s=this.touchStartListeners;i<s.length;){var r=s[i];++i,r(e,t,a)}},sendTouchEndEvent:function(e,t,a){for(var i=0,s=this.touchEndListeners;i<s.length;){var r=s[i];++i,r(e,t,a)}},sendMoveEvent:function(e,t,a){for(var i=0,s=this.moveListeners;i<s.length;){var r=s[i];++i,r(e,t,a)}},__class__:$a};var ei=function(e){this.bytes=e};a["kha.internal.BytesBlob"]=ei,ei.__name__=!0,ei.__interfaces__=[ot],ei.fromBytes=function(e){return new ei(e)},ei.alloc=function(e){return new ei(new x(new ki(e)))},ei.readF32=function(e){var t=0==(-2147483648&e)?1:-1,a=e>>23&255,i=8388607&e;switch(a){case 0:return 0;case 255:return 0!=i?NaN:t>0?1/0:-1/0;default:return t*((i+8388608)/8388608)*Math.pow(2,a-127)}},ei.bit=function(e,t){if(1==(e>>>t&1)){return 0,!0}return 0,!1},ei.toText=function(e,t){for(var a="",i=0,s=t;i<s;){var r=i++;a+=String.fromCharCode(e[r])}return a},ei.prototype={sub:function(e,t){return new ei(this.bytes.sub(e,t))},get_length:function(){return this.bytes.length},writeU8:function(e,t){this.bytes.b[e]=255&t},readU8:function(e){var t=this.bytes.b[e];return++e,t},readS8:function(e){var t=this.bytes.b[e];return++e,(0==(128&t)?1:-1)*(t&=127)},readU16BE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1];return e+=2,256*t+a},readU16LE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1];return e+=2,256*a+t},readU32LE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1],i=this.bytes.b[e+2],s=this.bytes.b[e+3];return e+=4,t+256*a+256*i*256+256*s*256*256},readU32BE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1],i=this.bytes.b[e+2],s=this.bytes.b[e+3];return e+=4,s+256*i+256*a*256+256*t*256*256},readS16BE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1];e+=2;var i=0==(128&t)?1:-1;return t&=127,-1==i?256*t-32767+a:256*t+a},readS16LE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1],i=0==(128&a)?1:-1;return a&=127,e+=2,-1==i?256*a-32767+t:256*a+t},readS32LE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1],i=this.bytes.b[e+2],s=this.bytes.b[e+3],r=0==(128&s)?1:-1;return s&=127,e+=4,-1==r?-2147483647+t+256*a+256*i*256+256*s*256*256:t+256*a+256*i*256+256*s*256*256},readS32BE:function(e){var t=this.bytes.b[e],a=this.bytes.b[e+1],i=this.bytes.b[e+2],s=this.bytes.b[e+3],r=0==(128&t)?1:-1;return t&=127,e+=4,-1==r?-2147483647+s+256*i+256*a*256+256*t*256*256:s+256*i+256*a*256+256*t*256*256},readF32LE:function(e){return ei.readF32(this.readS32LE(e))},readF32BE:function(e){return ei.readF32(this.readS32BE(e))},toString:function(){return this.bytes.toString()},readUtf8Char:function(e){if(e.value>=this.get_length())return-1;var t=this.readU8(e.value);++e.value;var a=0;if(ei.bit(t,7))if(ei.bit(t,7)&&ei.bit(t,6)&&!ei.bit(t,5)){var i=31&t,s=this.readU8(e.value);++e.value,a=i<<6|63&s}else ei.bit(t,7)&&ei.bit(t,6)&&ei.bit(t,5)&&!ei.bit(t,4)?e.value+=2:ei.bit(t,7)&&ei.bit(t,6)&&ei.bit(t,5)&&ei.bit(t,4)&&!ei.bit(t,3)&&(e.value+=3);else a=t;return a},readUtf8Block:function(e,t){var a=0;if(t.value>=this.get_length())return"";for(;a<2e3;){var i=this.readUtf8Char(t);if(i<0)break;e[a]=i,++a}return ei.toText(e,a)},readUtf8String:function(){var e=new Array(2e3),t="",a=0;this.get_length()>=3&&239==this.bytes.b[0]&&187==this.bytes.b[1]&&191==this.bytes.b[2]&&(a=3);for(var i={value:a};i.value<this.get_length();)t+=this.readUtf8Block(e,i);return t},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:ei,__properties__:{get_length:"get_length"}};var ti=function(){};a["kha.internal.HdrFormat"]=ti,ti.__name__=!0,ti.readBuf=function(e){for(var t=0;e[t++]=255&ti.buffer[ti.fileOffset],++ti.fileOffset<ti.bufferLength&&t<e.length;);return t},ti.readBufOffset=function(e,t,a){for(var i=0;e[t+i++]=255&ti.buffer[ti.fileOffset],++ti.fileOffset<ti.bufferLength&&i<a;);return i},ti.readPixelsRaw=function(e,t,a,i){var s=4*i,r=ti.readBufOffset(t,a,s);r<s&&S.trace("Error reading raw pixels: got "+r+" bytes, expected "+s,{fileName:"HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},ti.readPixelsRawRLE=function(e,t,a,i,s){var r,n,l,o=new Zi(4),h=null,c=new Zi(2);for(e.length;s>0;){if(ti.readBuf(o)<o.length)return void S.trace("Error reading bytes: expected "+o.length,{fileName:"HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=o[0]||2!=o[1]||0!=(128&o[2]))return t[a++]=255&o[0],t[a++]=255&o[1],t[a++]=255&o[2],t[a++]=255&o[3],void ti.readPixelsRaw(e,t,a,i*s-1);if(((255&o[2])<<8|255&o[3])!=i)return void S.trace("Wrong scanline width "+((255&o[2])<<8|255&o[3])+", expected "+i,{fileName:"HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==h)h=new Zi(4*i);r=0;for(var d=0;d<4;){for(n=(d+++1)*i;r<n;){if(ti.readBuf(c)<c.length)return void S.trace("Error reading 2-byte buffer",{fileName:"HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if((255&c[0])>128){if(0==(l=(255&c[0])-128)||l>n-r)return void S.trace("Bad scanline data",{fileName:"HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;l-- >0;)h[r++]=255&c[1]}else{if(0==(l=255&c[0])||l>n-r)return void S.trace("Bad scanline data",{fileName:"HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(h[r++]=255&c[1],--l>0){if(ti.readBufOffset(h,r,l)<l)return void S.trace("Error reading non-run data",{fileName:"HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});r+=l}}}}for(var u=0,g=i;u<g;){var f=u++;t[a]=255&h[f],t[a+1]=255&h[f+i],t[a+2]=255&h[f+2*i],t[a+3]=255&h[f+3*i],a+=4}--s}},ti.readLine=function(){for(var e="";;){var t=ti.buffer[ti.fileOffset];if(10==t){++ti.fileOffset;break}if(e+=String.fromCharCode(t),!(++ti.fileOffset<ti.bufferLength))break}return e},ti.parse=function(e){ti.buffer=j.fromBytes(e),ti.bufferLength=ti.buffer.length,ti.fileOffset=0;for(var t=0,a=0,i=!1,s=0;s<20;){s++;var r=ti.readLine();if(ti.formatPattern.match(r))i=!0;else if(ti.exposurePattern.match(r))parseFloat(ti.exposurePattern.matched(1));else if(ti.widthHeightPattern.match(r)){a=f.parseInt(ti.widthHeightPattern.matched(1)),t=f.parseInt(ti.widthHeightPattern.matched(2));break}}if(!i)return S.trace("File is not run length encoded!",{fileName:"HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var n=new Zi(t*a*4),l=t,o=a;ti.readPixelsRawRLE(ti.buffer,n,0,l,o);for(var h=new xi(t*a*4),c=0;c<n.length;){var d=n[c]/255,u=n[c+1]/255,g=n[c+2]/255,p=n[c+3],m=Math.pow(2,p-128);d*=m,u*=m,g*=m,h[c]=d,h[c+1]=u,h[c+2]=g,h[c+3]=1,c+=4}return{width:t,height:a,data:h}};var ai=function(e){this.stopped=!1,this.element=e};a["kha.js.AEAudioChannel"]=ai,ai.__name__=!0,ai.__interfaces__=[Gt],ai.prototype={play:function(){this.stopped=!1,Nt.mobile?Nt.insideInputEvent?(this.element.play(),Nt.mobileAudioPlaying=!0):Nt.mobileAudioPlaying?this.element.play():ai.todo.push(this):this.element.play()},__class__:ai};var ii=function(){};a["kha.js.AudioElementAudio"]=ii,ii.__name__=!0,ii._compile=function(){},ii.play=function(e,t){return null==t&&(t=!1),ii.stream(e,t)},ii.stream=function(e,t){null==t&&(t=!1),e.element.loop=t;var a=new ai(e.element);return a.play(),a};var si=function(e){ia.call(this),this.canvas=e,si.instance=this,this.myColor=dt.fromBytes(0,0,0),e.save()};a["kha.js.CanvasGraphics"]=si,si.__name__=!0,si.__super__=ia,si.prototype=s(ia.prototype,{begin:function(e,t){null==e&&(e=!0),e&&this.clear(t)},clear:function(e){null==e&&(e=0),this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",.00392156862745098*(e>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},set_color:function(e){return this.myColor=e,this.canvas.strokeStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&e)>>>16)+","+((65280&e)>>>8)+","+(255&e)+","+.00392156862745098*(e>>>24)+")",e},fillRect:function(e,t,a,i){var s=this.get_opacity();this.canvas.globalAlpha=s*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(e,t,a,i),this.canvas.globalAlpha=this.get_opacity()},__class__:si});var ri=function(){ft.call(this)};a["kha.js.EnvironmentVariables"]=ri,ri.__name__=!0,ri.__super__=ft,ri.prototype=s(ft.prototype,{__class__:ri});var ni=function(e){this.images=new Z,this.kravur=new ni.Kravur(e)};a["kha.js.Font"]=ni,ni.__name__=!0,ni.__interfaces__=[ot],ni.fromBytes=function(e){return new ni(ei.fromBytes(e))},ni.prototype={height:function(e){return this.kravur._get(e).getHeight()},width:function(e,t){return this.kravur._get(e).stringWidth(t)},widthOfCharacters:function(e,t,a,i){return this.kravur._get(e).charactersWidth(t,a,i)},baseline:function(e){return this.kravur._get(e).getBaselinePosition()},getImage:function(e,t,a){var i=null==a?e:1e4*e+a.length;if(!this.images.h.hasOwnProperty(i)){var s=this.images,r=new Z;s.h[i]=r}if(!this.images.h[i].h.hasOwnProperty(t)){var n=this.kravur._get(e,a),l=window.document.createElement("canvas");l.width=n.width,l.height=n.height;var o=l.getContext("2d");o.fillStyle="black",o.fillRect(0,0,n.width,n.height);for(var h=o.getImageData(0,0,n.width,n.height),c=tt.__cast(n.getTexture(),ct).bytes,d=0,u=c.length;d<u;){var g=d++;h.data[4*g]=(16711680&t)>>>16,h.data[4*g+1]=(65280&t)>>>8,h.data[4*g+2]=255&t,h.data[4*g+3]=c.b[g]}o.putImageData(h,0,0);var f=window.document.createElement("img");return f.src=l.toDataURL("image/png"),this.images.h[i].h[t]=f,f}return this.images.h[i].h[t]},unload:function(){this.kravur=null,this.images=null},__class__:ni};var li=function(){};a["kha.js.MobileWebAudio"]=li,li.__name__=!0,li._init=function(){try{return void(li._context=new AudioContext)}catch(e){}try{return void(this._context=new webkitAudioContext)}catch(e){}},li.play=function(e,t){null==t&&(t=!1);var a=new oi(e,t);return a.play(),a},li.stream=function(e,t){return null==t&&(t=!1),li.play(e,t)};var oi=function(e,t){this.stopped=!1,this.paused=!1,this.buffer=e._buffer,this.loop=t,this.createSource()};a["kha.js.MobileWebAudioChannel"]=oi,oi.__name__=!0,oi.__interfaces__=[Gt],oi.prototype={createSource:function(){var e=this;this.source=li._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){e.stopped=!0},this.gain=li._context.createGain(),this.source.connect(this.gain),this.gain.connect(li._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=li._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=li._context.currentTime,this.source.start())},__class__:oi};var hi=function(e,t){var a=this;Mt.call(this);var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onerror=function(){S.trace("Error loading "+e,{fileName:"MobileWebAudioSound.hx",lineNumber:25,className:"kha.js.MobileWebAudioSound",methodName:"new"})},i.onload=function(){a.compressedData=x.ofData(i.response),a.uncompressedData=null,li._context.decodeAudioData(a.compressedData.b.bufferValue,function(e){a._buffer=e,t(a)},function(){throw new et("Audio format not supported")})},i.send(null)};a["kha.js.MobileWebAudioSound"]=hi,hi.__name__=!0,hi.__super__=Mt,hi.prototype=s(Mt.prototype,{uncompress:function(e){e()},__class__:hi});var ci=function(e,t){Mt.call(this),this.done=t,ci.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var a=0;a<e.length;){var i=e[a];++a,""!=this.element.canPlayType("audio/ogg")&&p.endsWith(i,".ogg")&&this.filenames.push(i),""!=this.element.canPlayType("audio/mp4")&&p.endsWith(i,".mp4")&&this.filenames.push(i)}this.element.addEventListener("error",Ci(this,this.errorListener),!1),this.element.addEventListener("canplay",Ci(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};a["kha.js.Sound"]=ci,ci.__name__=!0,ci.__super__=Mt,ci.prototype=s(Mt.prototype,{errorListener:function(e){if(4==this.element.error.code)for(var t=0,a=this.filenames.length-1;t<a;){var i=t++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}S.trace("Error loading "+this.element.src,{fileName:"Sound.hx",lineNumber:108,className:"kha.js.Sound",methodName:"errorListener"}),window.console.log("loadSound failed"),this.finishAsset()},canPlayThroughListener:function(e){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Ci(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Ci(this,this.canPlayThroughListener),!1),this.done(this),n.remove(ci.loading,this)},uncompress:function(e){e()},__class__:ci});var di=function(e,t){var a=this;Mt.call(this);var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onerror=function(){S.trace("Error loading "+e,{fileName:"WebAudioSound.hx",lineNumber:76,className:"kha.js.WebAudioSound",methodName:"new"})},i.onload=function(){a.compressedData=x.ofData(i.response),a.uncompressedData=null,t(a)},i.send(null)};a["kha.js.WebAudioSound"]=di,di.__name__=!0,di.__super__=Mt,di.prototype=s(Mt.prototype,{superUncompress:function(e){Mt.prototype.uncompress.call(this,e)},uncompress:function(e){var t=this;kt._context.decodeAudioData(this.compressedData.b.bufferValue,function(a){var i=2*a.getChannelData(0).length,s=new Array(i);if(t.uncompressedData=s,1==a.numberOfChannels)for(var r=0,n=a.getChannelData(0).length;r<n;){var l=r++;t.uncompressedData[2*l]=a.getChannelData(0)[l],t.uncompressedData[2*l+1]=a.getChannelData(0)[l]}else for(var o=0,h=a.getChannelData(0).length;o<h;){var c=o++;t.uncompressedData[2*c]=a.getChannelData(0)[c],t.uncompressedData[2*c+1]=a.getChannelData(1)[c]}t.compressedData=null,e()},function(){t.superUncompress(e)})},__class__:di});var ui=function(e,t){this.value=e,this.type=t};a["kha.js.graphics4.ConstantLocation"]=ui,ui.__name__=!0,ui.__interfaces__=[ba],ui.prototype={__class__:ui};var gi=function(e){var t=new Array(9);this.matrix3Cache=t;var a=new Array(16);this.matrixCache=a,this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.renderTarget=e,this.init(),Nt.gl2?this.instancedExtension=!0:(this.instancedExtension=Nt.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=Nt.gl.getExtension("EXT_blend_minmax"))};a["kha.js.graphics4.Graphics"]=gi,gi.__name__=!0,gi.__interfaces__=[ya],gi.getBlendFunc=function(e){switch(e[1]){case 0:case 2:return 0;case 1:return 1;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},gi.getBlendOp=function(e){switch(e[1]){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},gi.prototype={init:function(){if(null!=this.renderTarget)if(this.isCubeMap=tt.__instanceof(this.renderTarget,Ca),this.isCubeMap){var e=tt.__cast(this.renderTarget,Ca);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture,this.isDepthAttachment=e.isDepthAttachment}else{var t=tt.__cast(this.renderTarget,St);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture}},begin:function(e){if(Nt.gl.enable(3042),Nt.gl.blendFunc(770,771),null==this.renderTarget)Nt.gl.bindFramebuffer(36160,null),Nt.gl.viewport(0,0,Bt.windowWidth(),Bt.windowHeight());else if(Nt.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),Nt.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=e){Nt.gl.framebufferTexture2D(36160,Nt.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var t=0,a=e.length;t<a;){var i=t++;Nt.gl.framebufferTexture2D(36160,Nt.drawBuffers.COLOR_ATTACHMENT0_WEBGL+i+1,3553,tt.__cast(e[i],St).texture,0)}for(var s=[Nt.drawBuffers.COLOR_ATTACHMENT0_WEBGL],r=0,n=e.length;r<n;){var l=r++;s.push(Nt.drawBuffers.COLOR_ATTACHMENT0_WEBGL+l+1)}Nt.gl2?Nt.gl.drawBuffers(s):Nt.drawBuffers.drawBuffersWEBGL(s)}},beginFace:function(e){Nt.gl.enable(3042),Nt.gl.blendFunc(770,771),Nt.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),Nt.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+e,this.renderTargetTexture,0),Nt.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},end:function(){},clear:function(e,t,a){var i=0;null!=e&&(i|=16384,Nt.gl.colorMask(!0,!0,!0,!0),Nt.gl.clearColor(.00392156862745098*((16711680&e)>>>16),.00392156862745098*((65280&e)>>>8),.00392156862745098*(255&e),.00392156862745098*(e>>>24))),null!=t&&(i|=256,Nt.gl.enable(2929),Nt.gl.depthMask(!0),Nt.gl.clearDepth(t)),null!=a&&(i|=1024,Nt.gl.enable(2960),Nt.gl.stencilMask(255),Nt.gl.clearStencil(a)),Nt.gl.clear(i),Nt.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?Nt.gl.enable(2929):Nt.gl.disable(2929),Nt.gl.depthMask(this.depthMask)},viewport:function(e,t,a,i){var s=null==this.renderTarget?Bt.windowHeight(0):this.renderTarget.get_height();Nt.gl.viewport(e,s-t-i,a,i)},setDepthMode:function(e,t){switch(t[1]){case 0:e?Nt.gl.enable(2929):Nt.gl.disable(2929),this.depthTest=e,Nt.gl.depthFunc(519);break;case 1:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(512);break;case 2:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(514);break;case 3:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(517);break;case 4:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(513);break;case 5:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(515);break;case 6:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(516);break;case 7:Nt.gl.enable(2929),this.depthTest=!0,Nt.gl.depthFunc(518)}Nt.gl.depthMask(e),this.depthMask=e},setBlendingMode:function(e,t,a,i,s,r){e==_a.BlendOne&&t==_a.BlendZero?Nt.gl.disable(3042):(Nt.gl.enable(3042),Nt.gl.blendFuncSeparate(gi.getBlendFunc(e),gi.getBlendFunc(t),gi.getBlendFunc(i),gi.getBlendFunc(s)),Nt.gl.blendEquationSeparate(gi.getBlendOp(a),gi.getBlendOp(r)))},setVertexBuffer:function(e){tt.__cast(e,La).set(0)},setVertexBuffers:function(e){for(var t=0,a=0;a<e.length;){var i=e[a];++a,t+=tt.__cast(i,La).set(t)}},setIndexBuffer:function(e){this.indicesCount=e.count(),tt.__cast(e,Da).set()},setTexture:function(e,t){null==t?(Nt.gl.activeTexture(33984+tt.__cast(e,pi).value),Nt.gl.bindTexture(3553,null)):tt.__cast(t,St).set(tt.__cast(e,pi).value)},setTextureDepth:function(e,t){tt.__cast(t,St).setDepth(tt.__cast(e,pi).value)},setTextureParameters:function(e,t,a,i,s,r){switch(Nt.gl.activeTexture(33984+tt.__cast(e,pi).value),t[1]){case 0:Nt.gl.texParameteri(3553,10242,10497);break;case 1:Nt.gl.texParameteri(3553,10242,33648);break;case 2:Nt.gl.texParameteri(3553,10242,33071)}switch(a[1]){case 0:Nt.gl.texParameteri(3553,10243,10497);break;case 1:Nt.gl.texParameteri(3553,10243,33648);break;case 2:Nt.gl.texParameteri(3553,10243,33071)}switch(i[1]){case 0:switch(r[1]){case 0:Nt.gl.texParameteri(3553,10241,9728);break;case 1:Nt.gl.texParameteri(3553,10241,9984);break;case 2:Nt.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(r[1]){case 0:Nt.gl.texParameteri(3553,10241,9729);break;case 1:Nt.gl.texParameteri(3553,10241,9985);break;case 2:Nt.gl.texParameteri(3553,10241,9987)}i==Fa.AnisotropicFilter&&Nt.gl.texParameteri(3553,Nt.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(s[1]){case 0:Nt.gl.texParameteri(3553,10240,9728);break;case 1:case 2:Nt.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(e,t,a,i,s,r,n){},setCubeMap:function(e,t){null==t?(Nt.gl.activeTexture(33984+tt.__cast(e,pi).value),Nt.gl.bindTexture(34067,null)):t.set(tt.__cast(e,pi).value)},setCubeMapDepth:function(e,t){t.setDepth(tt.__cast(e,pi).value)},setCullMode:function(e){switch(e[1]){case 0:Nt.gl.enable(2884),Nt.gl.cullFace(1029);break;case 1:Nt.gl.enable(2884),Nt.gl.cullFace(1028);break;case 2:Nt.gl.disable(2884)}},setPipeline:function(e){this.setCullMode(e.cullMode),this.setDepthMode(e.depthWrite,e.depthMode),this.setStencilParameters(e.stencilMode,e.stencilBothPass,e.stencilDepthFail,e.stencilFail,e.stencilReferenceValue,e.stencilReadMask,e.stencilWriteMask),this.setBlendingMode(e.blendSource,e.blendDestination,e.blendOperation,e.alphaBlendSource,e.alphaBlendDestination,e.alphaBlendOperation),e.set(),this.colorMaskRed=e.colorWriteMaskRed,this.colorMaskGreen=e.colorWriteMaskGreen,this.colorMaskBlue=e.colorWriteMaskBlue,this.colorMaskAlpha=e.colorWriteMaskAlpha},setBool:function(e,t){Nt.gl.uniform1i(tt.__cast(e,ui).value,t?1:0)},setInt:function(e,t){Nt.gl.uniform1i(tt.__cast(e,ui).value,t)},setFloat:function(e,t){Nt.gl.uniform1f(tt.__cast(e,ui).value,t)},setFloat2:function(e,t,a){Nt.gl.uniform2f(tt.__cast(e,ui).value,t,a)},setFloat3:function(e,t,a,i){Nt.gl.uniform3f(tt.__cast(e,ui).value,t,a,i)},setFloat4:function(e,t,a,i,s){Nt.gl.uniform4f(tt.__cast(e,ui).value,t,a,i,s)},setFloats:function(e,t){var a=tt.__cast(e,ui);switch(a.type){case 35664:Nt.gl.uniform2fv(a.value,t);break;case 35665:Nt.gl.uniform3fv(a.value,t);break;case 35666:Nt.gl.uniform4fv(a.value,t);break;default:Nt.gl.uniform1fv(a.value,t)}},setMatrix:function(e,t){this.matrixCache[0]=t._00,this.matrixCache[1]=t._01,this.matrixCache[2]=t._02,this.matrixCache[3]=t._03,this.matrixCache[4]=t._10,this.matrixCache[5]=t._11,this.matrixCache[6]=t._12,this.matrixCache[7]=t._13,this.matrixCache[8]=t._20,this.matrixCache[9]=t._21,this.matrixCache[10]=t._22,this.matrixCache[11]=t._23,this.matrixCache[12]=t._30,this.matrixCache[13]=t._31,this.matrixCache[14]=t._32,this.matrixCache[15]=t._33,Nt.gl.uniformMatrix4fv(tt.__cast(e,ui).value,!1,this.matrixCache)},setMatrix3:function(e,t){this.matrix3Cache[0]=t._00,this.matrix3Cache[1]=t._01,this.matrix3Cache[2]=t._02,this.matrix3Cache[3]=t._10,this.matrix3Cache[4]=t._11,this.matrix3Cache[5]=t._12,this.matrix3Cache[6]=t._20,this.matrix3Cache[7]=t._21,this.matrix3Cache[8]=t._22,Nt.gl.uniformMatrix3fv(tt.__cast(e,ui).value,!1,this.matrix3Cache)},drawIndexedVertices:function(e,t){null==t&&(t=-1),null==e&&(e=0);var a=null==Nt.elementIndexUint?5123:5125,i=5123==a?2:4;Nt.gl.drawElements(4,-1==t?this.indicesCount:t,a,e*i)},convertStencilAction:function(e){switch(e[1]){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},setStencilParameters:function(e,t,a,i,s,r,n){if(null==n&&(n=255),null==r&&(r=255),e==wa.Always&&t==Wa.Keep&&a==Wa.Keep&&i==Wa.Keep)Nt.gl.disable(2960);else{Nt.gl.enable(2960);var l=0;switch(e[1]){case 0:l=519;break;case 1:l=512;break;case 2:l=514;break;case 3:l=517;break;case 4:l=513;break;case 5:l=515;break;case 6:l=516;break;case 7:l=518}Nt.gl.stencilMask(n),Nt.gl.stencilOp(this.convertStencilAction(i),this.convertStencilAction(a),this.convertStencilAction(t)),Nt.gl.stencilFunc(l,s,r)}},scissor:function(e,t,a,i){Nt.gl.enable(3089),null==this.renderTarget?Nt.gl.scissor(e,Bt.windowHeight(0)-t-i,a,i):Nt.gl.scissor(e,t,a,i)},disableScissor:function(){Nt.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},drawIndexedVerticesInstanced:function(e,t,a){if(null==a&&(a=-1),null==t&&(t=0),this.instancedRenderingAvailable()){var i=null==Nt.elementIndexUint?5123:5125,s=null==Nt.elementIndexUint?2:4;Nt.gl2?Nt.gl.drawElementsInstanced(4,-1==a?this.indicesCount:a,i,t*s,e):this.instancedExtension.drawElementsInstancedANGLE(4,-1==a?this.indicesCount:a,i,t*s,e)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:gi};var fi=function(e){ka.call(this,e)};a["kha.js.graphics4.Graphics2"]=fi,fi.__name__=!0,fi.__super__=ka,fi.prototype=s(ka.prototype,{begin:function(e,t){null==e&&(e=!0),Nt.gl.colorMask(!0,!0,!0,!0),Nt.gl.disable(2929),Nt.gl.depthFunc(519),ka.prototype.begin.call(this,e,t)},__class__:fi});var pi=function(e){this.value=e};a["kha.js.graphics4.TextureUnit"]=pi,pi.__name__=!0,pi.__interfaces__=[Ha],pi.prototype={__class__:pi};var mi=function(){};a["kha.vr.VrInterface"]=mi,mi.__name__=!0,mi.prototype={IsVrEnabled:function(){return!1},__class__:mi};var vi=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,mi.call(this)};a["kha.js.vr.VrInterface"]=vi,vi.__name__=!0,vi.__super__=mi,vi.prototype=s(mi.prototype,{getVRDisplays:function(){var e=this;navigator.getVRDisplays().then(function(t){if(t.length>0){e.frameData=new VRFrameData,e.vrDisplay=t[0],e.vrDisplay.depthNear=.1,e.vrDisplay.depthFar=1024;var a=e.vrDisplay.getEyeParameters("left"),i=e.vrDisplay.getEyeParameters("right");e.width=Nt.khanvas.width,e.height=Nt.khanvas.height,e.vrWidth=2*Math.max(a.renderWidth,i.renderWidth)|0,e.vrHeight=0|Math.max(a.renderHeight,i.renderHeight)}else S.trace("There are no VR displays connected.",{fileName:"VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:vi});var _i=function(){};a["kha.network.ControllerBuilder"]=_i,_i.__name__=!0;var Ii=function(){this.controllers=new Z};a["kha.network.Session"]=Ii,Ii.__name__=!0,Ii.the=function(){return Ii.instance},Ii.prototype={sendControllerUpdate:function(e,t){if(this.controllers.h.hasOwnProperty(e)){if(this.controllers.h[e]._inputBuffer.length<this.controllers.h[e]._inputBufferIndex+4+t.length){var a=new x(new ki(this.controllers.h[e]._inputBufferIndex+4+t.length));a.blit(0,this.controllers.h[e]._inputBuffer,0,this.controllers.h[e]._inputBufferIndex),this.controllers.h[e]._inputBuffer=a}this.controllers.h[e]._inputBuffer.setInt32(this.controllers.h[e]._inputBufferIndex,t.length),this.controllers.h[e]._inputBuffer.blit(this.controllers.h[e]._inputBufferIndex+4,t,0,t.length),this.controllers.h[e]._inputBufferIndex+=4+t.length}},__class__:Ii};var wi,bi=0;function Ci(e,t){return null==t?null:(null==t.__id__&&(t.__id__=bi++),null==e.hx__closures__?e.hx__closures__={}:a=e.hx__closures__[t.__id__],null==a&&((a=function(){return a.method.apply(a.scope,arguments)}).scope=e,a.method=t,e.hx__closures__[t.__id__]=a),a);var a}a.Math=Math,String.prototype.__class__=a.String=String,String.__name__=!0,a.Array=Array,Array.__name__=!0,Date.prototype.__class__=a.Date=Date,Date.__name__=["Date"];var Ai=a.Int={__name__:["Int"]},Mi=a.Dynamic={__name__:["Dynamic"]},Bi=a.Float=Number;Bi.__name__=["Float"];var yi=a.Bool=Boolean;yi.__ename__=["Bool"];var Ni=a.Class={__name__:["Class"]},Si={},Gi={},ki=t.ArrayBuffer||it;null==ki.prototype.slice&&(ki.prototype.slice=it.sliceImpl);var Di=t.DataView||st,xi=t.Float32Array||rt._new,Zi=t.Uint8Array||nt._new;u.projectWindowMode=d.Window,u.projectWidth=960,u.projectHeight=540,C.dynamicScale=1,k.DEFAULT_RESOLVER=new G,k.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",z.count=0,X.i64tmp=new N(0,0),J.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],J.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],J.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],J.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee.traitInits=[],ee.traitUpdates=[],ee.traitLateUpdates=[],ee.traitRenders=[],ee.traitRenders2D=[],ee.pauseUpdates=!1,ee.lastw=-1,ee.lasth=-1,ie.helpVec=new ae,ie.helpMat=ie.identity(),le.framePassed=!0,he.cachedSceneRaws=new T,he.cachedMeshes=new T,he.cachedLamps=new T,he.cachedCameras=new T,he.cachedMaterials=new T,he.cachedParticles=new T,he.cachedWorlds=new T,he.cachedShaders=new T,he.cachedBlobs=new T,he.cachedImages=new T,he.cachedSounds=new T,he.loadingMeshes=new T,he.loadingLamps=new T,he.loadingCameras=new T,he.loadingMaterials=new T,he.loadingParticles=new T,he.loadingWorlds=new T,he.loadingShaders=new T,he.loadingSceneRaws=new T,he.assetsLoaded=0,he.loadingBlobs=new T,he.loadingImages=new T,he.loadingSounds=new T,ge.uidCounter=0,fe.num=0,Be.helpVec0=new ae,Be.helpVec1=new ae,Be.helpVec2=new ae,ye.m1=ie.identity(),ye.m2=ie.identity(),ye.vpos=new ae,ye.vpos2=new ae,ye.vscl=new ae,ye.vscl2=new ae,ye.q1=new Be,ye.q2=new Be,Ne.skinMaxBones=50,Ne.vpos=new ae,Ne.vscl=new ae,Ne.q1=new Be,Ne.q2=new Be,Ne.vpos2=new ae,Ne.vscl2=new ae,Se.uidCounter=0,Se.seed=1,Ge.temp=new ae,Ge.sphereCenter=new ae,Ze.m=ie.identity(),Ze.p1=new ae,Ze.p2=new ae,Ze.p3=new ae,Ye.temp=ie.identity(),Re.biasMat=new ie(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Re.helpMat=ie.identity(),Re.helpMat2=ie.identity(),Re.helpMat3=Me.identity(),Re.helpVec=new ae,Re.helpVec2=new ae,Re.helpQuat=new Be,je.gamepads=[],Ue.buttons=["left","right","middle"],qe.scale=1,qe.last=0,qe.realDelta=0,$e.eases=[$e.easeLinear,$e.easeSineIn,$e.easeSineOut,$e.easeSineInOut,$e.easeQuadIn,$e.easeQuadOut,$e.easeQuadInOut,$e.easeCubicIn,$e.easeCubicOut,$e.easeCubicInOut,$e.easeQuartIn,$e.easeQuartOut,$e.easeQuartInOut,$e.easeQuintIn,$e.easeQuintOut,$e.easeQuintInOut,$e.easeExpoIn,$e.easeExpoOut,$e.easeExpoInOut,$e.easeCircIn,$e.easeCircOut,$e.easeCircInOut,$e.easeBackIn,$e.easeBackOut,$e.easeBackInOut],$e.anims=[],tt.__toStr={}.toString,rt.BYTES_PER_ELEMENT=4,nt.BYTES_PER_ELEMENT=1,ut.canvas_id="khanvas",bt.DIF_COUNT=3,bt.maxframetime=.5,bt.startTime=0,At.Material_mesh_fragData0="s12344:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gaW50IGxpZ2h0VHlwZTsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0RGlyOwp1bmlmb3JtIGJvb2wgcmVjZWl2ZVNoYWRvdzsKdW5pZm9ybSBpbnQgbGlnaHRTaGFkb3c7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcDsKdW5pZm9ybSBoaWdocCBmbG9hdCBzaGFkb3dzQmlhczsKdW5pZm9ybSBoaWdocCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlOwp1bmlmb3JtIGhpZ2hwIHZlYzIgbGlnaHRQcm9qOwp1bmlmb3JtIGhpZ2hwIHZlYzIgc3BvdGxpZ2h0RGF0YTsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gaGlnaHAgZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIGhpZ2hwIHZlYzMgd25vcm1hbDsKdmFyeWluZyBoaWdocCB2ZWMzIGV5ZURpcjsKdmFyeWluZyBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKdmFyeWluZyBoaWdocCB2ZWM0IGxhbXBQb3M7CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIGZsb2F0IHNoYWRvd0NvbXBhcmUoaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCBoaWdocCB2ZWMyIHV2LCBoaWdocCBmbG9hdCBjb21wYXJlKQp7CiAgICBoaWdocCBmbG9hdCBkZXB0aCA9IHRleHR1cmUyRChzaGFkb3dNYXBfMSwgdXYpLng7CiAgICByZXR1cm4gc3RlcChjb21wYXJlLCBkZXB0aCk7Cn0KCmhpZ2hwIGZsb2F0IHNoYWRvd0xlcnAoaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCBoaWdocCB2ZWMyIHV2LCBoaWdocCBmbG9hdCBjb21wYXJlLCBoaWdocCB2ZWMyIHNtU2l6ZSkKewogICAgaGlnaHAgdmVjMiB0ZXhlbFNpemUgPSB2ZWMyKDEuMCkgLyBzbVNpemU7CiAgICBoaWdocCB2ZWMyIGYgPSBmcmFjdCgodXYgKiBzbVNpemUpICsgdmVjMigwLjUpKTsKICAgIGhpZ2hwIHZlYzIgY2VudHJvaWRVViA9IGZsb29yKCh1diAqIHNtU2l6ZSkgKyB2ZWMyKDAuNSkpIC8gc21TaXplOwogICAgaGlnaHAgZmxvYXQgbGIgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWLCBjb21wYXJlKTsKICAgIGhpZ2hwIGZsb2F0IGx0ID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViArICh0ZXhlbFNpemUgKiB2ZWMyKDAuMCwgMS4wKSksIGNvbXBhcmUpOwogICAgaGlnaHAgZmxvYXQgcmIgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWICsgKHRleGVsU2l6ZSAqIHZlYzIoMS4wLCAwLjApKSwgY29tcGFyZSk7CiAgICBoaWdocCBmbG9hdCBydCA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYgKyB0ZXhlbFNpemUsIGNvbXBhcmUpOwogICAgaGlnaHAgZmxvYXQgYSA9IG1peChsYiwgbHQsIGYueSk7CiAgICBoaWdocCBmbG9hdCBiID0gbWl4KHJiLCBydCwgZi55KTsKICAgIGhpZ2hwIGZsb2F0IGMgPSBtaXgoYSwgYiwgZi54KTsKICAgIHJldHVybiBjOwp9CgpoaWdocCBmbG9hdCBQQ0YoaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCBoaWdocCB2ZWMyIHV2LCBoaWdocCBmbG9hdCBjb21wYXJlLCBoaWdocCB2ZWMyIHNtU2l6ZSkKewogICAgaGlnaHAgZmxvYXQgcmVzdWx0ID0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wLCAwLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKC0xLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMC4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYsIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigwLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigxLjAsIDAuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXR1cm4gcmVzdWx0IC8gOS4wOwp9CgpoaWdocCBmbG9hdCBscFRvRGVwdGgoaW5vdXQgaGlnaHAgdmVjMyBscCwgaGlnaHAgdmVjMiBsaWdodFByb2pfMSkKewogICAgbHAgPSBhYnMobHApOwogICAgaGlnaHAgZmxvYXQgemNvbXAgPSBtYXgobHAueCwgbWF4KGxwLnksIGxwLnopKTsKICAgIHpjb21wID0gbGlnaHRQcm9qXzEueCAtIChsaWdodFByb2pfMS55IC8gemNvbXApOwogICAgcmV0dXJuICh6Y29tcCAqIDAuNSkgKyAwLjU7Cn0KCmhpZ2hwIGZsb2F0IFBDRkN1YmUoaGlnaHAgc2FtcGxlckN1YmUgc2hhZG93TWFwQ3ViZV8xLCBoaWdocCB2ZWMzIGxwLCBpbm91dCBoaWdocCB2ZWMzIG1sLCBoaWdocCBmbG9hdCBiaWFzLCBoaWdocCB2ZWMyIGxpZ2h0UHJval8xLCBoaWdocCB2ZWMzIG4pCnsKICAgIGhpZ2hwIHZlYzMgcGFyYW0gPSBscCAtIChuICogMC4wMDMwMDAwMDAwMjYwNzcwMzIwODkyMzMzOTg0Mzc1KTsKICAgIGhpZ2hwIGZsb2F0IF80ODIgPSBscFRvRGVwdGgocGFyYW0sIGxpZ2h0UHJval8xKTsKICAgIGhpZ2hwIGZsb2F0IGNvbXBhcmUgPSBfNDgyIC0gKGJpYXMgKiAwLjQwMDAwMDAwNTk2MDQ2NDQ3NzUzOTA2MjUpOwogICAgbWwgKz0gKG4gKiAwLjAwMzAwMDAwMDAyNjA3NzAzMjA4OTIzMzM5ODQzNzUpOwogICAgaGlnaHAgZmxvYXQgcmVzdWx0ID0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCAvPSA5LjA7CiAgICByZXR1cm4gcmVzdWx0Owp9CgpoaWdocCB2ZWMzIHN1cmZhY2VBbGJlZG8oaGlnaHAgdmVjMyBiYXNlQ29sb3IsIGhpZ2hwIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peChiYXNlQ29sb3IsIHZlYzMoMC4wKSwgdmVjMyhtZXRhbG5lc3MpKTsKfQoKaGlnaHAgdmVjMyBzdXJmYWNlRjAoaGlnaHAgdmVjMyBiYXNlQ29sb3IsIGhpZ2hwIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peCh2ZWMzKDAuMDM5OTk5OTk5MTA1OTMwMzI4MzY5MTQwNjI1KSwgYmFzZUNvbG9yLCB2ZWMzKG1ldGFsbmVzcykpOwp9CgpoaWdocCB2ZWMzIGxhbWJlcnREaWZmdXNlQlJERihoaWdocCB2ZWMzIGFsYmVkbywgaGlnaHAgZmxvYXQgbmwpCnsKICAgIHJldHVybiBhbGJlZG8gKiBtYXgoMC4wLCBubCk7Cn0KCmhpZ2hwIGZsb2F0IGRfZ2d4KGhpZ2hwIGZsb2F0IG5oLCBoaWdocCBmbG9hdCBhKQp7CiAgICBoaWdocCBmbG9hdCBhMiA9IGEgKiBhOwogICAgaGlnaHAgZmxvYXQgZGVub20gPSBwb3coKChuaCAqIG5oKSAqIChhMiAtIDEuMCkpICsgMS4wLCAyLjApOwogICAgcmV0dXJuIChhMiAqIDAuMzE4MzA5ODczMzQyNTE0MDM4MDg1OTM3NSkgLyBkZW5vbTsKfQoKaGlnaHAgZmxvYXQgdl9zbWl0aHNjaGxpY2soaGlnaHAgZmxvYXQgbmwsIGhpZ2hwIGZsb2F0IG52LCBoaWdocCBmbG9hdCBhKQp7CiAgICByZXR1cm4gMS4wIC8gKCgobmwgKiAoMS4wIC0gYSkpICsgYSkgKiAoKG52ICogKDEuMCAtIGEpKSArIGEpKTsKfQoKaGlnaHAgdmVjMyBmX3NjaGxpY2soaGlnaHAgdmVjMyBmMCwgaGlnaHAgZmxvYXQgdmgpCnsKICAgIHJldHVybiBmMCArICgodmVjMygxLjApIC0gZjApICogZXhwMigoKC01LjU1NDcyOTkzODUwNzA4MDA3ODEyNSAqIHZoKSAtIDYuOTgzMTYwMDE4OTIwODk4NDM3NSkgKiB2aCkpOwp9CgpoaWdocCB2ZWMzIHNwZWN1bGFyQlJERihoaWdocCB2ZWMzIGYwLCBoaWdocCBmbG9hdCByb3VnaG5lc3MsIGhpZ2hwIGZsb2F0IG5sLCBoaWdocCBmbG9hdCBuaCwgaGlnaHAgZmxvYXQgbnYsIGhpZ2hwIGZsb2F0IHZoKQp7CiAgICBoaWdocCBmbG9hdCBhID0gcm91Z2huZXNzICogcm91Z2huZXNzOwogICAgcmV0dXJuIChmX3NjaGxpY2soZjAsIHZoKSAqIChkX2dneChuaCwgYSkgKiBjbGFtcCh2X3NtaXRoc2NobGljayhubCwgbnYsIGEpLCAwLjAsIDEuMCkpKSAvIHZlYzMoNC4wKTsKfQoKaGlnaHAgdmVjMyBzaElycmFkaWFuY2UoaGlnaHAgdmVjMyBub3IpCnsKICAgIGhpZ2hwIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICBoaWdocCB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIGhpZ2hwIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgaGlnaHAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICBoaWdocCB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIGhpZ2hwIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgaGlnaHAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoLW5vci56ICogLW5vci56KSkpICsgKCgoY2wyMCAqIDAuNzQzMTI1MDIxNDU3NjcyMTE5MTQwNjI1KSAqIG5vci54KSAqIG5vci54KSkgKyAoY2wwMCAqIDAuODg2MjI3MDExNjgwNjAzMDI3MzQzNzUpKSAtIChjbDIwICogMC4yNDc3MDc5OTI3OTIxMjk1MTY2MDE1NjI1KSkgKyAoKChjbDJtMiAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogLW5vci56KSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIC1ub3IueikgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogLW5vci56KSkgKyAoKGNsMTAgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci54KTsKfQoKaGlnaHAgdmVjMyB0b25lbWFwRmlsbWljKGhpZ2hwIHZlYzMgY29sb3IpCnsKICAgIGhpZ2hwIHZlYzMgeCA9IG1heCh2ZWMzKDAuMCksIGNvbG9yIC0gdmVjMygwLjAwNDAwMDAwMDE4OTk4OTgwNTIyMTU1NzYxNzE4NzUpKTsKICAgIHJldHVybiAoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygwLjUpKSkgLyAoKHggKiAoKHggKiA2LjE5OTk5OTgwOTI2NTEzNjcxODc1KSArIHZlYzMoMS43MDAwMDAwNDc2ODM3MTU4MjAzMTI1KSkpICsgdmVjMygwLjA1OTk5OTk5ODY1ODg5NTQ5MjU1MzcxMDkzNzUpKTsKfQoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgaGlnaHAgdmVjMyB2VmVjID0gbm9ybWFsaXplKGV5ZURpcik7CiAgICBoaWdocCBmbG9hdCBkb3ROViA9IG1heChkb3QobiwgdlZlYyksIDAuMCk7CiAgICBoaWdocCB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDExOTIwOTI4OTU1MDc4MTI1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIHZlYzMgbHAgPSBsaWdodFBvcyAtIHdwb3NpdGlvbjsKICAgIGhpZ2hwIHZlYzMgbDsKICAgIGhpZ2hwIGZsb2F0IGRvdE5MOwogICAgaGlnaHAgZmxvYXQgZG90Tkg7CiAgICBoaWdocCBmbG9hdCBkb3RWSDsKICAgIGlmIChsaWdodFR5cGUgPT0gMCkKICAgIHsKICAgICAgICBsID0gbGlnaHREaXI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbCA9IG5vcm1hbGl6ZShscCk7CiAgICAgICAgdmlzaWJpbGl0eSAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgfQogICAgaGlnaHAgdmVjMyBoID0gbm9ybWFsaXplKHZWZWMgKyBsKTsKICAgIGRvdE5MID0gZG90KG4sIGwpOwogICAgZG90TkggPSBkb3QobiwgaCk7CiAgICBkb3RWSCA9IGRvdCh2VmVjLCBoKTsKICAgIGlmIChyZWNlaXZlU2hhZG93KQogICAgewogICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAxKQogICAgICAgIHsKICAgICAgICAgICAgaGlnaHAgdmVjMyBsUG9zID0gbGFtcFBvcy54eXogLyB2ZWMzKGxhbXBQb3Mudyk7CiAgICAgICAgICAgIHZpc2liaWxpdHkgKj0gUENGKHNoYWRvd01hcCwgbFBvcy54eSwgbFBvcy56IC0gc2hhZG93c0JpYXMsIHZlYzIoMTAyNC4wKSk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoaWdocCB2ZWMzIHBhcmFtID0gLWw7CiAgICAgICAgICAgICAgICBoaWdocCBmbG9hdCBfNzIwID0gUENGQ3ViZShzaGFkb3dNYXBDdWJlLCBscCwgcGFyYW0sIHNoYWRvd3NCaWFzLCBsaWdodFByb2osIG4pOwogICAgICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBfNzIwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgaWYgKGxpZ2h0VHlwZSA9PSAyKQogICAgewogICAgICAgIGhpZ2hwIGZsb2F0IHNwb3RFZmZlY3QgPSBkb3QobGlnaHREaXIsIGwpOwogICAgICAgIGlmIChzcG90RWZmZWN0IDwgc3BvdGxpZ2h0RGF0YS54KQogICAgICAgIHsKICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBzbW9vdGhzdGVwKHNwb3RsaWdodERhdGEueSwgc3BvdGxpZ2h0RGF0YS54LCBzcG90RWZmZWN0KTsKICAgICAgICB9CiAgICB9CiAgICBoaWdocCB2ZWMzIGFsYmVkbyA9IHN1cmZhY2VBbGJlZG8oYmFzZWNvbCwgbWV0YWxsaWMpOwogICAgaGlnaHAgdmVjMyBmMCA9IHN1cmZhY2VGMChiYXNlY29sLCBtZXRhbGxpYyk7CiAgICBoaWdocCB2ZWMzIGRpcmVjdCA9IGxhbWJlcnREaWZmdXNlQlJERihhbGJlZG8sIGRvdE5MKTsKICAgIGRpcmVjdCArPSBzcGVjdWxhckJSREYoZjAsIHJvdWdobmVzcywgZG90TkwsIGRvdE5ILCBkb3ROViwgZG90VkgpOwogICAgaGlnaHAgdmVjMyBpbmRpcmVjdCA9IHNoSXJyYWRpYW5jZShuKTsKICAgIGluZGlyZWN0ICo9IGFsYmVkbzsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoKGRpcmVjdCAqIGxpZ2h0Q29sb3IpICogdmlzaWJpbGl0eSkgKyAoKGluZGlyZWN0ICogb2NjbHVzaW9uKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKICAgIGhpZ2hwIHZlYzMgXzc5NCA9IHRvbmVtYXBGaWxtaWMoZ2xfRnJhZ0RhdGFbMF0ueHl6KTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChfNzk0LngsIF83OTQueSwgXzc5NC56LCBnbF9GcmFnRGF0YVswXS53KTsKfQoK",At.Material_mesh_fragData1="s11427:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gdmVjMyBsaWdodFBvczsKdW5pZm9ybSBpbnQgbGlnaHRUeXBlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gYm9vbCByZWNlaXZlU2hhZG93Owp1bmlmb3JtIGludCBsaWdodFNoYWRvdzsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlOwp1bmlmb3JtIHZlYzIgbGlnaHRQcm9qOwp1bmlmb3JtIHZlYzIgc3BvdGxpZ2h0RGF0YTsKdW5pZm9ybSB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWMzIGV5ZURpcjsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKdmFyeWluZyB2ZWM0IGxhbXBQb3M7CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmZsb2F0IHNoYWRvd0NvbXBhcmUobWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwXzEsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUpCnsKICAgIGZsb2F0IGRlcHRoID0gdGV4dHVyZTJEKHNoYWRvd01hcF8xLCB1dikueDsKICAgIHJldHVybiBzdGVwKGNvbXBhcmUsIGRlcHRoKTsKfQoKZmxvYXQgc2hhZG93TGVycChtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXBfMSwgdmVjMiB1diwgZmxvYXQgY29tcGFyZSwgdmVjMiBzbVNpemUpCnsKICAgIHZlYzIgdGV4ZWxTaXplID0gdmVjMigxLjApIC8gc21TaXplOwogICAgdmVjMiBmID0gZnJhY3QoKHV2ICogc21TaXplKSArIHZlYzIoMC41KSk7CiAgICB2ZWMyIGNlbnRyb2lkVVYgPSBmbG9vcigodXYgKiBzbVNpemUpICsgdmVjMigwLjUpKSAvIHNtU2l6ZTsKICAgIGZsb2F0IGxiID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViwgY29tcGFyZSk7CiAgICBmbG9hdCBsdCA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYgKyAodGV4ZWxTaXplICogdmVjMigwLjAsIDEuMCkpLCBjb21wYXJlKTsKICAgIGZsb2F0IHJiID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViArICh0ZXhlbFNpemUgKiB2ZWMyKDEuMCwgMC4wKSksIGNvbXBhcmUpOwogICAgZmxvYXQgcnQgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWICsgdGV4ZWxTaXplLCBjb21wYXJlKTsKICAgIGZsb2F0IGEgPSBtaXgobGIsIGx0LCBmLnkpOwogICAgZmxvYXQgYiA9IG1peChyYiwgcnQsIGYueSk7CiAgICBmbG9hdCBjID0gbWl4KGEsIGIsIGYueCk7CiAgICByZXR1cm4gYzsKfQoKZmxvYXQgUENGKG1lZGl1bXAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCB2ZWMyIHV2LCBmbG9hdCBjb21wYXJlLCB2ZWMyIHNtU2l6ZSkKewogICAgZmxvYXQgcmVzdWx0ID0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wLCAwLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKC0xLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMC4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYsIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigwLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigxLjAsIDAuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXR1cm4gcmVzdWx0IC8gOS4wOwp9CgpmbG9hdCBscFRvRGVwdGgoaW5vdXQgdmVjMyBscCwgdmVjMiBsaWdodFByb2pfMSkKewogICAgbHAgPSBhYnMobHApOwogICAgZmxvYXQgemNvbXAgPSBtYXgobHAueCwgbWF4KGxwLnksIGxwLnopKTsKICAgIHpjb21wID0gbGlnaHRQcm9qXzEueCAtIChsaWdodFByb2pfMS55IC8gemNvbXApOwogICAgcmV0dXJuICh6Y29tcCAqIDAuNSkgKyAwLjU7Cn0KCmZsb2F0IFBDRkN1YmUobWVkaXVtcCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlXzEsIHZlYzMgbHAsIGlub3V0IHZlYzMgbWwsIGZsb2F0IGJpYXMsIHZlYzIgbGlnaHRQcm9qXzEsIHZlYzMgbikKewogICAgdmVjMyBwYXJhbSA9IGxwIC0gKG4gKiAwLjAwMzAwMDAwMDAyNjA3NzAzMjA4OTIzMzM5ODQzNzUpOwogICAgZmxvYXQgXzQ4MiA9IGxwVG9EZXB0aChwYXJhbSwgbGlnaHRQcm9qXzEpOwogICAgZmxvYXQgY29tcGFyZSA9IF80ODIgLSAoYmlhcyAqIDAuNDAwMDAwMDA1OTYwNDY0NDc3NTM5MDYyNSk7CiAgICBtbCArPSAobiAqIDAuMDAzMDAwMDAwMDI2MDc3MDMyMDg5MjMzMzk4NDM3NSk7CiAgICBmbG9hdCByZXN1bHQgPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0IC89IDkuMDsKICAgIHJldHVybiByZXN1bHQ7Cn0KCnZlYzMgc3VyZmFjZUFsYmVkbyh2ZWMzIGJhc2VDb2xvciwgZmxvYXQgbWV0YWxuZXNzKQp7CiAgICByZXR1cm4gbWl4KGJhc2VDb2xvciwgdmVjMygwLjApLCB2ZWMzKG1ldGFsbmVzcykpOwp9Cgp2ZWMzIHN1cmZhY2VGMCh2ZWMzIGJhc2VDb2xvciwgZmxvYXQgbWV0YWxuZXNzKQp7CiAgICByZXR1cm4gbWl4KHZlYzMoMC4wMzk5OTk5OTkxMDU5MzAzMjgzNjkxNDA2MjUpLCBiYXNlQ29sb3IsIHZlYzMobWV0YWxuZXNzKSk7Cn0KCnZlYzMgbGFtYmVydERpZmZ1c2VCUkRGKHZlYzMgYWxiZWRvLCBmbG9hdCBubCkKewogICAgcmV0dXJuIGFsYmVkbyAqIG1heCgwLjAsIG5sKTsKfQoKZmxvYXQgZF9nZ3goZmxvYXQgbmgsIGZsb2F0IGEpCnsKICAgIGZsb2F0IGEyID0gYSAqIGE7CiAgICBmbG9hdCBkZW5vbSA9IHBvdygoKG5oICogbmgpICogKGEyIC0gMS4wKSkgKyAxLjAsIDIuMCk7CiAgICByZXR1cm4gKGEyICogMC4zMTgzMDk4NzMzNDI1MTQwMzgwODU5Mzc1KSAvIGRlbm9tOwp9CgpmbG9hdCB2X3NtaXRoc2NobGljayhmbG9hdCBubCwgZmxvYXQgbnYsIGZsb2F0IGEpCnsKICAgIHJldHVybiAxLjAgLyAoKChubCAqICgxLjAgLSBhKSkgKyBhKSAqICgobnYgKiAoMS4wIC0gYSkpICsgYSkpOwp9Cgp2ZWMzIGZfc2NobGljayh2ZWMzIGYwLCBmbG9hdCB2aCkKewogICAgcmV0dXJuIGYwICsgKCh2ZWMzKDEuMCkgLSBmMCkgKiBleHAyKCgoLTUuNTU0NzI5OTM4NTA3MDgwMDc4MTI1ICogdmgpIC0gNi45ODMxNjAwMTg5MjA4OTg0Mzc1KSAqIHZoKSk7Cn0KCnZlYzMgc3BlY3VsYXJCUkRGKHZlYzMgZjAsIGZsb2F0IHJvdWdobmVzcywgZmxvYXQgbmwsIGZsb2F0IG5oLCBmbG9hdCBudiwgZmxvYXQgdmgpCnsKICAgIGZsb2F0IGEgPSByb3VnaG5lc3MgKiByb3VnaG5lc3M7CiAgICByZXR1cm4gKGZfc2NobGljayhmMCwgdmgpICogKGRfZ2d4KG5oLCBhKSAqIGNsYW1wKHZfc21pdGhzY2hsaWNrKG5sLCBudiwgYSksIDAuMCwgMS4wKSkpIC8gdmVjMyg0LjApOwp9Cgp2ZWMzIHNoSXJyYWRpYW5jZSh2ZWMzIG5vcikKewogICAgdmVjMyBjbDAwID0gdmVjMyhzaGlyclswXS54LCBzaGlyclswXS55LCBzaGlyclswXS56KTsKICAgIHZlYzMgY2wxbTEgPSB2ZWMzKHNoaXJyWzBdLncsIHNoaXJyWzFdLngsIHNoaXJyWzFdLnkpOwogICAgdmVjMyBjbDEwID0gdmVjMyhzaGlyclsxXS56LCBzaGlyclsxXS53LCBzaGlyclsyXS54KTsKICAgIHZlYzMgY2wxMSA9IHZlYzMoc2hpcnJbMl0ueSwgc2hpcnJbMl0ueiwgc2hpcnJbMl0udyk7CiAgICB2ZWMzIGNsMm0yID0gdmVjMyhzaGlyclszXS54LCBzaGlyclszXS55LCBzaGlyclszXS56KTsKICAgIHZlYzMgY2wybTEgPSB2ZWMzKHNoaXJyWzNdLncsIHNoaXJyWzRdLngsIHNoaXJyWzRdLnkpOwogICAgdmVjMyBjbDIwID0gdmVjMyhzaGlycls0XS56LCBzaGlycls0XS53LCBzaGlycls1XS54KTsKICAgIHZlYzMgY2wyMSA9IHZlYzMoc2hpcnJbNV0ueSwgc2hpcnJbNV0ueiwgc2hpcnJbNV0udyk7CiAgICB2ZWMzIGNsMjIgPSB2ZWMzKHNoaXJyWzZdLngsIHNoaXJyWzZdLnksIHNoaXJyWzZdLnopOwogICAgcmV0dXJuICgoKCgoKCgoKChjbDIyICogMC40MjkwNDI5OTQ5NzYwNDM3MDExNzE4NzUpICogKChub3IueSAqIG5vci55KSAtICgtbm9yLnogKiAtbm9yLnopKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAtbm9yLnopKSArICgoKGNsMjEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqIG5vci54KSkgKyAoKChjbDJtMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogLW5vci56KSAqIG5vci54KSkgKyAoKGNsMTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci55KSkgKyAoKGNsMW0xICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiAtbm9yLnopKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2ZWMzIHRvbmVtYXBGaWxtaWModmVjMyBjb2xvcikKewogICAgdmVjMyB4ID0gbWF4KHZlYzMoMC4wKSwgY29sb3IgLSB2ZWMzKDAuMDA0MDAwMDAwMTg5OTg5ODA1MjIxNTU3NjE3MTg3NSkpOwogICAgcmV0dXJuICh4ICogKCh4ICogNi4xOTk5OTk4MDkyNjUxMzY3MTg3NSkgKyB2ZWMzKDAuNSkpKSAvICgoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygxLjcwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKSkgKyB2ZWMzKDAuMDU5OTk5OTk4NjU4ODk1NDkyNTUzNzEwOTM3NSkpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWMzIHZWZWMgPSBub3JtYWxpemUoZXllRGlyKTsKICAgIGZsb2F0IGRvdE5WID0gbWF4KGRvdChuLCB2VmVjKSwgMC4wKTsKICAgIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC44MDAwMDAwMTE5MjA5Mjg5NTUwNzgxMjUpOwogICAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgdmVjMyBscCA9IGxpZ2h0UG9zIC0gd3Bvc2l0aW9uOwogICAgdmVjMyBsOwogICAgZmxvYXQgZG90Tkw7CiAgICBmbG9hdCBkb3ROSDsKICAgIGZsb2F0IGRvdFZIOwogICAgaWYgKGxpZ2h0VHlwZSA9PSAwKQogICAgewogICAgICAgIGwgPSBsaWdodERpcjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBsID0gbm9ybWFsaXplKGxwKTsKICAgICAgICB2aXNpYmlsaXR5ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICB9CiAgICB2ZWMzIGggPSBub3JtYWxpemUodlZlYyArIGwpOwogICAgZG90TkwgPSBkb3QobiwgbCk7CiAgICBkb3ROSCA9IGRvdChuLCBoKTsKICAgIGRvdFZIID0gZG90KHZWZWMsIGgpOwogICAgaWYgKHJlY2VpdmVTaGFkb3cpCiAgICB7CiAgICAgICAgaWYgKGxpZ2h0U2hhZG93ID09IDEpCiAgICAgICAgewogICAgICAgICAgICB2ZWMzIGxQb3MgPSBsYW1wUG9zLnh5eiAvIHZlYzMobGFtcFBvcy53KTsKICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBQQ0Yoc2hhZG93TWFwLCBsUG9zLnh5LCBsUG9zLnogLSBzaGFkb3dzQmlhcywgdmVjMigxMDI0LjApKTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGxpZ2h0U2hhZG93ID09IDIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZlYzMgcGFyYW0gPSAtbDsKICAgICAgICAgICAgICAgIGZsb2F0IF83MjAgPSBQQ0ZDdWJlKHNoYWRvd01hcEN1YmUsIGxwLCBwYXJhbSwgc2hhZG93c0JpYXMsIGxpZ2h0UHJvaiwgbik7CiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ICo9IF83MjA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBpZiAobGlnaHRUeXBlID09IDIpCiAgICB7CiAgICAgICAgZmxvYXQgc3BvdEVmZmVjdCA9IGRvdChsaWdodERpciwgbCk7CiAgICAgICAgaWYgKHNwb3RFZmZlY3QgPCBzcG90bGlnaHREYXRhLngpCiAgICAgICAgewogICAgICAgICAgICB2aXNpYmlsaXR5ICo9IHNtb290aHN0ZXAoc3BvdGxpZ2h0RGF0YS55LCBzcG90bGlnaHREYXRhLngsIHNwb3RFZmZlY3QpOwogICAgICAgIH0KICAgIH0KICAgIHZlYzMgYWxiZWRvID0gc3VyZmFjZUFsYmVkbyhiYXNlY29sLCBtZXRhbGxpYyk7CiAgICB2ZWMzIGYwID0gc3VyZmFjZUYwKGJhc2Vjb2wsIG1ldGFsbGljKTsKICAgIHZlYzMgZGlyZWN0ID0gbGFtYmVydERpZmZ1c2VCUkRGKGFsYmVkbywgZG90TkwpOwogICAgZGlyZWN0ICs9IHNwZWN1bGFyQlJERihmMCwgcm91Z2huZXNzLCBkb3ROTCwgZG90TkgsIGRvdE5WLCBkb3RWSCk7CiAgICB2ZWMzIGluZGlyZWN0ID0gc2hJcnJhZGlhbmNlKG4pOwogICAgaW5kaXJlY3QgKj0gYWxiZWRvOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KCgoZGlyZWN0ICogbGlnaHRDb2xvcikgKiB2aXNpYmlsaXR5KSArICgoaW5kaXJlY3QgKiBvY2NsdXNpb24pICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwogICAgdmVjMyBfNzk0ID0gdG9uZW1hcEZpbG1pYyhnbF9GcmFnRGF0YVswXS54eXopOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KF83OTQueCwgXzc5NC55LCBfNzk0LnosIGdsX0ZyYWdEYXRhWzBdLncpOwp9Cgo",At.Material_mesh_fragData2="s11354:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gdmVjMyBsaWdodFBvczsKdW5pZm9ybSBpbnQgbGlnaHRUeXBlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gYm9vbCByZWNlaXZlU2hhZG93Owp1bmlmb3JtIGludCBsaWdodFNoYWRvdzsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlOwp1bmlmb3JtIHZlYzIgbGlnaHRQcm9qOwp1bmlmb3JtIHZlYzIgc3BvdGxpZ2h0RGF0YTsKdW5pZm9ybSB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7CgppbiB2ZWMzIHdub3JtYWw7CmluIHZlYzMgZXllRGlyOwppbiB2ZWMzIHdwb3NpdGlvbjsKaW4gdmVjNCBsYW1wUG9zOwpvdXQgdmVjNCBmcmFnQ29sb3I7CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmZsb2F0IHNoYWRvd0NvbXBhcmUobWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwXzEsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUpCnsKICAgIGZsb2F0IGRlcHRoID0gdGV4dHVyZShzaGFkb3dNYXBfMSwgdXYpLng7CiAgICByZXR1cm4gc3RlcChjb21wYXJlLCBkZXB0aCk7Cn0KCmZsb2F0IHNoYWRvd0xlcnAobWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwXzEsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUsIHZlYzIgc21TaXplKQp7CiAgICB2ZWMyIHRleGVsU2l6ZSA9IHZlYzIoMS4wKSAvIHNtU2l6ZTsKICAgIHZlYzIgZiA9IGZyYWN0KCh1diAqIHNtU2l6ZSkgKyB2ZWMyKDAuNSkpOwogICAgdmVjMiBjZW50cm9pZFVWID0gZmxvb3IoKHV2ICogc21TaXplKSArIHZlYzIoMC41KSkgLyBzbVNpemU7CiAgICBmbG9hdCBsYiA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYsIGNvbXBhcmUpOwogICAgZmxvYXQgbHQgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWICsgKHRleGVsU2l6ZSAqIHZlYzIoMC4wLCAxLjApKSwgY29tcGFyZSk7CiAgICBmbG9hdCByYiA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYgKyAodGV4ZWxTaXplICogdmVjMigxLjAsIDAuMCkpLCBjb21wYXJlKTsKICAgIGZsb2F0IHJ0ID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViArIHRleGVsU2l6ZSwgY29tcGFyZSk7CiAgICBmbG9hdCBhID0gbWl4KGxiLCBsdCwgZi55KTsKICAgIGZsb2F0IGIgPSBtaXgocmIsIHJ0LCBmLnkpOwogICAgZmxvYXQgYyA9IG1peChhLCBiLCBmLngpOwogICAgcmV0dXJuIGM7Cn0KCmZsb2F0IFBDRihtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXBfMSwgdmVjMiB1diwgZmxvYXQgY29tcGFyZSwgdmVjMiBzbVNpemUpCnsKICAgIGZsb2F0IHJlc3VsdCA9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoLTEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoLTEuMCwgMC4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wLCAxLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKDAuMCwgLTEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2LCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMC4wLCAxLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKDEuMCwgLTEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wLCAwLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmV0dXJuIHJlc3VsdCAvIDkuMDsKfQoKZmxvYXQgbHBUb0RlcHRoKGlub3V0IHZlYzMgbHAsIHZlYzIgbGlnaHRQcm9qXzEpCnsKICAgIGxwID0gYWJzKGxwKTsKICAgIGZsb2F0IHpjb21wID0gbWF4KGxwLngsIG1heChscC55LCBscC56KSk7CiAgICB6Y29tcCA9IGxpZ2h0UHJval8xLnggLSAobGlnaHRQcm9qXzEueSAvIHpjb21wKTsKICAgIHJldHVybiAoemNvbXAgKiAwLjUpICsgMC41Owp9CgpmbG9hdCBQQ0ZDdWJlKG1lZGl1bXAgc2FtcGxlckN1YmUgc2hhZG93TWFwQ3ViZV8xLCB2ZWMzIGxwLCBpbm91dCB2ZWMzIG1sLCBmbG9hdCBiaWFzLCB2ZWMyIGxpZ2h0UHJval8xLCB2ZWMzIG4pCnsKICAgIHZlYzMgcGFyYW0gPSBscCAtIChuICogMC4wMDMwMDAwMDAwMjYwNzcwMzIwODkyMzMzOTg0Mzc1KTsKICAgIGZsb2F0IF80ODIgPSBscFRvRGVwdGgocGFyYW0sIGxpZ2h0UHJval8xKTsKICAgIGZsb2F0IGNvbXBhcmUgPSBfNDgyIC0gKGJpYXMgKiAwLjQwMDAwMDAwNTk2MDQ2NDQ3NzUzOTA2MjUpOwogICAgbWwgKz0gKG4gKiAwLjAwMzAwMDAwMDAyNjA3NzAzMjA4OTIzMzM5ODQzNzUpOwogICAgZmxvYXQgcmVzdWx0ID0gc3RlcChjb21wYXJlLCB0ZXh0dXJlKHNoYWRvd01hcEN1YmVfMSwgbWwpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCAvPSA5LjA7CiAgICByZXR1cm4gcmVzdWx0Owp9Cgp2ZWMzIHN1cmZhY2VBbGJlZG8odmVjMyBiYXNlQ29sb3IsIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peChiYXNlQ29sb3IsIHZlYzMoMC4wKSwgdmVjMyhtZXRhbG5lc3MpKTsKfQoKdmVjMyBzdXJmYWNlRjAodmVjMyBiYXNlQ29sb3IsIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peCh2ZWMzKDAuMDM5OTk5OTk5MTA1OTMwMzI4MzY5MTQwNjI1KSwgYmFzZUNvbG9yLCB2ZWMzKG1ldGFsbmVzcykpOwp9Cgp2ZWMzIGxhbWJlcnREaWZmdXNlQlJERih2ZWMzIGFsYmVkbywgZmxvYXQgbmwpCnsKICAgIHJldHVybiBhbGJlZG8gKiBtYXgoMC4wLCBubCk7Cn0KCmZsb2F0IGRfZ2d4KGZsb2F0IG5oLCBmbG9hdCBhKQp7CiAgICBmbG9hdCBhMiA9IGEgKiBhOwogICAgZmxvYXQgZGVub20gPSBwb3coKChuaCAqIG5oKSAqIChhMiAtIDEuMCkpICsgMS4wLCAyLjApOwogICAgcmV0dXJuIChhMiAqIDAuMzE4MzA5ODczMzQyNTE0MDM4MDg1OTM3NSkgLyBkZW5vbTsKfQoKZmxvYXQgdl9zbWl0aHNjaGxpY2soZmxvYXQgbmwsIGZsb2F0IG52LCBmbG9hdCBhKQp7CiAgICByZXR1cm4gMS4wIC8gKCgobmwgKiAoMS4wIC0gYSkpICsgYSkgKiAoKG52ICogKDEuMCAtIGEpKSArIGEpKTsKfQoKdmVjMyBmX3NjaGxpY2sodmVjMyBmMCwgZmxvYXQgdmgpCnsKICAgIHJldHVybiBmMCArICgodmVjMygxLjApIC0gZjApICogZXhwMigoKC01LjU1NDcyOTkzODUwNzA4MDA3ODEyNSAqIHZoKSAtIDYuOTgzMTYwMDE4OTIwODk4NDM3NSkgKiB2aCkpOwp9Cgp2ZWMzIHNwZWN1bGFyQlJERih2ZWMzIGYwLCBmbG9hdCByb3VnaG5lc3MsIGZsb2F0IG5sLCBmbG9hdCBuaCwgZmxvYXQgbnYsIGZsb2F0IHZoKQp7CiAgICBmbG9hdCBhID0gcm91Z2huZXNzICogcm91Z2huZXNzOwogICAgcmV0dXJuIChmX3NjaGxpY2soZjAsIHZoKSAqIChkX2dneChuaCwgYSkgKiBjbGFtcCh2X3NtaXRoc2NobGljayhubCwgbnYsIGEpLCAwLjAsIDEuMCkpKSAvIHZlYzMoNC4wKTsKfQoKdmVjMyBzaElycmFkaWFuY2UodmVjMyBub3IpCnsKICAgIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoLW5vci56ICogLW5vci56KSkpICsgKCgoY2wyMCAqIDAuNzQzMTI1MDIxNDU3NjcyMTE5MTQwNjI1KSAqIG5vci54KSAqIG5vci54KSkgKyAoY2wwMCAqIDAuODg2MjI3MDExNjgwNjAzMDI3MzQzNzUpKSAtIChjbDIwICogMC4yNDc3MDc5OTI3OTIxMjk1MTY2MDE1NjI1KSkgKyAoKChjbDJtMiAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogLW5vci56KSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIC1ub3IueikgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogLW5vci56KSkgKyAoKGNsMTAgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci54KTsKfQoKdmVjMyB0b25lbWFwRmlsbWljKHZlYzMgY29sb3IpCnsKICAgIHZlYzMgeCA9IG1heCh2ZWMzKDAuMCksIGNvbG9yIC0gdmVjMygwLjAwNDAwMDAwMDE4OTk4OTgwNTIyMTU1NzYxNzE4NzUpKTsKICAgIHJldHVybiAoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygwLjUpKSkgLyAoKHggKiAoKHggKiA2LjE5OTk5OTgwOTI2NTEzNjcxODc1KSArIHZlYzMoMS43MDAwMDAwNDc2ODM3MTU4MjAzMTI1KSkpICsgdmVjMygwLjA1OTk5OTk5ODY1ODg5NTQ5MjU1MzcxMDkzNzUpKTsKfQoKdm9pZCBtYWluKCkKewogICAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgdmVjMyB2VmVjID0gbm9ybWFsaXplKGV5ZURpcik7CiAgICBmbG9hdCBkb3ROViA9IG1heChkb3QobiwgdlZlYyksIDAuMCk7CiAgICB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDExOTIwOTI4OTU1MDc4MTI1KTsKICAgIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIHZlYzMgbHAgPSBsaWdodFBvcyAtIHdwb3NpdGlvbjsKICAgIHZlYzMgbDsKICAgIGZsb2F0IGRvdE5MOwogICAgZmxvYXQgZG90Tkg7CiAgICBmbG9hdCBkb3RWSDsKICAgIGlmIChsaWdodFR5cGUgPT0gMCkKICAgIHsKICAgICAgICBsID0gbGlnaHREaXI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbCA9IG5vcm1hbGl6ZShscCk7CiAgICAgICAgdmlzaWJpbGl0eSAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgfQogICAgdmVjMyBoID0gbm9ybWFsaXplKHZWZWMgKyBsKTsKICAgIGRvdE5MID0gZG90KG4sIGwpOwogICAgZG90TkggPSBkb3QobiwgaCk7CiAgICBkb3RWSCA9IGRvdCh2VmVjLCBoKTsKICAgIGlmIChyZWNlaXZlU2hhZG93KQogICAgewogICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAxKQogICAgICAgIHsKICAgICAgICAgICAgdmVjMyBsUG9zID0gbGFtcFBvcy54eXogLyB2ZWMzKGxhbXBQb3Mudyk7CiAgICAgICAgICAgIHZpc2liaWxpdHkgKj0gUENGKHNoYWRvd01hcCwgbFBvcy54eSwgbFBvcy56IC0gc2hhZG93c0JpYXMsIHZlYzIoMTAyNC4wKSk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2ZWMzIHBhcmFtID0gLWw7CiAgICAgICAgICAgICAgICBmbG9hdCBfNzIwID0gUENGQ3ViZShzaGFkb3dNYXBDdWJlLCBscCwgcGFyYW0sIHNoYWRvd3NCaWFzLCBsaWdodFByb2osIG4pOwogICAgICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBfNzIwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgaWYgKGxpZ2h0VHlwZSA9PSAyKQogICAgewogICAgICAgIGZsb2F0IHNwb3RFZmZlY3QgPSBkb3QobGlnaHREaXIsIGwpOwogICAgICAgIGlmIChzcG90RWZmZWN0IDwgc3BvdGxpZ2h0RGF0YS54KQogICAgICAgIHsKICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBzbW9vdGhzdGVwKHNwb3RsaWdodERhdGEueSwgc3BvdGxpZ2h0RGF0YS54LCBzcG90RWZmZWN0KTsKICAgICAgICB9CiAgICB9CiAgICB2ZWMzIGFsYmVkbyA9IHN1cmZhY2VBbGJlZG8oYmFzZWNvbCwgbWV0YWxsaWMpOwogICAgdmVjMyBmMCA9IHN1cmZhY2VGMChiYXNlY29sLCBtZXRhbGxpYyk7CiAgICB2ZWMzIGRpcmVjdCA9IGxhbWJlcnREaWZmdXNlQlJERihhbGJlZG8sIGRvdE5MKTsKICAgIGRpcmVjdCArPSBzcGVjdWxhckJSREYoZjAsIHJvdWdobmVzcywgZG90TkwsIGRvdE5ILCBkb3ROViwgZG90VkgpOwogICAgdmVjMyBpbmRpcmVjdCA9IHNoSXJyYWRpYW5jZShuKTsKICAgIGluZGlyZWN0ICo9IGFsYmVkbzsKICAgIGZyYWdDb2xvciA9IHZlYzQoKChkaXJlY3QgKiBsaWdodENvbG9yKSAqIHZpc2liaWxpdHkpICsgKChpbmRpcmVjdCAqIG9jY2x1c2lvbikgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICB2ZWMzIF83OTQgPSB0b25lbWFwRmlsbWljKGZyYWdDb2xvci54eXopOwogICAgZnJhZ0NvbG9yID0gdmVjNChfNzk0LngsIF83OTQueSwgXzc5NC56LCBmcmFnQ29sb3Iudyk7Cn0KCg",At.Material_mesh_vertData0="s674:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDMgTjsKdW5pZm9ybSBtYXQ0IFdWUDsKdW5pZm9ybSBtYXQ0IFc7CnVuaWZvcm0gdmVjMyBleWU7CnVuaWZvcm0gaW50IGxpZ2h0U2hhZG93Owp1bmlmb3JtIG1hdDQgTFdWUDsKCmF0dHJpYnV0ZSB2ZWMzIHBvczsKdmFyeWluZyB2ZWMzIHdub3JtYWw7CmF0dHJpYnV0ZSB2ZWMzIG5vcjsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKdmFyeWluZyB2ZWMzIGV5ZURpcjsKdmFyeWluZyB2ZWM0IGxhbXBQb3M7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIHdub3JtYWwgPSBub3JtYWxpemUoTiAqIG5vcik7CiAgICBnbF9Qb3NpdGlvbiA9IFdWUCAqIHNwb3M7CiAgICB3cG9zaXRpb24gPSB2ZWM0KFcgKiBzcG9zKS54eXo7CiAgICBleWVEaXIgPSBleWUgLSB3cG9zaXRpb247CiAgICBpZiAobGlnaHRTaGFkb3cgPT0gMSkKICAgIHsKICAgICAgICBsYW1wUG9zID0gTFdWUCAqIHNwb3M7CiAgICB9Cn0KCg",At.Material_mesh_vertData1="s812:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0MyBOOwp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXVlA7CnVuaWZvcm0gbWVkaXVtcCBtYXQ0IFc7CnVuaWZvcm0gbWVkaXVtcCB2ZWMzIGV5ZTsKdW5pZm9ybSBtZWRpdW1wIGludCBsaWdodFNoYWRvdzsKdW5pZm9ybSBtZWRpdW1wIG1hdDQgTFdWUDsKCmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzMgcG9zOwp2YXJ5aW5nIG1lZGl1bXAgdmVjMyB3bm9ybWFsOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIG5vcjsKdmFyeWluZyBtZWRpdW1wIHZlYzMgd3Bvc2l0aW9uOwp2YXJ5aW5nIG1lZGl1bXAgdmVjMyBleWVEaXI7CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGxhbXBQb3M7Cgp2b2lkIG1haW4oKQp7CiAgICBtZWRpdW1wIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKICAgIHdwb3NpdGlvbiA9IHZlYzQoVyAqIHNwb3MpLnh5ejsKICAgIGV5ZURpciA9IGV5ZSAtIHdwb3NpdGlvbjsKICAgIGlmIChsaWdodFNoYWRvdyA9PSAxKQogICAgewogICAgICAgIGxhbXBQb3MgPSBMV1ZQICogc3BvczsKICAgIH0KfQoK",At.Material_mesh_vertData2="s776:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0MyBOOwp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXVlA7CnVuaWZvcm0gbWVkaXVtcCBtYXQ0IFc7CnVuaWZvcm0gbWVkaXVtcCB2ZWMzIGV5ZTsKdW5pZm9ybSBtZWRpdW1wIGludCBsaWdodFNoYWRvdzsKdW5pZm9ybSBtZWRpdW1wIG1hdDQgTFdWUDsKCmluIG1lZGl1bXAgdmVjMyBwb3M7Cm91dCBtZWRpdW1wIHZlYzMgd25vcm1hbDsKaW4gbWVkaXVtcCB2ZWMzIG5vcjsKb3V0IG1lZGl1bXAgdmVjMyB3cG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzMgZXllRGlyOwpvdXQgbWVkaXVtcCB2ZWM0IGxhbXBQb3M7Cgp2b2lkIG1haW4oKQp7CiAgICBtZWRpdW1wIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKICAgIHdwb3NpdGlvbiA9IHZlYzQoVyAqIHNwb3MpLnh5ejsKICAgIGV5ZURpciA9IGV5ZSAtIHdwb3NpdGlvbjsKICAgIGlmIChsaWdodFNoYWRvdyA9PSAxKQogICAgewogICAgICAgIGxhbXBQb3MgPSBMV1ZQICogc3BvczsKICAgIH0KfQoK",At.Material_shadowmap_fragData0="s103:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdm9pZCBtYWluKCkKewp9Cgo",At.Material_shadowmap_fragData1="s106:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2b2lkIG1haW4oKQp7Cn0KCg",At.Material_shadowmap_fragData2="s110:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2b2lkIG1haW4oKQp7Cn0KCg",At.Material_shadowmap_vertData0="s207:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgTFdWUDsKCmF0dHJpYnV0ZSB2ZWMzIHBvczsKYXR0cmlidXRlIHZlYzMgbm9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCBzcG9zID0gdmVjNChwb3MsIDEuMCk7CiAgICBnbF9Qb3NpdGlvbiA9IExXVlAgKiBzcG9zOwp9Cgo",At.Material_shadowmap_vertData1="s250:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBMV1ZQOwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyBwb3M7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzMgbm9yOwoKdm9pZCBtYWluKCkKewogICAgbWVkaXVtcCB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIGdsX1Bvc2l0aW9uID0gTFdWUCAqIHNwb3M7Cn0KCg",At.Material_shadowmap_vertData2="s235:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBMV1ZQOwoKaW4gbWVkaXVtcCB2ZWMzIHBvczsKaW4gbWVkaXVtcCB2ZWMzIG5vcjsKCnZvaWQgbWFpbigpCnsKICAgIG1lZGl1bXAgdmVjNCBzcG9zID0gdmVjNChwb3MsIDEuMCk7CiAgICBnbF9Qb3NpdGlvbiA9IExXVlAgKiBzcG9zOwp9Cgo",At.armdefault_mesh_fragData0="s12344:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWM0IHNoaXJyWzddOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gaW50IGxpZ2h0VHlwZTsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0RGlyOwp1bmlmb3JtIGJvb2wgcmVjZWl2ZVNoYWRvdzsKdW5pZm9ybSBpbnQgbGlnaHRTaGFkb3c7CnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcDsKdW5pZm9ybSBoaWdocCBmbG9hdCBzaGFkb3dzQmlhczsKdW5pZm9ybSBoaWdocCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlOwp1bmlmb3JtIGhpZ2hwIHZlYzIgbGlnaHRQcm9qOwp1bmlmb3JtIGhpZ2hwIHZlYzIgc3BvdGxpZ2h0RGF0YTsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gaGlnaHAgZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIGhpZ2hwIHZlYzMgd25vcm1hbDsKdmFyeWluZyBoaWdocCB2ZWMzIGV5ZURpcjsKdmFyeWluZyBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKdmFyeWluZyBoaWdocCB2ZWM0IGxhbXBQb3M7CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmhpZ2hwIGZsb2F0IHNoYWRvd0NvbXBhcmUoaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCBoaWdocCB2ZWMyIHV2LCBoaWdocCBmbG9hdCBjb21wYXJlKQp7CiAgICBoaWdocCBmbG9hdCBkZXB0aCA9IHRleHR1cmUyRChzaGFkb3dNYXBfMSwgdXYpLng7CiAgICByZXR1cm4gc3RlcChjb21wYXJlLCBkZXB0aCk7Cn0KCmhpZ2hwIGZsb2F0IHNoYWRvd0xlcnAoaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCBoaWdocCB2ZWMyIHV2LCBoaWdocCBmbG9hdCBjb21wYXJlLCBoaWdocCB2ZWMyIHNtU2l6ZSkKewogICAgaGlnaHAgdmVjMiB0ZXhlbFNpemUgPSB2ZWMyKDEuMCkgLyBzbVNpemU7CiAgICBoaWdocCB2ZWMyIGYgPSBmcmFjdCgodXYgKiBzbVNpemUpICsgdmVjMigwLjUpKTsKICAgIGhpZ2hwIHZlYzIgY2VudHJvaWRVViA9IGZsb29yKCh1diAqIHNtU2l6ZSkgKyB2ZWMyKDAuNSkpIC8gc21TaXplOwogICAgaGlnaHAgZmxvYXQgbGIgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWLCBjb21wYXJlKTsKICAgIGhpZ2hwIGZsb2F0IGx0ID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViArICh0ZXhlbFNpemUgKiB2ZWMyKDAuMCwgMS4wKSksIGNvbXBhcmUpOwogICAgaGlnaHAgZmxvYXQgcmIgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWICsgKHRleGVsU2l6ZSAqIHZlYzIoMS4wLCAwLjApKSwgY29tcGFyZSk7CiAgICBoaWdocCBmbG9hdCBydCA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYgKyB0ZXhlbFNpemUsIGNvbXBhcmUpOwogICAgaGlnaHAgZmxvYXQgYSA9IG1peChsYiwgbHQsIGYueSk7CiAgICBoaWdocCBmbG9hdCBiID0gbWl4KHJiLCBydCwgZi55KTsKICAgIGhpZ2hwIGZsb2F0IGMgPSBtaXgoYSwgYiwgZi54KTsKICAgIHJldHVybiBjOwp9CgpoaWdocCBmbG9hdCBQQ0YoaGlnaHAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCBoaWdocCB2ZWMyIHV2LCBoaWdocCBmbG9hdCBjb21wYXJlLCBoaWdocCB2ZWMyIHNtU2l6ZSkKewogICAgaGlnaHAgZmxvYXQgcmVzdWx0ID0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wLCAwLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKC0xLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMC4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYsIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigwLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigxLjAsIDAuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXR1cm4gcmVzdWx0IC8gOS4wOwp9CgpoaWdocCBmbG9hdCBscFRvRGVwdGgoaW5vdXQgaGlnaHAgdmVjMyBscCwgaGlnaHAgdmVjMiBsaWdodFByb2pfMSkKewogICAgbHAgPSBhYnMobHApOwogICAgaGlnaHAgZmxvYXQgemNvbXAgPSBtYXgobHAueCwgbWF4KGxwLnksIGxwLnopKTsKICAgIHpjb21wID0gbGlnaHRQcm9qXzEueCAtIChsaWdodFByb2pfMS55IC8gemNvbXApOwogICAgcmV0dXJuICh6Y29tcCAqIDAuNSkgKyAwLjU7Cn0KCmhpZ2hwIGZsb2F0IFBDRkN1YmUoaGlnaHAgc2FtcGxlckN1YmUgc2hhZG93TWFwQ3ViZV8xLCBoaWdocCB2ZWMzIGxwLCBpbm91dCBoaWdocCB2ZWMzIG1sLCBoaWdocCBmbG9hdCBiaWFzLCBoaWdocCB2ZWMyIGxpZ2h0UHJval8xLCBoaWdocCB2ZWMzIG4pCnsKICAgIGhpZ2hwIHZlYzMgcGFyYW0gPSBscCAtIChuICogMC4wMDMwMDAwMDAwMjYwNzcwMzIwODkyMzMzOTg0Mzc1KTsKICAgIGhpZ2hwIGZsb2F0IF80ODIgPSBscFRvRGVwdGgocGFyYW0sIGxpZ2h0UHJval8xKTsKICAgIGhpZ2hwIGZsb2F0IGNvbXBhcmUgPSBfNDgyIC0gKGJpYXMgKiAwLjQwMDAwMDAwNTk2MDQ2NDQ3NzUzOTA2MjUpOwogICAgbWwgKz0gKG4gKiAwLjAwMzAwMDAwMDAyNjA3NzAzMjA4OTIzMzM5ODQzNzUpOwogICAgaGlnaHAgZmxvYXQgcmVzdWx0ID0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCAvPSA5LjA7CiAgICByZXR1cm4gcmVzdWx0Owp9CgpoaWdocCB2ZWMzIHN1cmZhY2VBbGJlZG8oaGlnaHAgdmVjMyBiYXNlQ29sb3IsIGhpZ2hwIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peChiYXNlQ29sb3IsIHZlYzMoMC4wKSwgdmVjMyhtZXRhbG5lc3MpKTsKfQoKaGlnaHAgdmVjMyBzdXJmYWNlRjAoaGlnaHAgdmVjMyBiYXNlQ29sb3IsIGhpZ2hwIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peCh2ZWMzKDAuMDM5OTk5OTk5MTA1OTMwMzI4MzY5MTQwNjI1KSwgYmFzZUNvbG9yLCB2ZWMzKG1ldGFsbmVzcykpOwp9CgpoaWdocCB2ZWMzIGxhbWJlcnREaWZmdXNlQlJERihoaWdocCB2ZWMzIGFsYmVkbywgaGlnaHAgZmxvYXQgbmwpCnsKICAgIHJldHVybiBhbGJlZG8gKiBtYXgoMC4wLCBubCk7Cn0KCmhpZ2hwIGZsb2F0IGRfZ2d4KGhpZ2hwIGZsb2F0IG5oLCBoaWdocCBmbG9hdCBhKQp7CiAgICBoaWdocCBmbG9hdCBhMiA9IGEgKiBhOwogICAgaGlnaHAgZmxvYXQgZGVub20gPSBwb3coKChuaCAqIG5oKSAqIChhMiAtIDEuMCkpICsgMS4wLCAyLjApOwogICAgcmV0dXJuIChhMiAqIDAuMzE4MzA5ODczMzQyNTE0MDM4MDg1OTM3NSkgLyBkZW5vbTsKfQoKaGlnaHAgZmxvYXQgdl9zbWl0aHNjaGxpY2soaGlnaHAgZmxvYXQgbmwsIGhpZ2hwIGZsb2F0IG52LCBoaWdocCBmbG9hdCBhKQp7CiAgICByZXR1cm4gMS4wIC8gKCgobmwgKiAoMS4wIC0gYSkpICsgYSkgKiAoKG52ICogKDEuMCAtIGEpKSArIGEpKTsKfQoKaGlnaHAgdmVjMyBmX3NjaGxpY2soaGlnaHAgdmVjMyBmMCwgaGlnaHAgZmxvYXQgdmgpCnsKICAgIHJldHVybiBmMCArICgodmVjMygxLjApIC0gZjApICogZXhwMigoKC01LjU1NDcyOTkzODUwNzA4MDA3ODEyNSAqIHZoKSAtIDYuOTgzMTYwMDE4OTIwODk4NDM3NSkgKiB2aCkpOwp9CgpoaWdocCB2ZWMzIHNwZWN1bGFyQlJERihoaWdocCB2ZWMzIGYwLCBoaWdocCBmbG9hdCByb3VnaG5lc3MsIGhpZ2hwIGZsb2F0IG5sLCBoaWdocCBmbG9hdCBuaCwgaGlnaHAgZmxvYXQgbnYsIGhpZ2hwIGZsb2F0IHZoKQp7CiAgICBoaWdocCBmbG9hdCBhID0gcm91Z2huZXNzICogcm91Z2huZXNzOwogICAgcmV0dXJuIChmX3NjaGxpY2soZjAsIHZoKSAqIChkX2dneChuaCwgYSkgKiBjbGFtcCh2X3NtaXRoc2NobGljayhubCwgbnYsIGEpLCAwLjAsIDEuMCkpKSAvIHZlYzMoNC4wKTsKfQoKaGlnaHAgdmVjMyBzaElycmFkaWFuY2UoaGlnaHAgdmVjMyBub3IpCnsKICAgIGhpZ2hwIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICBoaWdocCB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIGhpZ2hwIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgaGlnaHAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICBoaWdocCB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIGhpZ2hwIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICBoaWdocCB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgaGlnaHAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoLW5vci56ICogLW5vci56KSkpICsgKCgoY2wyMCAqIDAuNzQzMTI1MDIxNDU3NjcyMTE5MTQwNjI1KSAqIG5vci54KSAqIG5vci54KSkgKyAoY2wwMCAqIDAuODg2MjI3MDExNjgwNjAzMDI3MzQzNzUpKSAtIChjbDIwICogMC4yNDc3MDc5OTI3OTIxMjk1MTY2MDE1NjI1KSkgKyAoKChjbDJtMiAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogLW5vci56KSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIC1ub3IueikgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogLW5vci56KSkgKyAoKGNsMTAgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci54KTsKfQoKaGlnaHAgdmVjMyB0b25lbWFwRmlsbWljKGhpZ2hwIHZlYzMgY29sb3IpCnsKICAgIGhpZ2hwIHZlYzMgeCA9IG1heCh2ZWMzKDAuMCksIGNvbG9yIC0gdmVjMygwLjAwNDAwMDAwMDE4OTk4OTgwNTIyMTU1NzYxNzE4NzUpKTsKICAgIHJldHVybiAoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygwLjUpKSkgLyAoKHggKiAoKHggKiA2LjE5OTk5OTgwOTI2NTEzNjcxODc1KSArIHZlYzMoMS43MDAwMDAwNDc2ODM3MTU4MjAzMTI1KSkpICsgdmVjMygwLjA1OTk5OTk5ODY1ODg5NTQ5MjU1MzcxMDkzNzUpKTsKfQoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgaGlnaHAgdmVjMyB2VmVjID0gbm9ybWFsaXplKGV5ZURpcik7CiAgICBoaWdocCBmbG9hdCBkb3ROViA9IG1heChkb3QobiwgdlZlYyksIDAuMCk7CiAgICBoaWdocCB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDExOTIwOTI4OTU1MDc4MTI1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGhpZ2hwIHZlYzMgbHAgPSBsaWdodFBvcyAtIHdwb3NpdGlvbjsKICAgIGhpZ2hwIHZlYzMgbDsKICAgIGhpZ2hwIGZsb2F0IGRvdE5MOwogICAgaGlnaHAgZmxvYXQgZG90Tkg7CiAgICBoaWdocCBmbG9hdCBkb3RWSDsKICAgIGlmIChsaWdodFR5cGUgPT0gMCkKICAgIHsKICAgICAgICBsID0gbGlnaHREaXI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbCA9IG5vcm1hbGl6ZShscCk7CiAgICAgICAgdmlzaWJpbGl0eSAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgfQogICAgaGlnaHAgdmVjMyBoID0gbm9ybWFsaXplKHZWZWMgKyBsKTsKICAgIGRvdE5MID0gZG90KG4sIGwpOwogICAgZG90TkggPSBkb3QobiwgaCk7CiAgICBkb3RWSCA9IGRvdCh2VmVjLCBoKTsKICAgIGlmIChyZWNlaXZlU2hhZG93KQogICAgewogICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAxKQogICAgICAgIHsKICAgICAgICAgICAgaGlnaHAgdmVjMyBsUG9zID0gbGFtcFBvcy54eXogLyB2ZWMzKGxhbXBQb3Mudyk7CiAgICAgICAgICAgIHZpc2liaWxpdHkgKj0gUENGKHNoYWRvd01hcCwgbFBvcy54eSwgbFBvcy56IC0gc2hhZG93c0JpYXMsIHZlYzIoMTAyNC4wKSk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoaWdocCB2ZWMzIHBhcmFtID0gLWw7CiAgICAgICAgICAgICAgICBoaWdocCBmbG9hdCBfNzIwID0gUENGQ3ViZShzaGFkb3dNYXBDdWJlLCBscCwgcGFyYW0sIHNoYWRvd3NCaWFzLCBsaWdodFByb2osIG4pOwogICAgICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBfNzIwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgaWYgKGxpZ2h0VHlwZSA9PSAyKQogICAgewogICAgICAgIGhpZ2hwIGZsb2F0IHNwb3RFZmZlY3QgPSBkb3QobGlnaHREaXIsIGwpOwogICAgICAgIGlmIChzcG90RWZmZWN0IDwgc3BvdGxpZ2h0RGF0YS54KQogICAgICAgIHsKICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBzbW9vdGhzdGVwKHNwb3RsaWdodERhdGEueSwgc3BvdGxpZ2h0RGF0YS54LCBzcG90RWZmZWN0KTsKICAgICAgICB9CiAgICB9CiAgICBoaWdocCB2ZWMzIGFsYmVkbyA9IHN1cmZhY2VBbGJlZG8oYmFzZWNvbCwgbWV0YWxsaWMpOwogICAgaGlnaHAgdmVjMyBmMCA9IHN1cmZhY2VGMChiYXNlY29sLCBtZXRhbGxpYyk7CiAgICBoaWdocCB2ZWMzIGRpcmVjdCA9IGxhbWJlcnREaWZmdXNlQlJERihhbGJlZG8sIGRvdE5MKTsKICAgIGRpcmVjdCArPSBzcGVjdWxhckJSREYoZjAsIHJvdWdobmVzcywgZG90TkwsIGRvdE5ILCBkb3ROViwgZG90VkgpOwogICAgaGlnaHAgdmVjMyBpbmRpcmVjdCA9IHNoSXJyYWRpYW5jZShuKTsKICAgIGluZGlyZWN0ICo9IGFsYmVkbzsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoKGRpcmVjdCAqIGxpZ2h0Q29sb3IpICogdmlzaWJpbGl0eSkgKyAoKGluZGlyZWN0ICogb2NjbHVzaW9uKSAqIGVudm1hcFN0cmVuZ3RoKSwgMS4wKTsKICAgIGhpZ2hwIHZlYzMgXzc5NCA9IHRvbmVtYXBGaWxtaWMoZ2xfRnJhZ0RhdGFbMF0ueHl6KTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChfNzk0LngsIF83OTQueSwgXzc5NC56LCBnbF9GcmFnRGF0YVswXS53KTsKfQoK",At.armdefault_mesh_fragData1="s11427:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gdmVjMyBsaWdodFBvczsKdW5pZm9ybSBpbnQgbGlnaHRUeXBlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gYm9vbCByZWNlaXZlU2hhZG93Owp1bmlmb3JtIGludCBsaWdodFNoYWRvdzsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlOwp1bmlmb3JtIHZlYzIgbGlnaHRQcm9qOwp1bmlmb3JtIHZlYzIgc3BvdGxpZ2h0RGF0YTsKdW5pZm9ybSB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWMzIGV5ZURpcjsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKdmFyeWluZyB2ZWM0IGxhbXBQb3M7CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmZsb2F0IHNoYWRvd0NvbXBhcmUobWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwXzEsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUpCnsKICAgIGZsb2F0IGRlcHRoID0gdGV4dHVyZTJEKHNoYWRvd01hcF8xLCB1dikueDsKICAgIHJldHVybiBzdGVwKGNvbXBhcmUsIGRlcHRoKTsKfQoKZmxvYXQgc2hhZG93TGVycChtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXBfMSwgdmVjMiB1diwgZmxvYXQgY29tcGFyZSwgdmVjMiBzbVNpemUpCnsKICAgIHZlYzIgdGV4ZWxTaXplID0gdmVjMigxLjApIC8gc21TaXplOwogICAgdmVjMiBmID0gZnJhY3QoKHV2ICogc21TaXplKSArIHZlYzIoMC41KSk7CiAgICB2ZWMyIGNlbnRyb2lkVVYgPSBmbG9vcigodXYgKiBzbVNpemUpICsgdmVjMigwLjUpKSAvIHNtU2l6ZTsKICAgIGZsb2F0IGxiID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViwgY29tcGFyZSk7CiAgICBmbG9hdCBsdCA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYgKyAodGV4ZWxTaXplICogdmVjMigwLjAsIDEuMCkpLCBjb21wYXJlKTsKICAgIGZsb2F0IHJiID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViArICh0ZXhlbFNpemUgKiB2ZWMyKDEuMCwgMC4wKSksIGNvbXBhcmUpOwogICAgZmxvYXQgcnQgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWICsgdGV4ZWxTaXplLCBjb21wYXJlKTsKICAgIGZsb2F0IGEgPSBtaXgobGIsIGx0LCBmLnkpOwogICAgZmxvYXQgYiA9IG1peChyYiwgcnQsIGYueSk7CiAgICBmbG9hdCBjID0gbWl4KGEsIGIsIGYueCk7CiAgICByZXR1cm4gYzsKfQoKZmxvYXQgUENGKG1lZGl1bXAgc2FtcGxlcjJEIHNoYWRvd01hcF8xLCB2ZWMyIHV2LCBmbG9hdCBjb21wYXJlLCB2ZWMyIHNtU2l6ZSkKewogICAgZmxvYXQgcmVzdWx0ID0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wLCAwLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKC0xLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMC4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYsIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigwLjAsIDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wLCAtMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigxLjAsIDAuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXR1cm4gcmVzdWx0IC8gOS4wOwp9CgpmbG9hdCBscFRvRGVwdGgoaW5vdXQgdmVjMyBscCwgdmVjMiBsaWdodFByb2pfMSkKewogICAgbHAgPSBhYnMobHApOwogICAgZmxvYXQgemNvbXAgPSBtYXgobHAueCwgbWF4KGxwLnksIGxwLnopKTsKICAgIHpjb21wID0gbGlnaHRQcm9qXzEueCAtIChsaWdodFByb2pfMS55IC8gemNvbXApOwogICAgcmV0dXJuICh6Y29tcCAqIDAuNSkgKyAwLjU7Cn0KCmZsb2F0IFBDRkN1YmUobWVkaXVtcCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlXzEsIHZlYzMgbHAsIGlub3V0IHZlYzMgbWwsIGZsb2F0IGJpYXMsIHZlYzIgbGlnaHRQcm9qXzEsIHZlYzMgbikKewogICAgdmVjMyBwYXJhbSA9IGxwIC0gKG4gKiAwLjAwMzAwMDAwMDAyNjA3NzAzMjA4OTIzMzM5ODQzNzUpOwogICAgZmxvYXQgXzQ4MiA9IGxwVG9EZXB0aChwYXJhbSwgbGlnaHRQcm9qXzEpOwogICAgZmxvYXQgY29tcGFyZSA9IF80ODIgLSAoYmlhcyAqIDAuNDAwMDAwMDA1OTYwNDY0NDc3NTM5MDYyNSk7CiAgICBtbCArPSAobiAqIDAuMDAzMDAwMDAwMDI2MDc3MDMyMDg5MjMzMzk4NDM3NSk7CiAgICBmbG9hdCByZXN1bHQgPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZUN1YmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlQ3ViZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmVDdWJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0IC89IDkuMDsKICAgIHJldHVybiByZXN1bHQ7Cn0KCnZlYzMgc3VyZmFjZUFsYmVkbyh2ZWMzIGJhc2VDb2xvciwgZmxvYXQgbWV0YWxuZXNzKQp7CiAgICByZXR1cm4gbWl4KGJhc2VDb2xvciwgdmVjMygwLjApLCB2ZWMzKG1ldGFsbmVzcykpOwp9Cgp2ZWMzIHN1cmZhY2VGMCh2ZWMzIGJhc2VDb2xvciwgZmxvYXQgbWV0YWxuZXNzKQp7CiAgICByZXR1cm4gbWl4KHZlYzMoMC4wMzk5OTk5OTkxMDU5MzAzMjgzNjkxNDA2MjUpLCBiYXNlQ29sb3IsIHZlYzMobWV0YWxuZXNzKSk7Cn0KCnZlYzMgbGFtYmVydERpZmZ1c2VCUkRGKHZlYzMgYWxiZWRvLCBmbG9hdCBubCkKewogICAgcmV0dXJuIGFsYmVkbyAqIG1heCgwLjAsIG5sKTsKfQoKZmxvYXQgZF9nZ3goZmxvYXQgbmgsIGZsb2F0IGEpCnsKICAgIGZsb2F0IGEyID0gYSAqIGE7CiAgICBmbG9hdCBkZW5vbSA9IHBvdygoKG5oICogbmgpICogKGEyIC0gMS4wKSkgKyAxLjAsIDIuMCk7CiAgICByZXR1cm4gKGEyICogMC4zMTgzMDk4NzMzNDI1MTQwMzgwODU5Mzc1KSAvIGRlbm9tOwp9CgpmbG9hdCB2X3NtaXRoc2NobGljayhmbG9hdCBubCwgZmxvYXQgbnYsIGZsb2F0IGEpCnsKICAgIHJldHVybiAxLjAgLyAoKChubCAqICgxLjAgLSBhKSkgKyBhKSAqICgobnYgKiAoMS4wIC0gYSkpICsgYSkpOwp9Cgp2ZWMzIGZfc2NobGljayh2ZWMzIGYwLCBmbG9hdCB2aCkKewogICAgcmV0dXJuIGYwICsgKCh2ZWMzKDEuMCkgLSBmMCkgKiBleHAyKCgoLTUuNTU0NzI5OTM4NTA3MDgwMDc4MTI1ICogdmgpIC0gNi45ODMxNjAwMTg5MjA4OTg0Mzc1KSAqIHZoKSk7Cn0KCnZlYzMgc3BlY3VsYXJCUkRGKHZlYzMgZjAsIGZsb2F0IHJvdWdobmVzcywgZmxvYXQgbmwsIGZsb2F0IG5oLCBmbG9hdCBudiwgZmxvYXQgdmgpCnsKICAgIGZsb2F0IGEgPSByb3VnaG5lc3MgKiByb3VnaG5lc3M7CiAgICByZXR1cm4gKGZfc2NobGljayhmMCwgdmgpICogKGRfZ2d4KG5oLCBhKSAqIGNsYW1wKHZfc21pdGhzY2hsaWNrKG5sLCBudiwgYSksIDAuMCwgMS4wKSkpIC8gdmVjMyg0LjApOwp9Cgp2ZWMzIHNoSXJyYWRpYW5jZSh2ZWMzIG5vcikKewogICAgdmVjMyBjbDAwID0gdmVjMyhzaGlyclswXS54LCBzaGlyclswXS55LCBzaGlyclswXS56KTsKICAgIHZlYzMgY2wxbTEgPSB2ZWMzKHNoaXJyWzBdLncsIHNoaXJyWzFdLngsIHNoaXJyWzFdLnkpOwogICAgdmVjMyBjbDEwID0gdmVjMyhzaGlyclsxXS56LCBzaGlyclsxXS53LCBzaGlyclsyXS54KTsKICAgIHZlYzMgY2wxMSA9IHZlYzMoc2hpcnJbMl0ueSwgc2hpcnJbMl0ueiwgc2hpcnJbMl0udyk7CiAgICB2ZWMzIGNsMm0yID0gdmVjMyhzaGlyclszXS54LCBzaGlyclszXS55LCBzaGlyclszXS56KTsKICAgIHZlYzMgY2wybTEgPSB2ZWMzKHNoaXJyWzNdLncsIHNoaXJyWzRdLngsIHNoaXJyWzRdLnkpOwogICAgdmVjMyBjbDIwID0gdmVjMyhzaGlycls0XS56LCBzaGlycls0XS53LCBzaGlycls1XS54KTsKICAgIHZlYzMgY2wyMSA9IHZlYzMoc2hpcnJbNV0ueSwgc2hpcnJbNV0ueiwgc2hpcnJbNV0udyk7CiAgICB2ZWMzIGNsMjIgPSB2ZWMzKHNoaXJyWzZdLngsIHNoaXJyWzZdLnksIHNoaXJyWzZdLnopOwogICAgcmV0dXJuICgoKCgoKCgoKChjbDIyICogMC40MjkwNDI5OTQ5NzYwNDM3MDExNzE4NzUpICogKChub3IueSAqIG5vci55KSAtICgtbm9yLnogKiAtbm9yLnopKSkgKyAoKChjbDIwICogMC43NDMxMjUwMjE0NTc2NzIxMTkxNDA2MjUpICogbm9yLngpICogbm9yLngpKSArIChjbDAwICogMC44ODYyMjcwMTE2ODA2MDMwMjczNDM3NSkpIC0gKGNsMjAgKiAwLjI0NzcwNzk5Mjc5MjEyOTUxNjYwMTU2MjUpKSArICgoKGNsMm0yICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiAtbm9yLnopKSArICgoKGNsMjEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIG5vci55KSAqIG5vci54KSkgKyAoKChjbDJtMSAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogLW5vci56KSAqIG5vci54KSkgKyAoKGNsMTEgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci55KSkgKyAoKGNsMW0xICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiAtbm9yLnopKSArICgoY2wxMCAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogbm9yLngpOwp9Cgp2ZWMzIHRvbmVtYXBGaWxtaWModmVjMyBjb2xvcikKewogICAgdmVjMyB4ID0gbWF4KHZlYzMoMC4wKSwgY29sb3IgLSB2ZWMzKDAuMDA0MDAwMDAwMTg5OTg5ODA1MjIxNTU3NjE3MTg3NSkpOwogICAgcmV0dXJuICh4ICogKCh4ICogNi4xOTk5OTk4MDkyNjUxMzY3MTg3NSkgKyB2ZWMzKDAuNSkpKSAvICgoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygxLjcwMDAwMDA0NzY4MzcxNTgyMDMxMjUpKSkgKyB2ZWMzKDAuMDU5OTk5OTk4NjU4ODk1NDkyNTUzNzEwOTM3NSkpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICB2ZWMzIHZWZWMgPSBub3JtYWxpemUoZXllRGlyKTsKICAgIGZsb2F0IGRvdE5WID0gbWF4KGRvdChuLCB2VmVjKSwgMC4wKTsKICAgIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC44MDAwMDAwMTE5MjA5Mjg5NTUwNzgxMjUpOwogICAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgdmVjMyBscCA9IGxpZ2h0UG9zIC0gd3Bvc2l0aW9uOwogICAgdmVjMyBsOwogICAgZmxvYXQgZG90Tkw7CiAgICBmbG9hdCBkb3ROSDsKICAgIGZsb2F0IGRvdFZIOwogICAgaWYgKGxpZ2h0VHlwZSA9PSAwKQogICAgewogICAgICAgIGwgPSBsaWdodERpcjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBsID0gbm9ybWFsaXplKGxwKTsKICAgICAgICB2aXNpYmlsaXR5ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICB9CiAgICB2ZWMzIGggPSBub3JtYWxpemUodlZlYyArIGwpOwogICAgZG90TkwgPSBkb3QobiwgbCk7CiAgICBkb3ROSCA9IGRvdChuLCBoKTsKICAgIGRvdFZIID0gZG90KHZWZWMsIGgpOwogICAgaWYgKHJlY2VpdmVTaGFkb3cpCiAgICB7CiAgICAgICAgaWYgKGxpZ2h0U2hhZG93ID09IDEpCiAgICAgICAgewogICAgICAgICAgICB2ZWMzIGxQb3MgPSBsYW1wUG9zLnh5eiAvIHZlYzMobGFtcFBvcy53KTsKICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBQQ0Yoc2hhZG93TWFwLCBsUG9zLnh5LCBsUG9zLnogLSBzaGFkb3dzQmlhcywgdmVjMigxMDI0LjApKTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGxpZ2h0U2hhZG93ID09IDIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZlYzMgcGFyYW0gPSAtbDsKICAgICAgICAgICAgICAgIGZsb2F0IF83MjAgPSBQQ0ZDdWJlKHNoYWRvd01hcEN1YmUsIGxwLCBwYXJhbSwgc2hhZG93c0JpYXMsIGxpZ2h0UHJvaiwgbik7CiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ICo9IF83MjA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBpZiAobGlnaHRUeXBlID09IDIpCiAgICB7CiAgICAgICAgZmxvYXQgc3BvdEVmZmVjdCA9IGRvdChsaWdodERpciwgbCk7CiAgICAgICAgaWYgKHNwb3RFZmZlY3QgPCBzcG90bGlnaHREYXRhLngpCiAgICAgICAgewogICAgICAgICAgICB2aXNpYmlsaXR5ICo9IHNtb290aHN0ZXAoc3BvdGxpZ2h0RGF0YS55LCBzcG90bGlnaHREYXRhLngsIHNwb3RFZmZlY3QpOwogICAgICAgIH0KICAgIH0KICAgIHZlYzMgYWxiZWRvID0gc3VyZmFjZUFsYmVkbyhiYXNlY29sLCBtZXRhbGxpYyk7CiAgICB2ZWMzIGYwID0gc3VyZmFjZUYwKGJhc2Vjb2wsIG1ldGFsbGljKTsKICAgIHZlYzMgZGlyZWN0ID0gbGFtYmVydERpZmZ1c2VCUkRGKGFsYmVkbywgZG90TkwpOwogICAgZGlyZWN0ICs9IHNwZWN1bGFyQlJERihmMCwgcm91Z2huZXNzLCBkb3ROTCwgZG90TkgsIGRvdE5WLCBkb3RWSCk7CiAgICB2ZWMzIGluZGlyZWN0ID0gc2hJcnJhZGlhbmNlKG4pOwogICAgaW5kaXJlY3QgKj0gYWxiZWRvOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KCgoZGlyZWN0ICogbGlnaHRDb2xvcikgKiB2aXNpYmlsaXR5KSArICgoaW5kaXJlY3QgKiBvY2NsdXNpb24pICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwogICAgdmVjMyBfNzk0ID0gdG9uZW1hcEZpbG1pYyhnbF9GcmFnRGF0YVswXS54eXopOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KF83OTQueCwgXzc5NC55LCBfNzk0LnosIGdsX0ZyYWdEYXRhWzBdLncpOwp9Cgo",At.armdefault_mesh_fragData2="s11354:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzQgc2hpcnJbN107CnVuaWZvcm0gdmVjMyBsaWdodFBvczsKdW5pZm9ybSBpbnQgbGlnaHRUeXBlOwp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gYm9vbCByZWNlaXZlU2hhZG93Owp1bmlmb3JtIGludCBsaWdodFNoYWRvdzsKdW5pZm9ybSBtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXA7CnVuaWZvcm0gZmxvYXQgc2hhZG93c0JpYXM7CnVuaWZvcm0gbWVkaXVtcCBzYW1wbGVyQ3ViZSBzaGFkb3dNYXBDdWJlOwp1bmlmb3JtIHZlYzIgbGlnaHRQcm9qOwp1bmlmb3JtIHZlYzIgc3BvdGxpZ2h0RGF0YTsKdW5pZm9ybSB2ZWMzIGxpZ2h0Q29sb3I7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7CgppbiB2ZWMzIHdub3JtYWw7CmluIHZlYzMgZXllRGlyOwppbiB2ZWMzIHdwb3NpdGlvbjsKaW4gdmVjNCBsYW1wUG9zOwpvdXQgdmVjNCBmcmFnQ29sb3I7CgpmbG9hdCBhdHRlbnVhdGUoZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCmZsb2F0IHNoYWRvd0NvbXBhcmUobWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwXzEsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUpCnsKICAgIGZsb2F0IGRlcHRoID0gdGV4dHVyZShzaGFkb3dNYXBfMSwgdXYpLng7CiAgICByZXR1cm4gc3RlcChjb21wYXJlLCBkZXB0aCk7Cn0KCmZsb2F0IHNoYWRvd0xlcnAobWVkaXVtcCBzYW1wbGVyMkQgc2hhZG93TWFwXzEsIHZlYzIgdXYsIGZsb2F0IGNvbXBhcmUsIHZlYzIgc21TaXplKQp7CiAgICB2ZWMyIHRleGVsU2l6ZSA9IHZlYzIoMS4wKSAvIHNtU2l6ZTsKICAgIHZlYzIgZiA9IGZyYWN0KCh1diAqIHNtU2l6ZSkgKyB2ZWMyKDAuNSkpOwogICAgdmVjMiBjZW50cm9pZFVWID0gZmxvb3IoKHV2ICogc21TaXplKSArIHZlYzIoMC41KSkgLyBzbVNpemU7CiAgICBmbG9hdCBsYiA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYsIGNvbXBhcmUpOwogICAgZmxvYXQgbHQgPSBzaGFkb3dDb21wYXJlKHNoYWRvd01hcF8xLCBjZW50cm9pZFVWICsgKHRleGVsU2l6ZSAqIHZlYzIoMC4wLCAxLjApKSwgY29tcGFyZSk7CiAgICBmbG9hdCByYiA9IHNoYWRvd0NvbXBhcmUoc2hhZG93TWFwXzEsIGNlbnRyb2lkVVYgKyAodGV4ZWxTaXplICogdmVjMigxLjAsIDAuMCkpLCBjb21wYXJlKTsKICAgIGZsb2F0IHJ0ID0gc2hhZG93Q29tcGFyZShzaGFkb3dNYXBfMSwgY2VudHJvaWRVViArIHRleGVsU2l6ZSwgY29tcGFyZSk7CiAgICBmbG9hdCBhID0gbWl4KGxiLCBsdCwgZi55KTsKICAgIGZsb2F0IGIgPSBtaXgocmIsIHJ0LCBmLnkpOwogICAgZmxvYXQgYyA9IG1peChhLCBiLCBmLngpOwogICAgcmV0dXJuIGM7Cn0KCmZsb2F0IFBDRihtZWRpdW1wIHNhbXBsZXIyRCBzaGFkb3dNYXBfMSwgdmVjMiB1diwgZmxvYXQgY29tcGFyZSwgdmVjMiBzbVNpemUpCnsKICAgIGZsb2F0IHJlc3VsdCA9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoLTEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoLTEuMCwgMC4wKSAvIHNtU2l6ZSksIGNvbXBhcmUsIHNtU2l6ZSk7CiAgICByZXN1bHQgKz0gc2hhZG93TGVycChzaGFkb3dNYXBfMSwgdXYgKyAodmVjMigtMS4wLCAxLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKDAuMCwgLTEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2LCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMC4wLCAxLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKDEuMCwgLTEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmVzdWx0ICs9IHNoYWRvd0xlcnAoc2hhZG93TWFwXzEsIHV2ICsgKHZlYzIoMS4wLCAwLjApIC8gc21TaXplKSwgY29tcGFyZSwgc21TaXplKTsKICAgIHJlc3VsdCArPSBzaGFkb3dMZXJwKHNoYWRvd01hcF8xLCB1diArICh2ZWMyKDEuMCkgLyBzbVNpemUpLCBjb21wYXJlLCBzbVNpemUpOwogICAgcmV0dXJuIHJlc3VsdCAvIDkuMDsKfQoKZmxvYXQgbHBUb0RlcHRoKGlub3V0IHZlYzMgbHAsIHZlYzIgbGlnaHRQcm9qXzEpCnsKICAgIGxwID0gYWJzKGxwKTsKICAgIGZsb2F0IHpjb21wID0gbWF4KGxwLngsIG1heChscC55LCBscC56KSk7CiAgICB6Y29tcCA9IGxpZ2h0UHJval8xLnggLSAobGlnaHRQcm9qXzEueSAvIHpjb21wKTsKICAgIHJldHVybiAoemNvbXAgKiAwLjUpICsgMC41Owp9CgpmbG9hdCBQQ0ZDdWJlKG1lZGl1bXAgc2FtcGxlckN1YmUgc2hhZG93TWFwQ3ViZV8xLCB2ZWMzIGxwLCBpbm91dCB2ZWMzIG1sLCBmbG9hdCBiaWFzLCB2ZWMyIGxpZ2h0UHJval8xLCB2ZWMzIG4pCnsKICAgIHZlYzMgcGFyYW0gPSBscCAtIChuICogMC4wMDMwMDAwMDAwMjYwNzcwMzIwODkyMzMzOTg0Mzc1KTsKICAgIGZsb2F0IF80ODIgPSBscFRvRGVwdGgocGFyYW0sIGxpZ2h0UHJval8xKTsKICAgIGZsb2F0IGNvbXBhcmUgPSBfNDgyIC0gKGJpYXMgKiAwLjQwMDAwMDAwNTk2MDQ2NDQ3NzUzOTA2MjUpOwogICAgbWwgKz0gKG4gKiAwLjAwMzAwMDAwMDAyNjA3NzAzMjA4OTIzMzM5ODQzNzUpOwogICAgZmxvYXQgcmVzdWx0ID0gc3RlcChjb21wYXJlLCB0ZXh0dXJlKHNoYWRvd01hcEN1YmVfMSwgbWwpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIDAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1LCAwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygwLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCArPSBzdGVwKGNvbXBhcmUsIHRleHR1cmUoc2hhZG93TWFwQ3ViZV8xLCBtbCArIHZlYzMoMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgLTAuMDAxMDAwMDAwMDQ3NDk3NDUxMzA1Mzg5NDA0Mjk2ODc1KSkueCk7CiAgICByZXN1bHQgKz0gc3RlcChjb21wYXJlLCB0ZXh0dXJlKHNoYWRvd01hcEN1YmVfMSwgbWwgKyB2ZWMzKC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSwgMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUsIC0wLjAwMTAwMDAwMDA0NzQ5NzQ1MTMwNTM4OTQwNDI5Njg3NSkpLngpOwogICAgcmVzdWx0ICs9IHN0ZXAoY29tcGFyZSwgdGV4dHVyZShzaGFkb3dNYXBDdWJlXzEsIG1sICsgdmVjMygtMC4wMDEwMDAwMDAwNDc0OTc0NTEzMDUzODk0MDQyOTY4NzUpKS54KTsKICAgIHJlc3VsdCAvPSA5LjA7CiAgICByZXR1cm4gcmVzdWx0Owp9Cgp2ZWMzIHN1cmZhY2VBbGJlZG8odmVjMyBiYXNlQ29sb3IsIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peChiYXNlQ29sb3IsIHZlYzMoMC4wKSwgdmVjMyhtZXRhbG5lc3MpKTsKfQoKdmVjMyBzdXJmYWNlRjAodmVjMyBiYXNlQ29sb3IsIGZsb2F0IG1ldGFsbmVzcykKewogICAgcmV0dXJuIG1peCh2ZWMzKDAuMDM5OTk5OTk5MTA1OTMwMzI4MzY5MTQwNjI1KSwgYmFzZUNvbG9yLCB2ZWMzKG1ldGFsbmVzcykpOwp9Cgp2ZWMzIGxhbWJlcnREaWZmdXNlQlJERih2ZWMzIGFsYmVkbywgZmxvYXQgbmwpCnsKICAgIHJldHVybiBhbGJlZG8gKiBtYXgoMC4wLCBubCk7Cn0KCmZsb2F0IGRfZ2d4KGZsb2F0IG5oLCBmbG9hdCBhKQp7CiAgICBmbG9hdCBhMiA9IGEgKiBhOwogICAgZmxvYXQgZGVub20gPSBwb3coKChuaCAqIG5oKSAqIChhMiAtIDEuMCkpICsgMS4wLCAyLjApOwogICAgcmV0dXJuIChhMiAqIDAuMzE4MzA5ODczMzQyNTE0MDM4MDg1OTM3NSkgLyBkZW5vbTsKfQoKZmxvYXQgdl9zbWl0aHNjaGxpY2soZmxvYXQgbmwsIGZsb2F0IG52LCBmbG9hdCBhKQp7CiAgICByZXR1cm4gMS4wIC8gKCgobmwgKiAoMS4wIC0gYSkpICsgYSkgKiAoKG52ICogKDEuMCAtIGEpKSArIGEpKTsKfQoKdmVjMyBmX3NjaGxpY2sodmVjMyBmMCwgZmxvYXQgdmgpCnsKICAgIHJldHVybiBmMCArICgodmVjMygxLjApIC0gZjApICogZXhwMigoKC01LjU1NDcyOTkzODUwNzA4MDA3ODEyNSAqIHZoKSAtIDYuOTgzMTYwMDE4OTIwODk4NDM3NSkgKiB2aCkpOwp9Cgp2ZWMzIHNwZWN1bGFyQlJERih2ZWMzIGYwLCBmbG9hdCByb3VnaG5lc3MsIGZsb2F0IG5sLCBmbG9hdCBuaCwgZmxvYXQgbnYsIGZsb2F0IHZoKQp7CiAgICBmbG9hdCBhID0gcm91Z2huZXNzICogcm91Z2huZXNzOwogICAgcmV0dXJuIChmX3NjaGxpY2soZjAsIHZoKSAqIChkX2dneChuaCwgYSkgKiBjbGFtcCh2X3NtaXRoc2NobGljayhubCwgbnYsIGEpLCAwLjAsIDEuMCkpKSAvIHZlYzMoNC4wKTsKfQoKdmVjMyBzaElycmFkaWFuY2UodmVjMyBub3IpCnsKICAgIHZlYzMgY2wwMCA9IHZlYzMoc2hpcnJbMF0ueCwgc2hpcnJbMF0ueSwgc2hpcnJbMF0ueik7CiAgICB2ZWMzIGNsMW0xID0gdmVjMyhzaGlyclswXS53LCBzaGlyclsxXS54LCBzaGlyclsxXS55KTsKICAgIHZlYzMgY2wxMCA9IHZlYzMoc2hpcnJbMV0ueiwgc2hpcnJbMV0udywgc2hpcnJbMl0ueCk7CiAgICB2ZWMzIGNsMTEgPSB2ZWMzKHNoaXJyWzJdLnksIHNoaXJyWzJdLnosIHNoaXJyWzJdLncpOwogICAgdmVjMyBjbDJtMiA9IHZlYzMoc2hpcnJbM10ueCwgc2hpcnJbM10ueSwgc2hpcnJbM10ueik7CiAgICB2ZWMzIGNsMm0xID0gdmVjMyhzaGlyclszXS53LCBzaGlycls0XS54LCBzaGlycls0XS55KTsKICAgIHZlYzMgY2wyMCA9IHZlYzMoc2hpcnJbNF0ueiwgc2hpcnJbNF0udywgc2hpcnJbNV0ueCk7CiAgICB2ZWMzIGNsMjEgPSB2ZWMzKHNoaXJyWzVdLnksIHNoaXJyWzVdLnosIHNoaXJyWzVdLncpOwogICAgdmVjMyBjbDIyID0gdmVjMyhzaGlycls2XS54LCBzaGlycls2XS55LCBzaGlycls2XS56KTsKICAgIHJldHVybiAoKCgoKCgoKCgoY2wyMiAqIDAuNDI5MDQyOTk0OTc2MDQzNzAxMTcxODc1KSAqICgobm9yLnkgKiBub3IueSkgLSAoLW5vci56ICogLW5vci56KSkpICsgKCgoY2wyMCAqIDAuNzQzMTI1MDIxNDU3NjcyMTE5MTQwNjI1KSAqIG5vci54KSAqIG5vci54KSkgKyAoY2wwMCAqIDAuODg2MjI3MDExNjgwNjAzMDI3MzQzNzUpKSAtIChjbDIwICogMC4yNDc3MDc5OTI3OTIxMjk1MTY2MDE1NjI1KSkgKyAoKChjbDJtMiAqIDAuODU4MDg1OTg5OTUyMDg3NDAyMzQzNzUpICogbm9yLnkpICogLW5vci56KSkgKyAoKChjbDIxICogMC44NTgwODU5ODk5NTIwODc0MDIzNDM3NSkgKiBub3IueSkgKiBub3IueCkpICsgKCgoY2wybTEgKiAwLjg1ODA4NTk4OTk1MjA4NzQwMjM0Mzc1KSAqIC1ub3IueikgKiBub3IueCkpICsgKChjbDExICogMS4wMjMzMjc5NDY2NjI5MDI4MzIwMzEyNSkgKiBub3IueSkpICsgKChjbDFtMSAqIDEuMDIzMzI3OTQ2NjYyOTAyODMyMDMxMjUpICogLW5vci56KSkgKyAoKGNsMTAgKiAxLjAyMzMyNzk0NjY2MjkwMjgzMjAzMTI1KSAqIG5vci54KTsKfQoKdmVjMyB0b25lbWFwRmlsbWljKHZlYzMgY29sb3IpCnsKICAgIHZlYzMgeCA9IG1heCh2ZWMzKDAuMCksIGNvbG9yIC0gdmVjMygwLjAwNDAwMDAwMDE4OTk4OTgwNTIyMTU1NzYxNzE4NzUpKTsKICAgIHJldHVybiAoeCAqICgoeCAqIDYuMTk5OTk5ODA5MjY1MTM2NzE4NzUpICsgdmVjMygwLjUpKSkgLyAoKHggKiAoKHggKiA2LjE5OTk5OTgwOTI2NTEzNjcxODc1KSArIHZlYzMoMS43MDAwMDAwNDc2ODM3MTU4MjAzMTI1KSkpICsgdmVjMygwLjA1OTk5OTk5ODY1ODg5NTQ5MjU1MzcxMDkzNzUpKTsKfQoKdm9pZCBtYWluKCkKewogICAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgdmVjMyB2VmVjID0gbm9ybWFsaXplKGV5ZURpcik7CiAgICBmbG9hdCBkb3ROViA9IG1heChkb3QobiwgdlZlYyksIDAuMCk7CiAgICB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDExOTIwOTI4OTU1MDc4MTI1KTsKICAgIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIHZlYzMgbHAgPSBsaWdodFBvcyAtIHdwb3NpdGlvbjsKICAgIHZlYzMgbDsKICAgIGZsb2F0IGRvdE5MOwogICAgZmxvYXQgZG90Tkg7CiAgICBmbG9hdCBkb3RWSDsKICAgIGlmIChsaWdodFR5cGUgPT0gMCkKICAgIHsKICAgICAgICBsID0gbGlnaHREaXI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbCA9IG5vcm1hbGl6ZShscCk7CiAgICAgICAgdmlzaWJpbGl0eSAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgfQogICAgdmVjMyBoID0gbm9ybWFsaXplKHZWZWMgKyBsKTsKICAgIGRvdE5MID0gZG90KG4sIGwpOwogICAgZG90TkggPSBkb3QobiwgaCk7CiAgICBkb3RWSCA9IGRvdCh2VmVjLCBoKTsKICAgIGlmIChyZWNlaXZlU2hhZG93KQogICAgewogICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAxKQogICAgICAgIHsKICAgICAgICAgICAgdmVjMyBsUG9zID0gbGFtcFBvcy54eXogLyB2ZWMzKGxhbXBQb3Mudyk7CiAgICAgICAgICAgIHZpc2liaWxpdHkgKj0gUENGKHNoYWRvd01hcCwgbFBvcy54eSwgbFBvcy56IC0gc2hhZG93c0JpYXMsIHZlYzIoMTAyNC4wKSk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGlmIChsaWdodFNoYWRvdyA9PSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2ZWMzIHBhcmFtID0gLWw7CiAgICAgICAgICAgICAgICBmbG9hdCBfNzIwID0gUENGQ3ViZShzaGFkb3dNYXBDdWJlLCBscCwgcGFyYW0sIHNoYWRvd3NCaWFzLCBsaWdodFByb2osIG4pOwogICAgICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBfNzIwOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgaWYgKGxpZ2h0VHlwZSA9PSAyKQogICAgewogICAgICAgIGZsb2F0IHNwb3RFZmZlY3QgPSBkb3QobGlnaHREaXIsIGwpOwogICAgICAgIGlmIChzcG90RWZmZWN0IDwgc3BvdGxpZ2h0RGF0YS54KQogICAgICAgIHsKICAgICAgICAgICAgdmlzaWJpbGl0eSAqPSBzbW9vdGhzdGVwKHNwb3RsaWdodERhdGEueSwgc3BvdGxpZ2h0RGF0YS54LCBzcG90RWZmZWN0KTsKICAgICAgICB9CiAgICB9CiAgICB2ZWMzIGFsYmVkbyA9IHN1cmZhY2VBbGJlZG8oYmFzZWNvbCwgbWV0YWxsaWMpOwogICAgdmVjMyBmMCA9IHN1cmZhY2VGMChiYXNlY29sLCBtZXRhbGxpYyk7CiAgICB2ZWMzIGRpcmVjdCA9IGxhbWJlcnREaWZmdXNlQlJERihhbGJlZG8sIGRvdE5MKTsKICAgIGRpcmVjdCArPSBzcGVjdWxhckJSREYoZjAsIHJvdWdobmVzcywgZG90TkwsIGRvdE5ILCBkb3ROViwgZG90VkgpOwogICAgdmVjMyBpbmRpcmVjdCA9IHNoSXJyYWRpYW5jZShuKTsKICAgIGluZGlyZWN0ICo9IGFsYmVkbzsKICAgIGZyYWdDb2xvciA9IHZlYzQoKChkaXJlY3QgKiBsaWdodENvbG9yKSAqIHZpc2liaWxpdHkpICsgKChpbmRpcmVjdCAqIG9jY2x1c2lvbikgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICB2ZWMzIF83OTQgPSB0b25lbWFwRmlsbWljKGZyYWdDb2xvci54eXopOwogICAgZnJhZ0NvbG9yID0gdmVjNChfNzk0LngsIF83OTQueSwgXzc5NC56LCBmcmFnQ29sb3Iudyk7Cn0KCg",At.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",At.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",At.painter_colored_fragData2="s210:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7CgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IGZyYWdtZW50Q29sb3I7Cn0KCg",At.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",At.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",At.painter_image_fragData2="s452:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCmluIHZlYzIgdGV4Q29vcmQ7CmluIHZlYzQgY29sb3I7Cm91dCB2ZWM0IEZyYWdDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgdGV4Y29sb3IgPSB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBGcmFnQ29sb3IgPSB0ZXhjb2xvcjsKfQoK",At.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",At.painter_colored_vertData2="s354:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",At.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_text_vertData2="s466:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWMyIHRleENvb3JkOwppbiBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKaW4gbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",At.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",At.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",At.painter_text_fragData2="s348:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCm91dCB2ZWM0IEZyYWdDb2xvcjsKaW4gdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWMyIHRleENvb3JkOwoKdm9pZCBtYWluKCkKewogICAgRnJhZ0NvbG9yID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZSh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",At.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_image_vertData2="s444:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWMyIHRleENvb3JkOwppbiBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzQgY29sb3I7CmluIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",At.painter_video_vertData2="s444:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWMyIHRleENvb3JkOwppbiBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzQgY29sb3I7CmluIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",At.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",At.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",At.painter_video_fragData2="s452:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCmluIHZlYzIgdGV4Q29vcmQ7CmluIHZlYzQgY29sb3I7Cm91dCB2ZWM0IEZyYWdDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgdGV4Y29sb3IgPSB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBGcmFnQ29sb3IgPSB0ZXhjb2xvcjsKfQoK",Bt.renderListeners=[],Bt.foregroundListeners=[],Bt.backgroundListeners=[],Nt.mobile=!1,Nt.ios=!1,Nt.mobileAudioPlaying=!1,Nt.chrome=!1,Nt.firefox=!1,Nt.insideInputEvent=!1,Nt.leftMouseCtrlDown=!1,Nt.minimumScroll=999,Nt.lastFirstTouchX=0,Nt.lastFirstTouchY=0,Nt.iosSoundEnabled=!1,Nt.iosTouchs=[],Vt.INVALID_BITS=-1,Yt.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],ia._glyphs=function(e){for(var t=[],a=32;a<256;){var i=a++;t.push(i)}return t}(),Ca.GL_RGBA16F=34842,Ca.GL_RGBA32F=34836,Ca.GL_R16F=33325,Ca.GL_R32F=33326,Ca.GL_DEPTH_COMPONENT24=33190,Ca.GL_DEPTH24_STENCIL8=35056,Ca.GL_DEPTH32F_STENCIL8=36013,Na.bufferSize=1500,Sa.bufferSize=100,Sa.triangleBufferSize=100,Ga.bufferSize=100,Ua.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Ua.instances=[],Ua.connectListeners=[],Ua.disconnectListeners=[],Qa.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Ja.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},ei.bufferSize=2e3,ti.exposurePattern=new r("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),ti.formatPattern=new r("FORMAT=32-bit_rle_rgbe","i"),ti.widthHeightPattern=new r("-Y ([0-9]+) \\+X ([0-9]+)","i"),ai.todo=[],ci.loading=[],_i.nextId=0,u.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);